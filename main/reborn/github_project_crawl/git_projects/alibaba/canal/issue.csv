issue_id,issue_content
1086,application.ymlé…ç½®æ‰“åŒ…è®¾ç½®é»˜è®¤æ¨¡æ¿ 
1084,fix #1083 
1083,æ‰å¹³å‘é€RocketMQå‡ºç°å‘é€ç©ºåŒ…ç°è±¡kafkaåº”è¯¥å­˜åœ¨åŒæ ·é—®é¢˜ [https://github.com/alibaba/canal/blob/master/server/src/main/java/com/alibaba/otter/canal/rocketmq/CanalRocketMQProducer.java](url) ä»£ç  96è¡Œå¤„è¿”å›æ•°ç»„ï¼Œæ•°ç»„ä¸­å€¼å¯èƒ½ä¸ºç©ºï¼Œä½†æ˜¯ä¸‹é¢æ²¡æœ‰åˆ¤æ–­ï¼Œä¼šç»™mqå‘é€ç©ºæ¶ˆæ¯ï¼Œkafkaåº”è¯¥ä¹Ÿå­˜åœ¨åŒæ ·é—®é¢˜ã€‚ å¦å¤–ä¸€ä¸ªé—®é¢˜è¿˜è¯·å¤§ç¥å¸®å¿™å›ç­”ä¸€ä¸‹ FlatMessage è¿™ä¸ªå¯¹è±¡ çš„å±æ€§ data length ä»€ä¹ˆæƒ…å†µä¸‹æ˜¯**å¤§äº1**çš„ æœ‰å‘ç”Ÿdmlæ“ä½œdata sizeå°±ä¼šå¤§äº1
1082,cana-kafak1.1.0ç‰ˆæœ¬ï¼Œæ­å»ºkafkaæ¶ˆè´¹å®¢æˆ·ç«¯ï¼Œæ€ä¹ˆå¯¹ROWDATAç±»å‹çš„storeValueè¿›è¡Œè§£æ 2018-10-31 15:49:04.318 [Thread-1] INFO  c.a.o.canal.client.running.kafka.CanalKafkaClientExample - Message[id=12 entries=[header {   version: 1   logfileName: "mysql-bin.000002"   logfileOffset: 1206761   serverId: 1   serverenCode: "UTF-8"   executeTime: 1540972144000   sourceType: MYSQL   schemaName: ""   tableName: ""   eventLength: 79 } entryType: TRANSACTIONBEGIN storeValue: " _"  header {   version: 1   logfileName: "mysql-bin.000002"   logfileOffset: 1206909   serverId: 1   serverenCode: "UTF-8"   executeTime: 1540972144000   sourceType: MYSQL   schemaName: "smart_meter"   tableName: "sys_region_new"   eventLength: 46   eventType: INSERT   props {     key: "rowsCount"     value: "1"   } } entryType: ROWDATA storeValue: "\b\212\001\020\001P\000b\217\001\022\036\b\000\020\004\032\002id \001(\0010\000B\00530026R\aint(11)\022\037\b\001\020\f\032\004name \000(\0010\000B\000R\vvarchar(20)\022!\b\002\020\004\032\tparent_id \000(\0010\000B\0012R\aint(11)\022)\b\003\020\371\377\377\377\377\377\377\377\377\001\032\005level \000(\0010\000B\0011R\ntinyint(1)"  header {   version: 1   logfileName: "mysql-bin.000002"   logfileOffset: 1206955   serverId: 1   serverenCode: "UTF-8"   executeTime: 1540972144000   sourceType: MYSQL   schemaName: ""   tableName: ""   eventLength: 31 } entryType: TRANSACTIONEND storeValue: "\022\0049961" ] raw=true rawEntries=[]] æƒ³çŸ¥é“storeValueæ€ä¹ˆè§£æï¼Ÿ åŒé—®ï¼ŒæŠ˜è…¾å¥½ä¹…äº† å¯ä»¥å‚è€ƒ: MessageUtil.parse4Dml
1081,10.1.22-MariaDBç‰ˆæœ¬æ•°æ®åº“ journalNameä¹±ç  ä½ å¥½ï¼Œæˆ‘ä½¿ç”¨10.1.22-MariaDBå’Œ1.1.1ç‰ˆæœ¬canalï¼Œå¯åŠ¨åæŠ¥å¦‚ä¸‹é”™è¯¯ 2018-11-01 09:40:42.663 [destination = cloud   address = /192.168.1.21:3306   EventParser] WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - prepare to find start position just last position  {"identity":{"slaveId":-1 "sourceAddress":{"address":"192.168.1.21" "port":3306}} "postion":{"gtid":"" "included":false **"journalName":"mysql-bin.000607Ã†\u009EÂ´U"** "position":91598031 "serverId":1 "timestamp":1541028888000}} 2018-11-01 09:40:42.674 [destination = cloud   address = /192.168.1.21:3306   EventParser] WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - find start position : EntryPosition[included=false journalName=mysql-bin.000607Ã†Â´U position=91598031 serverId=1 gtid= timestamp=1541028888000] 2018-11-01 09:40:42.690 [destination = cloud   address = /192.168.1.21:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:102) ~[canal.parse-1.1.1.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:216) [canal.parse-1.1.1.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:252) [canal.parse-1.1.1.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-11-01 09:40:42.691 [destination = cloud   address = /192.168.1.21:3306   EventParser] ERROR c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - dump address /192.168.1.21:3306 has an error  retrying. caused by  java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:102) ~[canal.parse-1.1.1.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:216) ~[canal.parse-1.1.1.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:252) ~[canal.parse-1.1.1.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-11-01 09:40:42.692 [destination = cloud   address = /192.168.1.21:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:cloud[java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:102) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:216) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:252) 	at java.lang.Thread.run(Thread.java:748) ] çœ‹åˆ°æ˜¯journalNameæœ‰ä¹±ç ï¼Œè¯·é—®æ€ä¹ˆè§£å†³ æœ¬åœ°ä¸€ç›´æ²¡é‡ç°ï¼Œæœ‰debugèƒ½åŠ›å¯ä»¥å°è¯•çœ‹ä¸‹RotateLogEventçš„è§£æè¿‡ç¨‹ æˆ‘æ”¹äº†EntryPositionç±» åŠ äº†ä¸ªè§£ææ–¹æ³•    ``` public EntryPosition(String journalName  Long position  Long timestamp){         super(timestamp);         this.journalName = filterLogFileName(journalName);         this.position = position;     }     public EntryPosition(String journalName  Long position  Long timestamp  Long serverId){         this(journalName  position  timestamp);         this.serverId = serverId;     }     public String filterLogFileName(String logfileName) {         Pattern p = Pattern.compile("(mysql-bin\\.[0-9]{6}).");         Matcher m = p.matcher(logfileName);         while(m.find()){             if(m.groupCount() >= 1) {                 return m.group(1);             }         }         return logfileName;     }     public String getJournalName() {         return filterLogFileName(journalName);     }     public void setJournalName(String journalName) {         this.journalName = filterLogFileName(journalName);     } ``` ç„¶åå¥½ä½¿äº† è¿™ä¸ªæ”¹æ³•éƒ½æ˜¯æ›²çº¿æ•‘å›½çš„ç¡¬ç¼–ç å¤„ç†ï¼Œæ²¡æœ‰æ‰¾åˆ°æ ¹æœ¬åŸå›  @haopangxu å¯ä»¥è¯•ä¸€ä¸‹æˆ‘çš„æ”¹æ³•.   ä¸»è¦åŸå› : mariadbåœ¨å¤„ç†checksumè¡Œä¸ºä¸Šå’Œmysqlæœ‰ç‚¹ä¸å¤ªä¸€è‡´ï¼Œé’ˆå¯¹rotate_eventè¿™ä¸ªbinlogå¯¹è±¡ï¼Œmariadbä¼šæ‰§è¡Œchecksumï¼Œè€Œmysqlä¸ä¼šï¼Œéœ€è¦æœ‰ç‰¹æ®Šåˆ¤æ–­å¤„ç†
1079, application.ymlä¸æ‰“åŒ…è¿›jar application.ymlä¸æ‰“åŒ…è¿›jar  è§£å†³jarä¸­çš„application.ymlå’Œconfigä¸­çš„ä¼šåˆå¹¶bug
1078,canal-server åœ¨ç§¯å‹äº‹ä»¶æ—¶é‡å¯ä¼šä¸¢å¼ƒå†…å­˜ä¸­çš„ç§¯å‹äº‹ä»¶å—ï¼Ÿ ## é—®é¢˜ canal-server åœ¨é…åˆ ZooKeeperLogPositionManagerä½¿ç”¨æ—¶ï¼Œé‡å¯åè¯»å–çš„ binlog ä½ç‚¹æ˜¯ server ä¸Šä¸€æ¬¡ parse çš„ä½ç½®è¿˜æ˜¯ client ack çš„ä½ç½®ï¼Ÿ æ ¹æ® https://github.com/alibaba/canal/wiki/Introduction#eventparser%E8%AE%BE%E8%AE%A1 çš„æè¿°ï¼ŒEventParser è®°å½•çš„ binlog ä½ç‚¹æ˜¯ä¸Šä¸€æ¬¡ parse åˆ°çš„ä½ç‚¹ï¼Œè¿™ç§è¡Œä¸ºæ˜¯ä¸æ˜¯ä¼šå¯¼è‡´ server é‡å¯æ—¶ä¸¢å¼ƒäº‹ä»¶ï¼Ÿ ## ç°è±¡ æå‡ºè¿™ä¸ªé—®é¢˜æ˜¯å› ä¸ºåœ¨å®è·µçš„æ—¶å€™é‡åˆ°äº† binlog äº‹ä»¶ä¸¢å¤±çš„é—®é¢˜ï¼Œç°è±¡å¦‚ä¸‹ï¼š åœ¨ canal-server æœ‰äº‹ä»¶ç§¯å‹ï¼ˆå¤§çº¦ 20 Mï¼Œæœªè¾¾åˆ°è®¾å®šçš„å†…å­˜é™åˆ¶ï¼‰æ—¶é‡å¯ canal-serverã€canal-clientã€zkï¼ˆä½¿ç”¨ docker-compose éƒ¨ç½²ï¼Œserverã€client å’Œ zk å‡ä¸ºå•å®ä¾‹ï¼Œserver ä½¿ç”¨é•œåƒä¸º canal/canal-server:v1.1.0ï¼‰ï¼Œcanal ä¼šä¸¢å¼ƒä¸€éƒ¨åˆ†äº‹ä»¶ã€‚ ## binlog ä¸¢å¤±åŸå› çŒœæµ‹ æ ¹æ® https://github.com/alibaba/canal/wiki/Introduction#eventparser%E8%AE%BE%E8%AE%A1 çš„æè¿°ï¼ŒEventParser åªè®°å½• parse åˆ°çš„ binlog ä½ç‚¹ï¼ŒçŒœæµ‹åŸå› æ˜¯ server ç«¯åœ¨ç§¯å‹äº‹ä»¶çš„åŒæ—¶é‡å¯ï¼Œé‡å¯åä»ä¸Šæ¬¡ parse åˆ°çš„ä½ç‚¹è¿›è¡Œæ¶ˆè´¹ï¼Œé€ æˆäº†å†…å­˜ä¸­ç»è¿‡ parseã€sinkã€store ä½†æ˜¯è¿˜æœªè¢« get çš„ binlog ä¸¢å¤±ã€‚ ## client ä»£ç  client ï¼ˆåŸºäº commit èŠ‚ç‚¹ 82f8a9f - fixed issue #483   show slave hosts ä¿®æ”¹ï¼‰ä½¿ç”¨ com.alibaba.otter.canal.client.ClientLauncher é…åˆè‡ªå®šä¹‰çš„ CanalOuterAdapter è¿›è¡Œæ¶ˆè´¹ã€‚ä¸ºäº†è®°å½•æ¥æ”¶åˆ°çš„ binlog ä½ç‚¹ï¼Œå¯¹ com.alibaba.otter.canal.client.adapter.loader.CanalAdapterWorker è¿›è¡Œäº†å¦‚ä¸‹ä¿®æ”¹ï¼š ```java while (running) {             try {                 // if (switcher != null) {                 // switcher.get();                 // }                 logger.info("=============> Start to connect destination: {} <============="  this.canalDestination);                 connector.connect();                 logger.info("=============> Start to subscribe destination: {} <============="  this.canalDestination);                 connector.subscribe();                 logger.info("=============> Subscribe destination: {} succeed <============="  this.canalDestination);                 while (running) {                     // try {                     // if (switcher != null) {                     // switcher.get();                     // }                     // } catch (TimeoutException e) {                     // break;                     // }                     // serveré…ç½®canal.instance.network.soTimeout(é»˜è®¤: 30s)                     // èŒƒå›´å†…æœªä¸serveräº¤äº’ï¼Œserverå°†å…³é—­æœ¬æ¬¡socketè¿æ¥                     // ä¸‹é¢æ˜¯æ·»åŠ çš„éƒ¨åˆ†                     Message message = connector.getWithoutAck(BATCH_SIZE); // è·å–æŒ‡å®šæ•°é‡çš„æ•°æ®                     for (CanalEntry.Entry entry : message.getEntries()) {                         if (!entry.getEntryType().equals(CanalEntry.EntryType.ROWDATA)) {                             continue;                         }                         logger.info("receive binlog event  file {}  offset {}"  entry.getHeader().getLogfileName()  entry.getHeader().getLogfileOffset());                     } ``` æ£€æŸ¥ client æ—¥å¿—ï¼Œå‘ç°æ¥æ”¶åˆ°çš„ binlog ä¸è¿ç»­ï¼ŒèŒƒå›´ä¸ canal æ•´ä½“ä¸¢å¼ƒçš„ binlog èŒƒå›´ç›¸åŒã€‚ç”±äºæ˜¯åœ¨ client çš„å…¥å£å¤„æ‰“å°çš„ binlog ä½ç‚¹ï¼Œæ‰€ä»¥æˆ‘è®¤ä¸º client æ²¡æœ‰æ¥æ”¶åˆ° binlog äº‹ä»¶ï¼Œserver å¤„ä¸¢å¼ƒäº†è¿™ä¸€éƒ¨åˆ†äº‹ä»¶ã€‚ ## é…ç½® instance.xml ä¸ canal/deployer/src/main/resources/spring/default-instance.xml çš„ diff å¦‚ä¸‹ï¼š ```xml 112 120c112 113 <                       <bean class="com.alibaba.otter.canal.parse.index.FailbackLogPositionManager"> <                               <constructor-arg> <                                       <bean class="com.alibaba.otter.canal.parse.index.MemoryLogPositionManager" /> <                               </constructor-arg> <                               <constructor-arg> <                                       <bean class="com.alibaba.otter.canal.parse.index.MetaLogPositionManager"> <                                               <constructor-arg ref="metaManager"/> <                                       </bean> <                               </constructor-arg> --- >                       <bean class="com.alibaba.otter.canal.parse.index.ZooKeeperLogPositionManager"> >                               <constructor-arg index="0" ref="zkClientx"/> 129c122 <                       <bean class="com.alibaba.otter.canal.parse.support.AuthenticationInfo" init-method="initPwd"> --- >                       <bean class="com.alibaba.otter.canal.parse.support.AuthenticationInfo"> 133 134d125 <                               <property name="pwdPublicKey" value="${canal.instance.pwdPublicKey:retl}" /> <                               <property name="enableDruid" value="${canal.instance.enableDruid:false}" /> 139c130 <                       <bean class="com.alibaba.otter.canal.parse.support.AuthenticationInfo" init-method="initPwd"> --- >                       <bean class="com.alibaba.otter.canal.parse.support.AuthenticationInfo"> 143 144d133 <                               <property name="pwdPublicKey" value="${canal.instance.pwdPublicKey:retl}" /> <                               <property name="enableDruid" value="${canal.instance.enableDruid:false}" /> ``` ## è¯·å¤§ç¥æŒ‡ç‚¹è¿·æ´¥ï¼Œæ˜¯æˆ‘çš„é…ç½®æœ‰è¯¯ï¼Œè¿˜æ˜¯ server ç¡®å®ä¼šåœ¨é‡å¯åä¸¢å¤±ç§¯å‹çš„äº‹ä»¶ï¼Ÿ canal-serveräº‹ä»¶çš„å­˜å‚¨æ˜¯ç”¨çš„åŸºäºå†…å­˜å®ç°çš„EventStore. ä¸¢å¤±æ˜¯å¿…ç„¶çš„å¤šã€‚çœ‹çœ‹wikiå§ wikiéƒ½å†™çš„å¾ˆæ¸…æ¥šäº†ã€‚ é‡å¯è¯»å–çš„æ˜¯ä¸Šä¸€æ¬¡client ackçš„ä½ç‚¹ï¼Œå†…å­˜æ•°æ®è™½ç„¶ä¼šä¸¢å¤±ï¼Œä½†ä¼šåŸºäºæœ€åä¸€æ¬¡æ¶ˆè´¹æˆåŠŸçš„ä½ç‚¹ç»§ç»­dump binlogï¼Œæ‰€ä»¥æ¶æ„ä¸Šä¸å­˜åœ¨æ¶ˆæ¯ä¸¢å¤±ï¼Œåªè¦æ­£ç¡®ackä½ç‚¹ ä½ è¿™æ˜¯é…ç½®é—®é¢˜ï¼Œå¿…é¡»å‚è€ƒfile/default-instance.xmlé‡Œçš„com.alibaba.otter.canal.parse.index.FailbackLogPositionManagerçš„é…ç½®ï¼Œå®ƒåœ¨é‡æ–°å¯åŠ¨æ—¶ä¼šè¯»å–åˆ°MetaLogPositionManager (ackçš„ä½ç‚¹) > ä½ è¿™æ˜¯é…ç½®é—®é¢˜ï¼Œå¿…é¡»å‚è€ƒfile/default-instance.xmlé‡Œçš„com.alibaba.otter.canal.parse.index.FailbackLogPositionManagerçš„é…ç½®ï¼Œå®ƒåœ¨é‡æ–°å¯åŠ¨æ—¶ä¼šè¯»å–åˆ°MetaLogPositionManager (ackçš„ä½ç‚¹) æ„Ÿè°¢å¤§ç¥æŒ‡å¯¼ï¼Œé—®é¢˜å·²è§£å†³
1076,å…³äºrds oss binlog ç¦»çº¿è¯»å–çš„é—®é¢˜ hi  æ‚¨å¥½ æˆ‘åœ¨å®ä¾‹é…ç½®æ–‡ä»¶ä¸­é…ç½®äº† #rds oss binlog canal.instance.rds.accesskey= canal.instance.rds.secretkey= canal.instance.rds.instanceId= é‡å¯canal é›†ç¾¤ï¼Œè¿˜æ˜¯æ— æ³•è·å–åˆ°ossçš„binlog è¿™æ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿ çœ‹å®ä¾‹æ—¥å¿—ï¼Œä¹Ÿæ²¡æœ‰å…³äºossçš„ä¿¡æ¯ è¿™æ˜¯é”™è¯¯ä¿¡æ¯ 2018-10-30 16:33:20.395 [destination = instance   address = åœ°å€    EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:instance[java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:102)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:153)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:262)         at java.lang.Thread.run(Thread.java:745) canal.instance.rds.accesskeyï¼Œcanal.instance.rds.secretkeyè¿ç»´ç»™ç”³è¯·çš„ï¼Œrds.instanceIdçš„å®ä¾‹idä¹Ÿæ˜¯æ²¡æœ‰é—®é¢˜çš„ oss binlogçš„å›æº¯ï¼Œç›®å‰åªæ”¯æŒåŸºäºæ—¶é—´æˆ³çš„å®šä½ï¼Œå®ƒä¼šåˆ¤å®šå½“å‰mysql binlogæ˜¯å¦æœ‰è¯¥æ—¶é—´æˆ³çš„æ•°æ®ï¼Œæ²¡æœ‰çš„è¯ä¼šä»ossä¸Šå»è‡ªåŠ¨ä¸‹è½½binlogï¼Œç„¶åæœ¬åœ°è§£æç›´åˆ°æœ¬åœ°mysql binlogé‡Œæ—¶é—´èƒ½æ¥ä¸Š.  ps.  å¦‚æœç»™äº†ä¸€ä¸ªé”™è¯¯çš„binlogä½ç‚¹ï¼Œä¸ç¡®å®šæ˜¯ç»™çš„ä½ç‚¹é”™è¯¯ï¼Œè¿˜æ˜¯binlogè¢«åˆ é™¤ï¼Œåç»­å¯ä»¥é’ˆå¯¹RDSæƒ…å†µè¯†åˆ«ä¼˜åŒ–ä¸€ä¸‹ @agapple  å—¯ï¼Œæ„Ÿè°¢ä½ çš„å›å¤ï¼Œç°åœ¨è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æˆ‘canal clientsæ­£å¸¸æ¶ˆè´¹binlogï¼Œå·²ç»è·‘äº†æœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œä½†æ˜¯æˆ‘çœ‹ç€zkä¸­å®ä¾‹è¢«æ¶ˆè´¹çš„ä½ç½®ä¸€ç›´æ²¡æœ‰æ›´æ–°ï¼Œè¿™æ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿ(canalçš„HAæ˜¯ç”¨ä¸‰å°èŠ‚ç‚¹åšçš„)ï¼Œ å¦‚å›¾ï¼š ![2121](https://user-images.githubusercontent.com/12511065/47762190-91bdca00-dcf6-11e8-8aaa-aec578ff67d1.jpg) æ˜¨å¤©ä¸‹åˆçœ‹çš„ä¹Ÿæ˜¯è¿™æ ·ï¼Œæ²¡æœ‰æ›´æ–°ä½ç½®ã€‚ canal haä½ç‚¹çš„æ›´æ–°ç­–ç•¥æ˜¯ä»€ä¹ˆå‘€ï¼Ÿæˆ‘çœ‹æ–‡æ¡£æ˜¯è¿™ä¹ˆè¯´çš„ **canal serveråœ¨æ¥æ”¶äº†å®¢æˆ·ç«¯çš„ackåï¼Œå°±ä¼šè®°å½•å®¢æˆ·ç«¯æäº¤çš„æœ€åä½ç‚¹** ä½†æ˜¯æˆ‘çš„ä½ç‚¹æ²¡æœ‰è¢«æ›´æ–° 1.  ä½ serverç«¯æ²¡å¼€å¯canal.instance.filter.transaction.entry=trueå§ï¼Ÿ 2. æ£€æŸ¥ä¸‹å½“å‰runçš„serverèŠ‚ç‚¹ï¼Œå¯¹åº”çš„meta.logï¼Œçœ‹ä¸‹å¦‚æœæœ‰ackæˆåŠŸä¼šè®°å½•ä¿¡æ¯ @agapple  1. æ¯ä¸ªèŠ‚ç‚¹æˆ‘è®¾ç½®äº†canal.instance.filter.transaction.entry=true 2.æ²¡æœ‰çœ‹åˆ°è¿è¡ŒèŠ‚ç‚¹æœ‰å¯¹åº”çš„meta.log   ... å—¯ã€‚ã€‚ã€‚æˆ‘çš„é›†ç¾¤æ­å»ºçš„æœ‰é—®é¢˜ï¼ŸğŸ˜­ 1. canal.instance.filter.transaction.entry=trueè¿™ä¸ªè®¾ç½®çš„é—®é¢˜ï¼Œè¿‡æ»¤äº†äº‹åŠ¡å¤´å’Œå°¾ï¼Œå°±æ²¡æœ‰å¯æ›´æ–°çš„ä½ç‚¹ (ä½ç‚¹è®°å½•ä»¥æ¥begin/endäº‹ä»¶)ï¼Œæ–°çš„v1.1.1æœ‰å…¼å®¹è¿™ä¸ªå‚æ•°ï¼Œfilterå¹¶ä¸æ˜¯è¿‡æ»¤å…¨éƒ¨ï¼Œè€Œæ˜¯ä¼šé—´éš”å‡ ç§’ä¿ç•™ä¸€ä¸ªäº‹åŠ¡äº‹ä»¶ 2. rds binlogä½ç‚¹çš„é—®é¢˜ï¼Œåšäº†å…¼å®¹å¤„ç†ï¼Œæ­£å¸¸çš„ä½ç‚¹è¢«åˆ é™¤ï¼Œåªè¦ä½ç‚¹é‡Œæœ‰timestampï¼Œä¼šè‡ªåŠ¨ä¸‹è½½oss binlog @agapple  å†æ¬¡æ„Ÿè°¢ğŸ™ï¼Œ zkä½ç‚¹æ›´æ–°å·²ç»å¯ä»¥äº†ï¼Œç¡®å®æ˜¯canal.instance.filter.transaction.entry=trueçš„é—®é¢˜å¼•å‘çš„ã€‚ > oss binlogçš„å›æº¯ï¼Œç›®å‰åªæ”¯æŒåŸºäºæ—¶é—´æˆ³çš„å®šä½ï¼Œå®ƒä¼šåˆ¤å®šå½“å‰mysql binlogæ˜¯å¦æœ‰è¯¥æ—¶é—´æˆ³çš„æ•°æ®ï¼Œæ²¡æœ‰çš„è¯ä¼šä»ossä¸Šå»è‡ªåŠ¨ä¸‹è½½binlogï¼Œç„¶åæœ¬åœ°è§£æç›´åˆ°æœ¬åœ°mysql binlogé‡Œæ—¶é—´èƒ½æ¥ä¸Š. >  > ps. å¦‚æœç»™äº†ä¸€ä¸ªé”™è¯¯çš„binlogä½ç‚¹ï¼Œä¸ç¡®å®šæ˜¯ç»™çš„ä½ç‚¹é”™è¯¯ï¼Œè¿˜æ˜¯binlogè¢«åˆ é™¤ï¼Œåç»­å¯ä»¥é’ˆå¯¹RDSæƒ…å†µè¯†åˆ«ä¼˜åŒ–ä¸€ä¸‹ æ‚¨è¯´çš„RDSä¼˜åŒ–æ˜¯æ€ä¹ˆåšçš„å‘¢ï¼Ÿæˆ‘ç°åœ¨è¿˜æ˜¯æ— æ³•ç¡®å®šï¼Œå®ƒåˆ°åº•æœ‰æ²¡æœ‰å»ossä¸Šé¢ä¸‹è½½æˆ‘è¦çš„binlogï¼› ä¼˜åŒ–æˆ‘å·²ç»ä»£ç æäº¤äº†ï¼Œå¯ä»¥åŸºäºmasteré‡æ–°æ‰“ä¸ªåŒ…
1075,kafkaçš„canal.instance.filter.transaction.entryé—®é¢˜ ç”¨çš„kafkaæ¨¡å¼ï¼Œåœ¨canal.propertiesæ–‡ä»¶è®¾ç½®äº†canal.instance.filter.transaction.entry:trueå å±è”½äº†TransactionBeginäº‹ä»¶ï¼Œä½†æ˜¯è¿˜å¯ä»¥æ”¶åˆ°Transactionendäº‹ä»¶ æ˜¯ç”¨çš„flatMessage:falseä¹ˆï¼Ÿå¯ä»¥å°è¯•ä¸€ä¸‹flatä¸ºtrueçš„æƒ…å†µ
1071,canal1.1.1è¿è¡Œclientä¸­KafkaClientRunningTestæŠ¥é”™ åœ¨1.1.0ç‰ˆæœ¬ä¸­æ˜¯Message message = connector.getWithoutAck(3L  TimeUnit.SECONDS); åœ¨1.1.1ç‰ˆæœ¬ä¸­æ˜¯List<Message> messages = connector.getList(3L  TimeUnit.SECONDS); è¿è¡Œ1.1.0ç‰ˆæœ¬æ²¡æœ‰é—®é¢˜ï¼Œå¯ä»¥çœ‹åˆ°messageæ•°æ®åŒ…ï¼Œè¿è¡Œ1.1.1åˆ°è¿™ä¸€è¡Œä»£ç å¤„æŠ¥é”™ã€‚ æ˜¯å¦è¿˜ä¸æ˜¯ç¨³å®šç‰ˆæœ¬ æŠŠdeployä¸­çš„é…ç½®mq.ymlæ–‡ä»¶ä¸­flatMessageè®¾ç½®ä¸ºfalse  KafkaClientRunningTestä¸­ä¸ºåŸç”ŸMessageæ¥æ”¶ é…ç½®mq.ymlæ–‡ä»¶ä¸­flatMessageè®¾ç½®ä¸ºfalseï¼ŒKafkaClientRunningTestæ”¹ä¸ºåŸç”ŸMessageï¼Œ connector.getWithoutAck(batchSize 5L  TimeUnit.SECONDS); æ‰§è¡Œè¿˜æ˜¯è¿è¡Œä¸äº†ã€‚ åœ¨ 2018-10-30 09:45:54ï¼Œ"rewerma" <notifications@github.com> å†™é“ï¼š æŠŠdeployä¸­çš„é…ç½®mq.ymlæ–‡ä»¶ä¸­flatMessageè®¾ç½®ä¸ºfalse  KafkaClientRunningTestä¸­ä¸ºåŸç”ŸMessageæ¥æ”¶ â€” You are receiving this because you authored the thread. Reply to this email directly  view it on GitHub  or mute the thread. æŠ¥com.alibaba.otter.canal.protocol.exception.CanalClientException: mq not support this method connector.getWithoutAck(batchSize 5L  TimeUnit.SECONDS);è¿™ä¸ªä¸æ˜¯kafkaConnectoræ‰€æä¾›çš„æ–¹æ³• æµ‹è¯•ç±»ä¸è¦ä¿®æ”¹  å°±ä½¿ç”¨è¿™æ®µä»£ç æ²¡æœ‰é—®é¢˜ ``` executor.submit(new Runnable() {             @Override             public void run() {                 connector.connect();                 connector.subscribe();                 while (running) {                     try {                         List<Message> messages = connector.getList(3L  TimeUnit.SECONDS);                         if (messages != null) {                             System.out.println(messages);                         }                         connector.ack();                     } catch (WakeupException e) {                         // ignore                     }                 }                 connector.unsubscribe();                 connector.disconnect();             }         }); ``` ä½¿ç”¨ä¸Šè¿°æµ‹è¯•ç±»ä»£ç ï¼ŒflatMessageè®¾ç½®ä¸ºfalseåï¼Œè¿è¡Œåæ²¡ååº”ï¼ŒæŠŠcatchå—æ”¹ä¸ºException åï¼Œçœ‹åˆ°æŠ¥é”™ä¿¡æ¯ä¸º `Caused by: com.alibaba.otter.canal.protocol.exception.CanalClientException: deserializer failed 	at com.alibaba.otter.canal.client.CanalMessageDeserializer.deserializer(CanalMessageDeserializer.java:52) 	at com.alibaba.otter.canal.client.CanalMessageDeserializer.deserializer(CanalMessageDeserializer.java:14) 	at com.alibaba.otter.canal.client.kafka.MessageDeserializer.deserialize(MessageDeserializer.java:24) 	at com.alibaba.otter.canal.client.kafka.MessageDeserializer.deserialize(MessageDeserializer.java:1) 	at org.apache.kafka.common.serialization.ExtendedDeserializer$Wrapper.deserialize(ExtendedDeserializer.java:65) 	at org.apache.kafka.common.serialization.ExtendedDeserializer$Wrapper.deserialize(ExtendedDeserializer.java:55) 	at org.apache.kafka.clients.consumer.internals.Fetcher.parseRecord(Fetcher.java:967) 	at org.apache.kafka.clients.consumer.internals.Fetcher.access$3300(Fetcher.java:93) 	at org.apache.kafka.clients.consumer.internals.Fetcher$PartitionRecords.fetchRecords(Fetcher.java:1144) 	at org.apache.kafka.clients.consumer.internals.Fetcher$PartitionRecords.access$1400(Fetcher.java:993) 	at org.apache.kafka.clients.consumer.internals.Fetcher.fetchRecords(Fetcher.java:527) 	at org.apache.kafka.clients.consumer.internals.Fetcher.fetchedRecords(Fetcher.java:488) 	at org.apache.kafka.clients.consumer.KafkaConsumer.pollOnce(KafkaConsumer.java:1155) 	at org.apache.kafka.clients.consumer.KafkaConsumer.poll(KafkaConsumer.java:1115) 	at com.alibaba.otter.canal.client.kafka.KafkaCanalConnector.getListWithoutAck(KafkaCanalConnector.java:173) 	at com.alibaba.otter.canal.client.kafka.KafkaCanalConnector.getList(KafkaCanalConnector.java:159) 	at com.alibaba.otter.canal.client.running.kafka.KafkaClientRunningTest$1.run(KafkaClientRunningTest.java:44) 	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) 	at java.util.concurrent.FutureTask.run(FutureTask.java:266) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) 	at java.lang.Thread.run(Thread.java:745) Caused by: com.google.protobuf.InvalidProtocolBufferException: Protocol message end-group tag did not match expected tag. 	at com.google.protobuf.InvalidProtocolBufferException.invalidEndTag(InvalidProtocolBufferException.java:110) 	at com.google.protobuf.CodedInputStream$ArrayDecoder.checkLastTagWas(CodedInputStream.java:660) 	at com.google.protobuf.CodedInputStream$ArrayDecoder.readGroup(CodedInputStream.java:869) 	at com.google.protobuf.UnknownFieldSet$Builder.mergeFieldFrom(UnknownFieldSet.java:541)` groupId æ¢ä¸€ä¸ª  ä½ æ¶ˆè´¹åˆ°çš„è¿˜æ˜¯è€çš„faltMessage okäº†ï¼Œè°¢è°¢å¤§å¸ˆï¼
1069,pass useDruidDdlFilter parameter to LogEventConvert æœ‰å…³tsdbåŠŸèƒ½å˜åŠ¨çš„è¯´æ˜ 1. tsdbåº”è¯¥åªå…³å¿ƒddl  dmlå’Œdclåº”è¯¥è·³è¿‡  åƒ #450 è¿™æ ·çš„é—®é¢˜ä¸ä¼šå†å‡ºç°ï¼Œå½“ç„¶fastsqlä¹Ÿåº”è¯¥æ”¯æŒdcl 2. ä¸ç®¡ddlæ˜¯å¦è¿‡æ»¤ï¼Œtsdbçš„åŠŸèƒ½éƒ½åº”è¯¥ä¿è¯æ­£ç¡®æ€§ 3. ddl historyå†™å…¥æ”¾åœ¨è¿‡æ»¤å™¨åé¢å¯ä»¥ä¿è¯åœ¨è¡¨ç»“æ„å¯¹æ¯”çš„æ—¶å€™ä¸å­˜åœ¨æƒé™é—®é¢˜ [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=1069) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=1069) before we can accept your contribution.<br/><hr/>**wuwo** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=1069) it.</sub> [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=1069) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=1069) before we can accept your contribution.<br/><hr/>**wuwo** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=1069) it.</sub> è¿™æ ·çš„æ”¹æ³•ä¼šæœ‰ä¸€ä¸ªé£é™©ï¼šå‡å¦‚fastsql parseåœ¨è§£ææ­£å¸¸çš„DDLè¯­å¥æ˜¯æ—¶æœ‰å¼‚å¸¸ï¼ŒDdlResultè¿”å›çš„é»˜è®¤æ˜¯Queryï¼Œä½ è¿™é‡Œå°±ä¼šå¿½ç•¥æ‰ï¼Œè¿ä¸€ç‚¹æ—¥å¿—éƒ½æ²¡æœ‰ å¦‚æœddlè§£æçš„å¼‚å¸¸åŠ ä¸Šå‘¢ï¼Œç°åœ¨ddlè§£æçš„å¼‚å¸¸éƒ½æ˜¯å¿½ç•¥ï¼Œç„¶åç›´æ¥è¿”å›Query ddlå¼‚å¸¸åŠ ä¸Šï¼Œæ•ˆæœæˆ‘è§‰å¾—å’Œä¹‹å‰ä¹Ÿæ²¡å•¥åŒºåˆ«å§ã€‚ å¦‚æœèƒ½æ­£å¸¸è§£æï¼ŒdruidFilterå°±å·²ç»æŠŠä¸è®¢é˜…çš„è¡¨ç»™è¿‡æ»¤äº† æˆ‘å›æ»šäº†æœ‰å…³tsdbçš„å˜æ›´ï¼Œä½†æ˜¯ç›®å‰åƒä½ è¯´çš„å¦‚æœæ­£å¸¸çš„ddlè§£æå¤±è´¥  ä¼šç›´æ¥è¿”å›Queryï¼Œå¦‚æœå¼€å¯äº†dclè¿‡æ»¤ï¼Œè¿™æ¬¡ddlå˜æ›´è¿˜æ˜¯ä¼šä¸¢å¤±ï¼Œæ­£å¸¸çš„ddlè§£æï¼Œå¦‚æœå¼€å¯ddlè¿‡æ»¤  ddlå˜æ›´ä¹Ÿä¼šä¸¢å¤±  æˆ‘è¿˜æ˜¯è§‰å¾—tsdbåŠŸèƒ½çš„æ­£ç¡®æ€§ä¸åº”è¯¥å’ŒfilterQueryDdlï¼ŒfilterQueryDmlï¼ŒfilterQueryDclç»‘ä¸Šå…³ç³»  ä¼°è®¡å¾ˆå¤šç”¨æˆ·ä¹Ÿæ— æ³•æ„è¯†åˆ°è¿™ä¸ªé—®é¢˜ æˆ‘æƒ³æƒ³æœ‰æ²¡æœ‰å…¶å®ƒä¼˜é›…ä¸€äº›çš„è°ƒæ•´æ–¹å¼ tks
1066,binlogåŒæ­¥è¿‡ç¨‹ä¸­ddlæœ‰ä¸¢å¤± mysqlç‰ˆæœ¬ 5.6.26 canalserverç‰ˆæœ¬ 1.0.24 æˆ‘ä»¬åœ¨å®æ—¶åŒæ­¥binlogå¤„ç†dmlçš„è¿‡ç¨‹ä¸­ï¼ˆä¸‡æ¡/ç§’ï¼‰ï¼Œå‘é€äº†ä¸€æ¡ddlè¯­å¥ï¼Œå‘ç°clientç«¯å¹¶æ²¡æœ‰æ‹¿åˆ°è¿™æ¡ddlè¯­å¥ï¼Œè¯·é—®æ˜¯ä»€ä¹ˆåŸå› ã€‚ canal.instance.get.ddl.isolation å’Œè¿™ä¸ªé…ç½®æœ‰å…³ç³»å—ï¼Ÿæˆ‘ç”¨çš„æ˜¯é»˜è®¤å€¼false å…³é—­issueï¼ŸåŸå› è‡ªå·±æ‰¾åˆ°äº†ï¼Ÿ @yxzhang666  > å…³é—­issueï¼ŸåŸå› è‡ªå·±æ‰¾åˆ°äº†ï¼Ÿ @yxzhang666  æˆ‘ä»¬çš„DBAæ·»åŠ è¡¨å­—æ®µçš„é€»è¾‘å’Œæˆ‘ä»¬çš„å¤„ç†æ–¹å¼ä¸ä¸€è‡´ã€‚æˆ‘ä»¬é€šè¿‡CanalEntry.EventType.ALTER è·å–ddl å¹¶å¤„ç†è¯¥ddlè¯­å¥ï¼›dbaæ˜¯é€šè¿‡å…‹éš†è¡¨ï¼Œæ›´æ¢è¡¨åä¹‹åæ·»åŠ çš„å­—æ®µï¼Œç„¶åæŠŠä¹‹å‰çš„è¡¨dropï¼Œå†æ›´æ”¹å…‹éš†è¡¨åä¸ºä¹‹å‰çš„è¡¨åï¼Œæ–°è¡¨åæˆ‘ä»¬æ²¡æœ‰å»å…³æ³¨ï¼Œæ‰€ä»¥æ²¡æ‹¿åˆ°è¯¥æ¡ddlã€‚ä¸¥æ ¼æ¥è¯´ï¼Œcanal serverå¹¶æ²¡æœ‰ä¸¢å¤±è¯¥æ¡binlog ï¼Œæ˜¯æˆ‘ä»¬æ²¡æ‹¿åˆ°ï¼Œè™šæƒŠä¸€åœºï¼ canal.instance.get.ddl.isolationï¼Œè¿™ä¸ªisolationæˆ‘ä»¬è¦ä¸è¦æ‰“å¼€ï¼Œæœ‰æ²¡æœ‰å»ºè®®å‘¢ï¼Ÿ è¿™ä¸æ˜¯pt-schema-change-onlineå’Œghostçš„åšæ³•å— canal.instance.get.ddl.isolation=trueï¼Œå¦‚æœæ‰“å¼€çš„è¯ï¼Œå®ƒä¼šå’Œå…¶ä»–DMLåˆ†å¼€å¤šä¸ªbatchï¼Œä¸€ä¸ªbatchä¸€ä¸ªddlï¼Œæ²¡æœ‰å•¥æœ¬è´¨åŒºåˆ«ã€‚å¯ä»¥ç”¨åœ¨åšæ•°æ®åŒæ­¥ä¸Š > ä¸ªbatchä¸€ä¸ªddlï¼Œæ²¡æœ‰å•¥æœ¬è´¨åŒºåˆ«ã€‚å¯ä»¥ç”¨åœ¨åšæ•°æ®åŒæ­¥ä¸Š æ˜ç™½äº†ã€‚è°¢è°¢ï¼ > è¿™ä¸æ˜¯pt-schema-change-onlineå’Œghostçš„åšæ³•å— ä¸å¤ªäº†è§£è¿™å—ã€‚ã€‚
1065,fix: fix NPE  ä½¿ç”¨CanalServerWithManageræ—¶ï¼Œå¼€å¯GTIDæ¨¡å¼ä¸‹ï¼Œä¸ä¼ å…¥masterPositionçš„æƒ…â€¦ ä½¿ç”¨CanalServerWithManageræ—¶ï¼Œå¼€å¯GTIDæ¨¡å¼ä¸‹ï¼Œä¸ä¼ å…¥masterPositionçš„æƒ…å†µä¸‹ï¼Œä¼šäº§ç”ŸNPE [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=1065) <br/>All committers have signed the CLA. tks ä½ ä»¬CanalServerWithManagerå¯¹æ¥çš„æ˜¯è‡ªå·±çš„æ§åˆ¶å°ï¼Ÿ @agapple æˆ‘ä»¬æ˜¯åŸºäºcanalåšå¢é‡å’Œå…¨é‡æ•°æ®åŒæ­¥çš„å¹³å° è‡ªå·±åšäº†ä¸€å¥—æ§åˆ¶å°å’¯ï¼Ÿ > è‡ªå·±åšäº†ä¸€å¥—æ§åˆ¶å°å’¯ï¼Ÿ ç›®å‰è¿˜æ²¡æœ‰åšé¡µé¢ï¼Œåªæ˜¯åšäº†æ ¸å¿ƒåŠŸèƒ½
1064,1.1.0ç‰ˆæœ¬golangå®¢æˆ·ç«¯ æŠ¥é”™ä¿¡æ¯ï¼šFatal error: proto: Messages: illegal tag 0 (wire type 0)exit status 1 å¯ä»¥æä¾›ä¸€ä¸‹ä½ æ˜¯æ€ä¹ˆè°ƒç”¨çš„å‘¢ï¼Ÿ  ä½ å¯ä»¥å» [canal-go-issue](https://github.com/CanalClient/canal-go/issues) æissueã€‚ çœ‹äº†ä¸€ä¸‹ï¼Œè¿™ä¸ªæŠ¥é”™å‘ç”Ÿåœ¨getæ“ä½œprotoé‚£è¾¹è§£ç çš„æ—¶å€™ï¼Œè€Œä¸”å½“æ—¶æ•°æ®åº“æ²¡æœ‰ä»»ä½•æ“ä½œ æˆ‘è¿™è¾¹æµ‹è¯•æ˜¯passçš„å–”ï¼Œç°åœ¨ä¾ç„¶æŠ¥é”™å—ï¼Ÿ å¶ç„¶å‡ºç°çš„ï¼Œä¸æ˜¯ä¸€ç›´æœ‰ï¼Œè€Œä¸”å½“æ—¶æ•°æ®åº“æ²¡æœ‰æ“ä½œï¼Œåº”è¯¥æ²¡æœ‰æ•°æ®æ‰å¯¹ å·²ç»è§£å†³
1063,RocketMQåˆ†åŒºå‘é€ æ²¡æœ‰commit RocketMQåˆ†åŒºå‘é€ æ²¡æœ‰commit [https://github.com/alibaba/canal/blob/master/server/src/main/java/com/alibaba/otter/canal/rocketmq/CanalRocketMQProducer.java](url) 
1061,ä¸æ­£å¸¸çš„full gcé—®é¢˜ æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨çš„æ˜¯1.10ç‰ˆæœ¬ï¼Œåšäº†ç®€å•çš„äºŒæ¬¡å¼€å‘å®ç°æ•°æ®å‘é€åˆ°kafkaå¤šåˆ†åŒºï¼Œé€šè¿‡pinpointç›‘æ§å·¥å…·å‘ç°ï¼ŒæœåŠ¡ç«¯åœ¨å †å†…å­˜ä½¿ç”¨åˆ°1.5Gæ—¶å°±ä¼šè§¦å‘full gcï¼Œä½†é»˜è®¤è®¾ç½®æœ€å¤§å¯ç”¨å†…å­˜æ˜¯3Gã€‚æ¶ˆè´¹ç«¯æ²¡æœ‰æ­¤é—®é¢˜ã€‚å¯åŠ¨ç”¨çš„start.shå†…å®¹æ²¡æœ‰ä¿®æ”¹è¿‡ï¼Œå…·ä½“åŸå› æ­£åœ¨æ’æŸ¥ï¼Œè¯·é—®å…¶ä»–äººæ˜¯å¦æœ‰æ­¤é—®é¢˜ã€‚
1060,AdminGuideæ–‡æ¡£æœªæ›´æ–° 1. æ“ä½œç³»ç»Ÿ     a.  çº¯javaå¼€å‘ï¼Œwindows/linuxå‡å¯æ”¯æŒ     b.  jdkå»ºè®®ä½¿ç”¨1.6.25ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œç¨³å®šå¯é ï¼Œç›®å‰é˜¿é‡Œå·´å·´ä½¿ç”¨åŸºæœ¬ä¸ºæ­¤ç‰ˆæœ¬.    2. mysqlè¦æ±‚    a. ç›®å‰canalæ”¯æŒmysql 5.5ç‰ˆæœ¬ä»¥ä¸‹ï¼Œå¯¹mysql5.6æš‚ä¸æ”¯æŒï¼Œ(mysql4.xç‰ˆæœ¬æ²¡æœ‰ç»è¿‡ä¸¥æ ¼æµ‹è¯•ï¼Œç†è®ºä¸Šæ˜¯å¯ä»¥å…¼å®¹)    æ”¹å¥½äº†
1059,CanalConnectoræ¥å£å»æ‰stopRunningæ–¹æ³• CanalConnectoræ¥å£å»æ‰stopRunningæ–¹æ³•  stopRunningæ–¹æ³•ä»…åœ¨å†…éƒ¨è°ƒç”¨
1058,å…³äºDockeræ¨¡å¼çš„ç–‘æƒ‘ 1ã€docker stop container-idåœä¸ä¸‹æ¥å®¹å™¨ï¼› 2ã€ä½¿ç”¨docker rm -f ç§»é™¤å®¹å™¨ï¼Œç„¶è€Œå†æ¬¡ä½¿ç”¨é•œåƒå¯åŠ¨å®¹å™¨æ—¶æ˜¾ç¤ºåˆšæ‰è¢«ç§»é™¤çš„å®¹æ˜“å·²ç»å­˜åœ¨ï¼Œæœ‰æ—¶å€™è¿˜ä¼šå­˜åœ¨11111ç«¯å£è¢«å ï¼Œéœ€è¦ä¿®æ”¹å¯åŠ¨è„šæœ¬é‡Œé¢çš„å®¹å™¨nameæ‰èƒ½å¯åŠ¨å®¹å™¨ï¼› æ±‚è§£é‡Šä¸‹ï¼Œè°¢è°¢ã€‚ dockerçš„åŸºæœ¬æ“ä½œï¼Œç½‘ä¸Šå¤šæ‰¾æ‰¾å§ close
1057,kafka canal-adapter åˆ†å¸ƒå¼å¼€å…³çš„bug è§£å†³åˆ†å¸ƒå¼åŒæ­¥å¼€å…³å…³é—­åŒæ­¥çŠ¶æ€ä¸‹  é‡å¯ kafka canal-adapteråå†å¼€å¯åŒæ­¥ ä¸¢å¤±æ•°æ®çš„bug
1056,group çº¿ç¨‹æ± æ²¡æœ‰åˆå§‹åŒ–çš„bug 
1055,ä»£ç æ•´ç† 
1054,[ISSUE1027]Add flat message support to rocketmq å¢åŠ äº†å¯¹rocketmqå¯¹äºhashåé˜Ÿåˆ—æœ‰åºæ€§æ”¯æŒï¼Œä½¿å…¶å¯ä»¥åˆ†å‘Flat message. tks
1053,canalæ˜¯å¦æ”¯æŒäº‹åŠ¡åˆ†ç»„ åœ¨æ•°æ®åº“æ“ä½œä¸­åŒ…å«äº‹åŠ¡æ€§è´¨çš„å¤šè¡¨æ“ä½œï¼Œåœ¨æ•°æ®è¾“å‡ºçš„æ—¶å€™èƒ½ä¸èƒ½å¯¹è¿™éƒ¨åˆ†æ•°æ®è¿›è¡Œåˆ†ç»„æˆ–æ‰“åŒ…ä¸ºä¸€ä¸ªæ•°æ®åŒ…ã€‚è¿˜æ˜¯è‡ªå·±æ ¹æ®äº‹åŠ¡idè¿›è¡Œåˆ†ç»„ æ•°æ®äº‹åŠ¡æœ‰begin/endè¿›è¡ŒåŒ…è£¹ï¼Œä¸šåŠ¡ä¸Šå¯ä»¥åŸºäºè¿™å—è¿›è¡Œç»„åˆ > æ•°æ®äº‹åŠ¡æœ‰begin/endè¿›è¡ŒåŒ…è£¹ï¼Œä¸šåŠ¡ä¸Šå¯ä»¥åŸºäºè¿™å—è¿›è¡Œç»„åˆ canalæ˜¯å¦æ”¯æŒpythonå¯¹æ¥ï¼Œå°†æ•°æ®åŒæ­¥åˆ°kafka æ–°çš„1.1.1ç‰ˆæœ¬ä¼šæ”¯æŒç›´æ¥å°†æ•°æ®æŠ•é€’åˆ°kafkaï¼Œå¯ç”¨å¯¹åº”kafkaçš„pythonå®¢æˆ·ç«¯è¿›è¡Œæ¶ˆè´¹ > æ–°çš„1.1.1ç‰ˆæœ¬ä¼šæ”¯æŒç›´æ¥å°†æ•°æ®æŠ•é€’åˆ°kafkaï¼Œå¯ç”¨å¯¹åº”kafkaçš„pythonå®¢æˆ·ç«¯è¿›è¡Œæ¶ˆè´¹ è°¢è°¢ï¼Œé‚£æˆ‘ç›´æ¥å¯ä»¥é…ç½®å¥½ä¹‹åé€šè¿‡pythonä»kafkaå–æ•°æ®äº†æ˜¯å§ æ˜¯çš„ > æ˜¯çš„ æˆ‘çœ‹åˆ°GitHubä¸Šçš„1.1.1ç‰ˆæœ¬ä¸­æäº¤è®°å½•å†™é“â€˜å»æ‰kafka serverç«¯TRANSACTIONBEGINå’ŒTRANSACTIONENDçš„åˆ¤æ–­â€™ï¼Œè¿™ä¸ªç‰ˆæœ¬è¦å¤„ç†äº‹åŠ¡æ“ä½œçš„è¯é€šè¿‡ä»€ä¹ˆæ–¹å¼åˆ¤æ–­ï¼Ÿæœ‰äº‹åŠ¡idå—ï¼Ÿ
1052,canalå¯åŠ¨æ­£å¸¸ï¼Œå®¢æˆ·ç«¯å–ä¸åˆ°binlog # mysqlç‰ˆæœ¬ 5.7 # canal 1.1.1 # logs/example/example.log ``` 2018-10-28 09:20:28.615 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [canal.properties] 2018-10-28 09:20:28.630 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [example/instance.properties] 2018-10-28 09:20:28.860 [main] WARN  o.s.beans.GenericTypeAwarePropertyDescriptor - Invalid JavaBean property 'connectionCharset' being accessed! Ambiguous write methods found next to actually used [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.lang.String)]: [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.nio.charset.Charset)] 2018-10-28 09:20:28.967 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [canal.properties] 2018-10-28 09:20:28.967 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [example/instance.properties] 2018-10-28 09:20:29.289 [main] ERROR com.alibaba.druid.pool.DruidDataSource - testWhileIdle is true  validationQuery not set 2018-10-28 09:20:29.736 [main] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start CannalInstance for 1-example 2018-10-28 09:20:29.916 [main] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - subscribe filter change to .*\..* 2018-10-28 09:20:29.916 [main] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - start successful.... 2018-10-28 09:20:29.918 [destination = example   address = /192.168.255.129:3306   EventParser] WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - prepare to find start position just show master status 2018-10-28 09:20:59.976 [New I/O server worker #1-1] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - subscribe filter change to .*\..* 2018-10-28 09:23:20.777 [destination = example   address = /192.168.255.129:3306   EventParser] WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - find start position : EntryPosition[included=false journalName=mysql-bin.000009 position=383 serverId=1 gtid=<null> timestamp=1540689592000] 2018-10-28 09:25:09.385 [New I/O server worker #1-2] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - subscribe filter change to .*\..* ~            ```     canal/canal.logæŠ¥é”™: ``` 2018-10-28 12:13:15.534 [New I/O server worker #1-2] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x26e93058  /192.168.255.1:65515 => /192.168.255.129:11111]  exception=java.io.IOException: Connection reset by peer         at sun.nio.ch.FileDispatcherImpl.read0(Native Method)         at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)         at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)         at sun.nio.ch.IOUtil.read(IOUtil.java:192)         at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)         at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:322)         at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:281)         at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:201)         at org.jboss.netty.util.internal.IoWorkerRunnable.run(IoWorkerRunnable.java:46)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)         at java.lang.Thread.run(Thread.java:748) ``` Connection reset by peer  ä¼°è®¡ç©ºé—²é“¾æ¥è¢«å…³é—­äº† > Connection reset by peer  ä¼°è®¡ç©ºé—²é“¾æ¥è¢«å…³é—­äº† æ€ä¹ˆè§£å†³ï¼Ÿè¯·æŒ‡æ•™ å·²è§£å†³ã€‚
1051,binlogå˜åŒ–clientæ— å“åº” mysqlã€canalå‡ä½¿ç”¨dockeræ–¹å¼éƒ¨ç½²ï¼ŒäºŒè€…å¯åŠ¨éƒ½æ­£å¸¸ï¼Œmysql binlogæ–‡ä»¶æ˜ å°„åœ¨å®¿ä¸»æœºçš„/var/lib/mysql/ç›®å½•ï¼Œæ“ä½œæ•°æ®åº“clientç«¯æ— å“åº”ï¼Œå§‹ç»ˆæ‰“å°empty countï¼Œæ˜¯å¦æ˜¯binlogæ–‡ä»¶ä½ç½®æœ‰é—®é¢˜ï¼Ÿ mysqlç‰ˆæœ¬æ˜¯5.7 ä¸€æ ·çš„é—®é¢˜ æ£€æŸ¥canal serveré‡Œå¯¹åº”çš„æ—¥å¿— æˆ‘æ˜¯ä½¿ç”¨å•æœºæ¨¡å¼ï¼Œéœ€è¦æŠŠparallelå‚æ•°è®¾ç½®æˆfalseï¼Œä½†æ˜¯é”™è¯¯æ—¥å¿—åªæ˜¾ç¤ºä¸€ä¸ªç©ºæŒ‡é’ˆï¼Œé”™è¯¯ä¿¡æ¯æç¤ºä¸å¤ªå‹å¥½
1050,ä¿®æ”¹hbaseé…ç½®é¡¹å 
1049,1.1.1ç‰ˆæœ¬é…ç½®kafka AbstractKafkaTestä¸­çš„groupIdæ˜¯ä»€ä¹ˆ 
1047,tablemeta tsdbæ•°æ®å¢åŠ è¿‡æœŸæ¸…ç†èƒ½åŠ› TableMetaTSDBä»‹ç»ï¼šhttps://github.com/alibaba/canal/wiki/TableMetaTSDB æ€è€ƒçš„é—®é¢˜ï¼štablemetaé»˜è®¤ä¼š24å°æ—¶åšcheckpointç”Ÿæˆä¸€ä»½snapshotæ•°æ®æŒä¹…åŒ–ï¼Œéšç€è¿è¡Œæ—¶é—´è¶Šæ¥è¶Šä¹…ï¼Œsnapshotæ•°æ®ä¼šæŒç»­è†¨èƒ€ï¼Œéœ€è¦å¢åŠ ä¸€ä¸ªexpireçš„ç­–ç•¥ï¼Œå®šæ—¶æ¸…ç†æ‰é™ˆæ—§çš„æ•°æ® è®¾è®¡æ€è·¯ï¼š 1.  å¢åŠ ä¸¤ä¸ªå‚æ•°ï¼šcanal.instance.tsdb.snapshot.interval / canal.instance.tsdb.snapshot.expire 2. åœ¨intervalçš„è¿è¡Œé¢‘ç‡å†…ï¼Œå¯¹è¶…è¿‡expireæ—¶é—´çš„snapshotæ•°æ®åšå®šæ—¶æ¸…ç†ã€‚æ³¨æ„ï¼šè¿™é‡Œä¼šä¿ç•™åˆå§‹åŒ–initçš„ç¬¬ä¸€ä»½snapshot(ç¬¬ä¸€ä»½çš„binlog_timestamp=-1) ï¼Œé¿å…æ‰€æœ‰çš„snapshotæ•°æ®è¢«æ¸…ç†æ‰
1046,åˆ—ç±»å‹æ˜¯tinyint(1) unsignedï¼Œä½†å®é™…æ•°æ®å€¼å¤§äº127æ—¶ï¼Œcanalè·å–çš„åˆ—å€¼é”™è¯¯ åˆ—ç±»å‹æ˜¯tinyint(1) unsignedï¼Œä½†å®é™…æ•°æ®å€¼å¤§äº127ï¼Œåœ¨128ï½255ä¹‹é—´ï¼Œcanalæ˜¯æŒ‰ç…§booleanæ¥å¤„ç†çš„ï¼Œç›´æ¥è½¬åŒ–æˆstringï¼Œå€¼å˜æˆäº†è´Ÿæ•°ã€‚åœ¨LogEventConvert.javaçš„674è¡Œï¼Œå»ºè®®ä¿®æ”¹å¦‚ä¸‹(æœªå……åˆ†æµ‹è¯•)             // if (isSingleBit && javaType == Types.TINYINT) {             //     javaType = Types.BIT;             // }             if (buffer.isNull()) {                 columnBuilder.setIsNull(true);             } else {                 final Serializable value = buffer.getValue();                 if (isSingleBit && javaType == Types.TINYINT && ((Number) value).intValue() >= 0) {                     javaType = Types.BIT;                 }                 //... https://github.com/alibaba/canal/blob/master/parse/src/main/java/com/alibaba/otter/canal/parse/inbound/mysql/dbsync/LogEventConvert.java æ–¹ä¾¿æä¾›ä¸€ä¸‹æµ‹è¯•çš„SQLï¼Ÿ
1045,ä¿®æ”¹æ‰“åŒ…é…ç½® tks
1044,canal è¿‡æ»¤çš„è¡¨è¾¾å¼ Expression is too large. Caused by: com.alibaba.otter.canal.filter.exception.CanalFilterException: org.apache.oro.text.regex.MalformedPatternException: Expression is too large. Caused by: org.apache.oro.text.regex.MalformedPatternException: Expression is too large. 	at org.apache.oro.text.regex.Perl5Compiler.compile(Unknown Source) 	at org.apache.oro.text.regex.Perl5Compiler.compile(Unknown Source) 	at com.alibaba.otter.canal.filter.PatternUtils$1.apply(PatternUtils.java:30) 	at com.alibaba.otter.canal.filter.PatternUtils$1.apply(PatternUtils.java:25) 	at com.google.common.collect.ComputingConcurrentHashMap$ComputingValueReference.compute(ComputingConcurrentHashMap.java:356) 	at com.google.common.collect.ComputingConcurrentHashMap$ComputingSegment.compute(ComputingConcurrentHashMap.java:182) 	at com.google.common.collect.ComputingConcurrentHashMap$ComputingSegment.getOrCompute(ComputingConcurrentHashMap.java:151) 	at com.google.common.collect.ComputingConcurrentHashMap.getOrCompute(ComputingConcurrentHashMap.java:67) 	at com.google.common.collect.MapMaker$ComputingMapAdapter.get(MapMaker.java:885) 	at com.alibaba.otter.canal.filter.PatternUtils.getPattern(PatternUtils.java:41) 	at com.alibaba.otter.canal.filter.aviater.RegexFunction.call(RegexFunction.java:24) 	at Script_1540529734651_0.execute0(Unknown Source) 	at com.googlecode.aviator.ClassExpression.execute(ClassExpression.java:53) 	at com.alibaba.otter.canal.filter.aviater.AviaterRegexFilter.filter(AviaterRegexFilter.java:74) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEventForTableMeta(LogEventConvert.java:456) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor$SimpleParserStage.onEvent(MysqlMultiStageCoprocessor.java:247) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor$SimpleParserStage.onEvent(MysqlMultiStageCoprocessor.java:222) 	at com.lmax.disruptor.BatchEventProcessor.processEvents(BatchEventProcessor.java:168) 	at com.lmax.disruptor.BatchEventProcessor.run(BatchEventProcessor.java:125) 	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) 	at java.util.concurrent.FutureTask.run(FutureTask.java:266) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) 	at java.lang.Thread.run(Thread.java:745) è¿™ä¸ªé—®é¢˜å¾ˆå¥‡æ€ªï¼Œæˆ‘åé¢å†æ‰§è¡Œçš„è¯ï¼Œæ²¡æœ‰é—®é¢˜äº†ã€‚ ä½ çš„è¡¨è¾¾å¼æœ‰å¤šé•¿å•Šï¼Ÿ ç­‰ç­‰å“ˆã€‚æˆ‘å†ä»”ç»†é‡ç°ä¸€ä¸‹ã€‚ æˆ‘debugä¸€ä¸‹ã€‚åœ¨ canal è¡¨è¾¾å¼è®¡ç®—æ¨¡å—ä¸­: pattern="^pub_operation_log2.tb_operation_log_429$|^pub_operation_log2.tb_operation_log_428$|^pub_operation_log0.tb_operation_log_201$|^pub_operation_log2.tb_operation_log_427$|^pub_operation_log0.tb_operation_log_200$|^pub_operation_log2.tb_operation_log_426$|^pub_operation_log2.tb_operation_log_425$|^pub_operation_log2.tb_operation_log_424$|^pub_operation_log0.tb_operation_log_205$|^pub_operation_log2.tb_operation_log_423$|^pub_operation_log0.tb_operation_log_204$|^pub_operation_log2.tb_operation_log_422$|^pub_operation_log0.tb_operation_log_203$|^pub_operation_log2.tb_operation_log_421$|^pub_operation_log0.tb_operation_log_202$|^pub_operation_log2.tb_operation_log_420$|^pub_operation_log0.tb_operation_log_209$|^pub_operation_log0.tb_operation_log_208$|^pub_operation_log0.tb_operation_log_207$|^pub_operation_log0.tb_operation_log_206$|^pub_operation_log2.tb_operation_log_419$|^pub_operation_log2.tb_operation_log_418$|^pub_operation_log2.tb_operation_log_417$|^pub_operation_log2.tb_operation_log_41 ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚" target= "tts_operation_log0.tb_operation_log_244" æˆ‘åœ¨ otter ä¸­é…ç½®äº†å³ä½¿ç”¨äº†åˆ†åº“ä¹Ÿä½¿ç”¨äº†åˆ†è¡¨ï¼š pub_operation_log[0-4] | tb_operation_log_[0-499]   æˆ‘çœ‹äº†ä¸€ä¸‹ï¼Œç¡®å®æ˜¯ ã€‚è¡¨åå¤ªé•¿äº†ï¼Œ2500 ä¸ª^pub_operation_log2.tb_operation_log_417$ ç±»ä¼¼çš„è¿™ç§è¡¨è¾¾å¼ï¼Œæˆ‘åœ¨è·‘demo çš„æ—¶å€™ï¼Œéƒ½è·‘ä¸ä¸‹å»äº†ã€‚ idea ç›´æ¥è¯´ï¼šError:(109  60) java: å¸¸é‡å­—ç¬¦ä¸²è¿‡é•¿ åœ¨ä½¿ç”¨åˆ†åº“åˆ†è¡¨çš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„ä¸‹ï¼šå­—ç¬¦ä¸²ä¸èƒ½å¤ªé•¿ã€‚ ä½ è¿™æ˜¯åˆ†åº“åˆ†è¡¨çš„å§  å¯ä»¥ç”¨æ­£åˆ™åŒ¹é…ä¸€ä¸‹
1043,Canalæ— æ³•è§£æmysql5.6çš„binlogæ±‚å¤§ç¥å¸®å¿™ æ“ä½œç³»ç»Ÿï¼šCentos6.5  æ•°æ®åº“ç‰ˆæœ¬ï¼šmysql5.6 é¦–å…ˆæˆ‘åœ¨mysqlçš„/etc/my.cnfæ–‡ä»¶ä¸­æ·»åŠ åœ¨è¿™ä¸‰æ¡ [mysqld] server-id=1 log-bin=mysql-bin binlog-format=ROW é…ç½®å®ŒæŸ¥çœ‹äº†ä¸€ä¸‹ï¼Œå¦‚å›¾ï¼š ![image](https://user-images.githubusercontent.com/32409300/47547957-f4dfe300-d929-11e8-9cfb-c6bac9679f58.png) ç»™æˆ‘çš„mysqlæ–°å¢çš„äº†ä¸€ä¸ªcanalè´¦æˆ· å¼€å¯äº†æ‰€æœ‰çš„æƒé™ã€‚Repl_slave_priv=Y ![image](https://user-images.githubusercontent.com/32409300/47548081-6750c300-d92a-11e8-942b-9b5bba436b97.png) ç›‘æµ‹canalçš„æ—¥å¿—tail -f logs/example/example.log ï¼Œå¼€å§‹å¯åŠ¨canal  æ—¥å¿—å†…å®¹å¦‚ä¸‹å›¾ï¼š ![image](https://user-images.githubusercontent.com/32409300/47548180-bdbe0180-d92a-11e8-9a64-7608dccd144f.png) æˆ‘çš„canalé…ç½®é¡¹ï¼š ![image](https://user-images.githubusercontent.com/32409300/47548240-05dd2400-d92b-11e8-8dc2-d7a1bced6de3.png) è¿™ä¸ªå‚æ•°ä¸åœ¨æˆªå›¾ä¸­ï¼šcanal.instance.filter.regex=.*\\..* æ‰§è¡ŒsqlæŸ¥çœ‹binlogæ—¥å¿—ä¸­çš„æ–‡ä»¶æ˜¯æœ‰å˜åŒ–çš„ï¼š ![image](https://user-images.githubusercontent.com/32409300/47548333-5785ae80-d92b-11e8-9d0f-5ed4882955b9.png) ä¸Šå›¾ä¸­æŸ¥çœ‹binlogçš„å§¿åŠ¿æœ‰ç‚¹é—®é¢˜ï¼Œæ­£ç¡®çš„å§¿åŠ¿æ˜¯ï¼š/usr/bin/mysqlbinlog -v mysql-bin.000003 ![image](https://user-images.githubusercontent.com/32409300/47548446-a7647580-d92b-11e8-9bd1-69c495fb00b7.png) testæ˜¯æˆ‘çš„æ•°æ®åº“åï¼Œuseræ˜¯æˆ‘çš„è¡¨åã€‚ æˆ‘æ‰§è¡Œå®Œsqlä¹‹å canalæ—¥å¿—æ²¡æœ‰å‘ç”Ÿä»»ä½•æ”¹å˜ã€‚ canalå®¢æˆ·ç«¯å¯ä»¥æ­£å¸¸è¿æ¥åˆ°canalæœåŠ¡ç«¯ã€‚ä½†æ˜¯canalæœåŠ¡ç«¯æ— æ³•æ­£å¸¸è§£æmysqlçš„binlogï¼Œæ±‚å¤§ç¥å¸®å¿™è§£å†³ã€‚ å¦‚æœå“ªé‡Œæè¿°çš„ä¸æ¸…æ™°è¯·å¤§ç¥æŒ‡æ­£ã€‚ exampleå·¥ç¨‹æ˜¯æ‰“å°åˆ°å¦å¤–çš„ç›®å½•çš„ï¼Œä»”ç»†æ‰¾æ‰¾ æ‰“å°åˆ°å¦å¤–çš„ç›®å½•çš„ï¼Ÿå¤§ç¥çš„æ„æ€æ˜¯å¦‚æœäº§ç”Ÿäº†binlogæ—¥å¿—ï¼Œåœ¨logs/example/example.logè¿™ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­æ˜¯çœ‹ä¸åˆ°çš„æ˜¯å— @agapple  ![image](https://user-images.githubusercontent.com/32409300/47554077-1dbca400-d93b-11e8-88ce-4cf6082b9646.png) 
1042,canal adapter readme.md 
1041,canal.example-1.1.0.tar.gzåŒ…ä¸‹çš„startup.batè„šæœ¬æç¤ºå‘½ä»¤è¯­æ³•ä¸æ­£ç¡® æˆ‘ç›®å‰æ˜¯åœ¨windows7ç¯å¢ƒä¸‹è¿›è¡Œæµ‹è¯•çš„ è¯­æ³•æŠ¥é”™çš„å†…å®¹ï¼Œæˆ–è€…æäº¤ä¸€ä¸ªä¿®å¤çš„PRç»™æˆ‘ ![2018-10-29_134009](https://user-images.githubusercontent.com/12081348/47631335-a710e800-db80-11e8-8825-06467c7045da.png) å¾ˆä½çº§çš„é—®é¢˜ï¼ŒåŸºæœ¬çš„batç”¨æ³•ä½ å…ˆgoogleä¸€ä¸‹
1040,canalé›†ç¾¤å½“æŒ‚æ‰ä¸€ä¸ªåzkèŠ‚ç‚¹ä¼šè¢«åˆ é™¤ï¼Œå¦ä¸€ä¸ªseverèµ·æ¥åæ•°æ®ä¼šé‡å¤å— canalé›†ç¾¤å½“æŒ‚æ‰ä¸€ä¸ªåzkèŠ‚ç‚¹ä¼šè¢«åˆ é™¤ï¼Œå¦ä¸€ä¸ªseverèµ·æ¥åæ•°æ®ä¼šé‡å¤å— æ•°æ®ä¼šé‡å¤ > æ•°æ®ä¼šé‡å¤ é‡å¤æ˜¯æ­£å¸¸çš„ï¼Ÿ @agapple  æ— æ³•é¿å…æ•°æ®ä¸é‡å¤ï¼Œå¤šçœ‹wiki
1039,è§„èŒƒæ³¨é‡Š tks
1038,Canal å‘é€åˆ°Kafka Topic æ¶ˆæ¯çš„åŒæ—¶ï¼Œå®ç°Partition åˆ†åŒº Canal 1.1.0 ç‰ˆæœ¬æ¶ˆæ¯å‘é€åˆ°Kafkaçš„åŒæ—¶ï¼Œæ”¯æŒæŒ‡å®šæ¶ˆæ¯æŒ‰Partition Key åˆ†å‘åˆ°ä¸åŒçš„åˆ†åŒºå—ï¼Ÿ https://github.com/alibaba/canal/wiki/Canal-Kafka-RocketMQ-QuickStartï¼Œå³å°†å‘å¸ƒçš„1.1.1æ”¯æŒè¿™æ ·çš„æ•£åˆ—åŠŸèƒ½
1037,å®Œå–„adapter-launcheråŠhbase-adaperç›¸å…³åŠŸèƒ½ å®Œå–„adapter-launcher å®Œå–„hbase-adaper æ–°å¢hbase etlåŠŸèƒ½ å¢åŠ å®¢æˆ·ç«¯åŒæ­¥å¼€å…³  etlåŒæ­¥é”ç­‰åŠŸèƒ½ tks
1036,Dockeréƒ¨ç½²canalåå®¢æˆ·ç«¯è¿æ¥ä¸äº† é¦–å…ˆcanalåœ¨dockerå·²ç»éƒ¨ç½²å¯åŠ¨å®Œæ¯•ï¼ŒæœåŠ¡ç«¯å£11112 ç„¶ådockeræ˜¯æœ‰å®¿ä¸»IP å’Œ è™šæ‹ŸIPï¼Œæœ¬æœºç”µè„‘è®¿é—®æ˜¯é€šè¿‡è™šæ‹ŸIPï¼š192.168.102.111:6633 ç„¶åå®¢æˆ·ç«¯ä½¿ç”¨192.168.102.111:6633è¿æ¥canalï¼Œå¯åŠ¨æœåŠ¡ä¹‹åå®¢æˆ·ç«¯æ¥æ”¶ä¸åˆ°ä¿¡æ¯ï¼Œè€ŒcanalæœåŠ¡ç«¯ä¸€ç›´è¾“å‡ºc.a.otter.canal.server.netty.handler.SessionHandler - message receives in session handler... è¯·é—®IPé—®é¢˜æ€ä¹ˆè§£å†³ï¼Ÿ æŒ‰ç…§Docker QuickStarté‡Œçš„è„šæœ¬ï¼Œå¯åŠ¨ä¸ºhostæ¨¡å¼ï¼Œå¹¶åšç«¯å£æ˜ å°„
1034,å¦‚ä½•å°†canal å®¢æˆ·ç«¯æ¥æ”¶åˆ°çš„CanalEntry è§£ææˆå¯æ‰§è¡Œçš„sql è¯­å¥ Master Mysql A ä¸­æ‰§è¡Œçš„sql  ç„¶å Slave  canal  æ¥æ”¶åˆ°CanalEntry çš„å¯¹è±¡ï¼Œå¦‚ä½•è§£æè¯¥å¯¹è±¡ æˆä¸º å¯æ‰§è¡Œçš„sql  ç„¶ååŒæ­¥åˆ°æ•°æ®åº“ mysql Bä¸­å‘¢ï¼Ÿè´¹äº†å¾ˆå¤§çš„åŠ²æ‹¼è£…sql å‘ç°è‡ªå·±æ‹¼è£…çš„è¦ä¸æƒ…æ™¯ä¸å…¨ï¼Œè¦ä¸å„ç§ç‘•ç–µï¼Œæœ‰æ²¡æœ‰æ–¹ä¾¿çš„æ–¹æ³•å‘¢ï¼Ÿ 1.1.0 ç‰ˆæœ¬ä¸­ DDLæ“ä½œå¯ä»¥ç›´æ¥æ‹¿åˆ°sql  é‚£DMLæ“ä½œæ˜¯å¦å¯ä»¥ç›´æ¥æ‹¿åˆ°sqlå‘¢ï¼Ÿ canal.exampleå·¥ç¨‹é‡Œï¼Œçœ‹ä¸‹åŒæ­¥åˆ°DBçš„æ ·ä¾‹ä»£ç ï¼šhttps://github.com/alibaba/canal/tree/master/example/src/main/java/com/alibaba/otter/canal/example/db
1032,v1.1.1-alpha 1 ç‰ˆæœ¬æ²¡æœ‰æ·»åŠ å¯é…ç½®çš„rowå‚æ•°ï¼Œé»˜è®¤æ˜¯trueã€‚ v1.1.1-alpha 1 ç‰ˆæœ¬æ²¡æœ‰æ·»åŠ å¯é…ç½®çš„rowå‚æ•°ï¼Œé»˜è®¤æ˜¯trueã€‚ ä½¿ç”¨CanalServerWithEmbeddedçš„è¿˜æ˜¯å­˜åœ¨Entryè§£ææ€§èƒ½é—®é¢˜ ![Uploading image.pngâ€¦]() ![image](https://user-images.githubusercontent.com/34024756/47475509-474bd180-d84e-11e8-88f7-bc45e2df4483.png) ![image](https://user-images.githubusercontent.com/34024756/47475517-4f0b7600-d84e-11e8-8266-425e7162b102.png) 
1031,æ–°å¢adapter-launcherå·¥ç¨‹ æ–°å¢adapter-launcher springbootå·¥ç¨‹
1030,å¯åŠ¨ä¸€ç›´ä¸åŠ¨ä¹Ÿä¸æŠ¥é”™ï¼Œæ—¥å¿—æœ‰è¿™ä¸ª 2018-10-24 11:08:47.331 [destination = canal-car   address = rm-m5e5o46l2f13j7an8.mysql.rds.aliyuncs.com/172.31.19.222:3306   EventParser] WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - prepare to find start position just show master status 2018-10-24 11:08:52.651 [destination = canal-car   address = rm-m5e5o46l2f13j7an8.mysql.rds.aliyuncs.com/172.31.19.222:3306   EventParser] WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - find start position : EntryPosition[included=false journalName=mysql- bin.000570 position=1244577 serverId=1797136470 gtid=<null> timestamp=1540350517000] è¿™ä¸ªä¸å½±å“ã€‚
1029,[v1.1.0]åœ¨mysqlä¸Šæ›´æ–°t_canal_tableè¡¨çº¦30wæ¡è®°å½•çš„åŒä¸€å­—æ®µ(å®¹é‡:755B/æ¡ å­—æ®µæ•°é‡ï¼š79)ï¼Œcanalè§£æbin logæŠ¥é”™ï¼šcolumn size is not match for table:  database_canal.t_canal_table 79 vs 78 æ›´æ–°è¯­å¥ï¼šsql = "UPDATE t_canal_table SET update_time= " + "'" + str(datetime.datetime.now()) + "'"  å¼‚å¸¸ä¿¡æ¯ï¼š Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: column size is not match for table:glocalme_css_tcanal.t_css_vsim 79 vs 78 ] 2018-10-10 11:37:10.242 [destination = canalEsInstance   address = /192.168.0.135:3306   EventParser] ERROR c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - dump address 192.168.0.135/192.168.0.135:3306 has an error  retrying. caused by com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. è¡¨å­˜åœ¨ddlåˆ—åˆ é™¤æ“ä½œï¼Œéœ€è¦å¼€å¯TSDBæ‰å¯ä»¥æ”¯æŒ @agapple æ­¤æ“ä½œæ²¡æœ‰è¿›è¡ŒDDLåˆ é™¤æ“ä½œ
1028,Fix Kafka FlatMessage Model Null Value set to "" canal ä½¿ç”¨kafka model ä»¥åŠflatMessage çš„æƒ…å†µä¸‹ï¼Œ æ•°æ®åº“nullå€¼è¢«è®¾ç½®æˆ"". ç°è±¡å¦‚ä¸‹ ![image](https://user-images.githubusercontent.com/7855069/47401555-6d04a800-d774-11e8-99a6-5b89b0338123.png) description ä¸ºnull æƒ…å†µä¸‹ï¼Œkafka message body å€¼ä¸º"" å»ºè®®è¿”å›null  å¦åˆ™varchar ç±»å‹nullæ— æ³•åŒºåˆ† ![image](https://user-images.githubusercontent.com/7855069/47401616-a9d09f00-d774-11e8-9305-e2ba1c94d932.png) [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=1028) <br/>All committers have signed the CLA. [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=1028) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=1028) before we can accept your contribution.<br/><hr/>**titeng.jiang** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=1028) it.</sub>
1027,RocketMQ å¢åŠ å¯¹FlatMessageçš„æ”¯æŒ ä¸ºäº†æå‡rocketmq binlogåˆ†å‘æ€§èƒ½ï¼Œéœ€è¦å¢åŠ æ•°æ®åˆ†ç‰‡æ”¯æŒã€‚ å¦‚æœå¢åŠ äº†åˆ†ç‰‡æ•°æ®ä¸€è‡´æ€§å°±ä¸å¥½ä¿è¯äº† è¿™ä¸ªæ˜¯å¦åˆ†ç‰‡åº”è¯¥æ˜¯æ ¹æ®ç”¨çš„é€‰æ‹©ï¼Œåšåˆ°è¡¨çº§åˆ«æ˜¯å¦å¼€å¯ã€‚é’ˆå¯¹ä¸»é”®ä¸ä¼šå‘ç”Ÿä¿®æ”¹çš„æˆ–è€…åªæ˜¯ç›‘å¬ä¸€ä¸‹äº‹ä»¶æœ¬èº«ä¸å…³æ³¨é¡ºåºçš„ï¼Œåº”è¯¥æ˜¯æ¯”è¾ƒé€‚åˆ ç›®å‰æˆ‘ä»¬è¿™è¾¹æƒ³é’ˆå¯¹æ¯ä¸ªmysqlæ•°æ®åº“å®ä¾‹åšä¸€ä¸ªtopicï¼Œä¸åŒçš„æ•°æ®åº“å®ä¾‹ä¸åŒçš„topicï¼Œç„¶åTagä½¿ç”¨åº“å+è¡¨ååšåŒºåˆ†ã€‚é’ˆå¯¹ä¸ªåˆ«éœ€è¦é¡ºåºçš„tableåšæŒ‡å®šé˜Ÿåˆ—å‘é€ï¼Œå¦‚æœæ­£å¥½æœ¬åº“å°±æœ‰è¿™æ ·çš„è¡¨é‚£å°±æ•´ä¸ªåº“éƒ½æ˜¯å‘é€åˆ°ä¸€ä¸ªé˜Ÿåˆ—çš„ï¼Œéœ€è¦å°†å¯¹åº”é…ç½®è½¬ç§»åˆ°expmleä¸­è¿›è¡Œé…ç½® ä»£ç å·²æäº¤
1026,canal varchar nullå¤„ç† ä½¿ç”¨canal-kafkaï¼Œæ”¶åˆ°æ¶ˆæ¯ï¼Œcolumnå€¼ä¸ºnullè¢«è®¾ç½®æˆ""   int   date ç±»å‹æ”¶åˆ°"" å¯ä»¥é»˜è®¤ç†è§£ä¸ºnull å¯¹äºvarchar  textç±»å‹å¦‚ä½•åŒºåˆ† nullå’Œ"" å•ä¸ªcolumnå¯¹è±¡æœ‰ä¸ªgetisNullçš„æ–¹æ³•æ¥åˆ¤æ–­è¿™ä¸ªåˆ—å¯¹åº”çš„valueæ˜¯ä¸æ˜¯null CanalEntry.Column è¿™ä¸ªç±» LSæ­£è§£
1025,destination:user_cards[com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.TableIdNotFoundException: not found tableId:21005 ç¯å¢ƒï¼šUbuntu 16.04 jdkï¼š1.8 canalç¯å¢ƒï¼šä¸€ä¸ªcanal serverï¼Œä¸¤ä¸ªinstanceï¼Œ canalç‰ˆæœ¬ï¼šcanal.kafka-1.1.0 å‡ºç°é—®é¢˜åŸå› ï¼š 1ã€åˆ é™¤zkä¸Š/otter znode  ç›®çš„ï¼šé‡ç½®instanceçš„binlog fileå’ŒPosition è¯¦ç»†æ—¥å¿—ï¼š 2018-10-23 16:05:48.880 [pool-6-thread-2] ERROR com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter - process error! java.lang.NullPointerException: null 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.calculateSize(MemoryEventStoreWithBuffer.java:555) ~[canal.store-1.1.0.jar:na] 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.doGet(MemoryEventStoreWithBuffer.java:322) ~[canal.store-1.1.0.jar:na] 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.tryGet(MemoryEventStoreWithBuffer.java:261) ~[canal.store-1.1.0.jar:na] 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getEvents(CanalServerWithEmbedded.java:478) ~[canal.server-1.1.0.jar:na] 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:310) ~[canal.server-1.1.0.jar:na] 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:273) ~[canal.server-1.1.0.jar:na] 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter.worker(CanalKafkaStarter.java:121) [canal.kafka-1.1.0.jar:na] 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter.access$000(CanalKafkaStarter.java:26) [canal.kafka-1.1.0.jar:na] 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter$1.run(CanalKafkaStarter.java:70) [canal.kafka-1.1.0.jar:na] 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_181] 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_181] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_181] 2018-10-23 16:05:48.881 [pool-6-thread-2] INFO  com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter - ## the canal consumer user_cards is running now ...... 2018-10-23 16:05:48.881 [pool-6-thread-2] ERROR com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter - process error! java.lang.NullPointerException: null 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.calculateSize(MemoryEventStoreWithBuffer.java:555) ~[canal.store-1.1.0.jar:na] 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.doGet(MemoryEventStoreWithBuffer.java:322) ~[canal.store-1.1.0.jar:na] 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.tryGet(MemoryEventStoreWithBuffer.java:261) ~[canal.store-1.1.0.jar:na] 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getEvents(CanalServerWithEmbedded.java:478) ~[canal.server-1.1.0.jar:na] 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:310) ~[canal.server-1.1.0.jar:na] 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:273) ~[canal.server-1.1.0.jar:na] 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter.worker(CanalKafkaStarter.java:121) [canal.kafka-1.1.0.jar:na] 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter.access$000(CanalKafkaStarter.java:26) [canal.kafka-1.1.0.jar:na] 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter$1.run(CanalKafkaStarter.java:70) [canal.kafka-1.1.0.jar:na] 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_181] 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_181] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_181] æˆ‘æš´åŠ›çš„åˆ é™¤çš„äº†zkä¸­çš„znodeï¼Œé‡å¯canalçš„æ—¶å€™ä»–ä¼šé‡æ–°åŠ è½½instanceå’Œcanal serverçš„é…ç½®ä¹ˆï¼Ÿ åœæ­¢canal serverï¼Œå†åˆ é™¤zknodeï¼Œæœ€åé‡å¯ï¼Œè¿™æ ·å¯ä»¥ç”Ÿæ•ˆinstanceé‡Œçš„ä½ç‚¹å®šä¹‰ã€‚  ps.  ä¸ºä»€ä¹ˆéœ€è¦åœæ­¢serverå†åˆ é™¤ï¼Œå› ä¸ºserverå¦‚æœä¸åœæ­¢ä¼šæœ‰å®šæ—¶åˆ·æ–°zknodeï¼Œæ‰€ä»¥æå‰åˆ é™¤zknodeæ²¡ä»»ä½•æ„ä¹‰ btwï¼Œæˆ‘åœæ­¢canal serverä¹‹åï¼Œåˆ é™¤znodeï¼Œç„¶åå†ä»ä¸Šæ¸¸æ•°æ®åº“show master statusæ‹¿å‡ºæ¥binlog fileå’ŒPositionï¼Œé‡å¯canal serveræ²¡é—®é¢˜ï¼Œcanal serverå’Œinstanceéƒ½ä¸æŠ¥é”™ï¼› ä½†æ˜¯ï¼Œä¸€æ—¦ä¸Šæ¸¸åº“æœ‰updateæ“ä½œï¼Œcanal serverä¼šä¸€ç›´æŠ¥è¿™ä¸ªé”™ï¼Œinstanceä¸æŠ¥é”™ ã€‚ ç”¨æœ€æ–°çš„v1.1.1çš„ç‰ˆæœ¬  canal.deployeréƒ¨ç½²ä¸€ä¸‹kafkaçš„åŒæ­¥   å·²çŸ¥é—®é¢˜ä¿®å¤äº†.  ps.  æ–°ç‰ˆæœ¬å·²ç»åˆå¹¶äº†canal.kafkaå·¥ç¨‹åˆ°canal.deployerä¸­  ä¸»è¦ä¿®æ”¹ä¸€ä¸‹canal.propertiesé‡Œçš„canal.serverMode=kafkaå³å¯ è¿™ä¸ªé—®é¢˜ï¼Œè°¢è°¢ 2018-10-23 22:02:58.642 [pool-4-thread-1] ERROR com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter - process error! java.lang.NullPointerException: null 	at com.alibaba.otter.canal.store.helper.CanalEventUtils.createPosition(CanalEventUtils.java:69) ~[canal.store-1.1.0.jar:na] 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.getFirstPosition(MemoryEventStoreWithBuffer.java:375) ~[canal.store-1.1.0.jar:na] 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.getFirstPosition(MemoryEventStoreWithBuffer.java:36) ~[canal.store-1.1.0.jar:na] 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:307) ~[canal.server-1.1.0.jar:na] 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:273) ~[canal.server-1.1.0.jar:na] 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter.worker(CanalKafkaStarter.java:121) [canal.kafka-1.1.0.jar:na] 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter.access$000(CanalKafkaStarter.java:26) [canal.kafka-1.1.0.jar:na] 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter$1.run(CanalKafkaStarter.java:70) [canal.kafka-1.1.0.jar:na] 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [na:1.8.0_131] 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [na:1.8.0_131] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_131]
1024,canal æ€ä¹ˆæ”¯æŒDRDSæ•°æ®åº“ [destination = example1   address = *************************:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Received error packet: errno = 1047  sqlstate = HY000 errmsg = [dc26f11c5801000][172.16.22.194:3306][zbtsteam_test]Unknown command @daoshunli canalæ˜¯æ¨¡æ‹Ÿmysqlçš„binlog dumpåè®®ï¼ŒDRDSç›®å‰æ²¡æœ‰å¯¹binlogåè®®æœ‰ç›´æ¥æ”¯æŒï¼Œå¯ä»¥ç›´è¿DRDSåº•ä¸‹çš„RDSæ¥ç›´æ¥è®¢é˜…
1023,c.a.o.canal.parse.inbound.mysql.dbsync.LogEventConvert - table parser error WARN  c.a.o.canal.parse.inbound.mysql.dbsync.LogEventConvert - table parser error : header{} ä»Šå¤©çªç„¶é‡åˆ°è¿™æ ·ä¸€ä¸ªå¼‚å¸¸ï¼Œå¯¼è‡´è¿™å¼ è¡¨åŒæ­¥ä¸æˆåŠŸã€‚ ä¹‹å‰è¿˜æ˜¯æ­£å¸¸çš„ï¼Œä»Šå¤©çªç„¶å‘ç°æœ‰è¿™ä¸ªå¼‚å¸¸ï¼Œæ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ ä¼°è®¡æ˜¯binlogé‡Œå¯¹åº”çš„è¡¨è¢«åˆ é™¤ï¼Œé‡ç½®ä½ç‚¹è·³è¿‡ï¼Œåç»­å¯ä»¥å¼€å¯TSDBæ¥è§„é¿
1022,FlatMessageç›´æ¥ç”Ÿäº§åˆ°kafkaï¼Œç„¶åkafkaæ¶ˆè´¹ç«¯è§£ææ•ˆç‡ä¸æ˜¯æ›´é«˜ä¹ˆï¼Œæ„Ÿè§‰probufæ¯”jsonè§£ææ•ˆç‡é«˜å•Š å¯¹è±¡åºåˆ—åŒ–ä¼šæœ‰å¾ˆå¤šç±»ä¿¡æ¯æ¶ˆæ¯ä½“å¤§æ¦‚æ¯”jsonå¤§äº†3å€  ååé‡ä¸‹é™æ˜æ˜¾
1021,1.0.24 canal hvæ¨¡å¼ä¸‹è§£æmysql timestampé—®é¢˜ å•æœºæƒ…å†µä¸‹è§£æmysql timestamp æ•°æ®è¿”å›æ˜¯æ­£ç¡® å®ä¾‹ï¼š mysql æ—¶é—´ 2018-10-19 19:09:09 å•æœºè§£æè¿‡æ¥ï¼Œcanalè·å–åˆ°æ˜¯ 2018-10-19 19:09:09            hvæ¨¡å¼ä¸‹ è§£æè·å–åˆ°ä¸º2018-10-19 07:02:09 ç›¸å·®ä¸º12å°æ—¶ å•æœºå’Œhvä¸ºåŒä¸€ä¸ªæœåŠ¡å™¨ hvä¸‰å°æœåŠ¡å™¨æ—¶é—´å‡ä¸ºCTCæ—¶åŒº æ—¶é—´ä¹Ÿæ˜¯æ­£ç¡®çš„ï¼Œæœ‰æ²¡æœ‰å¤§ä½¬çŸ¥é“æ˜¯ä»€ä¹ˆé—®é¢˜å¯¼è‡´            hvæ˜¯å•¥ï¼Ÿcanalæ˜¯ä»¥binlogé‡Œçš„æ•°æ®ä¸ºå‡†ï¼Œå¯ä»¥å…ˆé€šè¿‡mysqlbinlogçœ‹ä¸€ä¸‹åŸå§‹binlogæ•°æ® æ‰“é”™äº† HAæ¨¡å¼ï¼Œæ˜¨å¤©é‚®ç®±ä¸€ç›´éªŒè¯ä¸äº†ï¼Œå°±æ²¡å›å¤ã€‚æ˜¨å¤©å› ä¸ºç”Ÿäº§ç¯å¢ƒé—®é¢˜ï¼Œæˆ‘åœ¨æµ‹è¯•ç¯å¢ƒé‡æ–°å®‰è£…äº†canalç¯å¢ƒï¼ŒHAæ¨¡å¼ä¸‹è§£ætimestampç±»å‹æ˜¯æ²¡é—®é¢˜çš„ã€‚
1020,canal-kafka æ•°æ®åŒæ­¥åˆ°kafkaä¹‹åï¼Œkafka topicä¹±ç  ![default](https://user-images.githubusercontent.com/6134206/47210704-34587d80-d3c6-11e8-805c-0c7ed3772058.png) canalå¯åŠ¨ä¹‹åï¼Œæ•°æ®èƒ½åŒæ­¥åˆ°kafka ä½†æ˜¯åŒæ­¥çš„æ•°æ®ä¹±ç  canalç‰ˆæœ¬æ˜¯ï¼š1.1.0ï¼Œå•èŠ‚ç‚¹éƒ¨ç½²çš„ï¼Œæœ¬åœ°æŸ¥çœ‹topicä¹±ç  kafkaé»˜è®¤ä¼ è¾“çš„æ˜¯åºåˆ—åŒ–Messageå­—èŠ‚ç  ä¸æ˜¯å¯è§å­—ç¬¦ éœ€ç”¨clientä¸­çš„kafkaæ¨¡å—ååºåˆ—åŒ–ä¸ºMessage å–”ï¼Œå¥½çš„ åœ¨ä¸‹ä¸ªç‰ˆæœ¬ä¼šæ”¯æŒStringå’ŒMessage ä½ å¯ä»¥æ”¹åŠ¨canal-serverçš„åŒ…ä¸­kafkaç›¸å…³å‘é€ä»£ç (å‚ç…§ä¸»åˆ†æ”¯çš„ä»£ç  æœ‰æä¾›) å…ˆç”¨ç€ ç­‰æ–°ç‰ˆæœ¬å‡ºæ¥åå°±å¥½äº†. åœ¨ä¸‹ä¸ªç‰ˆæœ¬ä¼šæ”¯æŒStringå’ŒMessage ä½ å¯ä»¥æ”¹åŠ¨canal-serverçš„åŒ…ä¸­kafkaç›¸å…³å‘é€ä»£ç (å‚ç…§ä¸»åˆ†æ”¯çš„ä»£ç  æœ‰æä¾›) å…ˆç”¨ç€ ç­‰æ–°ç‰ˆæœ¬å‡ºæ¥åå°±å¥½äº†. æˆ‘ç”¨çš„pythonå®¢æˆ·ç«¯æ¶ˆè´¹kafkaï¼Œå¸Œæœ›èƒ½æ”¯æŒæ˜æ–‡å‘é€jsonæ•°æ®å¯¼kafkaï¼Œæ–¹ä¾¿æ¶ˆè´¹ï¼Œä¸ç”¨è€ƒè™‘ååºåˆ—åŒ–çš„é—®é¢˜ã€‚
1019,canal 1.1.0 çš„Entryè§£ææ€§èƒ½é—®é¢˜ è¿™é‡Œentry.toByteString()æ˜¯åŸºäºä»€ä¹ˆè€ƒè™‘ï¼Ÿæˆ‘ä»¬ä»canal 1.0.24å‡çº§åˆ°1.1.0ï¼Œå‘ç°æ€§èƒ½å·®äº†å¾ˆå¤šã€‚ æˆ‘çœ‹åˆ°è¿™ä¸ªåœ°æ–¹ï¼Œå·²ç»æ‹¿åˆ°Entryå¯¹è±¡äº†ï¼Œåº”è¯¥å¯ä»¥ç¼“å­˜èµ·æ¥ï¼Œè¿™æ ·ä¸šåŠ¡ä¸Šå°±ä¸éœ€è¦å†æ¬¡åšä¸€æ¬¡parseäº†ã€‚ ```     public Event(LogIdentity logIdentity  CanalEntry.Entry entry){         this.logIdentity = logIdentity;         this.entryType = entry.getEntryType();         this.executeTime = entry.getHeader().getExecuteTime();         this.journalName = entry.getHeader().getLogfileName();         this.position = entry.getHeader().getLogfileOffset();         this.serverId = entry.getHeader().getServerId();         this.gtid = entry.getHeader().getGtid();         this.eventType = entry.getHeader().getEventType();         // build raw         this.rawEntry = entry.toByteString();         this.rawLength = rawEntry.size();         if (entryType == EntryType.ROWDATA) {             List<CanalEntry.Pair> props = entry.getHeader().getPropsList();             if (props != null) {                 for (CanalEntry.Pair p : props) {                     if ("rowsCount".equals(p.getKey())) {                         rowsCount = Integer.parseInt(p.getValue());                         break;                     }                 }             }         }     } ``` ç±»ä¼¼çš„è¿˜æœ‰è¿™é‡Œï¼Œå…¶å®å·²ç»æœ‰RowChangeäº†ï¼Œä½†æ˜¯éƒ½è¢«åºåˆ—åŒ–æˆbytesäº†ã€‚ ```             RowChange rowChange = rowChangeBuider.build();             if (tableError) {                 Entry entry = createEntry(header  EntryType.ROWDATA  ByteString.EMPTY);                 logger.warn("table parser error : {}storeValue: {}"  entry.toString()  rowChange.toString());                 return null;             } else {                 Entry entry = createEntry(header  EntryType.ROWDATA  rowChange.toByteString());                 return entry;             } ``` æˆ‘ä»¬ç”¨çš„æ˜¯ CanalServerWithEmbedded entry.toByteString()ä¸»è¦æ˜¯é’ˆå¯¹server/clientè¿™æ ·çš„éƒ¨ç½²æ¨¡å¼ï¼Œé¿å…åœ¨client.getæ“ä½œæ—¶åºåˆ—åŒ–å‘¨æœŸè¿‡é•¿å¯¼è‡´client tpsä¸Šä¸å» å¯ä»¥è€ƒè™‘å¢åŠ ä¸€ä¸ªé…ç½®ï¼Œå…è®¸ä¿ç•™entryå¯¹è±¡ï¼Œè¿™æ ·ä¼šå¸¦æ¥å†…å­˜ä¸Šçš„é¢å¤–å¼€é”€
1017,1.1.0ç‰ˆæœ¬çš„canalçš„RDSé…ç½®å±æ€§   æ”¯æŒä½¿ç”¨managerçš„æ–¹æ³•ä¹ˆï¼Ÿ canalInstanceWithManager è¿™ç§å½¢å¼çš„é…ç½® æ˜¯ä¸æ˜¯è¿˜ä¸æ”¯æŒRDSæ–°åŠ çš„é‚£3ä¸ªé…ç½® å¯ä»¥è€ƒè™‘æäº¤ä¸€ä¸ªPRç»™æˆ‘ å·²ä¿®å¤
1016,æ¯å¤©é‡åˆ°ä¸€æ¬¡ should execute connector.connect() first å¼‚å¸¸ï¼Œæ˜¯ä»€ä¹ˆåŸå› ã€‚ otteræ¯å¤©é‡åˆ°ä¸€æ¬¡ä¸‹é¢çš„å¼‚å¸¸ï¼Œçœ‹å †æ ˆæ˜¯è¿æ¥ä¸­æ–­ï¼Œéœ€è¦é‡è”ã€‚ ä½†æ˜¯é‡åˆ°è¿™ç§é”™è¯¯ï¼Œæœ‰æ—¶åŒæ­¥è¿…é€Ÿå°±æ¢å¤äº†ï¼Œæœ‰æ—¶åŒæ­¥ä¼šä¸­æ–­10åˆ†é’Ÿå·¦å³ã€‚æ˜¯ä»€ä¹ˆåŸå› ï¼Œå¦‚ä½•è§£å†³ï¼Ÿ pid:4 nid:3 exception:canal:hd_canal_236:com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first Caused by: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first     at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4832)     at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:160)     at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:759)     at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:428)     at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:114)     at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:66)     at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:337)     at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:184)     at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:145)     at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220)     at java.lang.Thread.run(Thread.java:724) Caused by: java.io.IOException: should execute connector.connect() first     at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.(MysqlQueryExecutor.java:30)     at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:87)     at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMetaByDB(TableMetaCache.java:80)     at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.access$000(TableMetaCache.java:30)     at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:55)     at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:50)     at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3527)     at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2319)     at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2282)     at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2197)     at com.google.common.cache.LocalCache.get(LocalCache.java:3937)     at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3941)     at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4824)     at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4830) å¯¹åº”çš„otterç‰ˆæœ¬æ˜¯å•¥ï¼Ÿ å»ºè®®å‡çº§æœ€æ–°ç‰ˆï¼Œå·²æœ‰å¤„ç†
1015,æ±‚æŒ‡å¯¼ï¼šcanalè·å–çš„äº‹åŠ¡å·(tranactionID)å’Œmysqlä¸­çš„äº‹åŠ¡å·(transactionID)ä¸ä¸€è‡´ï¼Œå¦‚ä½•è§£å†³ï¼Ÿ  1.canalçš„transactionIDè·å–æ–¹æ³•ï¼š TransactionEnd txEnd = TransactionEnd.parseFrom(entry.getStoreValue()); String txID = txEnd.getTransactionId(); ç»“æœï¼š46 2. mysqlä¸­æŸ¥è¯¢ç»“æœï¼š Trx id counter 88363                          ä½ mysqlä¸­æ€ä¹ˆä¸€ä¸ªæŸ¥è¯¢åŠæ³•ï¼Ÿæ˜¯ä»mysqlbinlogå‘½ä»¤ä¸­è·å–ï¼Ÿ è°¢è°¢æ‚¨çš„å›å¤ï¼ä¸å¥½æ„æ€ï¼Œä¹‹å‰æŸ¥è¯¢çš„æ–¹æ³•é”™äº†ã€‚canalè·å–çš„transactionIDæ²¡æœ‰é—®é¢˜ã€‚ ç°ä½¿ç”¨çš„æŸ¥è¯¢æ–¹æ³•ï¼š sudo mysqlbinlog --no-defaults  /usr/local/mysql/data/mysql-bin.000149 åªæ˜¯MySQLçš„DDLè¯­å¥æ˜¯éäº‹åŠ¡çš„ï¼Œä¸èƒ½å¯¹DLLè¯­å¥è¿›è¡Œå›æ»šæ“ä½œï¼Œè¯·é—®canalæ˜¯å¦‚ä½•å¤„ç†ddlçš„å‘¢ï¼Ÿ canalåªæ˜¯è§£æbinlogé‡Œçš„DDLï¼Œbinlogé‡Œè®°å½•çš„å†…å®¹å·²ç»äº‹åŠ¡æäº¤æˆåŠŸçš„
1014,ä¿®å¤é€šè¿‡`show master status`è·å–åˆ°å¤šä¸ªGTID æ—¶ï¼Œå›è½¦ç¬¦å¯¼è‡´UUID è§£æå¤±è´¥çš„bug as title tks
1013,canal.kafka ç”¨bin/kafka-console-consumer.shå‘½ä»¤æ”¶åˆ°ä¹±ç  åœ¨mysqlæ•°æ®åº“ä¸­æ’å…¥ä¸€æ¡è®°å½•åï¼Œç”¨å‘½ä»¤bin/kafka-console-consumer.sh --zookeeper 192.168.206.128:2181 --topic canal1 --from-beginningï¼Œçœ‹åˆ°æ¶ˆè´¹ç«¯è¾“å‡ºä¹±ç ï¼š `*: mysql-bin.000027*UTF-80BJP229 *7 mysql-bin.000027*UTF-80BJPF mysql-bin.000027*UTF-80Bcan_dbJ      user_testP+Xb         _-+_C-+++1Pb_id (0B6Ri++(11)                                                        +a+e (0BdafdR                                                                         +a_cha_(40)age (0B15Ri++(11): +y_-+-bi+.000027 *UTF-80 8BJP261 *7 +y_-+-bi+.000027 *UTF-80 8BJPF  +y_-+-bi+.000027 *UTF-80 8Bca+_dbJ      +_e__+e_+P*Xb         _-+_C-+++1Pb^id (0B7Ri++(11)                                                        +a+e (0BeeeR                                                                        +a_cha_(40)age (0B11Ri++(11): +y_-+-bi+.000027 *UTF-80 8BJP262` ç„¶åçœ‹äº†kafka-clientä¸­çš„ä»£ç ï¼Œæ”¹äº†AbstractKafkaTest.javaç›¸åº”çš„é…ç½®å‚æ•°ï¼Œå¦‚ `public static String  topic     = "canal1";     public static Integer partition = 0;     public static String  groupId   = "";     public static String  servers   = "192.168.206.128:6667";     public static String  zkServers = "192.168.206.128:2181";` åï¼Œå½“å¾€mysqlä¸­æ’å…¥æ–°è®°å½•åï¼Œä½†è¿è¡ŒKafkaClientRunningTest.javaæ²¡æœ‰æ”¶åˆ°æ•°æ®åŒ…ã€‚å„ä½æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™ç§æƒ…å†µã€‚ canal kafka æ¨¡å¼é»˜è®¤æ˜¯å‘é€Messageå¯¹è±¡çš„åºåˆ—åŒ–å­—èŠ‚ä¸æ˜¯å¯è§å­—ç¬¦ä¸² clientæ¥æ”¶åˆ°ä¼šååºåˆ—åŒ–. å¦‚è¦å‘é€å¯è§å­—ç¬¦ä¸² è¯·ç”¨ flatMessageæ¨¡å¼ å°†ä¼šå‘é€jsonæ ¼å¼æ•°æ® @brightsong æˆ‘è¿™è¾¹ä¹Ÿç¢°åˆ°ä¸€æ ·çš„é—®é¢˜ã€‚è¯·é—®ä½ çš„é—®é¢˜è§£å†³äº†å—ï¼Ÿ > åœ¨mysqlæ•°æ®åº“ä¸­æ’å…¥ä¸€æ¡è®°å½•åï¼Œç”¨å‘½ä»¤bin/kafka-console-consumer.sh --zookeeper 192.168.206.128:2181 --topic canal1 --from-beginningï¼Œçœ‹åˆ°æ¶ˆè´¹ç«¯è¾“å‡ºä¹±ç ï¼š > `ï¿½*ï¿½ï¿½: ï¿½ï¿½ï¿½mysql-bin.000027ï¿½*UTF-80BJPï¿½ï¿½ï¿½ï¿½229 ï¿½*ï¿½7 ï¿½ï¿½ï¿½mysql-bin.000027ï¿½*UTF-80BJPFï¿½ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½ï¿½mysql-bin.000027ï¿½*UTF-80Bï¿½can_dbJ user_testP+Xï¿½b _-+_C-+++ï¿½ï¿½1ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Pb_ï¿½ï¿½ï¿½ï¿½ï¿½id ï¿½(ï¿½0Bï¿½6Ri++(11)ï¿½ï¿½ï¿½ ï¿½ï¿½+a+e (ï¿½0Bï¿½dafdR +a_cha_(40)ï¿½ï¿½ï¿½ï¿½ï¿½age (ï¿½0Bï¿½15Ri++(11)ï¿½: ï¿½ï¿½ï¿½+y_-+-bi+.000027ï¿½ï¿½ ï¿½*UTF-80 8ï¿½BJPï¿½ï¿½ï¿½ï¿½261 ï¿½*ï¿½ï¿½7 ï¿½ï¿½ï¿½+y_-+-bi+.000027ï¿½ï¿½ ï¿½*UTF-80 8ï¿½BJPFï¿½ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½+y_-+-bi+.000027ï¿½ï¿½ ï¿½*UTF-80 8ï¿½Bï¿½ca+_dbJ +_e__+e_+P*Xï¿½b _-+_C-+++ï¿½ï¿½1ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Pb^ï¿½ï¿½ï¿½ï¿½ï¿½id ï¿½(ï¿½0Bï¿½7Ri++(11)ï¿½ï¿½ï¿½ ï¿½ï¿½+a+e (ï¿½0Bï¿½eeeR +a_cha_(40)ï¿½ï¿½ï¿½ï¿½ï¿½age (ï¿½0Bï¿½11Ri++(11)ï¿½: ï¿½ï¿½ï¿½+y_-+-bi+.000027ï¿½ï¿½ ï¿½*UTF-80 8ï¿½BJPï¿½ï¿½ï¿½ï¿½262` > ç„¶åçœ‹äº†kafka-clientä¸­çš„ä»£ç ï¼Œæ”¹äº†AbstractKafkaTest.javaç›¸åº”çš„é…ç½®å‚æ•°ï¼Œå¦‚ > `public static String topic = "canal1"; public static Integer partition = 0; public static String groupId = ""; public static String servers = "192.168.206.128:6667"; public static String zkServers = "192.168.206.128:2181";` > åï¼Œå½“å¾€mysqlä¸­æ’å…¥æ–°è®°å½•åï¼Œä½†è¿è¡ŒKafkaClientRunningTest.javaæ²¡æœ‰æ”¶åˆ°æ•°æ®åŒ…ã€‚å„ä½æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™ç§æƒ…å†µã€‚ æˆ‘å’Œä½ ä¸€æ ·é‡åˆ°ç›¸åŒçš„é—®é¢˜ã€‚å½“æŠŠæ¥æ”¶æ ¼å¼æ”¹ä¸ºConsumerRecords<String  String> å¯ä»¥æ¥æ”¶åˆ°è¾“å‡ºï¼Œä½†æ˜¯åŸç”Ÿçš„ConsumerRecords<String  Message> æ²¡æœ‰æ¶ˆæ¯ã€‚è¯·é—®ä½ çš„é—®é¢˜è§£å†³äº†å—ï¼Ÿ > canal kafka æ¨¡å¼é»˜è®¤æ˜¯å‘é€Messageå¯¹è±¡çš„åºåˆ—åŒ–å­—èŠ‚ä¸æ˜¯å¯è§å­—ç¬¦ä¸² clientæ¥æ”¶åˆ°ä¼šååºåˆ—åŒ–. > å¦‚è¦å‘é€å¯è§å­—ç¬¦ä¸² è¯·ç”¨ flatMessageæ¨¡å¼ å°†ä¼šå‘é€jsonæ ¼å¼æ•°æ® è¯·é—®å¯¹åº”çš„æ˜¯å“ªä¸ªé…ç½®æ–‡ä»¶ä¸­çš„å“ªä¸ªé…ç½®é¡¹çš„å‘¢ï¼Ÿ è§£å†³äº†ï¼ŒæŠŠè™šæ‹Ÿæœºcpuæ”¹çš„å¤§ä¸€ç‚¹å°±å¯ä»¥äº†ã€‚å¦‚æœä¸è¡Œå†ä¿®æ”¹canal.instance.parser.parallel å‚æ•°ã€‚ åœ¨ 2018-10-22 11:06:28ï¼Œ"jkl0898" <notifications@github.com> å†™é“ï¼š @brightsong æˆ‘è¿™è¾¹ä¹Ÿç¢°åˆ°ä¸€æ ·çš„é—®é¢˜ã€‚è¯·é—®ä½ çš„é—®é¢˜è§£å†³äº†å—ï¼Ÿ åœ¨mysqlæ•°æ®åº“ä¸­æ’å…¥ä¸€æ¡è®°å½•åï¼Œç”¨å‘½ä»¤bin/kafka-console-consumer.sh --zookeeper 192.168.206.128:2181 --topic canal1 --from-beginningï¼Œçœ‹åˆ°æ¶ˆè´¹ç«¯è¾“å‡ºä¹±ç ï¼š ï¿½*ï¿½ï¿½: ï¿½ï¿½ï¿½mysql-bin.000027ï¿½*UTF-80BJPï¿½ï¿½ï¿½ï¿½229 ï¿½*ï¿½7 ï¿½ï¿½ï¿½mysql-bin.000027ï¿½*UTF-80BJPFï¿½ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½ï¿½mysql-bin.000027ï¿½*UTF-80Bï¿½can_dbJ user_testP+Xï¿½b _-+_C-+++ï¿½ï¿½1ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Pb_ï¿½ï¿½ï¿½ï¿½ï¿½id ï¿½(ï¿½0Bï¿½6Ri++(11)ï¿½ï¿½ï¿½ ï¿½ï¿½+a+e (ï¿½0Bï¿½dafdR +a_cha_(40)ï¿½ï¿½ï¿½ï¿½ï¿½age (ï¿½0Bï¿½15Ri++(11)ï¿½: ï¿½ï¿½ï¿½+y_-+-bi+.000027ï¿½ï¿½ ï¿½*UTF-80 8ï¿½BJPï¿½ï¿½ï¿½ï¿½261 ï¿½*ï¿½ï¿½7 ï¿½ï¿½ï¿½+y_-+-bi+.000027ï¿½ï¿½ ï¿½*UTF-80 8ï¿½BJPFï¿½ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½+y_-+-bi+.000027ï¿½ï¿½ ï¿½*UTF-80 8ï¿½Bï¿½ca+_dbJ +_e__+e_+P*Xï¿½b _-+_C-+++ï¿½ï¿½1ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Pb^ï¿½ï¿½ï¿½ï¿½ï¿½id ï¿½(ï¿½0Bï¿½7Ri++(11)ï¿½ï¿½ï¿½ ï¿½ï¿½+a+e (ï¿½0Bï¿½eeeR +a_cha_(40)ï¿½ï¿½ï¿½ï¿½ï¿½age (ï¿½0Bï¿½11Ri++(11)ï¿½: ï¿½ï¿½ï¿½+y_-+-bi+.000027ï¿½ï¿½ ï¿½*UTF-80 8ï¿½BJPï¿½ï¿½ï¿½ï¿½262 ç„¶åçœ‹äº†kafka-clientä¸­çš„ä»£ç ï¼Œæ”¹äº†AbstractKafkaTest.javaç›¸åº”çš„é…ç½®å‚æ•°ï¼Œå¦‚ public static String topic = "canal1"; public static Integer partition = 0; public static String groupId = ""; public static String servers = "192.168.206.128:6667"; public static String zkServers = "192.168.206.128:2181"; åï¼Œå½“å¾€mysqlä¸­æ’å…¥æ–°è®°å½•åï¼Œä½†è¿è¡ŒKafkaClientRunningTest.javaæ²¡æœ‰æ”¶åˆ°æ•°æ®åŒ…ã€‚å„ä½æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™ç§æƒ…å†µã€‚ æˆ‘å’Œä½ ä¸€æ ·é‡åˆ°ç›¸åŒçš„é—®é¢˜ã€‚å½“æŠŠæ¥æ”¶æ ¼å¼æ”¹ä¸ºConsumerRecords<String  String> å¯ä»¥æ¥æ”¶åˆ°è¾“å‡ºï¼Œä½†æ˜¯åŸç”Ÿçš„ConsumerRecords<String  Message> æ²¡æœ‰æ¶ˆæ¯ã€‚è¯·é—®ä½ çš„é—®é¢˜è§£å†³äº†å—ï¼Ÿ â€” You are receiving this because you were mentioned. Reply to this email directly  view it on GitHub  or mute the thread. ä¸å¥½æ„æ€ï¼Œçœ‹é”™äº†ï¼Œæš‚æ—¶è¿˜æ²¡æœ‰è§£å†³ åœ¨ 2018-10-22 11:06:28ï¼Œ"jkl0898" <notifications@github.com> å†™é“ï¼š @brightsong æˆ‘è¿™è¾¹ä¹Ÿç¢°åˆ°ä¸€æ ·çš„é—®é¢˜ã€‚è¯·é—®ä½ çš„é—®é¢˜è§£å†³äº†å—ï¼Ÿ åœ¨mysqlæ•°æ®åº“ä¸­æ’å…¥ä¸€æ¡è®°å½•åï¼Œç”¨å‘½ä»¤bin/kafka-console-consumer.sh --zookeeper 192.168.206.128:2181 --topic canal1 --from-beginningï¼Œçœ‹åˆ°æ¶ˆè´¹ç«¯è¾“å‡ºä¹±ç ï¼š ï¿½*ï¿½ï¿½: ï¿½ï¿½ï¿½mysql-bin.000027ï¿½*UTF-80BJPï¿½ï¿½ï¿½ï¿½229 ï¿½*ï¿½7 ï¿½ï¿½ï¿½mysql-bin.000027ï¿½*UTF-80BJPFï¿½ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½ï¿½mysql-bin.000027ï¿½*UTF-80Bï¿½can_dbJ user_testP+Xï¿½b _-+_C-+++ï¿½ï¿½1ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Pb_ï¿½ï¿½ï¿½ï¿½ï¿½id ï¿½(ï¿½0Bï¿½6Ri++(11)ï¿½ï¿½ï¿½ ï¿½ï¿½+a+e (ï¿½0Bï¿½dafdR +a_cha_(40)ï¿½ï¿½ï¿½ï¿½ï¿½age (ï¿½0Bï¿½15Ri++(11)ï¿½: ï¿½ï¿½ï¿½+y_-+-bi+.000027ï¿½ï¿½ ï¿½*UTF-80 8ï¿½BJPï¿½ï¿½ï¿½ï¿½261 ï¿½*ï¿½ï¿½7 ï¿½ï¿½ï¿½+y_-+-bi+.000027ï¿½ï¿½ ï¿½*UTF-80 8ï¿½BJPFï¿½ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½+y_-+-bi+.000027ï¿½ï¿½ ï¿½*UTF-80 8ï¿½Bï¿½ca+_dbJ +_e__+e_+P*Xï¿½b _-+_C-+++ï¿½ï¿½1ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Pb^ï¿½ï¿½ï¿½ï¿½ï¿½id ï¿½(ï¿½0Bï¿½7Ri++(11)ï¿½ï¿½ï¿½ ï¿½ï¿½+a+e (ï¿½0Bï¿½eeeR +a_cha_(40)ï¿½ï¿½ï¿½ï¿½ï¿½age (ï¿½0Bï¿½11Ri++(11)ï¿½: ï¿½ï¿½ï¿½+y_-+-bi+.000027ï¿½ï¿½ ï¿½*UTF-80 8ï¿½BJPï¿½ï¿½ï¿½ï¿½262 ç„¶åçœ‹äº†kafka-clientä¸­çš„ä»£ç ï¼Œæ”¹äº†AbstractKafkaTest.javaç›¸åº”çš„é…ç½®å‚æ•°ï¼Œå¦‚ public static String topic = "canal1"; public static Integer partition = 0; public static String groupId = ""; public static String servers = "192.168.206.128:6667"; public static String zkServers = "192.168.206.128:2181"; åï¼Œå½“å¾€mysqlä¸­æ’å…¥æ–°è®°å½•åï¼Œä½†è¿è¡ŒKafkaClientRunningTest.javaæ²¡æœ‰æ”¶åˆ°æ•°æ®åŒ…ã€‚å„ä½æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™ç§æƒ…å†µã€‚ æˆ‘å’Œä½ ä¸€æ ·é‡åˆ°ç›¸åŒçš„é—®é¢˜ã€‚å½“æŠŠæ¥æ”¶æ ¼å¼æ”¹ä¸ºConsumerRecords<String  String> å¯ä»¥æ¥æ”¶åˆ°è¾“å‡ºï¼Œä½†æ˜¯åŸç”Ÿçš„ConsumerRecords<String  Message> æ²¡æœ‰æ¶ˆæ¯ã€‚è¯·é—®ä½ çš„é—®é¢˜è§£å†³äº†å—ï¼Ÿ â€” You are receiving this because you were mentioned. Reply to this email directly  view it on GitHub  or mute the thread. > canal kafka æ¨¡å¼é»˜è®¤æ˜¯å‘é€Messageå¯¹è±¡çš„åºåˆ—åŒ–å­—èŠ‚ä¸æ˜¯å¯è§å­—ç¬¦ä¸² clientæ¥æ”¶åˆ°ä¼šååºåˆ—åŒ–. > å¦‚è¦å‘é€å¯è§å­—ç¬¦ä¸² è¯·ç”¨ flatMessageæ¨¡å¼ å°†ä¼šå‘é€jsonæ ¼å¼æ•°æ® è¯·é—®åœ¨å“ªé‡Œå¯ä»¥é…ç½®å‘¢ï¼Ÿ æˆ‘ä¹Ÿæ²¡æœ‰é…ç½®ï¼Œæˆ‘æ˜¯è¿™æ ·çš„ï¼Œæ¥å—åˆ°Messageå¯¹è±¡åï¼Œè§£æé‡Œé¢çš„å†…å®¹ï¼Œç„¶åæŠŠå†…å®¹æ”¾åœ¨jsonä¸­å‘é€åˆ°å¦ä¸€ä¸ªkafkaä¸­ã€‚ åœ¨ 2018-10-23 17:12:59ï¼Œ"liugaozy" <notifications@github.com> å†™é“ï¼š canal kafka æ¨¡å¼é»˜è®¤æ˜¯å‘é€Messageå¯¹è±¡çš„åºåˆ—åŒ–å­—èŠ‚ä¸æ˜¯å¯è§å­—ç¬¦ä¸² clientæ¥æ”¶åˆ°ä¼šååºåˆ—åŒ–. å¦‚è¦å‘é€å¯è§å­—ç¬¦ä¸² è¯·ç”¨ flatMessageæ¨¡å¼ å°†ä¼šå‘é€jsonæ ¼å¼æ•°æ® è¯·é—®åœ¨å“ªé‡Œå¯ä»¥é…ç½®å‘¢ï¼Ÿ â€” You are receiving this because you were mentioned. Reply to this email directly  view it on GitHub  or mute the thread.
1012,canalèƒ½è·å–mysqlä¸­LSNï¼ˆLog sequence numberï¼‰å—ï¼Ÿ binlogæ²¡æœ‰è¿™ è¿™æ ·å•Šï¼Œè°¢è°¢
1011,Kafkaæ¨¡å¼ï¼Œclient offsetä¸å‰è¿› Kafkaæ¨¡å¼ï¼Œclient offsetä¸å‰è¿›ï¼Œæ¥æ¥å›å›å°±æ¶ˆè´¹é‚£ä¹ˆå‡ æ¡æ•°æ®ï¼Œæ²¡æŠ¥é”™
1010,æœ€æ–°1.1.1-SNAPSHOTå¯ç”¨gtidæ¨¡å¼ï¼Œè¿˜æ˜¯ä¼šæŠ¥é”™errno = 1236 1.1.1-SNAPSHOTç‰ˆæœ¬å¯ç”¨gtidæ¨¡å¼ã€‚æºæ•°æ®åº“gtid_purgedæœ‰å€¼ï¼Œå¯åŠ¨åæŠ¥é”™ã€‚æ— æ³•åŒæ­¥ ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = The slave is connecting using CHANGE MASTER TO MASTER_AUTO_POSITION = 1  but the master has purged binary logs containing GTIDs that the slave requires. at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:102) æ‹¿ç€è¿™å¼‚å¸¸åŒºgoogleï¼Œmysqlé…ç½®é—®é¢˜ > æ‹¿ç€è¿™å¼‚å¸¸åŒºgoogleï¼Œmysqlé…ç½®é—®é¢˜ mysqlæ˜¯é…ç½®çš„gtidæ¨¡å¼ï¼Œgtid_purgedä¹Ÿæœ‰å€¼ã€‚ç½‘ä¸Šæœç´¢æ­¤é”™è¯¯å¾—åˆ°çš„è§£å†³æ–¹æ¡ˆéƒ½æ˜¯ï¼šåœæ­¢slaveåŒæ­¥ç„¶ååœ¨slaveä¸Šè®¾ç½®gtid_purgedã€‚ ä½†å¯¹äºæ¨¡æ‹Ÿslaveçš„canalæ¥è¯´è¦å¦‚ä½•è®¾ç½®gtid_purgedå‘¢ï¼Ÿ https://dev.mysql.com/doc/refman/5.6/en/replication-mode-change-online-enable-gtids.html å‚è€ƒè¿™ä¸ªæ“ä½œè®¾ç½®mysql server
1009,meta.dat not update [canal 1.1.0]  Canal server and client consumes data normally  but the timestamp and content of meta.dat not change  which will cause an exception 'Could not find first log file name in binary log index file' when restart canal server. Pls check the configurations in attachment. [instance.log](https://github.com/alibaba/canal/files/2486428/instance.log) [canal.log](https://github.com/alibaba/canal/files/2486429/canal.log) Could not find first log file name in binary log index file     ä»£è¡¨mysqlä¸»æœºä¸Šbinlogå·²è¢«åˆ é™¤ I got more information with adding log in canal server. something unexpected occurs the updateCursor does not execute. ![image](https://user-images.githubusercontent.com/9636488/47079731-b9ae2780-d238-11e8-8fe6-41fedf6ac8df.png) finally  I compile a new canal server with source code and deploy  the meta.dat was updated normally.
1008,å¯¹äºmysql enumç±»å‹ canalé»˜è®¤è¿”å›intï¼ˆå³1ï¼Œ2ï¼Œ3ï¼Œ...ï¼‰ï¼Œå¦‚ä½•è¿”å›enumä¸­çš„valueï¼Ÿ å¯¹äºmysql enumç±»å‹ canalé»˜è®¤è¿”å›intï¼ˆå³1ï¼Œ2ï¼Œ3ï¼Œ...ï¼‰ï¼Œç°éœ€è¦canalè¿”å›enumç±»å‹å­—æ®µçš„å…·ä½“å€¼valueï¼Œå¦‚ä½•å®ç°å‘¢ï¼Ÿ // *********** æˆ‘ä¹‹å‰çš„åšæ³•ï¼š 1. ä¿®æ”¹parseræ¨¡å—çš„rowslogbufferçš„mysqlToJavaTypeæ–¹æ³•ï¼Œå¯¹äºenumè¿”å›Types.CHAR;  2. ä¿®æ”¹rowslogbufferçš„fetchValueæ–¹æ³•ï¼Œå¯¹äºenumç±»å‹æŒ‰ç…§stringç±»å‹ä¿®æ”¹ï¼Œå³è¿”å›stringï¼Œä½†æ˜¯æŠ¥é”™ï¼š Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: java.lang.IllegalArgumentException: limit excceed: 63 	at com.taobao.tddl.dbsync.binlog.LogBuffer.getFullString(LogBuffer.java:1122) <img width="1125" alt="enum1" src="https://user-images.githubusercontent.com/28953872/47005872-44beed00-d167-11e8-83a9-bb56a2cae283.png"> <img width="1121" alt="enum2" src="https://user-images.githubusercontent.com/28953872/47005873-45578380-d167-11e8-8512-1b0eee9b05cc.png"> <img width="981" alt="enum3" src="https://user-images.githubusercontent.com/28953872/47005875-45578380-d167-11e8-84a4-b942af2f2816.png"> è¯·æ•™å¤§ç¥è¯¥å¦‚ä½•ä¿®æ”¹å‘¢ï¼Ÿ ä¸è¦åœ¨binlogè§£æé‡Œä¿®æ”¹ï¼Œå¯ä»¥åœ¨å¤–å›´æ‹¿åˆ°è¡¨ç»“æ„ï¼ŒåŸºäºintä¸‹è¡¨æ‰¾åˆ°å…·ä½“çš„æ–‡æœ¬è¿›è¡Œæ›¿æ¢ï¼Œæ¯”å¦‚LogEventConvert å¤§ç¥ï¼Œæ‚¨è¯´çš„â€œæ‰¾åˆ°å…·ä½“çš„æ–‡æœ¬è¿›è¡Œæ›¿æ¢â€æ˜¯ä¸æ˜¯æŒ‡â€œæ ¹æ®enumçš„ä¸‹æ ‡ç´¢å¼•ä»fieldMeta.getColumnType()ä¸­è§£æå¯¹åº”çš„å†…å®¹â€ï¼Ÿå¦‚ä¸‹æ‰€ç¤ºï¼š fieldMeta.getColumnType() is: enum('100' '200' '300' '400' '500' '600') >>>>>> columnType.startsWith("enum") >>>>>> String.valueOf(value): 3 ä»'100' '200' '300' '400' '500' '600'ä¸­è§£æç¬¬3ä¸ªå…ƒç´ 300ï¼Ÿ ä½†è¿™æ ·ä¸‡ä¸€enumä¸­çš„å…ƒç´ åŒ…å«ç‰¹æ®Šå­—ç¬¦æ¯”å¦‚é€—å· æˆ–è€…å•å¼•å·'æ€ä¹ˆåŠï¼Ÿ è¿˜æ˜¯è¯´æœ‰å…¶ä»–çš„åŠæ³•ï¼Ÿ æ±‚æŒ‡æ•™ï¼ @agapple  æšä¸¾ç‰¹æ®Šå­—ç¬¦çš„å„ç§æƒ…å†µï¼Œå®é™…æµ‹è¯•ä¸€ä¸‹ å¥½çš„ï¼Œè°¢è°¢æŒ‡å¯¼ï¼
1007,restart canal-server  canal stuck at at sun.nio.ch.Net.poll(Native Method) Server and client works normally  restart server   client will disconnect and try to connect and subscribe  while I found client thread stuck. Do someone have got this  or come up with some ideas about this. Callstack and information as follow: 2018-10-16 10:01:41  ERROR [CustomCanalClient]  Main Loop outter Exception.com.alibaba.otter.canal.protocol.exception.CanalClientException: java.io.IOException: end of stream when reading header 2018-10-16 10:01:41  WARN [HttpConnectionPool] object == null 2018-10-16 10:01:41  TRACEBACK [CustomCanalClient]com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:317)  com.alibaba.otter.canal.custom.CustomCanalClient.process(CustomCanalClient.java:106)  com.alibaba.otter.canal.custom.CustomCanalClient$1.run(CustomCanalClient.java:67)  java.lang.Thread.run(Thread.java:748)  2018-10-16 10:01:43  ERROR [CustomCanalClient]  Main Loop outter Exception.com.alibaba.otter.canal.protocol.exception.CanalClientException: java.net.ConnectException: Connection refused 2018-10-16 10:01:43  WARN [HttpConnectionPool] object == null 2018-10-16 10:01:43  TRACEBACK [CustomCanalClient]com.alibaba.otter.canal.client.impl.SimpleCanalConnector.doConnect(SimpleCanalConnector.java:190)  com.alibaba.otter.canal.client.impl.SimpleCanalConnector.connect(SimpleCanalConnector.java:114)  com.alibaba.otter.canal.custom.CustomCanalClient.process(CustomCanalClient.java:101)  com.alibaba.otter.canal.custom.CustomCanalClient$1.run(CustomCanalClient.java:67)  java.lang.Thread.run(Thread.java:748)    java.lang.Thread.State: RUNNABLE         at sun.nio.ch.Net.poll(Native Method)         at sun.nio.ch.SocketChannelImpl.poll(SocketChannelImpl.java:954)         - locked <0x0000000094054d90> (a java.lang.Object)         at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:204)         - locked <0x0000000094054d80> (a java.lang.Object)         at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)         - locked <0x0000000094054e98> (a sun.nio.ch.SocketAdaptor$SocketInputStream)         at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)         - locked <0x0000000094054f08> (a java.lang.Object)         at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.read(SimpleCanalConnector.java:429)         at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.readNextPacket(SimpleCanalConnector.java:419)         - locked <0x00000000c038e900> (a java.lang.Object)         at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.readNextPacket(SimpleCanalConnector.java:403)         at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.receiveMessages(SimpleCanalConnector.java:322)         at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:315)         at com.alibaba.otter.canal.custom.CustomCanalClient.process(CustomCanalClient.java:106)         at com.alibaba.otter.canal.custom.CustomCanalClient$1.run(CustomCanalClient.java:67)         at java.lang.Thread.run(Thread.java:748) client example : https://github.com/alibaba/canal/blob/master/example/src/main/java/com/alibaba/otter/canal/example/SimpleCanalClientTest.java [jstack_log.log](https://github.com/alibaba/canal/files/2481661/jstack_log.log) I add a shell script 'test.sh' to start canal.example.SimpleCanalClientTest class  but the same result comes out. ![image](https://user-images.githubusercontent.com/834743/46998952-b3e01580-d156-11e8-89a9-5f964f6e4eb9.png) if no binlog message    you can add sleep time . ex : Thread.sleep(1000) Thank you
1006,support  golang canal client  address  link as title tks
1005,binlog-rows-query-log-events=1 ä¸­çš„queryeventäº‹ä»¶å°‘åº“åï¼Œrowæ•°æ®å°‘GTID 5.6æ•°æ®åº“ä¸­å«æœ‰é…ç½® binlog-rows-query-log-events=1 ä¸­çš„queryeventäº‹ä»¶å°‘åº“åï¼Œrowæ•°æ®å°‘GTIDã€‚æˆ‘çœ‹äº†binlogï¼Œbinlogä¸­ç¡®å®ä¹Ÿå°‘è¿™ä¿©ï¼Œcanalèƒ½å¸®æŠŠè¿™ä¿©å±æ€§è¡¥å…¨äº†å—ï¼Ÿ header {   version: 1   logfileName: "mysql-bin.000945"   logfileOffset: 430773470   serverId: 1346306   serverenCode: "UTF-8"   executeTime: 1539165635000   sourceType: MYSQL   schemaName: ""    ----------------------------å°‘åº“å   tableName: "product_sc_id"   eventLength: 374   eventType: QUERY   gtid: "816fb525-8e3c-11e7-b7b0-525400730122:1-212612172 73aa9f66-8e18-11e7-b6c5-525400730120:1-358980 b064380d-0559-11e6-b5be-005056996b87:1-1593948705" } entryType: ROWDATA storeValue: "xxx"  header {------------------------å°‘gtid   version: 1   logfileName: "mysql-bin.000945"   logfileOffset: 430773918   serverId: 1346306   serverenCode: "UTF-8"   executeTime: 1539165635000   sourceType: MYSQL   schemaName: "gome_jiaoyu"   tableName: "product_sc_id"   eventLength: 126   eventType: UPDATE   props {     key: "rowsCount"     value: "1"   } } entryType: ROWDATA storeValue: "xxx" binlog-rows-query-log-events schemaæ²¡æ³•è·å–åˆ°ï¼Œbinlogé‡Œå°±æ²¡æœ‰ ROWDATAé‡Œå¢åŠ gtidé‡Œå·²æ·»åŠ ï¼Œä¸è¿‡éœ€è¦ç†è§£gtidçš„ä¸€ä¸ªè¯­ä¹‰ï¼Œå¦‚æœæ˜¯äº‹åŠ¡ä¸­çš„ä¸€è¡Œè®°å½•gtidä¸ºä½ç‚¹ï¼Œä¼šé€ æˆå‘é€ç»™mysqlä¹‹åï¼Œä¸¢å¼ƒå½“å‰äº‹åŠ¡çš„å‰©ä½™è®°å½•.  
1004,æ”¯æŒMysql8ä¹ˆ æœ‰æµ‹è¿‡æ”¯æŒMysql8ä¹ˆ ç›®å‰ä¸æ”¯æŒ mysql8 é‚£æ”¯æŒçš„mysqlæœ€é«˜ç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Ÿ å¤šçœ‹wiki
1003,Canalå†™kafkaçš„é€»è¾‘æ²¡æœ‰è€ƒè™‘kafkaçš„message sizeé™åˆ¶? https://github.com/alibaba/canal/blob/e4b6385dcc439fcf495c81b0c0f89da858dd377b/server/src/main/java/com/alibaba/otter/canal/kafka/CanalKafkaProducer.java#L104-L113 å¦‚æœéœ€è¦å‘é€çš„recordå¤§å°è¶…è¿‡kafkaé™åˆ¶(é»˜è®¤1MB)  æ˜¯ä¸æ˜¯æ— æ³•ç»§ç»­å¤„ç†? æˆ‘æ˜¯è‡ªå·±å¤„ç†çš„ canal batchSizeé…ç½®ä¸è¦è¶…è¿‡1M ``` servers: localhost:9092 #for rocketmq: means the nameserver retries: 0 batchSize: 16384 lingerMs: 1 bufferMemory: 33554432 # Canalçš„batch size  é»˜è®¤50K  ç”±äºkafkaæœ€å¤§æ¶ˆæ¯ä½“é™åˆ¶è¯·å‹¿è¶…è¿‡1M(900Kä»¥ä¸‹) canalBatchSize: 50 ``` @rewerma ä½ å¥½ï¼Œè¿˜æ˜¯æœ‰äº›ç–‘æƒ‘éœ€è¦è¯·æ•™ä¸€ä¸‹ã€‚ canalBatchSizeæ„ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Œ æ§åˆ¶çš„ç²’åº¦æ˜¯äº‹åŠ¡çº§åˆ« or event çº§åˆ« or rowçº§åˆ« or å­—æ®µçº§åˆ«ï¼Ÿå¦‚æœæŸä¸ªå­—æ®µå°±è¶…è¿‡äº†1Mï¼Œ å¦‚ä½•å¤„ç†å‘¢ã€‚ canalBatchSizeæ˜¯æ‹‰å–canalæ‹‰å–çš„å‘é€çš„æ‰¹å¤§å° å…·ä½“è¯·å‚è€ƒcanal çš„é…ç½®è¯´æ˜ å¦‚æœæœ‰å•ä¸ªå­—æ®µå¤§äº1Mçš„æƒ…å†µæš‚æ—¶å¯ä»¥å…ˆè°ƒæ•´kafkaçš„æ¶ˆæ¯ä½“é™åˆ¶ä¸Šé™
1002,1. AbstractEventParser ä¸­åº”è¯¥å¯¹multiStageCoprocessæ¯æ¬¡åœ¨whileæœ€åè¿›è¡Œstopè€Œä¸æ˜¯reseâ€¦ 1. AbstractEventParser ä¸­åº”è¯¥å¯¹multiStageCoprocessæ¯æ¬¡åœ¨whileæœ€åè¿›è¡Œstopè€Œä¸æ˜¯resetï¼Œ resetä¼šåœ¨mysqlMultiStageCoprocessorä¸­start()é‡æ–°åˆ›å»ºä¸¤ä¸ªçº¿ç¨‹æ± ï¼Œ å¦‚æœåœ¨dumpå‡ºé”™çš„æƒ…å†µä¸‹ï¼Œ ä¼šæ— é™å¤šçš„åˆ›å»ºçº¿ç¨‹æ± è€Œä¸”ä¸stopä¸terminalï¼Œ å¯¼è‡´ç³»ç»Ÿèµ„æºè¢«å ç”¨å®Œæ¯•     æ³¨æ„whileå¾ªç¯æ¯æ¬¡éƒ½ä¼šåˆ›å»ºæ–°çš„mysqlMultiStageCoprocessor 2. MySqlMultiStageComprocessorä¸­åœ¨stopæ—¶çº¿ç¨‹æ± éœ€è¦åˆ¤æ–­æ˜¯å¦å·²ç»shutdownï¼Œ å®é™…æƒ…å†µä¸­å­˜åœ¨çº¿ç¨‹æ± shutdownä¸ºtrueè€Œterminalä¸€ç›´ä¸ºfalseçš„æƒ…å†µ [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=1002) <br/>All committers have signed the CLA. tks
1001,ä½¿ç”¨ docker éƒ¨ç½² canal-server æ— æ³•ä½¿ç”¨ docker-restart å‘½ä»¤ - ç°è±¡ å½“ä½¿ç”¨ docker éƒ¨ç½²å®˜æ–¹ canal-server é•œåƒï¼ˆcanal/canal-server:v1.1.0ï¼‰å¹¶æˆåŠŸå¯åŠ¨åï¼Œè°ƒç”¨ ```shell docker restart ``` ä¼šæœ‰ä»¥ä¸‹é”™è¯¯ä¿¡æ¯ï¼š ```log mv: cannot stat `/home/admin/canal-server/conf/example': No such file or directory ``` - åŸå›  æ£€æŸ¥ docker å¯åŠ¨è„šæœ¬ï¼Œå‘ç° https://github.com/alibaba/canal/blob/master/docker/image/admin/app.sh çš„ 84-92 è¡Œå¼•å‘çš„é”™è¯¯ï¼š ```shell destination=`perl -le 'print $ENV{"canal.destinations"}'` if [[ "$destination" =~ ' ' ]]; then     echo "multi destination:$destination is not support"     exit 1; else     if [ "$destination" != "" ] && [ "$destination" != "example" ] ; then         mv /home/admin/canal-server/conf/example /home/admin/canal-server/conf/$destination     fi  fi ``` è¿™é‡Œçš„è¡Œä¸ºæ˜¯æ¯æ¬¡å¯åŠ¨æ—¶ï¼Œå¦‚æœæŒ‡å®šäº† destination ä¸” destination çš„å€¼ä¸æ˜¯ exampleï¼Œä¼šæŠŠ ```path /home/admin/canal-server/conf/example ``` ç›®å½•é‡å‘½åä¸ºæŒ‡å®šçš„ destination å€¼ã€‚ ç”±äºæˆ‘æŒ‡å®šäº† destination ä¸”å€¼ä¸æ˜¯ exampleï¼Œæ‰€ä»¥è¿™ä¸ªè¡Œä¸ºå¯¼è‡´äº†æ‰§è¡Œ ```shell docker restart ``` æ—¶ï¼Œç”±äºå®¹å™¨å†…å·²ç»æ²¡æœ‰ example æ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥å®¹å™¨æ— æ³•å¯åŠ¨ã€‚ - é—®é¢˜ å„ä½å¤§ä½¬æ˜¯å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜çš„ï¼Ÿè‡ªå·±æ‰“é•œåƒè¿˜æ˜¯æœ‰å…¶ä»–å§¿åŠ¿ï¼Ÿ ä½ å¯ä»¥å†™ä¸€ä¸ª docker-composeçš„ymlï¼Œæ˜ å°„ä¸€ä¸‹å³å¯ï¼Œå¯ä»¥å‚è€ƒä¸‹æˆ‘å†™çš„[docker-compose.yml](https://github.com/CanalSharp/CanalSharp/blob/692672b5e7ecec9c91019cd254a1e73adfea7289/docker/docker-compose.yml) mvæ“ä½œåšäº†ä¸‹åˆ¤æ–­ç›®å½•å­˜åœ¨å¤„ç† > ä½ å¯ä»¥å†™ä¸€ä¸ª docker-composeçš„ymlï¼Œæ˜ å°„ä¸€ä¸‹å³å¯ï¼Œå¯ä»¥å‚è€ƒä¸‹æˆ‘å†™çš„[docker-compose.yml](https://github.com/CanalSharp/CanalSharp/blob/692672b5e7ecec9c91019cd254a1e73adfea7289/docker/docker-compose.yml) @WithLin è¯•è¿‡è¿™ç§æ–¹æ³•ï¼Œä½†æ˜¯é‡å¯æ—¶ä¼šæŠ¥å…¶ä»–é”™è¯¯ï¼š ```log server_1  | mv: cannot move `/home/admin/canal-server/conf/example' to `/home/admin/canal-server/conf/uc': Device or resource busy ```
1000,è§£æä½ç‚¹è®°å½•ä½¿ç”¨FileMixedLogPositionManageræ—¶ï¼Œå¯åŠ¨ä¸äº† ç‰ˆæœ¬ï¼š1.1.0 mysqlï¼š5.6.36 `æ‰€æœ‰é…ç½®åªä¿®æ”¹ä¸¤å¤„ï¼Œä¸€ä¸ªæ˜¯exampleä¸­é…ç½®çš„mysqlçš„ipï¼športï¼Œå¦å¤–ä¸€å¤„å°±æ˜¯spring/file-instance.xml ï¼Œå¦‚ä¸‹ï¼š` <!-- è§£æä½ç‚¹è®°å½• -->         <property name="logPositionManager">             <bean class="com.alibaba.otter.canal.parse.index.FailbackLogPositionManager">                 <constructor-arg>                     <bean class="com.alibaba.otter.canal.parse.index.FileMixedLogPositionManager" >                         <constructor-arg index="0" value="/tmp/parse.dat" />                         <constructor-arg index="1" value="2000" />                         <constructor-arg index="2" ref="memoryLogPositionManager"/>                     </bean>                 </constructor-arg>                 <constructor-arg>                     <bean class="com.alibaba.otter.canal.parse.index.MetaLogPositionManager">                         <constructor-arg ref="metaManager"/>                     </bean>                 </constructor-arg>             </bean>         </property> `memoryLogPositionManagerå®šä¹‰ï¼š`   `<bean id="memoryLogPositionManager" class="com.alibaba.otter.canal.parse.index.MemoryLogPositionManager" />` æŠ¥é”™å¦‚ä¸‹ï¼š 2018-10-12 15:46:57.245 [destination = example   address = /127.0.0.1:3307   EventParser] ERROR c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - dump address /127.0.0.1:3307 has an error  retrying. caused by  java.lang.NullPointerException: null         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPositionInternal(MysqlEventParser.java:480) ~[canal.parse-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPosition(MysqlEventParser.java:362) ~[canal.parse-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:182) ~[canal.parse-1.1.0.jar:na]         at java.lang.Thread.run(Thread.java:748) [na:1.8.0_171] 2018-10-12 15:46:57.258 [destination = example   address = /127.0.0.1:3307   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.lang.NullPointerException         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPositionInternal(MysqlEventParser.java:480)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPosition(MysqlEventParser.java:362)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:182)         at java.lang.Thread.run(Thread.java:748) ] `springçš„åŸæœ¬é…ç½®ï¼š(ä¿æŒåŸæœ¬é…ç½®ï¼Œæ­¤æ—¶å¯åŠ¨ä¸€åˆ‡æ­£å¸¸)` <!-- è§£æä½ç‚¹è®°å½• -->         <property name="logPositionManager">             <bean class="com.alibaba.otter.canal.parse.index.FailbackLogPositionManager">                 <constructor-arg>                     <bean class="com.alibaba.otter.canal.parse.index.MemoryLogPositionManager" />                 </constructor-arg>                 <constructor-arg>                     <bean class="com.alibaba.otter.canal.parse.index.MetaLogPositionManager">                         <constructor-arg ref="metaManager"/>                     </bean>                 </constructor-arg>             </bean>         </property> com.alibaba.otter.canal.parse.index.FileMixedLogPositionManagerè¿™é‡Œè¦æ±‚dataDiræ˜¯ä¸€ä¸ªæ ¹è·¯å¾„ï¼ŒæŸ¥æ‰¾datæ–‡ä»¶æ—¶ï¼Œä¼šæ˜¯è¿™æ ·çš„ä¸€ä¸ªè·¯å¾„ dataDir + /$destination$/ + parse.datï¼Œä½ çš„è·¯å¾„æ„é€ é”™äº† @agapple  thx
999,ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.lang.IllegalArgumentException å‚ç…§Canal Kafka QuickStartä¸­çš„è¯´æ˜ï¼Œé…ç½®äº†canalåˆ°kafkaæ•°æ®åŒæ­¥ï¼Œå¯åŠ¨canal-kafkaåï¼ŒæŠ¥ `2018-10-12 15:26:32.189 [destination = example   address = /192.168.206.136:3306   EventParser] ERROR c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - dump address /192.168.206.136:3306 has an error  retrying. caused by  java.lang.IllegalArgumentException: null         at java.util.concurrent.ThreadPoolExecutor.<init>(ThreadPoolExecutor.java:1310) ~[na:1.7.0_79]         at java.util.concurrent.ThreadPoolExecutor.<init>(ThreadPoolExecutor.java:1233) ~[na:1.7.0_79]         at java.util.concurrent.Executors.newFixedThreadPool(Executors.java:114) ~[na:1.7.0_79]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor.start(MysqlMultiStageCoprocessor.java:84) ~[canal.parse-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:238) ~[canal.parse-1.1.0.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.7.0_79] 2018-10-12 15:26:32.189 [destination = example   address = /192.168.206.136:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.lang.IllegalArgumentException         at java.util.concurrent.ThreadPoolExecutor.<init>(ThreadPoolExecutor.java:1310)         at java.util.concurrent.ThreadPoolExecutor.<init>(ThreadPoolExecutor.java:1233)         at java.util.concurrent.Executors.newFixedThreadPool(Executors.java:114)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor.start(MysqlMultiStageCoprocessor.java:84)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:238)         at java.lang.Thread.run(Thread.java:745) ]` æœ‰æ²¡æœ‰é‡åˆ°è¿™ä¸ªé—®é¢˜çš„ï¼Ÿ ä½¿ç”¨ç¯å¢ƒï¼šå•æœºzookeeper-3.4.12ï¼Œkafka_2.10-0.10.0.1ï¼Œcanal-kafka-1.1.0 ï¼› æˆ‘ä¹Ÿé‡åˆ°ä¸€æ¨¡ä¸€æ ·çš„çš„é—®é¢˜ï¼Œä½ è§£å†³äº†å—ï¼Ÿ æ­¤é—®é¢˜å·²ç»è§£å†³ï¼Œå°†æœåŠ¡ç«¯é…ç½®æ–‡ä»¶canal.properties ä¸­çš„å¹¶è¡Œçº¿ç¨‹æ•°å…³æ‰å³å¯ï¼Œå•ä¾‹å•çº¿ç¨‹è¿è¡Œ
998,RowChangeè§£æå‡ºæ¥ä¸­æ–‡ä¹±ç  CanalEntry.RowChange rowChange = CanalEntry.RowChange.parseFrom(canalEntry.getStoreValue()); å¾—åˆ°çš„æ•°æ®ä¸­æ–‡ä¹±ç ï¼Œè€Œä¸”ddlçš„sqlåŒ…å«â€œ\r\n" æ•°æ®åº“å’Œcanalçš„é…ç½®éƒ½æ˜¯utf8ï¼Œæ€ä¹ˆæ²¡å›äº‹ï¼Œæ±‚å¤§ä½¬è§£ç­” ![image](https://user-images.githubusercontent.com/26699764/46853678-60f21f80-ce31-11e8-8201-c7e87c996bfe.png) ![image](https://user-images.githubusercontent.com/26699764/46853718-77987680-ce31-11e8-8f17-e21e953c837a.png) ä¸å¥½æ„æ€ï¼ŒtoString()å®³æ­»äººï¼Œå…‰çœ‹åˆ°toStringæ‰“å°çš„ä¿¡æ¯ï¼Œæ²¡æœ‰ç›´æ¥è·å–å€¼ï¼Œå‚»é€¼äº†ã€‚ã€‚ã€‚ã€‚
996,èšçŸ³å¡”å†…çš„RDSéƒ¨ç½²æ— æ•ˆ é—®é¢˜æè¿°     æˆ‘wget äº†é¡¹ç›®ä»£ç  ç¼–è¯‘æˆåŠŸ ï¼Œå¹¶ä¸” æ›´æ”¹äº† ```conf/example/instance.properties``` å†…å®¹ ï¼Œè¿è¡Œ/bin/startup.shåæŠ¥é”™ ``` 2018-10-11 20:12:49.383 [Thread-5] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - stop CannalInstance for null-example 2018-10-11 20:12:49.391 [Thread-5] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - stop successful.... 2018-10-11 20:12:57.090 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [canal.properties] 2018-10-11 20:12:57.095 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [example/instance.properties] 2018-10-11 20:12:57.289 [main] WARN  o.s.beans.GenericTypeAwarePropertyDescriptor - Invalid JavaBean property 'connectionCharset' being accessed! Ambiguous write methods found next to actually used [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.nio.charset.Charset)]: [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.lang.String)] 2018-10-11 20:12:57.343 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [canal.properties] 2018-10-11 20:12:57.343 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [example/instance.properties] 2018-10-11 20:12:57.553 [main] ERROR com.alibaba.druid.pool.DruidDataSource - testWhileIdle is true  validationQuery not set 2018-10-11 20:12:57.865 [main] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start CannalInstance for 1-example 2018-10-11 20:12:57.881 [main] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - start successful.... 2018-10-11 20:12:57.918 [destination = example   address = xxxxxxxx:3333   EventParser] WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - prepare to find start position just show master status 2018-10-11 20:12:59.013 [destination = example   address = xxxxxxxx:3333   EventParser] ERROR c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - dump address xxxxxxxx:3333 has an error  retrying. caused by com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: ErrorPacket [errorNumber=1142  fieldCount=-1  message=SHOW command denied to user 'xxxxxx' for table 'slow_log'  sqlState=42000  sqlStateMarker=#]  with command: show create table `mysql`.`event`;show create table `mysql`.`func`;show create table `mysql`.`general_log`;show create table `mysql`.`help_category`;show create table `mysql`.`help_keyword`;show create table `mysql`.`help_relation`;show create table `mysql`.`help_topic`;show create table `mysql`.`proc`;show create table `mysql`.`slow_log`;show create table `mysql`.`time_zone`;show create table `mysql`.`time_zone_leap_second`;show create table `mysql`.`time_zone_name`;show create table `mysql`.`time_zone_transition`;show create table `mysql`.`time_zone_transition_type`; Caused by: java.io.IOException: ErrorPacket [errorNumber=1142  fieldCount=-1  message=SHOW command denied to user 'xxxxxxx' for table 'slow_log'  sqlState=42000  sqlStateMarker=#]  with command: show create table `mysql`.`event`;show create table `mysql`.`func`;show create table `mysql`.`general_log`;show create table `mysql`.`help_category`;show create table `mysql`.`help_keyword`;show create table `mysql`.`help_relation`;show create table `mysql`.`help_topic`;show create table `mysql`.`proc`;show create table `mysql`.`slow_log`;show create table `mysql`.`time_zone`;show create table `mysql`.`time_zone_leap_second`;show create table `mysql`.`time_zone_name`;show create table `mysql`.`time_zone_transition`;show create table `mysql`.`time_zone_transition_type`;         at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.queryMulti(MysqlQueryExecutor.java:109) ~[canal.parse.driver-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.queryMulti(MysqlConnection.java:107) ~[canal.parse-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:175) ~[canal.parse-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:129) ~[canal.parse-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:91) ~[canal.parse-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:188) ~[canal.parse-1.1.0.jar:na]         at java.lang.Thread.run(Thread.java:748) [na:1.8.0_171 ``` å»æ‰mysqlåº“çš„è®¢é˜…
995,canalæ€ä¹ˆå¤„ç†æºè¡¨deleteçš„æ•°æ® å¦‚æ ‡é¢˜ deleteåœ¨binlogä¸­å°±æ˜¯ä¸€ä¸ªåªæœ‰before imageçš„eventï¼Œå’Œinsert/updateæ²¡å•¥åŒºåˆ«ã€‚ä½ è¯´çš„æ€ä¹ˆå¤„ç†æ˜¯æŒ‡ï¼Ÿ > deleteåœ¨binlogä¸­å°±æ˜¯ä¸€ä¸ªåªæœ‰before imageçš„eventï¼Œå’Œinsert/updateæ²¡å•¥åŒºåˆ«ã€‚ä½ è¯´çš„æ€ä¹ˆå¤„ç†æ˜¯æŒ‡ï¼Ÿ å¥½å§ï¼Œå…¶å®æ˜¯æˆ‘è¡¨è¾¾çš„ä¸æ¸…æ¥šï¼Œåº”è¯¥æ˜¯è¯´ï¼Œcanalèƒ½è§£æbinlogè‚¯å®šèƒ½è·å–deleteçš„è¯­å¥ã€‚ æˆ‘çš„é—®é¢˜åº”è¯¥æ˜¯ï¼Œè·å–åˆ°deleteæ•°æ®åï¼Œä»canalæŠ½å–æ•°æ®-->hiveä»“åº“ã€‚é‚£hiveä»“åº“æ€ä¹ˆå¤„ç†è¿™ä¸ªåˆ é™¤çš„æ•°æ®ï¼Ÿ æ³¨æ„ï¼š 1ã€hiveæ²¡æœ‰å¯ç”¨äº‹åŠ¡ï¼Œä¸èƒ½deleteæ“ä½œ è¿™ä¸ªæ˜¯ä½ hiveè¦å¤„ç†çš„å•Šï¼Œå’Œcanalæœ‰ä»€ä¹ˆå…³ç³»ï¼Œ ä½ å¯æ˜¯è¯•è¯• apache orc > è¿™ä¸ªæ˜¯ä½ hiveè¦å¤„ç†çš„å•Šï¼Œå’Œcanalæœ‰ä»€ä¹ˆå…³ç³»ï¼Œ ä½ å¯æ˜¯è¯•è¯• apache orc å¥½çš„ï¼Œæˆ‘è¯•è¯•ã€‚è°¢è°¢ï¼
994,canalæ˜¯å¦æ”¯æŒå¤šä¸ªinstanceæŒ‡å‘åŒä¸€database åªæ˜¯å¯¹åº”çš„ç™½åå•è¡¨ä¸åŒ? è¯•äº†ä¸‹è®¾ç½®å¤šä¸ªinstance å…¶ä¸­çš„instance.propertiesçš„æ•°æ®åº“åœ°å€ç›¸åŒ ä»…ä»…æ˜¯ç™½åå•æŒ‡å‘ä¸åŒçš„è¡¨(ä¸»è¦æ˜¯ä¸ºäº†ä¸€å¼ è¡¨å¯¹åº”ä¸€ä¸ªkafkaçš„topic) ä½†æ˜¯åœ¨å¯åŠ¨çš„æ—¶å€™æŠ¥é”™å®ä¾‹åŒ–Datasourceå†²çª? å¯ä»¥è®¾ç½® ä½†æ˜¯å¯¹äºzookeeperä¸Šcursorçš„positionæ²¡æœ‰æ›´æ–° 
993,å¯¹ç‰¹å®šçš„instanceæŒ‡å®šxxx-instance.xml è¯·é—® å‡å¦‚ç°åœ¨æœ‰ä¸¤ä¸ªå®ä¾‹: `conf/instance1/instance.properties`   `conf/instance2/instance.properties ` é‚£ä¹ˆå¦‚ä½•ä¸ºå®ƒä»¬åˆ†åˆ«æŒ‡å®š`conf/spring/` ä¸­ä¸åŒçš„xml é…ç½®? åº”è¯¥æ˜¯æ²¡æœ‰åŠæ³•ï¼Œåªèƒ½å¼€ä¸¤ä¸ªcanal @littleneko åœ¨ä¸€ä¸ªserverä¸­å¼€å¯ä¸¤ä¸ªinstance. ä¸ºä¸€ä¸ªinstanceæŒ‡å®šé…ç½®. åœ¨åº”ç”¨æ‰©å±•è²Œä¼¼ä¸­ç»™å‡ºäº†ç­”æ¡ˆ: https://github.com/alibaba/canal/wiki/DevGuide#%E5%BA%94%E7%94%A8%E6%89%A9%E5%B1%95 1. åœ¨`conf` ä¸­åˆ›å»ºæ–°å®ä¾‹å±æ€§æ–‡ä»¶ `new-instance/instance.properties` 2. æ–°å»º xml é…ç½®æ–‡ä»¶ `spring/custom-instance.xml` 3. canal.properties ä¸­æŒ‡å®š `canal.instance.new-instance.spring.xml = classpath:spring/custom-instance.xml` å¦‚æœ canal.properties æ²¡æœ‰è®¾ç½®è‡ªåŠ¨æ‰«æ(canal.auto.scan = true  å¼€å¯è‡ªåŠ¨æ‰«æ)  éœ€åœ¨ canal.properties ä¸­æŒ‡å®š: canal.destinations= example  new-instance --------------------------------------- è¿™é‡Œçš„"é€šé“åç§°" æ˜¯æŒ‡çš„instanceåç§°? è¿˜æ˜¯ä»€ä¹ˆ? ä½†æ˜¯`canal.instance.destination` è¿™ä¸ªå ä½ç¬¦çš„ä½œç”¨æ˜¯ä»€ä¹ˆ? å¦‚ä½•ä½¿ç”¨? è°¢è°¢å¤§ä½¬! @yudianer  è¿™ç§æ–¹æ³•ä¸èƒ½æŒ‡å®šä¸¤ä¸ªä¸åŒçš„xmlå•Šï¼Œxmlæ˜¯åœ¨`canal.properties`ä¸­é…ç½®çš„ã€‚ é€šé“åç§°å°±æ˜¯`new-instance`ï¼Œæ¯ä¸ªinstanceéœ€è¦åœ¨`${canal.conf.dir}`(é»˜è®¤ä¸ºconfç›®å½•ä¸‹ï¼Œåœ¨`canal.properties`ä¸­é…ç½®)ä¸­æ–°å»ºä¸€ä¸ªç›®å½•ï¼Œé‡Œé¢å†™ä¸Š`instance.properties`é…ç½®æ–‡ä»¶ã€‚ `canal.instance.destination`å®é™…ä¸Šå°±æ˜¯æ¯ä¸ªinstanceçš„ç›®å½•ã€‚ åœ¨`https://github.com/alibaba/canal/blob/master/deployer/src/main/java/com/alibaba/otter/canal/deployer/CanalController.java`ä¸­åˆå§‹åŒ–ï¼š ```java // è®¾ç½®å½“å‰æ­£åœ¨åŠ è½½çš„é€šé“ï¼ŒåŠ è½½springæŸ¥æ‰¾æ–‡ä»¶æ—¶ä¼šç”¨åˆ°è¯¥å˜é‡ System.setProperty(CanalConstants.CANAL_DESTINATION_PROPERTY  destination); ``` @littleneko  æˆ‘æ„Ÿè§‰å’±ä¿©è¯´çš„ä¸€ä¸ªæ„æ€å•Š. :smile: ![image](https://user-images.githubusercontent.com/12033023/46842989-50c34b80-ce03-11e8-8224-bf0a5aa593e0.png) > // è®¾ç½®å½“å‰æ­£åœ¨åŠ è½½çš„é€šé“ï¼ŒåŠ è½½springæŸ¥æ‰¾æ–‡ä»¶æ—¶ä¼šç”¨åˆ°è¯¥å˜é‡ System.setProperty(CanalConstants.CANAL_DESTINATION_PROPERTY  destination); ä½ è¯´çš„è¿™å¥è¯å€’æ˜¯æé†’äº†æˆ‘ `canal.instance.destination` å¹¶ä¸å€¾å‘äºä½¿ç”¨è€…è®¾ç½®çš„. è€Œæ˜¯åŠ è½½é…ç½®æ–‡ä»¶çš„æ—¶å€™ è®¾ç½®ä¸ºæ¯ä¸€ä¸ªinstanceåç§° ç„¶åå¯¹properties é…ç½®æ–‡ä»¶ä¸­å ä½ç¬¦è¿›è¡Œæ›¿æ¢. è°¢è°¢! 
992,ä½¿ç”¨CanalKafkaClientExample storeValueæ˜¯ä¹±ç  2018-10-10 17:25:19.304 [Thread-2] INFO  c.a.o.canal.client.running.kafka.CanalKafkaClientExample - Message[id=16 entries=[header {   version: 1   logfileName: "mysql-bin.000156"   logfileOffset: 298158292   serverId: 1   serverenCode: "UTF-8"   executeTime: 1539163519000   sourceType: MYSQL   schemaName: "payment"   tableName: "tmp_canal_test"   eventLength: 69   eventType: UPDATE   props {     key: "rowsCount"     value: "1"   } } entryType: ROWDATA storeValue: "\b\242\006\020\002P\000b\341\001\n\033\b\000\020\004\032\002id \001(\0000\000B\00245R\aint(11)\n\'\b\001\020\f\032\busername \000(\0000\000B\003111R\fvarchar(255)\n*\b\002\020\f\032\bpassword \000(\0000\000B\006123123R\fvarchar(255)\022\033\b\000\020\004\032\002id \001(\0000\000B\00245R\aint(11)\022\'\b\001\020\f\032\busername \000(\0000\000B\003111R\fvarchar(255)\022\'\b\002\020\f\032\bpassword \000(\0010\000B\003123R\fvarchar(255)" ] raw=true rawEntries=[]] è¯·é—®ä¸€ä¸‹æ€ä¹ˆå¤„ç† `storeValue`æ˜¯`com.alibaba.otter.canal.protocol.RowChange`ç±»å‹ï¼Œéœ€è¦è¿›ä¸€æ­¥è§£æå‡ºæ¥ï¼Œå…·ä½“å¯ä»¥çœ‹EntryProtocol.protoä¸­çš„å®šä¹‰ LSæ­£è§£
991,canalå®ç°HA å¹¶ä¸”å‘é€æ¶ˆæ¯åˆ°kafkaé›†ç¾¤ ä¸»å¤‡åˆ‡æ¢å¯¼è‡´æ¶ˆæ¯é‡å¤å‘é€ canalå®ç°HAå binlogçš„positionè®°å½•åˆ°äº†zookeeperä¸­ ä½†å°†ä¸»åº”ç”¨æš‚åœæ‰å å¤‡ç”¨ä¼šå°†ä¹‹å‰ä¸€æ®µæ—¶é—´æ²¡æœ‰ç»ç”±å®ƒå¤„ç†çš„binlogé‡æ–°æŠ•é€’åˆ°kafkaä¸­.æ˜¯ä»€ä¹ˆæƒ…å†µ??? åœ¨HAæ¨¡å¼ä¸‹ åœæ­¢A åˆ‡æ¢åˆ°B å†å¯åŠ¨A å†åœæ­¢Bç”±Aæ“ä½œçš„zkä¸Šçš„cursorçš„positionä¸æ›´æ–° ä¸çŸ¥é“æ˜¯å› ä¸ºé›†æˆäº†Kafkaè¿˜æ˜¯å…¶ä»–åŸå› ?? å·²çŸ¥é—®é¢˜ï¼Œå»ºè®®å‡çº§1.1.1æ–°ç‰ˆæœ¬
990,å¢åŠ  ç›®æ ‡æ•°æ®åº“å¯†ç åŠ å¯†è§£å¯†ï¼Œé‡‡ç”¨druidæ–¹å¼è¿›è¡ŒåŠ å¯†è§£å¯†ï¼Œå¹¶è®¾ç½®canal.instance.enableDruid=trueæ—¶ï¼Œè¯·ä½¿â€¦ å¢åŠ  ç›®æ ‡æ•°æ®åº“å¯†ç åŠ å¯†è§£å¯†ï¼Œé‡‡ç”¨druidæ–¹å¼è¿›è¡ŒåŠ å¯†è§£å¯†ï¼Œå¹¶è®¾ç½®canal.instance.enableDruid=trueæ—¶ï¼Œè¯·ä½¿â€¦ [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=990) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=990) before we can accept your contribution.<br/><hr/>**shichengming** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=990) it.</sub> [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=990) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=990) before we can accept your contribution.<br/><hr/>**shichengming** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=990) it.</sub> tks
989,ä¿®æ”¹canal dbsyncæ¨¡å—çš„ä»£ç æœªç”Ÿæ•ˆ åœ¨å®šåˆ¶canalçš„è¿‡ç¨‹ä¸­ï¼Œå·²ç»å®Œæˆäº†canalçš„å®‰è£…éƒ¨ç½²ä¸”è¿è¡Œæ­£å¸¸ã€‚ ç°éœ€è¦å¯¹canalçš„dbsyncæ¨¡å—çš„ä»£ç ï¼ˆcom.alibaba.otter.canal.parse.inbound.mysql.dbsyncåŒ…ä¸‹é¢çš„ç±»LogEventConvertçš„æ–¹æ³•parseOneRowï¼‰è¿›è¡Œæ”¹å†™ï¼ˆä¸‹è½½äº†canal sourceï¼Œå¹¶åœ¨intellij ideaä¸­æ‰“å¼€ï¼‰ï¼Œä½†æ˜¯ä¸€ç›´ä¸ç”Ÿæ•ˆã€‚ä¸çŸ¥é“ä»€ä¹ˆåŸå› ï¼Ÿ å“ªä½å¤§ç¥èƒ½å¸®å¿™æŒ‡ç‚¹ä¸‹ï¼Œè°¢è°¢å•¦ï¼ <img width="1232" alt="dbsync" src="https://user-images.githubusercontent.com/28953872/46657304-89380f00-cbe2-11e8-973f-3c13658b8e04.png"> @agapple @lcybo æ±‚å¤§ç¥æœ‰ç©ºæŒ‡ç‚¹ä¸‹ ä¸ç”Ÿæ•ˆï¼Ÿdebugæ–­ç‚¹èƒ½èµ°åˆ°è¿™é‡Œä¹ˆï¼Ÿ åœ¨ideaä¸­è®¾ç½®æ–­ç‚¹è°ƒè¯•è¿‡äº†ï¼Œæ²¡æœ‰èµ°åˆ°è¿™é‡Œã€‚éš¾é“æ˜¯è¦æ”¹canalå®‰è£…åŒ…ä¸­çš„lib/canal.parse.dbsync-1.0.24.jarï¼Ÿ æ–­ç‚¹èƒ½èµ°åˆ°å…¶ä»–åœ°æ–¹ä¹ˆï¼Ÿå…ˆç¡®ä¿åœ¨IDEAé‡Œé¢debugèƒ½èµ°åˆ°ä½ æ·»åŠ çš„ä»£ç å—ï¼Œæµ‹è¯•æ²¡é—®é¢˜äº†ï¼Œåœ¨æŠŠå·¥ç¨‹æ‰“æˆjaråŒ…ã€‚å†éƒ¨ç½² è°¢è°¢å›å¤ï¼ ä¸å¥½æ„æ€ï¼Œä¹‹å‰å†™é”™äº†ï¼Œåº”è¯¥æ˜¯ä¿®æ”¹parseræ¨¡å—ï¼ˆä¸æ˜¯dbsyncæ¨¡å—ï¼‰çš„LogEventConvertä»£ç æ²¡ç”Ÿæ•ˆã€‚ å¦å¤–æˆ‘å°è¯•åœ¨parseræ¨¡å—çš„å…¶ä»–ä»£ç è®¾ç½®æ–­ç‚¹è°ƒè¯•ï¼Œä½†éƒ½æ²¡æœ‰è·‘åˆ°è¯¥æ–­ç‚¹ã€‚ ********************** å…·ä½“æƒ…å†µæ˜¯è¿™æ ·çš„ï¼šæˆ‘æ­£åœ¨å®šåˆ¶canalæ¥è·å–mysqlçš„å¢é‡æ•°æ®å¹¶ç»è½¬æ¢åå¾—åˆ°è‡ªå®šä¹‰çš„json stringï¼ˆåŒ…å«1æ¡ä¿®æ”¹çš„recordï¼‰ï¼Œjsonæ ¼å¼å¦‚ä¸‹ï¼ˆinsert 1æ¡recordï¼‰ï¼š { "table":"mysql.mysql.all_types" "transactionID":"29" "scn":"29.0" "ts":"1539333745000" "data":[{"opType":"i" "after":{"smallint1":"111" "timestamp1":"2018-10-12 16:42:25.000000" "float1":"345.102" "inta":"108" "tinyint1":"11" "varchar1":"a" "decimal1":"-1235666.666668899987000000000000000000" "double1":"123.134577501986" "datetime1":"2018-10-12 16:42:25.000000"}}]} ä½†æ˜¯åŸç”Ÿcanal(1.0.24ç‰ˆæœ¬)ï¼Œâ€œclientç«¯ï¼ˆexampleæ¨¡å—çš„ClusterCanalClientTest.javaï¼‰ä½¿ç”¨column.getvalue()è·å–çš„doubleå’Œdecimalç±»å‹çš„æ•°æ®â€ å’Œ â€œmysql shellä¸­æ’å…¥/æŸ¥è¯¢æ•°æ®çš„ç²¾åº¦å’Œå°æ•°ç‚¹ä½æ•°(precision scale)â€ä¸ä¸€è‡´ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªæ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼Œæˆ‘å°è¯•å¯¹canalçš„parseræ¨¡å—çš„ä»£ç ï¼ˆcom.alibaba.otter.canal.parse.inbound.mysql.dbsyncåŒ…ä¸‹é¢çš„ç±»LogEventConvertçš„æ–¹æ³•parseOneRowï¼‰è¿›è¡Œæ”¹å†™ã€‚ä½†æ˜¯ä¸èµ·ä½œç”¨ï¼Œäºæ˜¯æˆ‘åœ¨intellij ideaä¸­å¼€å¯äº†æ–­ç‚¹è°ƒè¯•ï¼Œä½†æ˜¯ç¨‹åºæ˜¾ç¤ºä¸ä¼šæ‰§è¡Œåˆ°parseOneRowã€‚ æˆ‘è§‰å¾—åŸå› å¯èƒ½æ˜¯ï¼šæˆ‘æ˜¯åœ¨intellij ideaä¸­ä¿®æ”¹äº†canal parseræ¨¡å—ï¼ˆcanal æºç ï¼‰çš„ä»£ç ï¼Œä½†æ˜¯canal server ï¼ˆå³canalé¦–é¡µä¸‹è½½çš„ deployerï¼ˆäºŒè¿›åˆ¶ï¼‰å¹¶è§£å‹ç¼©å¾—åˆ°libã€binã€confä»¥åŠlogsæ–‡ä»¶å¤¹ï¼Œå…¶ä¸­libä¸­åŒ…å«å„ç§jarï¼‰è´Ÿè´£è§£æmysqlçš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚æ‰€ä»¥çœŸæ­£éœ€è¦æ›´æ”¹çš„æ˜¯canal server çš„libä¸‹é¢çš„jarã€‚ å› æ­¤æˆ‘éœ€è¦åœ¨intellij ideaä¸­ä¿®æ”¹å¥½parseræºç åï¼Œéœ€è¦é‡æ–°æ‰“æˆæ–°parser jaråŒ…ï¼Œå¹¶ç”¨è¯¥æ–°jaråŒ…æ›¿æ¢canal server çš„libä¸‹é¢çš„parser jarã€‚ çŒœæƒ³å¾…éªŒè¯ã€‚ æµ‹è¯•ç»“æœæ˜¾ç¤ºï¼Œéœ€è¦åœ¨intellij ideaä¸­ä¿®æ”¹å¥½parseræºç åï¼Œéœ€è¦é‡æ–°æ‰“æˆæ–°parser jaråŒ…ï¼Œå¹¶ç”¨è¯¥æ–°jaråŒ…æ›¿æ¢canal server çš„libä¸‹é¢çš„parser jarã€‚ä¿®æ”¹å·²ç»ç”Ÿæ•ˆäº†ã€‚ è°¢è°¢ @theonesmx 
988,canal.instance.filter.regexä¸ç”Ÿæ•ˆ å°è¯•äº†ä¸¤ä¸ªmysqlæœåŠ¡å™¨ï¼ŒåŒæ ·çš„é…ç½®ï¼Œä¸€ä¸ªç”Ÿæ•ˆï¼Œå¦ä¸€ä¸ªä¸ç”Ÿæ•ˆã€‚ å·²ç»æ£€æŸ¥bin logæ ¼å¼ï¼Œæ˜¯ROWæ ¼å¼ã€‚ ç”¨çš„æ˜¯KafkaCanalConnector subscribe()æ–¹æ³•é‡Œæ²¡æœ‰ç”¨å‚æ•°ã€‚ è¯·é—®æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ æœåŠ¡å™¨1 ä¸ç”Ÿæ•ˆ ![image](https://user-images.githubusercontent.com/24933564/46660266-44fc3d00-cbe9-11e8-93f3-2f7218564f10.png) ![image](https://user-images.githubusercontent.com/24933564/46660815-79bcc400-cbea-11e8-9085-ee90f1eb5933.png) æœåŠ¡å™¨2 ç”Ÿæ•ˆ ![image](https://user-images.githubusercontent.com/24933564/46660299-534a5900-cbe9-11e8-9aca-ae68e98b27ed.png) ![image](https://user-images.githubusercontent.com/24933564/46660833-82ad9580-cbea-11e8-80d8-9ce49dbbf46b.png) è¿™ä¸¤ä¸ªæœåŠ¡å™¨binlogçš„é…ç½®çš„ä¸åŒä¼šå½±å“å— çœ‹ä¸€ä¸‹wikié‡Œçš„FAQï¼Œæœ‰å‡ ç§å¸¸è§çš„filteræœªç”Ÿæ•ˆçš„case
987,è§£æcreate schemaæ—¥å¿—åï¼Œè°ƒç”¨ä¸æ–­æŠ›å¼‚å¸¸ > ç–‘é—®1 åœºæ™¯ï¼šå¯åŠ¨canalï¼Œæ‰§è¡Œcreate schemaè¯­å¥ï¼Œé€šè¿‡ Message getWithoutAck(int batchSize)è·å¾—æ—¥å¿—æ•°æ®ã€‚å½“ä¸‹ä¸€æ¬¡å†è°ƒç”¨è¯¥æ–¹æ³•æ—¶ï¼ŒæŠ›å‡ºä»¥ä¸‹å¼‚å¸¸ã€‚ å¦‚æœcanalè§£æcreate schemaæ—¥å¿—å‰ï¼Œè§£æäº†å…¶ä»–è¯­å¥ï¼ˆcrudï¼‰çš„æ—¥å¿—ï¼Œåˆ™ä¸ä¼šå‡ºç°è¿™æ ·çš„é”™è¯¯ã€‚ ### å¼‚å¸¸ä¿¡æ¯æ ˆï¼š 2018-10-09 10:19:20.755 [main] ERROR syncLogger - !!!!å¢é‡åŒæ­¥å¼‚å¸¸|com.alibaba.otter.canal.protocol.exception.CanalClientException: something goes wrong with reason: something goes wrong with channel:[id: 0xcf561b9e  /192.168.1.179:50803 => /192.168.1.179:2017]  exception=java.lang.NullPointerException 	at com.alibaba.otter.canal.store.helper.CanalEventUtils.createPosition(CanalEventUtils.java:69) 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.getFirstPosition(MemoryEventStoreWithBuffer.java:375) 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.getFirstPosition(MemoryEventStoreWithBuffer.java:36) 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:307) 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:273) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:124) 	at org.jboss.netty.channel.SimpleChannelHandler.handleUpstream(SimpleChannelHandler.java:88) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564) 	at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:791) 	at org.jboss.netty.channel.SimpleChannelHandler.messageReceived(SimpleChannelHandler.java:142) 	at org.jboss.netty.channel.SimpleChannelHandler.handleUpstream(SimpleChannelHandler.java:88) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:36) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564) 	at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:791) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:294) 	at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564) 	at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:791) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:296) 	at org.jboss.netty.handler.codec.frame.FrameDecoder.unfoldAndFireMessageReceived(FrameDecoder.java:462) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:536) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:435) 	at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:559) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:268) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:255) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:88) 	at org.jboss.netty.channel.socket.nio.AbstractNioWorker.process(AbstractNioWorker.java:109) 	at org.jboss.netty.channel.socket.nio.AbstractNioSelector.run(AbstractNioSelector.java:312) 	at org.jboss.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.java:90) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:178) 	at org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108) 	at org.jboss.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:42) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) 	at java.lang.Thread.run(Thread.java:748) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.receiveMessages(SimpleCanalConnector.java:344) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:315) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:287) > ç–‘é—®2 å¦å¤–ï¼Œcreate schemaè¯­å¥å¯¹åº”çš„event typeæ˜¯Queryï¼ŒisDdl=falseï¼Œæ„Ÿè§‰ä¸å¤ªå¯¹ã€‚ ![image](https://user-images.githubusercontent.com/22972651/46643311-2167d100-cbae-11e8-8695-a9a2559f92b3.png) 1.  å‡çº§ä¸€ä¸‹1.1.11ç‰ˆæœ¬ 2.  create schema è¯­æ³•æ²¡æœ‰è¯†åˆ«ï¼Œddlè¯­æ³•ä¸»è¦è¯†åˆ«äº†create/alter/drop tableç­‰æ“ä½œ
986,idle timeout exceeds  close channel to save server resources canal1.1.1ç‰ˆæœ¬é”™è¯¯  2018-10-08 18:09:07.144 [Hashed wheel timer #1] WARN  c.a.o.c.server.netty.handler.ClientAuthenticationHandler - channel:[id: 0x2d3c7336  /10.8.32.241:54621 => /10.8.32.241:11111] idle timeout exceeds  close channel to save server resources... 2018-10-08 18:09:13.279 [New I/O server worker #1-14] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x4863b38b  /10.8.32.241:54622 :> /10.8.32.241:11111]  exception=java.nio.channels.ClosedChannelException         at org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:629)         at org.jboss.netty.channel.socket.nio.NioWorker.close(NioWorker.java:605)         at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:356)         at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:281)         at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:201)         at org.jboss.netty.util.internal.IoWorkerRunnable.run(IoWorkerRunnable.java:46)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)         at java.lang.Thread.run(Thread.java:745) clienté•¿æ—¶é—´æ²¡æœ‰å’Œcanal serveræœ‰äº¤äº’å¯¼è‡´ï¼Œé»˜è®¤è¶…æ—¶æ—¶é—´1å°æ—¶
985,serveré…ç½®äº†å¤šä¸ªå®ä¾‹ï¼ŒæŸä¸ªå®ä¾‹æŠ¥é”™åå¦‚ä½•æ¢å¤ serverç›‘å¬äº†å¤šä¸ªåº“ï¼Œæœ‰ä¸ªåº“ç”±äºç½‘ç»œé—®é¢˜ä¸­æ–­äº†ä¸€ä¼šï¼Œåé¢ä¸€ç›´è¿ä¸ä¸Šï¼ŒæŠ¥timeoutã€‚ è¦é‡æ–°æ¥çš„è¯æ˜¯ä¸æ˜¯åªèƒ½é‡å¯serverï¼Œè¿˜æ˜¯è¯´å¯ä»¥åªé‡å¯å‡ºé”™çš„å®ä¾‹ï¼Ÿ ![default](https://user-images.githubusercontent.com/22339074/46599888-0e57f100-cb1b-11e8-81e4-38203ac9e231.PNG) å»ºè®®ç›´æ¥æµ‹è¯•ä¸€ä¸‹æœ€æ–°çš„1.1.1ç‰ˆæœ¬
984,é—®ä¸€ä¸ªcanalä»£ç æ•°æ®ç»“æ„çš„é—®é¢˜ RowChange rowChangeä¸­çš„getRowDatasList()å¯èƒ½ ä¼šè¿”å›å¤šæ¡å—ï¼Ÿå¦‚æœä¼š ä»€ä¹ˆæƒ…å†µä¸‹ä¼š æ‰¹é‡æƒ…å†µ
983,[1.1.0]æ˜¯å¦æ”¯æŒMariaDB-10.3.6 æ”¯æŒmariadb 5.xå’Œ10.x
982,è¯·é—®ï¼Œå®¢æˆ·ç«¯å¦‚ä½•èƒ½è·å– TableMeta å¯¹è±¡ï¼Œè°¢è°¢ï¼ å¦‚é¢˜ï¼Œæƒ³åœ¨å®¢æˆ·ç«¯è·å– è¡¨ä¸­çš„ä¸»é”®æˆ–è€…å”¯ä¸€é”®ã€‚ ä½†ä¸çŸ¥ä»ä½•ä¸‹æ‰‹ã€‚ ç°åœ¨æˆ‘ä»¬ç”¨çš„ canal æ˜¯1.0.22ï¼›æ®è¯´1.0.26ä»¥åï¼Œcanalå¢åŠ tsdbæ¥å®æ—¶å­˜å‚¨è¡¨ç»“æ„ä¿¡æ¯ï¼›é‚£å®¢æˆ·ç«¯å¦‚ä½•è·å–å‘¢ï¼Ÿç›´æ¥connectåˆ°druidä¸­æ‹¿ï¼Ÿè¿˜æ˜¯åœ¨æ‰¹é‡æ‹‰å–æ—¶ï¼Œä»è¿”å›çš„messageæˆ–è€…å…¶ä»–å¯¹è±¡ä¸­èƒ½è·å–åˆ°ï¼Ÿ è¯·ä¸åèµæ•™ï¼Œè°¢è°¢å„ä½ï¼ è¡¨çš„ä¸»é”®åœ¨è¿”å›çš„protobufå¯¹è±¡é‡Œå·²ç»æœ‰æ ‡è¯†ï¼ŒisKey.  å¦‚æœè¦è·å–å”¯ä¸€é”®ï¼Œéœ€è¦æ‹¿åˆ°è¡¨åå»åæŸ¥ä¸€ä¸‹æ•°æ®åº“è¡¨ç»“æ„ æ˜ç™½äº†ï¼Œè°¢è°¢ï¼
981, clientæ¨¡å—ä¸­rocketmq-clientåŒ…scope provideï¼Œå¤–éƒ¨ä½¿ç”¨å•ç‹¬ä¾èµ– tks
980,table meta é”™è¯¯  ERROR c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - pls submit github issue  show create table ddl:CREATE TABLE `partner_organization_data` (   `id` int(11) NOT NULL AUTO_INCREMENT   `organizationName` varchar(250) DEFAULT NULL   `organizationId` varchar(250) NOT NULL   `organizationLogo` varchar(500) DEFAULT NULL COMMENT 'æœºæ„logo'   `organizationUrl` varchar(500) DEFAULT NULL COMMENT 'æœºæ„åœ°å€'   `isDelete` tinyint(4) NOT NULL DEFAULT '0' COMMENT 'æ˜¯å¦åˆ é™¤0æ˜¯åˆ é™¤ï¼Œ1æ˜¯ä¸åˆ é™¤'   `isOnline` tinyint(4) NOT NULL DEFAULT '0' COMMENT 'æ˜¯å¦ä¸Šçº¿ï¼Œ0æ˜¯ä¸ä¸Šçº¿ï¼Œ1æ˜¯ä¸Šçº¿'   `organizationLogoh5_2` varchar(500) DEFAULT NULL COMMENT 'h5  ç¬¬äºŒä¸ªlogo'   `organizationLogoh5` varchar(500) DEFAULT NULL COMMENT 'h5æœºæ„logo'   `organizationUrlh5` varchar(500) DEFAULT NULL COMMENT 'h5æœºæ„url'   PRIMARY KEY (`id`) ) ENGINE=InnoDB AUTO_INCREMENT=11 DEFAULT CHARSET=utf8   compare failed .   db : TableMeta [schema=operation  table=partner_organization_data  fileds=         FieldMeta [columnName=id  columnType=int(11)  nullable=false  key=true  defaultValue=null  extra=null  unique=false]         FieldMeta [columnName=organizationName  columnType=varchar(250)  nullable=true  key=false  defaultValue=null  extra=null  unique=false]         FieldMeta [columnName=organizationId  columnType=varchar(250)  nullable=false  key=false  defaultValue=null  extra=null  unique=false]         FieldMeta [columnName=organizationLogo  columnType=varchar(500)  nullable=true  key=false  defaultValue=null  extra=null  unique=false]         FieldMeta [columnName=organizationUrl  columnType=varchar(500)  nullable=true  key=false  defaultValue=null  extra=null  unique=false]         FieldMeta [columnName=isDelete  columnType=tinyint(4)  nullable=false  key=false  defaultValue=0  extra=null  unique=false]         FieldMeta [columnName=isOnline  columnType=tinyint(4)  nullable=false  key=false  defaultValue=0  extra=null  unique=false]         FieldMeta [columnName=organizationLogoh5_2  columnType=varchar(500)  nullable=true  key=false  defaultValue=null  extra=null  unique=false]         FieldMeta [columnName=organizationLogoh5  columnType=varchar(500)  nullable=true  key=false  defaultValue=null  extra=null  unique=false]         FieldMeta [columnName=organizationUrlh5  columnType=varchar(500)  nullable=true  key=false  defaultValue=null  extra=null  unique=false] ]   mem : TableMeta [schema=operation  table=partner_organization_data  fileds=         FieldMeta [columnName=id  columnType=int(11)  nullable=false  key=true  defaultValue=null  extra=null  unique=false]         FieldMeta [columnName=organizationName  columnType=varchar(250)  nullable=true  key=false  defaultValue=null  extra=null  unique=false]         FieldMeta [columnName=organizationId  columnType=varchar(250)  nullable=false  key=false  defaultValue=null  extra=null  unique=false]         FieldMeta [columnName=organizationLogo  columnType=varchar(500)  nullable=true  key=false  defaultValue=null  extra=null  unique=false]         FieldMeta [columnName=organizationUrl  columnType=varchar(500)  nullable=true  key=false  defaultValue=null  extra=null  unique=false]         FieldMeta [columnName=isDelete  columnType=tinyint(4)  nullable=false  key=false  defaultValue=0  extra=null  unique=false]         FieldMeta [columnName=isOnline  columnType=tinyint(4)  nullable=false  key=false  defaultValue=0  extra=null  unique=false]         FieldMeta [columnName=organizationLogoh5_2  columnType=varchar(500)  nullable=true  key=false  defaultValue=null  extra=null  unique=false]         FieldMeta [columnName=organizationLogoh5_2  columnType=varchar(500)  nullable=true  key=false  defaultValue=null  extra=null  unique=false]         FieldMeta [columnName=organizationLogoh5  columnType=varchar(500)  nullable=true  key=false  defaultValue=null  extra=null  unique=false]         FieldMeta [columnName=organizationUrlh5  columnType=varchar(500)  nullable=true  key=false  defaultValue=null  extra=null  unique=false] ] 2018-09-30 15:53:41.988 [[scheduler-table-meta-snapshot]] ERROR c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - compare failed   check log ä»¥ä¸Šæ˜¯é”™è¯¯æ—¥å¿—  äºä¸¤å¤©å‰å¢åŠ äº†ä¸€ä¸ªæ•°æ®åˆ— organizationLogoh5_2 ä»Šå¤©å‘ç”Ÿçš„é”™è¯¯.memä¸­å‡ºç°äº†ä¸¤ä¸ªorganizationLogoh5_2 1. å¯¹åº”ç‰ˆæœ¬æ˜¯ï¼Ÿ 2. ä½ èƒ½ä»æœ¬åœ°h2æ–‡ä»¶é‡Œï¼Œæ‰¾åˆ°å¯¹åº”è¯¥è¡¨ä¸Šæ“ä½œçš„DDLï¼Œæˆ‘åœ¨æœ¬åœ°å¤ç°ä¸€ä¸‹ å†…å­˜è¡¨ç»“æ„æ˜¯æ²¡æœ‰åˆ¤é‡çš„å¤„ç†ï¼Œåˆ¤é‡ä¸»è¦æ˜¯meta_historyé‡Œä¼šåŸºäºserverId+ä½ç‚¹åšå»é‡è¿‡æ»¤ï¼Œå¦‚æœæ˜¯æ­£å¸¸çš„ä¸»å¤‡æ˜¯åœ¨å¤åˆ¶æ—¶ä¼šä¿ç•™serverIdï¼Œä½†å¯¹åº”çš„ä½ç‚¹ä¼šä¸åŒï¼Œæ­¤æ—¶meta_historyä¼šæœ‰ä¸»å¤‡åº“å„è‡ªçš„DDLï¼Œæ­¤æ—¶å¦‚æœå†å›æº¯ä¸€æ¬¡çš„è¯ï¼Œå°±ä¼šå‡ºç°å†…å­˜é‡å¤çš„åˆ— å›½åº†ä¹‹åæ”¯æŒä¸€ä¸‹tsdbå†…å­˜è¡¨ç»“æ„çš„å¹‚ç­‰å¤„ç†ï¼Œè§„é¿ä¸»å¤‡åˆ‡æ¢çš„å›æº¯å‡ºç°é‡å¤çš„DDL 2å¤©å‰çš„masterç‰ˆæœ¬ ä¸€ä¸ªcanalå®ä¾‹  instanceé…ç½®é‡Œé¢è¿æ¥çš„æ˜¯ä¸»åº“ æœªè®¾ç½®standby select * from PUBLIC.meta_snapshot ä»¥ä¸‹ä¸ºæŸ¥è¯¢ç»“æœ åªæœ‰ä¸€æ¡ 1	2018-09-29 15:53:47.086000000	2018-09-29 15:53:47.086000000	partner	0	0	-1	-2	{"operation":"CREATE TABLE `application` (\n\t`id` int(11) NOT NULL AUTO_INCREMENT \n\t`name` varchar(100) NOT NULL DEFAULT '' \n\t`type` varchar(50) NOT NULL DEFAULT '' \n\tPRIMARY KEY (`id`) \n\tUNIQUE `åº”ç”¨åè¯ç´¢å¼•` (`name`)\n) ENGINE = InnoDB AUTO_INCREMENT = 3 CHARSET = utf8; \nCREATE TABLE `op_account_history` (\n\t`id` int(11) NOT NULL AUTO_INCREMENT \n\t`hexun_user_id` int(11) NOT NULL \n\t`hexun_user_nick` varchar(255) NOT NULL \n\t`add_time` datetime NOT NULL \n\t`type` varchar(255) NOT NULL \n\t`content` varchar(255) NOT NULL \n\t`success` int(1) NOT NULL \n\t`params` text \n\t`access_type` varchar(45) DEFAULT NULL \n\t`access_log_param` text \n\t`access_log_detail` text \n\t`ip` varchar(45) DEFAULT NULL \n\tPRIMARY KEY (`id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 217066 CHARSET = utf8 COMMENT 'ç®¡ç†å‘˜è´¦å·è®¿é—®è®°å½•'; \nCREATE TABLE `op_account_url_permission` (\n\t`id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'è‡ªå¢permission id\n' \n\t`permission_url` varchar(255) NOT NULL COMMENT 'æƒé™æ ¹æ®urlæ§åˆ¶' \n\t`permission_desc` varchar(255) DEFAULT NULL COMMENT 'æƒé™çš„æè¿°ï¼Œå¦‚â€œå®¡æ ¸ç®¡ç†â€' \n\t`allowed_roles` varchar(512) NOT NULL COMMENT 'å…è®¸çš„è§’è‰²ID' \n\t`log_message_format` varchar(6000) DEFAULT NULL \n\t`access_type` varchar(45) DEFAULT NULL \n\t`permission_api_id` varchar(128) DEFAULT NULL \n\tPRIMARY KEY (`id`) \n\tUNIQUE `id_UNIQUE` (`id`) \n\tUNIQUE `permission_url_UNIQUE` (`permission_url`)\n) ENGINE = InnoDB AUTO_INCREMENT = 353 CHARSET = utf8 COMMENT 'è§’è‰²å¯ä»¥è¡Œä½¿çš„æƒé™'; \nCREATE TABLE `op_account_user` (\n\t`id` int(11) NOT NULL AUTO_INCREMENT \n\t`hexun_user_id` int(11) NOT NULL \n\t`hexun_user_name` varchar(255) NOT NULL \n\t`hexun_user_nick` varchar(255) NOT NULL \n\t`email_notification` varchar(255) NOT NULL \n\t`user_role_id` int(11) NOT NULL \n\t`create_time` datetime NOT NULL \n\t`creator_user_id` int(11) NOT NULL \n\t`creator_user_name` varchar(255) NOT NULL \n\t`creator_user_nick` varchar(255) NOT NULL \n\t`true_name` varchar(255) DEFAULT NULL \n\tPRIMARY KEY (`id`) \n\tUNIQUE `id_UNIQUE` (`id`) \n\tUNIQUE `hexun_user_id_UNIQUE` (`hexun_user_id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 85 CHARSET = utf8 COMMENT 'è¿è¥åå°ç®¡ç†å‘˜è¡¨'; \nCREATE TABLE `op_account_user_role` (\n\t`id` int(11) NOT NULL AUTO_INCREMENT \n\t`role_id` tinyint(4) NOT NULL \n\t`role_name` varchar(255) NOT NULL \n\t`role_desc` text \n\tPRIMARY KEY (`id`) \n\tUNIQUE `id_UNIQUE` (`id`) \n\tUNIQUE `roleName_UNIQUE` (`role_name`) \n\tUNIQUE `roleId_UNIQUE` (`role_id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 26 CHARSET = utf8; \nCREATE TABLE `op_check_flow_right` (\n\t`id` tinyint(8) NOT NULL \n\t`check_level` tinyint(4) DEFAULT NULL \n\t`role_id` varchar(16) DEFAULT NULL \n\t`modular_id` tinyint(4) DEFAULT NULL \n\tPRIMARY KEY (`id`)\n) ENGINE = InnoDB CHARSET = utf8; \nCREATE TABLE `op_check_partner_eventflow` (\n\t`id` int(8) NOT NULL AUTO_INCREMENT \n\t`partner_id` int(8) DEFAULT NULL \n\t`check_level` tinyint(2) DEFAULT '1' COMMENT 'åˆ†ä¸º1çº§å’Œ2çº§å®¡æ ¸ï¼Œ3çº§ä¸ºé©³å›çŠ¶æ€' \n\t`check_status` tinyint(2) DEFAULT '1' COMMENT '1å¾…å®¡ï¼Œ2å®¡æ ¸é€šè¿‡' \n\t`check_time` datetime DEFAULT NULL \n\t`check_reason` varchar(512) DEFAULT NULL \n\t`partner_submit_time` datetime DEFAULT NULL \n\t`adviser_status` tinyint(2) DEFAULT '0' COMMENT 'æŠ•é¡¾èº«ä»½å®¡æ ¸ 0ç›´æ’­äººå®¡æ ¸ï¼Œ1æŠ•é¡¾å®¡æ ¸ï¼Œ2æŠ•é¡¾å®¡æ ¸å®Œæˆ 3æŠ•é¡¾é™çº§ä¸ºç›´æ’­äºº' \n\tPRIMARY KEY (`id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 7034 CHARSET = utf8; \nCREATE TABLE `op_check_partner_log` (\n\t`id` int(8) NOT NULL AUTO_INCREMENT \n\t`operateName` varchar(32) DEFAULT '' COMMENT 'æ“ä½œå‘˜å§“å' \n\t`operateType` varchar(32) DEFAULT '' COMMENT 'æ“ä½œå‘˜è§’è‰²' \n\t`partnerId` int(8) DEFAULT NULL COMMENT 'äº‹ä»¶ID' \n\t`operateTime` datetime DEFAULT NULL COMMENT 'æ“ä½œæ—¶é—´' \n\t`operateContent` varchar(256) DEFAULT '' COMMENT 'æ“ä½œå†…å®¹' \n\t`checkType` varchar(64) DEFAULT '' COMMENT 'æ“ä½œç±»å‹ï¼ˆç”³è¯·ï¼Œé©³å›ï¼Œé€šè¿‡å®¡æ ¸ï¼‰' \n\t`checkUserId` int(11) DEFAULT NULL \n\t`reason` mediumtext \n\tPRIMARY KEY (`id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 2534 CHARSET = utf8; \nCREATE TABLE `op_check_partner_situation_detail` (\n\t`id` int(8) NOT NULL AUTO_INCREMENT \n\t`check_user_id` int(11) DEFAULT NULL \n\t`partner_id` int(11) DEFAULT NULL \n\t`check_time` datetime DEFAULT NULL \n\t`check_status` tinyint(2) DEFAULT NULL \n\t`check_level` tinyint(2) DEFAULT NULL \n\tPRIMARY KEY (`id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 104 CHARSET = utf8; \nCREATE TABLE `op_menu_management` (\n\t`id` int(8) NOT NULL AUTO_INCREMENT \n\t`parent_id` int(8) DEFAULT '0' COMMENT 'èœå•çˆ¶id' \n\t`menu_name` varchar(64) NOT NULL COMMENT 'èœå•åç§°' \n\t`menu_flag` varchar(32) NOT NULL COMMENT 'èœå•æ ‡è¯†' \n\t`menu_link_address` varchar(128) DEFAULT NULL COMMENT 'äºŒçº§èœå•é“¾æ¥åœ°å€' \n\t`menu_permission` varchar(32) DEFAULT NULL COMMENT 'èœå•æƒé™' \n\tPRIMARY KEY (`id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 104 CHARSET = utf8; \nCREATE TABLE `op_operate_log` (\n\t`id` int(11) NOT NULL AUTO_INCREMENT \n\t`operaterId` int(11) DEFAULT NULL \n\t`operaterName` varchar(64) DEFAULT NULL \n\t`model` varchar(64) DEFAULT NULL \n\t`userId` int(11) DEFAULT NULL \n\t`operateContent` varchar(512) DEFAULT NULL \n\t`timeStamp` datetime DEFAULT NULL \n\tPRIMARY KEY (`id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 1949 CHARSET = utf8; \nCREATE TABLE `op_partner_comment_statistics` (\n\t`id` int(11) NOT NULL AUTO_INCREMENT \n\t`dataDate` datetime(4) DEFAULT NULL COMMENT 'æ—¥æœŸ' \n\t`articleCommentCount` int(4) DEFAULT '0' COMMENT 'æ–‡ç« è¯„è®ºæ•°' \n\t`videoCommentCount` int(4) DEFAULT '0' COMMENT 'è§†é¢‘ç›´æ’­è¯„è®ºæ•°' \n\t`systemClassCommentCount` int(4) DEFAULT '0' COMMENT 'ç³»ç»Ÿè¯¾è¯„è®ºæ•°' \n\tPRIMARY KEY (`id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 422 CHARSET = utf8; \nCREATE TABLE `op_partner_data_statistics` (\n\t`id` int(8) NOT NULL AUTO_INCREMENT \n\t`dataDate` datetime DEFAULT NULL \n\t`partnerId` int(11) DEFAULT NULL \n\t`caiquanCount` int(4) DEFAULT '0' COMMENT 'è´¢åœˆæ•°' \n\t`articleCount` int(4) DEFAULT '0' COMMENT 'æ–‡ç« æ€»æ•°' \n\t`articleMessageCount` int(4) DEFAULT '0' COMMENT 'æ–‡ç« ç•™è¨€æ•°' \n\t`videoDemandClassCount` int(4) DEFAULT '0' COMMENT 'è§†é¢‘ç‚¹æ’­è¯¾æ•°' \n\t`liveClassCount` int(4) DEFAULT '0' COMMENT 'è§†é¢‘ç›´æ’­è¯¾æ•°' \n\t`caiquanReplyCount` int(4) DEFAULT '0' COMMENT 'è´¢åœˆå›å¤æ•°' \n\t`newAttentionCount` int(4) DEFAULT '0' COMMENT 'æ–°å¢å…³æ³¨æ•°' \n\t`cancelAttentionCount` int(4) DEFAULT '0' COMMENT 'å–æ¶ˆå…³æ³¨æ•°' \n\t`increaseAttentionCount` int(4) DEFAULT '0' COMMENT 'å‡€å¢å…³æ³¨æ•°' \n\t`totalAttentionCount` int(4) DEFAULT '0' COMMENT 'ç´¯è®¡å…³æ³¨æ•°' \n\t`caiboCount` int(4) DEFAULT '0' COMMENT 'è´¢æ’­æ•°' \n\t`sales` int(8) DEFAULT '0' COMMENT 'é”€å”®é¢' \n\t`aSharesCount` int(4) DEFAULT '0' COMMENT 'Aè‚¡é›·è¾¾æ•°' \n\t`tuguReplyCount` int(4) DEFAULT '0' COMMENT 'æŠ•é¡¾å›ç­”æ•°' \n\t`remarkCount` int(4) DEFAULT '0' COMMENT 'ç›´æ’­å®¤è€å¸ˆå‘è¨€æ€»æ•°' \n\t`studentSpeakCount` int(4) DEFAULT '0' COMMENT 'ç›´æ’­å®¤ä¸­å­¦å‘˜å‘è¨€æ€»æ•°' \n\t`openReplyCount` int(4) DEFAULT '0' COMMENT 'è€å¸ˆåœ¨ç›´æ’­å®¤ä¸­å…¬å¼€å›å¤æ€»æ•°' \n\t`studentSecretAskCount` int(4) DEFAULT '0' COMMENT 'å­¦å‘˜ç§ä¿¡æé—®æ€»æ•°' \n\t`secretReplyCount` int(4) DEFAULT '0' COMMENT 'è€å¸ˆç§ä¿¡å›å¤æ€»æ•°' \n\t`freeStudentSpeaks` int(4) DEFAULT '0' COMMENT 'å­¦å‘˜å‘è¨€ï¼ˆå…è´¹ï¼‰' \n\t`nonFreeStudentSpeaks` int(4) DEFAULT '0' COMMENT 'å­¦å‘˜å‘è¨€ï¼ˆæ”¶è´¹' \n\t`freeStudentAsks` int(4) DEFAULT '0' COMMENT 'å­¦å‘˜ç§ä¿¡æé—®ï¼ˆå…è´¹ï¼‰' \n\t`nonFreeStudentAsks` int(4) DEFAULT '0' COMMENT 'å­¦å‘˜ç§ä¿¡æé—®ï¼ˆæ”¶è´¹ï¼‰' \n\t`freeTeacherSpeaks` int(4) DEFAULT '0' COMMENT 'è€å¸ˆå…¬å¼€å‘è¨€ï¼ˆå…è´¹ï¼‰' \n\t`nonFreeTeacherSpeaks` int(4) DEFAULT '0' COMMENT 'è€å¸ˆå…¬å¼€å‘è¨€ï¼ˆæ”¶è´¹ï¼‰' \n\t`freeTeacherRepliesPublic` int(4) DEFAULT '0' COMMENT 'è€å¸ˆå…¬å¼€å›å¤ï¼ˆå…è´¹ï¼‰' \n\t`nonFreeTeacherRepliesPublic` int(4) DEFAULT '0' COMMENT 'è€å¸ˆå…¬å¼€å›å¤ï¼ˆæ”¶è´¹ï¼‰' \n\t`freeTeacherRepliesPrivate` int(4) DEFAULT '0' COMMENT 'è€å¸ˆç§å¯†å›å¤ï¼ˆå…è´¹ï¼‰' \n\t`nonFreeTeacherRepliesPrivate` int(4) DEFAULT '0' COMMENT 'è€å¸ˆç§å¯†å›å¤ï¼ˆæ”¶è´¹ï¼‰' \n\t`freeArticleCount` int(4) DEFAULT '0' COMMENT 'å…è´¹æ–‡ç« æ•°' \n\t`nonfreeArticleCount` int(4) DEFAULT '0' COMMENT 'æ”¶è´¹æ–‡ç« æ•°' \n\t`onlineTime` int(4) DEFAULT '0' COMMENT 'è€å¸ˆç›´æ’­å®¤åœ¨çº¿æ—¶é•¿' \n\t`freeStudentCount` int(4) DEFAULT '0' COMMENT 'å…è´¹ç›´æ’­å®¤åœ¨çº¿äººæ•°' \n\t`nonFreeStudentCount` int(4) DEFAULT '0' COMMENT 'æ”¶è´¹ç›´æ’­å®¤åœ¨çº¿äººæ•°' \n\t`freeTeacherSecretSpeaks` int(4) DEFAULT '0' COMMENT 'éšç§è§‚ç‚¹æ•°ï¼ˆå…è´¹ç›´æ’­å®¤ï¼‰' \n\t`nonFreeTeacherSecretSpeaks` int(4) DEFAULT '0' COMMENT 'éšç§è§‚ç‚¹æ•°ï¼ˆæ”¶è´¹ç›´æ’­å®¤æš‚æ— æ•°æ®ï¼‰' \n\t`totalTeacherSecretSpeaks` int(4) DEFAULT '0' COMMENT 'è€å¸ˆéšç§è§‚ç‚¹ï¼ˆæ‰€æœ‰ï¼‰' \n\tPRIMARY KEY (`id`) \n\tUNIQUE `index_data_id` USING BTREE (`dataDate`  `partnerId`) \n\tKEY `index_date` USING BTREE (`dataDate`)\n) ENGINE = InnoDB AUTO_INCREMENT = 1412753 CHARSET = utf8; \nCREATE TABLE `op_partner_data_statistics_log` (\n\t`id` int(8) NOT NULL AUTO_INCREMENT \n\t`partnerId` int(11) DEFAULT NULL \n\t`dataDate` datetime DEFAULT NULL \n\tPRIMARY KEY (`id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 943575 CHARSET = utf8; \nCREATE TABLE `op_product_data` (\n\t`id` int(11) NOT NULL AUTO_INCREMENT \n\t`productId` int(11) DEFAULT NULL \n\t`productName` varchar(100) DEFAULT NULL \n\t`partnerId` int(11) DEFAULT NULL \n\t`checkType` varchar(20) DEFAULT NULL COMMENT 'å®¡æ ¸ç±»å‹' \n\t`productType` varchar(30) DEFAULT NULL \n\t`createTime` datetime DEFAULT NULL \n\t`bussinessProId` varchar(50) DEFAULT NULL \n\t`bussinessCheck` varchar(10) DEFAULT NULL \n\t`bussinessInfo` varchar(1000) DEFAULT NULL \n\t`bussinessLog` varchar(1000) DEFAULT NULL \n\t`modifiTime` datetime DEFAULT NULL \n\t`isClose` int(8) DEFAULT '0' \n\t`verifyCode` varchar(100) DEFAULT NULL \n\tPRIMARY KEY (`id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 137 CHARSET = utf8; \nCREATE TABLE `op_req_external_service_log` (\n\t`id` int(8) NOT NULL AUTO_INCREMENT \n\t`partner_id` int(11) DEFAULT NULL COMMENT 'åˆä½œè€…id' \n\t`service_name` varchar(64) DEFAULT NULL COMMENT 'è¯·æ±‚æ¥å£åç§°' \n\t`req_param` text COMMENT 'è¯·æ±‚å‚æ•°' \n\t`req_time` datetime DEFAULT NULL COMMENT 'è¯·æ±‚æ—¶é—´' \n\t`resp_content` text COMMENT 'æ¥å£è¿”å›å†…å®¹' \n\t`resp_status` tinyint(2) DEFAULT NULL COMMENT 'è¯·æ±‚æ˜¯å¦æˆåŠŸ 0æˆåŠŸ 1å¤±è´¥' \n\t`manual_sync_status` tinyint(2) DEFAULT '0' COMMENT '1 ä»£è¡¨ä¸ºå¤±è´¥çš„è¿™æ¡è®°å½•å·²ç»æ‰‹å·¥åŒæ­¥æ“ä½œ' \n\tPRIMARY KEY (`id`) \n\tKEY `index_partner_id` USING BTREE (`partner_id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 1484 CHARSET = utf8; \nCREATE TABLE `op_violation_forbidden_words` (\n\t`id` int(11) NOT NULL AUTO_INCREMENT \n\t`forbidden_word` varchar(255) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL DEFAULT '' \n\t`add_time` datetime NOT NULL \n\t`creator_user_id` int(11) NOT NULL \n\t`creator_user_nick` varchar(255) NOT NULL \n\tPRIMARY KEY (`id`) \n\tUNIQUE `id_UNIQUE` (`id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 503987 CHARSET = utf8 COMMENT 'æ•æ„Ÿè¯'; \nCREATE TABLE `partner_advertising_data` (\n\t`id` int(8) NOT NULL AUTO_INCREMENT \n\t`partnerId` int(11) DEFAULT NULL COMMENT 'è€å¸ˆid' \n\t`content` text COMMENT 'å¹¿å‘Šå†…å®¹' \n\t`content_h` text COMMENT 'æ‹“å±•å­—æ®µ' \n\t`createTime` datetime DEFAULT NULL COMMENT 'åˆ›å»ºæ—¶é—´' \n\t`createUserId` int(11) DEFAULT NULL COMMENT 'åˆ›å»ºç”¨æˆ·Id' \n\tPRIMARY KEY (`id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 5224 CHARSET = utf8; \nCREATE TABLE `partner_circle_data` (\n\t`id` int(11) NOT NULL AUTO_INCREMENT \n\t`partnerId` int(11) NOT NULL \n\tPRIMARY KEY (`id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 3 CHARSET = utf8; \nCREATE TABLE `partner_config` (\n\t`id` int(4) NOT NULL AUTO_INCREMENT \n\t`partnerId` bigint(20) NOT NULL COMMENT 'åˆä½œè€…id' \n\t`isCombined` tinyint(4) DEFAULT '0' COMMENT 'æ˜¯å¦éšè—ï¼Œ1æ˜¯ç»„åˆè´¦å·ï¼Œ0ä¸æ˜¯ç»„åˆè´¦å·' \n\t`isHide` tinyint(4) NOT NULL DEFAULT '0' COMMENT 'æ˜¯å¦éšè—ï¼Œ1æ˜¯éšè—ï¼Œ0æ˜¯ä¸éšè—' \n\tPRIMARY KEY (`id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 12 CHARSET = utf8; \nCREATE TABLE `partner_data` (\n\t`id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'è‡ªå¢id' \n\t`partnerId` int(11) NOT NULL COMMENT 'ç”¨æˆ·id' \n\t`truename` varchar(25) DEFAULT NULL COMMENT 'çœŸå®å§“å' \n\t`sex` varchar(5) DEFAULT NULL COMMENT 'æ€§åˆ«' \n\t`province` varchar(25) DEFAULT NULL COMMENT 'çœä»½' \n\t`city` varchar(25) DEFAULT NULL COMMENT 'åŸå¸‚' \n\t`qq` varchar(25) DEFAULT NULL COMMENT 'qqå·' \n\t`blog` varchar(250) DEFAULT NULL COMMENT 'åšå®¢' \n\t`weibo` varchar(250) DEFAULT NULL COMMENT 'å¾®åš' \n\t`orgname` varchar(100) DEFAULT NULL COMMENT 'ç»„ç»‡åç§°' \n\t`intro` text COMMENT 'ç®€ä»‹' \n\t`noticeType` varchar(10) DEFAULT NULL COMMENT 'æ ‡ç­¾ç±»å‹' \n\t`noticeInfo` text COMMENT 'å†…å®¹' \n\t`level` varchar(32) DEFAULT NULL COMMENT 'å†…å®¹' \n\t`modifitime` datetime DEFAULT NULL COMMENT 'æœ€åä¿®æ”¹æ—¶é—´' \n\t`createtime` datetime DEFAULT NULL COMMENT 'åˆ›å»ºæ—¶é—´' \n\t`cooperationState` tinyint(2) DEFAULT '0' COMMENT '0æœªåˆä½œï¼Œ1åˆä½œï¼Œ2æš‚åœï¼Œ3æ‹‰é»‘' \n\t`aplanstate` tinyint(2) DEFAULT '0' COMMENT '0 ä»£è¡¨ç¦ç”¨ï¼Œ1å¼€å¯' \n\t`zhibostate` tinyint(2) DEFAULT '1' COMMENT 'æ–‡å­—ç›´æ’­æœåŠ¡0 ä»£è¡¨ç¦ç”¨ï¼Œ1å¼€å¯' \n\t`busDepartment` varchar(500) DEFAULT NULL \n\t`jobCode` varchar(250) DEFAULT NULL \n\t`adviserCooperationState` tinyint(2) DEFAULT '0' COMMENT '0æœªåˆä½œï¼Œ1åˆä½œï¼Œ2æš‚åœï¼Œ3æ‹‰é»‘' \n\t`openWeChatPlatform` tinyint(2) DEFAULT '0' COMMENT '0æœªå¼€é€šå¾®ä¿¡å¹³å°ï¼Œ1å¼€é€šå¾®ä¿¡å¹³å°' \n\t`adviserHide` tinyint(2) DEFAULT '0' COMMENT '1éšè—' \n\t`openEntrust` tinyint(2) DEFAULT '0' COMMENT '0æ˜¯æ²¡æœ‰æƒé™ï¼Œ1æ˜¯æœ‰æƒé™' \n\tPRIMARY KEY (`id`) \n\tUNIQUE `partnerId` (`partnerId`) \n\tKEY `level` USING BTREE (`level`)\n) ENGINE = InnoDB AUTO_INCREMENT = 7171 CHARSET = utf8; \nCREATE TABLE `partner_navigation` (\n\t`id` int(11) NOT NULL AUTO_INCREMENT \n\t`partnerId` int(11) NOT NULL COMMENT 'åˆä½œè€…id' \n\t`navigation` varchar(250) DEFAULT NULL \n\tPRIMARY KEY (`id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 882 CHARSET = utf8; \nCREATE TABLE `partner_notice` (\n\t`id` int(8) NOT NULL AUTO_INCREMENT \n\t`title` varchar(64) DEFAULT NULL \n\t`content` varchar(512) DEFAULT NULL \n\t`createTime` datetime DEFAULT NULL \n\t`createUserName` varchar(64) DEFAULT NULL \n\tPRIMARY KEY (`id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 68 CHARSET = utf8; \nCREATE TABLE `partner_notice_number` (\n\t`id` int(11) NOT NULL AUTO_INCREMENT \n\t`partnerId` int(11) DEFAULT NULL \n\t`readNumber` int(11) DEFAULT NULL \n\tPRIMARY KEY (`id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 464 CHARSET = utf8; \nCREATE TABLE `partner_organization` (\n\t`id` int(4) NOT NULL AUTO_INCREMENT \n\t`partnerId` int(8) DEFAULT NULL COMMENT 'åˆä½œè€…id' \n\t`organization` varchar(25) DEFAULT NULL \n\tPRIMARY KEY (`id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 95 CHARSET = utf8; \nCREATE TABLE `partner_organization_data` (\n\t`id` int(11) NOT NULL AUTO_INCREMENT \n\t`organizationName` varchar(250) DEFAULT NULL \n\t`organizationId` varchar(250) NOT NULL \n\t`organizationLogo` varchar(500) DEFAULT NULL COMMENT 'æœºæ„logo' \n\t`organizationUrl` varchar(500) DEFAULT NULL COMMENT 'æœºæ„åœ°å€' \n\t`isDelete` tinyint(4) NOT NULL DEFAULT '0' COMMENT 'æ˜¯å¦åˆ é™¤0æ˜¯åˆ é™¤ï¼Œ1æ˜¯ä¸åˆ é™¤' \n\t`isOnline` tinyint(4) NOT NULL DEFAULT '0' COMMENT 'æ˜¯å¦ä¸Šçº¿ï¼Œ0æ˜¯ä¸ä¸Šçº¿ï¼Œ1æ˜¯ä¸Šçº¿' \n\t`organizationLogoh5_2` varchar(500) DEFAULT NULL COMMENT 'h5  ç¬¬äºŒä¸ªlogo' \n\t`organizationLogoh5` varchar(500) DEFAULT NULL COMMENT 'h5æœºæ„logo' \n\t`organizationUrlh5` varchar(500) DEFAULT NULL COMMENT 'h5æœºæ„url' \n\tPRIMARY KEY (`id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 11 CHARSET = utf8; \nCREATE TABLE `partner_recommend` (\n\t`partner_id` int(11) NOT NULL COMMENT 'è€å¸ˆid' \n\t`partner_order` int(11) NOT NULL COMMENT 'æ’åº' \n\t`open_recommend` tinyint(2) DEFAULT NULL COMMENT 'æ˜¯å¦æ‰“å¼€æ¨è' \n\tPRIMARY KEY (`partner_id`) \n\tUNIQUE `index_partner_id` USING BTREE (`partner_id`)\n) ENGINE = InnoDB CHARSET = utf8; \nCREATE TABLE `partner_recommend_copy` (\n\t`partner_id` int(11) NOT NULL COMMENT 'è€å¸ˆid' \n\t`partner_order` int(11) NOT NULL COMMENT 'æ’åº' \n\t`open_recommend` tinyint(2) DEFAULT NULL COMMENT 'æ˜¯å¦æ‰“å¼€æ¨è' \n\tPRIMARY KEY (`partner_id`) \n\tUNIQUE `index_partner_id` USING BTREE (`partner_id`)\n) ENGINE = InnoDB CHARSET = utf8; \nCREATE TABLE `partner_service_data` (\n\t`id` int(11) NOT NULL AUTO_INCREMENT \n\t`partnerId` int(11) NOT NULL COMMENT 'åˆä½œè€…id' \n\t`serviceStatus` tinyint(4) NOT NULL COMMENT 'æ˜¯å¦æ˜¾ç¤ºæœåŠ¡æŒ‰é’®' \n\t`aplanStatus` tinyint(4) NOT NULL COMMENT 'æ˜¯å¦æ˜¾ç¤ºAè®¡åˆ’' \n\t`articleStatus` tinyint(4) NOT NULL COMMENT 'æ˜¯å¦æ˜¾ç¤ºæ–‡ç« ' \n\t`circleStatus` tinyint(4) NOT NULL COMMENT 'æ˜¯å¦æ˜¾ç¤ºåœˆå­' \n\t`classesStatus` tinyint(4) NOT NULL COMMENT 'æ˜¯å¦æ˜¾ç¤ºè¯¾ç¨‹' \n\t`blogStatus` tinyint(4) DEFAULT NULL COMMENT 'æ˜¯å¦æ˜¾ç¤ºåšå®¢' \n\t`aplanUrl` varchar(500) DEFAULT NULL COMMENT 'aè®¡åˆ’é“¾æ¥' \n\t`articleUrl` varchar(500) DEFAULT NULL COMMENT 'æ–‡ç« url' \n\t`circleUrl` varchar(500) DEFAULT NULL COMMENT 'åœˆå­url' \n\t`classUrl` varchar(500) DEFAULT NULL COMMENT 'è¯¾ç¨‹url' \n\t`blogUrl` varchar(500) DEFAULT NULL COMMENT 'åšå®¢url' \n\tPRIMARY KEY (`id`) \n\tKEY `partnerId` USING BTREE (`partnerId`)\n) ENGINE = InnoDB AUTO_INCREMENT = 15 CHARSET = utf8; \nCREATE TABLE `partner_signelectric` (\n\t`id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'è‡ªå¢ä¸»é”®' \n\t`partnerId` int(11) NOT NULL COMMENT 'åˆä½œè€…id' \n\t`partnerName` varchar(50) DEFAULT NULL COMMENT 'åˆä½œè€…åç§°' \n\t`trueName` varchar(20) DEFAULT NULL COMMENT 'çœŸå®å§“å' \n\t`idCard` varchar(50) DEFAULT NULL COMMENT 'èº«ä»½è¯å·' \n\t`address` varchar(200) DEFAULT NULL COMMENT 'åœ°å€' \n\t`createtime` datetime DEFAULT NULL COMMENT 'åˆ›å»ºæ—¶é—´' \n\t`modifitime` datetime DEFAULT NULL COMMENT 'æœ€åä¿®æ”¹æ—¶é—´' \n\tPRIMARY KEY (`id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 1279 CHARSET = utf8; \nCREATE TABLE `partner_tag_category` (\n\t`id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'è‡ªå¢ä¸»é”®' \n\t`categoryId` int(11) NOT NULL DEFAULT '0' COMMENT 'æ ç›®id' \n\t`parentId` int(11) DEFAULT NULL COMMENT 'çˆ¶æ ç›®id' \n\t`categoryName` varchar(50) DEFAULT NULL COMMENT 'æ ç›®åç§°' \n\t`categoryType` int(11) DEFAULT NULL COMMENT 'æ ç›®ç±»å‹' \n\tPRIMARY KEY (`id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 16 CHARSET = utf8; \nCREATE TABLE `partner_tag_data` (\n\t`id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'è‡ªå¢ä¸»é”®' \n\t`tagId` int(11) NOT NULL DEFAULT '0' COMMENT 'æ ‡çš„id' \n\t`tagName` varchar(50) DEFAULT NULL COMMENT 'æ ‡çš„åç§°' \n\t`tagType` int(11) DEFAULT NULL COMMENT 'æ ‡çš„ç±»å‹' \n\t`categoryId` int(11) DEFAULT NULL COMMENT 'æ ‡çš„æ ç›®' \n\tPRIMARY KEY (`id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 49 CHARSET = utf8; \nCREATE TABLE `partner_user_tag` (\n\t`id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'è‡ªå¢ä¸»é”®' \n\t`partnerId` int(11) DEFAULT NULL COMMENT 'åˆä½œè€…id' \n\t`tag` varchar(200) DEFAULT NULL COMMENT 'æ ‡çš„' \n\t`tagType` int(4) DEFAULT NULL COMMENT 'ç±»å‹' \n\t`createtime` datetime DEFAULT NULL COMMENT 'æ—¶é—´' \n\t`userDefined` tinyint(1) DEFAULT NULL \n\tPRIMARY KEY (`id`)\n) ENGINE = InnoDB AUTO_INCREMENT = 64455 CHARSET = utf8; \nCREATE TABLE `statistics_px-operation-app` (\n\t`id` int(11) NOT NULL AUTO_INCREMENT \n\t`timestamp` bigint(1) NOT NULL DEFAULT '0' COMMENT 'æ—¶é—´æˆ³' \n\t`serviceInterface` varchar(255) NOT NULL DEFAULT '' COMMENT 'æ¥å£å' \n\t`method` varchar(255) NOT NULL DEFAULT '' COMMENT 'æ–¹æ³•å' \n\t`type` varchar(10) DEFAULT NULL COMMENT 'å½“å‰è°ƒç”¨çš„åº”ç”¨ç±»å‹' \n\t`tps` float(11  2) NOT NULL DEFAULT '0.00' COMMENT 'TPSå€¼' \n\t`kbps` float(11  2) DEFAULT NULL COMMENT 'æµé‡' \n\t`host` varchar(50) DEFAULT NULL COMMENT 'ipåœ°å€' \n\t`elapsed` int(11) DEFAULT NULL COMMENT 'è€—æ—¶' \n\t`concurrent` int(11) DEFAULT NULL COMMENT 'å¹¶å‘æ•°' \n\t`input` int(11) DEFAULT NULL COMMENT 'è¾“å…¥å€¼' \n\t`output` int(11) DEFAULT NULL COMMENT 'è¾“å‡ºå¤§å°' \n\t`successCount` int(11) DEFAULT NULL COMMENT 'æˆåŠŸæ¬¡æ•°' \n\t`failureCount` int(11) DEFAULT NULL COMMENT 'å¤±è´¥æ¬¡æ•°' \n\t`remoteAddress` varchar(50) DEFAULT NULL COMMENT 'è¿œç¨‹åœ°å€' \n\t`remoteType` varchar(20) DEFAULT NULL COMMENT 'è¿œç¨‹åº”ç”¨ç±»å‹' \n\tPRIMARY KEY (`id`) \n\tKEY `time-index` (`timestamp`) \n\tKEY `method-index` (`method`) \n\tKEY `service-index` (`serviceInterface`)\n) ENGINE = InnoDB AUTO_INCREMENT = 168704 CHARSET = utf8; \nCREATE TABLE `statistics_zhibo-app` (\n\t`id` int(11) NOT NULL AUTO_INCREMENT \n\t`timestamp` bigint(1) NOT NULL DEFAULT '0' COMMENT 'æ—¶é—´æˆ³' \n\t`serviceInterface` varchar(255) NOT NULL DEFAULT '' COMMENT 'æ¥å£å' \n\t`method` varchar(255) NOT NULL DEFAULT '' COMMENT 'æ–¹æ³•å' \n\t`type` varchar(10) DEFAULT NULL COMMENT 'å½“å‰è°ƒç”¨çš„åº”ç”¨ç±»å‹' \n\t`tps` float(11  2) NOT NULL DEFAULT '0.00' COMMENT 'TPSå€¼' \n\t`kbps` float(11  2) DEFAULT NULL COMMENT 'æµé‡' \n\t`host` varchar(50) DEFAULT NULL COMMENT 'ipåœ°å€' \n\t`elapsed` int(11) DEFAULT NULL COMMENT 'è€—æ—¶' \n\t`concurrent` int(11) DEFAULT NULL COMMENT 'å¹¶å‘æ•°' \n\t`input` int(11) DEFAULT NULL COMMENT 'è¾“å…¥å€¼' \n\t`output` int(11) DEFAULT NULL COMMENT 'è¾“å‡ºå¤§å°' \n\t`successCount` int(11) DEFAULT NULL COMMENT 'æˆåŠŸæ¬¡æ•°' \n\t`failureCount` int(11) DEFAULT NULL COMMENT 'å¤±è´¥æ¬¡æ•°' \n\t`remoteAddress` varchar(50) DEFAULT NULL COMMENT 'è¿œç¨‹åœ°å€' \n\t`remoteType` varchar(20) DEFAULT NULL COMMENT 'è¿œç¨‹åº”ç”¨ç±»å‹' \n\tPRIMARY KEY (`id`) \n\tKEY `time-index` (`timestamp`) \n\tKEY `method-index` (`method`) \n\tKEY `service-index` (`serviceInterface`)\n) ENGINE = InnoDB AUTO_INCREMENT = 1657961 CHARSET = utf8; \n"}	 
979,reset last position when apply snapshot to database applySnapshotToDBé‡Œåšresetçš„æ„ä¹‰æ˜¯ï¼Ÿ ![image](https://user-images.githubusercontent.com/8461826/46252914-816dc180-c4a2-11e8-8eef-39f8a859b2aa.png) å¦‚æœä¸reset  å³ä½¿æ²¡æœ‰ddlå˜æ›´   è¿™é‡Œçš„positionä»ç„¶æŒ‡å‘ä¸Šä¸€æ¬¡ddlçš„ä½ç‚¹ applySnapshotToDBé‡Œçš„positionä¼ å…¥çš„å°±æ˜¯æœ€åä¸€æ¬¡DDLå˜æ›´åº”ç”¨åˆ°å†…å­˜ç»“æ„çš„ä½ç‚¹ï¼Œè¿˜æ˜¯æ²¡æ˜ç™½ä¸ºå•¥è¦åšreset
978,è§£å†³kafka å®¢æˆ·ç«¯æ¶ˆæ¯æ— æ³•ackçš„bug è§£å†³kafka å®¢æˆ·ç«¯æ¶ˆæ¯æ— æ³•ackçš„bug
977,åŒæ­¥ä½ç‚¹é—®é¢˜ canal ç‰ˆæœ¬ï¼š1.0.24 æºå®ä¾‹ï¼šRDS é—®é¢˜ï¼šcanal serveråœ¨å¯åŠ¨ä¹‹åï¼Œé…ç½®äº†å¤šä¸ªintancaesï¼Œå¦‚æœåœ¨è®¢é˜…çš„è¿‡ç¨‹å‘ç”Ÿäº†rdsä¸»å¤‡åˆ‡æ¢æˆ–è€…å®ä¾‹è¿ç§»ï¼Œæ€ä¹ˆä¿®å¤ï¼Ÿ(ç»è¿‡è¯•è¿‡ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶åªæ˜¯å°†intancesè¿›è¡Œreloadï¼Œä¿®æ”¹ä¿¡æ¯ä¸ä¼šåŒæ­¥è‡³zkä¸­ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™åº”è¯¥æ€ä¹ˆåš) åœæ­¢canal serverï¼Œåˆ é™¤zookeeperä¸­/otter/canal/destinations/${your_instance}/1001 æ•´ä¸ªznodeï¼Œå†é‡å¯canal server @1241407808 å¦‚æœæ˜¯å¯¹åº”çš„å¤šä¸ªintancesï¼Œé‡å¯serverä¼šå¯¹å…¶ä»–çš„intancesæœ‰å½±å“å—ï¼Ÿ å½“ç„¶ä¼šï¼Œå…¶ä»–çš„instanceä¼šåœæ‰ï¼› canal serverä¼šæŠŠå…¶ä»–instance çš„ä½ç‚¹è®°å½•åˆ°zkä¸­ï¼Œä¸‹ä¸€æ¬¡å¯åŠ¨ä¼šæŒ‰ç…§å¯¹åº”çš„ä½ç‚¹ç»§ç»­ã€‚ å¤šè°¢äº† 
976,canal-kafka-1.1.0ç‰ˆæœ¬ï¼Œbinlogæ²¡æœ‰å˜åŒ–çš„æ—¶å€™ï¼Œcpuå ç”¨è·‘æ»¡ä¸€ä¸ªæ ¸å¿ƒ99.99% cpu (50.00% of 2 core) ä½¿ç”¨canal-kafka-1.1.0ç‰ˆæœ¬ï¼Œcanal.propertiesä½¿ç”¨çš„é»˜è®¤é…ç½®ï¼Œå¯åŠ¨åcpuå ç”¨å°±å¾ˆé«˜ï¼Œbinlogæ²¡æœ‰å˜åŒ– æœåŠ¡å™¨CPUä¿¡æ¯ [cpuinfo.txt](https://github.com/alibaba/canal/files/2430253/cpuinfo.txt) çº¿ç¨‹è°ƒç”¨ä¿¡æ¯ä¸ºï¼š ![123](https://user-images.githubusercontent.com/16751056/46240746-a862bf80-c3de-11e8-9707-8a6bb6771a6e.png) ç«ç„°å›¾ ![image](https://user-images.githubusercontent.com/16751056/46240795-5bcbb400-c3df-11e8-9e51-874821bc76fa.png) æ˜¯å› ä¸ºæœºå™¨é…ç½®ä½è¿˜æ˜¯å…¶ä»–åŸå›  è¯·è·Ÿæ–°æœ€æ–°ç‰ˆæœ¬ #904
975,æ•°æ®ä¸€ç›´åœ¨åŒæ­¥ä½†æ•°æ®é‡ä¸å¯¹  ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x127a1b89  /5.39.221.52:60106 => æˆ‘çš„canal ip æ¯éš”å‡ ç§’å°±æŠ¥ä¸€æ¬¡è¿™ä¸ªé”™ï¼Œå¤§ä½¬ï¼Œæ˜¯æœ‰äººå·è¿æˆ‘çš„canalå— ï¼Œè¿™ä¸ªipå¥½åƒæ˜¯è·å…°çš„ 5.39.221.52:60106 ä½ è‡ªå·±ä¸è¦æš´éœ²åˆ°å…¬ç½‘ä¸Šå•Š -_-#
973,[ISSUE 800]æä¾›RocketMQåŸç”Ÿæ¥å…¥canal æä¾›äº†rocketmq Connectorå¯¹æ¥canalï¼Œä½†æ˜¯ç›®å‰ä»…æ”¯æŒå•åˆ†åŒºæœ‰åºï¼Œå¾…ä¸Šå±‚canal messageå¯ä»¥æŒ‰ç…§ä¸šåŠ¡å­—æ®µhashæ‹†åˆ†èšåˆåï¼Œå†åšå¤šåˆ†åŒºæœ‰åºï¼Œä½†æ˜¯è¿™æ ·å¯¹canalçš„æ”¹åŠ¨è¾ƒå¤§ï¼› åç»­æŒ‰ç…§è¡¨æ˜åšå¤šåˆ†åŒºæœ‰åºå¤„ç†ï¼Œä½†æ˜¯åœ¨è¡¨ä¹‹é—´å‡ºç°å…³è”æ—¶ï¼Œä¼šå­˜åœ¨é—®é¢˜ã€‚ [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=973) <br/>All committers have signed the CLA. [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=973) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=973) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=973) it.</sub> å®¢æˆ·ç«¯çš„canal-client.ymlé…ç½®æ ¼å¼æœ‰ç‚¹é—®é¢˜ï¼Œåº”è¯¥æ”¹æˆï¼š ``` mqTopics: - mqMode: kafka   topic: example   groups:   - groupId: example_g1     outAdapters:     - name: logger ``` rocketMQå¯ä»¥è€ƒè™‘å¢åŠ å¯¹FlatMessageçš„æ”¯æŒï¼Œåšæ•°æ®hashåˆ†ç‰‡
972,canal1.1.0 ZKæ¨¡å¼è¿è¡Œä¸€æ®µæ—¶é—´å°±åœæ­¢æ¶ˆè´¹ClosedChannelException é‡å¯å®¢æˆ·ç«¯ä¹‹åç»§ç»­æ¶ˆè´¹ï¼Œä½†æ˜¯ä½ç‚¹ä¸æ›´æ–°äº† ä»¥ä¸‹æ˜¯canalæœåŠ¡ç«¯å‡ºç°çš„çš„é”™è¯¯æ—¥å¿— 2018-09-26 17:14:32.336 [New I/O server worker #1-16] ERROR c.a.otter.canal.server.netty.handler.Ses sionHandler - something goes wrong with channel:[id: 0x4b49367f  /172.16.40.202:46512 :> /172.16.40. 200:11111]  exception=java.nio.channels.ClosedChannelException 	at org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:629) 	at org.jboss.netty.channel.socket.nio.NioWorker.close(NioWorker.java:605) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioSe rverSocketPipelineSink.java:119) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketP ipelineSink.java:76) 	at org.jboss.netty.channel.Channels.close(Channels.java:720) 	at org.jboss.netty.channel.AbstractChannel.close(AbstractChannel.java:208) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.exceptionCaught(SessionHandle r.java:272) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwar eChannelHandler.java:48) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.exceptionCaught(ReplayingDecoder.ja va:462) 	at org.jboss.netty.channel.Channels.fireExceptionCaught(Channels.java:432) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:332) 	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:281) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:201) 	at org.jboss.netty.util.internal.IoWorkerRunnable.run(IoWorkerRunnable.java:46) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) 	at java.lang.Thread.run(Thread.java:748) 2018-09-26 17:15:30.046 [New I/O server worker #1-1] ERROR c.a.otter.canal.server.netty.handler.Sess ionHandler - something goes wrong with channel:[id: 0x7ac76894  /172.16.40.202:51872 => /172.16.40.2 00:11111]  exception=java.io.IOException: Connection reset by peer 	at sun.nio.ch.FileDispatcherImpl.read0(Native Method) 	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39) 	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223) 	at sun.nio.ch.IOUtil.read(IOUtil.java:192) 	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:322) 	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:281) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:201) 	at org.jboss.netty.util.internal.IoWorkerRunnable.run(IoWorkerRunnable.java:46) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) 	at java.lang.Thread.run(Thread.java:748) é‡å¯æœåŠ¡ç«¯ï¼Œä½ç‚¹å¼€å§‹æ›´æ–°äº†
971,Question: canal v1.1.0  ä¸ºä»€ä¹ˆå­˜åœ¨DatabaseTableMeta#compareTableMetaDbAndMemoryè¿™æ ·çš„ä¸€ä¸ªæ¯”è¾ƒè¿‡ç¨‹ï¼Ÿ å¦‚é¢˜ ä¸ºäº†ç¡®ä¿åŸºäºå†…å­˜tsdbç»´æŠ¤çš„è¡¨ç»“æ„æ­£ç¡®æ€§ï¼Œåœ¨åšsnapshotä¹‹å‰å’Œå½“å‰æ•°æ®åº“åšä¸€ä¸‹å¯¹æ¯” åœ¨å†…å­˜tsdbç»´æŠ¤çš„è¡¨ç»“æ„æ­£ç¡®çš„æƒ…å†µä¸‹ï¼Œä¸‹é¢ä¸¤ä¸­æƒ…å†µä»ç„¶ä¼šå¯¼è‡´DatabaseTableMeta#compareTableMetaDbAndMemoryè¿”å›false 1. canalæ¶ˆè´¹å­˜åœ¨æ¯”è¾ƒå¤§çš„å»¶è¿Ÿï¼Œæ­¤æ—¶å†…å­˜ä¸­çš„è¡¨ç»“æ„å’ŒmysqlçœŸå®çš„è¡¨ç»“æ„å­˜åœ¨å·®å¼‚ 2. å›é€€ä½ç‚¹ï¼Œé‡å¤æ¶ˆè´¹binlogï¼Œæ¶ˆè´¹å¾ˆæ…¢ï¼Œ24å°æ—¶å†…ä»æœªè¿½ä¸Šæœ€æ–°çš„ä½ç‚¹ snapshotä¼šæ¯é—´éš”24å°æ—¶å®šæ—¶å‘èµ·ï¼Œå¦‚æœä¸€æ¬¡ä¸­å¯¹æ¯”å¤±è´¥ï¼Œå¯ä»¥åœ¨ä¸‹ä¸€æ¬¡å¯¹æ¯”æˆåŠŸåè®°å½• 3Q  æˆ‘æ¸…æ¥šè¿™å—çš„è®¾è®¡æ„å›¾äº†
970, fix bug #968 bug é‡ç°: 1. å¯ç”¨å¹¶è¡Œè§£æ 2. æ­£å¸¸è¿æ¥æºç«¯æ•°æ®åº“ - æ‰“å°çº¿ç¨‹æ•° 3. å…³é—­æºç«¯æ•°æ®åº“ - æ‰“å°çº¿ç¨‹æ•° é€šè¿‡é¢‘ç¹æ‰“å°å½“å‰çš„çº¿ç¨‹æ•°å¯å‘ç°çº¿ç¨‹æ•°åœ¨ä¸æ–­é€’å¢ï¼Œç›´è‡³OOM èµä¸€ä¸ª
969,Fix link error as title tks
968,å¹¶è¡Œè§£æä¸‹ï¼Œæ•°æ®åº“ä¸€ç›´è¿ä¸ä¸Šå¯¼è‡´OOMå¼‚å¸¸ ç‰ˆæœ¬ v1.1.1-alpha 1 heapdump: ![image](https://user-images.githubusercontent.com/33280738/46004767-435d5000-c0e6-11e8-942d-1b283879a799.png) 
967,Canal è¿è¡Œä¸€æ®µæ—¶é—´ æœåŠ¡ç«¯æŠ¥é”™? [New I/O server worker #1-2] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x5c5493e4  /10.152.0.121:18964 => /10.193. 16.48:11111]  exception=java.io.IOException: Connection reset by peer canal ç‰ˆæœ¬ 1.1.0 çœ‹å…¶ä»–issue è¯´æ˜¯idleTimeout è¿™ä¸ªç©ºé—²è¶…æ—¶æ—¶é—´çš„é—®é¢˜ æˆ‘çœ‹äº†ä¸‹æŠ¥é”™çš„ç‚¹  å¥½åƒå°±æ˜¯åœ¨1ä¸ªå°æ—¶ä¹‹åæŠ¥é”™ã€‚æˆ‘æƒ³é—®ä¸‹ã€‚æˆ‘å¯ä»¥è®¾ç½®è¿™ä¸ªidleTimeout å‚æ•°çš„æ—¶é—´ä¹ˆã€‚è°¢è°¢ï¼ SimpleCanalConnector.idleTimeout
966,æºç é—®é¢˜ï¼Œå…³äºMemoryEventStoreWithBuffer#checkFreeSlotAtå®ç°çš„ç–‘é—®ã€‚ MemoryEventStoreWithBufferçš„putæ“ä½œä¼šè°ƒç”¨checkFreeSlotAtæ£€æŸ¥æ˜¯å¦æœ‰ç©ºä½ã€‚æºç å¦‚ä¸‹ï¼š `private boolean checkFreeSlotAt(final long sequence) {          final long wrapPoint = sequence - bufferSize;         final long minPoint = getMinimumGetOrAck();         if (wrapPoint > minPoint) { // åˆšå¥½è¿½ä¸Šä¸€è½®             return false;         } else {            //...         }     }` æˆ‘æƒ³çŸ¥é“ï¼Œä¸ºä»€ä¹ˆè°ƒç”¨getMinimumGetOrAck()æ–¹æ³•æ¥è·å¾—getSequenceæˆ–ackSequenceçš„è¾ƒå°å€¼ï¼ŒackSequenceä¸åº”è¯¥æ€»æ˜¯å°äºç­‰äºgetSequenceå—ï¼Ÿç›´æ¥ä¸ackSequenceæ¯”è¾ƒä¸å°±å¯ä»¥äº†ï¼Ÿ æ˜¯çš„ï¼Œack < get  < putï¼ŒåŸºæœ¬æ»¡è¶³è¿™ä¸ªå…³ç³»
965,tsdbæŒä¹…åŒ–å­˜å‚¨çš„æ–¹æ¡ˆä½¿ç”¨mysqlæ—¶å¯ä»¥æ­£å¸¸ç›‘å¬åˆ°æ•°æ®ï¼Œæ”¹æˆh2ä¹‹åå°±ç›‘å¬ä¸åˆ°æ•°æ®äº† ç‰ˆæœ¬æ˜¯1.1.0 canal.propertiesä¸­çš„h2é…ç½® #table meta tsdb info canal.instance.tsdb.enable=true canal.instance.tsdb.dir=${canal.file.data.dir:../conf}/${canal.instance.destination:} canal.instance.tsdb.url=jdbc:h2:${canal.instance.tsdb.dir}/h2;CACHE_SIZE=1000;MODE=MYSQL; canal.instance.tsdb.dbUsername=canal canal.instance.tsdb.dbPassword=canal instance.properties ä¸­çš„h2é…ç½® #table meta tsdb info  #è®°å½•æŒ‰æ—¶é—´åºåˆ—è®°å½•è¡¨ç»“æ„  canal.instance.tsdb.enable=true #å°†è¡¨ç»“æ„æ•°æ®ä¿å­˜åœ¨h2 åµŒå…¥å¼æ•°æ®åº“ä¸­ canal.instance.tsdb.url=jdbc:h2:${canal.instance.tsdb.dir}/h2;CACHE_SIZE=1000;MODE=MYSQL; canal.instance.tsdb.dbUsername=canal canal.instance.tsdb.dbPassword=canal æ‰“å¼€h2 çš„æ•°æ®åº“æ–‡ä»¶å‘ç°meta_history å’Œ meta_snapshot ä¸­éƒ½æ²¡æœ‰æ•°æ®ã€‚ ![h2](https://user-images.githubusercontent.com/10652165/45876725-0cc5c380-bdce-11e8-8d64-dd5814762051.png) é—®é¢˜å¤ªç¬¼ç»Ÿï¼Œå…³æ³¨serverå¼‚å¸¸æ—¥å¿—
964,å»ºç«‹tsdbçš„meta_historyè¡¨çš„å»ºè¡¨è¯­å¥ä¸­çš„å­—æ®µä¸sqlmap_historyä¸­æŸ¥è¯¢è¯­å¥çš„å­—æ®µä¸ä¸€æ ·ï¼Œå¯¼è‡´æ›´æ”¹è¡¨ç»“æ„æ—¶æŠ¥é”™ ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯1.1.0 conf\spring\tsdb\sql\create_table.sql ä¸­å»ºç«‹meta_historyè¡¨çš„å»ºè¡¨è¯­å¥å¦‚ä¸‹: ``` CREATE TABLE IF NOT EXISTS `meta_history` (   `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®'   `gmt_create` datetime NOT NULL COMMENT 'åˆ›å»ºæ—¶é—´'   `gmt_modified` datetime NOT NULL COMMENT 'ä¿®æ”¹æ—¶é—´'   `destination` varchar(128) DEFAULT NULL COMMENT 'é€šé“åç§°'   `binlog_file` varchar(64) DEFAULT NULL COMMENT 'binlogæ–‡ä»¶å'   `binlog_offest` bigint(20) DEFAULT NULL COMMENT 'binlogåç§»é‡'   `binlog_master_id` varchar(64) DEFAULT NULL COMMENT 'binlogèŠ‚ç‚¹id'   `binlog_timestamp` bigint(20) DEFAULT NULL COMMENT 'binlogåº”ç”¨çš„æ—¶é—´æˆ³'   `use_schema` varchar(1024) DEFAULT NULL COMMENT 'æ‰§è¡Œsqlæ—¶å¯¹åº”çš„schema'   `schema` varchar(1024) DEFAULT NULL COMMENT 'å¯¹åº”çš„schema'   `table` varchar(1024) DEFAULT NULL COMMENT 'å¯¹åº”çš„table'   `sql` longtext DEFAULT NULL COMMENT 'æ‰§è¡Œçš„sql'   `type` varchar(256) DEFAULT NULL COMMENT 'sqlç±»å‹'   `extra` text DEFAULT NULL COMMENT 'é¢å¤–çš„æ‰©å±•ä¿¡æ¯'   PRIMARY KEY (`id`)   UNIQUE KEY binlog_file_offest(`destination` `binlog_master_id` `binlog_file` `binlog_offest`)   KEY `destination` (`destination`)   KEY `destination_timestamp` (`destination` `binlog_timestamp`)   KEY `gmt_modified` (`gmt_modified`) ) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='è¡¨ç»“æ„å˜åŒ–æ˜ç»†è¡¨'; ``` conf\spring\tsdb\sql-map\sqlmap_history.xml ä¸­æŸ¥è¯¢çš„å­—æ®µå¦‚ä¸‹: ```xml   <sql id="allVOColumns">         <![CDATA[ 		a.id as id a.gmt_create as gmtCreate a.gmt_modified as gmtModified 		a.destination as destination a.binlog_file as binlogFile a.binlog_offest as binlogOffest a.binlog_master_id as binlogMasterId a.binlog_timestamp as binlogTimestamp 		a.use_schema as useSchema a.sql_schema as sqlSchema a.sql_table as sqlTable a.sql_text as sqlText a.sql_type as sqlType a.extra as extra         ]]>     </sql> ``` ä¸ä¸€è‡´çš„å­—æ®µ: shema -> sql_shema table ->sql_table sql ->sql_text type ->sql_type æœ€æ–°ä¸»å¹²å·²ç»ä¿®å¤
963,Canal ClientIdentity ä¸­çš„destination å’Œ clientId å«ä¹‰æ˜¯ä»€ä¹ˆ? è¯·å¸®å¿™è§£é‡Šä¸€ä¸‹ã€‚ å¤šçœ‹wiki
962,canal clientå¦‚ä½•è‡ªå®šä¹‰clientç«¯è·å–åˆ°çš„å­—æ®µå†…å®¹çš„æ•°æ®ç±»å‹ï¼Ÿ canal clientç«¯è·å–åˆ°çš„å­—æ®µå†…å®¹é»˜è®¤ä¸ºstringç±»å‹ï¼Œè¯·å¤§ç¥æŒ‡æ•™å¦‚ä½•æ‰èƒ½å¤Ÿè‡ªå®šä¹‰clientç«¯è·å–åˆ°çš„å­—æ®µå†…å®¹çš„æ•°æ®ç±»å‹ï¼Ÿ å¤šçœ‹wikiï¼Œæ ¹æ®ä¸šåŠ¡ç±»å‹è‡ªè¡Œå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå…·ä½“type
961,canal clientç«¯è·å–çš„floatç±»å‹å­—æ®µçš„â€œç²¾åº¦â€ä¸mysqlä¸­çš„ä¸ä¸€è‡´ ç°è±¡ï¼š 1. mysqlä¸­æºè¡¨çš„å­—æ®µç±»å‹ï¼š float(36 6)  2. shellä¸­æŸ¥è¯¢åˆ°çš„è¯¥å­—æ®µçš„å€¼ï¼š  345.678894  ï¼ˆinsertåæŸ¥è¯¢ï¼‰ 3. insertæ“ä½œè§¦å‘canalä¹‹åï¼Œcanalä¸­è·å–åˆ°çš„å€¼ï¼š345.6789   ï¼ˆè·å–æ–¹æ³•ï¼šclientç«¯column.getValue()ï¼‰ é—®é¢˜ï¼š canal clientç«¯è·å–çš„floatç±»å‹å­—æ®µçš„â€œç²¾åº¦â€ä¸mysqlä¸­çš„ä¸ä¸€è‡´ã€‚ æˆ‘æ›¾ç»å°è¯•æ”¹å†™ com.alibaba.otter.canal.common.utils.CanalToStringStyle.appendDetailæ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š <img width="1230" alt="mysql float" src="https://user-images.githubusercontent.com/28953872/45869265-98355980-bdba-11e8-900c-fd9bebe6fcf0.png"> ä½†æ˜¯ç»“æœç°å®æ–¹æ³•æ”¹å†™ä¸èµ·ä½œç”¨ã€‚ è¯·é—®å¤§ç¥å¦‚ä½•ä¿®æ­£è¿™ä¸ªé—®é¢˜ï¼Ÿ ç¥å¥½ï¼ å‘Šè¯‰æˆ‘ä¸€ä¸‹é‡ç°çš„åŠæ³•ï¼Œmysqlç‰ˆæœ¬ã€canalç‰ˆæœ¬ã€å»ºè¡¨è¯­å¥ã€æµ‹è¯•SQLç­‰ç­‰ å·²ä¿®å¤ï¼Œä¿®æ”¹å·²ç”Ÿæ•ˆï¼Œä¹‹å‰ä¸ç”Ÿæ•ˆçš„åŸå› æ˜¯ï¼šæˆ‘æ²¡æœ‰åœ¨intellij ideaä¸­å°†ä¿®æ”¹çš„æºç é‡æ–°æ‰“åŒ…jarå¹¶æ›¿æ¢æ‰€å®‰è£…çš„canal serverä¸­çš„libä¸‹çš„å¯¹åº”jarã€‚ç²¾åº¦ä¸ä¸€è‡´çš„ä¿®å¤æ–¹æ³•ï¼šparseræ¨¡å—ä¸‹çš„logeventconvertçš„parseOneRowæ–¹æ³•ï¼ˆ case Types.REAL:ï¼‰å°†floatè½¬æ¢ä¸ºdoubleå†å¤„ç†ã€‚ æ˜¯ä½ è‡ªå·±æ”¹åŠ¨äº†ä»£ç å¯¼è‡´ï¼Ÿ ã€Œç°è±¡ï¼š mysqlä¸­æºè¡¨çš„å­—æ®µç±»å‹ï¼š float(36 6) shellä¸­æŸ¥è¯¢åˆ°çš„è¯¥å­—æ®µçš„å€¼ï¼š 345.678894 ï¼ˆinsertåæŸ¥è¯¢ï¼‰ insertæ“ä½œè§¦å‘canalä¹‹åï¼Œcanalä¸­è·å–åˆ°çš„å€¼ï¼š345.6789 ï¼ˆè·å–æ–¹æ³•ï¼šclientç«¯column.getValue()ï¼‰ é—®é¢˜ï¼š canal clientç«¯è·å–çš„floatç±»å‹å­—æ®µçš„â€œç²¾åº¦â€ä¸mysqlä¸­çš„ä¸ä¸€è‡´ã€‚ã€ è¿™ä¸ªâ€ç²¾åº¦é—®é¢˜ä¸ä¸€è‡´é—®é¢˜â€œä¸æ˜¯ç”±äºæ›´æ”¹æºç å¯¼è‡´çš„ã€‚ ******************************************** mysqlç‰ˆæœ¬ï¼š Server version:		5.7.22-log MySQL Community Server (GPL) canalç‰ˆæœ¬ï¼š1.0.24 å»ºè¡¨è¯­å¥ï¼š CREATE TABLE `all_types` (   `varchar1` varchar(20) DEFAULT NULL   `inta` int(10) unsigned NOT NULL AUTO_INCREMENT   `tinyint1` tinyint(4) DEFAULT NULL   `smallint1` smallint(6) DEFAULT NULL   `bigint1` bigint(20) DEFAULT NULL   `decimal1` decimal(65 30) DEFAULT NULL   `double1` double DEFAULT NULL   `date1` date DEFAULT NULL   `time1` time DEFAULT NULL   `year1` year(4) DEFAULT NULL   `datetime1` datetime DEFAULT NULL   `timestamp1` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP   `float1` float(36 6) DEFAULT NULL   PRIMARY KEY (`inta`) ) ENGINE=InnoDB AUTO_INCREMENT=111118 DEFAULT CHARSET=latin1 æµ‹è¯•SQLï¼š insert into all_types values('a' 111112 11 111 1111111 -1235666.6666688999870 123.1345775019860 sysdate() sysdate() '1999' sysdate() sysdate() 345.67890110); ç»è¿‡æµ‹è¯•å‘ç°å¯èƒ½æ˜¯å› ä¸ºåœ¨logeventconvertçš„parseOneRowæ–¹æ³•ä¸­åšäº†ï¼š case Types.REAL:                          // å¯¹è±¡ä¸ºnumberç±»å‹ï¼Œç›´æ¥valueofå³å¯                         columnBuilder.setValue(String.valueOf(value));                         break; String.valueOf(value)ä¸­å¦‚æœvalueæ˜¯floatï¼Œåˆ™ä¼šå¯¼è‡´ç²¾åº¦ä¸¢å¤±ã€‚ è¿™ä¸ªè¿˜ä¸ä¸€å®šå¥½æ”¹ 1.  mysqlè‡ªå¸¦çš„mysqlbinlogå·¥å…·è§£æ345.67890110ç›´æ¥å˜ä¸º345.679ï¼Œcanalè§£æä¸º345.6789ï¼Œå¦‚æœå¼ºè½¬ä¸ºdoubleåˆ™ä¸º345.67889404296875 2.  è‡ªå·±æ’å…¥çš„æ˜¯345.67890110ï¼Œå®é™…mysqlå­˜å…¥çš„æ˜¯345.678894 3.  mysqlå¯¹äºfloatçš„æè¿°ï¼Œå­˜å‚¨ä¸Šæœ¬èº«å­˜åœ¨ä¸ç²¾å‡†çš„è¡Œä¸ºï¼šhttps://dev.mysql.com/doc/refman/5.7/en/problems-with-float.htmlï¼Œè€ƒè™‘0.0001çš„ç²¾åº¦è¯¯å·® æˆ‘æ˜¯è¿™æ ·å¤„ç†çš„ï¼Œä¸çŸ¥é“æ˜¯å¦æ­£ç¡®ï¼š floatå…ˆè½¬doubleï¼Œmysqlå­˜å…¥çš„ä¸º345.678894ï¼Œdoubleä¸º345.67889404296875ï¼Œæ•°æ®ç±»å‹ä¸ºfloat(36 6)ï¼Œå› æ­¤scaleä¸º6ï¼Œdoubleä¸­å°æ•°ç‚¹scale+1ä½å³345.6788940ï¼Œå¯¹doubleä¸­å°æ•°ç‚¹scaleä½è¿›è¡Œ4èˆ5å…¥ï¼š å½“å°æ•°ç‚¹scale+1ä½æ•°å­—>=5  åˆ™å°æ•°åº—ç¬¬scaleä½+1ï¼›å¦åˆ™ä¸å˜åŒ–ã€‚å› æ­¤345.6788940å–6ä½æ˜¯ï¼š345.678894ã€‚ ç»è¿‡äº†å‡ æ¬¡æµ‹è¯•ï¼Œç›®å‰å‘ç°ç»å¤„ç†åçš„ç»“æœå’Œmysqlä¸­å­˜å…¥ç»“æœä¸€è‡´ã€‚ æ²¡æœ‰å¯ä¾æ‰˜çš„å¯é caseï¼Œmysqlè‡ªèº«çš„binlogè§£æä»£ç ä¹Ÿæ˜¯ç›´æ¥floatå¯¹è±¡å¤„ç† insertè¯­å¥ç›´æ¥æ’å…¥345.6789ï¼Œmysqlé‡Œselectå‡ºæ¥çš„ç»“æœä¹Ÿæ˜¯345.678894 æ˜¯å•Šï¼Œè¿™æ ·çš„è¯ç¡®å®æ˜¯ä¸å¥½å¤„ç†ã€‚ floatè¿™ç§ç±»å‹æœ¬èº«å†³å®šçš„å•¦ mysqlé‡Œä¸å»ºè®®ä½¿ç”¨float
960,æœ‰æ²¡æœ‰å·¥å…·å¯ä»¥æŠŠ Message è½¬ä¸º SQLè¯­å¥ï¼Ÿ æˆ‘éœ€è¦æŠŠMessage è½¬æ¢æˆä»åº“å¯æ‰§è¡Œçš„è¯­å¥ï¼ŒCanal æ˜¯å¦æä¾›äº†ç›¸å…³æ¥å£ï¼Ÿ çœ‹ä¸€ä¸‹clienté‡Œçš„example
959,kafkaæ¶ˆæ¯é¡ºåºé—®é¢˜ kafkaåªèƒ½ä¿è¯partition çº§æ¶ˆæ¯çš„é¡ºåºï¼Œ å¯¹äºä¸€å¼ è¡¨çš„æŸä¸ªè®°å½•éœ€è¦ä¿è¯ä¸¥æ ¼çš„é¡ºåºï¼Œè¿™ä¸ªæ€ä¹ˆå¤„ç†ï¼Ÿ canalDestinations å¹¶æ²¡æœ‰å¯¹äºkafka keyåšä»€ä¹ˆç‰¹æ®Šå¤„ç† é»˜è®¤å…¨éƒ¨å‘é€æ‰“partition 0  é…ç½®äº†pk hashçš„ä¼šå‘é€åˆ°å¯¹åº”partition #958
958,kafkaç”Ÿäº§ç«¯å¢åŠ æŒ‰pk hashåˆ°å¯¹åº”partitionåŠŸèƒ½ kafkaç”Ÿäº§ç«¯å¢åŠ æŒ‰pk hashåˆ°å¯¹åº”partitionåŠŸèƒ½ï¼Œæœªè®¾ç½®åˆ†åŒºhashçš„æˆ–åˆ™é»˜è®¤çŠ¶æ€å…¨éƒ¨å‘é€åˆ°åˆ†åŒº0 serverç«¯kafkaå¢åŠ å¦‚ä¸‹é…ç½®ï¼š ```` canalDestinations:   - canalDestination: example     topic: expample     #å¯¹åº”topicåˆ†åŒºæ•°é‡     partitionsNum: 3     partitionHash:       #åº“å.è¡¨å: å”¯ä¸€ä¸»é”®  æŒ‡å®šåº“è¡¨ä¸­çš„å”¯ä¸€ä¸»é”®ç”¨å…¶å€¼ä½œä¸ºhashåˆ†å‘partition       mytest.person: id ```` æ­¤åŠŸèƒ½åªé€‚ç”¨äºflatMessageæ¨¡å¼ å»ºè®®å¯ä»¥ä¼˜åŒ–ä¸€ä¸‹è¡¨çš„hashå­—æ®µå®šä¹‰ï¼Œæ–¹ä¾¿åœ¨å¤§é‡è¡¨çš„é…ç½®é—®é¢˜ï¼š 1.  å¢åŠ é€šé…ç¬¦åŒ¹é…è¡¨ï¼ŒåŒæ—¶æ”¯æŒpkè¿™æ ·çš„é»˜è®¤å…³é”®å­— 2. æœªå‘½ä¸­é€šé…ç¬¦çš„ï¼ŒæŒ‰ç…§ schema.table : columngA è¿›è¡ŒåŒ¹é… è¿«ä¸åŠå¾…
957,canal.kafkaçš„ä¸€äº›ç›¸å…³é—®é¢˜ ç›®å‰ç”¨canal.kafkaå®ç°äº†ä¸€å¥—æ•°æ®å¢é‡åˆ°elasticsearchçš„é¡¹ç›®ã€‚æœ‰ä¸€äº›é—®é¢˜è¯·æ•™ï¼Ÿ 1. å½“clientæŒ‚æ‰ï¼Œè¿™æ®µæ—¶é—´å†…çš„å¢é‡æ•°æ®ï¼Œåœ¨clienté‡å¯åï¼Œè¿™äº›å¢é‡æ•°æ®ä¸ä¼šé€šçŸ¥åˆ°clientã€‚ä¼šå‡ºç°æ•°æ®ä¸¢å¤±é—®é¢˜å—ï¼Ÿ 2. æœ‰æ²¡æœ‰å…³äºcannalçš„ç›‘æ§æ–¹æ¡ˆã€‚ç±»ä¼¼jmxtrans+InfluxDb+Grafana `å¯¹äºkafkaçš„ç›‘æ§ã€‚ å¤šçœ‹ä¸€ä¸‹æ–‡æ¡£ï¼Œä½ æƒ³è¦çš„ç­”æ¡ˆéƒ½æœ‰ï¼Œç›‘æ§æœ‰ç›´æ¥å¯¹æ¥prometheus
956,æœ‰æ²¡æœ‰canalæœªæ¥ä¸€å¹´çš„roadmap å¯å…³æ³¨issueå’Œwiki
955,canal v1.1.0å¼€å¯GTIDä¼šå‡ºç° CanalParseException: java.util.ConcurrentModificationExceptionå¼‚å¸¸ é…ç½®canal.instance.gtidon=trueå¦‚ä¸‹ï¼š # enable gtid use true/false canal.instance.gtidon=true Caused by: java.util.ConcurrentModificationException 	at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:901) 	at java.util.ArrayList$Itr.next(ArrayList.java:851) 	at com.alibaba.otter.canal.parse.driver.mysql.packets.UUIDSet.toString(UUIDSet.java:125) 	at com.alibaba.otter.canal.parse.driver.mysql.packets.MysqlGTIDSet.toString(MysqlGTIDSet.java:111) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.createHeader(LogEventConvert.java:849) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.createHeader(LogEventConvert.java:823) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.buildQueryEntry(LogEventConvert.java:807) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsQueryEvent(LogEventConvert.java:394) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:137) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor$DmlParserStage.onEvent(MysqlMultiStageCoprocessor.java:298) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor$DmlParserStage.onEvent(MysqlMultiStageCoprocessor.java:288) 	at com.lmax.disruptor.WorkProcessor.run(WorkProcessor.java:143) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) 	at java.lang.Thread.run(Thread.java:745) ä½¿ç”¨æœ€æ–°çš„1.1.1-alpha ç‰ˆæœ¬
954,canal1.1.1åœ¨RDSä¸Šé‡åˆ°çš„å‡ ä¸ªé—®é¢˜ ä½¿ç”¨çš„æ˜¯RDS mysql5.6é«˜å¯ç”¨ç‰ˆï¼Œ2ä¸ªRDSéƒ½ç”³è¯·äº†é«˜æƒé™è´¦å·ï¼ŒæŒ‰ç…§å¸¸è§„instance.propertiesé…ç½®ï¼Œä¸€ä¸ªèƒ½å¤Ÿå¯åŠ¨ï¼Œä¸€ä¸ªæŠ¥é”™ã€‚ 2018-09-19 11:30:38.912 [destination = xxx  address = xxx/xxx:3306   EventParser] ERROR c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - dump addressxxx/xxx:3306 has an error  retrying. caused by com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: ErrorPacket [errorNumber=1142  fieldCount=-1  message=SHOW VIEW command denied to user 'canal'@'xxx' for table 'db_view'  sqlState=42000  sqlStateMarker=#] å¥½åƒé«˜æƒé™è´¦å·ä¹Ÿæ²¡æœ‰Mysqlåº“çš„db_viewè¡¨çš„æƒé™ã€‚ ä¹Ÿæ²¡æœ‰è¿™ä¸ªæƒé™ï¼Œä½†æ˜¯å¯åŠ¨æ­£å¸¸ã€‚ å’¨è¯¢äº†ä¸‹é˜¿é‡Œäº‘å·¥ç¨‹å¸ˆï¼Œè¯´æ˜¯canal.instance.filter.regexé…ç½®çš„é—®é¢˜ï¼Œéœ€è¦å‰”é™¤mysqlåº“çš„ç›‘å¬ï¼Œç„¶åå¯åŠ¨æ­£å¸¸ï¼Œä½†æ˜¯å®¢æˆ·ç«¯æ”¶ä¸åˆ°æ•°æ®ã€‚ ç¬¬äºŒä¸ªé—®é¢˜ï¼Œåœ¨æœåŠ¡ç«¯åˆ é™¤èŠ‚ç‚¹äº†ï¼Œä½†æ˜¯æ¯æ¬¡å¯åŠ¨æŠ¥é”™ï¼Œcan't find destination:{} ç”¨æºç è·Ÿè¸ªè°ƒè¯•ï¼Œå‘ç°è¿˜åœ¨å¯åŠ¨åŸæ¥åˆ é™¤çš„èŠ‚ç‚¹ï¼Œå¤ªå¥‡æ€ªäº†ã€‚æˆ‘æŠŠæ•´ä¸ªdeployeråŒ…åˆ é™¤é‡æ–°éƒ¨ç½²è¿˜æ˜¯ä¼šå¯åŠ¨é‚£ä¸ªåˆ é™¤çš„èŠ‚ç‚¹ã€‚ æˆ‘ç”¨çš„æ˜¯å•æœºéƒ¨ç½²ï¼Œæ²¡æœ‰ä½¿ç”¨zkï¼Œæœ›æœ‰ç©ºè§£ç­”ä¸‹ï¼Œè°¢è°¢ã€‚ è€å®è¯´æ²¡å¤ªçœ‹æ‡‚ä½ çš„é—®é¢˜ > è€å®è¯´æ²¡å¤ªçœ‹æ‡‚ä½ çš„é—®é¢˜ èƒŒæ™¯æ˜¯è¿™æ ·çš„ï¼Œåœ¨ECSä¸Šå•æœºéƒ¨ç½²äº†deploy serverç«¯ï¼Œç„¶åè¿äº†4ä¸ªRDSã€‚ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯æˆ‘ä»¬è®¿é—®ä¸äº†mysqlä¸‹é¢çš„ä¸€äº›è¡¨ï¼Œé«˜æƒé™è´¦å·ä¹Ÿæ˜¯ä¸è¡Œï¼Œç„¶åè¿™å—å¥½åƒåªèƒ½é€šè¿‡é…ç½®filterå»æ‰mysql schemaçš„ç›‘æ§ã€‚ï¼ˆå½“æ—¶æ”¶ä¸åˆ°binlogæ•°æ®åº”è¯¥æ˜¯filteræ­£åˆ™é…ç½®é”™è¯¯çš„é—®é¢˜ï¼‰ã€‚ç¬¬äºŒä¸ªé—®é¢˜å°±æ˜¯åœ¨deploy serverçš„confæ–‡ä»¶å¤¹ä¸‹åˆ é™¤äº†ä¸€ä¸ªRDSçš„é…ç½®ï¼Œä½†æ˜¯é‡å¯äº†ä¹‹åï¼Œcanal æœåŠ¡ç«¯è¿˜æ˜¯å»åŠ è½½è¿™ä¸ªåˆ é™¤çš„é…ç½®ï¼Œå¾ˆå¥‡æ€ªï¼Œæˆ‘æŠŠdeployå·¥ç¨‹åˆ é™¤é‡æ–°éƒ¨ç½²è¿˜æ˜¯ä¼šå»åŠ è½½ï¼Œè¿™ä¸ªæ˜¯æˆ‘debugçœ‹åˆ°çš„ã€‚ç„¶ååªèƒ½é‡å¯ECSäº†ï¼Œé‡å¯ä¹‹åå°±å¥½äº†ã€‚æ‰€ä»¥è¿™é‡Œæ€€ç–‘æ˜¯ä¸æ˜¯å“ªé‡Œç¼“å­˜äº†confä¸‹çš„èŠ‚ç‚¹ã€‚ ç¼“å­˜åº”è¯¥æ˜¯æ²¡æœ‰çš„ï¼Œéƒ½åœ¨confç›®å½•ä¸‹ > ç¼“å­˜åº”è¯¥æ˜¯æ²¡æœ‰çš„ï¼Œéƒ½åœ¨confç›®å½•ä¸‹ å¦å¤–ï¼Œå¦‚æœå•æœºæ¨¡å¼ï¼Œserverç«¯çš„logæ•°æ®å¦‚æœä¸æ¶ˆè´¹æ‰çš„è¯ï¼Œä¼šä¸ä¼šçˆ†å†…å­˜ï¼Ÿè¿™å‡ å¤©ECSè«åçˆ†æ»¡äº†ï¼Œå†…å­˜ä¼˜åŒ–è¿™å—æœ‰ä»€ä¹ˆå¥½çš„å»ºè®®å—?æˆ–è€…æ¢zkï¼Ÿ å¤šçœ‹wikiï¼Œä¸ä¼šçˆ†å†…å­˜
953,å•è¯æ‹¼å†™ä¿®æ­£ MemoryEventStoreWithBuffer å†… INIT_SQEUENCE æ”¹ä¸º INIT_SEQUENCE [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=953) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=953) before we can accept your contribution.<br/><hr/>**zhikuodai** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=953) it.</sub> tks
952,canal 1.1.0 ä¸æ‰“å°æ•°æ®rowdataä¿¡æ¯  ![default](https://user-images.githubusercontent.com/16894071/45675324-b3595c80-bb61-11e8-9d31-103f0386ba22.png) ç±»ä¿¡æ¯å‚è€ƒ https://github.com/alibaba/canal/blob/master/example/src/main/java/com/alibaba/otter/canal/example/AbstractCanalClientTest.java å†™çš„  ` protected void printEntry(List<Entry> entrys) {         for (Entry entry : entrys) {             long executeTime = entry.getHeader().getExecuteTime();             long delayTime = System.currentTimeMillis() - executeTime;             Date date = new Date(entry.getHeader().getExecuteTime());             SimpleDateFormat simpleDateFormat = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");             if (entry.getEntryType() == EntryType.TRANSACTIONBEGIN || entry.getEntryType() == EntryType.TRANSACTIONEND) {                 if (entry.getEntryType() == EntryType.TRANSACTIONBEGIN) {                     TransactionBegin begin = null;                     try {                         begin = TransactionBegin.parseFrom(entry.getStoreValue());                     } catch (InvalidProtocolBufferException e) {                         throw new RuntimeException("parse event has an error   data:" + entry.toString()  e);                     }                     // æ‰“å°äº‹åŠ¡å¤´ä¿¡æ¯ï¼Œæ‰§è¡Œçš„çº¿ç¨‹idï¼Œäº‹åŠ¡è€—æ—¶                     logger.info(transaction_format                             new Object[] { entry.getHeader().getLogfileName()                                     String.valueOf(entry.getHeader().getLogfileOffset())                                     String.valueOf(entry.getHeader().getExecuteTime())  simpleDateFormat.format(date)                                     entry.getHeader().getGtid()  String.valueOf(delayTime) });                     logger.info(" BEGIN ----> Thread id: {}"  begin.getThreadId());                     printXAInfo(begin.getPropsList());                 } else if (entry.getEntryType() == EntryType.TRANSACTIONEND) {                     TransactionEnd end = null;                     try {                         end = TransactionEnd.parseFrom(entry.getStoreValue());                     } catch (InvalidProtocolBufferException e) {                         throw new RuntimeException("parse event has an error   data:" + entry.toString()  e);                     }                     // æ‰“å°äº‹åŠ¡æäº¤ä¿¡æ¯ï¼Œäº‹åŠ¡id                     logger.info("----------------\n");                     logger.info(" END ----> transaction id: {}"  end.getTransactionId());                     printXAInfo(end.getPropsList());                     logger.info(transaction_format                             new Object[] { entry.getHeader().getLogfileName()                                     String.valueOf(entry.getHeader().getLogfileOffset())                                     String.valueOf(entry.getHeader().getExecuteTime())  simpleDateFormat.format(date)                                     entry.getHeader().getGtid()  String.valueOf(delayTime) });                 }                 continue;             }             if (entry.getEntryType() == EntryType.ROWDATA) {                 RowChange rowChage = null;                 try {                     rowChage = RowChange.parseFrom(entry.getStoreValue());                 } catch (Exception e) {                     throw new RuntimeException("parse event has an error   data:" + entry.toString()  e);                 }                 EventType eventType = rowChage.getEventType();                 String tableName = entry.getHeader().getTableName();                 for (CanalEntry.RowData rowData : rowChage.getRowDatasList()) {                     Map map = new HashMap<>();                     map.put("tableName" tableName);                     map.put("eventType" eventType);                     map.put("eventDate"  org.apache.http.client.utils.DateUtils.formatDate(new Date() "yyyy-MM-dd"));                     if (eventType == CanalEntry.EventType.DELETE) {                         printColumn(map rowData.getBeforeColumnsList());                         //å‘é€åˆ é™¤å‘½ä»¤                     } else if (eventType == CanalEntry.EventType.INSERT) {                         //å‘é€æ’å…¥å‘½ä»¤                         printColumn(map rowData.getAfterColumnsList());                     } else {                         //å‘é€ä¿®æ”¹å‘½ä»¤                         printColumn(map rowData.getAfterColumnsList());                     }                 }                 if (eventType == EventType.QUERY || rowChage.getIsDdl()) {                     logger.info(" sql ----> " + rowChage.getSql() + SEP);                     continue;                 } //                printXAInfo(rowChage.getPropsList());             }         }     } ` æ£€æŸ¥è¿‡æ»¤æ¡ä»¶
951,V1.1.0ç‰ˆæœ¬ï¼Œæºç«¯æ²¡æœ‰æ•°æ®æ—¶ï¼Œdumpæ—¥å¿—çš„socket2.5så°±timeoutæŠ›å¼‚å¸¸ï¼Œå¯¼è‡´é‡è¿ å¯åŠ¨Canalï¼Œå¦‚æœæŒç»­æœ‰æ•°æ®ï¼Œä¸æŠ¥é”™ã€‚å½“æ²¡æœ‰æ•°æ®æ—¶ï¼Œ2.5så°±SocketTimeoutExceptionå¼‚å¸¸ï¼Œå¯¼è‡´é‡è¿ã€‚ æŠ¥é”™ä½äºBioSocketChannel.read(BioSocketChannel.java:123) æŸ¥çœ‹ä»£ç ï¼ŒBioSocketChannelä¸­çš„SO_TIMEOUT=1000ï¼Œå³1sï¼Œå¦‚æœread()ä¸åˆ°æ•°æ®ï¼Œ1så°±ä¼šæŠ›å‡ºSocketTimeoutExceptionã€‚å…¶ä¸­ç´¯åŠ åˆ°å…¥å‚çš„2.5sï¼Œå°±ä¼šå‘ä¸ŠæŠ›å‡ºå¼‚å¸¸ï¼Œå¯¼è‡´é‡è¿ã€‚ é¦–å…ˆç´¯åŠ çš„timeoutæ˜¯25sã€‚ å…¶æ¬¡canalå¼€å¯äº†master heartbeatï¼Œé»˜è®¤æ²¡æ•°æ®æ—¶æ¯15sä¼šè·å¾—ä¸€ä¸ªheartbeatåŒ…é‡ç½®è¶…æ—¶æ—¶é—´ã€‚ å¯ä»¥ä»è¿™é‡Œç€æ‰‹æ£€æŸ¥ä¸€ä¸‹ç³»ç»Ÿã€‚ @lcybo æˆ‘æè¿°é”™äº†ï¼Œæ˜¯25sï¼Œä¸æ˜¯2.5sã€‚ åœ¨æ–‡ä»¶DirectLogFetcherä¸­å®šä¹‰äº†master hearbeat=15ï¼›ç„¶åREAD_TIMEOUT_MILLISECONDS=(MASTER_HEARTBEAT_PERIOD_SECONDS + 10) * 1000;å³read()çš„æ—¶å€™timeout=25sã€‚ ç°åœ¨ç°è±¡å°±æ˜¯BioSocketChannelä¸­çš„read(25)æ–¹æ³•ä¼ å…¥çš„timeoutæ—¶é—´æ˜¯25sï¼Œå¦‚æœæ²¡æœ‰å¢é‡æ•°æ®ï¼Œè¶…è¿‡25sï¼Œå°±æŠ›å‡ºSocketTimeoutExceptionå¼‚å¸¸äº†ã€‚ å¦‚ä½ æ‰€è¯´ï¼š å¦‚æœä¸å¼€å¯master heartbeatçš„è¯ï¼Œæ˜¯ä¸æ˜¯25så°±ä¼šsockettimeoutå¼‚å¸¸ï¼Œè¿›è¡Œé‡è¿ã€‚ å¼€å¯master heartbeatæ˜¯è®¾ç½®é…ç½®æ–‡ä»¶ä¸­çš„canal.instance.detecting.enable =true å’Œcanal.instance.detecting.heartbeatHaEnable = trueä¹ˆï¼Ÿæˆ‘ç°åœ¨è®¾ç½®äº†æ²¡æœ‰èµ·ä½œç”¨å‘¢ï¼Ÿæ˜¯å“ªé‡Œæ²¡è®¾ç½®å¯¹ä¹ˆ canal.instance.detecting.enableå’Œbinlog master heartbeatä¸æ˜¯ä¸€ä¸ªæ¦‚å¿µã€‚ canal.instance.detecting.enableæ˜¯forkå‡ºå¦ä¸€ä¸ªconnectionç”±canal serverå‘èµ·çš„heartbeatã€‚ binlog master heartbeatåˆ™æ˜¯MySQL dumpåè®®çš„ä¸€éƒ¨åˆ†ï¼Œç”±MySQL masterå‘èµ·ç›´æ¥åœ¨dump connectionä¸­ä¼ è¾“ã€‚canal server æ— éœ€é…ç½®ç›´æ¥å¼€å¯çš„ï¼ˆä¸ºäº†è§£å†³åŠè¿æ¥é—®é¢˜ï¼‰ã€‚ https://dev.mysql.com/doc/refman/8.0/en/change-master-to.html å¯ä»¥çœ‹MASTER_HEARTBEAT_PERIOD è¿™ä¸€æ®µï¼Œæ£€æŸ¥ä¸‹masterç«¯æ˜¯å¦ç”Ÿæ•ˆ. @lcybo æ„Ÿè°¢ã€‚æˆ‘çœ‹äº†ä¸‹ä»‹ç»ï¼Œè¿™ä¸ªMASTER_HEARTBEAT_PERIOD æ˜¯slaveç«¯è®¾ç½®çš„å§ã€‚ canal serveråšä¸ºslaveç›´æ¥å¼€å¯äº†å·²ç»ï¼Œåº”è¯¥ä¸éœ€è¦Canalç«¯è®¾ç½®ä»€ä¹ˆäº†ã€‚ ä½ è®©æˆ‘æ£€æŸ¥masteræ˜¯å¦ç”Ÿæ•ˆï¼Œæ„æ€æ˜¯åœ¨masterè¦è®¾ç½®ä»€ä¹ˆï¼Ÿæ€ä¹ˆæ£€æŸ¥ï¼Ÿ åœ¨masterç«¯æ‰§è¡ŒCHANGE MASTER TO MASTER_HEARTBEAT_PERIOD=20ä¹ˆï¼Ÿæˆ‘å‘½ä»¤æ‰§è¡ŒæˆåŠŸäº†ï¼Œä½†æ˜¯è¿˜æ˜¯25sæ–­å¼€ï¼Œé‡è¿ã€‚ æˆ‘çš„Canal serverè¿æ¥çš„æ˜¯master. æˆ–è€…è¯´canal serverä¸ºäº†è§£å†³åŠè¿æ¥é—®é¢˜ï¼Œæ²¡æ•°æ®æ—¶ï¼Œ25sè‡ªåŠ¨é‡è¿ä¸€æ¬¡ï¼Œæ˜¯æ­£å¸¸çš„ã€‚ 2018-09-18 17:40:44.165 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - Socket timeout expired  closing connection java.net.SocketTimeoutException: Timeout occurred  failed to read 4 bytes in 25000 milliseconds. 	at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannel.read(BioSocketChannel.java:123) ~[classes/:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:174) ~[classes/:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:77) ~[classes/:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:213) [classes/:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:248) [classes/:na] 	at java.lang.Thread.run(Unknown Source) [na:1.7.0_45] @lcybo æ„Ÿè°¢ï¼Œæˆ‘åˆè¯•äº†ä¸‹ï¼Œå¯ä»¥äº†ã€‚ä¹‹å‰è¿æ¥çš„masteræ˜¯mysql5.1ï¼Œå®ƒä¸æ”¯æŒMASTER_HEARTBEAT_PERIODã€‚ç°åœ¨æ¢æˆmysql5.7äº†ï¼Œä½¿å¾—MASTER_HEARTBEAT_PERIODç”Ÿæ•ˆã€‚ä¸åœ¨25sæ–­äº†ã€‚é‚£å¦‚æœè¿æ¥5.6ä»¥ä¸‹ç‰ˆæœ¬ï¼Œä¸æ”¯æŒMASTER_HEARTBEAT_PERIODçš„ï¼Œå°±ä¼š25sæ–­å¼€é‡è¿å§ @theonesmx å—¯ï¼Œè¿™ä¸ªfeatureæ˜¯5.5åŠ å…¥çš„ã€‚
950,GTIDæ¨¡å¼åŒæ­¥ä¸‹æŠ¥gtid_purgedçš„é”™è¯¯ 1.1.0ç‰ˆæœ¬å¯ç”¨gtidæ¨¡å¼ã€‚æºæ•°æ®åº“gtid_purgedæœ‰å€¼ï¼Œå¯åŠ¨åæŠ¥é”™ã€‚æ— æ³•åŒæ­¥ ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = The slave is connecting using CHANGE MASTER TO MASTER_AUTO_POSITION = 1  but the master has purged binary logs containing GTIDs that the slave requires. 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:102) see #902ã€‚ç€æ€¥ç”¨çš„è¯å¯ä»¥å…ˆå°†ä¸»å¹²ä»£ç ç¼–è¯‘æ‰“åŒ…åè¯•ä¸‹ googleè¿™ä¸ªerrmsg
949,Fix simpleCanalConnector bug as title tks
948,åºåˆ—åŒ–çš„é—®é¢˜ æ›´æ–°ç‰ˆæœ¬åå‡ºç°ååºåˆ—åŒ–é”™è¯¯ ERROR com.alibaba.otter.canal.client.kafka.MessageDeserializer - Error when deserializing byte[] to message 
947,ä¿®å¤groupæ¨¡å¼æŠ¥é”™ ä¿®å¤ https://github.com/alibaba/canal/issues/943 1. counter ç»Ÿä¸€åˆ°abstractMySQLEventParserå±‚ã€‚ 2. å¯¹äºgourpä¸­æ¯ä¸ªparserå•ç‹¬ç»Ÿè®¡ã€‚ tks
945,æ”¶åˆ°éè®¢é˜…è¡¨çš„DMLè¯­å¥ Mysql 5.7 binlog-rows-query-log-events ON Canal 1.1.0 canal.instance.filter.query.dml false ä¼šæ”¶åˆ°éè®¢é˜…è¡¨çš„DMLè¯­å¥ï¼ˆä¸æ­£å¸¸ï¼‰ï¼Œä¸ä¼šæ”¶åˆ°éè®¢é˜…è¡¨æ•°æ®ï¼ˆæ­£å¸¸ï¼‰ è®¾ç½® canal.instance.filter.query.dml = trueå§ï¼Œç›®å‰ä¸ä¼šå¯¹5.7çš„DML queryè¯­å¥è¿›è¡Œè¿‡æ»¤ï¼Œå› ä¸ºæ— æ³•è·å–å¯¹åº”çš„dbname @agapple okï¼Œæœ¬æ¥æƒ³è®°å½•ä¸‹SQLè¯­å¥ï¼Œæ— æ³•è¿‡æ»¤çš„è¯å°±æŠŠbinlog-rows-query-log-eventsä¹Ÿå…³æ‰äº†ã€‚tks
944,è¯·é—®CanalAdapterKafkaWorkerçš„ackæ˜¯å¦å­˜åœ¨é—®é¢˜ï¼Ÿ com.alibaba.otter.canal.client.adapter.loader.CanalAdapterKafkaWorkerç±»ä»¥ä¸‹ä»£ç ï¼Œæ„æ€æ˜¯åªæœ‰pollåˆ°nullæˆ–è€…æ‰§è¡Œæ—¶é—´å¤§äºä¸€åˆ†é’Ÿæ‰ä¼šæ‰§è¡Œackæ“ä½œï¼Œè¯•äº†ä¸‹ä¸€ç›´æ­£å¸¸æ¶ˆè´¹æ•°æ®ï¼Œæ°¸è¿œä¸ä¼šæ‰§è¡Œconnector.ack()ï¼Œè¿™æ ·æ˜¯ä¸æ˜¯æœ‰é—®é¢˜å‘¢ï¼Œè¯·é—®ä¸ºä»€ä¹ˆè¦è¿™æ ·å†™ï¼Ÿ while (running) {                     try {                         // switcher.get(); //ç­‰å¾…å¼€å…³å¼€å¯                         final Message message = connector.getWithoutAck(100L  TimeUnit.MILLISECONDS timeFlag startTime);                         timeFlag = false;                         executing.set(true);                         if (message != null) {                            .......                             // é—´éš”ä¸€æ®µæ—¶é—´ackä¸€æ¬¡  é˜²æ­¢å› è¶…æ—¶æœªå“åº”åˆ‡æ¢åˆ°å¦å¤–å°å®¢æˆ·ç«¯                             long currentTS = System.currentTimeMillis();                             while (executing.get()) {                                 // å¤§äº1åˆ†é’Ÿæœªæ¶ˆè´¹å®Œackä¸€æ¬¡keep alive                                 if (System.currentTimeMillis() - currentTS >  60000) {                                     connector.ack();                                     currentTS = System.currentTimeMillis();                                 }                             }                         } else {                             connector.ack();                         }                     } catch (CommitFailedException e) {                         logger.warn(e.getMessage());                     } catch (Exception e) {                         logger.error(e.getMessage()  e);                         TimeUnit.SECONDS.sleep(1L);                     }                 } ç¡®å®æœ‰bugï¼Œåœ¨æœ€æ–°prä¸­ä¼šä¿®å¤ã€‚è¿™é‡Œçš„é—´éš”ä¸€æ®µæ—¶é—´ackæ˜¯ä¸ºäº†é˜²æ­¢æ¶ˆè´¹è¶…æ—¶kafka Consumerä¼šåˆ‡æ¢åˆ°å¦å¤–ä¸€å° @rewerma å¥½çš„ï¼Œè°¢è°¢
943,v1.1.0ç‰ˆæœ¬goupæ¨¡å¼é—®é¢˜ å¯åŠ¨æ—¶ goupçš„å®ä¾‹ä¼šæŠ¥é”™ å…¶å®ƒçš„å®ä¾‹ä¸ä¼šï¼Œä½†æ˜¯ä¹Ÿä¼šæ­£å¸¸æ¶ˆè´¹ã€‚ é”™è¯¯å¦‚ä¸‹: com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.lang.String)]: [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.nio.charset.Charset)] 2018-09-12 14:51:57.847 [main] WARN  com.alibaba.otter.canal.prometheus.PrometheusService - Unable to register instance exports for coupon. java.lang.IllegalArgumentException: CanalEventParser must be MysqlEventParser 	at com.alibaba.otter.canal.prometheus.impl.ParserCollector.register(ParserCollector.java:86) ~[canal.prometheus-1.1.0.jar:na] 	at com.alibaba.otter.canal.prometheus.CanalInstanceExports.register(CanalInstanceExports.java:65) ~[canal.prometheus-1.1.0.jar:na] 	at com.alibaba.otter.canal.prometheus.PrometheusService.register(PrometheusService.java:96) ~[canal.prometheus-1.1.0.jar:na] 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.start(CanalServerWithEmbedded.java:109) [canal.server-1.1.0.jar:na] 	at com.alibaba.otter.canal.deployer.CanalController$2$1.processActiveEnter(CanalController.java:140) [canal.deployer-1.1.0.jar:na] 	at com.alibaba.otter.canal.common.zookeeper.running.ServerRunningMonitor.processActiveEnter(ServerRunningMonitor.java:244) [canal.common-1.1.0.jar:na] 	at com.alibaba.otter.canal.common.zookeeper.running.ServerRunningMonitor.initRunning(ServerRunningMonitor.java:149) [canal.common-1.1.0.jar:na] 	at com.alibaba.otter.canal.common.zookeeper.running.ServerRunningMonitor.start(ServerRunningMonitor.java:103) [canal.common-1.1.0.jar:na] 	at com.alibaba.otter.canal.deployer.CanalController.start(CanalController.java:438) [canal.deployer-1.1.0.jar:na] 	at com.alibaba.otter.canal.deployer.CanalLauncher.main(CanalLauncher.java:38) [canal.deployer-1.1.0.jar:na] 2018-09-12 14:51:57.847 [main] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start CannalInstance for 1-coupon  2018-09-12 14:51:57.858 [main] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - start successful.... å¥½åƒæ˜¯è¯´çœŸæ­£ç”¨çš„setConnectionCharset(Charset connectionCharset)è¿™ä¸ªæ–¹æ³• ä½†æ˜¯ç¡®è®¾ç½®æˆä½¿ç”¨ setConnectionCharset(String connectionCharset)è¿™ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆå…¶å®ƒæ¨¡å¼ä¸æŠ¥é”™ https://github.com/alibaba/canal/pull/947 @shizhengchao å¯ä»¥çš„è¯ï¼Œè¯·æ‰“è¡¥ä¸æµ‹è¯•ä¸€ä¸‹ï¼Œä¸‡åˆ†æ„Ÿè°¢ã€‚ > #947 > @shizhengchao å¯ä»¥çš„è¯ï¼Œè¯·æ‰“è¡¥ä¸æµ‹è¯•ä¸€ä¸‹ï¼Œä¸‡åˆ†æ„Ÿè°¢ã€‚ @lcybo  å—¯ï¼Œç°åœ¨å·²ç»ä¸æŠ¥é”™äº†ã€‚()  @shizhengchao thx
942,å¢åŠ å½“å‰çš„gtidç›¸å…³ä¿¡æ¯è‡³Entry Header  1. å°†å½“å‰çš„gtidï¼Œsequence no å’Œlast committedä¿¡æ¯å¢åŠ è‡³Entry(trx begin/end  rowdata) Header ä¸­ å®¢æˆ·ç«¯å¯ä»propertyä¸­è·å–ç›¸å…³å€¼. 2. example å¢åŠ è·å–å¯¹åº”gtidç›¸å…³ä¿¡æ¯ç¤ºä¾‹ protected Map<String  String> gtidMap = new HashMap<>();  putå’Œgetæ—¶ä¼šå­˜åœ¨ä¸€ä¸ªå¹¶å‘æ€§å§ LogDecoder ä¼šä¸ºæ¯ä¸ªevent äº‹ä»¶å®ä¾‹åŒ–LogHeader å¯¹è±¡ï¼Œå½“GTIDäº‹ä»¶åˆ°æ¥æ—¶ï¼Œå¯¹logHeader çš„map.putæ“ä½œï¼Œåç»­æ— è®ºæ˜¯ä¸²è¡Œè¿˜æ˜¯å¹¶è¡Œè§£æï¼Œéƒ½æ˜¯å¯¹è¿™ä¸ªeventäº‹ä»¶çš„ç§æœ‰headerä¸­mapè¿›è¡Œgetæ“ä½œ. æˆ‘çš„ç†è§£: ``` ä¸²è¡Œè§£æé¡ºåºåº”è¯¥æ˜¯: put |-> get-> get -> get å¹¶è¡Œè§£æé¡ºåºåº”è¯¥æ˜¯: put |->get     |-> get      |-> get ``` tks
941,å¢åŠ æ‰å¹³Messageç”¨äºkafkaæ¶ˆæ¯æŠ•é€’ å¢åŠ FlatMessageç±»ï¼Œç”¨äºkafkaçš„æ¶ˆæ¯æŠ•é€’ï¼ŒMessageçš„æ¯ä¸ªEntryä¼šè¢«æ‹†åˆ†æˆå¯¹åº”FlatMessageï¼Œä½¿ç”¨jsonåºåˆ—åŒ–å‘é€è‡³kafkaæ¶ˆè´¹ã€‚ åç»­å°†å®ç°å¯¹FlatMessageæŒ‰pk hash å’Œ partitionè¿›è¡Œæ‹†åˆ†çš„éœ€æ±‚ **å¢åŠ é…ç½®** serverç«¯ï¼š conf/kafka.yml å¢åŠ æ–°å±æ€§ï¼š flatMessage: true  trueï¼šä»£è¡¨ä½¿ç”¨FlatMessageæ¶ˆæ¯æŠ•é€’ï¼Œfalseï¼šä»£è¡¨ä½¿ç”¨åŸç”ŸMessageæ¶ˆæ¯æŠ•é€’ clientç«¯ï¼š canal_client/conf/canal-client.yml å¢åŠ å±æ€§ï¼š flatMessage: true trueï¼šä»£è¡¨ä½¿ç”¨FlatMessageæ¶ˆæ¯æŠ•é€’ï¼Œfalseï¼šä»£è¡¨ä½¿ç”¨åŸç”ŸMessageæ¶ˆæ¯æŠ•é€’ **æ³¨ï¼š** FlatMessageåªå¯¹kafkaæ¶ˆæ¯æŠ•é€’æœ‰æ•ˆï¼Œä¸å½±å“tcpçš„åŸç”ŸMessageæ¶ˆæ¯ä¼ è¾“ ![image](https://user-images.githubusercontent.com/33280738/45535386-e08bcf00-b830-11e8-8349-37378d5470bb.png) æ„Ÿè§‰è¿™ä¸ªæœ€å¤§å·®è·åº”è¯¥åœ¨: ä¸€ä¸ªæ˜¯åŒæ­¥æäº¤åˆ°Kafkaï¼Œä¸€ä¸ªä½¿ç”¨å¼‚æ­¥æäº¤å§?å¦åˆ™ä»ä½ çš„å°è£…æ¥çœ‹ï¼Œè¿™ä¸ªå·®å¼‚ä¸åº”è¯¥è¿™ä¹ˆå¤§å‘€ã€‚æœ‰å°è¯•è¿‡éƒ½æ”¹æˆå¼‚æ­¥æµ‹è¯•å—ï¼Ÿ æ”¹æˆå¼‚æ­¥tpså¹¶æ²¡æœ‰åŒºåˆ«å¾ˆå¤§ OK
940,1.1.0ç”Ÿäº§ç¯å¢ƒ4ä¸ªdestinationç‚¹ä½ä¿¡æ¯æœ‰2ä¸ªæ²¡æœ‰å†™zk2ä¸ªä¸æ›´æ–° ä»zkä¸Šçœ‹01å’Œ04destinatonæ²¡æœ‰cursorç›®å½• 02å’Œ03æœ‰cursorç›®å½•ä½†æ˜¯ä¸æ›´æ–°ï¼Œé‡å¯äº†2æ¬¡éƒ½æ˜¯å¦‚æ­¤ æˆ‘éƒ¨ç½²å¦å¤–ä¸€ä¸ªcanal serverå®ä¾‹çš„æ—¶å€™ï¼Œæ²¡æœ‰æŠ¥ TableIdNotFoundExceptionï¼Œç‚¹ä½ä¿¡æ¯å…¨éƒ¨æ­£å¸¸ å¯åŠ¨çš„æ—¶å€™canal.canal.logæœ‰æŠ¥é”™ä¿¡æ¯ï¼š 2018-09-13 23:46:59.156 [destination = ordercanalprd02   address = /***:3321   EventParser] ERROR c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - dump address /***:3321 has an error  retrying. caused by com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.TableIdNotFoundException: not found tableId:110 Caused by: com.alibaba.otter.canal.parse.exception.TableIdNotFoundException: not found tableId:110 2018-09-13 23:46:59.109 [destination = ordercanalprd01   address = /***:3320   EventParser] WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - prepare to find start position ::1536827400000 **2018-09-13 23:46:59.151 [destination = ordercanalprd03   address = /***:3322   EventParser] ERROR c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - dump address /***:3322 has an error  retrying. caused by com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.TableIdNotFoundException: not found tableId:118 Caused by: com.alibaba.otter.canal.parse.exception.TableIdNotFoundException: not found tableId:118** 2018-09-13 23:46:59.156 [destination = ordercanalprd02   address = /***:3321   EventParser] ERROR c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - dump address /***:3321 has an error  retrying. caused by com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.TableIdNotFoundException: not found tableId:110 Caused by: com.alibaba.otter.canal.parse.exception.TableIdNotFoundException: not found tableId:110 2018-09-13 23:46:59.203 [destination = ordercanalprd03   address = /---:3322   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:ordercanalprd03[com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.TableIdNotFoundException: not found tableId:118 Caused by: com.alibaba.otter.canal.parse.exception.TableIdNotFoundException: not found tableId:118 ] 2018-09-13 23:46:59.204 [destination = ordercanalprd02   address = /---:3321   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:ordercanalprd02[com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.TableIdNotFoundException: not found tableId:110 Caused by: com.alibaba.otter.canal.parse.exception.TableIdNotFoundException: not found tableId:110 ] é…ç½®ä¿¡æ¯ï¼š # canal.properties binlog filter config canal.instance.filter.druid.ddl = true canal.instance.filter.query.dcl = true canal.instance.filter.query.dml = true canal.instance.filter.query.ddl = true canal.instance.filter.table.error = true canal.instance.filter.rows = false canal.instance.filter.transaction.entry = false table meta tsdb info **canal.instance.tsdb.enable=false** canal.instance.tsdb.dir=${canal.file.data.dir:../conf}/${canal.instance.destination:} canal.instance.tsdb.url=jdbc:h2:${canal.instance.tsdb.dir}/h2;CACHE_SIZE=1000;MODE=MYSQL; canal.instance.tsdb.dbUsername=canal canal.instance.tsdb.dbPassword=canal canal.instance.global.spring.xml = classpath:spring/default-instance.xml # instance.properties canal.instance.gtidon=false position info canal.instance.master.address=***:3322 canal.instance.master.journal.name= canal.instance.master.position= canal.instance.master.timestamp=1536827400000 canal.instance.master.gtid=  rds oss binlog canal.instance.rds.accesskey= canal.instance.rds.secretkey= canal.instance.rds.instanceId= table meta tsdb info **canal.instance.tsdb.enable=false** # kafka.ymlé…ç½®ä¿¡æ¯ï¼š servers: *** retries: 0 batchSize: 16384 lingerMs: 1 bufferMemory: 33554432 canalçš„æ‰¹æ¬¡å¤§å°ï¼Œå•ä½ kï¼Œé‡å¤§å»ºè®®æ”¹ä¸º1M canalBatchSize: 50 filterTransactionEntry: true canalDestinations:   - canalDestination: ordercanalprd01     topic: ordercanalprd01     partition:   - canalDestination: ordercanalprd02     topic: ordercanalprd01     partition:   - canalDestination: ordercanalprd03     topic: ordercanalprd01     partition:   - canalDestination: ordercanalprd04     topic: ordercanalprd01     partition: æˆ‘è‡ªæŸ¥äº†ä¸€é ä¼°è®¡è¿™ä¸ªé”™è¯¯æ˜¯å‘ç”Ÿåœ¨ canal.destinations= è¿™ä¸ªé…ç½®ç›´æ¥ç»™ç©ºäº† æˆ‘æŠŠè¿™ä¸ªåœ°æ–¹é…ä¸Šï¼Œç„¶åslaveidæŒ‰å®ä¾‹è‡ªå¢éƒ¨ç½²äº†å…¶ä»–28ä¸ªdestinationéƒ½æ²¡æœ‰å‘ç”Ÿé—®é¢˜ æˆ‘çŒœåº”è¯¥æ˜¯å¯åŠ¨è¿‡ç¨‹ä¸­æ‰«ædestinationå’Œå…¶ä»–ä»£ç çš„å…ˆåé¡ºåºå¼•å‘çš„é—®é¢˜ 
939,canal1.1.0å¾€kafkaå‘é€æ•°æ®é‡å’Œmysqläº§ç”Ÿçš„é‡ä¸ä¸€è‡´ æˆ‘çš„kafka.ymlæ˜¯è¿™æ ·é…ç½®çš„ï¼š retries: 0 batchSize: 1024 lingerMs: 0 bufferMemory: 33554432 # canalçš„æ‰¹æ¬¡å¤§å°ï¼Œå•ä½ kï¼Œé‡å¤§å»ºè®®æ”¹ä¸º1M canalBatchSize: 50 filterTransactionEntry: true canalDestinations:   - canalDestination: elample     topic: elample     partition: mysqlç”¨å­˜å‚¨è¿‡ç¨‹æ’å…¥10000æ¡æ•°æ®ï¼Œæ¯æ¬¡éƒ½åªèƒ½åœ¨kafkaæ¶ˆè´¹åˆ°6åƒå¤šæ¡ batchSizeä¸èƒ½æ”¹å¤ªå¤§ï¼Œkafkaæ¶ˆæ¯ä½“é»˜è®¤æœ€å¤§ä¸èƒ½è¶…è¿‡1Mæ•°æ®ï¼Œæ‰€ä»¥canalBatchSizeå¿…é¡»1Mä¸€ä¸‹å»ºè®®500Kï¼ŒbatchSizeå¯ä»¥æŒ‰é»˜è®¤ä¸éœ€è¦ä¿®æ”¹ @rewerma  ä»–è¿™ä¸ªå•ä½ä¸æ˜¯å­—èŠ‚çš„å—ï¼Ÿ1024æŒ‰å­—èŠ‚ç®—çš„è¯ä¸åˆ°1Mçš„ æˆ‘æ”¹æˆé»˜è®¤çš„ä¹Ÿæ˜¯ä¸€æ ·çš„æƒ…å†µ retries: 0 batchSize: 16384 lingerMs: 1 bufferMemory: 33554432 # canalçš„æ‰¹æ¬¡å¤§å°ï¼Œå•ä½ k canalBatchSize: 50 filterTransactionEntry: true è¯•è¿‡äº†ï¼Œè¿™å‡ ä¸ªå‚æ•°ï¼Œéƒ½æ˜¯ä¸€æ ·çš„æƒ…å†µï¼Œæ¯æ¬¡éƒ½æ˜¯åªèƒ½åŒæ­¥å…­åƒå…­ç™¾å¤šæ¡æ•°æ®
938,Fix upgrade proto2 to proto3 Fix upgrade proto2 to proto3  And  that test is already compatible with previous versions of the client.
937,canal.instance.filter.transaction.entryä¸èµ·ä½œç”¨ mysqlç‰ˆæœ¬ 5.6.26 canalserverç‰ˆæœ¬ 1.0.24 é—®é¢˜1ï¼š åœ¨canal.properties é‡Œé…ç½® canal.instance.filter.transaction.entry = true ä¹‹å åœ¨canal client é‡Œä»ç„¶å¯ä»¥çœ‹åˆ°entryType æœ‰ transactionbegin å’Œ transactionend  è¯·é—®ï¼Œæ€ä¹ˆå¤„ç†å¯ä»¥åœ¨serverç«¯å»é™¤æ‰ transcation é—®é¢˜äºŒï¼š åœ¨instance.propertiesé‡Œé…ç½®äº†canal.instance.filter.regex ä¹‹å åœ¨canal client é‡Œä»ç„¶å¯ä»¥çœ‹åˆ°æœªå…³æ³¨è¡¨çš„  transactionbegin å’Œ transactionend ï¼Œç›¸æ¯”å…³æ³¨è¡¨ï¼Œæœªå…³æ³¨è¡¨åªæ˜¯å°‘äº† queryçš„eventType å’Œ dmlçš„eventType è¯·é—®ï¼Œcanalserverèƒ½ä¸èƒ½åšåˆ°åªå»åŒæ­¥æˆ‘å…³æ³¨è¡¨çš„binlog ï¼Œä»¥æ­¤å‡å°‘canalserverçš„è´Ÿè½½ é—®é¢˜2æ˜¯ç”±é—®é¢˜1æœªç”Ÿæ•ˆå¯¼è‡´çš„ï¼Œå»ºè®®å‡çº§è‡³1.1.1å†è¯•ä¸€ä¸‹ ps:  1. å¼€å¯canal.instance.filter.transaction.entry =trueåï¼Œä¼šå¯¼è‡´æ— æ³•ackï¼Œä¸€æ—¦åŒæ­¥å‡ºç°é—®é¢˜ï¼Œå°†æœ‰å¯èƒ½å¯¼è‡´ä¸¢æ•°æ®ç”šè‡³æ‰¹é‡æ•°æ®é‡å‘çš„å¯èƒ½ã€‚ 2. canal server åœ¨1.1.0åšäº†å¤§é‡æ€§èƒ½ä¼˜åŒ–ï¼Œä¹‹å‰ç‰ˆæœ¬çš„æ€§èƒ½é—®é¢˜åœ¨1.1.0ä¸Šåº”è¯¥å¾—åˆ°å¤§å¹…åº¦ç¼“è§£ç”šè‡³è§£å†³ã€‚ æ„Ÿè°¢å›ç­”ï¼ç›®å‰çš„åº”ç”¨åœºæ™¯è¿˜ä¸å…è®¸è„±ç¦»ack ; ä¹‹åå°è¯•ä¸€ä¸‹1.1 ç‰ˆæœ¬
936,canal1.1.0 å¹¶å‘è§£æä¸‹å¤šçº¿ç¨‹å¯¹GTIDæ›´æ–°æ“ä½œ å¯¼è‡´java.util.ConcurrentModificatioinException å…·ä½“é”™è¯¯å¦‚ä¸‹: 2018-09-12 18:38:25 776||destination = 1002   address = /*********:3306   EventParser|?|ERROR|c.a.o.c.p.i.mysql.MysqlEventParser - dump address ************:3306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: java.util.ConcurrentModificationException: null 	at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:901) ~[na:1.8.0_121] 	at java.util.ArrayList$Itr.next(ArrayList.java:851) ~[na:1.8.0_121] 	at com.alibaba.otter.canal.parse.driver.mysql.packets.UUIDSet.toString(UUIDSet.java:125) ~[canal.parse.driver-1.1.0-20180912.102450-4.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.packets.MysqlGTIDSet.toString(MysqlGTIDSet.java:111) ~[canal.parse.driver-1.1.0-20180912.102450-4.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.createHeader(LogEventConvert.java:849) ~[canal.parse-1.1.0-20180912.102500-4.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:561) ~[canal.parse-1.1.0-20180912.102500-4.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor$DmlParserStage.onEvent(MysqlMultiStageCoprocessor.java:302) ~[canal.parse-1.1.0-20180912.102500-4.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor$DmlParserStage.onEvent(MysqlMultiStageCoprocessor.java:288) ~[canal.parse-1.1.0-20180912.102500-4.jar:na] 	at com.lmax.disruptor.WorkProcessor.run(WorkProcessor.java:143) ~[disruptor-3.4.2.jar:na] 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_121] 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[na:1.8.0_121] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_121] 2018-09-12 18:38:25 776||destination = 1002   address = /172.16.2.71:3306   EventParser|?|ERROR|c.a.o.c.common.alarm.LogAlarmHandler - destination:1002[com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: java.util.ConcurrentModificationException 	at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:901) 	at java.util.ArrayList$Itr.next(ArrayList.java:851) 	at com.alibaba.otter.canal.parse.driver.mysql.packets.UUIDSet.toString(UUIDSet.java:125) 	at com.alibaba.otter.canal.parse.driver.mysql.packets.MysqlGTIDSet.toString(MysqlGTIDSet.java:111) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.createHeader(LogEventConvert.java:849) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:561) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor$DmlParserStage.onEvent(MysqlMultiStageCoprocessor.java:302) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor$DmlParserStage.onEvent(MysqlMultiStageCoprocessor.java:288) 	at com.lmax.disruptor.WorkProcessor.run(WorkProcessor.java:143) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) 	at java.lang.Thread.run(Thread.java:745) ]st.java:901) 	at java.util.ArrayList$Itr.next(ArrayList.java:851) 	at com.alibaba.otter.canal.parse.driver.mysql.packets.UUIDSet.toString(UUIDSet.java:125) 	at com.alibaba.otter.canal.parse.driver.mysql.packets.MysqlGTIDSet.toString(MysqlGTIDSet.java:111) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.createHeader(LogEventConvert.java:849) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:561) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor$DmlParserStage.onEvent(MysqlMu JDK: 1.8.0_21 é…ç½®ä¿¡æ¯: preallell=true parallelthreadSize=4(è®¡ç®—ç»“æœ) åˆ†æåŸå› (ä¸ä¸€å®šæ­£ç¡®): åœ¨LogEventConvertçš„180è¡Œ å¯¹gtid_setè¿›è¡Œäº†æ›´æ–° å…¶å®æ˜¯æ›´æ–°äº†MysqlGTIDSetçš„34è¡Œ sets.get(sid).intervals.addAll(us.intervals) è¿™ä¸ªåœ°æ–¹æ›´æ–°äº†listçš„modCount++ åœ¨UUIDSetçš„tostringæ–¹æ³•ä¸­ éå†äº†intervals ç»“æœè§¦å‘äº†ArrayListçš„901è¡Œçš„checkForComodificationæ–¹æ³• ç”±äºaddAllå¢åŠ äº†modCount ä½†æ˜¯execptedModCountæ²¡æœ‰å¢åŠ  è·‘å‡ºäº†å¼‚å¸¸. è§£å†³æ–¹æ³•: æ–¹æ³•1:preallell=false æ–¹æ³•2:å¤šçº¿ç¨‹æƒ…å†µä¸‹ æ˜¯ä¸æ˜¯éœ€è¦åŠ é”. https://github.com/alibaba/canal/pull/902 å¯ä»¥å…ˆå°è¯•ç”¨ä¸€ä¸‹1.1.1çš„alphaç‰ˆæœ¬ é‡åˆ°äº†åŒæ ·çš„é—®é¢˜ï¼Œåˆ†æåŸå› è·Ÿmycat-lulinä¸€è‡´ï¼Œç°å…ˆé‡‡ç”¨preallell=falseçš„æ–¹æ³•æµ‹è¯•ä¸€ä¸‹ï¼Œåç»­è€ƒè™‘åŠ é”
935,å¦‚ä½•æŒ‡å®šä¸€ä¸ªè¡¨çš„æ•°æ®åˆ°ä¸€ä¸ªpartitionï¼Œè€Œä¸æ˜¯åˆ†æ•£åˆ°å¤šä¸ªpartitioné‡Œ æˆ–è€…è¯´å¦‚ä½•ç¡®è®¤ï¼Ÿ Kafkaåˆ›å»ºtopicçš„æ—¶å€™partitionåªç»™ä¸€ä¸ªä¸å°±okäº† #958 
934,å¦‚ä½•è®¾ç½®ä¸€å¼ è¡¨åˆ°ä¸€ä¸ªtopicçš„æŒ‡å®špartition è¿™ä¸ªæŠŠè¿™ä¸ªè¡¨åä½œä¸ºmessageçš„keyå°±è¡Œäº†å§ã€‚ #958 
933,canal ä¿®æ”¹instanceé…ç½®æ–‡ä»¶ï¼Œé‡æ–°å¯åŠ¨å®ä¾‹ï¼Œè¿™ä¸ªä¿¡æ¯ä¼šåŒæ­¥è‡³zkä¸­å— ç‰ˆæœ¬æ˜¯1.0.24 ä¸ä¼š
932,è¯·é—®èƒ½æ‹¿åˆ°å•æ¡æ•°æ®å—ï¼Œå¦åˆ™å¾€kafkaå‘é€åªèƒ½æ˜¯å•åˆ†åŒºï¼Œå¤šåˆ†åŒºé¡ºåºæ— æ³•ä¿è¯ è¯·é—®1.10å‘é€åˆ°kafkaçš„è¯ï¼Œç°åœ¨åªèƒ½æ˜¯å•åˆ†åŒºå‘é€ï¼Œå¤šåˆ†åŒºé¡ºåºä¸èƒ½ä¿è¯ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å‘é€åˆ°ä¸åŒåˆ†åŒºï¼Œå¹¶ä¸”æŒ‰ç…§keyè¿›è¡Œhashåˆ†åŒºï¼Œæˆ‘çš„åšæ³•æ˜¯æŠŠentrysæ‹¿å‡ºæ¥éå†ï¼Œå†æŠŠrowchangeæ‹¿å‡ºæ¥éå†ï¼Œæœ€åå¾—åˆ°ä¸€æ¡rowdataï¼Œç”¨åº“ååŠ ä¸»é”®çš„å€¼æ‹¼å‡ºkeyï¼ŒæŒ‰ç…§keyå‘é€è¿™æ¡æ•°æ®ï¼Œå°±å¯ä»¥ä¿è¯ä¸€æ¡æ•°æ®æ€»æ˜¯ä¼šåˆ°ä¸€ä¸ªåˆ†åŒºï¼Œä½†æ˜¯è§‰ç€è¿™æ ·æ•ˆç‡å¾ˆä½ï¼Œè¯·é—®ä¹‹åä¼šæœ‰èƒ½ç›´æ¥æ‹¿åˆ°å•æ¡æ•°æ®çš„æ–¹æ³•å—ï¼Œè¿˜æ˜¯ç°åœ¨å°±æœ‰å‘¢ï¼Ÿ ä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹ï¼š public void send(KafkaProperties.Topic topic  Message message) throws IOException {                  //è·å–entrys         List<ByteString> rawEntries = message.getRawEntries();         for (ByteString rawEntry : rawEntries) {             message.addEntry(CanalEntry.Entry.parseFrom(rawEntry));         }         //éå†entrys         for (CanalEntry.Entry entry : message.getEntries()) {             String tableName = entry.getHeader().getTableName();             CanalEntry.RowChange rowChage = CanalEntry.RowChange.parseFrom(entry.getStoreValue());             CanalEntry.EventType eventType = rowChage.getEventType(); //            éå†rowchange             for (CanalEntry.RowData rowData : rowChage.getRowDatasList()) {                 String key = "";                 List<CanalEntry.Column> list = null;                 if (eventType == CanalEntry.EventType.DELETE) {                     list = rowData.getBeforeColumnsList();                 } else {                     list = rowData.getAfterColumnsList();                 }                 //é‡æ–°å°è£…                 CanalEntry.RowData.Builder rowDataBuilder = CanalEntry.RowData.newBuilder();                 for (CanalEntry.Column column : list) {                     if (column.getIsKey()) {                         key = tableName + "_" + column.getValue();                     }                     if (eventType == CanalEntry.EventType.DELETE) {                         rowDataBuilder.addBeforeColumns(column);                     } else {                         rowDataBuilder.addAfterColumns(column);                     }                 }                 CanalEntry.RowChange.Builder rowChangeBuilder = CanalEntry.RowChange.newBuilder();                 rowChangeBuilder.addRowDatas(rowDataBuilder);                 CanalEntry.RowChange rowChangeNew = rowChangeBuilder.build();                 CanalEntry.Entry.Builder entryBuilder = CanalEntry.Entry.newBuilder();                 entryBuilder.setHeader(entry.getHeader())                         .setEntryType(entry.getEntryType())                         .setStoreValue(rowChangeNew.toByteString());                 List<CanalEntry.Entry> listEntry = new ArrayList<>();                 listEntry.add(entryBuilder.build());                 Message messageNew = new Message(message.getId());                 messageNew.setEntries(listEntry);                 //æŒ‰ç…§rowkeyè¿›è¡Œhashåˆ†åŒºå‘é€                 ProducerRecord<String  Message> record;                 record = new ProducerRecord<String  Message>(topic.getTopic()  key  messageNew);                 producer.send(record);                 if (logger.isDebugEnabled()) {                     logger.debug("send message to kafka topic: {} \n {}"  topic.getTopic()  message.toString());                 }             }         }     } é’ˆå¯¹æ•°æ®hashåˆ°ä¸åŒåˆ†åŒºï¼Œå¦‚æœé«˜æ•ˆéœ€è¦åœ¨æ„å»ºprotobufä¹‹å‰å°±å®Œæˆè®¡ç®—ï¼Œå¦åˆ™å°±ä¼šæœ‰è§£å‹ååºåˆ—åŒ–çš„é—®é¢˜ æ„Ÿè°¢å›å¤ï¼Œä½†æ˜¯çœ‹ä»£ç åªèƒ½æŒ‰æ‰¹è·å–æ•°æ®ï¼Œä¸ååºåˆ—åŒ–å‡ºæ¥æ²¡æ³•ç›´æ¥æ‹†æˆå•æ¡å§ å…¶å®ä¹Ÿå¯ä»¥è¿™æ ·å¤„ç†ï¼šcanal å†™å…¥kafkaçš„æ•°æ®ä½œä¸ºè´´æºçš„æ•°æ®åŒ…å­˜åœ¨ï¼Œåœ¨Kafkaä¹‹åå¯ä»¥åšä¸ªsinkè¿›è¡Œåˆ†å‘ã€åˆå¹¶ç­‰é¢„å¤„ç†å·¥ä½œï¼Œå› ä¸ºæ— è®ºå¦‚ä½•å¿…é¡»è¦æœ‰ä¸ªå¤„ç†ç«¯å¯¹æ•°æ®åŒ…è¿›è¡Œè§£æï¼Œè¿˜æœ‰è¿™éƒ¨åˆ†è´´æºçš„æ•°æ®ä¸€ç›´æ˜¯ä»¥MessageåŒ…çš„å½¢å¼å­˜åœ¨äºkafkaä¸­ï¼Œæ— è®ºåç»­çš„æ•°æ®éœ€è¦å¦‚ä½•å¤„ç†ï¼Œè´´æºçš„æ•°æ®ä¼šä½œä¸ºåŸºç¡€æ•°æ®å­˜ï¼ŒæœåŠ¡äºä¸åŒçš„æ•°æ®æµåº”ç”¨åœºæ™¯ä¸­ï¼Œæ‰©å±•æ€§ä¹Ÿä¼šå¾ˆå¥½ã€‚ è¿˜æœ‰å‡ ä¸ªåœºæ™¯ä¹Ÿéœ€è¦è€ƒè™‘å¹¶å¤„ç†: 1.  å¤šä¸ªkeyï¼Œç»„åˆkey 2. å¯¹åŒ…æ•°æ®è¿›è¡Œæ‹†è§£åï¼Œå¹‚ç­‰å¤„ç† @wingerx å—¯ï¼Œæ„Ÿè°¢æä¾›æ€è·¯ï¼Œåˆ†å±‚èƒ½æ›´å¥½çš„è¿›è¡Œè§£è€¦ï¼Œæ˜¯ä¸ªä¸é”™çš„æ–¹æ³•ï¼Œä½†è´´æºå±‚ä¹Ÿåªèƒ½æ˜¯å•åˆ†åŒºï¼Œé¢„å¤„ç†åˆ†å‘éƒ¨åˆ†ä¹Ÿåªèƒ½æ˜¯å•çº¿ç¨‹ï¼Œæ•´ä½“æ€§èƒ½è·Ÿç°åœ¨æ˜¯ä¸€æ ·çš„ã€‚å…¶å®ç°åœ¨é‡ä¹Ÿè¾¾ä¸åˆ°ä¸å¤Ÿç”¨çš„ç¨‹åº¦ï¼Œåªæ˜¯æƒ³çœ‹çœ‹æ˜¯ä¸æ˜¯æœ‰æ›´å¥½çš„æ–¹å¼ï¼Œæ‰€ä»¥æ¥è·Ÿå¤§å®¶äº¤æµä¸€ä¸‹ @undeadwing æŠŠå¹¶å‘æ‰“å¼€è¯•äº†æ²¡ï¼Ÿä¸çŸ¥ä½ ç›®å‰æ•°æ®åº“çš„tpsæ˜¯å¤šå°‘ï¼Œå»¶è¿Ÿæ˜¯å¤šå¤§ï¼Ÿ @wingerx æˆ‘æœ¬æ¥ç”¨groupæ¨¡å¼ï¼Œæ¥äº†5ä¸ªmysqlï¼Œå‘ç°å¾ˆåƒåŠ›ï¼Œç°åœ¨æ‹†äº†ï¼Œæ¯ä¸ªmysqlæ¥ä¸€ä¸ªdefaultæ¨¡å¼çš„å®ä¾‹ï¼Œå•ä¸ªå®ä¾‹è¿‡æ»¤åtpsæ­£å¸¸ä¹Ÿå°±å‡ ååˆ°ä¸€ç™¾å¤šå§ï¼Œæ²¡æœ‰å»¶è¿Ÿï¼Œä¸šåŠ¡æœ‰æ—¶å€™ä¼šå…¨è¡¨updateä¸€ä¸ªå­—æ®µï¼Œé‚£æ—¶å€™ä¼šå¡å¾ˆä¹…ï¼Œtpsä¹Ÿå¾ˆé«˜ã€‚ä¹‹å‰æ²¡ç”¨kafkaçš„æ—¶å€™ï¼Œæ•°æ®æœ‰é”™serverç«¯éœ€è¦å›é€€ï¼Œç„¶åclientåªèƒ½å•çº¿ç¨‹è¿½æ•°ï¼Œè¿½çš„æ¯”è¾ƒæ…¢ï¼Œæ‰€ä»¥ç°åœ¨æƒ³ä½¿ç”¨kafkaå¤šåˆ†åŒºï¼Œä¹‹åå‡ºé—®é¢˜æˆ–è€…å…¨è¡¨updateå¤šçº¿ç¨‹æ¶ˆè´¹å°±å¾ˆå¿«äº† clientå¦‚æœæ¶ˆè´¹é€»è¾‘ç»„è£…æ•°æ®å¾ˆæ…¢ï¼Œè¿™ä¸ªæ¶ˆè´¹æ€§èƒ½å¤ªä½äº†ï¼Œclientå®Œå…¨å¯ä»¥å¤šçº¿ç¨‹æ¶ˆè´¹ï¼Œäº‹åŠ¡æäº¤åè®°å½•ä¸€ä¸ªoffsetåˆ°zkï¼Œå¦‚æœkill-9ï¼Œä¸‹æ¬¡ä»è¿™ä¸ªoffseté‡æ–°å¼€å§‹æ¶ˆè´¹ï¼Œæ¶ˆè´¹è¾“å‡ºéœ€è¦ä¿è¯å¹‚ç­‰ï¼›å®é™…ä¸Šæ¶ˆè´¹çº¿ç¨‹æ± å®è·µä¸­éƒ½æ˜¯å‡ºäºé¥¥é¥¿çŠ¶æ€ï¼Œé˜»å¡é˜Ÿåˆ—æ²¡æœ‰ä»»åŠ¡ç­‰å¾…ï¼Œåˆšå¼€å§‹ä¸Šçº¿çš„æ—¶å€™å¯ä»¥ä¸è€ƒè™‘è¿™ä¸ªåœºæ™¯ï¼›å¦‚æœéœ€è¦ä¿è¯é¡ºåºé—®é¢˜ï¼Œåœ¨clientæ¶ˆè´¹çš„æ—¶å€™åšä¸€ä¸ªhashåçº¿ç¨‹æ± ç»‘å®šå³å¯(åˆå§‹åŒ–Nä¸ªå•çº¿ç¨‹çš„çº¿ç¨‹æ± )ï¼Œæˆ‘ç°åœ¨å°±æ˜¯æŒ‰ç…§è¿™ä¸ªæ€è·¯å¤„ç†çš„ï¼Œ8ä¸ª canal serverå›æº¯å†å²binlog25åˆ†é’Ÿæ‹‰1100Wæ¶ˆæ¯ï¼Œæ¶ˆè´¹8ä¸ªèŠ‚ç‚¹æ¯ä¸ªèŠ‚ç‚¹50çº¿ç¨‹æ± éœ€è¦40åˆ†é’Ÿæ¶ˆè´¹å®Œï¼Œå¦‚æœæ˜¯å•çº¿ç¨‹æ¶ˆè´¹é‡åˆ°å¤§é‡æ›´æ–°å°±å‚»çœ¼äº†ã€‚ å¦‚æœèƒ½å¤Ÿåœ¨æºå¤´å…¥kafkaçš„æ—¶å€™å°±åšå¥½æ•°æ®åˆ†å‘ï¼Œclientç«¯å°±ä¸ç”¨è€ƒè™‘å¹¶å‘çš„é¡ºåºé—®é¢˜äº† @yin007008 æ„Ÿè°¢æä¾›æ€è·¯ï¼Œä¹‹å‰æ²¡æƒ³è¿‡çº¿ç¨‹æ± ç»‘å®šã€‚æˆ‘ç°åœ¨çš„åšæ³•æ˜¯åœ¨kafkaå‘é€çš„æ—¶å€™å°†æ•°æ®æ‹†åˆ†æˆå•æ¡ï¼ŒæŒ‰ç…§keyå‘é€åˆ°kafkaå¤šåˆ†åŒºï¼Œè¿™æ ·çš„å¥½å¤„ä¸€æ˜¯æ¶ˆè´¹æ—¶å€™é¡ºåºå¯ä»¥ä¿è¯ï¼ŒäºŒæ˜¯æ•°æ®å›æº¯æ—¶serverç«¯ä¸éœ€è¦æ“ä½œï¼Œclientç«¯è®¾ç½®ä¸‹kafkaæ¶ˆè´¹èµ·å§‹æ—¶é—´å³å¯ï¼Œä¸‰æ˜¯æ¶ˆè´¹è€…å¯ä»¥æ˜¯å•å®ä¾‹å¤šçº¿ç¨‹ï¼Œä¹Ÿå¯ä»¥æ˜¯åœ¨ä¸åŒæœºå™¨ä¸Šçš„å¤šå®ä¾‹å¤šçº¿ç¨‹ï¼Œæ¶ˆè´¹æ€§èƒ½å’Œå¯ç”¨æ€§å¾—åˆ°ä¿è¯ï¼Œç¼ºç‚¹å°±æ˜¯æ•°æ®æ‹†åˆ†é‡ç»„éƒ¨åˆ†éœ€è¦ååºåˆ—åŒ–å†åºåˆ—åŒ–ï¼Œå¯èƒ½ä¼šæˆä¸ºæ€§èƒ½ç“¶é¢ˆã€‚ç›®å‰æ¥å…¥ä½¿ç”¨æ­£å¸¸ï¼Œæœ€å¤§å¹¶å‘æ•°æ²¡æµ‹è¯•ã€‚ å¤špartitionåˆ†åŒºï¼Œæœ€å¤§çš„é—®é¢˜åœ¨äºpk/ukçš„å˜æ›´.  å¦‚æœä¸šåŠ¡åœºæ™¯ä¸Šèƒ½è§„é¿ï¼Œé‚£æ˜¯æ¯”è¾ƒperfectçš„.  ps.  å·²ç»æœ‰äººæäº¤äº†å¤šåˆ†åŒºå†™å‡ºåˆ°kafkaçš„æ–¹æ¡ˆï¼Œä¸‹ä¸€ä¸ªç‰ˆæœ¬å°±ä¼šå¸¦ä¸Š #958
931,fix #904: ç©ºè®°å½•æ—¶sleep 1sé˜²æ­¢å¾ªç¯getæ•°æ®è¿‡å¿« 1000msé•¿äº†ç‚¹  å¦‚æœæ§åˆ¶binlogä½å»¶è¿Ÿ  å¯ä»¥è€ƒè™‘10~100ms tks
930,canalæœåŠ¡å¼‚å¸¸ [New I/O server worker #1-1] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x6b1bba32  /192.10.0.46:57388 => /192.10.16.48:11111]  exception=java.io.IOException: Connection reset by peer è€ƒè™‘å‡çº§canalç‰ˆæœ¬ ä¼°è®¡æ˜¯idleè¶…æ—¶äº†
929,Message æ€»æ˜¯è¿”å› RawEntries å¦‚ä½•è§£æï¼Ÿ è¯·é—®å¦‚ä½•å°† `RawEntries` ä¸­çš„`ByteString` è½¬ä¸ºæ­£å¸¸çš„ä¸šåŠ¡å¯¹è±¡ï¼Ÿ ææ¸…æ¥šäº†ï¼Œå…ˆè§£æå‡º `Entry` å†è§£æå‡º `RowChange`ã€‚     Entry changeEntry = Entry.parseFrom(rawEntry);     RowChange.parseFrom(changeEntry.getStoreValue()); 
928,Consider add filed executeTime at canal-adapter-common class Dml? Consider add filed executeTime?  That's sql exactly execute time  more useful sometimes. solved on v1.1.1
927,fix #912 è§£å†³guavaå†²çªé—®é¢˜ é€šè¿‡mavenæ’ä»¶å°†guavaä¿®æ”¹åŒ…è·¯å¾„æ‰“åŒ…è¿›canal.client tks
926,åœ¨ç‰ˆæœ¬1.1.0ä¸­ï¼Œé»˜è®¤å¼€å¯äº†tsdbï¼ŒæŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ 2018-09-11 11:10:08.724 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: apply failed Caused by: org.springframework.jdbc.BadSqlGrammarException: SqlMapClient operation; bad SQL grammar []; nested exception is com.ibatis.common.jdbc.exception.NestedSQLException: --- The error occurred in spring/tsdb/sql-map/sqlmap_history.xml. --- The error occurred while executing query. --- Check the          select                     a.id as id a.gmt_create as gmtCreate a.gmt_modified as gmtModified    a.destination as destination a.binlog_file as binlogFile a.binlog_offest as binlogOffest a.binlog_master_id as binlogMasterId a.binlog_timestamp as binlogTimestamp    a.use_schema as useSchema a.sql_schema as sqlSchema a.sql_table as sqlTable a.sql_text as sqlText a.sql_type as sqlType a.extra as extra                       from meta_history a         where destination = ? and binlog_timestamp >= ? and binlog_timestamp <= ?         order by binlog_timestamp asc id asc              . --- Check the SQL Statement (preparation failed). --- Cause: org.h2.jdbc.JdbcSQLException: Table "META_HISTORY" not found; SQL statement:          select                     a.id as id a.gmt_create as gmtCreate a.gmt_modified as gmtModified    a.destination as destination a.binlog_file as binlogFile a.binlog_offest as binlogOffest a.binlog_master_id as binlogMasterId a.binlog_timestamp as binlogTimestamp    a.use_schema as useSchema a.sql_schema as sqlSchema a.sql_table as sqlTable a.sql_text as sqlText a.sql_type as sqlType a.extra as extra                       from meta_history a                  where destination = ? and binlog_timestamp >= ? and binlog_timestamp <= ?         order by binlog_timestamp asc id asc               [42102-196]         at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:237)         at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:72)         at org.springframework.orm.ibatis.SqlMapClientTemplate.execute(SqlMapClientTemplate.java:206)         at org.springframework.orm.ibatis.SqlMapClientTemplate.queryForList(SqlMapClientTemplate.java:296)         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.dao.MetaHistoryDAO.findByTimestamp(MetaHistoryDAO.java:28)         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.applyHistoryOnMemory(DatabaseTableMeta.java:367)         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:123)         at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:91)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:188)         at java.lang.Thread.run(Thread.java:748) Caused by: com.ibatis.common.jdbc.exception.NestedSQLException: --- The error occurred in spring/tsdb/sql-map/sqlmap_history.xml. --- The error occurred while executing query. --- Check the          select                     a.id as id a.gmt_create as gmtCreate a.gmt_modified as gmtModified    a.destination as destination a.binlog_file as binlogFile a.binlog_offest as binlogOffest a.binlog_master_id as binlogMasterId a.binlog_timestamp as binlogTimestamp    a.use_schema as useSchema a.sql_schema as sqlSchema a.sql_table as sqlTable a.sql_text as sqlText a.sql_type as sqlType a.extra as extra                       from meta_history a                  where destination = ? and binlog_timestamp >= ? and binlog_timestamp <= ?         order by binlog_timestamp asc id asc              . --- Check the SQL Statement (preparation failed). --- Cause: org.h2.jdbc.JdbcSQLException: Table "META_HISTORY" not found; SQL statement:          select                     a.id as id a.gmt_create as gmtCreate a.gmt_modified as gmtModified    a.destination as destination a.binlog_file as binlogFile a.binlog_offest as binlogOffest a.binlog_master_id as binlogMasterId a.binlog_timestamp as binlogTimestamp    a.use_schema as useSchema a.sql_schema as sqlSchema a.sql_table as sqlTable a.sql_text as sqlText a.sql_type as sqlType a.extra as extra                       from meta_history a                  where destination = ? and binlog_timestamp >= ? and binlog_timestamp <= ?         order by binlog_timestamp asc id asc               [42102-196]         at com.ibatis.sqlmap.engine.mapping.statement.MappedStatement.executeQueryWithCallback(MappedStatement.java:201)         at com.ibatis.sqlmap.engine.mapping.statement.MappedStatement.executeQueryForList(MappedStatement.java:139)         at com.ibatis.sqlmap.engine.impl.SqlMapExecutorDelegate.queryForList(SqlMapExecutorDelegate.java:567)         at com.ibatis.sqlmap.engine.impl.SqlMapExecutorDelegate.queryForList(SqlMapExecutorDelegate.java:541)         at com.ibatis.sqlmap.engine.impl.SqlMapSessionImpl.queryForList(SqlMapSessionImpl.java:118)         at org.springframework.orm.ibatis.SqlMapClientTemplate$3.doInSqlMapClient(SqlMapClientTemplate.java:298)         at org.springframework.orm.ibatis.SqlMapClientTemplate$3.doInSqlMapClient(SqlMapClientTemplate.java:296)         at org.springframework.orm.ibatis.SqlMapClientTemplate.execute(SqlMapClientTemplate.java:203)         ... 7 more Caused by: org.h2.jdbc.JdbcSQLException: Table "META_HISTORY" not found; SQL statement:          select                     a.id as id a.gmt_create as gmtCreate a.gmt_modified as gmtModified    a.destination as destination a.binlog_file as binlogFile a.binlog_offest as binlogOffest a.binlog_master_id as binlogMasterId a.binlog_timestamp as binlogTimestamp    a.use_schema as useSchema a.sql_schema as sqlSchema a.sql_table as sqlTable a.sql_text as sqlText a.sql_type as sqlType a.extra as extra                       from meta_history a                  where destination = ? and binlog_timestamp >= ? and binlog_timestamp <= ?         order by binlog_timestamp asc id asc               [42102-196]         at org.h2.message.DbException.getJdbcSQLException(DbException.java:345)         at org.h2.message.DbException.get(DbException.java:179)         at org.h2.message.DbException.get(DbException.java:155)         at org.h2.command.Parser.readTableOrView(Parser.java:5552)         at org.h2.command.Parser.readTableFilter(Parser.java:1266)         at org.h2.command.Parser.parseSelectSimpleFromPart(Parser.java:1946)         at org.h2.command.Parser.parseSelectSimple(Parser.java:2095)         at org.h2.command.Parser.parseSelectSub(Parser.java:1940)         at org.h2.command.Parser.parseSelectUnion(Parser.java:1755)         at org.h2.command.Parser.parseSelect(Parser.java:1743)         at org.h2.command.Parser.parsePrepared(Parser.java:449)         at org.h2.command.Parser.parse(Parser.java:321)         at org.h2.command.Parser.parse(Parser.java:293)         at org.h2.command.Parser.prepareCommand(Parser.java:258)         at org.h2.engine.Session.prepareLocal(Session.java:578)         at org.h2.engine.Session.prepareCommand(Session.java:519)         at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1204)         at org.h2.jdbc.JdbcPreparedStatement.<init>(JdbcPreparedStatement.java:73)         at org.h2.jdbc.JdbcConnection.prepareStatement(JdbcConnection.java:288)         at com.alibaba.druid.pool.DruidPooledConnection.prepareStatement(DruidPooledConnection.java:349)         at com.ibatis.sqlmap.engine.execution.SqlExecutor.prepareStatement(SqlExecutor.java:497)         at com.ibatis.sqlmap.engine.execution.SqlExecutor.executeQuery(SqlExecutor.java:175)         at com.ibatis.sqlmap.engine.mapping.statement.MappedStatement.sqlExecuteQuery(MappedStatement.java:221)         at com.ibatis.sqlmap.engine.mapping.statement.MappedStatement.executeQueryWithCallback(MappedStatement.java:189)  Table "META_HISTORY" not found   confä¸‹æœ‰ä¸€äº›åˆå§‹åŒ–çš„ddlæ–‡ä»¶ï¼Œæ£€æŸ¥ä¸€ä¸‹ @agapple åœ¨canal-1.1.0/conf/spring/tsdb/sql/create_table.sql æœ‰è¿™ä¸ªæ–‡ä»¶ å°è¯•debugçœ‹ä¸€ä¸‹å§  ä¸ºå•¥initTableçš„æ“ä½œæ²¡æœ‰ç”Ÿæ•ˆ  MetaHistoryDAOé‡Œçš„initTable å¥½çš„ï¼Œè°¢è°¢ @agapple 
925,å¦‚ä½•ç¡®å®šåŒæ­¥å®Œæˆï¼Ÿ ä½¿ç”¨ç¤ºä¾‹ç¨‹åºexampleä¼šæŒç»­è·å–å‘é€dumpåè®®ï¼Œè·å–masterç«¯çš„binlogæ•°æ®ï¼Œç„¶åè¿›è¡Œæ›´æ–°å¤„ç†ã€‚ä½†å‘ç°ï¼Œä¼¼ä¹ç¨‹åºåœ¨åŒæ­¥å®Œæ•°æ®åæ²¡æœ‰ç»“æŸæˆ–å¤„äºå¾…æœºçŠ¶æ€ï¼Œè€Œæ˜¯æŒç»­ä¸æ–­åœ°é‡å¤ä¸Šä¸€æ¬¡çš„åŒæ­¥æ•°æ®ã€‚ä¾‹å¦‚å‘ä¸»åº“æ–°å¢10æ¡è®°å½•ï¼ŒæŒ‰å¤„ç†æµç¨‹å¤‡åº“å¢åŠ 10æ¡ï¼ŒæŒ‰ç…§ä¸€èˆ¬é€»è¾‘æ­¤æ—¶å®¢æˆ·ç«¯å·²å®ŒæˆåŒæ­¥ï¼Œåº”å¤„äºå¾…æœºçŠ¶æ€ï¼Œç›´åˆ°ä¸»åº“æœ‰æ–°çš„æ›´æ–°ï¼Œå†è¿›è¡ŒåŒæ­¥ã€‚è€Œç¤ºä¾‹ç¨‹åºå±•ç¤ºçš„æ˜¯æŒç»­å¦æ–­åœ°é‡å¤ä¹‹å‰å·²åŒæ­¥çš„æ•°æ®ï¼Œè¯·é—®æ˜¯éœ€è¦è¿›è¡Œä»€ä¹ˆå‚æ•°è®¾ç½®å—ï¼Ÿ å¦å¤–ï¼Œ1.1.0ç‰ˆæœ¬çš„canal-exampleå¯¹DDLæ“ä½œä»…è¾“å‡ºeventypeå’Œsqlè¯­å¥ï¼Œä¼¼ä¹æ²¡æœ‰å¯¹å¤‡åº“è¿›è¡Œç›¸åº”çš„DDLæ“ä½œï¼Œä¸çŸ¥æƒ…å†µæ˜¯å¦å±å®ï¼Ÿ å…ˆè°¢è°¢åŒè¡Œè§£ç­”ã€‚ 2018-09-10 17:06:07.896 [Thread-2] WARN  com.alibaba.otter.canal.example.db.CanalConnectorClient - parse event : QUERY  sql: create table xgeom3(id int(20) not null auto_increment location point not null x timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP primary key(id) spatial key sp_index(location)) ENGINE=MyISAM AUTO_INCREMENT=3 DEFAULT CHARSET=utf8 . ignored! 2018-09-10 17:06:07.899 [Thread-2] INFO  com.alibaba.otter.canal.example.db.CanalConnectorClient -  ===========Transaction begin : =======>>>binlog[mysql-bin.000001:8519]   executeTime : 1536567819000   delay : 2548899ms close this issue.
924,update æ•´å¼ è¡¨åæ— é™å¾ªç¯æŠ¥é”™ no match ack positionLogPosition é”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼š 2018-09-10 12:09:57.669 [pool-7-thread-1] ERROR com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter - no match ack positionLogPosition[identity=LogIdentity[sourceAddress=/47.97.169.27:3317 slaveId=-1] postion=EntryPosition[included=false journalName=mysql-bin.000003 position=7080270 serverId=20183317 gtid= timestamp=1536552101000]] sql: update t_order_shop_0024 set  modify_time = now() ; # binlog filter config canal.instance.filter.druid.ddl = true canal.instance.filter.query.dcl = true canal.instance.filter.query.dml = true canal.instance.filter.query.ddl = true canal.instance.filter.table.error = true canal.instance.filter.rows = false canal.instance.filter.transaction.entry = true è§£æçš„binlogä¿¡æ¯: * Batch Id: [149136]  count : [1]   memsize : [8064]   Time : 2018-09-10 12:30:11 * Start : [mysql-bin.000003:7080270:1536552101000(2018-09-10 12:01:41)]  * End : [mysql-bin.000003:7080270:1536552101000(2018-09-10 12:01:41)]  kafkaçš„æ¶ˆæ¯ä¸€ç›´åœ¨å¢é•¿ï¼Œçœ‹æ—¥å¿—binlogå…¨éƒ¨æ˜¯ä¸Šé¢è¿™ä¸ªmysql-bin.000003:7080270:1536552101000 é—®é¢˜åŸºæœ¬ä¸ŠæŸ¥æ˜: canal.instance.filter.transaction.entry = true è¿‡æ»¤äº‹åŠ¡å¤´å°¾è®¾ç½®ä¸ºtrueä¹‹åï¼Œå¦‚æœzkä¸Šæ²¡æœ‰ç‚¹ä½ä¿¡æ¯ï¼Œèµ·å§‹æˆ‘ç»™çš„ä¸€ä¸ª5å¤©å‰çš„timestampï¼Œåˆšå¥½åˆåšäº†å¤§æ‰¹é‡æ›´æ–°å°±ä¼šæ— é™å¾ªç¯æŠ¥é”™ é—®é¢˜çš„å…³é”®ç‚¹åº”è¯¥æ˜¯canal.instance.filter.transaction.entry = true è¿™ä¸ªè®¾ç½®ä¸ºtrueäº† éœ€è¦ä½ç‚¹æ›´æ–°çš„ä½¿ç”¨çš„ï¼Œä¸èƒ½å°†canal.instance.filter.transaction.entryè®¾ç½®ä¸ºtrue LSæ­£è§£
923,æ€ä¹ˆè§£å†³å®¿ä¸»æœºè®¿é—®docker ç»‘å®šçš„ipå•Š ä½¿ç”¨docker æ¨¡å¼æ—¶ï¼Œcanalå‘zookeeperæ³¨å†Œçš„ipæ˜¯dockerå®¹å™¨çš„ç½‘ç»œçš„ipï¼š172.17.0.3 æ¯”å¦‚dockeré‡Œçš„canal-serverç»‘å®šçš„åœ°å€æ˜¯/172.17.0.3:11111 é‚£ä¹ˆæˆ‘çš„å®¢æˆ·ç«¯è®¿é—®ä¸äº†çš„å•Š com.alibaba.otter.canal.protocol.exception.CanalClientException: java.net.ConnectException: Connection timed out: connect 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.doConnect(SimpleCanalConnector.java:171) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.access$000(SimpleCanalConnector.java:48) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector$1.processActiveEnter(SimpleCanalConnector.java:396) 	at com.alibaba.otter.canal.client.impl.running.ClientRunningMonitor.processActiveEnter(ClientRunningMonitor.java:207) 	at com.alibaba.otter.canal.client.impl.running.ClientRunningMonitor.initRunning(ClientRunningMonitor.java:118) 	at com.alibaba.otter.canal.client.impl.running.ClientRunningMonitor.start(ClientRunningMonitor.java:92) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.connect(SimpleCanalConnector.java:93) 	at com.alibaba.otter.canal.client.impl.ClusterCanalConnector.connect(ClusterCanalConnector.java:63) 	at com.fcbox.canal.scheduling.SchedulerTask.run(SchedulerTask.java:39) Caused by: java.net.ConnectException: Connection timed out: connect 	at sun.nio.ch.Net.connect0(Native Method) 	at sun.nio.ch.Net.connect(Net.java:454) 	at sun.nio.ch.Net.connect(Net.java:446) 	at sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:648) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.doConnect(SimpleCanalConnector.java:132) 	... 8 common frames omitted 2018-09-10 11:03:05 454 WARN (ClusterCanalConnector.java:66)- failed to connect to:**### /172.17.0.3:11111** after retry 0 times è€Œä¸”canal.ipä¹Ÿä¸èƒ½ç›´æ¥å†™æˆå®¿ä¸»æœºçš„ipï¼Œä¼šæŠ¥é”™çš„ã€‚ å¯ä»¥è€ƒè™‘dockerçš„hostæ¨¡å¼
922,å…³äº canal.instance.filter.regex è®¾ç½®çš„é—®é¢˜ ç‰ˆæœ¬ 1.0.24 @agapple  é—®é¢˜ç°è±¡ï¼š åœ¨åŒä¸€ä¸ªmysqlä¸­ æˆ‘çš„canal.instance.filter.regex=cms\\.rc_.*ï¼Œæ„æ€æ˜¯åªè®¢é˜…cmsæ•°æ®åº“ä¸‹çš„rc_å¼€å¤´çš„è¡¨ï¼Œè¿™æ ·æ˜¯æ²¡é—®é¢˜çš„ã€‚ ä½†æ˜¯æˆ‘åœ¨debugä»£ç æ—¶ï¼Œæˆ‘ä¿®æ”¹å…¶å®ƒæ•°æ®åº“ä¸‹çš„è¡¨ æ¯”å¦‚ æˆ‘ä¿®æ”¹ testæ•°æ®åº“ä¸‹çš„è¡¨ï¼Œæˆ‘çš„å®¢æˆ·ç«¯è¿˜æ˜¯èƒ½æ¥æ”¶åˆ°æ¶ˆæ¯ï¼Œæ¶ˆæ¯çš„ entryType åªæœ‰TRANSACTIONBEGINå’ŒTRANSACTIONENDï¼›è™½ç„¶è¿™ä¸¤ä¸ªæ¶ˆæ¯å¹¶ä¸æ˜¯æˆ‘æƒ³è¦çš„ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯å¸Œæœ›ä¸è¦æ”¶åˆ°å…¶å®ƒæ•°æ®åº“ä¿®æ”¹åçš„â€œåƒåœ¾â€æ¶ˆæ¯: åƒåœ¾æ¶ˆæ¯å¦‚ä¸‹ï¼š header {   version: 1   logfileName: "mysql-bin.000001"   logfileOffset: 6882   serverId: 1   serverenCode: "UTF-8"   executeTime: 1536320325000   sourceType: MYSQL   schemaName: ""   tableName: ""   eventLength: 75 } entryType: TRANSACTIONBEGIN storeValue: " \036" æˆ‘æƒ³åœ¨è¡¨è¾¾ ä¸‹æˆ‘çš„é—®é¢˜ï¼š 1.canal.instance.filter.regex=cms\.rc_.*çš„ç¡®èƒ½è¾¾åˆ°æˆ‘é¢„æœŸçš„æ•ˆæœã€‚ 2.ä½†æ˜¯å…¶å®ƒçš„æ•°æ®åº“(schema)çš„æ¶ˆæ¯æˆ‘ä¹Ÿæ”¶åˆ°äº†(å¢åˆ æ”¹å°±ä¼šæ”¶åˆ°æ¶ˆæ¯)ï¼ŒentryType è™½ç„¶æ²¡æœ‰å¢åˆ æ”¹çš„æ¶ˆæ¯ï¼ŒåªTRANSACTIONBEGINå’ŒTRANSACTIONENDï¼Œä½†æˆ‘ä¸æƒ³æ”¶åˆ°è¿™ä¸¤ä¸ªæ¶ˆæ¯ã€‚ 3.æœ‰ä»€ä¹ˆåŠæ³•èƒ½è§£å†³ã€‚ æœ‰å‚æ•°å¯ä»¥å…³é—­  è¿‡æ»¤æ‰ç©ºäº‹åŠ¡çš„å¤´å’Œå°¾ åœ¨canal.properteis é‡Œé¢åªæœ‰ä¸€ä¸ªæ˜¯true å…¶ä»–å…¨éƒ¨å¯ä»¥æ”¹ä¸ºfalse https://github.com/alibaba/canal/wiki/AdminGuideè¿™é‡Œå¯ä»¥çœ‹ canal.instance.filter.transaction.entry = true  è¿™ä¸ªæ„æ€å°±æ˜¯æŠŠäº‹åŠ¡å¤´å°¾è¿‡æ»¤ canal.instance.filter.query.dcl = true canal.instance.filter.query.dml = true canal.instance.filter.query.ddl = true canal.instance.filter.table.error = true è¿™ä¸ªé…ç½®å°±æ˜¯æŠŠé»˜è®¤äº§ç”Ÿçš„sqlè¯­å¥ç»™è¿‡æ»¤æ‰ï¼Œä¹Ÿå°±æ˜¯binlogæ—¥å¿—æ”¹ä¸ºrowæ¨¡å¼åï¼Œè¿˜æ˜¯ä¼šæœ‰ä¸€æ¡EntryTypeä¸ºQUERYçš„sqlè¯­å¥ @yin007008 @agapple è°¢è°¢
921,canal.instance.filter.transaction.entry è®¾ç½®trueå  zk cusorä¸æ›´æ–° canal.instance.filter.transaction.entry = true {"@type":"com.alibaba.otter.canal.protocol.position.LogPosition" "identity":{"slaveId":-1 "sourceAddress":{"address":"10.35.165.15" "port":3306}} "postion":{"gtid":"" "included":false "journalName":"mysql-bin.000023" "**position**":43893 "serverId":1 "timestamp":1536312619000}} canal.instance.filter.transaction.entryä¸è¦éšæ„è®¾ç½®  ä¼šå¯¼è‡´zkçŠ¶æ€ä¸æ›´æ–°
920,canan kafka æ•°æ®è¿‡æ»¤é—®é¢˜ é…ç½®äº† ç™½åå• canal.instance.filter.regex=easy4ip.civil_user_phone  è¿˜æ˜¯èƒ½æ”¶åˆ°å…¶ä»–è¡¨çš„ä¿¡æ¯ è§å¦‚ä¸‹æ‰“å° ``` table:sys_user logfile:mysql-bin.000023 entry:ROWDATA eventType:QUERY sql:UPDATE `sys_user` SET `LOGIN_DATE`='2018-09-08 15:36:02' WHERE (`ID`='21') ``` çœ‹FAQ
919,Fix upgrade protobuf version upgrade  protobuf  version [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=919) <br/>All committers have signed the CLA. [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=919) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=919) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=919) it.</sub> å‡çº§äº†protobuf 3.6.1ä¹‹å  ä½¿ç”¨è€ç‰ˆæœ¬protobuf 2.6.1çš„å®¢æˆ·ç«¯æ˜¯å¦å¯ä»¥è¯»å–åˆ°æ•°æ®?  ä¼°è®¡æ˜¯ä¸è¡Œçš„ï¼Œè¿™ä¸ªå‡çº§ä¸å…¼å®¹ã€‚ å¯ä»¥è¯»å–åˆ°æ•°æ®ï¼Œæˆ‘ç”¨çš„æ˜¯1.1.0çš„clietæµ‹è¯•å¯ä»¥è¿ tks
918,æ–°æ—§ç‰ˆæœ¬æ˜¯å¦å…¼å®¹ v1.1.0å‡ºæ¥ä¹‹åæ‰“ç®—å‡çº§ï¼ˆè€ç‰ˆæœ¬1.0.26-snapshotï¼‰ï¼Œç”±äºå¯¹å®æ—¶æ€§è¦æ±‚è¾ƒé«˜ï¼Œä¸èƒ½åœæœï¼Œè€ƒè™‘åæƒ³è¦å¹³æ»‘çš„å‡çº§ï¼š 1ã€æ–°ç‰ˆæœ¬é…ç½®ç›¸åŒçš„configï¼Œå’Œè€ç‰ˆæœ¬çš„å…±åŒæ³¨å†Œåœ¨åŒä¸€ä¸ªzkä¸Šã€‚ 2ã€å…³æ‰è€ç‰ˆæœ¬èŠ‚ç‚¹ï¼Œè®©æ–°ç‰ˆæœ¬æŠ¢å å¤„ç†æƒã€‚ 3ã€å†ä¸Šä¸€ä¸ªæ–°ç‰ˆæœ¬çš„serverã€‚ æœ‰ä¸€ä¸ªç–‘é—®ï¼Œåœ¨æ­¥éª¤1çš„æ—¶å€™æ–°è€ç‰ˆæœ¬èƒ½å…¼å®¹å—ï¼Ÿ æ–‡æ¡£ä¸Šè¯´å¯ä»¥å®Œå…¨å…¼å®¹ã€‚
917,canal.instance.dbPassword = æ•°æ®åº“å¯†ç æ”¯æŒåŠ å¯†å˜›ï¼Ÿ å¯ä»¥è€ƒè™‘æ ¹æ®è‡ªå·±çš„éœ€æ±‚ï¼Œæ‰©å±•ä¸‹ propertiesResolverè¦†ç›–æ‰
916,zookeeperé›†ç¾¤æ­å»ºcanalå¯åŠ¨æŠ¥é”™? - Session 0x0 for server null  unexpected error  closing socket connection and attempting reconnect java.net.ConnectException: Connection refused 	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.8.0_181] 	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[na:1.8.0_181] 	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.4.5.jar:3.4.5-1392090] 	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1068) ~[zookeeper-3.4.5.jar:3.4.5-1392090] `canal.properties:` canal.id= 1 canal.zkServers=10.153.1.208:2888 10.153.0.183:2888 10.153.0.38:2888 canal.instance.global.spring.xml = classpath:spring/default-instance.xml æ˜¯æˆ‘canalè¿æ¥zookeeperè¿æ¥çš„ç«¯å£å·å¼„é”™äº†ã€‚
915,å…³äºmysqlä¸»å¤‡åˆ‡æ¢ ä¸¤ä¸ªé—®é¢˜ï¼Œæœ›æŒ‡æ•™ 1ã€canalä¸­è®¾ç½®å¤‡ç”¨åº“ï¼Œä¸»åº“å®•æœºï¼Œåˆ‡åˆ°å¤‡ç”¨åº“ã€‚ä¹‹åä¸»åº“æ¢å¤ï¼Œå¤‡ç”¨åº“å®•æœºï¼Œèƒ½åˆ‡å›ä¸»åº“ä¹ˆ 2ã€canalæ˜¯å¦æ”¯æŒvipï¼Œä»è€Œä¸å…³æ³¨ç‰©ç†èŠ‚ç‚¹çš„åˆ‡æ¢ 1.  ä¸ä¼šä¸»åŠ¨ä¸»åº“ 2.  æ”¯æŒrds vipçš„æ¨¡å¼ @agapple tks åˆ‡æ¢åˆ°å¤‡åº“ä»¥åï¼Œå›é€€60sï¼Œæ•°æ®é‡å¤é—®é¢˜æ€ä¹ˆè§£å†³ï¼Ÿé ä¸»é”®ä¹ˆï¼Ÿå¦‚æœä¿®æ”¹äº†ä¸»é”®æ€ä¹ˆåŠï¼Ÿä¾‹å¦‚ï¼šæºç«¯æ“ä½œ 1ã€insert id=1; 2ã€update id=2 where id=1; æºç«¯ç›®æ ‡ç«¯æ•°æ®åº“éƒ½æ˜¯ä¸€æ¡æ•°æ®id=2äº†ç°åœ¨ã€‚æ­¤æ—¶ä¸»åº“åˆ‡æ¢åˆ°å¤‡åº“ï¼Œå›é€€60sæ—¥å¿—ã€‚åˆé‡åšäº†æ­¥éª¤1å’Œ2ï¼Œ1æˆåŠŸï¼Œ2å¤±è´¥ï¼ˆä¸»é”®å†²çªï¼‰ã€‚æ­¤æ—¶ç›®æ ‡åº“å°±å˜æˆid=1å’Œid=2ä¸¤æ¡æ•°æ®ã€‚æ•°æ®ä¸ä¸€è‡´äº†å’Œæºç«¯ã€‚ 1.  insertå¯ä»¥è€ƒè™‘ä½¿ç”¨merge sql 2. updateé‡åˆ°ä¸»é”®å†²çªï¼Œæ‹†ä¸ºdelete before pk + merge insert new pk
914,canal.instance.dbPassword = æ•°æ®åº“å¯†ç æ”¯æŒåŠ å¯†çš„å¯†ç ï¼Ÿ è¿™ä¸ªå¯†ç æ”¯æŒåŠ å¯†çš„å¯†ç ï¼Ÿ ç›®å‰ä¸æ”¯æŒ  å¯ä»¥è€ƒè™‘æäº¤ä¸€ä¸ªPRç»™æˆ‘
913,[v1.1.0]å¼‚å¸¸åœºæ™¯æµ‹è¯•å¯¼è‡´æ“ä½œç³»ç»Ÿcannot allocate memoryå†…å­˜æ³„æ¼ æ¨¡æ‹ŸMySQL-binlongæ–‡ä»¶å†…å®¹è·Œæ–­ï¼Œå¯¹binlogæ–‡ä»¶åˆ é™¤ä¸€éƒ¨åˆ†æ•°æ®ï¼Œcanalåœ¨å‘é€dumpè§£æåˆ°æ­¤binlogæ–‡ä»¶æ—¶å¼‚å¸¸ï¼Œå¼‚å¸¸æŒç»­é•¿æ—¶é—´ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ã€‚ æ“ä½œç³»ç»Ÿæ—¥å¿—ï¼šFatal error : pthread_create() failed æœ€ç»ˆå¯¼è‡´æ“ä½œç³»ç»Ÿcannot allocate memory æœ€ååªèƒ½é‡å¯ç³»ç»Ÿ @agapple  ä½ è‡ªå·±æ£€æŸ¥ä¸€ä¸‹jvmæ‰€éœ€è¦çš„å†…å­˜å‚æ•°å’Œä½ æœºå™¨çš„å†…å­˜æ˜¯å¦match @agapple    æœºå™¨å†…å­˜16G canalä½¿ç”¨é»˜è®¤å†…å­˜ @agapple canalä¼šä¸åœçš„åˆ›å»ºçº¿ç¨‹ï¼Œæ•°é‡è¾¾åˆ°30000+æ—¶ï¼Œç³»ç»Ÿå°±æ²¡æ³•åˆ†é…å†…å­˜äº†ï¼Œcanalä¼šæŠ›å¼‚å¸¸java.lang.OutOfMemoryErrorï¼š unable to create new native threadï¼Œæœ€ç»ˆå¯¼è‡´æ•´ä¸ªç³»ç»Ÿä¸å¯ç”¨ï¼Œjvmå‚æ•°ä½¿ç”¨é»˜è®¤å€¼ï¼Œåˆ›å»ºçš„å¤§é‡çº¿ç¨‹å¦‚ä¸‹ï¼š MultiStageCoprocessor-other-example-0 .... MultiStageCoprocessor-other-example-8 MultiStageCoprocessor-Parse-example-0 .... MultiStageCoprocessor-Parse-example-8 æœ€æ–°çš„masterå·²ç»ä¿®å¤ https://github.com/alibaba/canal/pull/1002
912,[1.1.0]canalä¸springboot.2.0.4é›†æˆå¼‚å¸¸ï¼Œguava-18 ç‰ˆæœ¬å¤ªä½ï¼Œspringboot é›†æˆguava-20 ` java.lang.NoSuchMethodError: com.google.common.collect.MapMaker.makeComputingMap(Lcom/google/common/base/Function;)Ljava/util/concurrent/ConcurrentMap; 	at com.google.common.collect.MigrateMap.makeComputingMap(MigrateMap.java:17) ~[canal.common-1.1.0.jar:na] 	at com.alibaba.otter.canal.common.zookeeper.ZkClientx.<clinit>(ZkClientx.java:26) ~[canal.common-1.1.0.jar:na] 	at com.alibaba.otter.canal.client.kafka.KafkaCanalConnector.<init>(KafkaCanalConnector.java:52) ~[classes/:na] 	at com.alibaba.otter.canal.client.kafka.KafkaCanalConnectors.newKafkaConnector(KafkaCanalConnectors.java:47) ~[classes/:na] 	at com.louxun.search.service.SyncDataToESJob.syncHouseDataToES(SyncDataToESJob.java:41) ~[classes/:na] 	at com.louxun.search.listener.StartupListener.onApplicationEvent(StartupListener.java:18) ~[classes/:na] 	at com.louxun.search.listener.StartupListener.onApplicationEvent(StartupListener.java:10) ~[classes/:na] 	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:172) ~[spring-context-5.0.8.RELEASE.jar:5.0.8.RELEASE] 	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:165) ~[spring-context-5.0.8.RELEASE.jar:5.0.8.RELEASE] 	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:139) ~[spring-context-5.0.8.RELEASE.jar:5.0.8.RELEASE] 	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:400) ~[spring-context-5.0.8.RELEASE.jar:5.0.8.RELEASE] 	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:354) ~[spring-context-5.0.8.RELEASE.jar:5.0.8.RELEASE] 	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:888) ~[spring-context-5.0.8.RELEASE.jar:5.0.8.RELEASE] 	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.finishRefresh(ServletWebServerApplicationContext.java:161) ~[spring-boot-2.0.4.RELEASE.jar:2.0.4.RELEASE] 	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:553) ~[spring-context-5.0.8.RELEASE.jar:5.0.8.RELEASE] 	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:140) ~[spring-boot-2.0.4.RELEASE.jar:2.0.4.RELEASE] 	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:762) [spring-boot-2.0.4.RELEASE.jar:2.0.4.RELEASE] 	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:398) [spring-boot-2.0.4.RELEASE.jar:2.0.4.RELEASE] 	at org.springframework.boot.SpringApplication.run(SpringApplication.java:330) [spring-boot-2.0.4.RELEASE.jar:2.0.4.RELEASE] 	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1258) [spring-boot-2.0.4.RELEASE.jar:2.0.4.RELEASE] 	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1246) [spring-boot-2.0.4.RELEASE.jar:2.0.4.RELEASE] 	at com.louxun.search.SearchApplication.main(SearchApplication.java:10) [classes/:na] ` <exclusion>è²Œä¼¼å¯ä»¥è§£å†³æŠŠï¼Ÿ æˆ‘æ˜¯ä¿®æ”¹äº†åŸä»£ç è§£å†³çš„ ` package com.alibaba.otter.canal.common.zookeeper; import java.util.Map; import com.google.common.cache.CacheBuilder; import com.google.common.cache.CacheLoader; import com.google.common.cache.LoadingCache; import org.I0Itec.zkclient.IZkConnection; import org.I0Itec.zkclient.ZkClient; import org.I0Itec.zkclient.exception.ZkException; import org.I0Itec.zkclient.exception.ZkInterruptedException; import org.I0Itec.zkclient.exception.ZkNoNodeException; import org.I0Itec.zkclient.exception.ZkNodeExistsException; import org.I0Itec.zkclient.serialize.ZkSerializer; import org.apache.zookeeper.CreateMode; import com.google.common.base.Function; import com.google.common.collect.MigrateMap; /**  * ä½¿ç”¨è‡ªå®šä¹‰çš„ZooKeeperx for zk connection  *  * @author jianghang 2012-7-10 ä¸‹åˆ02:31:15  * @version 1.0.0  */ public class ZkClientx extends ZkClient {     /* BUG  å¯¹äºzkclientè¿›è¡Œä¸€æ¬¡ç¼“å­˜ï¼Œé¿å…ä¸€ä¸ªjvmå†…éƒ¨ä½¿ç”¨å¤šä¸ªzk connection     private static Map<String  ZkClientx> clients = MigrateMap.makeComputingMap(new Function<String  ZkClientx>() {         public ZkClientx apply(String servers) {             return new ZkClientx(servers);         }     });     */     //ä½¿ç”¨ guava æ–°çš„æ–¹å¼ æ›¿ä»£ä»¥å‰æ—§çš„ï¼ˆæ—§çš„ä¸springboot2.0é›†æˆæœ‰é—®é¢˜ï¼‰     private static LoadingCache<String  ZkClientx> clients = CacheBuilder.newBuilder().build(             new CacheLoader<String  ZkClientx>() {                 public ZkClientx load(String servers) {                     return new ZkClientx(servers);                 }             });    // å…¶ä»–åŸä»£ç çœç•¥ï¼Œæœªåšä¿®æ”¹ } ` æˆ‘è¯´çš„æ˜¯ä½ åœ¨pomé‡Œé¢ éƒ½ä½¿ç”¨åˆ°guavaçš„åœ°æ–¹ å…¶ä¸­ä¸€ä¸ªæ—§ä¾èµ–çš„åœ°æ–¹åŠ ä¸Šexclusionæ ‡ç­¾ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½è§£å†³ ä¸è¡Œå•Šï¼Œcanalä¾èµ–çš„æ˜¯æ—§ç‰ˆæœ¬guava-18çš„ï¼Œç”¨ä¸Šæ–°guava-20çš„è¯å…¶ä¸­ä¸€ä¸ªç±»é‡Œè¿‡æ—¶çš„æ–¹æ³•å·²ç»è¢«ç§»é™¤äº†ï¼Œæƒ³ç»Ÿä¸€ç”¨æ–°ç‰ˆæœ¬è¡Œä¸é€šå•Šï¼Œæ‰€ä»¥æˆ‘ç°åœ¨ä¿®æ”¹äº†canalé‡Œé¢æºç ï¼Œå°†è¿‡æœŸçš„guavaæ–¹æ³•æ›¿æ¢æˆæ–°çš„æ–¹å¼ canalä½¿ç”¨springç‰ˆæœ¬ä¸º3.2.6ï¼Œè€Œspring-boot2.0.4ä¾èµ–springç‰ˆæœ¬ä¸º5.x  åœ¨ç‰ˆæœ¬ä¸Šå·®å¼‚æ¯”è¾ƒå¤§ï¼Œè°¨æ…ä½¿ç”¨ æœ‰æ›¿æ¢æˆåŠŸçš„ï¼Œå¯ä»¥æäº¤ä¸€ä¸ªPRç»™æˆ‘ @panjianping å…„å¼Ÿä½ åæ¥ç”¨çš„æ˜¯å“ªä¸ªç‰ˆæœ¬çš„canal å’Œå“ªä¸ªç‰ˆæœ¬çš„springboot @gezhiwei8899 å°±ç”¨äº†canal-1.1.0 å’Œ springboot-2.0.4 çš„ï¼Œä¿®æ”¹äº†canal çš„æºç  ZkClientx.java æˆ‘è¿˜å¼•å…¥äº†dubboæ ¹æœ¬èµ·ä¸æ¥äº† @panjianping  @panjianping èƒ½ä¸èƒ½é‡æ–°canalçš„ä¸€ä¸ªæ–¹æ³• é¿å…ä¿®æ”¹æºç å˜› @gezhiwei8899 ç°åœ¨ä¸»è¦æ˜¯é—®é¢˜æ˜¯ï¼Œé«˜ç‰ˆæœ¬çš„spring-bootä½¿ç”¨çš„æ˜¯guava-20ï¼Œè€Œå½“å‰canalä¸­çš„ZkClientx.javaä¾èµ–æguava-18ä¸­çš„æ–¹æ³•ï¼Œä½†è¿™ä¸ªæ–¹æ³•åœ¨guava-20ä¸­å·²ç»è¢«ç§»é™¤äº†ï¼Œæ‰€ä»¥ä¸æƒ³ä¿®æ”¹åŸç çš„è¯ï¼Œéœ€è¦ä½¿ç”¨spring-3.xçš„ç‰ˆæœ¬ã€‚æˆ‘å¤§æ¦‚æƒ³åˆ°çš„è§£å†³æ–¹æ³•å°±è¿™ä¸ªäº† ç›´æ¥åœ¨ä½ çš„pomé‡Œé¢æ˜¾ç¤ºä¾èµ–guava-18ä¸å°±å¯ä»¥äº†ä¹ˆï¼Ÿ æˆ‘å°±æ˜¯è¿™ä¹ˆè§£å†³çš„         <dependency>             <groupId>com.google.guava</groupId>             <artifactId>guava</artifactId>             <version>18.0</version>         </dependency>
911,æœ€æ–°canal.kafka-1.1.0.taréƒ¨ç½²æ— æ³•å¯åŠ¨ï¼Œè°ƒè¯•æºç ä¹Ÿæ˜¯åŒæ ·çš„å¼‚å¸¸ï¼Œæ±‚å…³æ³¨ 2018-09-04 16:10:09.223 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [canal.properties] 2018-09-04 16:10:09.226 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [example/instance.properties] 2018-09-04 16:10:09.400 [main] WARN  o.s.beans.GenericTypeAwarePropertyDescriptor - Invalid JavaBean property 'connectionCharset' being accessed! Ambiguous write methods found next to actually use d [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.lang.String)]: [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlE ventParser.setConnectionCharset(java.nio.charset.Charset)] 2018-09-04 16:10:09.435 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [canal.properties] 2018-09-04 16:10:09.435 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [example/instance.properties] 2018-09-04 16:10:09.667 [main] ERROR com.alibaba.druid.pool.DruidDataSource - testWhileIdle is true  validationQuery not set 2018-09-04 16:10:09.891 [main] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start CannalInstance for 1-example 2018-09-04 16:10:09.905 [main] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - start successful.... 2018-09-04 16:10:09.948 [destination = example   address = /192.168.200.30:3306   EventParser] WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - prepare to find start position just las t position  {"identity":{"slaveId":-1 "sourceAddress":{"address":"mySlave" "port":3306}} "postion":{"gtid":"" "included":false "journalName":"mysql-bin.000029" "position":132895982 "serverId":2 "timestamp":1 536044055000}} 2018-09-04 16:10:09.993 [Thread-7] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - stop CannalInstance for null-example 2018-09-04 16:10:09.996 [destination = example   address = /192.168.200.30:3306   EventParser] ERROR c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - parse events has an error com.alibaba.otter.canal.parse.exception.CanalParseException: dump address /192.168.200.30:3306 has an error  retrying. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: should execute connector.connect() first Caused by: java.io.IOException: should execute connector.connect() first         at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.<init>(MysqlQueryExecutor.java:30) ~[canal.parse.driver-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.queryMulti(MysqlConnection.java:106) ~[canal.parse-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:175) ~[canal.parse-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:129) ~[canal.parse-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:91) ~[canal.parse-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:188) ~[canal.parse-1.1.0.jar:na]         at java.lang.Thread.run(Thread.java:748) ~[na:1.8.0_171] 2018-09-04 16:10:09.997 [Thread-7] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - stop successful.... åœ¨æˆ‘ä»¬ç¯å¢ƒé‡Œæ— æ³•é‡è¯•ï¼Œä½ å°è¯•debugçœ‹ä¸€ä¸‹MysqlConnectionä»€ä¹ˆæ¡ä»¶ä¸‹è¢«disconnect
910,canalå¦‚ä½•æŠŠmysqlçš„æŸäº›æ•°æ®å¯¼å…¥åˆ°redisçš„é›†ç¾¤ï¼Ÿ ç›®å‰å·²ç»æœ‰redisé›†ç¾¤6å° canalå®¢æˆ·ç«¯ä¸€å° åœ¨æ•°æ®ä¸æ›´æ–°çš„æƒ…å†µä¸‹ å¦‚ä½•èƒ½æŠŠmysqlä¸­ç°æœ‰çš„æŸäº›è¡¨çš„æ•°æ®å¯¼å…¥åˆ°redisçš„é›†ç¾¤ä¸­å‘¢? è°¢è°¢ "åœ¨æ•°æ®ä¸æ›´æ–°çš„æƒ…å†µä¸‹â€œ  è¿™ä¸ªå‰æä¸ç¬¦åˆcanalçš„å·¥ä½œåŸç†ï¼Œå¯èƒ½æ— æ³•æ»¡è¶³ä½ çš„éœ€æ±‚ã€‚å¯ä»¥çœ‹çœ‹yugongæˆ–è€…dataXæ˜¯ä¸æ˜¯å¯ä»¥æ»¡è¶³? æ˜ç™½äº†ã€‚è°¢è°¢
909,[v1.1.0]canalå¦‚ä½•åœ¨Zookeeperä¸­å¤„ç†äº‘æœåŠ¡å™¨IPé—®é¢˜ï¼ˆå¤§å°ç½‘IPé—®é¢˜ï¼‰ï¼Ÿ canalåœ¨Zookeeperä¸­æ³¨å†Œäº‘æœåŠ¡å™¨çš„å†…ç½‘IPï¼Œå¦‚192.168.4.xï¼Œè€Œå¯¹åº”å¤§ç½‘æœåŠ¡å™¨åœ°å€æ˜¯å…¶ä»–IPï¼Œå¦‚10.100.x.x è¿™æ ·å¯¼è‡´canalä»¥åŠZookeeperã€clientå¿…é¡»éƒ¨ç½²åˆ°åŒä¸€äº‘æœåŠ¡å™¨å°ç½‘æ®µä¸­ï¼Œæ— æ³•ä½¿ç”¨å¤§ç½‘æ®µè¿›è¡Œè®¿é—® @agapple  è¿™ç§ç‰¹æ®Šç½‘ç»œæ²¡åœ¨è®¾è®¡è€ƒè™‘çš„èŒƒç•´ @agapple èƒ½å¦è®¡åˆ’æ”¯æŒï¼ŒZuulä¹Ÿæœ‰ç±»ä¼¼æƒ…å†µè¿›è¡Œç½‘ç»œæ®µä½è¿‡æ»¤æœºåˆ¶ æ¯ä¸ªcanal serverè‡ªå·±äººè‚‰è®¾ç½®å¯¹åº”çš„ip? ä½ å¯ä»¥è€ƒè™‘æäº¤ä¸€ä¸ªprç»™æˆ‘
908,meta.batçš„é—®é¢˜ ä¸ºä»€ä¹ˆæˆ‘å¯åŠ¨æœåŠ¡ä¸æ˜¯ç”Ÿæˆçš„meta.batæ–‡ä»¶è€Œæ˜¯ç”Ÿæˆçš„h2.mv.dbæ–‡ä»¶ï¼Ÿæœ‰æ²¡æœ‰å¤§ç¥è§£é‡Šä¸€ä¸‹ï¼ h2.mv.dbæ–‡ä»¶é»˜è®¤ä¼šæœ‰ï¼Œcanal.instance.global.spring.xml = classpath:spring/default-instance.xmlæ˜¯å†™åˆ°zkä¸Šçš„ï¼Œcanal.instance.global.spring.xml = classpath:spring/file-instance.xmlè¿™ä¸ªæ‰æ˜¯å†™æœ¬åœ°çš„meta.bat LSæ­£è§£
907,exampleé‡Œé¢çš„æŠ¥é”™ 2018-09-04 11:39:04.244 [WrapperSimpleAppMain] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [canal.properties] 2018-09-04 11:39:04.244 [WrapperSimpleAppMain] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [example/instance.properties] 2018-09-04 11:39:04.400 [WrapperSimpleAppMain] WARN  o.s.beans.GenericTypeAwarePropertyDescriptor - Invalid JavaBean property 'connectionCharset' being accessed! Ambiguous write methods found next to actually used [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.nio.charset.Charset)]: [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.lang.String)] 2018-09-04 11:39:04.400 [WrapperSimpleAppMain] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start CannalInstance for 1-example  2018-09-04 11:39:04.416 [WrapperSimpleAppMain] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - start successful.... 2018-09-04 11:39:04.416 [canal-instance-scan-0] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - stop CannalInstance for null-example  2018-09-04 11:39:04.432 [destination = example   address = /127.0.0.1:3308   EventParser] ERROR c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - parse events has an error com.alibaba.otter.canal.parse.exception.CanalParseException: dump address /127.0.0.1:3308 has an error  retrying.  Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: java.net.SocketException: Socket Closed Caused by: java.net.SocketException: Socket Closed 	at java.net.SocketInputStream.socketRead0(Native Method) ~[na:1.8.0_77] 	at java.net.SocketInputStream.socketRead(SocketInputStream.java:116) ~[na:1.8.0_77] 	at java.net.SocketInputStream.read(SocketInputStream.java:170) ~[na:1.8.0_77] 	at java.net.SocketInputStream.read(SocketInputStream.java:141) ~[na:1.8.0_77] 	at java.io.BufferedInputStream.fill(BufferedInputStream.java:246) ~[na:1.8.0_77] 	at java.io.BufferedInputStream.read1(BufferedInputStream.java:286) ~[na:1.8.0_77] 	at java.io.BufferedInputStream.read(BufferedInputStream.java:345) ~[na:1.8.0_77] 	at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannel.read(BioSocketChannel.java:52) ~[canal.parse.driver-1.1.0.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.readHeader(PacketManager.java:12) ~[canal.parse.driver-1.1.0.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.readNextPacket(MysqlQueryExecutor.java:159) ~[canal.parse.driver-1.1.0.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.query(MysqlQueryExecutor.java:56) ~[canal.parse.driver-1.1.0.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:102) ~[canal.parse-1.1.0.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.loadBinlogFormat(MysqlConnection.java:433) ~[canal.parse-1.1.0.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.getBinlogFormat(MysqlConnection.java:582) ~[canal.parse-1.1.0.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:95) ~[canal.parse-1.1.0.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:173) ~[canal.parse-1.1.0.jar:na] 	at java.lang.Thread.run(Thread.java:745) ~[na:1.8.0_77] 2018-09-04 11:39:04.432 [canal-instance-scan-0] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - stop successful.... Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: java.net.SocketException: Socket Closed Caused by: java.net.SocketException: Socket Closed æ„Ÿè§‰æ˜¯ä¸»åŠ¨å…³é—­
906,1.1.0ç‰ˆæœ¬å¯åŠ¨å¼‚å¸¸ æ— æ³•æ£€æµ‹åˆ°æ•°æ®åº“å˜åŠ¨ [destination = example   address = /10.19.1.80:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: EOF encountered. Caused by: java.io.IOException: EOF encountered. 	at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannel.read(BioSocketChannel.java:56) 	at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.readHeader(PacketManager.java:12) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.readNextPacket(MysqlQueryExecutor.java:159) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.query(MysqlQueryExecutor.java:56) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:102) 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:148) 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:129) 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:91) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:188) 	at java.lang.Thread.run(Thread.java:748) ] Caused by: java.io.IOException: EOF encountered.  æ£€æŸ¥ä¸€ä¸‹æ•°æ®åº“
905,æ˜¯å¦æ”¯æŒå¤šè®¢é˜…è€…æ¨¡å¼ï¼Ÿ è¯·é—®canalæ˜¯å¦æ”¯æŒå¤šè®¢é˜…è€…æ¨¡å¼ï¼Œä¸ºæ¯ä¸ªè®¢é˜…è€…ç»´æŒä¸åŒçš„mark å’Œ ack? ä¸æ”¯æŒï¼Œéœ€è¦å¤šè®¢é˜…è€…å¯ä»¥å°†æ•°æ®å†™å…¥åˆ°MQ
904,1.1.0 ç‰ˆæœ¬canal server å¯åŠ¨å8ä¸ªdestination cpuä¸€ç›´800%ï¼Œæ­»å¾ªç¯new Eventså¯¹è±¡ 1.1.0 ç‰ˆæœ¬canal server å¯åŠ¨åcpuä¸€ç›´100%ç”šè‡³160%ï¼Œè¿™ä¸ªå±äºè¿™ä¸ªç‰ˆæœ¬å­˜åœ¨çš„é—®é¢˜è¿˜æ˜¯ä½¿ç”¨å§¿åŠ¿é—®é¢˜ï¼Ÿ é…ç½®æ–¹é¢ç”¨çš„canal.instance.global.spring.xml = classpath:spring/default-instance.xml ï¼Œä½¿ç”¨kafkaé›†æˆçš„æ–¹å¼ ä¸ç®¡æœ‰æ²¡æœ‰binlogä¸‹æ¥ï¼Œcanal server è¿›ç¨‹çš„cpuæ¶ˆè€—åŸºæœ¬ä¸Šä¸€ç›´100%çš„æ ·å­ top -Hp pidçœ‹çœ‹å“ªä¸ªçº¿ç¨‹å cpué«˜ï¼Œç„¶åç”¨jstackçœ‹çœ‹æ˜¯å“ªä¸ªç±»å’Œæ–¹æ³•å¼•èµ·çš„ ç°åœ¨éƒ¨ç½²åˆ°å‹æµ‹ç¯å¢ƒäº†ï¼Œæ²¡æœ‰ä»»ä½•binlogä¸‹è½½çš„æƒ…å†µä¸‹ï¼Œéƒ¨ç½²äº†4å°äº‘æœºï¼Œ8æ ¸å¿ƒçš„æœºå™¨ï¼Œ8ä¸ªdestinationï¼Œcpu800%ï¼Œæ±‚å¤§ä½¬è§£å†³å•Š "pool-12-thread-1" #29 prio=5 os_prio=0 tid=0x00007fdee4afa000 nid=0x2394 runnable [0x00007fde6cce4000]    java.lang.Thread.State: RUNNABLE 	at com.alibaba.otter.canal.store.model.Events.<init>(Events.java:23) 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.doGet(MemoryEventStoreWithBuffer.java:280) 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.tryGet(MemoryEventStoreWithBuffer.java:261) 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getEvents(CanalServerWithEmbedded.java:478) 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:310) 	- locked <0x0000000740492388> (a com.alibaba.otter.canal.instance.spring.CanalInstanceWithSpring) 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:273) 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter.worker(CanalKafkaStarter.java:121) 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter.access$000(CanalKafkaStarter.java:26) 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter$1.run(CanalKafkaStarter.java:70) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) 	at java.lang.Thread.run(Thread.java:745) ä»çº¿ç¨‹dumpæ¥çœ‹å°±æ˜¯è¿›å…¥æ­»å¾ªç¯new  Eventså¯¹è±¡äº† ä»jstatæ¥çœ‹ 500M edenåŒºï¼Œå¯åŠ¨15åˆ†é’Ÿ YGC 500æ¬¡äº† æ˜¨æ™šåç‚¹å¯åŠ¨åˆ°ç°åœ¨çš„YGC64000æ¬¡ï¼ŒFGCåªæœ‰å¯åŠ¨åˆå§‹åŒ–å› ä¸ºSTWçš„2æ¬¡è®°å½•ï¼Œä¹Ÿå°±æ˜¯è¿è¡Œä¸­æ²¡æœ‰YGC # binlog filter config canal.instance.filter.druid.ddl = true canal.instance.filter.query.dcl = true canal.instance.filter.query.dml = true canal.instance.filter.query.ddl = true canal.instance.filter.table.error = true canal.instance.filter.rows = false canal.instance.filter.transaction.entry = false canal.instance.global.spring.xml = classpath:spring/default-instance.xml æ­£å¸¸æœ‰binlogæ‹‰å–æ—¶å€™çš„çº¿ç¨‹æ ˆä¿¡æ¯å¦‚ä¸‹ï¼š # "pool-11-thread-3" #73 prio=5 os_prio=0 tid=0x00007f7ae8d88800 nid=0x3e5e runnable [0x00007f7a70927000]    java.lang.Thread.State: RUNNABLE 	at com.alibaba.otter.canal.store.helper.CanalEventUtils.createPosition(CanalEventUtils.java:76) 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.getFirstPosition(MemoryEventStoreWithBuffer.java:375) 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.getFirstPosition(MemoryEventStoreWithBuffer.java:36) 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:307) 	- locked <0x00000007406361f0> (a com.alibaba.otter.canal.instance.spring.CanalInstanceWithSpring) 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:273) 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter.worker(CanalKafkaStarter.java:121) 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter.access$000(CanalKafkaStarter.java:26) 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter$1.run(CanalKafkaStarter.java:70) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) 	at java.lang.Thread.run(Thread.java:745) # "pool-11-thread-2" #72 prio=5 os_prio=0 tid=0x00007f7ae8d86800 nid=0x3e5d runnable [0x00007f7a70968000]    java.lang.Thread.State: RUNNABLE 	at com.google.common.collect.MapMakerInternalMap$Segment.getEntry(MapMakerInternalMap.java:2402) 	at com.google.common.collect.ComputingConcurrentHashMap$ComputingSegment.getOrCompute(ComputingConcurrentHashMap.java:81) 	at com.google.common.collect.ComputingConcurrentHashMap.getOrCompute(ComputingConcurrentHashMap.java:67) 	at com.google.common.collect.MapMaker$ComputingMapAdapter.get(MapMaker.java:885) 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:296) 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:273) 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter.worker(CanalKafkaStarter.java:121) 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter.access$000(CanalKafkaStarter.java:26) 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter$1.run(CanalKafkaStarter.java:70) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) 	at java.lang.Thread.run(Thread.java:745) # "pool-11-thread-1" #71 prio=5 os_prio=0 tid=0x00007f7ae8d85800 nid=0x3e5c runnable [0x00007f7a709a9000]    java.lang.Thread.State: RUNNABLE 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:317) 	- locked <0x000000074004a4d0> (a com.alibaba.otter.canal.instance.spring.CanalInstanceWithSpring) 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:273) 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter.worker(CanalKafkaStarter.java:121) 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter.access$000(CanalKafkaStarter.java:26) 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter$1.run(CanalKafkaStarter.java:70) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) 	at java.lang.Thread.run(Thread.java:745) @rewerma å¤§ä½¬è¿™ä¸ªé—®é¢˜å¸®å¿™çœ‹çœ‹å•Š  CanalKafkaStarter.workerä¼°è®¡æœªè®¾ç½®sleepæ—¶é—´ é’ˆå¯¹ç©ºç»“æœæ—¶ç›¸å½“äºæ— é™å¾ªç¯åœ¨è·‘äº†  å¯ä»¥ä¼˜åŒ–ä¸€ä¸‹ ä¿®æ”¹æäº¤äº†ï¼Œä¸è¿‡æœ‰ç‚¹å¥‡æ€ªï¼Œæˆ‘è¿™è¾¹ä¸è®¾sleepä¸€ç›´æ— çº¿å¾ªç¯å–æ•°æ®æ²¡é—®é¢˜çš„ï¼ŒCPUæ­£å¸¸ã€‚æˆ‘è¿™è¾¹ç”¨çš„æ˜¯1.8çš„jdkï¼ŒG1çš„æ”¶é›†å™¨
903,Could not find first log file name in binary log index file é”™è¯¯ä¿¡æ¯ï¼š 2018-09-03 17:06:05.707 [main] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start CannalInstance for 1-example 2018-09-03 17:06:05.709 [main] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - start successful.... 2018-09-03 17:06:05.781 [destination = example   address = xxxxx:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position  {"identity":{"slaveId":-1 "sourceAddress":{"address":"xxxx" "port":3306}} "postion":{"included":false "journalName":"mysql-bin.002736" "position":30948432 "serverId":2118896143 "timestamp":1535632015000}} 2018-09-03 17:06:05.886 [destination = example   address = xxxx:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:122) [canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) [canal.parse-1.0.24.jar:na]         at java.lang.Thread.run(Thread.java:748) [na:1.7.0_141] 2018-09-03 17:06:05.887 [destination = example   address = xxxx:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address xxxxx:3306 has an error  retrying. caused by java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:122) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) ~[canal.parse-1.0.24.jar:na]         at java.lang.Thread.run(Thread.java:748) [na:1.7.0_141] 2018-09-03 17:06:05.893 [destination = example   address = xxxx:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:122)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209)         at java.lang.Thread.run(Thread.java:748) ] é—®é¢˜åº”è¯¥æ˜¯meta.datä¸­çš„binlogæ–‡ä»¶è·Ÿä¸ä¸Šshow master STATUSä¸­çš„æ—¥å¿—æ–‡ä»¶ã€‚ meta.datä¸­çš„æ–‡ä»¶æ˜¯mysql-bin.002736: {"clientDatas":[{"clientIdentity":{"clientId":1001 "destination":"example" "filter":""} "cursor":{"identity":{"slaveId":-1 "sourceAddress":{"address":"":"xxxx" "p" "port":3306}} "postion":{"included":false "journalName":"mysql-bin.002736" "position":30948432 "serverId":2118896143 "timestamp":1535632015000}}}] "destination":"example"} show master STATUSæœ€æ–°çš„æ–‡ä»¶; mysql-bin.002752	24891270	 ä¹‹å‰çš„åšæ³•æ˜¯ç›´æ¥åˆ é™¤meta.datæ–‡ä»¶ï¼Œé‡æ–°å¼€å§‹åŒæ­¥ï¼Œä½†æ˜¯ä¼šä¸¢å¤±æ•°æ®ã€‚è¿è¡Œä¸€æ®µæ—¶é—´ååˆä¼šå‡ºç°è¯¥é—®é¢˜ã€‚è¯·é—®å¤§ä½¬ä»¬æ€ä¹ˆè§£å†³ã€‚ mysql masterä¼šåŸºäºä¸€å®šçš„ç­–ç•¥å»sweep binlog(æ ¹æ®sizeæˆ–æ—¶é—´)ï¼Œå¦‚æœæ¶ˆè´¹çš„æ…¢ï¼Œmeta.daté‡Œçš„logå°±è¢«æ¸…ç†äº†ã€‚ è¿™ç§æƒ…å†µè€ƒè™‘ä¸‹æå‡æ•´ä½“ååé‡å§ã€‚ 2018-09-04 09:35:33.645 [destination = example   address = xxx:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: column size is not match for table:`skstandard`.`tbl_20180824090548lyqbbcqqjdt68u5m` 103 vs 15 åº”è¯¥æ˜¯ç”±äºè¡¨ç»“æ„æ”¹å˜å¯¼è‡´æœåŠ¡ä¸€ç›´å¡åœ¨è¿™é‡Œï¼Œè¯·é—®æœ‰ä»€ä¹ˆå¥½çš„æ–¹æ³•å¯ä»¥è·³è¿‡å»å—ï¼Œé’ˆå¯¹è¿™ç§è¡¨ç»“æ„æ”¹å˜çš„æƒ…å†µæ€ä¹ˆå¤„ç†çš„å‘¢ï¼Ÿæˆ‘ç°åœ¨æ˜¯æ‰‹åŠ¨ä¿®æ”¹meta.datä¸­çš„positionè·³è¿‡çš„ã€‚ å‡çº§æ–°ç‰ˆæœ¬å§ https://github.com/alibaba/canal/wiki/TableMetaTSDB å¤§ä½¬ï¼Œä½ è¿™ä¸ªcolumn size is not match for tableé—®é¢˜æ˜¯æ€ä¹ˆè§£å†³çš„ æœ›èµæ•™ï¼ æœ¬åœ°ä½¿ç”¨çš„æ˜¯1.1.0ç‰ˆæœ¬ï¼Œä½†æ˜¯è¿˜ä¼šå‡ºç°column size is not match for tableï¼Œæœ›å¤§ä½¬èµæ•™è§£å†³åŠæ³•
902,fix bug #890: å¹¶è¡Œè§£æ + Gtid .æ²¡æœ‰åˆå§‹åŒ–LogContextä¸­çš„gtidSet tks
901,ä½¿ç”¨kafkaå®¢æˆ·ç«¯æ¶ˆè´¹binlogå‡ºç°ä¹±ç  *B> 0mysql-bin.000102ï¿½0 ï¿½*UTF-80è¸¬ï¿½ï¿½ 8B æˆ‘ä¹Ÿé‡åˆ°äº†ç›¸åŒçš„é—®é¢˜ã€‚ kafkaå‘é€çš„æ˜¯messageæ•°æ®åŒ…ä¸æ˜¯å¯è§å­—ç¬¦ä¸²ï¼Œå®¢æˆ·ç«¯æ¥æ”¶åˆ°åéœ€è¦ååºåˆ—åŒ–è§£åŒ…ï¼Œå‚è€ƒclient.kafka
900,kafka serverç«¯ä»£ç è°ƒæ•´ 
899,æ•°æ®æ¶ˆè´¹ä¸€æ®µåï¼Œcanal-clientæ— æ³•æ‹‰å–æ–°çš„æ•°æ®ï¼Œç¡®å®šdbæ˜¯åœ¨ä¸æ–­æ›´æ–°çš„ã€‚ ![image](https://user-images.githubusercontent.com/5965173/44947782-0e424280-ae45-11e8-973a-b2c102d7d704.png) ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ã€‚1.10 æ£€æŸ¥ä¸€ä¸‹serverç«¯æ˜¯å¦æœ‰æŠ¥é”™ ![image](https://user-images.githubusercontent.com/5965173/45035342-57d09e80-b08c-11e8-9bf8-bba18de5ae43.png) serverç«¯ï¼Œå‡ºç°ä¸€ä¸ªå¼‚å¸¸åï¼Œçœ‹åˆ°clientè‡ªåŠ¨é‡æ–°subscribeçš„ä¿¡æ¯ã€‚ç„¶åclient å°±è¯»ä¸åˆ°æ•°æ®äº†ã€‚ åˆä¸€æ¬¡ï¼Œå‡ºç°å¼‚å¸¸åï¼Œæ¶ˆè´¹åœæ­¢äº†ã€‚ ![image](https://user-images.githubusercontent.com/5965173/45036036-fad5e800-b08d-11e8-8b33-a956e293438d.png) mysqlç‰ˆæœ¬ 5.6.28 getWithoutAck ä½¿ç”¨æ— éœ€ç¡®è®¤çš„æ¨¡å¼ï¼Œå‡ºç°ä¸Šé¢é—®é¢˜ã€‚ ä½¿ç”¨get Ackçš„æ¨¡å¼å°±æ²¡æœ‰é—®é¢˜äº†ã€‚ å…ˆè€ƒè™‘å‡çº§ä¸€ä¸‹canalç‰ˆæœ¬
898,canal.kafkaè¾“å‡ºä¹±ç  CentOS Linux release 7.3.1611 (Core)  3.10.0-514.el7.x86_64 JDKï¼šjdk-8u161-linux-x64.tar.gz zookeeperï¼šzookeeper-3.4.13.tar.gz kafkaï¼škafka_2.11-2.0.0.tgz canal.kafkaï¼šcanal.kafka-1.1.0.tar.gz MySQLï¼š5.7.22-log æŒ‰ç…§https://github.com/alibaba/canal/wiki/Canal-Kafka-QuickStarté…ç½® kafkaä¸­å…¨æ˜¯ä¹±ç  è¯·é—®éœ€è¦åœ¨é‚£é‡Œè°ƒæ•´  bin/kafka-console-consumer.sh --bootstrap-server 192.168.10.110:9092 --topic example *D mysql-binlog.000012*UTF-80BJP401663 *? mysql-binlog.000012*UTF-80BJPH  mysql-binlog.000012*UTF-80BtestJtP+Xb         _-+_C-+++1Pb? id (0B1Ri++(11)    +e_+ (0B1R                +a_cha_(255)D +y_-+-bi++-g.000012 *UTF-80 8BJP401877 *? +y_-+-bi++-g.000012 *UTF-80 8BJPI > +y_-+-bi++-g.000012 *UTF-80 8Beca_dJ+_c+a___ca_d__e-+e_+_+-gPTXb         _-+_C-+++1Pb  kafkaæ•°æ®æŠ•é€’ä¼ è¾“çš„æ˜¯æ•°æ®åŒ…å“¦ï¼Œæ”¶åˆ°æ•°æ®åè¿˜è¦è§£åŒ…æˆå¯¹åº”çš„messageï¼Œå¯å‚è€ƒclientä¸­çš„kafkaå®ç° æˆ‘çœ‹äº†kafka-clientä¸­çš„AbstractKafkaTest.javaï¼Œæ”¹äº†ç›¸åº”çš„é…ç½®å‚æ•°åï¼Œå½“å¾€mysqlä¸­æ’å…¥æ–°è®°å½•åï¼Œç”¨å‘½ä»¤`bin/kafka-console-consumer.sh --zookeeper 192.168.206.128:2181 --topic canal1 --from-beginning`å¯ä»¥çœ‹åˆ°æŠ•é€’è¿‡æ¥çš„æ•°æ®åŒ…ï¼Œæ˜¯ä¹±ç ï¼Œä½†è¿è¡ŒKafkaClientRunningTest.javaæ²¡æœ‰æ”¶åˆ°æ•°æ®åŒ…ã€‚
897,canal-1.1.0æºç ä¸­canal-kafkaå…¥å£å¯åŠ¨ä¸€ç›´æŠ¥å¼‚å¸¸ã€‚ 2018-08-31 09:05:51.141 [destination = example   address = /192.168.200.42:3306   EventParser] ERROR c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - dump address /192.168.200.42:3306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: java.net.SocketException: Socket closed Caused by: java.net.SocketException: Socket closed 	at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:116) ~[na:1.8.0_20] 	at java.net.SocketOutputStream.write(SocketOutputStream.java:141) ~[na:1.8.0_20] 	at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannel.write(BioSocketChannel.java:36) ~[classes/:na] 	at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.writeBody0(PacketManager.java:42) ~[classes/:na] 	at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.writeBody(PacketManager.java:35) ~[classes/:na] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.query(MysqlQueryExecutor.java:55) ~[classes/:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:102) ~[classes/:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.loadBinlogFormat(MysqlConnection.java:433) ~[classes/:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.getBinlogFormat(MysqlConnection.java:582) ~[classes/:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:95) ~[classes/:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:173) ~[classes/:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_20] 2018-08-31 09:05:51.146 [destination = example   address = /192.168.200.42:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: java.net.SocketException: Socket closed Caused by: java.net.SocketException: Socket closed 	at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:116) 	at java.net.SocketOutputStream.write(SocketOutputStream.java:141) 	at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannel.write(BioSocketChannel.java:36) 	at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.writeBody0(PacketManager.java:42) 	at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.writeBody(PacketManager.java:35) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.query(MysqlQueryExecutor.java:55) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:102) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.loadBinlogFormat(MysqlConnection.java:433) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.getBinlogFormat(MysqlConnection.java:582) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:95) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:173) 	at java.lang.Thread.run(Thread.java:745) ] mysqlè¿æ¥æ²¡æœ‰é—®é¢˜ï¼ŒåŒæ ·çš„mysqlé…ç½®ç”¨canalå…¥å£å¯åŠ¨æ²¡æœ‰é—®é¢˜ Socket closed Caused by: java.net.SocketException: Socket closed
896,ä¿®å¤execTimeå¿«äºcanalå½“å‰æ—¶é—´ï¼Œdelayæ— data points @wingerx ï¼Œä»ä»£ç æ¥çœ‹ï¼Œæ²¡æœ‰data pointsçš„æƒ…å†µï¼ŒåŸºæœ¬å°±æ˜¯mysql hostå’Œcanal server ntpä¸åŒæ­¥ï¼Œmysqlæ—¶é—´è¾ƒå¿«ã€‚ ç°åœ¨ä¿®æ”¹ä¸ºï¼šåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œdelayä¸º0ï¼›wikié‡Œä¹Ÿä¼šç€é‡ä¿®æ”¹è¯´æ˜ä¸€ä¸‹ã€‚ tks
895,canal åˆ°kafka æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ å¦‚æœæˆ‘è®¾ç½®å¤šä¸ªpartitionï¼Œcanalå¦‚ä½•ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œæœ‰åºæ€§ æ— è®ºkafkaè¿˜æ˜¯rocketmqéƒ½åªèƒ½æ˜¯å•åˆ†åŒºå…¨å±€æœ‰åºï¼Œæˆ–å•åˆ†åŒºæœ‰åºã€‚ å¦‚æœè¡¨ä¹‹é—´è¦æ²¡æœ‰å¼ºå…³è”ï¼Œæ˜¯å¯ä»¥å•ä¸ªè¡¨hashåˆ°åŒä¸€ä¸ªåˆ†åŒºä¿è¯å•è¡¨æœ‰åºçš„ å¥½åƒå¬è¯´canalçš„é¡¹ç›®ä½œè€…ï¼Œå¯èƒ½æ­£åœ¨å®ç°å¤šä¸ªåˆ†åŒºï¼Œä¸€ä¸ªè¡¨ï¼Œå¹¶ä¿è¯é¡ºåºã€‚ä¸çŸ¥é“æ˜¯å¦æ˜¯çœŸçš„ï¼ˆç†è®ºä¸Šï¼Œæˆ‘è§‰å¾—ï¼Œå¦‚æœæœ‰å¼ ç´¢å¼•è¡¨--æŒ‰æ—¶é—´æ’åºï¼Œå…ˆè¯»å–ç´¢å¼•è¡¨ï¼Œå†è¯»çœŸæ­£çš„æ•°æ®ï¼Œå°±å¯ä»¥å®ç°è¯»å–æ”¾åœ¨å¤šä¸ªåˆ†åŒºä¸Šçš„binglogæ•°æ®äº†ï¼‰ #958
894,fix #893 index name contains "on" keyword [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=894) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=894) before we can accept your contribution.<br/><hr/>**å¼ é‘«** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=894) it.</sub> [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=894) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=894) before we can accept your contribution.<br/><hr/>**å¼ é‘«** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=894) it.</sub> tks
893,åˆ›å»ºæˆ–è€…åˆ é™¤indexæ—¶ï¼Œå¦‚æœindexåç§°ä¸­åŒ…å«onå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆè§£ætableçš„åç§°ä¼šå‡ºç°é”™è¯¯ æ¯”å¦‚ï¼š CREATE INDEX `schema_new_index_version_s_idx` ON `tb_email_auth` (`status`) ç”±äºversionä¸­åŒ…å«onï¼Œæ­¤æ—¶è§£æå¤„ç†çš„tableåä¸º_s_idx ä¿®æ­£æ–¹æ³•ï¼š com.alibaba.otter.canal.parse.inbound.mysql.ddl.SimpleDdlParserä¸­çš„  public static final String CREATE_INDEX_PATTERN   = "^\\s*CREATE\\s*(UNIQUE)?(FULLTEXT)?(SPATIAL)?\\s*INDEX\\s*(.*?)\\s+ON\\s+(.*?)$";     public static final String DROP_INDEX_PATTERN     = "^\\s*DROP\\s*INDEX\\s*(.*?)\\s+ON\\s+(.*?)$"; ONå‰åçš„\så¿…é¡»å‡ºç°1æ¬¡åˆ°å¤šæ¬¡ï¼ˆæºç ä¸­æ˜¯* æ”¹ä¸º+ï¼‰ å…¶å®simpparseråº”è¯¥deprecateç§»é™¤æ‰äº†å§ï¼Œè¿™ä¸ªæ”¯æŒä¸äº†å…¶å®ƒå¤æ‚çš„åœºæ™¯
892,kafka client keep aliveé—´éš”æ—¶é—´ 
891,canal.deployer-1.1.0 cursoræŒä¹…åŒ–é¢‘ç‡é—®é¢˜ æµ‹è¯•1ï¼šclienté‡è¿æ—¶ï¼Œmeta.datçš„ä¿®æ”¹æ—¶é—´å‘ç”Ÿæ›´æ–°ï¼Œä½†æ•°æ®è¿˜æ˜¯æ²¡å˜ã€‚ æµ‹è¯•2ï¼šç”±äºæµ‹è¯•1çš„é—®é¢˜ï¼Œå¯¼è‡´positionæ²¡æœ‰æ›´æ–°ã€‚å¯¼è‡´å¦‚æœæ­¤æ—¶serveré‡å¯ï¼Œè¯»å–çš„è¿˜æ˜¯â€œæ—§â€çš„æŒä¹…åŒ–cursorï¼Œclientåœ¨â€œæ—§â€çš„positionæ¶ˆè´¹ã€‚ issue canalç‰ˆæœ¬ï¼š1.0.26 alpha5ï¼Œ1.1.0 1.0.26 alpha2ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼šæ¯æ¬¡clientæ¶ˆè´¹éƒ½æ›´æ–°curosr [#882](https://github.com/alibaba/canal/issues/882)
890,å¹¶è¡Œè§£æ + Gtid .æ²¡æœ‰åˆå§‹åŒ–LogContextä¸­çš„gtidSet æ²¡æœ‰åˆå§‹åŒ–LogContextä¸­çš„gtidSet     public final void putGtid(GtidLogEvent logEvent) {         if (logEvent != null) {             String gtid = logEvent.getSid().toString() + ":" + logEvent.getGno();             if (gtidSet == null) {                 gtid = logEvent.getSid().toString() + ":1-" + logEvent.getGno();                 gtidSet = MysqlGTIDSet.parse(gtid);             }             gtidSet.update(gtid);         }     } eventä¸­çš„å½“å‰serverçš„gtidä¼šè¦†ç›–æ‰zk cursorä¸­çš„å†å²gtidSetï¼ˆè‹¥å¹²ä¸ªserver:start-end ç»„åˆï¼‰ ä¸‹æ¬¡å†é‡å¯ï¼ŒdumpæŠ¥é”™ã€‚ æ˜¯åŸºäºå½“å‰çš„ä¸»å¹²ä»£ç ä¹ˆï¼Ÿ åŸºäº1.1.0 release è¿™ä¸ªcommit .  commit dd8b1ce9551b59b719516615e43193c467214ade (tag: canal-1.1.0) Author: ä¸ƒé”‹ <jianghang.loujh@alibaba-inc.com> Date:   Mon Aug 20 13:28:57 2018 +0800     [maven-release-plugin] prepare release canal-1.1.0 ç„¶åcherry-pick äº†å¹¶è¡Œè§£æçš„gtid çš„ä¸¤ä¸ªbug fix  commit 0ca9fa129975ccb4884d8ca9c02c63b066461e6a Author: winger <winger2049@gmail.com> Date:   Sat Aug 25 09:17:13 2018 +0800     fix bug: å¹¶è¡Œè§£ææ¨¡å¼ä¸‹ï¼Œå¼€å¯gtid ä¼šå¯¼è‡´è§£æé”™è¯¯ commit 186b58396862cbea82781458625608400fe3e5c5 Author: winger <winger2049@gmail.com> Date:   Sat Aug 25 03:54:38 2018 +0800     fix bug: å¹¶è¡Œè§£ææ¨¡å¼ä¸‹ï¼Œå¼€å¯gtid ä¼šå¯¼è‡´è§£æé”™è¯¯ å¦‚æœä¹‹å‰zkä¸Šå­˜å‚¨çš„positionæœ‰å¤šä¸ªgtidé›†åˆï¼Œå¹¶ä¸”æœ‰çš„å·²ç»è¢«mysql master purgedæ‰ã€‚ å¾ˆå®¹æ˜“å¤ç°å‡ºæ¥ã€‚
889,canal1.1.0å¯åŠ¨example.logæŠ¥é”™ 2018-08-27 17:22:51.560 [destination = example   address = /192.168.155.35:3306   EventParser] WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - prepare to find start position just show master status 2018-08-27 17:22:51.562 [destination = example   address = /192.168.155.35:3306   EventParser] ERROR c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - dump address /192.168.100.249:3306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: command : 'show master status' has an error! pls check. you need (at least one of) the SUPER REPLICATION CLIENT privilege(s) for this operation 2018-08-27 17:22:51.562 [destination = example   address = /192.168.155.35:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: command : 'show master status' has an error! pls check. you need (at least one of) the SUPER REPLICATION CLIENT privilege(s) for this operation ] æƒé™é—®é¢˜ ä»¥è§£å†³ï¼Œæ„Ÿè°¢å¤§ä½¬ï¼ å‘è‡ªç½‘æ˜“é‚®ç®±å¤§å¸ˆ åœ¨2018å¹´8æœˆ28æ—¥ 17:47ï¼Œagapple<notifications@github.com> å†™é“ï¼š Closed #889. â€” You are receiving this because you authored the thread. Reply to this email directly  view it on GitHub  or mute the thread. å¤§ä½¬ canalä¿®æ”¹è¡¨ç»“æ„åï¼Œå‡ºç°ä¸€ä¸ªå¼‚å¸¸ï¼šcolumn size is not match table xx  å°†ddlæ‰“å¼€è¿˜æ˜¯ä¸è¡Œ éº»çƒ¦å¤§ä½¬ç»™äºˆèµæ•™ï¼ çœ‹ä¸€ä¸‹æ–‡æ¡£TableMetaTSDB
888,connector.subscribe("xxx") ä¸èµ·ä½œç”¨ canal.instance.filter.regex=fid_standard_product\\..*  æˆ‘åœ¨serverç«¯å®šä¹‰ç›‘æµ‹è¿™ä¸€æ•´ä¸ªåº“ï¼Œåœ¨ä¸€ä¸ªå®¢æˆ·ç«¯connector.subscribe("fid_standard_product.fid_stock_report") å…¶ä¸­æŸä¸ªè¡¨ï¼Œä½†æ˜¯è¿™ä¸ªåº“é‡Œçš„å…¶ä»–è¡¨è¿˜æ˜¯ä¼šåŒæ­¥è¿‡æ¥ï¼Œè¿™ä¸ªconnector.subscribeä¸ºä»€ä¹ˆæ²¡èµ·åˆ°è¿‡æ»¤çš„ä½œç”¨å‘¢ å¤šçœ‹FAQ
887,canal è¿è¡Œå‘ç”Ÿacké”™è¯¯ canalè¿è¡Œå‘ç”Ÿacké”™è¯¯ï¼š ack error   clientId:1001 batchId:261365 is not exist   please checkã€‚ è¿™ä¸ªåº”è¯¥æ˜¯æœåŠ¡å™¨ç«¯instanceé‡å¯å¯¼è‡´ã€‚ç°åœ¨æœåŠ¡å™¨ç«¯çš„é…ç½®ä¸ºï¼š canal.instance.get.ddl.isolation = false ################################################# #########               destinations            ############# ################################################# canal.destinations= db9002 # conf root dir canal.conf.dir = ../conf # auto scan instance dir add/remove and start/stop instance canal.auto.scan = false canal.auto.scan.interval = 5 canal.instance.global.mode = spring canal.instance.global.lazy = false è¯·é—®instanceä¸ºä»€ä¹ˆä¼šå‘ç”Ÿé‡å¯ï¼Ÿ æ€æ ·èƒ½æ§åˆ¶æœåŠ¡ç«¯çš„instanceä¸å‘ç”Ÿé‡å¯ï¼Ÿ é‡åˆ°ackå¼‚å¸¸æ—¶ï¼Œé‡æ–°rollbackä¸€ä¸‹å†æ¥ä¸€æ¬¡å°±å¯ä»¥äº†ï¼Œçœ‹ä¸€ä¸‹exampleçš„æ ·ä¾‹å·¥ç¨‹
886,canal 
885,å…³äºkafka topicè®¾ç½® è¯·é—®ç›®å‰æ˜¯å¦æ”¯æŒå¯¹åº”æ¯å¼ mysqlè¡¨è®¾ç½®ä¸€ä¸ªå¯¹åº”çš„kafka topicï¼Ÿ åˆæ­¥çœ‹ä»£ç ï¼Œç›®å‰ä¼¼ä¹åªæ”¯æŒå¯¹åº”ä¸€ä¸ªdestinationè®¾ç½®å¤šä¸ªtopicï¼Œæ•°æ®ä¼šå‘å¾€è®¾ç½®çš„æ‰€æœ‰topicã€‚ ç›®å‰åªæ”¯æŒä¸€ä¸ªdestinationä¸€ä¸ªtopic
884,é€šè¿‡canal.instance.filter.regex= è¿‡æ»¤ å’Œé€šè¿‡javaç¨‹åºconnector.subscribe(" ")æœ‰ä»€ä¹ˆä¸åŒçš„å—ï¼Ÿ å®é™…ä½¿ç”¨ä¸­ï¼Œåªè®©canalç›‘å¬ä¸€ä¸ªåº“ä¸­çš„æŸå‡ å¼ è¡¨ï¼Œæ€ä¹ˆé…æ€§èƒ½ä¼šæ›´å¥½ä¸€ç‚¹ï¼Œæœ›å¤§ä½¬æŒ‡æ•™ å¤šçœ‹ä¸‹wiki
883,canal1.1.0å½“ç›‘å¬åˆ°ç¬¬ä¸€æ¬¡å˜åŒ–æ—¶æŠ¥é”™ï¼Œåæ¥éƒ½æ²¡é—®é¢˜ logEventParserProxy - dump address /106.12.14.74:3306 has an error  retrying. caused by com.alibaba.otter.canal.parse.exception.CanalParseException: java.net.SocketException: Connection reset Caused by: java.net.SocketException: Connection reset         at java.net.SocketInputStream.read(SocketInputStream.java:210) ~[na:1.8.0_181]         at java.net.SocketInputStream.read(SocketInputStream.java:141) ~[na:1.8.0_181]         at java.io.BufferedInputStream.fill(BufferedInputStream.java:246) ~[na:1.8.0_181]         at java.io.BufferedInputStream.read1(BufferedInputStream.java:286) ~[na:1.8.0_181]         at java.io.BufferedInputStream.read(BufferedInputStream.java:345) ~[na:1.8.0_181]         at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannel.read(BioSocketChannel.java:52) ~[canal.parse.driver-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.readHeader(PacketManager.java:12) ~[canal.parse.driver-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.readNextPacket(MysqlQueryExecutor.java:159) ~[canal.parse.driver-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.query(MysqlQueryExecutor.java:56) ~[canal.parse.driver-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:102) ~[canal.parse-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:148) ~[canal.parse-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:129) ~[canal.parse-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:91) ~[canal.parse-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:188) ~[canal.parse-1.1.0.jar:na]         at java.lang.Thread.run(Thread.java:748) [na:1.8.0_181] 2018-08-26 19:08:07.309 [destination = example   address = /106.12.14.74:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: java.net.SocketException: Connection reset Caused by: java.net.SocketException: Connection reset  ç½‘ç»œå¼‚å¸¸  ä¼šè‡ªåŠ¨é‡è¯•
882,1.0.26-alpha 2: canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield canal.instance.tsdb.enable=false canal.instance.gtidon=false é”™è¯¯æ—¥å¿—1ï¼š ``` 2018-08-25 10:04:02.917 [destination = platform_data   address = ip:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTa bleMeta - parse faield : CREATE TABLE `t_bill_details` (   `bill_id` bigint(20) NOT NULL   ....   KEY `IDX_BD_CITY` (`store_city`) KEY_BLOCK_SIZE=8   KEY `IDX_BD_DETAIL_ID` (`detail_id`) KEY_BLOCK_SIZE=8   KEY `IDX_BD_SD` (`bill_sale_date`) KEY_BLOCK_SIZE=8   KEY `IDX_BD_SSS` (`bill_status` `store_city` `bill_sale_date` `store_id`) KEY_BLOCK_SIZE=8   KEY `IDX_STORE_ID` (`store_id`) KEY_BLOCK_SIZE=8   KEY `IDX_BD_STATUS` (`bill_status` `bill_sale_date`) KEY_BLOCK_SIZE=8 ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 ROW_FORMAT=COMPRESSED KEY_BLOCK_SIZE=4 com.alibaba.fastsql.sql.parser.ParserException: syntax error  error in :'id`) KEY_BLOCK_SIZE=8   KEY `IDX_B'  expect RPAREN  actual IDENTIFIER pos 1834  line 43  column 32  token IDENTIFIER KEY_BLOCK_SIZE         at com.alibaba.fastsql.sql.parser.SQLParser.printError(SQLParser.java:305) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186]         at com.alibaba.fastsql.sql.parser.SQLParser.accept(SQLParser.java:313) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186]         at com.alibaba.fastsql.sql.dialect.mysql.parser.MySqlCreateTableParser.parseCreateTable(MySqlCreateTableParser.java:260) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186]         at com.alibaba.fastsql.sql.dialect.mysql.parser.MySqlStatementParser.parseCreate(MySqlStatementParser.java:239) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186]         at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:165) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186]         at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:76) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186]         at com.alibaba.fastsql.sql.SQLUtils.parseStatements(SQLUtils.java:469) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186]         at com.alibaba.fastsql.sql.repository.SchemaRepository.console(SchemaRepository.java:331) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:71) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.parseTableMeta(TableMetaCache.java:101) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMetaByDB(TableMetaCache.java:87) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.access$000(TableMetaCache.java:32) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:57) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:52) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3527) [guava-18.0.jar:na]         at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2319) [guava-18.0.jar:na]         at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2282) [guava-18.0.jar:na]         at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2197) [guava-18.0.jar:na]         at com.google.common.cache.LocalCache.get(LocalCache.java:3937) [guava-18.0.jar:na]         at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3941) [guava-18.0.jar:na]         at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4824) [guava-18.0.jar:na]         at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4830) [guava-18.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:185) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:793) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:457) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:133) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:68) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:345) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:187) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:154) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.8.0_60] ``` é”™è¯¯æ—¥å¿—2:  ``` 2018-08-25 09:59:04.733 [destination = platform_data   address = ip:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHand ler - destination:platform_data[com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.util.concurrent.UncheckedExecutionException: com.alibaba.otter.canal.parse.exception.CanalParseException: fetch  failed by table meta:`platform_data`.`tmp_presto_0e13f1bc14574ec4ae4950cade1bc360` Caused by: com.google.common.util.concurrent.UncheckedExecutionException: com.alibaba.otter.canal.parse.exception.CanalParseException: fetch failed by table meta:`platform_data`.`tmp_presto_0e13f1bc145 74ec4ae4950cade1bc360`         at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2203)         at com.google.common.cache.LocalCache.get(LocalCache.java:3937)         at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3941)         at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4824)         at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4830)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:185)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:793)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:457)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:127)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:68)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:345)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:187)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:154)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227)         at java.lang.Thread.run(Thread.java:745) Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: fetch failed by table meta:`platform_data`.`tmp_presto_0e13f1bc14574ec4ae4950cade1bc360` Caused by: java.io.IOException: ErrorPacket [errorNumber=1146  fieldCount=-1  message=Table 'platform_data.tmp_presto_0e13f1bc14574ec4ae4950cade1bc360' doesn't exist  sqlState=42S02  sqlStateMarker=#]  with command: desc `platform_data`.`tmp_presto_0e13f1bc14574ec4ae4950cade1bc360`         at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.query(MysqlQueryExecutor.java:61)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:96)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMetaByDB(TableMetaCache.java:89)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.access$000(TableMetaCache.java:32)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:62)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:52)         at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3527)         at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2319)         at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2282)         at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2197)         at com.google.common.cache.LocalCache.get(LocalCache.java:3937)         at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3941)         at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4824)         at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4830)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:185)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:793)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:457)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:127)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:68)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:345)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:187)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:154)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227)         at java.lang.Thread.run(Thread.java:745) ``` å…¶å®æˆ‘åªéœ€è¦ç›‘å¬dmlï¼Œå¦‚æœæˆ‘é…ç½®è¿‡æ»¤è¦æ€ä¹ˆåšï¼Ÿé…ç½®ä¸‹é¢çš„å—ï¼Ÿ ``` canal.instance.filter.druid.ddl = true canal.instance.filter.query.dcl = true canal.instance.filter.query.dml = false canal.instance.filter.query.ddl = true canal.instance.filter.table.error = true canal.instance.filter.rows = false ``` canal.instance.filter.rowså…·ä½“åšä»€ä¹ˆçš„ï¼Œwikiæ²¡çœ‹æ‡‚ å…ˆå‡çº§æœ€æ–°çš„1.1.0è¿›è¡Œæµ‹è¯•
881,fix bug: å¹¶è¡Œè§£ææ¨¡å¼ä¸‹ï¼Œå¼€å¯gtid ä¼šå¯¼è‡´è§£æé”™è¯¯ tks
880,aliyun  rds æ—¥å¿—è§£æå¤±è´¥ Could not find first log file name in binary log index file ä¸æ˜¯è¯´å…¨é¢æ”¯æŒrdsäº†å—ï¼Œä¸ºå•¥è¿˜æœ‰è¿™ä¸ªé”™ï¼Œcanal.instance.rds.accesskey é‚£å‡ ä¸ªå‚æ•°ä¹Ÿé…äº†ï¼Œä½†æ˜¯è²Œä¼¼æ²¡èµ·ä½œç”¨å•Š è¿™æ˜¯binlogè¢«åˆ é™¤ï¼Œæ¸…ç†æ‰offestï¼Œä½¿ç”¨binlogæ—¶é—´æˆ³æ¥å®šä½
879,ä¸ºä»€ä¹ˆæˆ‘æŒ‡å®šé‡Œçš„ä¸€å¼ è¡¨ï¼Œä½†æ˜¯ä»kafkaé‡Œé¢å°±çœ‹ä¸åˆ°schemaåå’Œè¡¨å æˆ‘è®¾ç½®äº†è¿™ä¸ª canal.instance.filter.regex=db_shopdog_test.deli_order ä½†æ˜¯kafkaé‡Œé¢è§£æä¸åˆ°schemaåå’Œè¡¨å å…ˆçœ‹ä¸‹wikiï¼Œç¡®è®¤ä¸‹filteræ˜¯å¦ç”Ÿæ•ˆ
878,instance.propertieså¯¹è¡¨è¿›è¡Œè¿‡æ»¤canal.instance.filter.regex= ä¸èµ·ä½œç”¨ï¼Œå¦‚ä½•é…ç½®ç›‘è§†æ•°æ®åº“ä¸­æŒ‡å®šæŸå¼ è¡¨çš„å˜åŒ– å¤šçœ‹wikié‡Œçš„FAQ æˆ‘ä¹Ÿæœ‰è¿™ä¸ªéœ€æ±‚ä¸çŸ¥é“æ€ä¹ˆåšï¼Ÿæˆ‘éœ€è¦ç›‘æ§ä¸€ä¸ªåº“é‡Œé¢çš„ä¸‰å¼ è¡¨ ï¼Œgithubé‡Œé¢çš„wikié‡Œçš„FAQæ‰“ä¸å¼€äº†ã€‚ > å¤šçœ‹wikié‡Œçš„FAQ æˆ‘ä¹Ÿæœ‰è¿™ä¸ªéœ€æ±‚ä¸çŸ¥é“æ€ä¹ˆåšï¼Ÿæˆ‘éœ€è¦ç›‘æ§ä¸€ä¸ªåº“é‡Œé¢çš„ä¸‰å¼ è¡¨ ï¼Œgithubé‡Œé¢çš„wikié‡Œçš„FAQæ‰“ä¸å¼€äº†ã€‚
877,canalå¦‚ä½•é…ç½®åªç›‘å¬æ›´æ–°çŠ¶æ€ï¼Œæ’å…¥ï¼Œåˆ é™¤éƒ½ä¸ç›‘å¬ å¯ä»¥åœ¨æ ¹æ®CanalEntry.EventTypeè‡ªå·±è¿‡æ»¤ å¤šè°¢å¤§ä½¬æŒ‡ç‚¹ã€‚ å‘è‡ªç½‘æ˜“é‚®ç®±å¤§å¸ˆ åœ¨2018å¹´8æœˆ24æ—¥ 11:28ï¼Œxiaokangzhao<notifications@github.com> å†™é“ï¼š å¯ä»¥åœ¨æ ¹æ®CanalEntry.EventTypeè‡ªå·±è¿‡æ»¤ â€” You are receiving this because you authored the thread. Reply to this email directly  view it on GitHub  or mute the thread.
876,æ•´åˆ kafka åˆ° server å’Œ client tks
875,canal.logå¯åŠ¨canalæŠ¥é”™ 2018-08-24 06:25:04.409 [New I/O server worker #1-1] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x599715d9  /192.168.254.1:57576 => /192.168.254.128:11111]  exception=java.io.IOException: Connection reset by peer         at sun.nio.ch.FileDispatcherImpl.read0(Native Method)         at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)         at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)         at sun.nio.ch.IOUtil.read(IOUtil.java:192)         at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)         at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:322)         at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:281)         at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:201)         at org.jboss.netty.util.internal.IoWorkerRunnable.run(IoWorkerRunnable.java:46)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)         at java.lang.Thread.run(Thread.java:745) æœ›å¤§ä½¬ä»¬æŒ‡ç‚¹ã€‚ å‡çº§åˆ°æœ€æ–°çš„1.1.0
874,ä¸»ä»åŒæ­¥å»¶æ—¶å¤§æ¦‚å¤šä¹… æœ‰æ²¡æœ‰ç›¸å…³çš„æ€§èƒ½æµ‹è¯•æŠ¥å‘Šå•Šï¼Œæ¯”å¦‚æ•°æ®é‡å¤šå¤§çš„æ—¶å€™ï¼Œå»¶è¿Ÿæ¯”è¾ƒå¤§ å¤šçœ‹wikiçš„perfomanceå’Œç›‘æ§
873,å•æ ¸ç¯å¢ƒä¸‹åˆ›å»ºçº¿ç¨‹æ± ä¼šå‡ºé”™ã€‚ as title [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=873) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=873) before we can accept your contribution.<br/><hr/>**Chuanyi Li L** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=873) it.</sub> [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=873) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=873) before we can accept your contribution.<br/><hr/>**Chuanyi Li L** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=873) it.</sub> tksï¼Œéš¾æ€ªæœ€è¿‘æœ‰æ¯”è¾ƒå¤šçš„åé¦ˆçº¿ç¨‹æ± åˆ›å»ºå¤±è´¥çš„é—®é¢˜ï¼Œè¿™ä¹ˆå¤šç”¨å°è§„æ ¼è™šæ‹Ÿæœºçš„å•Š
872,canal serverã€client å’Œ canal-kafka serverã€canal-kafka client åˆå¹¶ canal serverã€client å’Œ canal-kafka serverã€canal-kafka client åˆå¹¶
871,ä¸ºä»€ä¹ˆæˆ‘ä¼ è¾“åˆ°kafkaé‚£é‡Œæ˜¾ç¤ºçš„å…¨æ˜¯ä¹±ç  é…ç½®éƒ½æ˜¯æŒ‰ç…§æ–‡æ¡£æ¥çš„ï¼Œmysqlçš„å­—ç¬¦é›†æ˜¯utf8 mysql-bin.000002Â« *UTF-80Â¨Â£Â¯Ô¬8BJP58025 XshellXshellXshellXshell8 mysql-bin.000002 *UTF-80ò¯°– 8BJPK w mysql-bin.000002 *UTF-80ò¯°– 8Btest_heJbP'Xb 	rowsCount1ò‚Pa (0BdR	char(200)= mysql-bin.000002Â® *UTF-80ò¯°– 8BJP58052 XshellXshellXshellXshell8 mysql-bin.000002 *UTF-80È¹ñ±”¬8BJPK w mysql-bin.000002 *UTF-80È¹ñ±”¬8Btest_heJbP'Xb 	rowsCount1ò‚Pa (0BdR	char(200)= mysql-bin.000002Â± *UTF-80È¹ñ±”¬8BJP58481 XshellXshellXshellXshell8 mysql-bin.000002 *UTF-80ñº·°Ô¬8BJPK w mysql-bin.000002 *UTF-80ñº·°Ô¬8Btest_heJbP'Xb 	rowsCount1ò‚Pa (0BdR	char(200)= mysql-bin.000002Â´ *UTF-80ñº·°Ô¬8BJP58486 XshellXshellXshellXshellXshell8 mysql-bin.000002 *UTF-80Âºñ”ª¸BJPK w mysql-bin.000002 *UTF-80Âºñ”ª¸Btest_heJbP'Xb 	rowsCount1ò‚Pa (0BdR	char(200)= mysql-bin.000002Â· *UTF-80Âºñ”ª¸BJP58491 XshellXshellXshellXshell8 mysql-bin.000002 *UTF-80ñ¼±– 8BJPK w mysql-bin.000002 *UTF-80ñ¼±– 8Btest_heJbP'Xb 	rowsCount1ò‚Pa (0BdR	char(200)= mysql-bin.000002Âº *UTF-80ñ¼±– 8BJP58498 XshellXshellXshellXshel8* mysql-bin.000002 *UTF-80Ñ‚Ã¿Â°Ô¬8BJPK w mysql-bin.000002 *UTF-80Ñ‚Ã¿Â°Ô¬8Btest_heJbP'Xb 	rowsCount1ò‚Pa (0BdR	char(200)= mysql-bin.000002Â½ *UTF-80Ñ‚Ã¿Â°Ô¬8BJP58507 XshellXshellXshellXshell*       8 mysql-bin.000002 *UTF-80È†Â±Ô¬8BJPK w mysql-bin.000002Â  *UTF-80È†Â±Ô¬8Btest_heJbP'Xb 	rowsCount1ò‚Pa (0BdR	char(200)= mysql-bin.000002  *UTF-80È†Â±Ô¬8BJP58520 XshellXshellXshellXshell* 8 mysql-bin.000002Â Â¡ *UTF-80Â¸Â²Â±Ô¬8BJPK w mysql-bin.000002Â¢ *UTF-80Â¸Â²Â±Ô¬8Btest_heJbP'X 	rowsCount1ò‚Pa (0BdR	char(200)= mysql-bin.000002Ã¢ *UTF-80Â¸Â²Â±Ô¬8BJP58525 XshellXshellXshellXshell*                         8 mysql-bin.000002Â£Â£ *UTF-80×Â±Ô¬8BJPK w mysql-bin.000002Â¤ *UTF-80×Â±Ô¬8Btest_heJbP'Xb 	rowsCount1ò‚Pa (0BdR	char(200)= mysql-bin.000002Æ¤ *UTF-80×Â±Ô¬8BJP58538 ä¼ åˆ°kafkaçš„æ˜¯messageçš„åºåˆ—åŒ–æ•°æ®ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°åä¼šååºåˆ—åŒ–ä¸ºmessageçš„
870,canalç›‘å¬å¤šä¸ªmysqlæ•°æ®åº“åº”è¯¥å¦‚ä½•é…ç½®ï¼Ÿ å¤šçœ‹wiki
869,canal-kafka-1.0.26-preview-4: CanalKafkaStarter  CPUå ç”¨ç‡é«˜ CanalKafkaStarter.worker çº¿ç¨‹ä¸­è°ƒç”¨getWithoutAckæœªä½¿ç”¨timeoutå‚æ•°ã€‚ ``` "pool-8-thread-1" #21 prio=5 os_prio=0 tid=0x00007facb47b1000 nid=0x5fe runnable [0x00007fac8d16b000]    java.lang.Thread.State: RUNNABLE         at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.isStart(CanalServerWithEmbedded.java:126)         at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.checkStart(CanalServerWithEmbedded.java:484)         at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:279)         at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:259)         at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter.worker(CanalKafkaStarter.java:118)         at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter.access$000(CanalKafkaStarter.java:26)         at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter$1.run(CanalKafkaStarter.java:67)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)         at java.lang.Thread.run(Thread.java:748) ``` æœ€æ–°çš„1.1.1å·²ç»ä¿®å¤
868,canal-kafka-1.1.0: æ— é™å¾ªç¯CanalKafkaStarter - process error! kafka: n1:9092 n2:9092 zk: n3:2181 n4:2181 n5:2181 canal: n1 é”™è¯¯æ—¥å¿—ï¼š ``` 2018-08-23 16:25:08.274 [destination = example   address = n1/192.168.4.11:3306   EventParser] WARN  c.a.o.c.p.inboun d.mysql.rds.RdsBinlogEventParserProxy - find start position : EntryPosition[included=false journalName=mysql-bin.0000 01 position=3024 serverId=<null> gtid=<null> timestamp=<null>] 2018-08-23 16:25:08.299 [main] INFO  com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter - ## start the kafka wo rkers. 2018-08-23 16:25:08.300 [main] INFO  com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter - ## the kafka workers  is running now ...... 2018-08-23 16:25:08.301 [pool-4-thread-1] INFO  com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter - ## start t he canal consumer: example. 2018-08-23 16:25:08.305 [pool-4-thread-1] INFO  com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter - ## the can al consumer example is running now ...... 2018-08-23 16:25:15.105 [pool-4-thread-1] ERROR com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter - process er ror! java.lang.NullPointerException: null         at com.alibaba.otter.canal.store.helper.CanalEventUtils.createPosition(CanalEventUtils.java:69) ~[canal.store -1.1.0.jar:na]         at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.getFirstPosition(MemoryEventStoreWithBuffe r.java:375) ~[canal.store-1.1.0.jar:na]         at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.getFirstPosition(MemoryEventStoreWithBuffe r.java:36) ~[canal.store-1.1.0.jar:na]         at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java :307) ~[canal.server-1.1.0.jar:na]         at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java :273) ~[canal.server-1.1.0.jar:na]         at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter.worker(CanalKafkaStarter.java:121) [canal.kafka-1 .1.0.jar:na]         at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter.access$000(CanalKafkaStarter.java:26) [canal.kafk a-1.1.0.jar:na]         at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter$1.run(CanalKafkaStarter.java:70) [canal.kafka-1.1 .0.jar:na]         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_161]         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_161]         at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-08-23 16:25:15.106 [pool-4-thread-1] ERROR com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter - process er ror! java.lang.NullPointerException: null         at com.alibaba.otter.canal.store.helper.CanalEventUtils.createPosition(CanalEventUtils.java:69) ~[canal.store -1.1.0.jar:na]         at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.getFirstPosition(MemoryEventStoreWithBuffe : ``` é…ç½®ï¼š canal.properties ```################################################# ######### 		common argument		#############  ################################################# canal.id= 1 canal.ip= canal.port=11111 canal.metrics.pull.port=11112 canal.zkServers=n3:2181 n4:2181 n5:2181 # flush data to zk canal.zookeeper.flush.period = 1000 canal.withoutNetty = true # flush meta cursor/parse position to file canal.file.data.dir = ${canal.conf.dir} canal.file.flush.period = 1000 ## memory store RingBuffer size  should be Math.pow(2 n) canal.instance.memory.buffer.size = 16384 ## memory store RingBuffer used memory unit size   default 1kb canal.instance.memory.buffer.memunit = 1024  ## meory store gets mode used MEMSIZE or ITEMSIZE canal.instance.memory.batch.mode = MEMSIZE ## detecing config canal.instance.detecting.enable = false #canal.instance.detecting.sql = insert into retl.xdual values(1 now()) on duplicate key update x=now() canal.instance.detecting.sql = select 1 canal.instance.detecting.interval.time = 3 canal.instance.detecting.retry.threshold = 3 canal.instance.detecting.heartbeatHaEnable = false # support maximum transaction size  more than the size of the transaction will be cut into multiple transactions delivery canal.instance.transaction.size =  1024 # mysql fallback connected to new master should fallback times canal.instance.fallbackIntervalInSeconds = 60 # network config canal.instance.network.receiveBufferSize = 16384 canal.instance.network.sendBufferSize = 16384 canal.instance.network.soTimeout = 30 # binlog filter config canal.instance.filter.druid.ddl = true canal.instance.filter.query.dcl = true canal.instance.filter.query.dml = false canal.instance.filter.query.ddl = true canal.instance.filter.table.error = false canal.instance.filter.rows = false canal.instance.filter.transaction.entry = true # binlog format/image check canal.instance.binlog.format = ROW STATEMENT MIXED  canal.instance.binlog.image = FULL MINIMAL NOBLOB # binlog ddl isolation canal.instance.get.ddl.isolation = false # parallel parser config canal.instance.parser.parallel = true ## concurrent thread number  default 60% available processors  suggest not to exceed Runtime.getRuntime().availableProcessors() #canal.instance.parser.parallelThreadSize = 16 ## disruptor ringbuffer size  must be power of 2 canal.instance.parser.parallelBufferSize = 256 # table meta tsdb info canal.instance.tsdb.enable=true canal.instance.tsdb.dir=${canal.file.data.dir:../conf}/${canal.instance.destination:} canal.instance.tsdb.url=jdbc:h2:${canal.instance.tsdb.dir}/h2;CACHE_SIZE=1000;MODE=MYSQL; canal.instance.tsdb.dbUsername=canal canal.instance.tsdb.dbPassword=canal # rds oss binlog account canal.instance.rds.accesskey = canal.instance.rds.secretkey = ################################################# ######### 		destinations		#############  ################################################# canal.destinations= example # conf root dir canal.conf.dir = ../conf # auto scan instance dir add/remove and start/stop instance canal.auto.scan = true canal.auto.scan.interval = 5 canal.instance.tsdb.spring.xml=classpath:spring/tsdb/h2-tsdb.xml #canal.instance.tsdb.spring.xml=classpath:spring/tsdb/mysql-tsdb.xml canal.instance.global.mode = spring  canal.instance.global.lazy = false #canal.instance.global.manager.address = 127.0.0.1:1099 #canal.instance.global.spring.xml = classpath:spring/memory-instance.xml #canal.instance.global.spring.xml = classpath:spring/file-instance.xml canal.instance.global.spring.xml = classpath:spring/default-instance.xml ``` kafka.yml ```servers: n1:9092 n2:9092 retries: 0 batchSize: 16384 lingerMs: 1 bufferMemory: 33554432 # canalçš„æ‰¹æ¬¡å¤§å°ï¼Œå•ä½ kï¼Œé‡å¤§å»ºè®®æ”¹ä¸º1M canalBatchSize: 50 filterTransactionEntry: true canalDestinations:   - canalDestination: example     topic: example     partition: ``` example/instance.properties ```################################################# ## mysql serverId   v1.0.26+ will autoGen  # canal.instance.mysql.slaveId=0 # enable gtid use true/false canal.instance.gtidon=false # position info canal.instance.master.address=n1:3306 canal.instance.master.journal.name= canal.instance.master.position= canal.instance.master.timestamp= canal.instance.master.gtid= # rds oss binlog canal.instance.rds.accesskey= canal.instance.rds.secretkey= canal.instance.rds.instanceId= # table meta tsdb info canal.instance.tsdb.enable=false #canal.instance.tsdb.url=jdbc:mysql://127.0.0.1:3306/canal_tsdb #canal.instance.tsdb.dbUsername=canal #canal.instance.tsdb.dbPassword=canal #canal.instance.standby.address = #canal.instance.standby.journal.name = #canal.instance.standby.position =  #canal.instance.standby.timestamp = #canal.instance.standby.gtid= # username/password canal.instance.dbUsername=root canal.instance.dbPassword=root canal.instance.connectionCharset=UTF-8 # table regex canal.instance.filter.regex=test\\..* # table black regex canal.instance.filter.black.regex= ################################################# ``` ç¬¬ä¸€æ¬¡insert into table æˆåŠŸè§£æbinlogï¼Œç„¶åå°±å‡ºç°è¿™ä¸ªé—®é¢˜ ä½¿ç”¨å®˜æ–¹canalçš„exampleé‡Œçš„SimpleCanalClientTestè¯»å–ã€‚ç¬¬ä¸€æ¬¡æ’å…¥çš„æ•°æ®èƒ½è§£æï¼Œä¹‹åçš„å°±æŠ¥é”™ï¼Œæ—¥å¿—å¦‚ä¸‹ï¼š ä¸€ç›´åœ¨æ¢ç«¯å£ï¼Ÿ ``` **************************************************** * Batch Id: [1]  count : [1]   memsize : [55]   Time : 2018-08-25 15:56:55 * Start : [mysql-bin.000005:642:1535212613000(2018-08-25 23:56:53)]  * End : [mysql-bin.000005:642:1535212613000(2018-08-25 23:56:53)]  **************************************************** ----------------> binlog[mysql-bin.000005:642]   name[test ar_tmp]   eventType : INSERT   executeTime : 1535212613000(2018-08-25 23:56:53)   gtid : ()   delay : -28797618 ms id : 1    type=int(11)    update=true name : a    type=varchar(32)    update=true price : 1.1    type=double    update=true time : 2018-08-25 23:56:53    type=datetime    update=true process error!com.alibaba.otter.canal.protocol.exception.CanalClientException: something goes wrong with reason: something goes wrong with channel:[id: 0x12e25627  /192.168.4.1:9230 => /192.168.4.21:11111]  exception=java.lang.NullPointerException 	at com.alibaba.otter.canal.store.helper.CanalEventUtils.createPosition(CanalEventUtils.java:69) 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.getFirstPosition(MemoryEventStoreWithBuffer.java:375) 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.getFirstPosition(MemoryEventStoreWithBuffer.java:36) 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:307) 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:273) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:124) 	at org.jboss.netty.channel.SimpleChannelHandler.handleUpstream(SimpleChannelHandler.java:100) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:545) 	at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:754) 	at org.jboss.netty.channel.SimpleChannelHandler.messageReceived(SimpleChannelHandler.java:154) 	at org.jboss.netty.channel.SimpleChannelHandler.handleUpstream(SimpleChannelHandler.java:100) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:545) 	at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:754) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276) 	at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:80) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:545) 	at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:754) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:444) 	at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:80) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:545) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:540) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:350) 	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:281) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:201) 	at org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108) 	at org.jboss.netty.util.internal.IoWorkerRunnable.run(IoWorkerRunnable.java:46) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) 	at java.lang.Thread.run(Thread.java:748) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.receiveMessages(SimpleCanalConnector.java:344) ~[classes/:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:315) ~[classes/:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:287) ~[classes/:na] 	at com.alibaba.otter.canal.example.AbstractCanalClientTest.process(AbstractCanalClientTest.java:110) ~[classes/:na] 	at com.alibaba.otter.canal.example.AbstractCanalClientTest$2.run(AbstractCanalClientTest.java:76) [classes/:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_171] process error!com.alibaba.otter.canal.protocol.exception.CanalClientException: failed to subscribe with reason: something goes wrong with channel:[id: 0x1fda2da3  /192.168.4.1:9232 => /192.168.4.21:11111]  exception=java.lang.NullPointerException 	at com.alibaba.otter.canal.store.helper.CanalEventUtils.createPosition(CanalEventUtils.java:69) 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.getFirstPosition(MemoryEventStoreWithBuffer.java:375) 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.getFirstPosition(MemoryEventStoreWithBuffer.java:36) 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.subscribe(CanalServerWithEmbedded.java:157) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:77) 	at org.jboss.netty.channel.SimpleChannelHandler.handleUpstream(SimpleChannelHandler.java:100) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:545) 	at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:754) 	at org.jboss.netty.channel.SimpleChannelHandler.messageReceived(SimpleChannelHandler.java:154) 	at org.jboss.netty.channel.SimpleChannelHandler.handleUpstream(SimpleChannelHandler.java:100) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:545) 	at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:754) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276) 	at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:80) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:545) 	at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:754) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:444) 	at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:80) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:545) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:540) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:350) 	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:281) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:201) 	at org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108) 	at org.jboss.netty.util.internal.IoWorkerRunnable.run(IoWorkerRunnable.java:46) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) 	at java.lang.Thread.run(Thread.java:748) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.subscribe(SimpleCanalConnector.java:241) ~[classes/:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.subscribe(SimpleCanalConnector.java:218) ~[classes/:na] 	at com.alibaba.otter.canal.example.AbstractCanalClientTest.process(AbstractCanalClientTest.java:108) ~[classes/:na] 	at com.alibaba.otter.canal.example.AbstractCanalClientTest$2.run(AbstractCanalClientTest.java:76) [classes/:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_171] process error!com.alibaba.otter.canal.protocol.exception.CanalClientException: failed to subscribe with reason: something goes wrong with channel:[id: 0x1c0b056f  /192.168.4.1:9233 => /192.168.4.21:11111]  exception=java.lang.NullPointerException 	at com.alibaba.otter.canal.store.helper.CanalEventUtils.createPosition(CanalEventUtils.java:69) 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.getFirstPosition(MemoryEventStoreWithBuffer.java:375) 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.getFirstPosition(MemoryEventStoreWithBuffer.java:36) 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.subscribe(CanalServerWithEmbedded.java:157) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:77) 	at org.jboss.netty.channel.SimpleChannelHandler.handleUpstream(SimpleChannelHandler.java:100) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:545) 	at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:754) 	at org.jboss.netty.channel.SimpleChannelHandler.messageReceived(SimpleChannelHandler.java:154) 	at org.jboss.netty.channel.SimpleChannelHandler.handleUpstream(SimpleChannelHandler.java:100) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:545) 	at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:754) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276) 	at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:80) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:545) 	at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:754) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:444) 	at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:80) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:545) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:540) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:350) 	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:281) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:201) 	at org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108) 	at org.jboss.netty.util.internal.IoWorkerRunnable.run(IoWorkerRunnable.java:46) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) 	at java.lang.Thread.run(Thread.java:748) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.subscribe(SimpleCanalConnector.java:241) ~[classes/:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.subscribe(SimpleCanalConnector.java:218) ~[classes/:na] 	at com.alibaba.otter.canal.example.AbstractCanalClientTest.process(AbstractCanalClientTest.java:108) ~[classes/:na] 	at com.alibaba.otter.canal.example.AbstractCanalClientTest$2.run(AbstractCanalClientTest.java:76) [classes/:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_171] process error!com.alibaba.otter.canal.protocol.exception.CanalClientException: failed to subscribe with reason: something goes wrong with channel:[id: 0x6db99e95  /192.168.4.1:9234 => /192.168.4.21:11111]  exception=java.lang.NullPointerException 	at com.alibaba.otter.canal.store.helper.CanalEventUtils.createPosition(CanalEventUtils.java:69) 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.getFirstPosition(MemoryEventStoreWithBuffer.java:375) 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.getFirstPosition(MemoryEventStoreWithBuffer.java:36) 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.subscribe(CanalServerWithEmbedded.java:157) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:77) ``` æˆ‘ä½¿ç”¨çš„æ˜¯spring/file-instance.xmlã€‚åˆæ­¥ä¼°è®¡ï¼Œåº”è¯¥æ˜¯${destination_dir}/meta.datçš„é—®é¢˜ alpha5ç‰ˆæœ¬å†™å…¥çš„meta.dat ``` {"clientDatas":[{"clientIdentity":{"clientId":1001 "destination":"local_mysql" "filter":""} "cursor":{"identity":{"slaveId":-1 "sourceAddress":{"address":"192.168.4.101" "port":3306}} "postion":{"gtid":"" "included":false "journalName":"mysql-bin.000005" "position":14016 "serverId":1 "timestamp":1535189721000}}}] "destination":"local_mysql"} ``` è€Œ1.1.0å†™å…¥çš„meta.dat ``` {"clientDatas":[{"clientIdentity":{"clientId":1001 "destination":"local_mysql" "filter":""}}] "destination":"local_mysql"} ``` å¦‚æœæˆ‘æŠŠalpha5çš„meta.datè¦†ç›–1.1.0çš„ï¼Œé‚£1.1.0çš„å°±æ²¡æœ‰æ¥¼ä¸Šçš„é—®é¢˜äº† NPEçš„é—®é¢˜  æˆ‘ä»¬å…³æ³¨ä¸€ä¸‹ 2018-09-03 17:21:00.046 [main] INFO  com.alibaba.otter.canal.kafka.CanalServerStarter - ## the canal server is running now ...... 2018-09-03 17:21:00.048 [main] INFO  com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter - ## load kafka configurations 2018-09-03 17:21:00.169 [main] INFO  com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter - ## start the kafka workers. 2018-09-03 17:21:00.169 [main] INFO  com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter - ## the kafka workers is running now ...... 2018-09-03 17:21:00.169 [pool-5-thread-1] INFO  com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter - ## start the canal consumer: ordertest3317. 2018-09-03 17:21:53.135 [canal-instance-scan-0] WARN  o.s.beans.GenericTypeAwarePropertyDescriptor - Invalid JavaBean property 'connectionCharset' being accessed! Ambiguous write methods found next to actually used [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.lang.String)]: [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.nio.charset.Charset)] 2018-09-03 17:21:53.157 [canal-instance-scan-0] INFO  c.a.o.canal.deployer.monitor.SpringInstanceConfigMonitor - auto notify reload ordertest3317 successful. 2018-09-03 17:21:54.161 [destination = ordertest3317   address = yunjitest.mysql.rds.aliyuncs.com/47.98.70.247:3306   EventParser] WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - prepare to find start position just show master status 2018-09-03 17:21:54.204 [destination = ordertest3317   address = yunjitest.mysql.rds.aliyuncs.com/47.98.70.247:3306   EventParser] WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - find start position : EntryPosition[included=false journalName=mysql-bin.001277 position=264457500 serverId=<null> gtid=<null> timestamp=<null>] 2018-09-03 17:21:54.230 [pool-5-thread-1] INFO  com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter - ## the canal consumer ordertest3317 is running now ...... **2018-09-03 17:21:55.892 [pool-5-thread-1] ERROR com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter - process error! java.lang.NullPointerException: null 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.calculateSize(MemoryEventStoreWithBuffer.java:555) ~[canal.store-1.1.0.jar:na] 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.doGet(MemoryEventStoreWithBuffer.java:322) ~[canal.store-1.1.0.jar:na] 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.tryGet(MemoryEventStoreWithBuffer.java:261) ~[canal.store-1.1.0.jar:na] 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getEvents(CanalServerWithEmbedded.java:478) ~[canal.server-1.1.0.jar:na] 	at** com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:310) ~[canal.server-1.1.0.jar:na] 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:273) ~[canal.server-1.1.0.jar:na] 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter.worker(CanalKafkaStarter.java:121) [canal.kafka-1.1.0.jar:na] 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter.access$000(CanalKafkaStarter.java:26) [canal.kafka-1.1.0.jar:na] 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter$1.run(CanalKafkaStarter.java:70) [canal.kafka-1.1.0.jar:na] 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_181] 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_181] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_181] 2018-09-03 17:21:55.896 [pool-5-thread-1] INFO  com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter - ## the canal consumer ordertest3317 is running now ...... 2018-09-03 17:21:55.896 [pool-5-thread-1] ERROR com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter - process error! java.lang.NullPointerException: null 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.calculateSize(MemoryEventStoreWithBuffer.java:555) ~[canal.store-1.1.0.jar:na] 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.doGet(MemoryEventStoreWithBuffer.java:322) ~[canal.store-1.1.0.jar:na] 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.tryGet(MemoryEventStoreWithBuffer.java:261) ~[canal.store-1.1.0.jar:na] 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getEvents(CanalServerWithEmbedded.java:478) ~[canal.server-1.1.0.jar:na] 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:310) ~[canal.server-1.1.0.jar:na] 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:273) ~[canal.server-1.1.0.jar:na] 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter.worker(CanalKafkaStarter.java:121) [canal.kafka-1.1.0.jar:na] 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter.access$000(CanalKafkaStarter.java:26) [canal.kafka-1.1.0.jar:na] 	at com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter$1.run(CanalKafkaStarter.java:70) [canal.kafka-1.1.0.jar:na] 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_181] 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_181] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_181] ç‰ˆæœ¬ï¼š1.1.0 spring.xml /default-instance.xml æˆ‘è¿™é‡Œä¹Ÿé‡åˆ°æ— é™NPEé”™è¯¯çš„é—®é¢˜äº†ï¼Œé”™è¯¯çš„å…³é”®æ—¥å¿—è§ä¸Šé¢åŠ ç²—éƒ¨åˆ†ï¼Œcanal server ä¸Šæ¬¡è°ƒè¯•å¥½ä¹‹åï¼Œæœ‰1å‘¨å¤šæ²¡æœ‰ä½¿ç”¨äº†ï¼Œè¿™æ¬¡å¯åŠ¨å°±æŠ¥é”™è¯¯äº†ï¼Œæˆ‘æŠŠzkæ¸…ç©ºåé‡å¯é—®é¢˜ä¾æ—§ at com.alibaba.otter.canal.store.helper.CanalEventUtils.createPosition(CanalEventUtils.java:69) è¿™ä¸ªé”™è¯¯æˆ‘ä¹Ÿçœ‹åˆ°è¿‡ï¼Œä¸è¿‡æ‰¾ä¸åˆ°å¯¹åº”çš„æ—¥å¿—äº† æˆ‘æŠŠæ•°æ®åº“å®ä¾‹ç»™æ¢äº†ä¸€ä¸ªå…¶ä»–çš„æµ‹è¯•åº“ï¼Œæ¸…ç©ºzkï¼Œå¯åŠ¨çš„æ—¶å€™å°±æ²¡æœ‰å‡ºç°è¿™ä¸ªé”™è¯¯äº†ï¼Œç„¶åæˆ‘é‡æ–°æŠŠæ•°æ®åº“å®ä¾‹æ¢åˆ°åŸæ¥å‡ºé—®é¢˜çš„è¿™ä¸ª æŠŠtimestampè®¾ç½®ä¸ºå½“å‰æ—¶é—´(æˆ‘æ€€ç–‘æ˜¯binlogæœ‰é—®é¢˜å¼•èµ·ï¼Œè®¾ç½®å½“å‰æ—¶é—´æ˜¯ä¸ºäº†è·³è¿‡æœ‰é—®é¢˜çš„binlog)ï¼Œå¯åŠ¨åæœç„¶æ²¡æœ‰æŠ¥é”™ï¼Œæˆ‘æƒ³è®©é”™è¯¯å¤ç°ï¼ŒæŠŠtimestampæ”¹å›åˆ°å‡ºé—®é¢˜ä¹‹å‰çš„æ—¶é—´ç‚¹æ¸…ç©ºzkï¼Œä½†æ˜¯é”™è¯¯ä¹Ÿæ²¡æœ‰å†æ¬¡å‡ºç°äº† æˆ‘æ˜¯æƒ³å®šä½å‡ºå¯¼è‡´è¿™ä¸ªNPEé”™è¯¯çš„åŸå› åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œä»¥ååœ¨ç”Ÿäº§ä¸­æ‰èƒ½å¤Ÿé¿å…æˆ–è€…è§£å†³æ‰ è¯·å¤§ä½¬èµæ•™ï¼Œè¿™ä¸ªåˆ°åº•æ˜¯ä»€ä¹ˆé—®é¢˜å•Šï¼Œæˆ‘å¾ˆæ‹…å¿ƒä¸Šçº¿åå‡ºç°é—®é¢˜holdä¸ä½å°±å®Œè›‹äº†ï¼Œæ±‚å¤§ä½¬æŒ‡ç‚¹ï¼ 2018-10-19 03:08:14.957 [pool-4-thread-1] INFO  com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter - ## the canal consumer example is running now ...... 2018-10-19 03:08:14.957 [pool-4-thread-1] ERROR com.alibaba.otter.canal.kafka.producer.CanalKafkaStarter - process error! java.lang.NullPointerException: null   ![image](https://user-images.githubusercontent.com/14846522/47178034-9a082380-d34c-11e8-9b2a-d9079e6c5485.png) æˆ‘çš„ç‰ˆæœ¬æ˜¯ canal.kafka-1.1.0 è¿™æ˜¯ä¸Šé¢çš„æŠ¥é”™ ä½ è¯•ç€ cat canal.properties ä¸è¦å‚è€ƒwiki ä¸Šçš„ï¼Œä½¿ç”¨é»˜è®¤çš„å°±å¥½ï¼Œæˆ‘çš„æ˜¯è¿™æ ·è§£å†³çš„ #canal.instance.global.spring.xml = classpath:spring/memory-instance.xml canal.instance.global.spring.xml = classpath:spring/file-instance.xml #canal.instance.global.spring.xml = classpath:spring/default-instance.xml ![image](https://user-images.githubusercontent.com/14846522/47182391-e311a500-d357-11e8-8d21-929ddd83e007.png) reopened but closed again just because Github was down yesterday which I think is MS 'stealling user's data
867,ä¸€é‡åˆ°mysql è¿›è¡Œå¤§æ‰¹é‡æ“ä½œçš„æ—¶å€™ï¼Œå®¢æˆ·ç«¯å°±ä¼šæŠ¥é”™ com.alibaba.otter.canal.protocol.exception.CanalClientException: java.io.IOException: Broken pipe 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.ack(SimpleCanalConnector.java:339) 	at com.adups.canal.CanalHandler.handler(CanalHandler.java:72) 	at com.adups.canal.CanalClient$2.run(CanalClient.java:52) 	at java.lang.Thread.run(Thread.java:748) Caused by: java.io.IOException: Broken pipe 	at sun.nio.ch.FileDispatcherImpl.write0(Native Method) 	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47) 	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93) 	at sun.nio.ch.IOUtil.write(IOUtil.java:65) 	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471) 	at java.nio.channels.Channels.writeFullyImpl(Channels.java:78) 	at java.nio.channels.Channels.writeFully(Channels.java:98) 	at java.nio.channels.Channels.access$000(Channels.java:61) 	at java.nio.channels.Channels$1.write(Channels.java:174) 	at java.nio.channels.Channels$WritableByteChannelImpl.write(Channels.java:458) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.writeWithHeader(SimpleCanalConnector.java:382) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.writeWithHeader(SimpleCanalConnector.java:369) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.ack(SimpleCanalConnector.java:333) 	... 3 common frames omitted 	 å®¢æˆ·ç«¯å¤„ç†é€Ÿåº¦æ…¢äº†ï¼Œè¶…è¿‡è¶…æ—¶æ—¶é—´äº†ï¼Ÿå‡çº§1.1.0è¯•è¯• æ˜¯ä¸æ˜¯å®¢æˆ·ç«¯ackå¤ªæ…¢äº†ï¼Œå¯¼è‡´è¶…æ—¶æŠ¥é”™ï¼Ÿ
866,canal.deployer-1.1.0ç‰ˆæœ¬ï¼Œå½“ç›‘å¬åˆ°æ•°æ®åº“å˜åŠ¨æ—¶ï¼Œserverç«¯æŠ¥å¼‚å¸¸ï¼Œæœ›å¤§ä½¬æŒ‡æ•™ 2018-08-23 22:52:32.366 [destination = example   address = /106.12.14.74:3306   EventParser] WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - find start position : EntryPosition[included=false journalName=mysql-bin.000004 position=5377 serverId=1 gtid=<null> timestamp=1535008711000] 2018-08-23 22:52:32.582 [destination = example   address = /106.12.14.74:3306   EventParser] ERROR c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - dump address /106.12.14.74:3306 has an error  retrying. caused by  java.lang.IllegalArgumentException: null         at java.util.concurrent.ThreadPoolExecutor.<init>(ThreadPoolExecutor.java:1314) ~[na:1.8.0_181]         at java.util.concurrent.ThreadPoolExecutor.<init>(ThreadPoolExecutor.java:1237) ~[na:1.8.0_181]         at java.util.concurrent.Executors.newFixedThreadPool(Executors.java:151) ~[na:1.8.0_181]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor.start(MysqlMultiStageCoprocessor.java:84) ~[canal.parse-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:238) ~[canal.parse-1.1.0.jar:na]         at java.lang.Thread.run(Thread.java:748) [na:1.8.0_181] 2018-08-23 22:52:32.582 [destination = example   address = /106.12.14.74:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.lang.IllegalArgumentException         at java.util.concurrent.ThreadPoolExecutor.<init>(ThreadPoolExecutor.java:1314)         at java.util.concurrent.ThreadPoolExecutor.<init>(ThreadPoolExecutor.java:1237)         at java.util.concurrent.Executors.newFixedThreadPool(Executors.java:151)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor.start(MysqlMultiStageCoprocessor.java:84)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:238)         at java.lang.Thread.run(Thread.java:748) ] é‡åˆ°åŒæ ·çš„é—®é¢˜äº†ï¼Œä¸çŸ¥é“æ¥¼ä¸»æœ‰æ²¡æœ‰è§£å†³ æˆ‘åˆšæ‰è¿˜åœ¨ç»™å¼€å‘å¤§ä½¬å‘é‚®ä»¶ ä»–è¯´çœ‹çœ‹æ˜¯å¦canal.propertiesé‡Œä¿®æ”¹è¿‡å‚æ•°é…ç½®ã€‚æˆ‘å¹¶æ²¡ä¿®æ”¹ è¿˜åœ¨ç­‰å¾…ä»–å›å¤ã€‚ --- from Dcein. åœ¨2018å¹´8æœˆ23æ—¥ 17:23ï¼Œplatypus0127<notifications@github.com> å†™é“ï¼š é‡åˆ°åŒæ ·çš„é—®é¢˜äº†ï¼Œä¸çŸ¥é“æ¥¼ä¸»æœ‰æ²¡æœ‰è§£å†³ â€” You are receiving this because you authored the thread. Reply to this email directly  view it on GitHub  or mute the thread. é—®ä¸ªé—®é¢˜ï¼Œæ˜¯ä¸æ˜¯åœ¨å•æ ¸ç¯å¢ƒä¸‹è·‘çš„ï¼Œå¯èƒ½æœ‰ä¸ªbugï¼Œç¨åå°±æ”¹ã€‚canal.instance.parser.parallelè®¾æˆfalseå¯ä»¥å…ˆç»•è¿‡å» @lcybo æ„Ÿè°¢å¤§ä½¬ï¼ŒæˆåŠŸäº†ã€‚å¦‚æœå¤šæ ¸ç¯å¢ƒä¸‹è¿™ä¸ªæ˜¯ä¸æ˜¯å°±ä¸ç”¨è®¾ç½®äº†ï¼Ÿ å¤šæ ¸ä¸ç”¨ æ„Ÿè°¢å¤§ä½¬ï¼è†œæ‹œ~ï¼å¦‚æœcanalç›‘è§†å¤šä¸ªmysqlæœåŠ¡å™¨å˜åŒ–ï¼Œæ˜¯ä¸æ˜¯éœ€è¦é…ç½®å¤šä¸ªcanal.instance.standby.address = è¢«ç›‘è§†mysqlåœ°å€ï¼Œè¿˜æ˜¯é…ç½®å¤šä¸ªcanal.instance.master.addresså‘¢ï¼Ÿ åœ¨2018å¹´8æœˆ23æ—¥ 18:20ï¼Œlcybo<notifications@github.com> å†™é“ï¼š å¤šæ ¸ä¸ç”¨ â€” You are receiving this because you authored the thread. Reply to this email directly  view it on GitHub  or mute the thread. å¤§ä½¬ï¼š      ä½ å¥½ï¼ŒçœŸæ˜¯æ‰“æ‰°ä½ äº†ã€‚ğŸ™æœ‰æ—¶é—´éº»çƒ¦å¸®æˆ‘è§£å†³ä¸ªé—®é¢˜ã€‚æˆ‘åœ¨æˆ‘ä»¬linuxä¸­mysqlé…ç½®æ–‡ä»¶å·²å¼€å¯rowæ¨¡å¼ï¼Œè€Œä¸”è®©è¿ç»´å¸ˆä¹Ÿå¼€å¯çš„canalç›¸å…³æ“ä½œæƒé™ï¼Œä½†æ˜¯å¯åŠ¨åæŸ¥æ–°exampleæ—¥å¿—ï¼Œä»ç„¶æŠ¥é”™ï¼Œæç¤ºæ²¡æƒé™ï¼Œéº»çƒ¦å¤§ä½¬ç»™äºˆæŒ‡ç‚¹ã€‚     2018-08-27 18:27:16.849 [destination = example   address = /192.168.100.249:3306   EventParser] WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - prepare to find start position just show master status 2018-08-27 18:27:16.851 [destination = example   address = /192.168.100.249:3306   EventParser] ERROR c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - dump address /192.168.100.249:3306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: command : 'show master status' has an error! pls check. you need (at least one of) the SUPER REPLICATION CLIENT privilege(s) for this operation 2018-08-27 18:27:16.851 [destination = example   address = /192.168.100.249:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: command : 'show master status' has an error! pls check. you need (at least one of) the SUPER REPLICATION CLIENT privilege(s) for this operation ]     å¤šè°¢å¤§ä½¬èµæ•™ï¼ | | Dcein520 | | é‚®ç®±ï¼šDcein520@163.com | ç­¾åç”± ç½‘æ˜“é‚®ç®±å¤§å¸ˆ å®šåˆ¶ åœ¨2018å¹´08æœˆ23æ—¥ 18:26ï¼ŒDcein520 å†™é“ï¼š æ„Ÿè°¢å¤§ä½¬ï¼è†œæ‹œ~ï¼å¦‚æœcanalç›‘è§†å¤šä¸ªmysqlæœåŠ¡å™¨å˜åŒ–ï¼Œæ˜¯ä¸æ˜¯éœ€è¦é…ç½®å¤šä¸ªcanal.instance.standby.address = è¢«ç›‘è§†mysqlåœ°å€ï¼Œè¿˜æ˜¯é…ç½®å¤šä¸ªcanal.instance.master.addresså‘¢ï¼Ÿ åœ¨2018å¹´8æœˆ23æ—¥ 18:20ï¼Œlcybo<notifications@github.com> å†™é“ï¼š å¤šæ ¸ä¸ç”¨ â€” You are receiving this because you authored the thread. Reply to this email directly  view it on GitHub  or mute the thread. you need (at least one of) the SUPER REPLICATION CLIENT privilege(s) for this æ£€æŸ¥mysql grant  > å¤§ä½¬ï¼š ä½ å¥½ï¼ŒçœŸæ˜¯æ‰“æ‰°ä½ äº†ã€‚æœ‰æ—¶é—´éº»çƒ¦å¸®æˆ‘è§£å†³ä¸ªé—®é¢˜ã€‚æˆ‘åœ¨æˆ‘ä»¬linuxä¸­mysqlé…ç½®æ–‡ä»¶å·²å¼€å¯rowæ¨¡å¼ï¼Œè€Œä¸”è®©è¿ç»´å¸ˆä¹Ÿå¼€å¯çš„canalç›¸å…³æ“ä½œæƒé™ï¼Œä½†æ˜¯å¯åŠ¨åæŸ¥æ–°exampleæ—¥å¿—ï¼Œä»ç„¶æŠ¥é”™ï¼Œæç¤ºæ²¡æƒé™ï¼Œéº»çƒ¦å¤§ä½¬ç»™äºˆæŒ‡ç‚¹ã€‚ 2018-08-27 18:27:16.849 [destination = example   address = /192.168.100.249:3306   EventParser] WARN c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - prepare to find start position just show master status 2018-08-27 18:27:16.851 [destination = example   address = /192.168.100.249:3306   EventParser] ERROR c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - dump address /192.168.100.249:3306 has an error  retrying. caused by com.alibaba.otter.canal.parse.exception.CanalParseException: command : 'show master status' has an error! pls check. you need (at least one of) the SUPER REPLICATION CLIENT privilege(s) for this operation 2018-08-27 18:27:16.851 [destination = example   address = /192.168.100.249:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: command : 'show master status' has an error! pls check. you need (at least one of) the SUPER REPLICATION CLIENT privilege(s) for this operation ] å¤šè°¢å¤§ä½¬èµæ•™ï¼ | | Dcein520 | | é‚®ç®±ï¼šDcein520@163.com | ç­¾åç”± ç½‘æ˜“é‚®ç®±å¤§å¸ˆ å®šåˆ¶ åœ¨2018å¹´08æœˆ23æ—¥ 18:26ï¼ŒDcein520 å†™é“ï¼š æ„Ÿè°¢å¤§ä½¬ï¼è†œæ‹œ~ï¼å¦‚æœcanalç›‘è§†å¤šä¸ªmysqlæœåŠ¡å™¨å˜åŒ–ï¼Œæ˜¯ä¸æ˜¯éœ€è¦é…ç½®å¤šä¸ªcanal.instance.standby.address = è¢«ç›‘è§†mysqlåœ°å€ï¼Œè¿˜æ˜¯é…ç½®å¤šä¸ªcanal.instance.master.addresså‘¢ï¼Ÿ åœ¨2018å¹´8æœˆ23æ—¥ 18:20ï¼Œlcybo<notifications@github.com> å†™é“ï¼š å¤šæ ¸ä¸ç”¨ â€” You are receiving this because you authored the thread. Reply to this email directly  view it on GitHub  or mute the thread. å»ºè®®åœ¨example/instance.properties é‡Œé¢ä¿®æ”¹ canal.instance.filter.regex=.*\\..*   åªç›‘æ§è‡ªå·±è¿™ä¸ªinstanceè¦çš„æ•°æ®åº“ã€‚ æˆ‘å‘ç°ç”¨rdsçš„æ—¶å€™å³ä½¿è¶…çº§ç”¨æˆ·ä¹Ÿæç¤ºæƒé™ä¸è¶³ ä¼°è®¡å†…å»ºåº“æƒé™ä¸è¶³ rdsçš„è¶…çº§è´¦å·è¿˜æ˜¯æœ‰å¯¹mysqlåº“çš„éƒ¨åˆ†è¡¨æ— æƒé™ï¼Œéœ€è¦è¿‡æ»¤æ‰mysqlåº“
865,fix #849: HBaseæ•°æ®åŒæ­¥é€‚é… HBaseæ•°æ®åŒæ­¥å¤–éƒ¨é€‚é…å™¨ï¼Œä¼šæ‰“åŒ…åˆ°client-launcherä¸‹ tks 
864,canal-1.1.0 BioSocketChannel Timeout `2018-08-21 05:51:48.895 [destination = zaful   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position  {"identity":{"slaveId":-1 "sourceAddress":{"address":"127.0.0.1" "port":3306}} "postion":{"gtid":"" "included":false "journalName":"binlog.002535" "position":157229530 "serverId":97153 "timestamp":1534833018000}} 2018-08-21 05:51:48.895 [destination = zaful   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - find start position : EntryPosition[included=false journalName=binlog.002535 position=157229530 serverId=97153 gtid= timestamp=1534833018000] 2018-08-21 05:52:36.469 [destination = zaful   address = /127.0.0.1:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - Socket timeout expired  closing connection java.net.SocketTimeoutException: Timeout occurred  failed to read 9471 bytes in 25000 milliseconds. 	at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannel.read(BioSocketChannel.java:123) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:174) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:85) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:206) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:240) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_91] 2018-08-21 05:52:36.470 [destination = zaful   address = /127.0.0.1:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address 127.0.0.1/127.0.0.1:3306 has an error  retrying. **caused by  _### **###  > java.net.SocketTimeoutException: Timeout occurred  failed to read 9471 bytes in 25000 milliseconds **_.** 	at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannel.read(BioSocketChannel.java:123) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:174) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:85) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:206) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:240) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_91] 2018-08-21 05:52:36.470 [destination = zaful   address = /127.0.0.1:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:zaful[java.net.SocketTimeoutException: Timeout occurred  failed to read 9471 bytes in 25000 milliseconds. 	at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannel.read(BioSocketChannel.java:123) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:174) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:85) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:206) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:240) 	at java.lang.Thread.run(Thread.java:745) ]` ç¨‹åºå¯åŠ¨ è¿è¡Œä¸€æ®µæ—¶é—´åï¼Œå°±ä¸€ç›´æŠ¥è¿™ä¸ªé”™ï¼æ¯æ¬¡fetchè¶…æ—¶åï¼Œå°±ä¼škillæ‰å’ŒMysqlçš„connectionï¼Œç„¶ååˆé‡è¯•ï¼Œæ¥ç€åˆè¶…æ—¶ï¼Œä¸€ç›´è¿™æ ·å­æ­»å¾ªç¯ï¼Œé‡å¯ä¹Ÿæ²¡æœ‰ç”¨ï¼Œä½†æ˜¯åˆ é™¤æ‰meta.datåï¼Œèƒ½å¤Ÿæ­£å¸¸è¿è¡Œä¸€æ®µæ—¶é—´ï¼Œä¹‹ååˆä¼šæŠ¥è¶…æ—¶çš„é”™è¯¯ã€‚ å®åœ¨ä¸èƒ½ç†è§£åœ¨æœ‰å¾ˆå¤šbinlogæ–‡ä»¶æ²¡æœ‰æ¶ˆè´¹çš„æƒ…å†µä¸‹ï¼Œä¸ºä»€ä¹ˆè¯»å‡ kbæ•°æ®èŠ±25séƒ½è¯»ä¸å®Œï¼ï¼ æœ‰é‡åˆ°ç›¸åŒé—®é¢˜çš„åŒä»å—ï¼Ÿ  æ¢1.1.0ç‰ˆæœ¬è¯•è¯• @fangchunsheng ï¼Œå¦‚æœä½ çš„ç¯å¢ƒèƒ½ç»å¸¸reproduceï¼Œå»ºè®®åœ¨   BioSocketChannel.read(BioSocketChannel.java:123) é‡Œé¢debugä¸‹ï¼Œæ˜¯ä¸æ˜¯ input.read(data  off + n  len - n); è¿™ä¸ªè°ƒç”¨çœŸçš„timeoutäº†ã€‚ PS: çœ‹äº†ä¸‹openjdkå®ç°ï¼Œtimeouté€šè¿‡pollæˆ–selectæŸ¥çœ‹è¿”å›å€¼æ˜¯å¦>0ã€‚å› æ­¤å°±ç®—åªèƒ½è¯»åˆ°1ä¸ªbyteï¼Œéƒ½ä¸ç®—è¶…æ—¶ã€‚ @agapple  ä¸å¥½æ„æ€  ç¬”è¯¯å†™æˆäº†2.1.1 å®é™…ç”¨çš„å°±æ˜¯1.1.0ï¼Œä½†æ˜¯æˆ‘æ¢åˆ°1.0.25å°±ä¸ä¼šå­˜åœ¨æœ‰è¿™ç§æƒ…å†µ @lcybo  ok æˆ‘è¯•ä¸€ä¸‹  ä¸è¿‡æˆ‘ä»¬çº¿ä¸Šç”¨çš„ä¸æ˜¯openjdkå“ˆ è°¢è°¢ æˆ‘è¿™é‡Œè¯»4ä¸ªbyteéƒ½ä¼štimeoutï¼Œå¯åŠ¨exampleä¹Ÿä¼šæŠ¥è¿™ä¸ªé”™ java.net.SocketTimeoutException: Timeout occurred  failed to read 4 bytes in 25000 milliseconds.         at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannel.read(BioSocketChannel.java:123) ~[canal.parse.driver-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:174) ~[canal.parse-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:77) ~[canal.parse-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:213) [canal.parse-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:248) [canal.parse-1.1.0.jar:na]         at java.lang.Thread.run(Thread.java:748) [na:1.7.0_191] 2018-08-22 05:24:35.190 [destination = centos1   address = /127.0.0.1:3306   EventParser] ERROR c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - dump address /127.0.0.1:3306 has an error  retrying. caused by  java.net.SocketTimeoutException: Timeout occurred  failed to read 4 bytes in 25000 milliseconds.         at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannel.read(BioSocketChannel.java:123) ~[canal.parse.driver-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:174) ~[canal.parse-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:77) ~[canal.parse-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:213) ~[canal.parse-1.1.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:248) ~[canal.parse-1.1.0.jar:na]         at java.lang.Thread.run(Thread.java:748) [na:1.7.0_191] 2018-08-22 05:24:35.194 [destination = centos1   address = /127.0.0.1:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:centos1[java.net.SocketTimeoutException: Timeout occurred  failed to read 4 bytes in 25000 milliseconds.         at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannel.read(BioSocketChannel.java:123)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:174)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:77)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:213)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:248)         at java.lang.Thread.run(Thread.java:748) @nerverbe  æ˜¯çš„ æˆ‘è¿™è¾¹ä¹Ÿä¼šæœ‰è¿™ç§æƒ…å†µ å°±æ˜¯4ä¸ªå­—èŠ‚ä¹Ÿä¼šæŠ¥é”™ï¼Œæˆ‘çœ‹äº†ä¸‹ä»£ç ï¼Œåº”è¯¥æ˜¯è¯»ä»–çš„åè®®çš„headçš„æ—¶å€™ä¼šæ˜¯4ä¸ªå­—èŠ‚ã€‚æˆ‘è¿˜è¯•è¿‡æŠŠ25000msæ”¹æˆ75000msè¿‡ï¼Œä½†æ˜¯ä¸€æ ·çš„æŠ¥é”™ å¦‚æœç¡®è®¤socketInputStreamçš„readè°ƒç”¨æœ‰timeoutï¼Œå¯ä»¥è€ƒè™‘ä¸‹ç½‘ç»œé—®é¢˜ã€‚ æŸ¥çœ‹dump connectionç”¨çš„ç½‘å¡æœ‰æ— æŒ¤å çš„æƒ…å†µã€‚ @lcybo  æˆ‘ç”¨canal-1.1.0 é‡Œé¢çš„dumpçš„æµ‹è¯•ç”¨ä¾‹å»åˆ°çº¿ä¸Šå»è·‘è¿‡ï¼Œç”¨ç›¸åŒçš„binglogæ–‡ä»¶ï¼Œç„¶åç›¸åŒçš„position è·‘çš„æ—¶å€™å®Œå…¨æ²¡æœ‰é—®é¢˜ï¼Œæ‰€ä»¥åº”è¯¥ä¸æ˜¯ç½‘ç»œåŸå›  @fangchunsheng ä½ è¯´çš„æµ‹è¯•ç”¨ä¾‹æ˜¯MysqlDumpTestå—ï¼Ÿ æµ‹è¯•ç”¨ä¾‹é‡Œçš„MysqlEventParseræ˜¯çº¿ä¸Šä½¿ç”¨çš„parserï¼Œç”¨çš„socketChannelå…¶å®ä¹Ÿæ˜¯ä¸€è‡´çš„ã€‚ çœ‹æ¥ä¹Ÿè¦è€ƒè™‘ä¸‹MysqlEventParserå¤–çš„å› ç´ ï¼Œ @agapple ã€‚
863,åœ¨ç¨‹åºä¸­è®¾ç½®master positionæŠ¥é”™ã€‚ æˆ‘æ˜¯ç›´æ¥extends MysqlEventParser ```java  /**    * æŸ¥è¯¢å½“å‰çš„binlogä½ç½®    * @param mysqlConnection    * @return    */   private EntryPosition findEndPosition(MysqlConnection mysqlConnection) {     try {   // ... EntryPosition endPosition = new EntryPosition(           "my-bin.000001"  Long.valueOf(1L));       return endPosition; ``` è¿è¡Œç›´æ¥æŠ¥é”™ ```cmd 18:06:43.222 [destination = example   address = /117.107.241.79:3306   EventParser] INFO  c.a.o.c.p.d.mysql.MysqlConnector - KILL DUMP 1110 failure java.io.IOException: ErrorPacket [errorNumber=1094  fieldCount=-1  message=Unknown thread id: 1110  sqlState=HY000  sqlStateMarker=#]  with command: KILL CONNECTION 1110 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlUpdateExecutor.update(MysqlUpdateExecutor.java:49) ~[classes/:na] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.disconnect(MysqlConnector.java:107) ~[classes/:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.disconnect(MysqlConnection.java:93) [classes/:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:309) [classes/:na] ``` æ˜¯æˆ‘å¤ªlowäº†ï¼Œåº”è¯¥æ˜¯ä»4Lï¼Œå¼€å§‹ã€‚
862,kafka ç‰ˆæœ¬wikié…ç½®è¯´æ˜ä¸è¯¦ canal_kafkaçš„deployç‰ˆæœ¬ï¼ŒæŒ‰ç…§wikié…ç½®æ–¹æ³•ï¼Œé…ç½®kafka.xmlï¼Œå…¶ä»–çš„å‚è€ƒcanalç‹¬ç«‹é…ç½®ï¼Œkafka consoleæ¶ˆè´¹æ²¡æœ‰è¾“å‡ºï¼Œcanalè¿™è¾¹ä¹Ÿæ²¡æœ‰æ—¥å¿—åé¦ˆï¼Œæœ‰éœ€è¦ç‰¹åˆ«çš„é…ç½®å— canal_serverä¸æ˜¯ç›´æ¥ä»deployæ¨¡å—ä¸‹çš„target/canal/biné‡Œå¯åŠ¨çš„ï¼Œè€Œæ˜¯ä»kafkaæ¨¡å—ä¸‹çš„target/canal/binä¸‹å¯åŠ¨ï¼Œå¯åŠ¨serveråå…ˆè§‚å¯Ÿæœ‰æ²¡æœ‰å¾€kafkaå‘é€æ•°æ® releaseé‡Œé¢çš„ï¼Œåˆšçœ‹äº†ï¼Œæ–‡ä»¶ç›®å½•éƒ½æ˜¯ä¸€æ ·çš„ã€‚canalå¯åŠ¨çš„æ—¶å€™æœ‰kafka workers is running now  å°±æ˜¯ä¸ä¼šè¾“å‡ºåˆ°kafka clientçœ‹ä¸åˆ°æ•°æ® åŒé—®ï¼Œæ€ä¹ˆè§£å†³ï¼Œä¹Ÿä¸æŠ¥é”™ï¼Œä¹Ÿæ²¡æœ‰æ—¥å¿—è¾“å‡ºï¼Œkafkaå°±æ˜¯æ¶ˆè´¹ä¸åˆ°æ•°æ® å‚è€ƒæ–‡æ¡£ï¼šhttps://github.com/alibaba/canal/wiki/Canal-Kafka-RocketMQ-QuickStart å¦‚æœ‰æ–‡æ¡£ä¸æ˜ç¡®ï¼Œå¯ä»¥ä¿®æ”¹å’Œåé¦ˆ
861,Client QPSæŒ‡æ ‡çš„datasourceé…ç½®é¡¹ç”±"Prometheus"æ”¹ä¸ºå–$datasourceå‚æ•° å‡çº§Canalåˆ°1.1.0åé…ç½®äº†ç›‘æ§ï¼Œåœ¨Grafanaçš„ç›‘æ§é¡µé¢ä¸­å‘ç°åä¸º"Client QPS"çš„panelä¸å¯ç”¨ï¼ŒåŸå› åœ¨äº"Canal instances"é¢æ¿çš„é…ç½®æ–‡ä»¶Canal_instances_tmpl.jsonä¸­ï¼Œåä¸º"Client QPS"çš„panelçš„"datasource"é…ç½®é¡¹å†™æˆäº†å›ºå®šå€¼"Prometheus"ï¼Œä¿®æ”¹ä¸ºå–"$datasource"å‚æ•°åï¼Œpanelå°±å¯ä»¥æ­£å¸¸æ˜¾ç¤ºäº† [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=861) <br/>All committers have signed the CLA. [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=861) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=861) before we can accept your contribution.<br/><hr/>**lixiang** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=861) it.</sub> å¤šè°¢
860,é›†ç¾¤æ¨¡å¼ä¸‹å¦‚ä½•å…±äº«zk?canal clientç«¯åˆ å¦‚ä½•æŒ‡å®šzkå‘¢? æœ‰ç¯‡æ–‡ç« æ˜¯æä¾›äº†ä¸‹é¢çš„æ–¹æ³•: ##Productionåœºæ™¯ï¼ŒHAæ¨¡å¼ä¸‹ï¼Œæ¯”å¦‚ä½¿ç”¨ZKä½œä¸ºæœåŠ¡ç®¡ç†ï¼Œæ­¤å¤„è‡³å°‘æŒ‡å®šâ€œå¤šæ•°æ´¾ZK Nodeâ€çš„IPåˆ—è¡¨   ##å¦‚æœä½ çš„å¤šä¸ªCanal Clusterå…±äº«ZKï¼Œé‚£ä¹ˆæ¯ä¸ªCanalè¿˜éœ€è¦ä½¿ç”¨å”¯ä¸€çš„â€œrootpathâ€ã€‚   canal.zkServers = 10.0.1.21:2818 10.0.1.22 10.0.2.21:2818/canal/g1  æˆ‘æœ¬æœºæµ‹è¯• canal.zkServers = localhost:2181/canal/g1 å¯åŠ¨å°±ç›´æ¥æŠ¥é”™äº† Something goes wrong when starting up the canal Server: java.lang.IllegalArgumentException: Path length must be > 0 å¦‚æœåŸç”Ÿä¸æ”¯æŒï¼Œæ˜¯å¦å°±åªæœ‰é€šè¿‡éƒ¨ç½²å¤šå¥—zkæ¥éš”ç¦»å¤šä¸ªcanal server é›†ç¾¤å‘¢ï¼Ÿ  /canal/g1 è¿™ä¸ªä¸è¦å¸¦ æˆ‘ä¹Ÿé‡åˆ°è¿™ä¸ªé—®é¢˜  ç°åœ¨çš„è®¾è®¡è²Œä¼¼åªèƒ½ä¸€å¥—zkæ”¯æŒä¸€å¥—canal server HAé›†ç¾¤  åŒä¸€å¥—canal serveråœ¨zkçš„æ³¨å†Œè·¯å¾„ä¸èƒ½ä¿®æ”¹å—? canalæœ¬èº«å°±æ”¯æŒé›†ç¾¤æ¨¡å¼ï¼Œåœ¨A canal server å¯åŠ¨å®Œæˆåä¼šåœ¨zkçš„destinationçš„runningæœ‰è¯¥èŠ‚ç‚¹çš„ä¿¡æ¯ï¼ŒB canal serverå¯åŠ¨åï¼Œå¦‚æœæ˜¯è·ŸA canal serverçš„destinationæœ‰ç›¸åŒçš„åç§°çš„ï¼Œä¼šåœ¨zkçš„destinationç›®å½•çš„clusteré‡Œé¢æœ‰è¯¥èŠ‚ç‚¹çš„ä¿¡æ¯ï¼Œå› ä¸ºAå·²ç»runningä¸­äº†ï¼Œæ‰€ä»¥è¿™ä¸ªèŠ‚ç‚¹æ˜¯ä¸ä¼šæ‹‰å–binlogçš„ï¼Œåªæœ‰å½“A canal server æŒ‚äº†åï¼Œä¼šç”±ZKé€šçŸ¥Bå»è·å–binlogï¼Œrunningä¿¡æ¯å˜ä¸ºB canal serverï¼Œclusteré‡Œé¢Açš„ä¿¡æ¯ä¹Ÿä¼šæ²¡äº† clientç«¯ç›´ç®¡è¿æ¥å¯¹åº”çš„destinationçš„zkå’Œdestination nameå³å¯ï¼Œå½“æœ‰å¤šä¸ªclientæ—¶ä¹Ÿæ˜¯é€šè¿‡zkè°ƒåº¦å®ç°HAçš„ é—®é¢˜å·²ç»è§£å†³äº†ï¼Œä¹‹å‰é—®è¿™ä¸ªé—®é¢˜å±äºå¯¹canalä¸ç†Ÿæ‚‰å¼•èµ· 
859,èƒ½æä¾›äº›1.1.0çš„ç›¸å…³çš„å†…éƒ¨è®¾è®¡æ–‡æ¡£å—ï¼Ÿ èƒ½æä¾›äº›1.1.0çš„ç›¸å…³çš„å†…éƒ¨è®¾è®¡æ–‡æ¡£å—ï¼Ÿ éƒ½åœ¨wikié‡Œäº† wikié‡Œçš„è²Œä¼¼æ¯”è¾ƒæ—§ï¼Œ æ²¡æœ‰1.1.0çš„ å¦‚prometheus. https://github.com/alibaba/canal/wiki   è¿™é‡Œ æ”¶åˆ°å¤šè°¢
858,åœ¨1.1.0ä¸­ï¼ŒLogEventConvert.javaä¸­çš„tableMetaCacheå±æ€§æ˜¯nullã€‚ tableMetaCacheæ˜¯ä»€ä¹ˆæ—¶å€™ï¼Œåˆå§‹åŒ–çš„å‘¢ï¼Ÿ å…·ä½“å¤ç°çš„åŠæ³•?  è¿˜æœ‰ä½ æ˜¯è‡ªå·±æ”¹é€ è¿‡ä»£ç ä¹ˆ?  æ˜¯æ”¹åˆ°è¿‡ä»£ç ã€‚ ç›´æ¥ç»§æ‰¿ ```java extends MysqlEventParser ``` å¤šè°¢ï¼Œè¿™æ ·tableMetaCacheå°±åˆå§‹åŒ–äº†
857,æ–°å¢client-launcheræ¨¡å—ï¼Œå¤–éƒ¨æ•°æ®è½åœ°é€‚é…å™¨çš„æ€»å…¥å£ å¤–éƒ¨æ•°æ®è½åœ°é€‚é…å™¨çš„æ€»å…¥å£ï¼Œåç»­å¯é€‚é…HBaseå’ŒESçš„æ•°æ®åŒæ­¥
856,ErrotCode:400 canal 1.0.26-SNAPSHOT-2 2018-08-20 09:46:27.050 [New I/O server worker #1-1] ERROR com.alibaba.otter.canal.server.netty.NettyUtils - ErrotCode:400   Caused by :  something goes wrong with channel:[id: 0x2ae8ccbc  /10.31.152.38:34114 => /10.31.152.38:11111]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: ack error   clientId:1001 batchId:36171 is not exist   please check 2018-08-20 09:48:12.626 [New I/O server worker #1-3] ERROR com.alibaba.otter.canal.server.netty.NettyUtils - ErrotCode:400   Caused by :  something goes wrong with channel:[id: 0x568191e2  /10.31.152.38:34184 => /10.31.152.38:11111]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: ack error   clientId:1001 batchId:36172 is not exist   please check 2018-08-20 09:50:13.754 [New I/O server worker #1-1] ERROR com.alibaba.otter.canal.server.netty.NettyUtils - ErrotCode:400   Caused by :  something goes wrong with channel:[id: 0x4176eecb  /10.31.152.38:34258 => /10.31.152.38:11111]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: ack error   clientId:1001 batchId:36173 is not exist   please check 2018-08-20 09:52:11.962 [New I/O server worker #1-3] ERROR com.alibaba.otter.canal.server.netty.NettyUtils - ErrotCode:400   Caused by :  something goes wrong with channel:[id: 0x49e5e3d0  /10.31.152.38:34332 => /10.31.152.38:11111]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: ack error   clientId:1001 batchId:36174 is not exist   please check 2018-08-20 09:54:03.646 [New I/O server worker #1-1] ERROR com.alibaba.otter.canal.server.netty.NettyUtils - ErrotCode:400   Caused by :  something goes wrong with channel:[id: 0x74b1d81d  /10.31.152.38:34400 => /10.31.152.38:11111]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: ack error   clientId:1001 batchId:36175 is not exist   please check 2018-08-20 09:55:57.774 [New I/O server worker #1-3] ERROR com.alibaba.otter.canal.server.netty.NettyUtils - ErrotCode:400   Caused by :  something goes wrong with channel:[id: 0x2b72e577  /10.31.152.38:34460 => /10.31.152.38:11111]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: ack error   clientId:1001 batchId:36176 is not exist   please check 2018-08-20 09:57:52.922 [New I/O server worker #1-1] ERROR com.alibaba.otter.canal.server.netty.NettyUtils - ErrotCode:400   Caused by :  something goes wrong with channel:[id: 0x61134480  /10.31.152.38:34530 => /10.31.152.38:11111]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: ack error   clientId:1001 batchId:36177 is not exist   please check serverç«¯instanceè‚¯å®šæ˜¯æœ‰rollbackæˆ–è€…é‡å¯çš„è¡Œä¸ºï¼ŒæŒ‰ç…§exampleå·¥ç¨‹é‡æ–°subscibe/get/ack
855,Remove TPS(events) in tmpl. å±•ç¤ºå±‚å…ˆå»æ‰TPS(events)ã€‚
854,æ ¹æ®commentsçš„æ”¹è¿› è¯¥è¿›åŸºæœ¬ä¸Šä¸commentsä¸€è‡´ï¼Œæœ‰ä¸€ä¸ªä¸åŒï¼š delayåˆ†ä¸ºï¼šmaster  put  get  ackï¼Œä»”ç»†è€ƒè™‘äº†ä¸€ä¸‹ï¼Œè¿˜æ˜¯ä¿ç•™äº†masterï¼ˆserverä¸mysql masterï¼‰çš„delayã€‚ master delayä¸ put  get  ackçš„ä¸»è¦åŒºåˆ«åœ¨äºï¼š master delayä¸“æ³¨äºserverä¸mysqlï¼Œå½“mysqlå¤„äºidleçŠ¶æ€æ—¶ï¼ˆæ— delta binlogï¼‰ä¹Ÿå¯ä»¥é€šè¿‡heartbeatåˆ·æ–°delayï¼›è€Œput  get  ackå°¤å…¶æ˜¯åä¸¤è€…ï¼Œåå‘äºclient delayã€‚ æ–‡æ¡£ç¨åæ›´æ–°ã€‚ æˆ‘ç†è§£ä¸€ä¸‹master delay ä¸»è¦æ˜¯æŒ‡æœ€åä¸€æ¬¡æ¥æ”¶binlogå’Œå½“å‰æ—¶é—´çš„å·®å€¼ä¹ˆ? é’ˆå¯¹æ— binlogæ—¶ é€šè¿‡heartbeatæ¥æ›´æ–°æœ€åä¸€æ¬¡æ¥æ”¶æ•°æ®çš„æ—¶é—´æˆ³ ? "expr": "rate(canal_instance_store_consume_seq{destination=~\"$destination\"}[2m])" è¿™ä¸ªbinlog eventsçš„TPSè®¡ç®—  å…¶å®æ˜¯ä»¥æˆ‘ä»¬å¯¹è¿›å…¥eventStoreçš„binlogè®¡æ•°  å¹¶ä¸æ˜¯åŸå§‹mysqlçš„binlogè®¡æ•°.   ä¸¾ä¸ªä¾‹å­æ¥è¯´: mysqlçš„DMLéƒ½ä¼šæœ‰ä¸€ä¸ªTableLogEvent +WriteLogEventä¸¤æ¡  ä½†è¿™ä¸ªconsume_seqåªä¼šè®°å½•WriteLogEventä¸€æ¡ 1. master delayï¼Œå¯¹çš„ã€‚é€šè¿‡ç›®å‰15sä¸€æ¬¡çš„master heartbeatã€‚ 2. æˆ‘ç†è§£ä¸‹ï¼ŒTableLogEventæ˜¯table mapå…ƒæ•°æ®å§ã€‚é‚£è¿™ä¸ªTPS(events)çœ‹æ¥æ„ä¹‰ä¸å¤§ï¼Œæˆ‘æŠŠä»–å»äº†ï¼Œthxã€‚
853,ä¿®å¤å¯åŠ¨æ—¶ï¼Œæ²¡è¯»åˆ°å¸¦execTimeæ—¶ï¼Œå‡ºç°48å¹´delayã€‚ 1. ä¿®å¤bug 2. å¢åŠ template 3. æ›´æ–°ä¸€äº›å›¾
852,canalè§£æåˆ°çš„å­—æ®µå’Œå€¼ä¸åŒ¹é…ï¼Œå¤§ä½¬ç»™çœ‹çœ‹å‘— ![image](https://user-images.githubusercontent.com/18712087/44260217-51e25d00-a246-11e8-9622-32655791da82.png) è¿™ä¸€è¡Œå–åˆ°çš„rowchange é‡Œè¾¹å¯ä»¥çœ‹åˆ°è§£æåˆ°çš„å­—æ®µ å’Œå€¼ ä¸åŸåº“çš„ä¸ç¬¦ï¼Œç”šè‡³ç±»å‹éƒ½ä¸å¯¹ï¼ŒåŸåº“int  è§£æåæ˜¯dateäº† æ˜¯ä¸æ˜¯å‘ç”Ÿddlå˜æ›´äº†? @wingerx   æ¯”å¦‚è¯´ åŸè¡¨ æœ‰ä¸€æ¡insertï¼Œä½†æ˜¯canalæ²¡æœ‰æ¶ˆè´¹ï¼Œå¦‚æœåŸè¡¨åˆåšäº†ddlï¼Œé‚£ä¹ˆcanalå†æ¶ˆè´¹ä¹‹å‰çš„æ•°æ®å°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µä¹ˆ æ˜¯çš„ï¼Œè¿™ç§æƒ…å†µå¯ä»¥å¼€å¯tsdbæ¥é¿å…åé¢ç±»ä¼¼çš„é—®é¢˜ï¼Œå½“å‰åªèƒ½è·³è¿‡äº† . tsdbæ˜¯æŒ‡ä»€ä¹ˆå‘¢ã€‚ã€‚ä¸äº†è§£ @wingerx  ä¹‹å‰æˆ‘è®°å¾—ä¹Ÿæœ‰è¿™ç§æƒ…å†µå•Šã€‚æ”¹äº†è¡¨ç»“æ„çš„ã€‚ã€‚ä¹Ÿæ²¡å‡ºç°è¿‡è¿™ä¸ªé—®é¢˜
851,canal sever-client heartbeat Serverç«¯çš„Idleæ£€æµ‹ï¼Œåªæ˜¯æ£€æµ‹Socketè¯»å†™é€šé“çš„é˜»å¡æ—¶é—´ Clientä¸Serverè®¢é˜…å…³ç³»å»ºç«‹åï¼ŒCanalConnectoræ²¡æœ‰æä¾›çº¯ç²¹çš„å¿ƒè·³æ£€æµ‹æ–¹æ³•ï¼Œåªèƒ½å‘Serverç«¯åªèƒ½å‘é€getè¯·æ±‚æ‰èƒ½è¯æ˜è‡ªå·±æ´»ç€ï¼Œå¦‚æœæ¶ˆè´¹é€Ÿåº¦è¿‡æ…¢ï¼Œè¶…æ—¶å°±ä¼šè¢«Serverç«¯å…³é—­Socketè¿æ¥ã€‚ å¯å¦å¢åŠ ä¸€ä¸ªå•çº¯çš„å¿ƒè·³æ£€æµ‹å®ç°ï¼Ÿ çŸ­æœŸå†…å…ˆè°ƒå¤§è¶…æ—¶æ—¶é—´å§
850,alterè¯­å¥æ— æ³•è§£æ æ­£å¸¸çš„mysql alterè¯­å¥ï¼Œserverç«¯è§£æå‡ºé”™ã€‚ æ— æ³•è·³è¿‡ï¼Œç›®å‰æƒ³åˆ°çš„æš‚æ—¶è§£å†³åŠæ³•æ˜¯æ‰‹åŠ¨åœ¨ç›®æ ‡åº“æ‰§è¡Œï¼Œç„¶åæŠŠoffsetå¾€åç§»ã€‚ 2018-08-14 16:53:22.500 [destination =xxxx   address = /xxxx   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : ALTER TABLE `loan_withdraw_record` ADD COLUMN `remark` varchar(255) DEFAULT NULL COMMENT 'å¤‡æ³¨ä¿¡æ¯' AFTER `is_remind_limit` ALGORITHM=inplace LOCK=NONE com.alibaba.fastsql.sql.parser.ParserException: syntax error  expect TABLES or TABLE  actual EQ  pos 143  line 1  column 143  token =         at com.alibaba.fastsql.sql.dialect.mysql.parser.MySqlStatementParser.parseStatementListDialect(MySqlStatementParser.java:863) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371]         at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:483) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371]         at com.alibaba.fastsql.sql.SQLUtils.parseStatements(SQLUtils.java:500) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371]         at com.alibaba.fastsql.sql.repository.SchemaRepository.console(SchemaRepository.java:412) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:72) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.apply(DatabaseTableMeta.java:104) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.apply(TableMetaCache.java:228) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseQueryEvent(LogEventConvert.java:265) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:126) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:68) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:345) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:187) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:154) [canal.parse-1.0.26-SNAPSHOT.jar:na] SHTERM: session timeoutotter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.8.0_51] fastsqlè§£æçš„é—®é¢˜
849,canalæ”¯æŒä¸€ä¸‹åŒæ­¥åˆ°hbase ç›®å‰hbaseä½œä¸ºå¤§æ•°æ®é¢†åŸŸæ¯”è¾ƒå¹¿æ³›çš„æ–¹æ¡ˆä¹‹ä¸€ï¼ŒæœŸæœ›èƒ½æä¾›ä¸€ä¸ªåŸºäºcanalå¢é‡åŒæ­¥åˆ°hbaseçš„èƒ½åŠ›
847,æˆ‘åœ¨å¼€å¯serveråï¼ŒæŠ¥ä¸€ä¸ª dump address /127.0.0.1:3306 has an error ï¼Œè¿™ä¸ªæ˜¯ä»€ä¹ˆåŸå› å•Š     [destination = example   address = /127.0.0.1:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /127.0.0.1:3306 has an error  retrying. caused by  java.lang.IllegalArgumentException: null 	at java.util.concurrent.ThreadPoolExecutor.<init>(ThreadPoolExecutor.java:1314) ~[na:1.8.0_144] 	at java.util.concurrent.ThreadPoolExecutor.<init>(ThreadPoolExecutor.java:1237) ~[na:1.8.0_144] 	at java.util.concurrent.Executors.newFixedThreadPool(Executors.java:151) ~[na:1.8.0_144] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor.start(MysqlMultiStageCoprocessor.java:84) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:230) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_144] 2018-08-16 12:21:45.933 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.lang.IllegalArgumentException 	at java.util.concurrent.ThreadPoolExecutor.<init>(ThreadPoolExecutor.java:1314) 	at java.util.concurrent.ThreadPoolExecutor.<init>(ThreadPoolExecutor.java:1237) 	at java.util.concurrent.Executors.newFixedThreadPool(Executors.java:151) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor.start(MysqlMultiStageCoprocessor.java:84) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:230) 	at java.lang.Thread.run(Thread.java:748) æ˜¯1.0.26 alphaçš„é‚£ä¸ªç‰ˆæœ¬çš„é”™è¯¯ï¼Ÿ æ˜¯è¿™ä¸ªç‰ˆæœ¬ã€‚ alphaå¥½å‡ ä¸ªç‰ˆæœ¬ï¼Œalpha3è¿˜æ˜¯alpha5ï¼Ÿä¸è¦ä½¿ç”¨alpha4ï¼Œalpha4æœ‰é—®é¢˜ alpha5 è¿™ä¸ªç‰ˆæœ¬æŠ¥çš„é”™è¯¯ã€‚ alpha5 é‡åˆ°åŒæ ·çš„é—®é¢˜ canal.instance.parser.parallelThreadSize éœ€è¦è®¾ç½® ä½ å½“æ—¶canal.instance.parser.parallelThreadSize è¿™ä¸ªå‚æ•°æ˜¯é…ç½®æˆä¸ºå¤šå°‘çš„ï¼Ÿ æˆ‘ç”¨é»˜è®¤çš„å€¼ï¼ŒåŸé…ç½®æ–‡æ¡£è¿™è¡Œæ³¨é‡Šæ‰çš„ ä¹Ÿé‡åˆ°æ­¤é—®é¢˜ï¼Œæ±‚å¸®åŠ© æœ€æ–°çš„1.1.1ç‰ˆæœ¬å·²è§£å†³
846,[v1.0.26-alpha5]å®¢æˆ·ç«¯å¶å°”é¢‘å‘æŠ¥é”™ï¼šno alive canal server com.alibaba.otter.canal.protocol.exception.CanalClientException:no alive canal server  at com.alibaba.otter.canal.client.impl.ClusterNodeAccessStrategy.nextNode(ClusterNodeAccessStrategy.java:76)~ å®¢æˆ·ç«¯å¶å°”é¢‘å‘æŠ¥ä»¥ä¸Šé”™è¯¯ åœ¨Zookeeperä¸­æ£€æŸ¥ get /otter/canal/destinations/example/running {"active":true "address":"xxx.xxx.xxx.xxx" "cid":1} æœåŠ¡ç«¯æ²¡æœ‰æŠ¥é”™ä¹Ÿæ˜¯æ­£å¸¸çš„ï¼Œä½†å®¢æˆ·ç«¯ä¼šé¢‘å‘æŠ¥é”™ å¦‚æœclientè‡ªæˆ‘æ¢å¤çš„è¯  æ£€æŸ¥ä¸€ä¸‹å½“æ—¶canal serveræ˜¯å¦å‘ç”Ÿè¿‡åˆ‡æ¢æˆ–è€…é€€å‡º?  @agapple æ€ä¹ˆæ£€æŸ¥canal serverå‘¢ï¼Ÿ @agapple   åœ¨Zookeeperä¸­æ£€æŸ¥ get /otter/canal/destinations/example/running ç»“æœï¼š Node does not exist : /otter/canal/destinations/example/running get /otter/canal/destinations/sample/running ç»“æœï¼š Node does not exist : /otter/canal/destinations/sample/running è¿™ç§æƒ…å†µé¢‘ç‡æœ‰äº›å¤šï¼Œè™½ç„¶å¯ä»¥é‡è¯•æˆåŠŸï¼Œä½†å‡ºç°è¿™ç§é—®é¢˜æ˜¯ä¸æ˜¯canal serveræœ‰é—®é¢˜å•Š ç›®å‰åœºæ™¯ï¼š ä¸¤ä¸ªå®ä¾‹exampleã€sampleï¼Œä¸¤ä¸ªå®ä¾‹ä¸­é…ç½®ä¸€æ¨¡ä¸€æ · canal.deployerä¸­logæ—¥å¿—ä¸­å¹¶æ²¡æœ‰æŠ¥é”™ï¼Œåªæ˜¯Zookeeperä¸­æ£€æŸ¥ä¸åˆ°èŠ‚ç‚¹ä¿¡æ¯ å‡ºç°no alive canal serverï¼Œè‚¯å®šæ˜¯canal serveræœ‰é€€å‡ºçš„è¡Œä¸ºï¼Œéœ€è¦æ£€æŸ¥serverçš„æ—¥å¿—
845,Add header size for each packet. clientæµé‡è¡¥ä¸ŠåŒ…å¤´é•¿åº¦ï¼ŒMDç›´æ¥æ”¾åˆ°wikiã€‚
844,åŠ ä¸Š if (logger.isDebugEnabled()) é˜²æ­¢message.toStringæ¯æ¬¡éƒ½ä¼šè¢«è¿è¡Œï¼Œmessageè¿‡å¤§ä¼šå¡cpu tks é‚®ä»¶èƒ½è”ç³»æˆ‘ä¸€ä¸‹ jianghang115@gmail.com   é‚€è¯·ä½ åŠ å…¥canal Collaborators   ä¸€èµ·å…±å»º @rewerma 
843,canal + rocksmq èƒ½ç¡®ä¿æ•°æ®ä¸ä¸¢å¤±ä¹ˆï¼Ÿ  å¦‚æœcanalæŠŠæ•°æ®æ¨é€åˆ°rocksmqåï¼Œrmqå´©æºƒï¼Œå¦å¤–mqæ²¡æœ‰åŠæ—¶flushè½ç›˜ï¼Œæ•°æ®ä¸¢å¤±ï¼Ÿ  canal + rocksmqæ˜¯å¦æœ‰ä¸¢å¤±binlogçš„å¯èƒ½ã€‚ å¦‚æœrmqå¥”æºƒå‰æ²¡æœ‰flushè½ç›˜ï¼Œé‚£æ˜¯MQè®¾è®¡é—®é¢˜ï¼Œè‚¯å®šä¼šä¸¢å¤±æ•°æ®ï¼Œéœ€è¦æ‰‹å·¥é‡æ–°å›æ¥æ•°æ®è¿›è¡Œè¡¥å……æ•°æ® ok @agapple 
842,v1.0.26æ­£å¼ç‰ˆä»€ä¹ˆæ—¶å€™å‘å¸ƒå‘¢ï¼Ÿ v1.1.0-alapaç‰ˆæœ¬éƒ½åœ¨è¿›è¡Œäº†ï¼Œè¿˜ä¸è§v1.0.26çš„releaseç‰ˆæœ¬å•Š 1.0.26ç›´æ¥è½¬ä¸º1.1.0ï¼Œé¢„è®¡è¿™ä¸€ä¸¤å‘¨ä¼šæ­£å¼release
841,Create canal prometheus docs. èµ·å§‹çš„æ–‡æ¡£ï¼Œç­‰å…¨éƒ¨å®Œæˆäº†ï¼Œä¼šæ”¾åˆ°wikié‡Œé¢ã€‚ æ¯å¤©æ™šä¸Šéƒ½ä¼šæ›´æ–°ä¸€éƒ¨åˆ†ï¼Œç¡®ä¿è¿™å‘¨èƒ½æå®šã€‚ ç”±äºç›®å‰å·¥ä½œä¸Šä¸canalå·²ç»è„±é’©ï¼Œåªèƒ½æ™šä¸Šå›å®¶æŠ½æ—¶é—´å¼„ï¼Œè¿›åº¦ä¸Šè¿˜è¯·è§è°…ï¼Œè°¢è°¢ã€‚ ä½ å¯ä»¥ç›´æ¥å†™åˆ°wikié‡Œå•Š    è¿™é‡Œï¼šhttps://github.com/alibaba/canal/wiki
840,å‡çº§Kafka ç‰ˆæœ¬è‡³ 2.11_1.1.1 èµ
839,Debug Memory Leak [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=839) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you all sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=839) before we can accept your contribution.<br/>**1** out of **2** committers have signed the CLA.<br/><br/>:white_check_mark: payonxp<br/>:x: yfpeng<br/><hr/>**yfpeng** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=839) it.</sub>
838,canal-1.0.26-preview-5åµŒå…¥å¼Serveræ— æ³•è·å–Entries ä¹‹å‰1.0.25ç‰ˆæœ¬æ˜¯å¯ä»¥çš„ https://github.com/alibaba/canal/releases/tag/canal-1.0.26-preview-5 1.0.26 å¯¹æ€§èƒ½è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå¯¹Entries çš„å¤„ç†æ–¹å¼ä¸Šè¿›è¡Œäº†ä¿®æ”¹. åµŒå…¥å¼server å¯ä»¥å‚è€ƒhttps://github.com/alibaba/canal/blob/master/client/src/main/java/com/alibaba/otter/canal/client/impl/SimpleCanalConnector.java#L332 ä¸­å¯¹æ•°æ®çš„å¤„ç†æ–¹å¼ æ©æ©ï¼Œå°±æ˜¯æ–°ç‰ˆçš„Messageä¿¡æ¯éƒ½æ”¾åˆ°List<ByteString> rawEntries = message.getRawEntries();é‡Œäº†ï¼Œå†é€šè¿‡result.addEntry(Entry.parseFrom(byteString));å¯ä»¥è·å–å®Œæ•´ä¿¡æ¯ï¼Œè°¢è°¢ï¼
837,MemoryEventStoreWithBufferä¿®å¤å†…å­˜æ³„æ¼ï¼Œå¢åŠ Max batch size ä¿®å¤äº†MemoryEventStoreWithBufferä¸­çš„ä¸€ä¸ªå†…å­˜æ³„æ¼é—®é¢˜ï¼š public void cleanUntil(Position position) throws CanalStoreException line 430: for (long next = sequence + 1; next <= maxSequence; next++) åœ¨CanalEventStoreæ¥å£ä¸­å¢åŠ äº†æœ€å¤§Batché•¿åº¦å‚æ•°ï¼Œä½¿å¾—otterèƒ½å¤Ÿæ§åˆ¶è·å–çš„Batchæœ€å¤§é•¿åº¦ï¼Œä¼˜åŒ–RPCä½¿ç”¨åœºæ™¯ä¸­Dubboè¯·æ±‚è¶…å‡ºMax payloadçš„é—®é¢˜ã€‚ [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=837) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you all sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=837) before we can accept your contribution.<br/>**1** out of **2** committers have signed the CLA.<br/><br/>:white_check_mark: payonxp<br/>:x: yfpeng<br/><hr/>**yfpeng** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=837) it.</sub> [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=837) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you all sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=837) before we can accept your contribution.<br/>**1** out of **2** committers have signed the CLA.<br/><br/>:white_check_mark: payonxp<br/>:x: yfpeng<br/><hr/>**yfpeng** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=837) it.</sub> 1.  ä»£ç å…ˆåˆå¹¶ä¸€ä¸‹masterï¼Œæ— æ•ˆçš„åˆ†æ”¯æ”¹åŠ¨æœ‰ç‚¹å¤š 2.  otter payloadçš„é—®é¢˜ï¼Œcanal masterä»£ç å·²ç»å¯ä»¥ç²¾ç¡®æ§åˆ¶batchçš„å†…å­˜å¤§å°ï¼Œä¹Ÿä¸éœ€è¦é¢å¤–çš„batchSizeæ¥æ§åˆ¶ï¼Œå…¶æ¬¡ä¸šåŠ¡otterçš„payloadå¯ä»¥é€‰æ‹©autoæ¨¡å¼ï¼Œä¼šæ ¹æ®æ•°æ®å¤§å°åˆ¤æ–­æ˜¯å¦èµ°rpcè¿˜æ˜¯HTTPçš„æ–‡ä»¶ä¸‹è½½ #839  æˆ‘ä»¬ä¸šåŠ¡ä¸å¤ªé€‚åˆä½¿ç”¨HTTPæ–‡ä»¶ä¸‹è½½çš„æ–¹å¼ï¼Œæ‰€ä»¥å¯¹åŸºäºRPC PayLoadè¿‡å¤§çš„é—®é¢˜è¿›è¡Œäº†æ”¹é€ ã€‚ å†…å­˜æ³„æ¼çš„é—®é¢˜ä½ ä»¬çœ‹ä¸‹å§ã€‚
836,merge [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=836) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you all sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=836) before we can accept your contribution.<br/>**1** out of **2** committers have signed the CLA.<br/><br/>:white_check_mark: payonxp<br/>:x: yfpeng<br/><hr/>**yfpeng** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=836) it.</sub>
835,MemoryEventStoreWithBufferä¿®å¤å†…å­˜æ³„æ¼ï¼Œå¢åŠ Max batch size ä¿®å¤äº†MemoryEventStoreWithBufferä¸­çš„ä¸€ä¸ªå†…å­˜æ³„æ¼é—®é¢˜ï¼š public void cleanUntil(Position position) throws CanalStoreException line 430: for (long next = sequence + 1; next <= maxSequence; next++) åœ¨CanalEventStoreæ¥å£ä¸­å¢åŠ äº†æœ€å¤§Batché•¿åº¦å‚æ•°ï¼Œä½¿å¾—otterèƒ½å¤Ÿæ§åˆ¶è·å–çš„Batchæœ€å¤§é•¿åº¦ï¼Œä¼˜åŒ–RPCä½¿ç”¨åœºæ™¯ä¸­Dubboè¯·æ±‚è¶…å‡ºMax payloadçš„é—®é¢˜ã€‚ [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=835) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you all sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=835) before we can accept your contribution.<br/>**1** out of **2** committers have signed the CLA.<br/><br/>:white_check_mark: payonxp<br/>:x: yfpeng<br/><hr/>**yfpeng** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=835) it.</sub> [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=835) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you all sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=835) before we can accept your contribution.<br/>**1** out of **2** committers have signed the CLA.<br/><br/>:white_check_mark: payonxp<br/>:x: yfpeng<br/><hr/>**yfpeng** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=835) it.</sub>
834,å…³äºmaster - slave çš„ bin-log é—®é¢˜ æ–‡æ¡£ä¸­æŒ‡å‡ºï¼ŒCanal æ˜¯é€šè¿‡æ¨¡æ‹Ÿè‡ªå·±ä¸ºä¸€ä¸ª â€œslaveâ€ å»å’Œ master äº¤äº’ï¼Œè¿›è¡Œ bin-log çš„è®¢é˜…å’Œè§£æã€‚ é‚£å‡å¦‚ slave ä¹Ÿå¼€å¯äº†bin-logï¼Œé‚£ Canal æ˜¯å¦èƒ½ä¸ slave äº¤äº’ï¼Œä»è€Œå®ç°ç›¸å…³çš„åŠŸèƒ½ï¼Ÿ æå‡ºè¿™ä¸ªçš„åŸå› æ˜¯ï¼Œè€ƒè™‘åˆ°ç›®å‰æˆ‘ä»¬ master çš„ç‰©ç†æœºå­æ€§èƒ½æ¯”è¾ƒå·®ï¼Œç„¶åä¹‹å‰ä¹Ÿæ²¡æœ‰çš„ bin-log æ¨¡å¼ä¹Ÿä¸æ˜¯ ROWï¼Œæ‰€ä»¥æƒ³å’¨è¯¢æ˜¯å¦èƒ½åœ¨ slave å¼€ bin-logï¼Œç„¶å Canal ç›´æ¥é€šè¿‡ slave è¿›è¡Œè®¢é˜…å’Œè§£æã€‚ è°¢è°¢ã€‚ å¯ä»¥çš„ï¼Œå¯¹canalæ¥è¯´ï¼Œä½ çš„slaveå°±æ˜¯master @lcybo thx
833,storeå¢åŠ bufferSizeï¼Œmetrics serverç«¯å£å¯é…ç½® å¦‚é¢˜ã€‚
832,å¤§ä½¬ï¼Œè¿™ä¸ªä»¥åä¼šæ”¯æŒæ¡ä»¶ç­›é€‰å— æ¯”å¦‚è¯´åŒæ­¥ä¸€å¼ è¡¨çš„æ•°æ®ï¼Œä½†æ˜¯æˆ‘ä¸æƒ³å…¨éƒ¨åŒæ­¥è¿‡å»æƒ³åšä¸€äº›ç­›é€‰ï¼Œç±»ä¼¼äºåœ¨where åé¢å®šä¹‰ä¸€äº›æ¡ä»¶ï¼Œç¬¦åˆæ¡ä»¶çš„æ‰åŒæ­¥è¿‡å» clienté‡Œé¢å†™ä»£ç åšæ•°æ®è¿‡æ»¤
831,æœ‰æ²¡æœ‰æ‰“ç®—å‡çº§ä¸‹Google Protocol Buffer? æƒ³åšä¸€ä¸ªc#çš„å®¢æˆ·ç«¯è¿æ¥ CanalServerã€‚ ä½ å¯ä»¥æäº¤ä¸€ä¸ªPRä¸Šæ¥  å¯ä»¥åšå‡çº§.   got it
830,Entry header ä¸­ executeTime å­—æ®µèƒ½åšåˆ°æ¯«ç§’ç²¾åº¦ï¼Ÿ binlogé‡Œé¢timestamp 4ä¸ªå­—èŠ‚ï¼Œç²¾åº¦æ˜¯ç§’
829,è¯·é—®ä¸‹ï¼Œexampleä¸‹instance.propertieså’Œrds_propertiesé‡Œé¢çš„æ•°æ®åº“é…ç½®æœ‰å•¥åŒºåˆ«å•Š æˆ‘è®°å¾—1.0.24æ˜¯é…ç½®åœ¨instance.propertiesé‡Œé¢çš„ï¼Œrds_propertiesæ˜¯å¹²å˜›ç”¨çš„å•Šï¼Œè¿˜æœ‰è¿™ä¸ªcanal.instance.tsdb.dbUsername æ˜¯å•¥å•Šï¼Œå¸®å¸®å¿™å•Šè€å“¥ è¿™å—æ–°ç‰ˆæœ¬ä¼šæ¢æˆæ–°æ–¹æ¡ˆï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ : https://github.com/alibaba/canal/issues/727
828,canal æ€§èƒ½æŒ‡æ ‡é‡‡é›† æŒ‡æ ‡åˆ—è¡¨ï¼š canal_instance_traffic_delay   ä¸masterçš„delayï¼Œå•ä½æ¯«ç§’ï¼Œç²¾åº¦æ¯«ç§’ canal_instance_transactions   æ¥æ”¶çš„transactionæ•°é‡ canal_instance_row_events    æ¥æ”¶çš„rowdata entryæ•°é‡ canal_instance_rows_counter   å˜æ›´çš„è¡Œæ•° canal_instance     instanceåˆ—è¡¨ canal_instance_subscriptions      instanceè®¢é˜…æ•°é‡ canal_instance_publish_blocking_time      parallelæ¨¡å¼ä¸‹pushlishé˜»å¡æ—¶é—´ï¼Œå•ä½æ¯«ç§’ï¼Œç²¾åº¦çº³ç§’ canal_instance_received_binlog_bytes       æ¥æ”¶çš„binlogå­—èŠ‚æ•° canal_instance_parser_mode        parseræ˜¯å¦parallelæ¨¡å¼ canal_instance_client_packets      client instancesè¯·æ±‚packetsæ•°é‡ canal_instance_client_bytes         å‘client instanceså‘é€å­—èŠ‚æ•° canal_instance_client_empty_batches       å‘client instanceså‘é€ç©ºåŒ…æ•°é‡ canal_instance_client_request_error     client instancesé”™è¯¯è¯·æ±‚æ•°é‡ canal_instance_client_request_latency    è¯·æ±‚latencyæƒ…å†µ canal_instance_sink_blocking_time     sinkçº¿ç¨‹put storeçš„é˜»å¡æ—¶é—´ï¼Œå•ä½æ¯«ç§’ï¼Œç²¾åº¦çº³ç§’ canal_instance_store_produce_seq      ç”Ÿäº§entryçš„åºå· canal_instance_store_consume_seq     æ¶ˆè´¹entryçš„åºå·ï¼Œä¸canal_instance_store_produce_seqé…åˆä½¿ç”¨ canal_instance_store                      storeåŸºæœ¬ä¿¡æ¯ canal_instance_store_produce_mem      ç”Ÿäº§çš„entryå ç”¨memæ€»é‡ canal_instance_store_consume_mem     æ¶ˆè´¹çš„entryå ç”¨memæ€»é‡ å¾…è¡¥å……... httpserverç«¯å£ç›®å‰æ˜¯11112 æ™šä¸Šå’Œrdsçš„æäº¤æ’è½¦äº†ï¼Œæ‰€ä»¥æœ‰äº›å†²çªæ–‡ä»¶mergeã€‚ protocç”¨çš„2.6.1ç‰ˆæœ¬ã€‚ åç»­ä¼šè¡¥å……Prometheusè¡¨è¾¾å¼ï¼Œå¯è§†åŒ–ç›¸å…³æ–‡æ¡£ï¼Œtest casesï¼›å°†ç«¯å£ç­‰å‚æ•°å¯é…ç½®ç­‰ç­‰ã€‚ è¯·reviewä¸€ä¸‹ï¼Œè°¢è°¢ã€‚ å¤§èµ!!   é—®ä¸€ä¸‹ METRICS_OPTS è¿™ä¸ªæ³¨é‡Šäº†  ç›®å‰ç›‘æ§ä¿¡æ¯çš„è·å–æ–¹å¼æ˜¯JMXè¿˜æ˜¯HTTP ? å»ºè®®ä½ æŠŠç›‘æ§è¿™å—çš„æŒ‡æ ‡çš„æ¦‚å¿µ  ä»¥åŠåŸºäºæŒ‡æ ‡æ¥å®šä½é—®é¢˜çš„caseèƒ½ç½—åˆ—ä¸€ä¸‹   åç»­å¤§å®¶éƒ½å¯ä»¥å…±äº«äº† rdsçš„æäº¤æ¯”è¾ƒå¤§  å’Œæˆ‘è¿™è¾¹çš„ä¸€äº›æäº¤ä¹Ÿæœ‰æ’è½¦  éœ€è¦ç•™æ„çœ‹çœ‹æ˜¯å¦è¢«è¦†ç›–.   è¿™æ¬¡RDSçš„æäº¤  ä¸»è¦ä¸ºè§£å†³é˜¿é‡Œäº‘ä¸ŠRDS binlogè¢«åˆ çš„é—®é¢˜  ä¼šè‡ªåŠ¨è¡”æ¥ossçš„binlog å’Œ mysql binlog.  æœ‰äº†è¿™å¥—æœºåˆ¶ï¼Œ ä»¥åå¯¹æ¥å„ç±»äº‘RDSåŸºæœ¬æ— éšœç¢äº†  METRICS_OPTS æœ¬æ¥æ˜¯ç”¨äº-javaagentçš„ï¼Œç°åœ¨å»æ‰äº†ã€‚ ç›®å‰ç›‘æ§ä¿¡æ¯çš„è·å–æ–¹å¼æ˜¯httpï¼š - job_name: 'canal'     static_configs:     - targets: ['localhost:11112']     //ç«¯å£æˆ–å…¶ä»–é…ç½®åç»­ä¼šé…ç½®åˆ°æ–‡ä»¶é‡Œ æŒ‡æ ‡çš„æ¦‚å¿µåŠcaseä¼šè¿åŒè¡¨è¾¾å¼ï¼Œå†™ä¸€ä¸ªMDï¼Œå†commitï¼ŒåŒ…æ‹¬ä¸€äº›develop guideå’Œå¯è§†åŒ–çš„å†…å®¹ã€‚ èµèµèµ
827,Merge master updates [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=827) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you all sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=827) before we can accept your contribution.<br/>**2** out of **3** committers have signed the CLA.<br/><br/>:white_check_mark: agapple<br/>:white_check_mark: lcybo<br/>:x: lin848497337<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=827) it.</sub>
826,Metrics support å¢åŠ heartbeatåˆ·æ–°delayï¼Œå¢åŠ MHEARTBEAT event typeã€‚ ä½¿ç”¨version 2.6.1 protocç¼–è¯‘CanalEntryã€‚ ä½¿ç”¨pairä¸­çš„rowsCountç»Ÿè®¡å˜æ›´è¡Œæ•°ã€‚ [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=826) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you all sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=826) before we can accept your contribution.<br/>**4** out of **5** committers have signed the CLA.<br/><br/>:white_check_mark: payonxp<br/>:white_check_mark: agapple<br/>:white_check_mark: wingerx<br/>:white_check_mark: lcybo<br/>:x: yfpeng<br/><hr/>**yfpeng** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=826) it.</sub>
825,Remove dirty test case sourceä¸‹é¢com.alibaba.otter.canal.parse.inbound.mysql.tablemetaå·²ç»åˆ æ‰äº†ï¼Œtest caseè¿˜åœ¨ï¼Œç¼–è¯‘æœ‰é—®é¢˜ã€‚ tks
824,clientå¦‚ä½•æ§åˆ¶åŒä¸€ä¸ªäº‹ç‰©å†…çš„insert  updateæ¶ˆè´¹é¡ºåºï¼Ÿ clientå¦‚ä½•æ§åˆ¶åŒä¸€ä¸ªäº‹ç‰©å†…çš„insert  updateæ¶ˆè´¹é¡ºåºï¼Ÿæœ‰æ—¶å€™clientå¾€å¾€å…ˆæ‹¿åˆ°äº†updateçš„äº‹ä»¶ï¼Œåæ‹¿åˆ°insertäº‹ä»¶ã€‚ clientæ‹¿åˆ°çš„é¡ºåºå°±æ˜¯æ•°æ®åº“é‡Œbinlogè®°å½•çš„é¡ºåº
823,TableMetaCache.parseTableMetaByDesc è§£ædesc table çš„ç»“æœ NullPointer mysqlç‰ˆæœ¬ï¼š5.6 desc tableçš„packetsè§£æä¸­keyé”™è¯¯ã€‚     public static final String              COLUMN_NAME    = "COLUMN_NAME";     public static final String              COLUMN_TYPE    = "COLUMN_TYPE";     public static final String              IS_NULLABLE    = "IS_NULLABLE";     public static final String              COLUMN_KEY     = "COLUMN_KEY";     public static final String              COLUMN_DEFAULT = "COLUMN_DEFAULT";     public static final String              EXTRA          = "EXTRA"; åº”è¯¥æ”¹ä¸ºï¼š     public static final String              COLUMN_NAME    = "Field";     public static final String              COLUMN_TYPE    = "Type";     public static final String              IS_NULLABLE    = "Null";     public static final String              COLUMN_KEY     = "Key";     public static final String              COLUMN_DEFAULT = "Default";     public static final String              EXTRA          = "Extra"; å¦åˆ™ä¼šåœ¨è¿™ä¸€è¡ŒæŠ¥NullPointer  meta.setColumnName(packet.getFieldValues().get(nameMaps.get(COLUMN_NAME) + i * size).intern()); mysql> select @@version ; +--------------------+ | @@version          | +--------------------+ | 5.6.28-cdb2016-log | +--------------------+ 1 row in set (0.01 sec) mysql> desc test.test ; +-------+---------+------+-----+---------+-------+ | Field | Type    | Null | Key | Default | Extra | +-------+---------+------+-----+---------+-------+ | id    | int(11) | YES  |     | NULL    |       | +-------+---------+------+-----+---------+-------+ 1 row in set (0.01 sec) ![image](https://user-images.githubusercontent.com/33280738/43878223-88545b3a-9bd0-11e8-9f31-6dccbc75e37a.png) å–çš„æ˜¯originalNameï¼Œè€Œéname. NPEæ˜¯æµ‹è¯•å‡ºæ¥çš„ç»“æœå—? ![image](https://user-images.githubusercontent.com/7187362/43878339-234ac804-9bd1-11e8-99de-a4646bdb9c61.png) å“¥ä»¬~~æˆ‘è¿™é‡ŒæŠŠpacketæ‰“å‡ºæ¥æ˜¯è¿™æ ·ã€‚æ˜¯ä¸æ˜¯æˆ‘çš„mysqlç‰ˆæœ¬å’Œä½ é‚£è¾¹çš„ä¸ä¸€è‡´         System.out.println(packet); UTå¯ä»¥æµ‹å‡ºæ¥ã€‚ æœ‰å¯èƒ½. https://dev.mysql.com/doc/refman/8.0/en/columns-table.html ![image](https://user-images.githubusercontent.com/33280738/43881977-9a81a8ac-9be0-11e8-9126-c6711b98eb16.png) ![image](https://user-images.githubusercontent.com/33280738/43881992-ad3b1fbe-9be0-11e8-97e7-11bad3d560c9.png) æˆ‘è¿™è¾¹ç”¨5.6.28æµ‹å‡ºæ¥çš„ä¹Ÿæ˜¯ä¸€è‡´çš„ã€‚ä½ é‚£è¾¹çš„ç‰ˆæœ¬ä»å“ªé‡Œè·å–åˆ°çš„ï¼Ÿ å“¥ã€‚ã€‚æˆ‘å¼„é”™äº†ã€‚ã€‚mysqlConnectionè¿åˆ°å¦å¤–ä¸€ä¸ªæ•°æ®åº“å»äº†é¢ã€‚ã€‚ã€‚æ˜¯ä¸ª8.0.11ç‰ˆæœ¬çš„ã€‚ å ç”¨ä½ è¿™ä¹ˆä¹…æ—¶é—´äº†ï¼Œä¸å¥½æ„æ€äº†ã€‚ ok. 8.0ç‰ˆæœ¬ç›®å‰æš‚ä¸æ”¯æŒã€‚ æ‰“æ‰°äº†~~issueå…³äº†å§ã€‚
822,fix tableMetaStorage NPE 
821, NPEï¼šMysqlEventParser TableMetaCacheWithStorage å¦‚å›¾ï¼ŒtableMetaStorageFactoryä¸ºNULLæ—¶ï¼Œstorageå€¼ä¸ºnullï¼Œåç»­å°±NullPointerExceptionäº† 	at com.alibaba.otter.canal.parse.inbound.mysql.tablemeta.TableMetaCacheWithStorage.<init>(TableMetaCacheWithStorage.java:21) ![image](https://user-images.githubusercontent.com/5847660/43820893-1ccadbde-9b1a-11e8-9979-2ab94346dfdb.png) #822  çœ‹æˆ‘æœ€æ–°çš„masteræäº¤ï¼Œå·²ç»å»æ‰äº†tableMetaStorageFactory ok
820,canalæ˜¯æ”¯æŒåˆ°MySQL5.7.18å—ï¼Ÿ 5.7.18ä»¥ä¸Šçš„ç‰ˆæœ¬æ˜¯å®Œå…¨ä¸æ”¯æŒï¼Œè¿˜æ˜¯è¯´æŸäº›åŠŸèƒ½çš„æ”¯æŒæœ‰é—®é¢˜ï¼Ÿæœ‰æ²¡æœ‰åœ¨æ›´é«˜ç‰ˆæœ¬ä¸Šä½¿ç”¨è¿‡çš„ç«¥é‹å“‡ï¼Ÿ æˆ‘ä»¬ç°åœ¨åœ¨ 5.7.20 ä¸Šä½¿ç”¨ï¼Œæ²¡å‘ç°é—®é¢˜.
819,canal æ€§èƒ½ç›‘æ§æ”¹åŠ¨ç‰ˆ ä»£ç æˆ‘å…ˆmergeåˆ°å¼€å‘åˆ†æ”¯é‡Œï¼ˆmetrics_supportï¼‰ã€‚ æœ€è¿‘æœ‰äº›åˆ«çš„äº‹è¦å¿™ï¼Œè¿›åº¦æœ‰ç‚¹æ…¢ï¼ŒæŠ±æ­‰ã€‚ ç›®å‰è¿›åº¦æ˜¯ç®€å•debugè¿‡ï¼Œåé¢å‡ å¤©å›å®¶åæˆ‘ä¼šæŠ“ç´§è‡ªå·±å…ˆæµ‹è¯•ä¸‹ã€‚ ä¸€äº›TODO listå¤‡å¿˜ï¼š 1. æ‰©å±•EntryProtocolï¼Œå¢åŠ masterçš„heartbeatï¼Œç”¨æ¥åœ¨idleçŠ¶æ€åˆ·æ–°delayã€‚ 2. æ‰©å±•EntryProtocolï¼Œåœ¨headerå¤´å¢åŠ rowDataè®¡æ•°ï¼ˆå¦åˆ™åªèƒ½é€šè¿‡ååºåˆ—åŒ–æ‹¿åˆ°ï¼‰ï¼Œå…³äºè¿™ä¸€æ¡ï¼Œä¹Ÿæƒ³è¯¢é—® @agapple çš„æ„è§ã€‚è¿™æ¡åˆ’æ‰ï¼Œå·²ç»åœ¨Pairé‡Œé¢äº†ã€‚ [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=819) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you all sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=819) before we can accept your contribution.<br/>**4** out of **5** committers have signed the CLA.<br/><br/>:white_check_mark: wingerx<br/>:white_check_mark: lcybo<br/>:white_check_mark: agapple<br/>:white_check_mark: qmz<br/>:x: Chuanyi Li L<br/><hr/>**Chuanyi Li L** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=819) it.</sub>
818,HAæ¨¡å¼ä¸‹ï¼Œcanal.instance.tsdb.enable=trueï¼Œæ•°æ®åº“è¿›è¡Œä¸»ä»åˆ‡æ¢åï¼Œcanalçš„masterä¸standby åˆ‡æ¢åï¼Œä¼šæŠ¥å¦‚ä¸‹å¼‚å¸¸ã€‚ç›®å‰æˆ‘ä½¿ç”¨çš„è§£å†³æ–¹å¼æ˜¯å°†canal.instance.tsdb.enable=falseï¼Œå°±å¯ä»¥è¿›è¡Œæ­£å¸¸çš„åˆ‡æ¢äº†ã€‚ HAæ¨¡å¼ä¸‹ï¼Œcanal.instance.tsdb.enable=trueï¼Œæ•°æ®åº“è¿›è¡Œä¸»ä»åˆ‡æ¢åï¼Œcanalçš„masterä¸standby åˆ‡æ¢åï¼Œä¼šæŠ¥å¦‚ä¸‹å¼‚å¸¸ã€‚ç›®å‰æˆ‘ä½¿ç”¨çš„è§£å†³æ–¹å¼æ˜¯å°†canal.instance.tsdb.enable=falseï¼Œå°±å¯ä»¥è¿›è¡Œæ­£å¸¸çš„åˆ‡æ¢äº†ã€‚ 2018-08-07 10:44:48.772 [destination = orderfailover   address = /10.8.132.135:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position by switch ::1532919362000 2018-08-07 10:44:48.780 [destination = orderfailover   address = /10.8.132.135:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - Didn't find the corresponding binlog files from mysql-bin.000020 to mysql-bin.000021 2018-08-07 10:44:48.782 [destination = orderfailover   address = /10.8.132.135:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /10.8.132.135:3306 has an error  retrying. caused by com.alibaba.otter.canal.parse.exception.CanalParseException: can't find start position for orderfailover 2018-08-07 10:44:48.782 [Druid-ConnectionPool-Create-1877078260] ERROR com.alibaba.druid.pool.DruidDataSource - create connection SQLException  url:   errorCode 0  state null java.sql.SQLException: connect error  url   driverClass org.h2.Driver         at com.alibaba.druid.pool.DruidAbstractDataSource.createPhysicalConnection(DruidAbstractDataSource.java:1582) ~[druid-1.1.9.jar:1.1.9]         at com.alibaba.druid.pool.DruidDataSource$CreateConnectionThread.run(DruidDataSource.java:2466) ~[druid-1.1.9.jar:1.1.9] 2018-08-07 10:44:48.782 [destination = orderfailover   address = /10.8.132.135:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:orderfailover[com.alibaba.otter.canal.parse.exception.CanalParseException: can't find start position for orderfailover ] 2018-08-07 10:44:49.282 [Druid-ConnectionPool-Create-1877078260] ERROR com.alibaba.druid.pool.DruidDataSource - create connection SQLException  url:   errorCode 0  state null java.sql.SQLException: connect error  url   driverClass org.h2.Driver         at com.alibaba.druid.pool.DruidAbstractDataSource.createPhysicalConnection(DruidAbstractDataSource.java:1582) ~[druid-1.1.9.jar:1.1.9]         at com.alibaba.druid.pool.DruidDataSource$CreateConnectionThread.run(DruidDataSource.java:2466) ~[druid-1.1.9.jar:1.1.9] 2018-08-07 10:44:49.783 [Druid-ConnectionPool-Create-1877078260] ERROR com.alibaba.druid.pool.DruidDataSource - create connection SQLException  url:   errorCode 0  state null java.sql.SQLException: connect error  url   driverClass org.h2.Driver         at com.alibaba.druid.pool.DruidAbstractDataSource.createPhysicalConnection(DruidAbstractDataSource.java:1582) ~[druid-1.1.9.jar:1.1.9]         at com.alibaba.druid.pool.DruidDataSource$CreateConnectionThread.run(DruidDataSource.java:2466) ~[druid-1.1.9.jar:1.1.9] 2018-08-07 10:44:50.283 [Druid-ConnectionPool-Create-1877078260] ERROR com.alibaba.druid.pool.DruidDataSource - create connection SQLException  url:   errorCode 0  state null java.sql.SQLException: connect error  url   driverClass org.h2.Driver         at com.alibaba.druid.pool.DruidAbstractDataSource.createPhysicalConnection(DruidAbstractDataSource.java:1582) ~[druid-1.1.9.jar:1.1.9]         at com.alibaba.druid.pool.DruidDataSource$CreateConnectionThread.run(DruidDataSource.java:2466) ~[druid-1.1.9.jar:1.1.9] 2018-08-07 10:44:50.783 [Druid-ConnectionPool-Create-1877078260] ERROR com.alibaba.druid.pool.DruidDataSource - create connection SQLException  url:   errorCode 0  state null java.sql.SQLException: connect error  url   driverClass org.h2.Driver         at com.alibaba.druid.pool.DruidAbstractDataSource.createPhysicalConnection(DruidAbstractDataSource.java:1582) ~[druid-1.1.9.jar:1.1.9]         at com.alibaba.druid.pool.DruidDataSource$CreateConnectionThread.run(DruidDataSource.java:2466) ~[druid-1.1.9.jar:1.1.9] 2018-08-07 10:44:51.283 [Druid-ConnectionPool-Create-1877078260] ERROR com.alibaba.druid.pool.DruidDataSource - create connection SQLException  url:   errorCode 0  state null ä¸»è¦åŸå› ä¸ºh2-tsdb.xmlé‡Œä¾èµ–äº†Systemé‡Œçš„canal.instance.destinationå˜é‡å®šä¹‰ï¼Œåœ¨ä¸»å¤‡åˆ‡æ¢æ—¶æ˜¯æœ‰ä¸€ä¸ªå¼‚æ­¥ç°åœºæ“ä½œï¼Œè¯¥å€¼ä¸ºç©ºå¯¼è‡´
817,canal-1.026-alpha4 å¯åŠ¨å¤±è´¥ OS: CentOS Linux release 7.4.1708 canal : canal-1.026-alpha4 åœ¨macä¸­éªŒè¯æ²¡æœ‰é—®é¢˜ã€‚linuxç¯å¢ƒ å¯åŠ¨å¤±è´¥. java stack: `Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: java.lang.IllegalArgumentException: limit excceed: 44 Caused by: java.lang.IllegalArgumentException: limit excceed: 44         at com.taobao.tddl.dbsync.binlog.LogBuffer.getUint8(LogBuffer.java:235) ~[canal.parse.dbsync-1.0.26-SNAPSHOT.jar:na]         at com.taobao.tddl.dbsync.binlog.event.GtidLogEvent.<init>(GtidLogEvent.java:48) ~[canal.parse.dbsync-1.0.26-SNAPSHOT.jar:na]         at com.taobao.tddl.dbsync.binlog.LogDecoder.decode(LogDecoder.java:364) ~[canal.parse.dbsync-1.0.26-SNAPSHOT.jar:na]         at com.taobao.tddl.dbsync.binlog.LogDecoder.decode(LogDecoder.java:110) ~[canal.parse.dbsync-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor$SimpleParserStage.onEvent(MysqlMultiStageCoprocessor.java:210) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]` å·²çŸ¥é—®é¢˜ï¼Œè¯·ä¸‹è½½æœ€æ–°çš„alpha-5
816,fix ci: fixed compiler java 1.7 fix ci: fixed compiler java 1.7 1. ç§»é™¤canal.instance.spring ä¾èµ–åï¼Œéœ€è¦åŠ å…¥druidä¸mysql connectorçš„ä¾èµ–  2. PropertyPlaceholderConfigurerç”±canal.instance.springç§»è‡³db tks
815,canal HA æ¨¡å¼ï¼ŒæŸ¥çœ‹position canal server å¯äº†ä¸¤å°ï¼Œå¼€å¯äº†HAé«˜å¯ç”¨ã€‚é…ç½®å¦‚ä¸‹ï¼š ä½†æ˜¯zkä¸å°å¿ƒè¢«åˆ é™¤äº†ï¼Œç°åœ¨active canal è¿˜æ˜¯æ­£å¸¸æ¥æ”¶binlogè§£æï¼Œä½†æ˜¯å·²ç»æ²¡æ³•æ›´æ–°zkä¸­çš„positionä¿¡æ¯äº†ã€‚è¯·é—®ä¸€ä¸‹ï¼Œzkä¸å°å¿ƒè¯¯åˆ äº†ï¼Œé™¤äº†zkè¿˜èƒ½åœ¨å“ªæŸ¥åˆ°å½“å‰instanceçš„positionæ•°æ®ï¼Ÿ ` ################################################# ######### 		common argument		############# ################################################# canal.id= 1 canal.ip= canal.port= 11111 canal.zkServers=10.100.1.10:2181 10.100.1.11:2181 10.100.1.12:2181 canal.zookeeper.flush.period = 1000 canal.file.data.dir = ${canal.conf.dir} canal.file.flush.period = 1000 canal.instance.memory.buffer.size = 16384 canal.instance.memory.buffer.memunit = 1024 ` logsä¸‹çš„meta.logä¼šæœ‰è®°å½•æ¯æ¬¡çš„æ¶ˆè´¹ HAæ¨¡å¼ä¸‹ï¼Œlogsä¸‹çš„meta.log æ²¡æœ‰è®°å½•ï¼Œåªæœ‰éHAçš„æ—¶å€™æ‰ä¼šè®°å½•meta.logã€‚ æ˜¯æˆ‘HAä¸‹ï¼Œé…ç½®æœ‰é—®é¢˜å—ï¼Ÿ
814,schema history storage interface ä¸ºäº†è§£å†³Otterå›è¿½æ•°æ®æ—¶Rowdataä¸å½“å‰schemaä¸åŒ¹é… å¯¹TableMetaæä¾›æŒä¹…åŒ–æ¥å£ï¼Œæ ¹æ®timestampåŒ¹é…å†å²schema åœ¨æˆ‘ä»¬çš„mysqlå‚¨å­˜å®ç°ä¸­ï¼Œç”±Otter Managerè¿›è¡Œæ•°æ®åº“æ“ä½œï¼ŒCanalEmbedSelectorç»„è£…Factoryå¹¶æ”¾å…¥CanalPropertiesã€‚ æ²¡æœ‰storageå®ç°åˆ™é€€åŒ–ä¸ºåŸå§‹TableMetaCacheã€‚ [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=814) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you all sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=814) before we can accept your contribution.<br/>**1** out of **2** committers have signed the CLA.<br/><br/>:white_check_mark: payonxp<br/>:x: yfpeng<br/><hr/>**yfpeng** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=814) it.</sub> [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=814) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=814) before we can accept your contribution.<br/><hr/>**yfpeng** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=814) it.</sub> @payonxp ä»£ç åˆå†²çªï¼Œéº»çƒ¦å…ˆåˆå¹¶ä¸€ä¸‹ä¸»å¹²ä»£ç  è¿™ä¸ªåŠŸèƒ½å’Œtsdb æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ çœ‹äº†ä¸‹å®ç°ï¼Œæ˜¯åœ¨è§£æåˆ°å½“æ—¶çš„DDLæ—¥å¿—æ—¶åæŸ¥ä¸€ä¸‹æ•°æ®åº“è¡¨ç»“æ„ï¼Œåšä¸€ä¸‹timestampçš„æ˜ å°„è®°å½•ã€‚ç›¸æ¯”äºTableMeta tsdbæœ‰ä¸€ä¸ªé—®é¢˜åœ¨äºï¼Œæ‹¿åˆ°binlog DDLæ—¶è¿›è¡ŒåæŸ¥è¡¨ç»“æ„ï¼Œæ­¤æ—¶çš„è¡¨ç»“æ„å’Œå½“æ—¶çš„DDLå¯¹åº”çš„ç»“æ„æ˜¯æœ‰æ—¶é—´GAPçš„ï¼Œä¼šæœ‰ä¸ä¸€è‡´æ€§.  å¯ä»¥canal1.0.26æœ€æ–°çš„å®ç°ï¼šhttps://github.com/alibaba/canal/wiki/TableMetaTSDB @agapple æˆ‘æ²¡ç»†çœ‹å®ç°é€»è¾‘ï¼Œä½†ä»æè¿°ä¸Šçœ‹æ„Ÿè§‰å°±æ˜¯TSDBå®ç°çš„åŠŸèƒ½ æ‹¿åˆ°binlog DDLæ—¶å°è¯•è°ƒç”¨äº†TSDBçš„è§£æåŠŸèƒ½ï¼Œå…¶å®ä¸æ˜¯æ¯æ¬¡éƒ½å¾€æ•°æ®åº“æŸ¥ã€‚ ä¸»è¦çš„åŠŸèƒ½å’ŒTSDBå·®ä¸å¤šï¼Œæ˜¯æƒ³æŠŠæŒä¹…åŒ–åŠŸèƒ½æ”¾åˆ°otterï¼Œcanalæœ¬èº«ä¸å®ç°æŒä¹…åŒ–ã€‚ å»ºè®®æŠŠotteré‡Œå®ç°çš„storageèƒ½åŠ›ï¼Œä¹Ÿæäº¤ä¸€ä¸ªPR æˆ‘é‡æ–°ä¿®æ”¹æ”¯æŒäº†otterä½¿ç”¨TableMetaTSDB https://github.com/alibaba/canal/commit/9e816bc48f9955f9e2839873993cef9627c2f389 å¯¹åº”çš„otter commit : https://github.com/alibaba/otter/commit/7cc897131da65aab2c1aa31b7b0b8aa7a6f65745 Thx
813,fix #802: ä»otterä¸­å‰¥ç¦»MySQL ç›¸å…³åŒæ­¥å®ç°ï¼Œä½œä¸ºexampleçš„å‚è€ƒ éå¸¸èµ
812,é“¾æ¥å¤±æ•ˆ ### wikiçš„home + **ç›¸å…³èµ„æ–™**ï¼šä¸é˜¿é‡Œå·´å·´çš„rocketMQé…åˆä½¿ç”¨ è¿æ¥å¤±æ•ˆ ### wikiçš„Introduction + **çŸ¥è¯†ç§‘æ™®**ï¼šmysqlçš„Binlay Logä»‹ç»çš„ç¬¬äºŒä¸ªé“¾æ¥å¤±æ•ˆ + **EventParserè®¾è®¡**ï¼šbinlog event structureï¼Œè¯¦ç»†ä¿¡æ¯è¯·å‚è€ƒçš„è¿æ¥ Page Not Found taobaodbaçš„blog å·²ç»ä¸å­˜åœ¨äº†.å…¶ä»–è¿æ¥å·²ç»ä¿®å¤ï¼Œtks. @wingerx å¯ä»¥è¯´ååˆ†çš„æ•ˆç‡äº†ï¼Œèµä¸€ä¸ªã€‚ èµä¸€ä¸ª åŸè°…æˆ‘çš„å¼ºè¿«ç—‡ README.md é‡Œé¢å…³äºRocketMQçš„è¿æ¥æœªæ›´æ”¹ã€‚ https://github.com/apache/rocketmq å·²ä¿®å¤
811,change com.alibaba.fastsql version to the last on http://central.maveâ€¦ Solve the bug of issue #808  [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=811) <br/>All committers have signed the CLA. [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=811) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=811) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=811) it.</sub> åé¢ä¼šæäº¤fastsqlçš„æœ€æ–°ç‰ˆ å¥½ï¼Œé‚£å°½å¿«deployä¸€ä¸‹å“ˆï¼Œæˆ‘å°±æŠŠè¿™ä¸ªå…ˆå…³äº†
810,fix bug: kafka get row data for performance tks
809,canal ack error 2018-08-03 15:17:45.414 [New I/O server worker #1-4] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x7cec5107  /10.111.61.32:47512 :> /10.111.61.32:11111]  exception=java.nio.channels.ClosedChannelException         at org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:649)         at org.jboss.netty.channel.socket.nio.NioWorker.writeFromUserCode(NioWorker.java:370)         at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:137)         at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76)         at org.jboss.netty.channel.Channels.write(Channels.java:611)         at org.jboss.netty.channel.Channels.write(Channels.java:578)         at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:46)         at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:174)         at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48)         at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276)         at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302)         at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526)         at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507)         at org.jboss.netty.handler.codec.replay.ReplayingDecoder.cleanup(ReplayingDecoder.java:542)         at org.jboss.netty.handler.codec.replay.ReplayingDecoder.channelDisconnected(ReplayingDecoder.java:450)         at org.jboss.netty.channel.Channels.fireChannelDisconnected(Channels.java:360)         at org.jboss.netty.channel.socket.nio.NioWorker.close(NioWorker.java:599)         at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:119)         at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76)         at org.jboss.netty.channel.Channels.close(Channels.java:720)         at org.jboss.netty.channel.AbstractChannel.close(AbstractChannel.java:208)         at org.jboss.netty.channel.ChannelFutureListener$1.operationComplete(ChannelFutureListener.java:46)         at org.jboss.netty.channel.DefaultChannelFuture.notifyListener(DefaultChannelFuture.java:381)         at org.jboss.netty.channel.DefaultChannelFuture.addListener(DefaultChannelFuture.java:148)         at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:48)         at com.alibaba.otter.canal.server.netty.NettyUtils.error(NettyUtils.java:69)         at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:253)         at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48)         at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276)         at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302)         at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526)         at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507)         at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:444)         at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274)         at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261)         at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:350)         at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:281)         at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:201)         at org.jboss.netty.util.internal.IoWorkerRunnable.run(IoWorkerRunnable.java:46)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)         at java.lang.Thread.run(Thread.java:748) æŒ‰ç…§exampleä»£ç åšä¸€ä¸‹é‡è¯•å¤„ç†
808,com.alibaba.fastsql:fastsql:jar:2.0.0_preview_520 mvn clean installçš„æ—¶å€™æŠ¥é”™ [ERROR] Failed to execute goal on project canal.parse: Could not resolve dependencies for project com.alibaba.otter:canal.parse:jar:1.0.26-SNAPSHOT: Could not find artifact com.alibaba.fastsql:fastsql:jar:2.0.0_preview_520 in central (http://repo1.maven.org/maven2) -> [Help 1] è¯·é—®ä¸‹è¿™ä¸ªæ€ä¹ˆè§£å†³ã€‚è°¢è°¢ ä½ ç”¨2.0.0_preview_186å§ï¼Œ2.0.0_preview_520 å¹¶æ²¡æœ‰å¯¹å¤–å¼€æ”¾ï¼Œå¦å¤–é…ç½®mavenä»“åº“ä¸­å¿ƒä¸ºï¼šhttp://central.maven.org/maven2/ 2.0.0_preview_520 åœ¨release é‡Œé¢æœ‰jaråŒ…
807,instance with manageræ¨¡å¼ä¸€äº›å¾®è°ƒ 1ã€CanalParameter#MetaModeå¢åŠ æœ¬åœ°æ–‡ä»¶æ–¹å¼é€‚é…manageræ¨¡å¼æ˜¯instanceä½¿ç”¨æœ¬åœ°meta.datå­˜å‚¨ä½ç‚¹ä¿¡æ¯ï¼› 2ã€typoä¿®æ­£; 3ã€BatchModeé»˜è®¤å€¼ä¿®æ­£; CanalParameterçš„å‚æ•°åè°ƒæ•´ä¼šæœ‰ä¸€ä¸ªå†å²ç‰ˆæœ¬å…¼å®¹æ€§çš„é—®é¢˜ï¼Œå•è¯æ‹¼å†™çš„é—®é¢˜ä»¥å‰å‘ç°äº†ä½†ä¸èƒ½åšå˜åŠ¨äº†ï¼Œé™¤éå…¼å®¹è€çš„set/getæ–¹æ³• æ˜ç™½ï¼Œæˆ‘é‡ç½®äº†ä¸€ä¸‹æäº¤ï¼Œç›®å‰è¿™ä¸ªpråªæ˜¯å¯¹manageræ¨¡å¼é€‚é…ä¸€ä¸‹å¯ä»¥ä½¿ç”¨FileMixedMetaManageræœ¬åœ°æ–‡ä»¶å­˜å‚¨meta.datä½ç‚¹æ•°æ®ï¼Œé¿å…ç›®å‰manageræ–¹å¼æ—¶ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨zookeeperï¼Œå’Œfile-instance.xmlé»˜è®¤é…ç½®ç±»ä¼¼ï¼› å‚æ•°å¯¹åº”äºCanalParameteræ–°å¢å‚æ•°çš„dataDirå’ŒmetaFileFlushPeriodï¼› tks
806,æ”¯æŒGTIDæ¨¡å¼ä¸‹ï¼Œé»˜è®¤è·å–å½“å‰gtidå€¼ä½œä¸ºèµ·å§‹å€¼ tks
805,å…³äºpositionè®¾ç½® è¯·é—®æˆ‘è®¾ç½®æ—¥å¿—è¯»å–ä½ç½®ï¼Œæ˜¯ä¸æ˜¯åªéœ€è¦è®¾ç½®instance.proertiesä¸­çš„jouralNameå’Œpositionå°±è¡Œï¼Œé‚£meda.daté‡Œçš„å‘¢ï¼Œä¸ºä»€ä¹ˆå®ƒä¸instance.proertiesä¸­çš„ä¸ä¸€æ ·å‘¢ï¼Œåˆ°åº•å“ªä¸ªç”Ÿæ•ˆï¼Ÿ æˆ‘æ˜¯ç”¨default-instance.xml zké›†ç¾¤ 1. ä½¿ç”¨default-instance.xmlåï¼Œé»˜è®¤æ˜¯é€šè¿‡zkç®¡ç†ä½ç‚¹ä¿¡æ¯çš„.æ‰€ä»¥ meda.datåœ¨è¿™é‡Œæ— æ•ˆçš„ 2. meda.daté’ˆå¯¹çš„æ¨¡å¼æ˜¯file-instance.xml 3. instance.properties ä¸­çš„ä½ç‚¹ä¸zk ä½ç‚¹ å…³ç³»(ä»¥ default-instance.xmlä¸ºä¾‹)  * å½“zkä¸­ä½ç‚¹ä¸­ä¸å­˜åœ¨æ—¶ï¼Œcanalå¯åŠ¨çš„ä½ç‚¹ä»¥ instance.propertiesä¸­ä¸ºå‡†ï¼Œè‹¥æ²¡æœ‰ï¼Œåˆ™é€šè¿‡ `show master status` å–æœ€æ–°çš„ä½ç‚¹ä¿¡æ¯  *  å½“ zk ä¸­å­˜åœ¨ä½ç‚¹ä¿¡æ¯æ—¶ï¼Œä»¥zkä¸­çš„è®°å½•ä¸ºå‡†.  æ‰€ä»¥åœ¨æ­£å¸¸æ•°æ®åŒæ­¥çš„æƒ…å†µä¸‹ï¼Œzkçš„ä½ç‚¹å’Œinstance.propertiesä¸­é…ç½®çš„ä½ç‚¹æ˜¯ä¸åŒçš„ã€‚canal ä¹Ÿæ˜¯é€šè¿‡å…¶æ¥å®ç°æ–­ç‚¹ç»­ä¼ çš„èƒ½åŠ› @wingerx ä½ å¥½ï¼Œæˆ‘å°è¯•åˆ é™¤äº†zkä¸Šçš„ä½ç‚¹ä¿¡æ¯ï¼Œè®©å…¶é‡æ–°ç”Ÿæˆï¼ŒæŒ‰ç…§ä½ çš„è¯´æ³•åº”è¯¥åŒæ­¥Instance.propertiesä¸­çš„ä½ç‚¹ä¿¡æ¯ï¼ˆæˆ‘è®¾ç½®è¿‡äº†ï¼‰ï¼Œä½†æ˜¯å´æ²¡æœ‰ï¼Œè¿™ä¸ªåŸå› å¯èƒ½æ˜¯å‡ºåœ¨å“ªé‡Œå‘¢ 1. Instance.propertiesä¸­é…ç½®çš„åªå’Œå¯åŠ¨æ—¶æ‰¾ä½ç‚¹æœ‰å…³ 2. zkä¸­è®°å½•çš„æ˜¯clientç«¯æ¶ˆè´¹æˆåŠŸåack æ—¶çš„ä½ç‚¹ å¹¶ä¸æ˜¯è¯´å†instance.propertiesä¸­é…ç½®äº†æŸä½ç‚¹ä¿¡æ¯ï¼Œzkå°±ä¼šåŒæ­¥æ›´æ–°æˆè¿™ä¸ªä½ç‚¹. 
804,canalå¦‚ä½•å¤„ç†mysqlä¸­çš„blobæ•°æ®ç±»å‹ï¼Ÿ æ±‚å¤§ç¥è¯·æ•™canalä¸­æ˜¯å¦‚ä½•å¤„ç†mysqlä¸­çš„blobæ•°æ®ç±»å‹ï¼Ÿ åœ¨ç½‘ä¸ŠæŸ¥æ‰¾åˆ°çš„èµ„æ–™å¦‚ä¸‹ï¼ˆä¸çŸ¥é“æ˜¯å¦æ­£ç¡®ï¼‰ï¼š Canal å°† binlog ä¸­çš„å€¼åºåˆ—åŒ–æˆäº† String æ ¼å¼ç»™ä¸‹æ¸¸ç¨‹åºï¼Œå› æ­¤åœ¨ Blob æ ¼å¼çš„æ•°æ®åºåˆ—åŒ–æˆ String æ—¶ä¸ºäº†èŠ‚çœç©ºé—´ï¼Œå¼ºåˆ¶ä½¿ç”¨äº† IOS_8859_0 ä½œä¸ºç¼–ç ã€‚å› æ­¤ï¼Œåœ¨å¦‚ä¸‹æƒ…å†µä¸‹ä¼šé€ æˆä¸­æ–‡ä¹±ç ï¼š åŒæ­¥æœåŠ¡ JVM ä½¿ç”¨äº† UTF-8 ç¼–ç  BLOB å­—æ®µä¸­å­˜å‚¨æœ‰ä¸­æ–‡å­—ç¬¦ ä½œè€…ï¼šhaitaoyao é“¾æ¥ï¼šhttps://www.jianshu.com/p/be3f62d4dce0 ä¾†æºï¼šç®€ä¹¦ ç®€ä¹¦è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ï¼Œä»»ä½•å½¢å¼çš„è½¬è½½éƒ½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒå¹¶æ³¨æ˜å‡ºå¤„ã€‚ æ±‚å¤§ç¥æŒ‡å¯¼ï¼ æŒ‰ç…§iso8859-1è¿›è¡Œåè§£ä¸ºbytes[]å³å¯ è°¢è°¢æŒ‡å¯¼ï¼ä½†æ˜¯æˆ‘å°†sqltypeä¸ºlongblobç±»å‹çš„å­—æ®µä½¿ç”¨iso8859-1åè§£ä¸ºbytes[]å†utf-8ç¼–ç ä¸ºstringæ—¶ï¼Œä»ç„¶æ˜¯ä¹±ç ï¼š è¿™æ˜¯longblobå­—æ®µçš„å†…å®¹ï¼š <img width="1128" alt="canal-blob-getvalue" src="https://user-images.githubusercontent.com/28953872/43885058-677e5658-9bea-11e8-956c-edeb50a0da5b.png"> è¿™æ˜¯ä½¿ç”¨iso8859-1è¿›è¡Œ åè§£ï¼š <img width="1123" alt="iso" src="https://user-images.githubusercontent.com/28953872/43885109-8a92545a-9bea-11e8-9102-2b5a0c10ec0d.png"> æˆ‘çš„ä»£ç å¦‚ä¸‹ï¼š if(column.getMysqlType().toUpperCase().equals("LONGBLOB")){                     logger.info(">>>>>> is blob\n");                     logger.info("\n>>>>>> column.getValue() is: " + column.getValue());                     logger.info("\n\n\n\n\n\n>>>>>> new String(column.getValue().getBytes(\"iso8859-1\") \"UTF-8\") is: " + new String(column.getValue().getBytes("iso8859-1"))); } è¯·æ•™å¤§ç¥å¦‚ä½•fixï¼Ÿ ç”¨ getValueBytesæ–¹æ³•æ‹¿åŸå§‹bytes è¿˜æ˜¯getBytesValueï¼Ÿç”¨çš„çˆªæœºæ²¡åŠæ³•ç¡®è®¤ã€‚ èƒ½è®²çš„è¯¦ç»†ç‚¹å—ï¼Ÿå¤§ç¥ columnæ²¡æœ‰getBytesValueæ–¹æ³•ï¼Œåº”è¯¥æ˜¯getBytesValue ``` try {                 if (StringUtils.containsIgnoreCase(column.getMysqlType()  "BLOB")                     || StringUtils.containsIgnoreCase(column.getMysqlType()  "BINARY")) {                     // get value bytes                     builder.append(column.getName() + " : "                                    + new String(column.getValue().getBytes("ISO-8859-1")  "UTF-8"));                 } else {                     builder.append(column.getName() + " : " + column.getValue());                 }             } catch (UnsupportedEncodingException e) {             } ```             public java.lang.String getValue() {                 java.lang.Object ref = value_;                 if (!(ref instanceof java.lang.String)) {                     com.google.protobuf.ByteString bs = (com.google.protobuf.ByteString) ref;                     //ç”¨getValue()è¿™é‡Œå°±å·²ç»ç”¨utf8ç¼–ç äº†                     java.lang.String s = bs.toStringUtf8();                     if (bs.isValidUtf8()) {                         value_ = s;                     }                     return s;                 } else {                     return (java.lang.String) ref;                 }             }             public com.google.protobuf.ByteString getValueBytes() {                 java.lang.Object ref = value_;                 if (ref instanceof String) {                     com.google.protobuf.ByteString b = com.google.protobuf.ByteString.copyFromUtf8((java.lang.String) ref);                     value_ = b;                     return b;                 } else {                     //æ‹¿åˆ°åŸå§‹çš„ByteString                     return (com.google.protobuf.ByteString) ref;                 }             } @alexlgj å…ˆè¯•è¯• @agapple çš„å§ã€‚    å°è±¡åœ¨1.0.22ç‰ˆæœ¬é‡ŒgetValue ï¼ˆvarbinaryï¼‰ä¼šæœ‰ä¿¡æ¯ä¸¢å¤±ï¼›é‚£æ—¶å€™ç›´æ¥è¿›å»æ”¹äº†ç¼–ç ã€‚ @agapple @lcybo å¥½çš„ï¼Œè°¢è°¢ä¸¤ä½å¤§ç¥çš„æŒ‡å¯¼ï¼Œæˆ‘è¿™è¾¹ç½‘é€Ÿä¸æ€ä¹ˆæ ·ã€‚å›å¤æ…¢äº†ï¼Œä¸å¥½æ„æ€ åšäº†ä¸ªå®éªŒï¼š         byte[] bs = {-1  -2};   //byteæ˜¯è´Ÿæ•°çš„æƒ…å†µï¼Œè¿™ä¸ªå°±çœ‹ä½ æ•°æ®åº“çš„ç¼–ç äº†         ByteString bstring = ByteString.copyFrom(bs);         String utf = bstring.toStringUtf8();         System.out.println(utf);    //ä¸¢æ•°æ®äº†ï¼Œå˜æˆäº†ä¸¤ä¸ª65533         String iso = new String(utf.getBytes("ISO-8859-1")  "UTF-8");         System.out.println(iso);    //æ²¡æœ‰åŠæ³•è¿˜åŸï¼Œå˜æˆä¸¤ä¸ª63 @alexlgj ç¼–ç é—®é¢˜è›®æœ‰æ„æ€çš„   æŒ‰ç…§@agappleçš„æ–¹æ³•å¯ä»¥æˆåŠŸè§£ç ï¼ˆblobå­—æ®µå†…å®¹ä¸ºä¸­æ–‡â€œåŒ—äº¬â€ï¼‰ column.getvalueå¾—åˆ°ï¼› "image\\\":\\\"Ã¥\\\\u008C\\\\u0097Ã¤ÂºÂ¬\\\" \\\ new String(column.getValue().getBytes("ISO-8859-1")  "UTF-8"))å¾—åˆ°ï¼š "image\\\":\\\"åŒ—äº¬\ æˆ‘ç”¨çš„canalæ˜¯1.0.24ç‰ˆæœ¬ï¼Œæ‚¨ä¾‹å­ä¸­çš„æ˜¯æ²¡æœ‰è®¿é—®æ•°æ®åº“ï¼Œä¸ºä»€ä¹ˆè¯´â€œ//byteæ˜¯è´Ÿæ•°çš„æƒ…å†µï¼Œè¿™ä¸ªå°±çœ‹ä½ æ•°æ®åº“çš„ç¼–ç äº†â€ï¼Ÿ latin1 128-255ç”¨ä¸€ä¸ªbyteæ˜¯è´Ÿæ•°è¡¨ç¤ºï¼Œæœ‰è´Ÿæ•°åœ¨utf-8é‡Œé¢ä»£è¡¨å¤šå­—èŠ‚ï¼Œæ˜¯æœ‰ä¸€å®šè§„èŒƒçš„ã€‚128-255çš„sequenceå¾ˆæœ‰å¯èƒ½è¿åè¿™äº›è§„èŒƒï¼Œå°±å˜æˆï¿½äº† å¦‚æœæœ‰ç¡¬ç¼–ç çš„ä¸œè¥¿ï¼ˆæ— åºçš„128-255ï¼Œéutf-8çš„ç¼–ç ï¼‰ï¼Œè¿˜æ˜¯æ‹¿åŸå§‹çš„byteStringå§ã€‚ å¦‚æœcanalæ”¾è¿›å»çš„stringï¼Œå°±æ˜¯ç”¨çš„iso-8859-1ç¼–ç è¿‡çš„ï¼Œé‚£å¿½ç•¥æˆ‘è¯´çš„å§ï¼Œé€ƒäº†ã€‚ @lcybo æ˜ç™½äº†ï¼Œéå¸¸æ„Ÿè°¢ï¼Œå¤§å¤§çš„èµ @lcybo ä¹‹å‰serverç«¯ä¼ blobç±»å‹æ—¶å¼ºè½¬äº†stringç±»å‹ï¼Œæ¯”è¾ƒåˆç†çš„åšæ³•æ˜¯ç”¨ByteStringï¼Œä½†ç°åœ¨ä¸èƒ½æ”¹ï¼Œå·²æ”¹è€ç”¨æˆ·çš„blobè§£æå¤„ç†éƒ½ä¼šä¹±ç äº† ç†è§£ ä¸¤ä½å¤§ç¥ï¼Œæˆ‘è¿˜æœ‰äº›ç–‘é—®ï¼š 1. æ˜¯ä¸æ˜¯canal serverç«¯ä¼šå¯¹mysql binlogçš„æ‰€æœ‰å­—æ®µåšiso-8859-1ç¼–ç æˆstringï¼Ÿ 2. å¯¹ç¼–ç å®Œå…¨ä¸æ‡‚ï¼Œ èƒ½å¸®å¿™è§£é‡Šä¸‹ä¸ºä»€ä¹ˆè¿™æ ·æ›´æ”¹ç¼–ç å°±èƒ½æ­£ç¡®è§£æå‡ºå­˜å…¥blobç±»å‹çš„å­—ç¬¦ä¸²ï¼ˆ"åŒ—äº¬â€œï¼‰ï¼šnew String(column.getValue().getBytes("ISO-8859-1")  "UTF-8")) ï¼Ÿè¯¥ä»£ç ä¸­çš„ä¸åŒç¼–ç çš„æ‰§è¡Œé¡ºåºæ˜¯æ€æ ·çš„ï¼Ÿ ï¼ˆæˆ‘çš„ç†è§£æ˜¯canal serverå¯¹blobå­—æ®µçš„byteæ•°ç»„åšiso-8859-1ç¼–ç ï¼Œä½†æ˜¯iso-8859-1ç¼–ç ä¸èƒ½è¡¨ç¤ºä¸­æ–‡â€œåŒ—äº¬â€ï¼ˆä¹±ç ï¼‰ã€‚è¿™æ—¶æ‰§è¡Œcolumn.getValue()æ–¹æ³•ä¼šè¿›å…¥åˆ°ï¼šif (!(ref instanceof java.lang.String)) {   å¯¹refè¿›è¡Œutf8-stringï¼‰ å¤§ç¥ï¼Œå¦å¤–æˆ‘æƒ³é—®ä¸‹ï¼Œcolumn.getValueBytes().toByteArray()è¿”å›çš„æ˜¯blobå­—æ®µoriginal å­—èŠ‚æ•°ç»„å—ï¼Ÿè¿˜æ˜¯æ€»æ˜¯utf-8ç¼–ç æˆ–è€…å…¶ä»–ç¼–ç çš„å­—èŠ‚æ•°ç»„ï¼Ÿä¸ºä»€ä¹ˆcanalä¸­(column.getValueBytes().toByteArray()ä¸€ä¸ªæ±‰å­—å¯¹åº”6ä¸ªå­—èŠ‚å‘¢ï¼Ÿ è¿™æ˜¯æˆ‘çš„æµ‹è¯•ç»“æœï¼š æ’å…¥çš„blobå­—æ®µå€¼ï¼š â€0123abc" javaç¨‹åºä¸­æ‰“å°æ’å…¥çš„stringçš„äºŒè¿›åˆ¶æ•°ç»„å†…å®¹ï¼š Arrays.toString(â€0123abc".getBytes()) isï¼š [48  49  50  51  97  98  99] canalä¸­è·å¾—çš„äºŒè¿›åˆ¶æ•°ç»„å†…å®¹ï¼š Arrays.toString(column.getValueBytes().toByteArray() isï¼š [48  49  50  51  97  98  99] blobå­—æ®µå€¼ï¼šâ€ä¸Šâ€: Arrays.toString(â€ä¸Š".getBytes()) isï¼š [-28  -72  -118]  Arrays.toString(column.getValueBytes().toByteArray() is: [-61  -92  -62  -72  -62  -118] blobå­—æ®µå€¼ï¼šâ€ä¸Šæµ·â€: Arrays.toString(â€ä¸Šæµ·".getBytes()) isï¼š [-28  -72  -118  -26  -75  -73] Arrays.toString(column.getValueBytes().toByteArray() isï¼š [-61  -92  -62  -72  -62  -118  -61  -90  -62  -75  -62  -73] 1.ä»agappleå¤§ç¥çš„æè¿°ï¼Œåº”è¯¥æ˜¯åªæœ‰blobå’Œbinaryè¿™ä¹ˆåšäº† å¦ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœç”¨isoç¼–ç æˆstringã€‚é‚£ä¹ˆstringå†…ä¸€ä¸ªcharå®é™…ä¸Šæ”¾çš„å°±æ˜¯å•ä¸ªbyteï¼Œæ‰“å°å‡ºæ¥æ˜¯ä¹±ç ï¼Œä½†å®é™…æ•°æ®æ ¼å¼æ²¡æœ‰ä¸¢å¤±ã€‚ æ‚¨çš„æ„æ€æ˜¯è¯´è™½ç„¶æ‰“å°å‡ºæ¥æ˜¯ä¹±ç ï¼Œä½†æ˜¯äºŒè¿›åˆ¶æ•°æ®æœ¬èº«è¿˜æ˜¯ä¿æŒä¸å˜çš„å—ï¼Ÿé‚£ä¸ºä»€ä¹ˆï¼šnew String(column.getValue().getBytes("UTF-8")  "UTF-8"))æ‰“å°çš„ç»“æœæ˜¯ä¹±ç å‘¢ï¼Ÿ getBytes("UTF-8")ç­‰åŒäºç”¨utf-8å»ç¼–ç é‚£ä¸€å †ä¹±ç ï¼Œæ‰“å°å‡ºæ¥çš„å½“ç„¶æ˜¯ä¹±ç  æˆ‘åˆšè¯·æ•™äº†ä¸‹åŒå­¦ä¸€äº›ç¼–ç çš„çŸ¥è¯†ï¼Œç°åœ¨åŸºæœ¬èƒ½ç†è§£äº†ï¼Œè°¢è°¢å¤§ç¥çš„è€å¿ƒæŒ‡å¯¼ï¼Œæ£’æ£’å“’
803,canalConnector.subscribe()ä¼šæŠŠçº¿ç¨‹é˜»å¡ï¼Œé€ æˆstopæ— æ³•åœæ­¢ å½“ä»¥zookeeper HAæ¨¡å¼æ¥å¯åŠ¨å¤šä¸ªCanal Clientæ—¶ï¼Œå¦‚æœæŸä¸ªCanal Clientå·²ç»æˆåŠŸsubsribeï¼Œåˆ™å½“å‰å¯åŠ¨çš„Canal Clientä¼šé˜»å¡åœ¨canalConnector.subscribe()æ–¹æ³•ä¸Šã€‚ æ­¤æ—¶å†è°ƒç”¨å¦‚ä¸‹çš„stopæ–¹æ³•ï¼Œä¼šé˜»å¡åœ¨joinå¤„ï¼Œé€ æˆæ— æ³•æ­£å¸¸çš„stop     public void stop() {         if (!running) {             return;         }         //canalConnector.stopRunning();è¯¥ç‰ˆæœ¬çš„canal-clientä¸æ”¯æŒ         running = false;         if (thread != null) {             try {                 **thread.join();**             } catch (InterruptedException e) {                 e.printStackTrace();             }         }         KafkaProducerUtil.stop();         MDC.remove("destination");     } æˆ‘çœ‹æ–°ç‰ˆçš„exampleçš„stopæ–¹æ³•ä¸­å¢åŠ äº†å¦‚ä¸‹çš„ä»£ç ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯ä¸ºäº†è§£å†³ä¸Šé¢çš„é—®é¢˜çš„ï¼Ÿ connector.stopRunning(); å¦‚æœæ˜¯ï¼Œé‚£ä¹ˆä¹‹å‰ç‰ˆæœ¬è¯¥æ€ä¹ˆè§£å†³é˜»å¡çš„é—®é¢˜å‘¢ï¼Ÿ canalæ˜¯é€šè¿‡è¿™ä¸ªæœºåˆ¶æ¥å®ç°clientç«¯çš„HAçš„. å µå¡æ˜¯ä¸ºäº†é¿å…åŒæ—¶æœ‰ä¸¤ä¸ªç›¸åŒçš„clientè¿›è¡Œæ¶ˆè´¹
802,canal exampleå¢åŠ æ•°æ®åŒæ­¥çš„æ ·ä¾‹ä»£ç  clientå±‚é¢çš„åº”ç”¨ä¸°å¯Œï¼ŒæœŸæœ›æä¾›ä¸€ä¸ªåŸºäºåŒæ­¥åˆ°æ•°æ®åº“çš„æ ‡å‡†å®ç°
801,canal dockeråŒ–æ‰“åŒ…æ”¯æŒ 1.  å¢åŠ Dockerfileï¼Œæ”¯æŒall in oneçš„æ‰“åŒ…æ–¹å¼(centos + jdk + canal) 2. å‚æ•°å±‚é¢ï¼Œå…è®¸docker -eå˜é‡ä¼ é€’å’Œä¿®æ”¹ (javaé‡Œé€šè¿‡System.getenvè¯»å–) 3. äº¤ä»˜å½¢å¼ - å…è®¸ç”¨æˆ·åŸºäºDockerfileè¿›è¡Œæºç æ‰“åŒ… - ä¸Šä¼ åˆ°Docker hubï¼Œå…è®¸ç”¨æˆ·ç›´æ¥å…¬ç½‘ä¸‹è½½ å¯¹åº”çš„dockerä½¿ç”¨æ–‡æ¡£ï¼šhttps://github.com/alibaba/canal/wiki/Docker-QuickStart
800,canalåŸç”Ÿæ”¯æŒä¸€ä¸‹RocketMQå¯¹æ¥ RocketMQï¼š https://rocketmq.apache.org/ canalåŸç”Ÿæ”¯æŒä¸€ä¸‹æ•°æ®å†™å‡ºåˆ°RocketMQ ä»£ç å·²æäº¤  å‚è€ƒæ–‡æ¡£: https://github.com/alibaba/canal/wiki/Canal-Kafka-RocketMQ-QuickStart 
799,å…³äºcanalæ¥æ”¶åˆ°æ•°æ®çš„æ’åºé—®é¢˜? å½“åŒæ—¶åŒä¸€ä¸ªcust_id ä¾æ¬¡è¿›è¡Œæ–°å¢ ä¿®æ”¹ åˆ é™¤ æ–°å¢ canalæ¥æ”¶åˆ°ä¸¤æ¡æ•°æ®çš„æ•°æ®: å¦‚: cust_id ç±»å‹ sqlæ‰§è¡Œæ—¶é—´ 001 add 1533002422 001 update 1533002422 001 delete 1533002423 001 add  1533002423 è¿™æ ·çš„è¯å‡ºç°ä¸€ä¸ªé—®é¢˜ æˆ‘åšæ•°æ®ä»“åº“çš„æ‹‰é“¾è¡¨çš„æ—¶å€™ æ— æ³•çŸ¥é“ 001 ç”¨æˆ·åœ¨1533002423æ¯«ç§’æƒ…å†µä¸‹addå’Œdeleteçš„é¡ºåº æˆ‘çš„é—®é¢˜æ˜¯ è¿™ç§æƒ…å†µä¸‹ è¿˜æœ‰å…¶ä»–çš„å­—æ®µèƒ½æä¾›å¯¹äºåŒä¸€ä¸ªsqlæ‰§è¡Œæ—¶é—´ å¯¹æ•°æ®è¿›è¡Œæ’åºåŒºåˆ†å‰åé¡ºåº binlogé‡Œå°±æ˜¯é¡ºåºå…³ç³» cust_id æ˜¯ä¸»é”®å—ï¼Ÿå¦‚æœæ˜¯ä¸»é”®ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰addä¸¤æ¬¡çš„æƒ…å†µå‘¢ï¼Ÿï¼Ÿ mysql binlogæœºåˆ¶æ¯”è¾ƒå¤æ‚ï¼Œå†…éƒ¨å¾ˆå¤šä¼˜åŒ–ã€‚transactionå†…éƒ¨åªä¿è¯slaveæ‰§è¡Œåçš„æœ€ç»ˆç»“æœä¸€è‡´ã€‚
798,canalä¸­çš„transaction IDè·å–å’Œentry.getHeader().getLogfileOffset()åç§»é‡çš„ç†è§£ï¼Ÿ é—®é¢˜1:  canalçš„ä¸€ä¸ªmessageå¯èƒ½ä¼šå¯¹åº”mysqlä¸­çš„å¤šä¸ªtransactionï¼Œé€šè¿‡æ–¹æ³•message.getEntries()å¯ä»¥è·å¾—List<Entry> entrysï¼Œentryåˆ åˆ†ä¸ºtransanctionBegin/ transactionEndä»¥åŠrowdataã€‚ ç°åœ¨é—®é¢˜æ˜¯ï¼Œæˆ‘åœ¨  > è·å–transaction id<  çš„æ—¶å€™åªæœ‰é€šè¿‡transactionEnd.getTransactionIdæ‹¿åˆ°çš„æ˜¯æ­£å¸¸çš„æ•°å­—ï¼Œä½†æ˜¯é€šè¿‡transactionbeginå’Œrowdataè·å–åˆ°çš„åˆ™éƒ½æ˜¯nullã€‚  è¯·é—®canalä¸­è¿˜æœ‰å…¶ä»–æ–¹æ³•è·å–åˆ°transaction idå—ï¼Ÿ é—®é¢˜2:  entry.getHeader().getLogfileOffset()è·å–çš„åç§»é‡æ˜¯å½“å‰ï¼ˆentryï¼‰rowdataåœ¨æ—¥å¿—æ–‡ä»¶ä¸­çš„åºå·ï¼ˆå³ç¬¬å‡ æ¡æ—¥å¿—ï¼‰è¿˜æ˜¯å­—èŠ‚æ•°ï¼ˆå³è¯¥rowå‰é¢çš„æ•°æ®æ‰€å çš„å­—èŠ‚æ•°ï¼‰ï¼Ÿ æ±‚å¤§ç¥èµæ•™ï¼ è°¢è°¢ è‡ªå·±åŠ¨æ‰‹é€šè¿‡mysqlbinlog --hexdumpå¯ä»¥æŸ¥çœ‹åˆ°commitæ‰æœ‰xidã€‚ offsetæ˜¯å­—èŠ‚åç§»ã€‚ æ£’ï¼Œè°¢è°¢å¤§ç¥
797,canalå¦‚ä½•åŒºåˆ†ä¸€æ¬¡transactionä¸­çš„å¤šæ¡è®°å½•rowdata mysqlä¸­ä¸€æ¬¡transactionå¯èƒ½åŒ…å«å¤šæ¡è®°å½•ï¼ˆrowdataï¼‰ï¼Œé‚£ä¹ˆcanalæ˜¯å¦‚ä½•åŒºåˆ†è¿™äº›è®°å½•çš„å‘¢ï¼Ÿæœ‰æ²¡æœ‰ç±»ä¼¼oracleä¸­çš„scn(system change number)æ¥å”¯ä¸€æ ‡è¯†å¯¹æŸä¸ªè®°å½•æ‰€åšçš„æ›´æ”¹ï¼Ÿ #751 çœ‹ä¸€ä¸‹è¿™ä¸ªpræ˜¯ä¸æ˜¯æ»¡è¶³ä½ è¯´çš„åœºæ™¯ pr? ä¸å¥½æ„æ€ï¼Œæ–¹ä¾¿è§£é‡Šçš„è¯¦ç»†ç‚¹å—ï¼Ÿ ä¸å¥½æ„æ€ï¼Œåˆšæ²¡çœ‹åˆ°é“¾æ¥ï¼Œè°¢è°¢
796,æœ¬åœ°è°ƒè¯•SimpleCanalClientTestæŠ›å¼‚å¸¸java.net.ConnectException: Connection refused: connectè§£å†³åŠæ³• ![image](https://user-images.githubusercontent.com/16176283/43498536-f031ab84-9579-11e8-9bc6-09ca48546cbf.png) å°†com.alibaba.otter.canal.example.SimpleCanalClientTest ç±»ä¸­çš„ç›¸åº”å†…å®¹æ”¹æˆå®é™…å†…å®¹å³å¯è§£å†³
794,kafkaé›†æˆï¼Œcanal eventå§‹ç»ˆæ¥æ”¶ä¸åˆ°æ•°æ®ï¼Œä¸çŸ¥é“ä»€ä¹ˆåŸå›  see PR #790 
793,ByteStringå¦‚ä½•è½¬æ¢ä¸ºCanalEntry.Entry? example çš„ä»£ç é‡Œæœ‰ ``` ... CanalEntry.Entry.parseFrom(byteString) ``` OK
792,Received EOF packet from server ![image](https://user-images.githubusercontent.com/18360996/43445241-7a85f184-94d8-11e8-87f6-1bf1f0b8ddba.png) å¦‚æœslaveId è®¾ç½®ç¡®å®æ²¡æœ‰é‡å¤çš„è¯ï¼Œæœ€å¤§å¯èƒ½è¯·å…ˆå‚è€ƒ #777 
791,ä¸ºä»€ä¹ˆinsertä¼šè¢«è§£ææˆddlï¼Ÿ RowChangeå¯¹è±¡ä¿¡æ¯å¦‚ä¸‹ã€‚ unknownFields = {UnknownFieldSet@1470} "" bitField0_ = 30 tableId_ = 0 eventType_ = {CanalEntry$EventType@1609} "INSERT" isDdl_ = true sql_ = "insert into `test`(`school_student_id`  `school_group_id`  `like_user_id`  `school_event_id`) values('114'  '1'  '66889278'  '61')" rowDatas_ = {Collections$EmptyList@1473}  size = 0 props_ = {Collections$EmptyList@1473}  size = 0 ddlSchemaName_ = "test" memoizedIsInitialized = 1 memoizedSerializedSize = -1 memoizedSize = -1 memoizedHashCode = 0 1.  æ£€æŸ¥binlogæ˜¯å¦ä¸ºrowæ¨¡å¼ 2. rowæ¨¡å¼ä¸‹çš„RowsQueryLogEventäº‹ä»¶ 1.0.26æœ‰è§£å†³è¿™ä¸ªé—®é¢˜ä¸ï¼Ÿ https://github.com/alibaba/canal/wiki/FAQ
790,kafka producer é€‚é… row data for performance #726 tks
789,å¯åŠ¨ä¸äº† ![image](https://user-images.githubusercontent.com/18360996/43390651-4090cdb2-9421-11e8-9e18-4b1d13f8e758.png) å‚ç…§ #777 
788,canalå¯¹æ¥æ€§èƒ½é‡‡æ ·åˆç‰ˆ Hi         ä¸ªäººçš„ä¸€äº›å®ç°æ€è·¯å¦‚ä¸‹ï¼š 1. plugableï¼šä¸ºäº†æ–¹ä¾¿ä»¥åå¯¹æ¥prometheusä»¥å¤–çš„æ–¹æ¡ˆï¼Œå¹¶ä½¿ç›¸å…³ä»£ç é›†ä¸­ï¼Œä½¿ç”¨äº†service provideræœºåˆ¶ï¼ˆCanalServerWithEmbeddedä¸­åŠ è½½serviceï¼‰ï¼Œç”¨runtime scopeåœ¨deployerçš„pomé‡ŒæŒ‡å®šå®ç°ï¼š <!-- è¿™é‡ŒæŒ‡å®šruntimeçš„metrics provider--> 	<dependency> 		<groupId>com.alibaba.otter</groupId> 	        <artifactId>canal.prometheus</artifactId> 		<version>${project.version}</version> 		<scope>runtime</scope> 	</dependency> 2. å°½å¯èƒ½ä¸æ”¹åŠ¨canalçš„é€»è¾‘ä»£ç ï¼Œå½“å‰çš„æäº¤å¯¹åŸæœ‰ä»£ç æ”¹åŠ¨å¦‚ä¸‹ï¼š a. CanalServerWithEmbedded (ServiceProvideré€»è¾‘) b. startup.sh (åŠ è½½ä¸€ä¸ªjavaagentï¼Œç”¨äºLTW(load time weaving))ï¼Œç›®å‰æ³¨æ‰äº†ï¼Œç­‰ç‰ˆæœ¬ç¨³å®šã€‚ c. deployerçš„pomï¼ˆæŒ‡å®šmetricså®ç°ï¼‰ï¼Œç›®å‰åŒæ ·æ³¨æ‰äº†ã€‚ å› æ­¤ï¼Œç›®å‰ä¸ä¼šå½±å“canalçš„é€»è¾‘ã€‚å¯åŠ¨metricsçš„æ–¹å¼ä¸ºæŠŠæ³¨æ‰çš„é…ç½®åŠ ä¸Šï¼Œå†mvn installã€‚ 3. å½“å‰å®ç°çš„metricsæœ‰ï¼š - jvm å…¨å®¶æ¡¶ - canal_net_inbound_bytes  ä»mysqlæ¥æ”¶çš„æ•°æ®é‡ï¼Œå•ä½byteï¼Œç”¨rateå¯è®¡ç®—é€Ÿç‡ã€‚ - canal_net_outbound_bytes  å‘clientå‘é€çš„æ•°æ®é‡ï¼Œå•ä½byteï¼Œç”¨rateå¯è®¡ç®—é€Ÿç‡ã€‚ - canal_instance  instance åˆ—è¡¨ - canal_instance_traffic_delay  å„instanceçš„delayã€‚ç›®å‰è¿˜æœ‰limitationï¼Œåœ¨mysql binlogä¸æ›´æ–°æ—¶ï¼Œdelayä¼šä¸€ç›´å¢åŠ ï¼Œç›®å‰çš„æ€è·¯æ˜¯åˆ©ç”¨mysqlçš„master heart beat packetè¿›è¡Œåˆ·æ–°ï¼Œéœ€è¦è§£æè¿™ä¸ªåŒ…ï¼ŒTODO - eventstore çš„produceå’Œackç´¢å¼•ï¼š'canal_instance_store_produce_seq'ä¸'canal_instance_store_consume_seq' å¯ç”¨äºè®¡ç®—TPS(rate(canal_instance_store_consume_seq))å’Œringbuffer remain evnets cound(canal_instance_store_produce_seq - canal_instance_store_consume_seq) å…¶ä»–çš„metricsè¯·è¡¥å……ã€‚ 4. ä¸€äº›å¾…å®Œå–„çš„TODOï¼š - HttpServeræ˜¯å¦éœ€è¦æ”¯æŒhttpsã€‚ - æœ¬æœºæµ‹è¯•ç”¨çš„æ˜¯debugï¼ŒUTä¹‹åè¡¥ä¸Šã€‚ - å‚æ•°å¯é…ç½®åŒ–ã€‚ - ... æ€è™‘æœ‰ä¸å‘¨çš„åœ°æ–¹ï¼Œæ¬¢è¿å¤§å®¶è¡¥å……å¹¶æå‡ºcommentsã€‚ Best regards è¦åœ¨IDEé‡Œé¢debugæ–°featureçš„è¯ï¼Œvmargè¦åŠ ä¸Š -javaagent:/pathto/aspectjweaver-${version}.jar çœ‹äº†ä¸‹ï¼Œç»“æ„æ¯”è¾ƒä¸é”™ï¼Œæœ‰å‡ ä¸ªå»ºè®®ï¼š 1.  å¯ä»¥é€‚å½“æ”¹åŠ¨ä¸»ä½“serverçš„ä»£ç ï¼Œä¸ºç›‘æ§åšä¸€äº›åŸ‹ç‚¹ï¼Œè¿™ä¹Ÿæ˜¯éå¸¸æœ‰å¿…è¦çš„ (é€šè¿‡aspectå¹¶ä¸æ˜¯ç‰¹åˆ«å»ºè®®) 2. é’ˆå¯¹ç›‘æ§åŒºåˆ†å®ä¾‹çº§å’Œdestinationçº§ï¼Œæ¯”å¦‚ç½‘ç»œæµé‡è¯»å–å’Œå†™å‡ºï¼Œå¯ä»¥åŒºåˆ†å‡ºä¸åŒçš„destination (å› ä¸ºä¸šåŠ¡ä¸Šç»å¸¸è¦æ‰¾å‡ºè°æ˜¯æ£è›‹ä»½å­ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯ä¸ªåˆ«çš„destinationå½±å“äº†æ•´ä½“) @agapple æ„Ÿè°¢commentsï¼Œæˆ‘ä¼šå¥½å¥½æƒ³æƒ³å¦‚ä½•è¿›è¡Œrefactorã€‚ BTWï¼Œè¯·æ•™ä¸€ä¸‹aspectåœ¨åšåŸ‹ç‚¹æ–¹é¢çš„åŠ£åŠ¿ã€‚ ä¸»è¦åœ¨äºä¸€äº›ç»´æŠ¤æ€§ï¼Œç›‘æ§åº”è¯¥å±äºcanalå†…ç½®çš„èƒ½åŠ›(ç†æƒ³æƒ…å†µåº”è¯¥æ˜¯æ•´ä¸ªbinlog->parser->sink->store->clientï¼Œèƒ½å®Œæ•´åŸ‹ç‚¹åšé‡‡æ ·å¾—åˆ°æ€§èƒ½æ•°æ®)ï¼Œåšå¤–å›´éå¸¸çµæ´»çš„å¯æ’æ‹”å¹¶ä¸æ˜¯éå¸¸æœ‰æ„ä¹‰ @agapple å—¯ï¼Œæ˜ç™½äº†ã€‚ç®€å•æ¥è¯´å°±æ˜¯åˆ©ç”¨canal serverçš„ç°æœ‰æœºåˆ¶åšä¸€äº›neutralçš„åŸ‹ç‚¹ã€‚å·²ç»æœ‰ä¸€äº›æƒ³æ³•äº†ï¼Œæœ‰ç©ºæ•´ç†å‡ºæ¥ã€‚
787,ç”¨show processlist å‘½ä»¤çœ‹ä¸åˆ°dumpè¿›ç¨‹ [v1.0.26.alpha4]  canalå¯åŠ¨èµ·æ¥åï¼Œå¼€å§‹dump ä¸ºä»€ä¹ˆåœ¨mysqlç«¯ï¼Œç”¨show processlist å‘½ä»¤çœ‹ä¸åˆ°dumpè¿›ç¨‹ ç¡®è®¤ä¸€ä¸‹æ˜¯ä¸æ˜¯å¼€å§‹æ¶ˆè´¹æ•°æ®äº†ï¼š instanceæ—¥å¿—é‡Œæœ‰æ²¡æœ‰find start position : EntryPosition[included=false journalName=xxxx position=xxxx serverId=<null> gtid=<null> timestamp=<null>]. ç„¶åmeta.logæœ‰æ²¡æœ‰æŒç»­åˆ·æ–° show slave hosts å¯ä»¥çœ‹åˆ°canalçš„dumpè¿›ç¨‹
786,è¯·æ•™Canalè®¢é˜…é˜¿é‡Œäº‘RDS(MySql)çš„æ¡ˆä¾‹ [ä¸šåŠ¡åœºæ™¯] ç°æœ‰é˜¿é‡Œäº‘RDSï¼ˆMySql)æ•°æ®åº“ï¼Œæƒ³é€šè¿‡è‡ªå·±å®‰è£…canalï¼Œè®¢é˜…RDSæ•°æ®çš„binlogã€‚ è¯·å¤§ç¥æä¾›æ¡ˆä¾‹ã€‚ å¤šè°¢ã€å¤šè°¢~ å‚è€ƒï¼šhttps://github.com/alibaba/canal/wiki/FAQ
785,no meda.dat  I accidentally deleted the fileï¼šmeta.datï¼ˆBelow each instanceï¼‰  what should I doï¼Ÿ set position info in instance.properties  which you could find in meta.log.However  there might be an overlap. the latest one in meta.log @lcybo Do I need to manually create meta.dat and copy the contents of meta.log into newly meta.dat? It would be created and maintained by metamanager automatically. @lcybo Unfortunately  it doesn't automatically generate in the document. Is it because I didn't configure position and what should position fill in? @lcybo I know why I did not generate meta.dat files because I did not add the following sentence to my code: connector.subscribe (* * \ \ \ * *); @lcybo  But is this not dispensable  as long as the canal.instance.filter.regex in the Instance.properties should not be configured with connector.subscribe (". * \ \.. *"); position is selected by following priority: 1.meta.dat 2.instance.properties 3.the position via 'show master status'(probably events lost) the meta.dat would be created after successful subscription if not exist. @lcybo Now you can automatically generate meta.dat  but now I have to write connector.subscribe () in the program; connector is the CanalConnector type. If I write this  the filter attribute in Instance.properties will be rewritten into an empty string  and I can't let canal.instance.filter.regex in Instance.properties now. What do I do to make it work  rather than using connector.subscribe () in the program? Yes  filter is not necessary. Canal server work with canal client together  there is a example client in canal project. Here is the code slice:     protected void process() {         int batchSize = 5 * 1024;         while (running) {             try {                 MDC.put("destination"  destination);                 connector.connect();                 connector.subscribe();                 while (running) {                     Message message = connector.getWithoutAck(batchSize); // è·å–æŒ‡å®šæ•°é‡çš„æ•°æ®                     long batchId = message.getId();                     int size = message.getEntries().size();                     if (batchId == -1 || size == 0) {                         // try {                         // Thread.sleep(1000);                         // } catch (InterruptedException e) {                         // }                     } else {                         printSummary(message  batchId  size);                         printEntry(message.getEntries());                     }                     connector.ack(batchId); // æäº¤ç¡®è®¤                     // connector.rollback(batchId); // å¤„ç†å¤±è´¥  å›æ»šæ•°æ®                 }             } catch (Exception e) {                 logger.error("process error!"  e);             } finally {                 connector.disconnect();                 MDC.remove("destination");             }         }     } @lcybo  If I write connector.subscribe () in the program again  the regex on the server side will be covered. How can I make regex not cover? a. If you call subscribe()  then canal.instance.filter.regex is used  ignore the empty string in meta.dat. b.Otherwise(subscribe(regex)) use the parameter 'regex' instead of canal.instance.filter.regex. @lcybo  It's like you saidï¼šyou call subscribe()  then canal.instance.filter.regex is used  ignore the empty string in meta.dat.The problem has been solvedï¼ŒThank you very muchã€‚ :)
784,canalserveræ”¯æŒä¸€ä¸ªinstanceå®ä¾‹æŠ½å–å¤šåº“çš„ä¹ˆï¼Ÿ canalserverä½¿ç”¨å•åº“instanceé…ç½®ï¼Œä¸åˆ†ç»„ï¼Œç„¶ååœ¨ä¸€ä¸ªå®ä¾‹ä¸­æŠ½å–å¤šä¸ªåº“çš„binlogæ—¥å¿—ã€‚è¿™ç§æ–¹å¼é…ç½®æ–¹æ³•æ”¯æŒä¹ˆï¼Ÿ å·²æ‰¾åˆ°é…ç½®æ–¹æ³•canal.instance.defaultDatabaseName=db1 db2ã€‚è¿™ä¸ªé…ç½®é€‚ç”¨äºåŒä¸€ä¸ªipã€portå®ä¾‹ä¸‹ä¸åŒåº“ã€‚åº“åä¹‹é—´ä½¿ç”¨é€—å·éš”å¼€ã€‚è¿™æ ·é…ç½®å³å¯ã€‚ æˆ‘è§‰å¾—ä½ ç†è§£å¾—æœ‰ä¸€ç‚¹å°é—®é¢˜ï¼Œä½ é‚£æ ·æ˜¯é…ç½®é»˜è®¤ç›‘å¬çš„å¤šä¸ªåº“ï¼Œä½†æœ€å¥½æ˜¯åœ¨ä¸‹é¢è¿™ä¸ªé…ç½®é¡¹ä¸­è¿›è¡Œæ­£åˆ™åŒ¹é…å°±å¥½äº† æ‰€æœ‰åº“ canal.instance.filter.regex = .*\\..* db1 db2 canal.instance.filter.regex = db1\\..* db2\\..* LSæ­£è§£
783,canalæ±‚è§£é‡Šä¸‹messageï¼Œentriesï¼ŒtransanctionIDï¼Œbatchid  eventä»¥åŠrowchangeçš„å…³ç³» æ­£åœ¨å­¦ä¹ canalçš„ä½¿ç”¨ï¼Œæ±‚å¤§ç¥æ¢³ç†ä¸‹canalä¸­å‡ ä¸ªæ¦‚å¿µçš„å…³ç³»ï¼š ç›®å‰æˆ‘çš„ç†è§£æ˜¯ï¼šä¸€ä¸ªmessageåŒ…å«å¤šä¸ªentryï¼ˆå…¶å…±åŒæ„æˆentriesï¼‰ï¼Œä¸€ä¸ªentryå¯¹åº”ä¸€ä¸ªeventtypeï¼ˆå¯ä»¥æ˜¯insert/deleteç­‰ï¼‰ï¼Œä¸€ä¸ªentryå¯ä»¥è§£æå¾—åˆ°ä¸€ä¸ªrowchangeï¼Œä¸€ä¸ªrowchangeå¯ä»¥è§£æå¾—åˆ°å¤šä¸ªrowdataï¼Œä¸€ä¸ªrowdataå¯ä»¥è§£æå¾—åˆ°beforeçš„columnsï¼ˆæ–¹æ³•getBeforeColumnsListï¼‰å’Œafterçš„columnsã€‚ - é—®é¢˜1: è¯·é—®å®ƒä»¬å†…éƒ¨çš„å…³è”æ˜¯æ€æ ·çš„ï¼Ÿ - é—®é¢˜2: transactionIDå’ŒbatchIDçš„åŒºåˆ«ï¼Ÿ - é—®é¢˜3: entry.getHeader().getSchemaName())å¯ä»¥è·å–åˆ°mysqlçš„schemaï¼Œä½†æ˜¯æ€ä¹ˆè·å–mysql çš„instanceï¼Ÿ è°¢è°¢ æ±‚å¤§ç¥æŒ‡ç‚¹ ä¸€ä¸ªmessageå°±æ˜¯getåˆ°çš„batch packetï¼ŒbatchIdæ˜¯å…¶æ ‡è¯†ï¼Œæ˜¯canalæ¦‚å¿µï¼›transactionIdæ˜¯mysqläº‹åŠ¡ç›¸å…³çš„ã€‚mysql binlog ä¼šå°†åŒè¡¨çš„åŒç±»å‹æ“ä½œï¼ˆinsert  updateç­‰ï¼‰çš„å˜æ›´è¡Œmergeä¸ºä¸€ä¸ªeventä»¥èŠ‚çœmetaå¼€é”€ï¼Œentryæ˜¯canal protoç±»å‹ï¼Œå¯¹åº”mysql eventã€‚rowdataå¯¹åº”æ¯ä¸€è¡Œæ•°æ®ã€‚beforeå’Œafterå¯¹åº”å˜æ›´å‰åï¼Œæ‰€ä»¥updateå…¼å…·ä¸¤è€…ï¼Œinsertåªæœ‰after deleteåªæœ‰beforeã€‚åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œæ¯”å¦‚å¼€å¯ndbçš„ä¸€äº›å‚æ•°ï¼Œupdateä¼šå˜æˆinsertç±»å‹ã€‚ ä½ å¥½ï¼Œè°¢è°¢ä½ çš„æŒ‡ç‚¹ï¼Œè®²å¾—å¾ˆæ¸…æ¥šã€‚æˆ‘è¿˜æœ‰ä¸ªé—®é¢˜ï¼šæˆ‘åœ¨mysqlä¸­åªæ’å…¥äº†ä¸€ä¸ªrowï¼Œä½†æ˜¯canalä¸­æ˜¾ç¤ºçš„entrys.size() æ˜¯3ï¼Œé‚£æˆ‘å¦‚ä½•çŸ¥é“å“ªä¸ªentryæ‰å¯¹åº”æˆ‘åˆšæ‰æ’å…¥çš„rowå‘¢ï¼Ÿ åº”è¯¥æ˜¯è¿˜æœ‰ transactionBegin å’Œ transactionEnd äº‹ä»¶ï¼Œå¯ä»¥æŒ‰ event ç±»å‹ç­›é€‰ä¸€ä¸‹ã€‚ On Jul 26  2018  18:20 +0800  alexlgj <notifications@github.com>  wrote: > ä½ å¥½ï¼Œè°¢è°¢ä½ çš„æŒ‡ç‚¹ï¼Œè®²å¾—å¾ˆæ¸…æ¥šã€‚æˆ‘è¿˜æœ‰ä¸ªé—®é¢˜ï¼šæˆ‘åœ¨mysqlä¸­åªæ’å…¥äº†ä¸€ä¸ªrowï¼Œä½†æ˜¯canalä¸­æ˜¾ç¤ºçš„entrys.size() æ˜¯3ï¼Œé‚£æˆ‘å¦‚ä½•çŸ¥é“å“ªä¸ªentryæ‰å¯¹åº”æˆ‘åˆšæ‰æ’å…¥çš„rowå‘¢ï¼Ÿ > â€” > You are receiving this because you are subscribed to this thread. > Reply to this email directly  view it on GitHub  or mute the thread. lsæ­£è§£ æ„Ÿè°¢å¤§ç¥çš„å›å¤ï¼Œç°åœ¨æ‡‚äº†ã€‚æµ‹è¯•äº†å‡ æ¬¡ï¼Œç»“æœå¦‚ä¸‹ï¼š ä¸€æ¬¡insertæˆ–deleteæˆ–è€…updateæ“ä½œ entrys.size() is: 3 è¿ç»­æ‰§è¡Œä¸‰æ¬¡insertæ•°æ®æ“ä½œï¼Œå†å¯åŠ¨canal client entrys.size() is: 9 å½“entryæ˜¯transactionbeginæˆ–transactionendï¼Œå¯¹åº”çš„eventtypeéƒ½æ˜¯update å½“entryæ˜¯rowdataï¼Œå¯¹åº”çš„eventtypeæ˜¯å¯¹åº”çš„æ“ä½œï¼Œå³insert/delete/update è¿˜é‡åˆ°ä¸ªé—®é¢˜ï¼Œå¦‚ä½•é€šè¿‡canalè·å–mysql databaseçš„instanceåç§°ï¼Œä»entryçš„headerä¸­åªæ‰¾åˆ°äº†schemaï¼ˆé€šè¿‡entry.getHeader().getSchemaName())ï¼Œä½†æ˜¯æ€ä¹ˆè·å–mysql çš„instanceï¼Ÿ instanceæ˜¯æŒ‡portåŒºåˆ†çš„mysqlå®ä¾‹å—ï¼Ÿ è€ƒè™‘ä¸€ä¸‹ç”¨serverIdåŒºåˆ† å¥½çš„ï¼Œéå¸¸æ„Ÿè°¢å¤§ç¥
782,MysqlMultiStageCoprocessorå¥å£®æ€§enhance Hi     æ–‡å“¥çš„commitè§£å†³äº†ç”±äºEOFåŒ…å¸¦æ¥çš„é—®é¢˜ã€‚     ä½†MysqlMultiStageCoprocessoråœ¨å…¶ä»–æƒ…å†µä¸‹ä»å­˜åœ¨å‡ºç°é—®é¢˜çš„å¯èƒ½ã€‚     è‹¥å¼‚å¸¸ä¸æ˜¯onEvent bodyé‡Œäº§ç”Ÿçš„ï¼Œå°±æ¯”å¦‚#771çš„InterruptedExceptionã€‚     onShutdowné‡Œçš„stopä¸dumpçº¿ç¨‹çš„resetï¼Œä¼šæœ‰ç«äº‰å‘ç”Ÿã€‚     å¦‚æœMysqlMultiStageCoprocessorä»…ä»…åœ¨dumpçº¿ç¨‹å†…ä¸²è¡Œè°ƒç”¨ï¼Œé‚£æ ·æ¯”è¾ƒå®‰å…¨ã€‚     æ‰€ä»¥æ”¹æˆï¼Œå‘ç”Ÿæ„å¤–exceptionï¼Œä¹Ÿç”±publishä¸­checkï¼Œç”±dumpçº¿ç¨‹è¿›è¡Œresetã€‚ Best regard [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=782) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=782) before we can accept your contribution.<br/><hr/>**Chuanyi Li L** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=782) it.</sub> [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=782) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=782) before we can accept your contribution.<br/><hr/>**Chuanyi Li L** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=782) it.</sub> tks @lcybo ä½ çš„incidentå®šä¹‰å’Œä¹‹å‰çš„exceptioné‡å¤äº†ï¼Œç›´æ¥åˆå¹¶ä¸ºä¸€ä¸ª okï¼Œæˆ‘å½“æ—¶è§‰å¾—canalParseExceptionå¯èƒ½æœ‰ç‰¹æ®Šå¤„ç†ï¼Œç¬¬äºŒä¸ªcommitç‰¹æ„åŠ äº†incidentåŒºåˆ†äº†ä¸€ä¸‹ã€‚çœ‹æ¥æƒ³å¤šäº†233 @lcybo é‚€è¯·ä½ åŠ å…¥é¡¹ç›®ç®¡ç†å‘˜ï¼Œéº»çƒ¦ç§ä¿¡æˆ‘é‚®ç®±è”ç³»æ–¹å¼ï¼šjianghang115@gmail.com @agapple å·²accpetï¼Œé‚®ç®±ï¼šchuanyili0625@gmail.com  è¯·å¤šå…³ç…§
781,æœ€æ–°ç‰ˆfastsql-preview 520 ï¼š com.alibaba.fastsql.sql.parser.ParserException fastsqlç‰ˆæœ¬ï¼š æœ€æ–°çš„520  sqlè¯­å¥ä»¥åŠExceptionï¼š case 1 :  sql_6 = "CREATE INDEX `idx_t_uid` on stu_score (`uid`) COMMENT '' ALGORITHM DEFAULT LOCK DEFAULT "; Exception in thread "main" com.alibaba.fastsql.sql.parser.ParserException: syntax error  error in :'ITHM DEFAULT LOCK DEFAULT  pos 134  line 1  column 136  token IDENTIFIER null 	at com.alibaba.fastsql.sql.parser.SQLParser.printError(SQLParser.java:363) 	at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:520) 	at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:92) 	at com.test.HelloWorld.main(HelloWorld.java:266) case 2: sql = "alter table test  COLLATE utf8mb4_unicode_ci" ; Exception in thread "main" com.alibaba.fastsql.sql.parser.ParserException: syntax error  error in :'LATE utf8mb4_unicode_ci'  expect =  actual null  pos 44  line 1  column 27  token IDENTIFIER utf8mb4_unicode_ci 	at com.alibaba.fastsql.sql.parser.SQLParser.printError(SQLParser.java:363) 	at com.alibaba.fastsql.sql.parser.SQLParser.accept(SQLParser.java:371) 	at com.alibaba.fastsql.sql.dialect.mysql.parser.MySqlStatementParser.parseAlterTable(MySqlStatementParser.java:4818) 	at com.alibaba.fastsql.sql.dialect.mysql.parser.MySqlStatementParser.parseAlter(MySqlStatementParser.java:3544) 	at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:264) 	at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:92) 	at com.test.HelloWorld.main(HelloWorld.java:266) case 3ï¼š sql_8 = "alter table task AUTO_INCREMENT = 20000000 COMMENT ='è‡ªå¢èµ·å§‹å€¼'" ; Exception in thread "main" com.alibaba.fastsql.sql.parser.ParserException: syntax error  error in :'0000 COMMENT ='è‡ªå¢èµ·å§‹å€¼''  expect ON  actual =  pos 52  line 1  column 52  token = 	at com.alibaba.fastsql.sql.parser.SQLParser.printError(SQLParser.java:363) 	at com.alibaba.fastsql.sql.parser.SQLParser.accept(SQLParser.java:371) 	at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseComment(SQLStatementParser.java:3488) 	at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:354) 	at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:92) 	at com.test.HelloWorld.main(HelloWorld.java:266) è¿™äº›æ˜¯æœ‰ä¸€äº›é—®é¢˜ï¼Œå·²åé¦ˆåšä¿®æ”¹ï¼Œå»ºè®®å…ˆç»•è¿‡ alter table test COLLATE = utf8mb4_unicode_ci alter table task AUTO_INCREMENT = 20000000    COMMENT ='è‡ªå¢èµ·å§‹å€¼' å†è¡¥å……ä¸€ä¸ªddl  CREATE TABLE `app_info` (`id` bigint(20) NOT NULL  `app_name` varchar(255) NOT NULL  PRIMARY KEY (`id`) INDEX `idx` USING BTREE (`app_name`) comment '') ;
780,fix bug #776 [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=780) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=780) before we can accept your contribution.<br/><hr/>**winger** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=780) it.</sub> [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=780) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=780) before we can accept your contribution.<br/><hr/>**winger** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=780) it.</sub> @agapple gmailé‚®ç®±(jianghang115@gmail.com)æœ‰æˆ‘çš„ç•™è¨€ï¼Œè°¢è°¢ã€‚ tks 
779,æ³¨é‡Šè¿‡é•¿ä¼šå¼•èµ·æ•°æ®é”™ä¹± æ³¨é‡Šæœ¬æ¥æ˜¯ï¼š å®šå‘è®¾ç½®ï¼Œ32ä¸ªå­—ç¬¦ï¼Œæ¯ä¸ªå­—ç¬¦æœ‰3ä¸ªå€¼ï¼ˆ0ç©º1ä¸é™2ç¡®å®šå€¼-æŒ‡å®š{ä¸åˆ†æŒ‡å®šæ’é™¤çš„ä¹Ÿå­˜ä¸ºæŒ‡å®š}3ç¡®å®šå€¼-æ’é™¤ï¼‰ç¬¬1ä¸ªå­—ç¬¦ï¼šåº”ç”¨æ¸ é“ï¼Œç¬¬2ä¸ªå­—ç¬¦ï¼šç½‘ç»œç¯å¢ƒï¼Œç¬¬3ä¸ªå­—ç¬¦ï¼šç§»åŠ¨æ“ä½œç³»ç»Ÿï¼Œç¬¬4ä¸ªå­—ç¬¦ï¼šå¹³å°ç‰ˆæœ¬å·ï¼Œç¬¬5ä¸ªå­—ç¬¦ï¼šåœ°åŸŸå®šå‘ï¼Œç¬¬6ä¸ªå­—ç¬¦ï¼šæ€§åˆ«ï¼Œç¬¬7ä¸ªå­—ç¬¦ï¼šå¹´é¾„æ®µï¼Œç¬¬8ä¸ªå­—ç¬¦ï¼šå…³é”®è¯ã€0æ²¡æœ‰ï¼›1ä¸é™ï¼›2æŒ‡å®šï¼›3æ’é™¤ï¼›4ï¼›æ™ºèƒ½ã€‘ï¼Œç¬¬9ä¸ªå­—ç¬¦ï¼šå•†ä¸šå…´è¶£æ ‡ç­¾ï¼Œç¬¬10ä¸ªå­—ç¬¦ï¼šAppListæ ‡ç­¾ï¼Œç¬¬11ä¸ªå­—ç¬¦ï¼šè®¾å¤‡ä»·æ ¼æ ‡ç­¾ï¼Œç¬¬12ä¸ªå­—ç¬¦ï¼šè§†é¢‘ç±»å‹ï¼Œç¬¬13ä¸ªå­—ç¬¦ï¼šè¿è¥å•†ï¼Œç¬¬14ä¸ªå­—ç¬¦ï¼šè‡ªå®šä¹‰äººç¾¤åŒ… æ”¹æˆï¼š å®šå‘è®¾ç½®ï¼Œ32ä¸ªå­—ç¬¦ï¼Œæ¯ä¸ªå­—ç¬¦æœ‰3ä¸ªå€¼ï¼ˆ0ç©º1ä¸é™2ç¡®å®šå€¼-æŒ‡å®š{ä¸åˆ†æŒ‡å®šæ’é™¤çš„ä¹Ÿå­˜ä¸ºæŒ‡å®š}3ç¡®å®šå€¼-æ’é™¤ï¼‰ç¬¬1ä¸ªå­—ç¬¦ï¼šåº”ç”¨æ¸ é“ï¼Œç¬¬2ä¸ªå­—ç¬¦ï¼šç½‘ç»œç¯å¢ƒï¼Œç¬¬3ä¸ªå­—ç¬¦ï¼šç§»åŠ¨æ“ä½œç³»ç»Ÿï¼Œç¬¬4ä¸ªå­—ç¬¦ï¼šå¹³å°ç‰ˆæœ¬å·ï¼Œç¬¬5ä¸ªå­—ç¬¦ï¼šåœ°åŸŸå®šå‘ï¼Œç¬¬6ä¸ªå­—ç¬¦ï¼šæ€§åˆ«ï¼Œç¬¬7ä¸ªå­—ç¬¦ï¼šå¹´é¾„æ®µï¼Œç¬¬8ä¸ªå­—ç¬¦ï¼šå…³é”®è¯ã€0æ²¡æœ‰ï¼›1ä¸é™ï¼›2æŒ‡å®šï¼›3æ’é™¤ï¼›4ï¼›æ™ºèƒ½ã€‘ï¼Œç¬¬9ä¸ªå­—ç¬¦ï¼šå•†ä¸šå…´è¶£æ ‡ç­¾ï¼Œç¬¬10ä¸ªå­—ç¬¦ï¼šAppListæ ‡ç­¾ï¼Œç¬¬11ä¸ªå­—ç¬¦ï¼šè®¾å¤‡ä»·æ ¼æ ‡ç­¾ï¼Œç¬¬12ä¸ªå­—ç¬¦ï¼šè§†é¢‘ç±»å‹ï¼Œç¬¬13ä¸ªå­—ç¬¦ï¼šè¿è¥å•†ï¼Œç¬¬14ä¸ªå­—ç¬¦ï¼šè‡ªå®šä¹‰äººç¾¤åŒ…ï¼Œç¬¬15ä¸ªå­—ç¬¦ï¼šåº”ç”¨æ¸ é“-èµ„è®¯ç‰ˆï¼Œç¬¬16ä¸ªå­—ç¬¦ï¼šå¹³å°ç‰ˆæœ¬å·-èµ„è®¯ç‰ˆ ä»¥åï¼Œæœ‰ä¸€ä¸ªå­—æ®µçš„æ•°æ®å‡ºç°é”™ä¹± ç»™æˆ‘ä¸€ä¸ªå®Œæ•´çš„ddl  sql alter table tb_ad_group modify `target_setting` varchar(64) NOT NULL DEFAULT '00000000000000000000000000000000' COMMENT 'å®šå‘è®¾ç½®ï¼Œ32ä¸ªå­—ç¬¦ï¼Œæ¯ä¸ªå­—ç¬¦æœ‰3ä¸ªå€¼ï¼ˆ0ç©º1ä¸é™2ç¡®å®šå€¼-æŒ‡å®š{ä¸åˆ†æŒ‡å®šæ’é™¤çš„ä¹Ÿå­˜ä¸ºæŒ‡å®š}3ç¡®å®šå€¼-æ’é™¤ï¼‰ç¬¬1ä¸ªå­—ç¬¦ï¼šåº”ç”¨æ¸ é“ï¼Œç¬¬2ä¸ªå­—ç¬¦ï¼šç½‘ç»œç¯å¢ƒï¼Œç¬¬3ä¸ªå­—ç¬¦ï¼šç§»åŠ¨æ“ä½œç³»ç»Ÿï¼Œç¬¬4ä¸ªå­—ç¬¦ï¼šå¹³å°ç‰ˆæœ¬å·ï¼Œç¬¬5ä¸ªå­—ç¬¦ï¼šåœ°åŸŸå®šå‘ï¼Œç¬¬6ä¸ªå­—ç¬¦ï¼šæ€§åˆ«ï¼Œç¬¬7ä¸ªå­—ç¬¦ï¼šå¹´é¾„æ®µï¼Œç¬¬8ä¸ªå­—ç¬¦ï¼šå…³é”®è¯ã€0æ²¡æœ‰ï¼›1ä¸é™ï¼›2æŒ‡å®šï¼›3æ’é™¤ï¼›4ï¼›æ™ºèƒ½ã€‘ï¼Œç¬¬9ä¸ªå­—ç¬¦ï¼šå•†ä¸šå…´è¶£æ ‡ç­¾ï¼Œç¬¬10ä¸ªå­—ç¬¦ï¼šAppListæ ‡ç­¾ï¼Œç¬¬11ä¸ªå­—ç¬¦ï¼šè®¾å¤‡ä»·æ ¼æ ‡ç­¾ï¼Œç¬¬12ä¸ªå­—ç¬¦ï¼šè§†é¢‘ç±»å‹ï¼Œç¬¬13ä¸ªå­—ç¬¦ï¼šè¿è¥å•†ï¼Œç¬¬14ä¸ªå­—ç¬¦ï¼šè‡ªå®šä¹‰äººç¾¤åŒ…ï¼Œç¬¬15ä¸ªå­—ç¬¦ï¼šåº”ç”¨æ¸ é“-èµ„è®¯ç‰ˆï¼Œç¬¬16ä¸ªå­—ç¬¦ï¼šå¹³å°ç‰ˆæœ¬å·-èµ„è®¯ç‰ˆ'; æœ€æ–°çš„alpha 4è§£ææ²¡é—®é¢˜ æƒ³é—®æ‚¨ä¸€ä¸‹ å¦‚æœä¸æ¢ç‰ˆæœ¬ã€‚æœ‰ä»€ä¹ˆæ–¹æ³•å—ã€‚ã€‚ã€‚ç‰ˆæœ¬ä¸æ˜¯ç‰¹åˆ«æ–¹ä¾¿æ›´æ¢é¢
778,parse row data failed canal 1.0.26-SNAPSHOT 5.5.52-MariaDB GRANT SELECT  REPLICATION SLAVE  REPLICATION CLIENT ON *.* TO 'czbrepclient'@'%' IDENTIFIED BY PASSWORD '*A6A643DF20257C290F26693E1A59F69448428157' Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: java.lang.IllegalArgumentException: limit excceed: 148         at com.taobao.tddl.dbsync.binlog.LogBuffer.getFullString(LogBuffer.java:1123) æä¾›binlogæ–‡ä»¶æˆ–è€…æµ‹è¯•æ•°æ®å¤ç°å¸¸é™  å‘ä½ gmailé‡Œäº†ï¼Œè¯·æŸ¥æ”¶
777, fix issue #771 #776 #756 [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=777) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=777) before we can accept your contribution.<br/><hr/>**winger** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=777) it.</sub> tks
776,[v1.0.26.alpha4] decode eventæ—¶æŠ¥limit exceedé”™è¯¯ ![image](https://user-images.githubusercontent.com/8179551/43183817-099b0e50-9019-11e8-8339-2d922e48b9ed.png) decode eventæ—¶æŠ¥limit exceedé”™è¯¯ åº”è¯¥æ˜¯å’Œè¿™ä¸ªcommitæœ‰å…³ https://github.com/alibaba/canal/commit/89726a636530b73a6b97cecc2b5bcee4fb464f86 mysqlç‰ˆæœ¬æ˜¯å•¥ï¼Ÿ æŠ±æ­‰.@gaoxiangyu  æˆ‘ä¾èµ–äº MySQL 5.7æµ‹è¯•çš„ï¼Œèƒ½æŠŠå¼•èµ·è¿™ä¸ªé”™è¯¯çš„MySQL ç‰ˆæœ¬è¯´ä¸‹å—ï¼Ÿæ–¹ä¾¿æˆ‘è¿™è¾¹è·Ÿè¿›ï¼Œè°¢è°¢. 5.6.28 @gaoxiangyu å¤šè°¢ï¼Œæˆ‘è·Ÿè¿›ä¸€ä¸‹ @agapple è¿™ä¸ªé—®é¢˜æˆ‘æ¥è·Ÿè¿›. BTWï¼Œæ–¹ä¾¿çš„æ—¶å€™è¯·çœ‹ä¸‹ä½ çš„gmail 
775,canalæ”¯æŒspring4æˆ–spring5å—ï¼Ÿ ç›®å‰åœ¨å¼•å…¥å®¢æˆ·ç«¯æ—¶ä¸é¡¹ç›®ä¸­spring4ã€spring5å†²çª ç›®å‰é»˜è®¤ç”¨spring3 @agapple æœ‰è®¡åˆ’æ”¯æŒspring4æˆ–spring5å—ï¼Œç°åœ¨spring4ç”¨çš„æ¯”è¾ƒæ™®éï¼Œspring3ç”¨çš„æ¯”è¾ƒå°‘ ä½ å¯ä»¥æäº¤ä¸€ä¸ªPRç»™æˆ‘ï¼Œcanalå¯¹springçš„ä¾èµ–å°±æ˜¯ä¸€ä¸ªIOCï¼Œå¯ä»¥å‡çº§ spring5è¦æ±‚java8ï¼Œè¦æ³¨æ„ä¸‹
774,[v1.0.26.alpha4]connect timed outé”™è¯¯ 018-07-25 10:50:58.209 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - Received EOF packet from server  apparent master disconnected. It's may be duplicate slaveId   check instance config 2018-07-25 10:51:17.034 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position  {"identity":{"slaveId":-1 "sourceAddress":{"address":"127.0.0.1" "port":3306}} "postion":{"gtid":"" "included":false "journalName":"mysql-bin.000027" "position":299492902 "serverId":2 "timestamp":1532487056000}} 2018-07-25 10:51:17.086 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - find start position : EntryPosition[included=false journalName=mysql-bin.000027 position=299492902 serverId=2 gtid= timestamp=1532487056000] 2018-07-25 10:51:18.081 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - Received EOF packet from server  apparent master disconnected. It's may be duplicate slaveId   check instance config 2018-07-25 10:51:33.753 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position  {"identity":{"slaveId":-1 "sourceAddress":{"address":"127.0.0.1" "port":3306}} "postion":{"gtid":"" "included":false "journalName":"mysql-bin.000027" "position":299516130 "serverId":2 "timestamp":1532487071000}} 2018-07-25 10:51:33.760 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - find start position : EntryPosition[included=false journalName=mysql-bin.000027 position=299516130 serverId=2 gtid= timestamp=1532487071000] 2018-07-25 10:51:43.767 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address 127.0.0.1/127.0.0.1:3306 has an error  retrying. caused by  java.io.IOException: connect /127.0.0.1:3306 failure 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:77) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.reconnect(MysqlConnector.java:86) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.reconnect(MysqlConnection.java:85) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:186) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Unknown Source) [na:1.8.0_152] Caused by: java.net.SocketTimeoutException: connect timed out 	at java.net.TwoStacksPlainSocketImpl.socketConnect(Native Method) ~[na:1.8.0_152] 	at java.net.AbstractPlainSocketImpl.doConnect(Unknown Source) ~[na:1.8.0_152] 	at java.net.AbstractPlainSocketImpl.connectToAddress(Unknown Source) ~[na:1.8.0_152] 	at java.net.AbstractPlainSocketImpl.connect(Unknown Source) ~[na:1.8.0_152] 	at java.net.PlainSocketImpl.connect(Unknown Source) ~[na:1.8.0_152] 	at java.net.SocksSocketImpl.connect(Unknown Source) ~[na:1.8.0_152] 	at java.net.Socket.connect(Unknown Source) ~[na:1.8.0_152] 	at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannelPool.open(BioSocketChannelPool.java:18) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannelPool.open(SocketChannelPool.java:18) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:72) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	... 4 common frames omitted 2018-07-25 10:51:43.774 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.io.IOException: connect /127.0.0.1:3306 failure 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:77) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.reconnect(MysqlConnector.java:86) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.reconnect(MysqlConnection.java:85) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:186) 	at java.lang.Thread.run(Unknown Source) Caused by: java.net.SocketTimeoutException: connect timed out 	at java.net.TwoStacksPlainSocketImpl.socketConnect(Native Method) 	at java.net.AbstractPlainSocketImpl.doConnect(Unknown Source) 	at java.net.AbstractPlainSocketImpl.connectToAddress(Unknown Source) 	at java.net.AbstractPlainSocketImpl.connect(Unknown Source) 	at java.net.PlainSocketImpl.connect(Unknown Source) 	at java.net.SocksSocketImpl.connect(Unknown Source) 	at java.net.Socket.connect(Unknown Source) 	at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannelPool.open(BioSocketChannelPool.java:18) 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannelPool.open(SocketChannelPool.java:18) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:72) 	... 4 more ] 2018-07-25 10:52:13.657 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address 127.0.0.1/127.0.0.1:3306 has an error  retrying. caused by  java.io.IOException: connect /127.0.0.1:3306 failure 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:77) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:81) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:172) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Unknown Source) [na:1.8.0_152] Caused by: java.net.SocketTimeoutException: connect timed out 	at java.net.TwoStacksPlainSocketImpl.socketConnect(Native Method) ~[na:1.8.0_152] 	at java.net.AbstractPlainSocketImpl.doConnect(Unknown Source) ~[na:1.8.0_152] 	at java.net.AbstractPlainSocketImpl.connectToAddress(Unknown Source) ~[na:1.8.0_152] 	at java.net.AbstractPlainSocketImpl.connect(Unknown Source) ~[na:1.8.0_152] 	at java.net.PlainSocketImpl.connect(Unknown Source) ~[na:1.8.0_152] 	at java.net.SocksSocketImpl.connect(Unknown Source) ~[na:1.8.0_152] 	at java.net.Socket.connect(Unknown Source) ~[na:1.8.0_152] 	at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannelPool.open(BioSocketChannelPool.java:18) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannelPool.open(SocketChannelPool.java:18) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:72) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	... 3 common frames omitted 2018-07-25 10:52:13.658 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.io.IOException: connect /127.0.0.1:3306 failure 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:77) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:81) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:172) 	at java.lang.Thread.run(Unknown Source) Caused by: java.net.SocketTimeoutException: connect timed out 	at java.net.TwoStacksPlainSocketImpl.socketConnect(Native Method) 	at java.net.AbstractPlainSocketImpl.doConnect(Unknown Source) 	at java.net.AbstractPlainSocketImpl.connectToAddress(Unknown Source) 	at java.net.AbstractPlainSocketImpl.connect(Unknown Source) 	at java.net.PlainSocketImpl.connect(Unknown Source) 	at java.net.SocksSocketImpl.connect(Unknown Source) 	at java.net.Socket.connect(Unknown Source) 	at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannelPool.open(BioSocketChannelPool.java:18) 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannelPool.open(SocketChannelPool.java:18) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:72) 	... 3 more ] @agapple  æœ¬æœºçš„MySQLé€šè¿‡ 127.0.0.1:3306 è¿ä¸ä¸Šå§ @wingerx è¿™ä¸ª127.0.0.1æ˜¯å…¶ä»–å…·ä½“IPï¼Œåªæ˜¯è´´æ—¥å¿—æ—¶æ›¿æ¢äº†
773, [v1.0.26.alpha4]parse events has an erroré”™è¯¯ ![image](https://user-images.githubusercontent.com/9798724/43177235-d82ca3c0-8ff9-11e8-87f1-e43826acb891.png) 2018-07-25 10:52:13.662 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - parse events has an error java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.FutureTask@869cc59 rejected from java.util.concurrent.ThreadPoolExecutor@36f77020[Terminated  pool size = 0  active threads = 0  queued tasks = 0  completed tasks = 0] 	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(Unknown Source) ~[na:1.8.0_152] 	at java.util.concurrent.ThreadPoolExecutor.reject(Unknown Source) ~[na:1.8.0_152] 	at java.util.concurrent.ThreadPoolExecutor.execute(Unknown Source) ~[na:1.8.0_152] 	at java.util.concurrent.AbstractExecutorService.submit(Unknown Source) ~[na:1.8.0_152] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor.start(MysqlMultiStageCoprocessor.java:120) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor.reset(MysqlMultiStageCoprocessor.java:187) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:306) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Unknown Source) ~[na:1.8.0_152] ç›¸åŒé—®é¢˜å•Šï¼Œè§£å†³æ²¡ @agapple è¿™ä¸æ˜¯root causeï¼Œæ‰¾æœ€å‰é¢çš„æ—¥å¿— ä½¿ç”¨v1.0.25æ²¡æœ‰é—®é¢˜ åº”è¯¥æ˜¯å•æ ¸æœºå™¨çš„å¯åŠ¨å¤±è´¥é—®é¢˜ï¼Œv1.1.1å·²ä¿®å¤ @agapple v1.1.1æ­£å¼ç‰ˆä»€ä¹ˆæ—¶å€™å‘å¸ƒ
772,fix issue #771 #756 [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=772) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=772) before we can accept your contribution.<br/><hr/>**winger** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=772) it.</sub> [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=772) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=772) before we can accept your contribution.<br/><hr/>**winger** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=772) it.</sub>
771,å¯åŠ¨canalæ—¶ï¼Œçº¿ç¨‹æ± å·¥ä½œå¼‚å¸¸ 2018-07-24 15:44:43.247 [destination = example   address = /22.5.229.239:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position mysql-bin.000001:558240:null 2018-07-24 15:44:43.271 [destination = example   address = /22.5.229.239:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - find start position : EntryPosition[included=false journalName=mysql-bin.000001 position=558240 serverId=<null> gtid= timestamp=<null>] 2018-07-24 15:44:43.331 [destination = example   address = /22.5.229.239:3306   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - Received EOF packet from server  apparent master disconnected. It's may be duplicate slaveId   check instance config 2018-07-24 15:45:00.446 [destination = example   address = /22.5.229.239:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position {"identity":{"slaveId":-1 "sourceAddress":{"address":"cbjup04" "port":3306}} "postion":{"gtid":"" "included":false "journalName":"mysql-bin.000001" "position":559146 "serverId":16782861 "timestamp":1532417891000}} 2018-07-24 15:45:00.447 [destination = example   address = /22.5.229.239:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - find start position : EntryPosition[included=false journalName=mysql-bin.000001 position=559146 serverId=16782861 gtid= timestamp=1532417891000] 2018-07-24 15:45:00.453 [destination = example   address = /22.5.229.239:3306   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - Received EOF packet from server  apparent master disconnected. It's may be duplicate slaveId   check instance config 2018-07-24 15:45:18.422 [destination = example   address = /22.5.229.239:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position {"identity":{"slaveId":-1 "sourceAddress":{"address":"cbjup04" "port":3306}} "postion":{"gtid":"" "included":false "journalName":"mysql-bin.000001" "position":559146 "serverId":16782861 "timestamp":1532417891000}} 2018-07-24 15:45:18.422 [destination = example   address = /22.5.229.239:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - find start position : EntryPosition[included=false journalName=mysql-bin.000001 position=559146 serverId=16782861 gtid= timestamp=1532417891000] 2018-07-24 15:45:18.426 [destination = example   address = /22.5.229.239:3306   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - Received EOF packet from server  apparent master disconnected. It's may be duplicate slaveId   check instance config 2018-07-24 15:45:18.440 [destination = example   address = /22.5.229.239:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - parse events has an error java.util.concurrent.RejectedExecutionException: Task com.lmax.disruptor.WorkProcessor@58d43d50 rejected from java.util.concurrent.ThreadPoolExecutor@56057cbf[Terminated  pool size = 0  active threads = 0  queued tasks = 0  completed tasks = 0]         at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2048) ~[na:1.7.0_45]         at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:821) ~[na:1.7.0_45]         at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1372) ~[na:1.7.0_45]         at com.lmax.disruptor.WorkerPool.start(WorkerPool.java:140) ~[disruptor-3.4.2.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor.start(MysqlMultiStageCoprocessor.java:122) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor.reset(MysqlMultiStageCoprocessor.java:187) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:306) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at java.lang.Thread.run(Thread.java:744) ~[na:1.7.0_45] #756 ç›¸åŒçš„é—®é¢˜ æŸ¥åˆ°é—®é¢˜æ‰€åœ¨äº†ã€‚ @agapple åœ¨ fix #726 issueæ—¶å°† binlog_flags è®¾ç½®ä¸ºäº† BINLOG_DUMP_NON_BLOCKï¼Œmasteråœ¨æ²¡æœ‰å¯å‘é€çš„binlog eventä¹‹åï¼Œå°±ä¼šè¿”å›ä¸€ä¸ªEOF package.  é€šå¸¸å¯¹äºslaveæ¥è¯´ï¼Œä¸€ç›´æŠŠè¿æ¥æŒ‚ç€å¯èƒ½æ›´å¥½ï¼Œè¿™æ ·èƒ½æ›´åŠæ—¶æ”¶åˆ°æ–°äº§ç”Ÿçš„binlog eventï¼Œä¸çŸ¥@agapple åŸºäºä»€ä¹ˆè€ƒè™‘ï¼Œå°†è®¾ç½®æ”¹æˆäº† BINLOG_DUMP_NON_BLOCKï¼Ÿ æˆ–è€…è¯´æ›´ä¼˜é›…å¤„ç† EOF package è€Œä¸æ˜¯æ‰“å°ä¸€ä¸ªè¯¯å¯¼çš„" Received EOF packet from server  apparent master disconnected. It's may be duplicate slaveId   check instance config" æ—¥å¿—ä¿¡æ¯å‡ºæ¥? @wingerx ä½ å¥½ï¼Œæˆ‘çš„é—®é¢˜ä¸»è¦æ˜¯åœ¨ä¸‹é¢ï¼Œåœ¨åˆ›å»ºparseçš„çº¿ç¨‹æ± çš„æ—¶å€™ï¼Œæ€»ä¼šæŠ¥java.util.concurrent.RejectedExecutionExceptionï¼Œè€Œä¸”pool sizeä¸º0ï¼Œæˆ‘çš„æœåŠ¡å™¨æ˜¯4æ ¸çš„ï¼ŒæŒ‰ç…§parallelThreadSizeçš„é»˜è®¤å€¼ä¸ºæœåŠ¡å™¨æ€»å¯ç”¨ç‰©ç†æ ¸æ•°çš„60%ï¼ŒpoolSizeåº”è¯¥æ˜¯2ï¼Œè€Œä¸æ˜¯0ã€‚ ç›¸åŒé—®é¢˜ï¼Œæ¥¼ä¸»è§£å†³æ²¡ @fanpeng1100 æ²¡æœ‰ï¼Œæˆ‘çš„é—®é¢˜æ˜¯è°ƒç”¨çº¿ç¨‹æ± æŠ¥é”™..... @sky-mariner çº¿ç¨‹æ± æŠ¥é”™çš„åŸå› è¯·çœ‹æˆ‘æäº¤çš„pr #777ã€‚ å¯¹äºç›®å‰æœ€æ–°release v1.0.26 alpha 4ï¼Œå…ˆæ”¹é…ç½® canal.instance.parser.parallel = false ç”¨å§ @wingerx å¥½çš„ï¼Œè°¢è°¢~â€™ @wingerx æ­£è§£
770,æŒ‡å®šcanal.instance.master.timestampæ—¶é—´æˆ³æ¶ˆè´¹æ— æ•ˆ åœ¨instanceä¸­æŒ‡å®šäº†æ—¶é—´æˆ³ï¼Œå‘ç°clientè¿˜ä¼šæ‹¿åˆ°è¿™ä¸ªæ—¶é—´æˆ³ä»¥å‰çš„logï¼Œå¦‚æœæƒ³åªæ¶ˆè´¹è¿™ä¸ªæ—¶é—´æˆ³ä¹‹åçš„logï¼Œåº”è¯¥é…ç½®å“ªäº›å‘¢ï¼Ÿå•ç‹¬é…ç½®canal.instance.master.timestampæ˜¯ä¸æ˜¯ä¸å¯ä»¥ï¼Ÿ æ¸…ç†æ‰ä¸Šä¸€æ¬¡çš„è®°å½•çš„ä½ç‚¹ä¿¡æ¯ï¼Œæ¯”å¦‚zookeeperèŠ‚ç‚¹å’Œmeta.datæ–‡ä»¶
769,1.0.26 ç‰ˆæœ¬ï¼Œå•æœºæœªä½¿ç”¨h2.db å†ä¸€æ¡sqlä¸­ä¿®æ”¹å¤šä¸ªè¡¨ç»“æ„ä»¥åŠåˆ›å»ºæ–°è¡¨è§£æå‡ºç°å¼‚å¸¸.ç›‘å¬çš„æ•´ä¸ªåº“ å¼‚å¸¸ä¿¡æ¯å¦‚ä¸‹ Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: fetch failed by table meta:`æ•°æ®åº“`.`_è¡¨å_new` Caused by: java.io.IOException: ErrorPacket [errorNumber=1146  fieldCount=-1  message=Table 'æ•°æ®åº“._è¡¨å_new' doesn't exist  sqlState=42S02  sqlStateMarker=#] at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.query(MysqlQueryExecutor.java:61) at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:94) at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMetaByDB(TableMetaCache.java:89) at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.access$000(TableMetaCache.java:32) at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:62) at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:52) at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3527) at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2319) at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2282) at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2197) at com.google.common.cache.LocalCache.get(LocalCache.java:3937) at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3941) at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4824) at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4830) at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:185) at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:759) at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:428) at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:114) at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:66) at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:337) at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:184) at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:152) at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220) at java.lang.Thread.run(Thread.java:748)  message=Table 'æ•°æ®åº“._è¡¨å_new' doesn't exist  sqlState=42S02  sqlStateMarker=#] æ‰¾ä¸åˆ°è¡¨ è¿™ä¸ªè¡¨æ˜¯ä¸å­˜åœ¨çš„ï¼Œé”™è¯¯ä¿¡æ¯æ˜¯åœ¨ä¿®æ”¹ç´¢å¼•ï¼Œå¢åŠ è¡¨å­—æ®µå’Œåˆ›å»ºå…¶ä»–è¡¨æ“ä½œé™„è¿‘æ—¶åˆ»å‘ç”Ÿçš„ï¼Œæ˜¯ä¸æ˜¯ä¸´æ—¶è¡¨ä¹‹ç±»çš„é€ æˆçš„è§£æå¼‚å¸¸ å¼€å¯Table TSDBæ¥æµ‹è¯•å§ï¼Œä»¥å‰åæŸ¥æ•°æ®åº“çš„æ¨¡å¼å¾ˆå¤šé™åˆ¶ å¥½ æˆ‘å¼€å¯ä¸‹h2 çœ‹åç»­è¿˜ä¼šå‘ç”Ÿè¿™æ ·çš„å¼‚å¸¸ä¸
768,ä¿®æ”¹Readme.mdï¼Œæ–°å¢æ•°æ®è®¢é˜…æ´»åŠ¨å…¬å‘Š ä¿®æ”¹Readme.mdï¼Œæ–°å¢æ•°æ®è®¢é˜…æ´»åŠ¨å…¬å‘Š [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=768) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=768) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=768) it.</sub>
767,canalå®¢æˆ·ç«¯è¿æ¥é—®é¢˜ ZKåœ¨47.96.186.32:2181  Canalåœ¨47.96.186.32:11111 ç«¯å£æ–¹é¢éƒ½æ²¡é—®é¢˜  CanalæœåŠ¡ç«¯æ—¥å¿—éƒ½æ­£å¸¸. å®¢æˆ·ç«¯è¿æ¥çš„æ—¶å€™  ZKèƒ½æˆåŠŸè¿ä¸Š  ä½†æ˜¯è°ƒç”¨ **canalConnector.subscribe(canalClientProperties.getSubscribeFilter());** è¿™ä¸€æ®µæ–¹æ³•æ—¶æŠ›å‡ºä¸‹é¢çš„å¼‚å¸¸  canalçš„autoScanå·²å…³é—­. something goes wrong when subscribing from server:null 2018-07-23 14:14:30.100 [main-SendThread(47.96.186.32:2181)] DEBUG org.apache.zookeeper.ClientCnxn.readResponse(815) -                 Reading reply sessionid:0x164b770991e0058  packet:: clientPath:null serverPath:null finished:false header:: 298 4  replyHeader:: 298 12176 0  request:: '/otter/canal/destinations/example/1001/running T  response:: #7b22616374697665223a747275652c2261646472657373223a223132372e302e302e313a3536333633222c22636c69656e744964223a313030317d s{12174 12175 1532326470040 1532326470047 1 0 0 100406785942093912 59 0 12174}  2018-07-23 14:14:30.100 [taskExecutor-5] WARN  c.a.o.c.c.i.r.ClientRunningMonitor.check(168) -                 canal is running in [127.0.0.1:56363]   but not in [192.168.31.207] 2018-07-23 14:14:30.101 [taskExecutor-5] ERROR t.j.m.m.s.c.CanalIncrementSyncTask.handleException(25) -                 com.alibaba.otter.canal.protocol.exception.CanalClientException: failed to subscribe after 3 times retry. 	at com.alibaba.otter.canal.client.impl.ClusterCanalConnector.subscribe(ClusterCanalConnector.java:119) 	at tech.jiyu.micromagasin.mc.sync.canal.CanalIncrementSyncTask.sync(CanalIncrementSyncTask.java:75) 	at tech.jiyu.micromagasin.mc.sync.canal.CanalIncrementSyncTask$$FastClassBySpringCGLIB$$783fbb6f.invoke(<generated>) 	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204) 	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:720) 	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157) 	at org.springframework.aop.interceptor.AsyncExecutionInterceptor$1.call(AsyncExecutionInterceptor.java:115) 	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266) 	at java.util.concurrent.FutureTask.run(FutureTask.java) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) 	at java.lang.Thread.run(Thread.java:748) com.alibaba.otter.canal.protocol.exception.CanalClientException: failed to subscribe after 3 times retry. 	at com.alibaba.otter.canal.client.impl.ClusterCanalConnector.subscribe(ClusterCanalConnector.java:119) 	at tech.jiyu.micromagasin.mc.sync.canal.CanalIncrementSyncTask.sync(CanalIncrementSyncTask.java:75) 	at tech.jiyu.micromagasin.mc.sync.canal.CanalIncrementSyncTask$$FastClassBySpringCGLIB$$783fbb6f.invoke(<generated>) 	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204) 	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:720) 	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157) 	at org.springframework.aop.interceptor.AsyncExecutionInterceptor$1.call(AsyncExecutionInterceptor.java:115) 	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266) 	at java.util.concurrent.FutureTask.run(FutureTask.java) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) 	at java.lang.Thread.run(Thread.java:748) ç›®å‰æ‰¾åˆ°é—®é¢˜çš„åŸå›    ![image](https://user-images.githubusercontent.com/31718669/43062693-3e5187a2-8e8c-11e8-9c3a-beb631e3d868.png) canalServer çš„canal.properties ipé…ç½®ä¸º127.0.0.1  å½“å®¢æˆ·ç«¯è¿æ¥è‡³ZKæ—¶è·å–ä¸Šé¢çš„æ•°æ®è¿æ¥Canalæ—¶ä½¿ç”¨çš„ä¹Ÿæ˜¯127.0.0.1çš„åœ°å€å»è¿æ¥Canal Server  è¿™å°±å˜æˆäº†å®¢æˆ·ç«¯æœºå™¨åœ¨è¿æ¥æœ¬åœ°çš„CanalServer   ä¸€å¼€å§‹è¿™åªæ˜¯ä¸ªçŒœæƒ³  ä½†æ˜¯å½“æˆ‘åœ¨æœ¬åœ°èµ·äº†ä¸€ä¸ªCanalServeråå°±ä¸å†æŠ›å¼‚å¸¸äº† å¯ä»¥æ­£å¸¸è¿æ¥.  é—®é¢˜åœ¨äº  æˆ‘å°è¯•æŠŠè¿œç«¯çš„CanalServerçš„ipé…ç½®æˆå…¬ç½‘IP  è¿™æ ·åº”è¯¥å°±èƒ½æ­£å¸¸è¿æ¥äº†  ä½†æ˜¯æ”¹æˆå…¬ç½‘IPåCanalServer å¯åŠ¨å¤±è´¥  æç¤ºå‡ºé”™ "**canal cannot assign requested address**"
766,cancalå¯åŠ¨æ­£å¸¸ï¼Œjavaå®¢æˆ·ç«¯å¯ä»¥è¿æ¥ä¸Šï¼Œä½†æœ‰æ•°æ®æ›´æ”¹åå®¢æˆ·ç«¯è·å–ä¸åˆ°ã€‚ cancalå¯åŠ¨æ­£å¸¸ï¼Œjavaå®¢æˆ·ç«¯å¯ä»¥è¿æ¥ä¸Šï¼Œä½†æœ‰æ•°æ®æ›´æ”¹åå®¢æˆ·ç«¯è·å–ä¸åˆ°æ›´æ”¹ã€‚ä¸‹é¢æ˜¯è®°å½• è°é‡åˆ°è¿‡è¿™ç§æƒ…å†µï¼Œè¯·å¸®å¿™ä¸‹ã€‚è°¢è°¢ã€‚ 2018-07-23 12:29:37.519 [destination = example   address = /127.0.01:3307   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: ErrorPacket [errorNumber=1046  fieldCount=-1  message=No database selected  sqlState=3D000  sqlStateMarker=#]  with command: show create table `sbed`.`å…¨é€Ÿé€šåº“å­˜`;show create table `sbed`.`å•†å“å¤‡æ¡ˆä¿¡æ¯è¡¨`;show create table `sbed`.`åº·å¤šå¤šåº“å­˜`;show create table `sbed`.`æ²¡æœ‰GSTçš„å•†å“`;show create table `sbed`.`æ¾³çŒ«å•†å“å†…éƒ¨ä»·`;show create table `sbed`.`æ¾³çŒ«å•†å“ç”³æŠ¥ä»·`;show create table `sbed`.`æ¾³çŒ«å•†å“é”€å”®ä»·`;show create table `sbed`.`ç½‘åº—ç®¡å®¶å•†å“æ€»åº“å­˜`;show create table `sbed`.`ç½‘åº—ç®¡å®¶å•†å“æ•°æ®`;show create table `sbed`.`è´§å“ä»·æ ¼è¡¨`;show create table `sbed`.`QRTZ_BLOB_TRIGGERS`;show create table `sbed`.`QRTZ_CALENDARS`;show create table `sbed`.`QRTZ_CRON_TRIGGERS`;show create table `sbed`.`QRTZ_FIRED_TRIGGERS`;show create table `sbed`.`QRTZ_JOB_DETAILS`;show create table `sbed`.`QRTZ_LOCKS`;show create table `sbed`.`QRTZ_PAUSED_TRIGGER_GRPS`;show create table `sbed`.`QRTZ_SCHEDULER_STATE`;show create table `sbed`.`QRTZ_SIMPLE_TRIGGERS`;show create table `sbed`.`QRTZ_SIMPROP_TRIGGERS`;show create table `sbed`.`QRTZ_TRIGGERS`;show create table `sbed`.`sys_add_goods_advice`;show create table `sbed`.`sys_aomao_goods`;show create table `sbed`.`sys_aomao_goods_price`;show create table `sbed`.`sys_aomao_logistics`;show create table `sbed`.`sys_aomao_trade`;show create table `sbed`.`sys_aomao_trade_goods`;show create table `sbed`.`sys_aomao_user`;show create table `sbed`.`sys_aomao_user_group`;show create table `sbed`.`sys_aomao_user_inventory`;show create table `sbed`.`sys_attachment`;show create table `sbed`.`sys_au_data`;show create table `sbed`.`sys_auspost_base`;show create table `sbed`.`sys_auspost_log`;show create table `sbed`.`sys_auspost_order`;show create table `sbed`.`sys_common_map`;show create table `sbed`.`sys_config`;show create table `sbed`.`sys_content`;show create table `sbed`.`sys_content_taxonomy`;show create table `sbed`.`sys_currency`;show create table `sbed`.`sys_customer`;show create table `sbed`.`sys_customer_address`;show create table `sbed`.`sys_customer_category`;show create table `sbed`.`sys_customer_grade`;show create table `sbed`.`sys_dept`;show create table `sbed`.`sys_documents`;show create table `sbed`.`sys_eunionpay`;show create table `sbed`.`sys_excel_export`;show create table `sbed`.`sys_express`;show create table `sbed`.`sys_finance_log`;show create table `sbed`.`sys_finance_order`;show create table `sbed`.`sys_finance_order_goods`;show create table `sbed`.`sys_finance_refund`;show create table `sbed`.`sys_goods`;show create table `sbed`.`sys_goods_brand`;show create table `sbed`.`sys_goods_category`;show create table `sbed`.`sys_goods_price`;show create table `sbed`.`sys_goods_repertory`;show create table `sbed`.`sys_goods_return`;show create table `sbed`.`sys_goods_shop_price`;show create table `sbed`.`sys_goods_stock`;show create table `sbed`.`sys_goods_supplier`;show create table `sbed`.`sys_issue`;show create table `sbed`.`sys_issue_post`;show create table `sbed`.`sys_jingdong_refund`;show create table `sbed`.`sys_log`;show create table `sbed`.`sys_menu`;show create table `sbed`.`sys_order_detail`;show create table `sbed`.`sys_purchase`;show create table `sbed`.`sys_purchase_checkout`;show create table `sbed`.`sys_purchase_checkout_detail`;show create table `sbed`.`sys_purchase_detail`;show create table `sbed`.`sys_purchaseplan`;show create table `sbed`.`sys_purchaseplan_detail`;show create table `sbed`.`sys_quansutong_clearance`;show create table `sbed`.`sys_quansutong_express`;show create table `sbed`.`sys_quansutong_token`;show create table `sbed`.`sys_redbook_repertory`;show create table `sbed`.`sys_role`;show create table `sbed`.`sys_role_menu`;show create table `sbed`.`sys_sai_goods`;show create table `sbed`.`sys_sai_shipment_data`;show create table `sbed`.`sys_sai_stock`;show create table `sbed`.`sys_sale_num_goods`;show create table `sbed`.`sys_sales`;show create table `sbed`.`sys_sales_stock`;show create table `sbed`.`sys_schedule_job`;show create table `sbed`.`sys_schedule_job_log`;show create table `sbed`.`sys_shop`;show create table `sbed`.`sys_shop_delivery`;show create table `sbed`.`sys_shop_goods`;show create table `sbed`.`sys_shop_order`;show create table `sbed`.`sys_shop_order_goods`;show create table `sbed`.`sys_status`;show create table `sbed`.`sys_stock_all`;show create table `sbed`.`sys_stock_all_log`;show create table `sbed`.`sys_stock_all_num`;show create table `sbed`.`sys_stock_all_num_view`;show create table `sbed`.`sys_stock_allocation`;show create table `sbed`.`sys_stock_allocation_main`;show create table `sbed`.`sys_stock_goods`;show create table `sbed`.`sys_stock_store`;show create table `sbed`.`sys_stock_store_position`;show create table `sbed`.`sys_store`;show create table `sbed`.`sys_store_model`;show create table `sbed`.`sys_supplier`;show create table `sbed`.`sys_taobao_goods`;show create table `sbed`.`sys_taobao_goods_detail`;show create table `sbed`.`sys_taobao_goods_detail_item_imgs`;show create table `sbed`.`sys_taobao_goods_detail_location`;show create table `sbed`.`sys_taobao_goods_detail_prop_imgs`;show create table `sbed`.`sys_taobao_goods_detail_sku`;show create table `sbed`.`sys_taobao_goods_price`;show create table `sbed`.`sys_taobao_logistics_company`;show create table `sbed`.`sys_taobao_order`;show create table `sbed`.`sys_taobao_trade`;show create table `sbed`.`sys_taxonomy`;show create table `sbed`.`sys_third_nulaxgroup`;show create table `sbed`.`sys_tianmao_activity`;show create table `sbed`.`sys_tianmao_activity_goods`;show create table `sbed`.`sys_trade`;show create table `sbed`.`sys_trade_goods`;show create table `sbed`.`sys_trade_logistics`;show create table `sbed`.`sys_user`;show create table `sbed`.`sys_user_brand`;show create table `sbed`.`sys_user_formthead`;show create table `sbed`.`sys_user_role`;show create table `sbed`.`sys_user_store`;show create table `sbed`.`sys_user_token`;show create table `sbed`.`sys_value`;show create table `sbed`.`sys_wave_house_cost`;show create table `sbed`.`sys_yeebao_pay`;show create table `sbed`.`xhs_order`;show create table `sbed`.`xhs_order_detail`;show create table `sbed`.`xhs_stock`; Caused by: java.io.IOException: ErrorPacket [errorNumber=1046  fieldCount=-1  message=No database selected  sqlState=3D000  sqlStateMarker=#]  with command: show create table `sbed`.`å…¨é€Ÿé€šåº“å­˜`;show create table `sbed`.`å•†å“å¤‡æ¡ˆä¿¡æ¯è¡¨`;show create table `sbed`.`åº·å¤šå¤šåº“å­˜`;show create table `sbed`.`æ²¡æœ‰GSTçš„å•†å“`;show create table `sbed`.`æ¾³çŒ«å•†å“å†…éƒ¨ä»·`;show create table `sbed`.`æ¾³çŒ«å•†å“ç”³æŠ¥ä»·`;show create table `sbed`.`æ¾³çŒ«å•†å“é”€å”®ä»·`;show create table `sbed`.`ç½‘åº—ç®¡å®¶å•†å“æ€»åº“å­˜`;show create table `sbed`.`ç½‘åº—ç®¡å®¶å•†å“æ•°æ®`;show create table `sbed`.`è´§å“ä»·æ ¼è¡¨`;show create table `sbed`.`QRTZ_BLOB_TRIGGERS`;show create table `sbed`.`QRTZ_CALENDARS`;show create table `sbed`.`QRTZ_CRON_TRIGGERS`;show create table `sbed`.`QRTZ_FIRED_TRIGGERS`;show create table `sbed`.`QRTZ_JOB_DETAILS`;show create table `sbed`.`QRTZ_LOCKS`;show create table `sbed`.`QRTZ_PAUSED_TRIGGER_GRPS`;show create table `sbed`.`QRTZ_SCHEDULER_STATE`;show create table `sbed`.`QRTZ_SIMPLE_TRIGGERS`;show create table `sbed`.`QRTZ_SIMPROP_TRIGGERS`;show create table `sbed`.`QRTZ_TRIGGERS`;show create table `sbed`.`sys_add_goods_advice`;show create table `sbed`.`sys_aomao_goods`;show create table `sbed`.`sys_aomao_goods_price`;show create table `sbed`.`sys_aomao_logistics`;show create table `sbed`.`sys_aomao_trade`;show create table `sbed`.`sys_aomao_trade_goods`;show create table `sbed`.`sys_aomao_user`;show create table `sbed`.`sys_aomao_user_group`;show create table `sbed`.`sys_aomao_user_inventory`;show create table `sbed`.`sys_attachment`;show create table `sbed`.`sys_au_data`;show create table `sbed`.`sys_auspost_base`;show create table `sbed`.`sys_auspost_log`;show create table `sbed`.`sys_auspost_order`;show create table `sbed`.`sys_common_map`;show create table `sbed`.`sys_config`;show create table `sbed`.`sys_content`;show create table `sbed`.`sys_content_taxonomy`;show create table `sbed`.`sys_currency`;show create table `sbed`.`sys_customer`;show create table `sbed`.`sys_customer_address`;show create table `sbed`.`sys_customer_category`;show create table `sbed`.`sys_customer_grade`;show create table `sbed`.`sys_dept`;show create table `sbed`.`sys_documents`;show create table `sbed`.`sys_eunionpay`;show create table `sbed`.`sys_excel_export`;show create table `sbed`.`sys_express`;show create table `sbed`.`sys_finance_log`;show create table `sbed`.`sys_finance_order`;show create table `sbed`.`sys_finance_order_goods`;show create table `sbed`.`sys_finance_refund`;show create table `sbed`.`sys_goods`;show create table `sbed`.`sys_goods_brand`;show create table `sbed`.`sys_goods_category`;show create table `sbed`.`sys_goods_price`;show create table `sbed`.`sys_goods_repertory`;show create table `sbed`.`sys_goods_return`;show create table `sbed`.`sys_goods_shop_price`;show create table `sbed`.`sys_goods_stock`;show create table `sbed`.`sys_goods_supplier`;show create table `sbed`.`sys_issue`;show create table `sbed`.`sys_issue_post`;show create table `sbed`.`sys_jingdong_refund`;show create table `sbed`.`sys_log`;show create table `sbed`.`sys_menu`;show create table `sbed`.`sys_order_detail`;show create table `sbed`.`sys_purchase`;show create table `sbed`.`sys_purchase_checkout`;show create table `sbed`.`sys_purchase_checkout_detail`;show create table `sbed`.`sys_purchase_detail`;show create table `sbed`.`sys_purchaseplan`;show create table `sbed`.`sys_purchaseplan_detail`;show create table `sbed`.`sys_quansutong_clearance`;show create table `sbed`.`sys_quansutong_express`;show create table `sbed`.`sys_quansutong_token`;show create table `sbed`.`sys_redbook_repertory`;show create table `sbed`.`sys_role`;show create table `sbed`.`sys_role_menu`;show create table `sbed`.`sys_sai_goods`;show create table `sbed`.`sys_sai_shipment_data`;show create table `sbed`.`sys_sai_stock`;show create table `sbed`.`sys_sale_num_goods`;show create table `sbed`.`sys_sales`;show create table `sbed`.`sys_sales_stock`;show create table `sbed`.`sys_schedule_job`;show create table `sbed`.`sys_schedule_job_log`;show create table `sbed`.`sys_shop`;show create table `sbed`.`sys_shop_delivery`;show create table `sbed`.`sys_shop_goods`;show create table `sbed`.`sys_shop_order`;show create table `sbed`.`sys_shop_order_goods`;show create table `sbed`.`sys_status`;show create table `sbed`.`sys_stock_all`;show create table `sbed`.`sys_stock_all_log`;show create table `sbed`.`sys_stock_all_num`;show create table `sbed`.`sys_stock_all_num_view`;show create table `sbed`.`sys_stock_allocation`;show create table `sbed`.`sys_stock_allocation_main`;show create table `sbed`.`sys_stock_goods`;show create table `sbed`.`sys_stock_store`;show create table `sbed`.`sys_stock_store_position`;show create table `sbed`.`sys_store`;show create table `sbed`.`sys_store_model`;show create table `sbed`.`sys_supplier`;show create table `sbed`.`sys_taobao_goods`;show create table `sbed`.`sys_taobao_goods_detail`;show create table `sbed`.`sys_taobao_goods_detail_item_imgs`;show create table `sbed`.`sys_taobao_goods_detail_location`;show create table `sbed`.`sys_taobao_goods_detail_prop_imgs`;show create table `sbed`.`sys_taobao_goods_detail_sku`;show create table `sbed`.`sys_taobao_goods_price`;show create table `sbed`.`sys_taobao_logistics_company`;show create table `sbed`.`sys_taobao_order`;show create table `sbed`.`sys_taobao_trade`;show create table `sbed`.`sys_taxonomy`;show create table `sbed`.`sys_third_nulaxgroup`;show create table `sbed`.`sys_tianmao_activity`;show create table `sbed`.`sys_tianmao_activity_goods`;show create table `sbed`.`sys_trade`;show create table `sbed`.`sys_trade_goods`;show create table `sbed`.`sys_trade_logistics`;show create table `sbed`.`sys_user`;show create table `sbed`.`sys_user_brand`;show create table `sbed`.`sys_user_formthead`;show create table `sbed`.`sys_user_role`;show create table `sbed`.`sys_user_store`;show create table `sbed`.`sys_user_token`;show create table `sbed`.`sys_value`;show create table `sbed`.`sys_wave_house_cost`;show create table `sbed`.`sys_yeebao_pay`;show create table `sbed`.`xhs_order`;show create table `sbed`.`xhs_order_detail`;show create table `sbed`.`xhs_stock`; 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.queryMulti(MysqlQueryExecutor.java:109) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.queryMulti(MysqlConnection.java:101) 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:173) 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:84) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:173) 	at java.lang.Thread.run(Thread.java:748) ] æ‰§è¡Œé‚£æ®µshowæŒ‡ä»¤çœ‹çœ‹å•¥é”™è¯¯ åŒæ ·çš„é—®é¢˜ï¼Œcanal1.1.1  æ€ä¹ˆè§£å†³çš„ã€‚æ±‚åŠ©   @agapple  æ‰§è¡Œä¸€ä¸‹æŠ¥é”™çš„é‚£æ¡showæŒ‡ä»¤ @shuaicloud   å¤šè°¢@agapple  ï¼Œæ‰§è¡Œäº†å¤šä¸ªshow create table XXXXX;  æ²¡æŠ¥é”™  ã€‚ mysql5.7.18ï¼Œä¸Šé¢æœ‰å¤šä¸ªæ•°æ®åº“ï¼Œæƒé™å…¨å¼€ï¼Œ æŠ¥ï¼š  ERROR c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - dump address xxxxx/xxxxx:3306  has an error  retrying. caused by com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: ErrorPacket [errorNumber=1046  fieldCount=-1  message=No database selected  sqlState=3D000  sqlStateMarker=#] mysql5.6.40 åŒä¸€å¥—canalæœåŠ¡æ²¡é—®é¢˜ï¼Œæƒé™å…¨å¼€ï¼› 5.7ä¸Šæ‰§è¡Œå¤šè¯­å¥show create tableï¼Œæ˜¯æ²¡æŠ¥é”™ä¹ˆï¼Ÿ > 5.7ä¸Šæ‰§è¡Œå¤šè¯­å¥show create tableï¼Œæ˜¯æ²¡æŠ¥é”™ä¹ˆï¼Ÿ æ˜¯çš„ 
765,canalç›‘æ§å¯¹æ¥ä¸€ä¸‹prometheus+grafana å¾ˆå¤šäººåé¦ˆè¿‡å¦‚ä½•æœ‰æ•ˆçš„ç›‘æ§canal serverï¼Œåˆæ­¥æ€è€ƒæ˜¯é€‰æ‹©ç›®å‰æ¯”è¾ƒæµè¡Œçš„prometheus+grafana ç›‘æ§çš„æŒ‡æ ‡ï¼š 1.  serverçº§åˆ«çš„çŠ¶æ€ (instance list / client list) + (cpu / jvm gc / net / io ...) 2.  instanceçº§åˆ«çš„çŠ¶æ€ (delay /  tps /  ringbuffer / heartbeat ... ) å¦‚æœå¤§å®¶å·²ç»åšè¿‡ç±»ä¼¼çš„æ–¹æ¡ˆï¼Œ éå¸¸æ¬¢è¿å¤§å®¶æäº¤PRç»™æˆ‘ cpu/jvm gc è¿™äº›å¯ä»¥ç›´æ¥ä½¿ç”¨æ˜¯simpleclient_hotspotæä¾›çš„exports @agapple æœ€è¿‘æ­£å¥½å­¦ä¹ ç›¸å…³å†…å®¹ï¼Œæˆ‘å¯ä»¥æprå—ï¼Œå·®ä¸å¤šå‘¨æœ«çš„æ—¶å€™ã€‚ éå¸¸æ¬¢è¿ä¸¤ä½æäº¤PR æ ¹æ® @agapple çš„commentsï¼Œç»“åˆè‡ªå·±ä½¿ç”¨çš„ä¸€äº›æ„Ÿå—ï¼Œè¯´ä¸‹å®ç°canal serverè‡ªèº«ç›‘æ§çš„ä¸€äº›æƒ³æ³•ï¼Œ å…ˆåˆ—å‡ºä¸€äº›æŒ‡æ ‡ï¼ˆä»¥å¼€å¯parallelæ¨¡å¼è§£æä¸ºä¾‹ï¼‰ï¼ŒPS: é€šè¿‡å¸¦instance tagå¯ä»¥å°†æŒ‡æ ‡ä»¥instanceçº§åˆ«æ”¶é›†ï¼Œç„¶åæ±‡æ€»ï¼š 1. ä»readåˆ°store put a. è¡¨ç¤ºinboundæµé‡çš„canal_inbound_bytes b. è¡¨ç¤ºdumpçº¿ç¨‹pushlish events -> disruptor bufferé˜»å¡æ—¶é—´ç‰‡çš„ canal_dump_publish_blocking_time c. è¡¨ç¤ºsinkçº¿ç¨‹put events -> storeé˜»å¡æ—¶é—´ç‰‡çš„ canal_sink_put_blocking_time d. é€šè¿‡CanalEventDownStreamHandlerï¼Œå¯ä»¥è·å¾—ä»£è¡¨å»¶è¿Ÿçš„ canal_instance_delayï¼›å„ç§Event typeçš„åˆ†ç±»ç»Ÿè®¡ï¼›é€šè¿‡rowchangeé™„å¸¦çš„rowDataæ•°é‡åˆ¤æ–­è¿‘æœŸæ˜¯å¦æœ‰æ‰¹é‡SQLç­‰ç­‰ã€‚ 2. netty serverç«¯ï¼Œä½¿ç”¨SessionHandlerè°ƒç”¨writeæ—¶ï¼Œå¢åŠ ChannelFutureListenerå›è°ƒï¼Œå°†clientçš„è¯·æ±‚å’Œå®Œæˆä¿¡æ¯è¿›è¡Œé‡‡æ ·ï¼ŒåŒ…æ‹¬destination  PacketType  write amount  batchId(ä»…å¯¹GETï¼Œåˆ¤æ–­æ˜¯å¦ç©ºåŒ…)  error code  response time ç­‰ a. è¡¨ç¤ºoutboundæµé‡çš„canal_inbound_bytes b. å„packetTypeåŒ…çš„åˆ†ç±»ç»Ÿè®¡ c. ç©ºåŒ…ç‡ d. å‘ç”Ÿçš„erroræŒ‰error codeç»Ÿè®¡ e. å“åº”æ—¶é—´ 3. event storeï¼Œæ¯”è¾ƒå¤©ç„¶çš„åŸ‹ç‚¹ï¼š a. TPSï¼Œæ ¹æ®ackSequenceè®¡ç®— b. å¦‚æœæ˜¯memoryæ¨¡å¼ï¼ŒMPSï¼Œæ ¹æ®ackMemSizeè®¡ç®— c. store remain events æ•°é‡ d. store remain memory ä¸€äº›åœºæ™¯ï¼š - 1-b æ— æ˜æ˜¾ blockingï¼Œ1-d delayä¸æ–­å¢åŠ ï¼Œ1-a æµé‡è¾ƒå° --> å¯å¤§è‡´æ¨æ–­ç“¶é¢ˆåœ¨ç½‘ç»œï¼Œæ˜¯å¦å¸¦å®½ä¸å¤Ÿæˆ–æµé‡è¢«æŒ¤å ã€‚ - 1-b æœ‰æ˜¾è‘— blockingï¼Œ1-c æ— æ˜æ˜¾blockingï¼ˆclientæ¶ˆè´¹å¾ˆå¿«ï¼‰--> å¯å°è¯•å¢åŠ canal.instance.parser.parallelThreadSizeåŠ å¿«è§£æé€Ÿåº¦ - 1-b å’Œ 1-cå‡æœ‰æ˜¾è‘—blocking  delayä¸æ–­å¢åŠ  --> ç“¶é¢ˆåœ¨äºclientè¯»å†™å’Œæ¶ˆè´¹ - 2-c ç©ºåŒ…é¢‘ç‡é«˜ --> å¯è€ƒè™‘è°ƒæ•´ä¼˜åŒ–getçš„timeoutæ—¶é—´ - 2-b && 2-d --> clientçš„è¡Œä¸ºæ˜¯å¦æ­£å¸¸ æ¬¢è¿commentsã€‚ BTW  æ–°æ‹‰äº†ä¸€ä¸ªåˆ†æ”¯metrics_supportã€‚ @lcybo è€ƒè™‘çš„éå¸¸å…¨é¢äº†ï¼Œç‚¹èµä¸€ä¸ª :) <img width="910" alt="grafana" src="https://user-images.githubusercontent.com/15042781/44220795-30379600-a1b2-11e8-9f56-24dd8395f0bf.PNG"> è´´ä¸€å¼ é¢„è§ˆå›¾ã€‚å®¶é‡Œçš„ç¯å¢ƒï¼Œtrafficéšä¾¿çŒçš„ï¼Œä¸å¤ªå®¹æ˜“æ¨¡æ‹Ÿå¤æ‚åœºæ™¯ã€‚ å¤ªèµäº†  perfect! <img width="251" alt="down" src="https://user-images.githubusercontent.com/15042781/44293887-3f0d6e00-a2c2-11e8-92e7-da3ccae6c991.PNG"> ç”Ÿæˆæ¨¡æ¿ï¼Œå¢åŠ datasourceä¾¿åˆ©é…ç½®ï¼Œinstancesåˆ‡æ¢ æäº¤äº†æ¨¡æ¿/canal/conf/metrics/Canal_instances_tmpl.json å¯¹dashboardé‡æ–°è¿›è¡Œäº†æ’ç‰ˆ ä½¿ç”¨è¯´æ˜æ–‡æ¡£ä¹Ÿå·²å‘Šä¸€æ®µè½ã€‚ å¦‚æœæœ‰é—®é¢˜ï¼Œæˆ‘ä¼šå°½å¿«ä¿®å¤ã€‚ ![image](https://user-images.githubusercontent.com/834743/44321609-8ab74780-a47b-11e8-80c2-6d5baab962fa.png) æœ€åçš„æ•ˆæœå›¾ï¼Œå…·ä½“å¯ä»¥å‚è§ï¼šhttps://github.com/alibaba/canal/wiki/Prometheus-QuickStart
764,canal 1.0.26 å¶å°”æ–­å¼€è¿æ¥ç„¶åä»æ–°è¿æ¥å éƒ¨åˆ†åŒæ­¥åœæ­¢ ä½¿ç”¨åœºæ™¯: 1 å•å°è™šæ‹Ÿæœºè¿æ¥20ä¸ªæ•°æ®åº“çš„åŒæ­¥ä»»åŠ¡ æŸä¸€æ—¶åˆ»çªç„¶å‡ºç°å¤§æ‰¹é‡å¦‚ä¸‹æ—¥å¿— ä½†æ˜¯ä»æ–°è¿æ¥å éƒ¨åˆ†æ•°æ®åº“åŒæ­¥æ­£å¸¸ éƒ¨åˆ†æ•°æ®åº“åŒæ­¥åœæ­¢ zkçš„cursorä¸å˜åŒ– åœç•™åœ¨æ–­å¼€è¿æ¥çš„åœ°æ–¹.æ—¥å¿—å¦‚ä¸‹ MysqlConnector - |disConnect Mysql Connection to 10.x.x.x/10.x.x.x:3306..... MysqlConnector - |connect Mysql Connection to 10.x.x.x/10.x.x.x:3306..... MysqlConnector - |handshake initialization packet received  prepare the client authentication packet to send MysqlConnector - |client authentication packet is sent out. ç›®å‰å‡ºç°å¤šæ¬¡è¿™ç§æƒ…å†µ åŸå› æœªçŸ¥. ä¿¡æ¯å¤ªå°‘ï¼Œæ— æ³•å®šä½ï¼Œå¯ä»¥çœ‹çœ‹å½“æ—¶çš„jstack +1 ä¸æ–­æœ‰kill dumpä»¥åŠdisConnectã€connect ã€handshakeï¼Œå†…ç½‘æµ‹è¯•æ˜¯è¿™æ ·çš„ @kervin521 ä½ ä¹Ÿé‡åˆ°è¿™ä¸ªé—®é¢˜äº†?è¿˜æ˜¯è®©æˆ‘æä¾›æ›´å¤šçš„ä¿¡æ¯?ç°åœ¨åœ¨æŒ‰ç…§å¤§ç¥çš„æ„æ€ åˆ†æjstack. æœ‰å¤ç°æ–¹æ³•ä¹‹åå†reopen
763,canal.instance.filter.regexå¤šä¸ªæ—¶ï¼Œåªèƒ½æŠ“å–åˆ°ç¬¬ä¸€é¡¹ï¼Œåé¢å‡ é¡¹æ•°æ®å˜æ›´è·å–ä¸åˆ° ä¾‹å¦‚ï¼š ``` canal.instance.filter.regex=vip\\.crm.* .oms.* .ser.* .sku.* .vip.* .wfe.* ``` åªèƒ½è·å–åˆ°â€œ**crm**â€å‰ç¼€è¡¨çš„æ•°æ®å˜æ›´ã€‚**oms**åŠåé¢çš„è·å–ä¸åˆ°ã€‚ çœ‹ä¸€ä¸‹ https://github.com/alibaba/canal/wiki/FAQ
762,ä¿®æ”¹Readme.md æ–°å¢DTSè¯´æ˜ [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=762) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=762) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=762) it.</sub>
761,æ·»åŠ Canalå•†ä¸šåŒ–ç‰ˆæœ¬æ›´æ–°è¯´æ˜ æ·»åŠ Canalå•†ä¸šåŒ–ç‰ˆæœ¬æ›´æ–°è¯´æ˜ [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=761) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=761) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=761) it.</sub> é‡å¤äº† è¿™ä¸ªåç»­ä¼šå¢åŠ  ï¼Œhdfs/hbase/ ç­‰å…¶ä»–æ¥å£æ’ä»¶ä¸ï¼Ÿ
760,canal+OTTER clientç«¯batchid=-1 canalç‰ˆæœ¬ï¼š1.0.22 é…ç½®å¯åŠ¨åï¼Œclientç«¯ä½¿ç”¨canalConnector.getWithoutAck(batchSize)getId();å¾—åˆ°çš„å€¼ä¸€ç›´ä¸º-1ã€‚ä¸”åœ¨zkä¸Š1001nodeä¸‹cursorèŠ‚ç‚¹ä¸€ç›´æ²¡æœ‰ç”Ÿæˆï¼Œcanalç«¯logæ­£å¸¸ã€‚ clientç«¯logï¼š ![image](https://user-images.githubusercontent.com/41414514/42923813-0c834b50-8b5a-11e8-83f4-bf00bdb56d34.png) åœ¨canalç«¯è®¾ç½®binlogåå­—ä»¥åŠpositionä¾æ—§åˆ›å»ºä¸äº†cursorã€‚ä¸”æ–‡ä»¶å­˜åœ¨ã€‚ æœ‰äººé‡åˆ°è¿‡è¿™æ ·çš„é—®é¢˜å—ï¼Ÿæ±‚æ•™ çœ‹çœ‹canal serverä¸Šçš„æ—¥å¿—æ˜¯å¦æœ‰å¼‚å¸¸
759,append gtid lastCommitted and sequenceNumber support [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=759) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=759) before we can accept your contribution.<br/><hr/>**winger** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=759) it.</sub> tks
758,clientåˆ‡æ¢æ—¶å»¶é—®é¢˜ éƒ¨ç½²äº†ä¸¤ä¸ªclientç«¯é€šè¿‡zkç›‘å¬åŒä¸€ä¸ªdestinationï¼Œçœ‹äº†ä¸€ä¸‹æ–‡æ¡£ï¼Œè²Œä¼¼æ²¡æœ‰æè¿°ä¸¤ä¸ªclientåˆ‡æ¢æ—¶è·å–æ•°æ®çš„æ—¶é—´é—´éš”ï¼Œä¸¤ä¸ªclientç«¯éƒ½æ˜¯é€šè¿‡whileï¼ˆtrueï¼‰æ–¹å¼ä¸åœçš„ subscribeã€connectã€getMessageã€‚æŒ‰ç†æ¥è¯´ï¼Œæ—¶é—´é—´éš”å°±åº”è¯¥æ˜¯zkå¤„ç†ç»“ç‚¹çŠ¶æ€å˜åŒ–çš„æ—¶é—´ï¼Œæˆ‘è®¾ç½®çš„æ˜¯ canal.zookeeper.flush.period=1000ï¼Œä»ç»“æœä¸Šæ¥çœ‹æ¯æ¬¡é—´éš”å¤§çº¦30Så·¦å³ï¼Œå’Œé…ç½®ç›¸å·®è¾ƒå¤§ï¼Œè¯·é—®ï¼Œæœ‰åŠæ³•ç¼©çŸ­ä¸€ä¸‹è¿™ä¸ªé—´éš”å—ï¼Œä¸šåŠ¡å¯¹å®æ—¶æ€§è¦æ±‚å¾ˆé«˜ã€‚ è¿™æ˜¯zookeeperçš„sessionTimeoutï¼Œä½ ç½‘ä¸Šæ‰¾æ‰¾å‚æ•°è°ƒä½ä¸€ä¸‹
757,ç”¨äº† 1.0.26 p3ç‰ˆæœ¬ï¼Œä¸ºä»€ä¹ˆ EventType.QUERY æ‰“å°çš„sqlæ˜¯ insert æˆ–è€…æ˜¯ create tableï¼Ÿ > DEBUG com.pamirs.data.AbstractCanalClient - Event Type Is Query  sql --> UPDATE T_PDC_HANDOVER_INDEX_OR ä»£ç å¦‚ä¸‹ ```java  if (eventType == EventType.QUERY                                     || rowChage.getIsDdl()) {                                 if (rowChage.getIsDdl()) {                                     StringBuilder exceptionMessage = new StringBuilder();                                     exceptionMessage.append("mysql has an ddl  sql is [ ").append(rowChage.getSql()).append(" ]");                                     ExceptionHandle.handleException(new ExceptionMessageEntity(entityTask.getTableTask().getId()  ExceptionMessageEntityDesc.PAMIRS_DATA_MYSQL_PULL_DDL_MESSAGE  ExceptionMessageTypeEnum.pamirs_data  exceptionMessage.toString()));                                 } else {                                     logger.debug("Event Type Is Query  sql --> {}"  rowChage.getSql());                                 }                                return;  } ``` RowsQueryLogEvent ï¼Œ 5.6ä¹‹åçš„rowæ¨¡å¼çš„binlogä¼šæ··æ‚statementå’Œrowï¼Œé’ˆå¯¹insert/update/deleteä¹Ÿä¼šè®°å½•å¯¹åº”çš„åŸå§‹SQLï¼Œæ‹¿åˆ°çš„è¿™ä¸ªsqlå°±æ˜¯è¿™è´§ @agapple é‚£åº”è¯¥æ€ä¹ˆåŒºåˆ†å‘¢ï¼Ÿ
756, com.lmax.disruptor.FatalExceptionHandler handleEventException åˆšäº†è§£canalï¼Œç›´æ¥ç”¨canal.kafka-1.0.26-SNAPSHOT.taråŒ…çš„æ—¶å€™ä¼šæŠ¥ä¸€ä¸ªcom.alibaba.druid.pool.DruidDataSource - testWhileIdle is true  validationQuery not setï¼Œä½†è¿˜æ˜¯å¯ä»¥ç”¨ï¼Œä½†åœ¨ç”¨kafkaåŒ…è·‘CanalLauncher.javaçš„æ—¶å€™å‡ºç°é”™è¯¯ ![image](https://user-images.githubusercontent.com/26325971/42809370-19b008e0-89e8-11e8-8ba0-bc520efcb083.png)ï¼Œè¯·é—®æ˜¯æˆ‘å“ªé‡Œåšé”™äº†å—ã€‚ çœŸçš„æ‰¾ä¸åˆ°é”™è¯¯åœ¨å“ªé‡Œï¼Œæ¥¼ä¸»help meã€‚ ![image](https://user-images.githubusercontent.com/26325971/42810158-d57bd4ae-89e9-11e8-95a9-97a38b5d6402.png)ï¼Œé…ç½®æ–‡ä»¶ä¿¡æ¯ ![image](https://user-images.githubusercontent.com/26325971/42810224-04150a7e-89ea-11e8-954b-1855e2d8fe0b.png) ![image](https://user-images.githubusercontent.com/26325971/42813766-a1392646-89f4-11e8-82ea-3279b7b1e13a.png) è¯·é—®è¿™ä¸ªæ€æ ·å­è§£å†³ ![image](https://user-images.githubusercontent.com/834743/42819117-28463a7e-8a05-11e8-9058-64224e83e062.png) å‡ºç°é‡å¤çš„slaveId  ä¼˜åŒ–äº†ä¸€ä¸‹æ—¥å¿—è¾“å‡ºï¼Œå»æ‰äº†æ— ç”¨çš„ æˆ‘ä¹Ÿçœ‹åˆ°äº†è¿™ä¸ªé‡å¤slaveIdçš„é”™è¯¯ï¼Œä½†æ˜¯æˆ‘åªæœ‰ä¸€ä¸ªåœ¨Instance.prorertiesï¼Œåªå®šä¹‰äº†ä¸€ä¸ª ![image](https://user-images.githubusercontent.com/26325971/42854088-b68f65c8-8a6c-11e8-94c2-abc81424ca81.png)ï¼Œè¿˜æœ‰å“ªé‡Œè¦æ”¹çš„å—ã€‚ 
755,é…ç½®çš„filter.regexä¸ç”Ÿæ•ˆï¼Œserveræ²¡æœ‰è¿‡æ»¤æ‰sysåº“æ•°æ®ï¼Œæœ‰æ—¶å€™ä¹Ÿæ²¡è¿‡æ»¤æ‰mysqlåº“æ•°æ® ç‰ˆæœ¬ï¼š1.0.26 binlogæ¨¡å¼ï¼šROW instance.propertiesé…ç½®ï¼š canal.instance.filter.regex=blacklist3\\..* canal.instance.filter.black.regex= serveræ—¥å¿—ï¼š 2018-07-17 15:45:09.388 [destination = xxxx   address = /xxxx:xxxx   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:xxxx[com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: ErrorPacket [errorNumber=1142  fieldCount=-1  message=SHOW VIEW command denied to user 'xxxx'@'xxxx for table 'host_summary'  sqlState=42000  sqlStateMarker=#]  with command: show create table `sys`.`host_summary`;show create table `sys`.`host_summary_by_file_io`;show create table `sys`.`host_summary_by_file_io_type`;show create table `sys`.`host_summary_by_stages`;show create table `sys`.`host_summary_by_statement_latency`;show create table `sys`.`host_summary_by_statement_type`;show create table `sys`.`innodb_buffer_stats_by_schema`;show create table `sys`.`innodb_buffer_stats_by_table`;show create table `sys`.`innodb_lock_waits`;show create table `sys`.`io_by_thread_by_latency`;show create table `sys`.`io_global_by_file_by_bytes`;show create table `sys`.`io_global_by_file_by_latency`;show create table `sys`.`io_global_by_wait_by_bytes`;show create table `sys`.`io_global_by_wait_by_latency`;show create table `sys`.`latest_file_io`;show create table `sys`.`memory_by_host_by_current_bytes`;show create table `sys`.`memory_by_thread_by_current_bytes`;show create table `sys`.`memory_by_user_by_current_bytes`;show create table `sys`.`memory_global_by_current_bytes`;show create table `sys`.`memory_global_total`;show create table `sys`.`metrics`;show create table `sys`.`processlist`;show create table `sys`.`ps_check_lost_instrumentation`;show create table `sys`.`schema_auto_increment_columns`;show create table `sys`.`schema_index_statistics`;show create table `sys`.`schema_object_overview`;show create table `sys`.`schema_redundant_indexes`;show create table `sys`.`schema_table_lock_waits`;show create table `sys`.`schema_table_statistics`;show create table `sys`.`schema_table_statistics_with_buffer`;show create table `sys`.`schema_tables_with_full_table_scans`;show create table `sys`.`schema_unused_indexes`;show create table `sys`.`session`;show create table `sys`.`session_ssl_status`;show create table `sys`.`statement_analysis`;show create table `sys`.`statements_with_errors_or_warnings`;show create table `sys`.`statements_with_full_table_scans`;show create table `sys`.`statements_with_runtimes_in_95th_percentile`;show create table `sys`.`statements_with_sorting`;show create table `sys`.`statements_with_temp_tables`;show create table `sys`.`sys_config`;show create table `sys`.`user_summary`;show create table `sys`.`user_summary_by_file_io`;show create table `sys`.`user_summary_by_file_io_type`;show create table `sys`.`user_summary_by_stages`;show create table `sys`.`user_summary_by_statement_latency`;show create table `sys`.`user_summary_by_statement_type`;show create table `sys`.`version`;show create table `sys`.`wait_classes_global_by_avg_latency`;show create table `sys`.`wait_classes_global_by_latency`;show create table `sys`.`waits_by_host_by_latency`;show create table `sys`.`waits_by_user_by_latency`;show create table `sys`.`waits_global_by_latency`;show create table `sys`.`x$host_summary`;show create table `sys`.`x$host_summary_by_file_io`;show create table `sys`.`x$host_summary_by_file_io_type`;show create table `sys`.`x$host_summary_by_stages`;show create table `sys`.`x$host_summary_by_statement_latency`;show create table `sys`.`x$host_summary_by_statement_type`;show create table `sys`.`x$innodb_buffer_stats_by_schema`;show create table `sys`.`x$innodb_buffer_stats_by_table`;show create table `sys`.`x$innodb_lock_waits`;show create table `sys`.`x$io_by_thread_by_latency`;show create table `sys`.`x$io_global_by_file_by_bytes`;show create table `sys`.`x$io_global_by_file_by_latency`;show create table `sys`.`x$io_global_by_wait_by_bytes`;show create table `sys`.`x$io_global_by_wait_by_latency`;show create table `sys`.`x$latest_file_io`;show create table `sys`.`x$memory_by_host_by_current_bytes`;show create table `sys`.`x$memory_by_thread_by_current_bytes`;show create table `sys`.`x$memory_by_user_by_current_bytes`;show create table `sys`.`x$memory_global_by_current_bytes`;show create table `sys`.`x$memory_global_total`;show create table `sys`.`x$processlist`;show create table `sys`.`x$ps_digest_95th_percentile_by_avg_us`;show create table `sys`.`x$ps_digest_avg_latency_distribution`;show create table `sys`.`x$ps_schema_table_statistics_io`;show create table `sys`.`x$schema_flattened_keys`;show create table `sys`.`x$schema_index_statistics`;show create table `sys`.`x$schema_table_lock_waits`;show create table `sys`.`x$schema_table_statistics`;show create table `sys`.`x$schema_table_statistics_with_buffer`;show create table `sys`.`x$schema_tables_with_full_table_scans`;show create table `sys`.`x$session`;show create table `sys`.`x$statement_analysis`;show create table `sys`.`x$statements_with_errors_or_warnings`;show create table `sys`.`x$statements_with_full_table_scans`;show create table `sys`.`x$statements_with_runtimes_in_95th_percentile`;show create table `sys`.`x$statements_with_sorting`;show create table `sys`.`x$statements_with_temp_tables`;show create table `sys`.`x$user_summary`;show create table `sys`.`x$user_summary_by_file_io`;show create table `sys`.`x$user_summary_by_file_io_type`;show create table `sys`.`x$user_summary_by_stages`;show create table `sys`.`x$user_summary_by_statement_latency`;show create table `sys`.`x$user_summary_by_statement_type`;show create table `sys`.`x$wait_classes_global_by_avg_latency`;show create table `sys`.`x$wait_classes_global_by_latency`;show create table `sys`.`x$waits_by_host_by_latency`;show create table `sys`.`x$waits_by_user_by_latency`;show create table `sys`.`x$waits_global_by_latency`; Caused by: java.io.IOException: ErrorPacket [errorNumber=1142  fieldCount=-1  message=SHOW VIEW command denied to user 'xxxx'@'xxxx' for table 'host_summary'  sqlState=42000  sqlStateMarker=#]  with command: show create table `sys`.`host_summary`;show create table `sys`.`host_summary_by_file_io`;show create table `sys`.`host_summary_by_file_io_type`;show create table `sys`.`host_summary_by_stages`;show create table `sys`.`host_summary_by_statement_latency`;show create table `sys`.`host_summary_by_statement_type`;show create table `sys`.`innodb_buffer_stats_by_schema`;show create table `sys`.`innodb_buffer_stats_by_table`;show create table `sys`.`innodb_lock_waits`;show create table `sys`.`io_by_thread_by_latency`;show create table `sys`.`io_global_by_file_by_bytes`;show create table `sys`.`io_global_by_file_by_latency`;show create table `sys`.`io_global_by_wait_by_bytes`;show create table `sys`.`io_global_by_wait_by_latency`;show create table `sys`.`latest_file_io`;show create table `sys`.`memory_by_host_by_current_bytes`;show create table `sys`.`memory_by_thread_by_current_bytes`;show create table `sys`.`memory_by_user_by_current_bytes`;show create table `sys`.`memory_global_by_current_bytes`;show create table `sys`.`memory_global_total`;show create table `sys`.`metrics`;show create table `sys`.`processlist`;show create table `sys`.`ps_check_lost_instrumentation`;show create table `sys`.`schema_auto_increment_columns`;show create table `sys`.`schema_index_statistics`;show create table `sys`.`schema_object_overview`;show create table `sys`.`schema_redundant_indexes`;show create table `sys`.`schema_table_lock_waits`;show create table `sys`.`schema_table_statistics`;show create table `sys`.`schema_table_statistics_with_buffer`;show create table `sys`.`schema_tables_with_full_table_scans`;show create table `sys`.`schema_unused_indexes`;show create table `sys`.`session`;show create table `sys`.`session_ssl_status`;show create table `sys`.`statement_analysis`;show create table `sys`.`statements_with_errors_or_warnings`;show create table `sys`.`statements_with_full_table_scans`;show create table `sys`.`statements_with_runtimes_in_95th_percentile`;show create table `sys`.`statements_with_sorting`;show create table `sys`.`statements_with_temp_tables`;show create table `sys`.`sys_config`;show create table `sys`.`user_summary`;show create table `sys`.`user_summary_by_file_io`;show create table `sys`.`user_summary_by_file_io_type`;show create table `sys`.`user_summary_by_stages`;show create table `sys`.`user_summary_by_statement_latency`;show create table `sys`.`user_summary_by_statement_type`;show create table `sys`.`version`;show create table `sys`.`wait_classes_global_by_avg_latency`;show create table `sys`.`wait_classes_global_by_latency`;show create table `sys`.`waits_by_host_by_latency`;show create table `sys`.`waits_by_user_by_latency`;show create table `sys`.`waits_global_by_latency`;show create table `sys`.`x$host_summary`;show create table `sys`.`x$host_summary_by_file_io`;show create table `sys`.`x$host_summary_by_file_io_type`;show create table `sys`.`x$host_summary_by_stages`;show create table `sys`.`x$host_summary_by_statement_latency`;show create table `sys`.`x$host_summary_by_statement_type`;show create table `sys`.`x$innodb_buffer_stats_by_schema`;show create table `sys`.`x$innodb_buffer_stats_by_table`;show create table `sys`.`x$innodb_lock_waits`;show create table `sys`.`x$io_by_thread_by_latency`;show create table `sys`.`x$io_global_by_file_by_bytes`;show create table `sys`.`x$io_global_by_file_by_latency`;show create table `sys`.`x$io_global_by_wait_by_bytes`;show create table `sys`.`x$io_global_by_wait_by_latency`;show create table `sys`.`x$latest_file_io`;show create table `sys`.`x$memory_by_host_by_current_bytes`;show create table `sys`.`x$memory_by_thread_by_current_bytes`;show create table `sys`.`x$memory_by_user_by_current_bytes`;show create table `sys`.`x$memory_global_by_current_bytes`;show create table `sys`.`x$memory_global_total`;show create table `sys`.`x$processlist`;show create table `sys`.`x$ps_digest_95th_percentile_by_avg_us`;show create table `sys`.`x$ps_digest_avg_latency_distribution`;show create table `sys`.`x$ps_schema_table_statistics_io`;show create table `sys`.`x$schema_flattened_keys`;show create table `sys`.`x$schema_index_statistics`;show create table `sys`.`x$schema_table_lock_waits`;show create table `sys`.`x$schema_table_statistics`;show create table `sys`.`x$schema_table_statistics_with_buffer`;show create table `sys`.`x$schema_tables_with_full_table_scans`;show create table `sys`.`x$session`;show create table `sys`.`x$statement_analysis`;show create table `sys`.`x$statements_with_errors_or_warnings`;show create table `sys`.`x$statements_with_full_table_scans`;show create table `sys`.`x$statements_with_runtimes_in_95th_percentile`;show create table `sys`.`x$statements_with_sorting`;show create table `sys`.`x$statements_with_temp_tables`;show create table `sys`.`x$user_summary`;show create table `sys`.`x$user_summary_by_file_io`;show create table `sys`.`x$user_summary_by_file_io_type`;show create table `sys`.`x$user_summary_by_stages`;show create table `sys`.`x$user_summary_by_statement_latency`;show create table `sys`.`x$user_summary_by_statement_type`;show create table `sys`.`x$wait_classes_global_by_avg_latency`;show create table `sys`.`x$wait_classes_global_by_latency`;show create table `sys`.`x$waits_by_host_by_latency`;show create table `sys`.`x$waits_by_user_by_latency`;show create table `sys`.`x$waits_global_by_latency`; 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.queryMulti(MysqlQueryExecutor.java:109) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.queryMulti(MysqlConnection.java:101) 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:173) 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:84) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:173) 	at java.lang.Thread.run(Thread.java:745) debugçœ‹çœ‹DatabaseTableMeta.dumpTableMeta()æ˜¯å¦filteræ¡ä»¶æ²¡æ­£ç¡®æ¥æ”¶åˆ°ï¼Œè¢«clientçš„subscribeæ¡ä»¶ç»™è¦†ç›–äº† åº”è¯¥æ˜¯è¿™ä¸ªé—®é¢˜ï¼ åœ¨serverç«¯åŒå®ä¾‹çš„åˆ‡æ¢ã€‚ clientç«¯é…ç½®å¦‚ä¸‹éƒ½ä¼šå½±å“åˆ°serverç«¯ï¼š ``` String filter = ".*"; String filter = "\\.*"; String filter = "\\.\\*"; String filter = ".*\\\\..*"; ``` çœ‹äº†ä¸€ä¸‹æºç   å¦‚æœè®¾ç½®æˆnullï¼Œå°±ä¸å½±å“ã€‚ String filter = null; å…·ä½“çš„å½±å“è¡¨ç°ä¸ºï¼Œåå¯åŠ¨çš„é‚£ä¸ªserverä¼šè®¢é˜…serverç«¯filterä¹‹å¤–çš„è¡¨ï¼Œå¯¼è‡´æ²¡æƒé™æŠ¥é”™ï¼Œå®¢æˆ·ç«¯getMessageå°±ä¸€ç›´æ˜¯ç©ºã€‚ ä¸¤ä¸ªserverå®ä¾‹é…ç½®ï¼š canal.properties é™¤äº†canal.id canal.portéƒ½ä¸€æ · instance.properties é™¤äº† canal.instance.mysql.slaveIdéƒ½ä¸€æ ·ã€‚ `canal.instance.filter.regex=blacklist3\\..*` 
754,fix issue #751 [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=754) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=754) before we can accept your contribution.<br/><hr/>**winger** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=754) it.</sub> [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=754) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=754) before we can accept your contribution.<br/><hr/>**winger** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=754) it.</sub> tks
753,com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed è¿è¡Œä¸€æ®µæ—¶é—´ æ€»æ˜¯æŠ¥è¿™ä¸ªé”™è¯¯ï¼Œ ç‰ˆæœ¬1.0.26 com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first Caused by: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first 	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4832) ~[guava-18.0.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:160) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:759) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:428) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:114) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:66) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:337) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:184) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:145) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] Caused by: java.io.IOException: should execute connector.connect() first 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.<init>(MysqlQueryExecutor.java:30) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:87) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMetaByDB(TableMetaCache.java:80) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.access$000(TableMetaCache.java:30) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:55) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:50) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3527) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2319) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2282) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2197) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache.get(LocalCache.java:3937) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3941) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4824) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4830) ~[guava-18.0.jar:na] 	... 10 common frames omitted 2018-07-17 10:48:26.646 [destination = example   address = /172.16.203.11:3309   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address 172.16.203.11/172.16.203.11:3309 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first Caused by: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first 	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4832) ~[guava-18.0.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:160) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:759) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:428) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:114) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:66) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:337) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:184) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:145) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] Caused by: java.io.IOException: should execute connector.connect() first 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.<init>(MysqlQueryExecutor.java:30) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:87) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMetaByDB(TableMetaCache.java:80) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.access$000(TableMetaCache.java:30) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:55) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:50) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3527) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2319) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2282) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2197) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache.get(LocalCache.java:3937) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3941) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4824) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4830) ~[guava-18.0.jar:na] 	... 10 common frames omitted 2018-07-17 10:48:26.646 [destination = example   address = /172.16.203.11:3309   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first Caused by: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first 	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4832) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:160) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:759) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:428) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:114) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:66) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:337) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:184) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:145) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220) 	at java.lang.Thread.run(Thread.java:748) Caused by: java.io.IOException: should execute connector.connect() first 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.<init>(MysqlQueryExecutor.java:30) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:87) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMetaByDB(TableMetaCache.java:80) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.access$000(TableMetaCache.java:30) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:55) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:50) 	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3527) 	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2319) 	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2282) 	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2197) 	at com.google.common.cache.LocalCache.get(LocalCache.java:3937) 	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3941) 	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4824) 	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4830) 	... 10 more ] ä½ ä¸‹è½½ä¸€ä¸ªæœ€æ–°çš„26ç‰ˆæœ¬ï¼Œä»£ç è¡Œå¯¹ä¸ä¸Š
752,GTIDæ— æ³•è·å–åˆ° ![6b06917b225fc61a76d0b901b656ecc9](https://user-images.githubusercontent.com/5210147/42793757-40d64d60-89ae-11e8-8090-f69238c5ed5a.jpg) æˆ‘çš„ä¸»ä»éƒ½æ˜¯å¼€å¯çš„gtidï¼ŒåŒæ­¥æ­£å¸¸ï¼Œåªæœ‰åœ¨transactionendçš„æ—¶å€™ä¼šæœ‰äº‹åŠ¡idï¼Œå…¶å®ƒæ—¶å€™æ— æ³•è·å–åˆ°gtidå’Œäº‹åŠ¡id gtidçš„è·å–æ–¹å¼ä½ çœ‹è¿‡exampleä»£ç äº†å—ï¼Ÿåœ¨æ‰©å±•å±æ€§å­—æ®µé‡Œ å“¥ï¼Œexampleé‡Œ entry.getHeader().getGtid() æ‰“å°å‡ºæ¥æ˜¯ä¸ªç©ºå­—ç¬¦ä¸² éœ€è¦å¼€å¯canal gtidçš„è®¢é˜… instance.property canal.instance.gtidon=true æŠŠè¿™ä¸ªæ‰“å¼€å°±okï¼ thanksï¼ï¼ï¼
751,canal å¢åŠ æ ‡è®°ä¸€ä¸ªäº‹åŠ¡å†…çš„ row data è®¡æ•° Hi  @agapple é’ˆå¯¹å¤§äº‹åŠ¡åœºæ™¯ï¼Œç”±äºcanalåœ¨ä¼ é€’è¿‡ç¨‹ä¸­ï¼Œè¶…è¿‡ä¸€å®šæ•°é‡å(é»˜è®¤1024)ä¼šåˆ†æ‰¹å‘é€ï¼Œå¯¹äºä¸€äº›ä¸šåŠ¡åœºæ™¯ä¸‹æ˜¯éœ€è¦çŸ¥é“ä¸€ä¸ªå¤§äº‹åŠ¡å†…çš„row dataæ•°é‡ç„¶åè¿›è¡Œåˆå¹¶å¤„ç†  
750,canal.deployer-1.0.26-SNAPSHOTç‰ˆæœ¬è¿è¡ŒåæŠ¥ä½ç‚¹é”™è¯¯ The details of the false information are as follows: something goes wrong with channel:[id: 0x1d0b2315  /xx.xx.xx.xx:xxxx => /xx.xx.xx.xx:xxxx]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: ack error   clientId:1001 batchId:261365 is not exist   please check [New I/O server worker #1-12] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x1d0b2315  /xx.xx.xx.xx:xxxx :> /xx.xx.xx.xx:xxxx]  exception=java.nio.channels.ClosedChannelException         at org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:649)         at org.jboss.netty.channel.socket.nio.NioWorker.writeFromUserCode(NioWorker.java:370)         at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:137)         at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76)         at org.jboss.netty.channel.Channels.write(Channels.java:611)         at org.jboss.netty.channel.Channels.write(Channels.java:578)         at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:28)         at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:144)         at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48)         at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276)         at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302)         at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526)         at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507)         at org.jboss.netty.handler.codec.replay.ReplayingDecoder.cleanup(ReplayingDecoder.java:542)         at org.jboss.netty.handler.codec.replay.ReplayingDecoder.channelDisconnected(ReplayingDecoder.java:450)         at org.jboss.netty.channel.Channels.fireChannelDisconnected(Channels.java:360)         at org.jboss.netty.channel.socket.nio.NioWorker.close(NioWorker.java:599)         at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:119)         at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76)         at org.jboss.netty.channel.Channels.close(Channels.java:720)         at org.jboss.netty.channel.AbstractChannel.close(AbstractChannel.java:208)         at org.jboss.netty.channel.ChannelFutureListener$1.operationComplete(ChannelFutureListener.java:46)         at org.jboss.netty.channel.DefaultChannelFuture.notifyListener(DefaultChannelFuture.java:381)         at org.jboss.netty.channel.DefaultChannelFuture.addListener(DefaultChannelFuture.java:148)         at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:30)         at com.alibaba.otter.canal.server.netty.NettyUtils.error(NettyUtils.java:51)         at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:200)         at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48)         at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276)         at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302)         at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526)         at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507)         at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:444)         at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274)         at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261)         at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:350)         at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:281)         at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:201)         at org.jboss.netty.util.internal.IoWorkerRunnable.run(IoWorkerRunnable.java:46)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)         at java.lang.Thread.run(Thread.java:745)  clientId:1001 batchId:261365 is not exist   please check  æœåŠ¡ç«¯ä¼°è®¡å‘ç”Ÿäº†instanceé‡å¯ ä¸ºä»€ä¹ˆä¼šå‘ç”Ÿé‡å¯ï¼Œæ€ä¹ˆé¿å…è¿™ä¸ªé‡å¯ï¼Ÿ
749,fastsql-2.0.0_preview_371åœ¨å“ªä¸ªmavenä¸‹è½½ï¼Ÿ ```xml <dependency>                 <groupId>com.alibaba.fastsql</groupId>                 <artifactId>fastsql</artifactId>                 <version>2.0.0_preview_371</version> </dependency> ``` ä¿®æ”¹ pom.xml æ›¿æ¢ fastsql èŠ‚ç‚¹å†…å®¹ï¼š     <dependency>         <groupId>com.alibaba.fastsql</groupId>         <artifactId>fastsql</artifactId>         <version>2.0.0_preview_186</version>     </dependency> 371åœ¨æˆ‘çš„äºŒè¿›åˆ¶é‡Œæœ‰ åœ¨masteråˆ†æ”¯ä¸­æ˜¯ä¸æ˜¯éœ€è¦æŠŠfastsqlçš„ä¾èµ–ä»371æ”¹æˆå¯ç”¨çš„ç‰ˆæœ¬å‘¢ï¼Ÿè¦ä¸ç„¶å¯¼å…¥é¡¹ç›®éƒ½æ‰¾ä¸åˆ°è¿™ä¸ªjarçš„ Missing artifact com.alibaba.fastsql:fastsql:jar:2.0.0_preview_520   ç°åœ¨åˆç¼ºè¿™ä¸ªåŒ…äº†ï¼Œå¥½å‘å‘€ï¼Œä¼ åˆ°mavenä¸€ä¸‹å‘—
748,canalçš„dumpå¤ªæ…¢æ€ä¹ˆå¤„ç† MySQLçš„show master status mysql-bin.000093 canalçš„dumpçš„zkä¸­parseï¼š mysql-bin.000064 æ¯ä¸ªbinlogå¤§å°100M dump entry: 30~40 event/second åœ¨MySQLä¸­show full processlist: æ˜¾ç¤ºcanalçš„dumpä¸º # writing to net ä½ è¿™æ˜¯æ–°ç‰ˆæœ¬çš„å˜›ï¼Ÿ @WithLin v1.0.25ï¼Œv1.0.26æœ‰é—®é¢˜æœ‰ä¸åœçš„æ–­å¼€é‡è¿æ•°æ®åº“è¿˜æœ‰æ•°æ®åº“è¿æ¥è¶…æ—¶é—®é¢˜ @agapple @kervin521 å…·ä½“æè¿°ä¸€ä¸‹v1.0.26çš„é—®é¢˜  ä½ æçš„å¤ªç¬¼ç»Ÿ
747,add restart.sh restart canal server [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=747) <br/>All committers have signed the CLA. [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=747) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=747) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=747) it.</sub> tks
746,canal server è¿æ¥æ•°æ®åº“è¶…æ—¶ serverè¿æ¥æ•°æ®åº“è¶…æ—¶ï¼Œç„¶åå°±ä¸å†é‡æ–°è¿æ¥äº†ï¼Œè¿‡äº†å¤§æ¦‚ä¸¤ä¸ªå°æ—¶å ï¼Œåˆè‡ªåŠ¨é‡æ–°è¿æ¥äº†ï¼Œè¯·é—®æ˜¯å“ªä¸ªå‚æ•°å¯ä»¥è®¾ç½® è¶…æ—¶ä¹‹åè¿‡å¤šé•¿æ—¶é—´é‡æ–°è¿æ¥å‘¢ ä½ æ¢æˆv1.0.25ç‰ˆæœ¬å§ï¼Œv1.0.26æœ‰é—®é¢˜ v1.0.25 æœ‰è¿™ä¸ªå‚æ•°è®¾ç½®ä¹ˆ æˆ‘çš„æ²¡æœ‰é—®é¢˜ï¼Ÿçœ‹ä¸€ä¸‹æ—¥å¿—ï¼Ÿæœ‰æŠ¥é”™å—ï¼Ÿ 25ç‰ˆæœ¬å·²ç»æ ‡è®°ä¸å»ºè®®ä½¿ç”¨äº†ï¼Œnioçš„é—®é¢˜ @WithLin 26ç‰ˆæœ¬è¿™ä¸åœçš„æ–­å¼€é‡è¿ä¹Ÿå¤ªå¤§å•¦ï¼ˆä¸‹åˆ7ç‚¹ä¹‹åå‡ºç°æ­¤æƒ…å†µæ¯”è¾ƒå¤šï¼‰ï¼Œæ¢æˆ25ç‰ˆæœ¬å°±æ²¡é—®é¢˜ï¼Œçœ‹æ˜¯å¦æ˜¯å®šæ—¶å™¨å“ªé‡Œæœ‰é—®é¢˜ @WithLin  æŠ¥é”™å°±æ˜¯ç®€å•çš„è¿æ¥è¶…æ—¶ connect timeout æ„Ÿè§‰å¯èƒ½æ˜¯ç½‘ç»œæ³¢åŠ¨å¼•èµ·çš„ï¼Œä½†æ˜¯ å®ƒéš”äº†2ä¸ªå°æ—¶æ‰å»é‡æ–°è·å–è¿æ¥ï¼Œæ˜¯ä¸æ˜¯å¤ªå¤ªä¹…äº†ã€‚è¶…æ—¶ä¹‹å å¤šä¹…å»é‡æ–°è·å–è¿æ¥ï¼Œæ²¡æœ‰å¯ä»¥è‡ªå·±è®¾ç½®çš„å‚æ•°ä¹ˆ ç½‘ç»œçš„é—®é¢˜é‡è¯•å°±å¥½äº†å•Šï¼Ÿ while(true)  catch çš„æ—¶å€™ä¼‘æ¯å¤šä¹…ï¼Œåšé‡è¯•ï¼Œå°±å¥½äº†
745,canal serviceå› åˆ é™¤logä¸‹é¢çš„tempæ—¥å¿—è€ŒæœåŠ¡æ²¡æœ‰é‡å¯å¯¼è‡´ç£ç›˜ç©ºé—´è¢«å ç”¨ å¦‚é¢˜ï¼Œcanal æœåŠ¡ç«¯å‘ç°ç£ç›˜è¢«å ç”¨ï¼Œä½†æ˜¯æ²¡æ‰¾åˆ°å…·ä½“å ç”¨çš„é—®é¢˜ï¼Œé€šè¿‡lsof |grep deleteå‘ç°å¤§é‡å¦‚ä¸‹ä¿¡æ¯ï¼š java      37924 37925       appops    2w      REG              254 1 50965216675     136005 /home/appops/canal/logs/canal/canal.log6671827459413464.tmp (deleted) æŸ¥äº†ä¸‹ï¼Œæ–‡ä»¶è¢«åˆ é™¤ï¼Œè€Œè¿›ç¨‹è¿˜æ´»ç€ï¼Œå› è€Œé€ æˆå ç”¨ç©ºé—´çš„ç°è±¡ï¼Œéœ€è¦killæ‰è¿›ç¨‹æ‰èƒ½æ¢å¤ï¼Œä½†æ˜¯æœåŠ¡æ€»æ˜¯é€šè¿‡killæ‰æ¥æ¢å¤è‚¯å®šä¸æ–¹ä¾¿ï¼Œæœ‰ä»€ä¹ˆå¥½çš„è§£å†³æ–¹å¼å—
744,1.0.26æœåŠ¡ç«¯ä¸€ç›´é‡å¤ something goes wrong with channel æœåŠ¡ç«¯ï¼š1.0.26 2018-07-10 15:50:20.197 [destination = example   address = /110.110.10.27:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position  {"identity":{"slaveId":-1 "sourceAddress":{"address":"10.110.10.27" "port":3306}} "postion":{"gtid":"" "included":false "journalName":"mysql-bin.000007" "position":313931 "serverId":27 "timestamp":1531208924000}} 2018-07-10 15:50:20.203 [destination = example   address = /10.110.10.27:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - find start position : EntryPosition[included=false journalName=mysql-bin.000007 position=313931 serverId=27 gtid= timestamp=1531208924000] 2018-07-10 15:50:21.402 [New I/O server worker #1-1] ERROR com.alibaba.otter.canal.server.netty.NettyUtils - ErrotCode:400   Caused by :  something goes wrong with channel:[id: 0x65065848  /192.168.37.1:60600 => /192.168.37.129:11111]  exception=com.alibaba.otter.canal.store.CanalStoreException: no match ack positionLogPosition[identity=LogIdentity[sourceAddress=10.110.10.27/10.110.10.27:3306 slaveId=-1] postion=EntryPosition[included=false journalName=mysql-bin.000007 position=313931 serverId=27 gtid= timestamp=1531208924000]] 2018-07-10 15:50:31.406 [New I/O server worker #1-1] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x65065848  /192.168.37.1:60600 :> /192.168.37.129:11111]  exception=java.nio.channels.ClosedChannelException 	at org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:649) 	at org.jboss.netty.channel.socket.nio.NioWorker.writeFromUserCode(NioWorker.java:370) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:137) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76) 	at org.jboss.netty.channel.Channels.write(Channels.java:611) 	at org.jboss.netty.channel.Channels.write(Channels.java:578) 	at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:28) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:144) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.cleanup(ReplayingDecoder.java:542) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.channelDisconnected(ReplayingDecoder.java:450) 	at org.jboss.netty.channel.Channels.fireChannelDisconnected(Channels.java:360) 	at org.jboss.netty.channel.socket.nio.NioWorker.close(NioWorker.java:599) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:119) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76) 	at org.jboss.netty.channel.Channels.close(Channels.java:720) 	at org.jboss.netty.channel.AbstractChannel.close(AbstractChannel.java:208) 	at org.jboss.netty.channel.ChannelFutureListener$1.operationComplete(ChannelFutureListener.java:46) 	at org.jboss.netty.channel.DefaultChannelFuture.notifyListener(DefaultChannelFuture.java:381) 	at org.jboss.netty.channel.DefaultChannelFuture.addListener(DefaultChannelFuture.java:148) 	at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:30) 	at com.alibaba.otter.canal.server.netty.NettyUtils.error(NettyUtils.java:51) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:200) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:444) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:350) 	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:281) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:201) 	at org.jboss.netty.util.internal.IoWorkerRunnable.run(IoWorkerRunnable.java:46) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) 	at java.lang.Thread.run(Thread.java:745) 2018-07-10 15:50:32.315 [destination = example   address = /10.110.10.27:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Received error packet: errno = 4052  sqlstate = HY000 errmsg = A slave with the same server_uuid/server_id as this slave has connected to the master; the first event 'mysql-bin.000007' at 313931  the last event read from 'mysql-bin.000007' at 313931  the last byte read from 'mysql-bin.000007' at 313962. 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_102] 2018-07-10 15:50:32.317 [destination = example   address = /10.110.10.27:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address 10.110.10.27/10.110.10.27:3306 has an error  retrying. caused by  java.io.IOException: Received error packet: errno = 4052  sqlstate = HY000 errmsg = A slave with the same server_uuid/server_id as this slave has connected to the master; the first event 'mysql-bin.000007' at 313931  the last event read from 'mysql-bin.000007' at 313931  the last byte read from 'mysql-bin.000007' at 313962. 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_102] 2018-07-10 15:50:32.318 [destination = example   address = /10.110.10.27:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.io.IOException: Received error packet: errno = 4052  sqlstate = HY000 errmsg = A slave with the same server_uuid/server_id as this slave has connected to the master; the first event 'mysql-bin.000007' at 313931  the last event read from 'mysql-bin.000007' at 313931  the last byte read from 'mysql-bin.000007' at 313962. 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) 	at java.lang.Thread.run(Thread.java:745) ] 2018-07-10 15:50:41.415 [New I/O server worker #1-2] ERROR com.alibaba.otter.canal.server.netty.NettyUtils - ErrotCode:400   Caused by :  something goes wrong with channel:[id: 0x650a9f4a  /192.168.37.1:60616 => /192.168.37.129:11111]  exception=com.alibaba.otter.canal.store.CanalStoreException: no match ack positionLogPosition[identity=LogIdentity[sourceAddress=10.110.10.27/10.110.10.27:3306 slaveId=-1] postion=EntryPosition[included=false journalName=mysql-bin.000007 position=313931 serverId=27 gtid= timestamp=1531208924000]] 2018-07-10 15:50:46.048 [destination = example   address = /10.110.10.27:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position  {"identity":{"slaveId":-1 "sourceAddress":{"address":"10.110.10.27" "port":3306}} "postion":{"gtid":"" "included":false "journalName":"mysql-bin.000007" "position":313931 "serverId":27 "timestamp":1531208924000}} 2018-07-10 15:50:46.052 [destination = example   address = /10.110.10.27:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - find start position : EntryPosition[included=false journalName=mysql-bin.000007 position=313931 serverId=27 gtid= timestamp=1531208924000] 2018-07-10 15:50:51.418 [New I/O server worker #1-2] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x650a9f4a  /192.168.37.1:60616 :> /192.168.37.129:11111]  exception=java.nio.channels.ClosedChannelException 	at org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:649) 	at org.jboss.netty.channel.socket.nio.NioWorker.writeFromUserCode(NioWorker.java:370) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:137) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76) 	at org.jboss.netty.channel.Channels.write(Channels.java:611) 	at org.jboss.netty.channel.Channels.write(Channels.java:578) 	at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:28) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:144) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.cleanup(ReplayingDecoder.java:542) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.channelDisconnected(ReplayingDecoder.java:450) 	at org.jboss.netty.channel.Channels.fireChannelDisconnected(Channels.java:360) 	at org.jboss.netty.channel.socket.nio.NioWorker.close(NioWorker.java:599) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:119) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76) 	at org.jboss.netty.channel.Channels.close(Channels.java:720) 	at org.jboss.netty.channel.AbstractChannel.close(AbstractChannel.java:208) 	at org.jboss.netty.channel.ChannelFutureListener$1.operationComplete(ChannelFutureListener.java:46) 	at org.jboss.netty.channel.DefaultChannelFuture.notifyListener(DefaultChannelFuture.java:381) 	at org.jboss.netty.channel.DefaultChannelFuture.addListener(DefaultChannelFuture.java:148) 	at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:30) 	at com.alibaba.otter.canal.server.netty.NettyUtils.error(NettyUtils.java:51) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:200) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:444) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:350) 	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:281) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:201) 	at org.jboss.netty.util.internal.IoWorkerRunnable.run(IoWorkerRunnable.java:46) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) 	at java.lang.Thread.run(Thread.java:745) 2018-07-10 15:51:00.260 [destination = example   address = /10.110.10.27:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Received error packet: errno = 4052  sqlstate = HY000 errmsg = A slave with the same server_uuid/server_id as this slave has connected to the master; the first event 'mysql-bin.000007' at 313931  the last event read from 'mysql-bin.000007' at 313931  the last byte read from 'mysql-bin.000007' at 313962. 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_102] 2018-07-10 15:51:00.261 [destination = example   address = /10.110.10.27:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address 10.110.10.27/10.110.10.27:3306 has an error  retrying. caused by  java.io.IOException: Received error packet: errno = 4052  sqlstate = HY000 errmsg = A slave with the same server_uuid/server_id as this slave has connected to the master; the first event 'mysql-bin.000007' at 313931  the last event read from 'mysql-bin.000007' at 313931  the last byte read from 'mysql-bin.000007' at 313962. 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_102] 2018-07-10 15:51:00.261 [destination = example   address = /10.110.10.27:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.io.IOException: Received error packet: errno = 4052  sqlstate = HY000 errmsg = A slave with the same server_uuid/server_id as this slave has connected to the master; the first event 'mysql-bin.000007' at 313931  the last event read from 'mysql-bin.000007' at 313931  the last byte read from 'mysql-bin.000007' at 313962. 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) 	at java.lang.Thread.run(Thread.java:745) ] 2018-07-10 15:51:01.425 [New I/O server worker #1-1] ERROR com.alibaba.otter.canal.server.netty.NettyUtils - ErrotCode:400   Caused by :  something goes wrong with channel:[id: 0x3f8a301b  /192.168.37.1:60627 => /192.168.37.129:11111]  exception=com.alibaba.otter.canal.store.CanalStoreException: no match ack positionLogPosition[identity=LogIdentity[sourceAddress=10.110.10.27/10.110.10.27:3306 slaveId=-1] postion=EntryPosition[included=false journalName=mysql-bin.000007 position=313931 serverId=27 gtid= timestamp=1531208924000]] 2018-07-10 15:51:11.430 [New I/O server worker #1-1] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x3f8a301b  /192.168.37.1:60627 :> /192.168.37.129:11111]  exception=java.nio.channels.ClosedChannelException 	at org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:649) 	at org.jboss.netty.channel.socket.nio.NioWorker.writeFromUserCode(NioWorker.java:370) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:137) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76) 	at org.jboss.netty.channel.Channels.write(Channels.java:611) 	at org.jboss.netty.channel.Channels.write(Channels.java:578) 	at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:28) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:144) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.cleanup(ReplayingDecoder.java:542) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.channelDisconnected(ReplayingDecoder.java:450) 	at org.jboss.netty.channel.Channels.fireChannelDisconnected(Channels.java:360) 	at org.jboss.netty.channel.socket.nio.NioWorker.close(NioWorker.java:599) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:119) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76) 	at org.jboss.netty.channel.Channels.close(Channels.java:720) 	at org.jboss.netty.channel.AbstractChannel.close(AbstractChannel.java:208) 	at org.jboss.netty.channel.ChannelFutureListener$1.operationComplete(ChannelFutureListener.java:46) 	at org.jboss.netty.channel.DefaultChannelFuture.notifyListener(DefaultChannelFuture.java:381) 	at org.jboss.netty.channel.DefaultChannelFuture.addListener(DefaultChannelFuture.java:148) 	at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:30) 	at com.alibaba.otter.canal.server.netty.NettyUtils.error(NettyUtils.java:51) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:200) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:444) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:350) 	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:281) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:201) 	at org.jboss.netty.util.internal.IoWorkerRunnable.run(IoWorkerRunnable.java:46) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) 	at java.lang.Thread.run(Thread.java:745) å®¢æˆ·ç«¯ï¼šå®˜æ–¹exampledemo ----------------  END ----> transaction id: 17715 ================> binlog[mysql-bin.000007Â‰32Ã:313931]   executeTime : 1531208924000(2018-07-10 15:48:44)   gtid : ()   delay : 317551ms ----------------  END ----> transaction id: 17715 ================> binlog[mysql-bin.000007:313931]   executeTime : 1531208924000(2018-07-10 15:48:44)   gtid : ()   delay : 317552ms process error!com.alibaba.otter.canal.protocol.exception.CanalClientException: something goes wrong with reason: something goes wrong with channel:[id: 0x092dc999  /192.168.37.1:60768 => /192.168.37.129:11111]  exception=com.alibaba.otter.canal.store.CanalStoreException: no match ack positionLogPosition[identity=LogIdentity[sourceAddress=10.110.10.27/10.110.10.27:3306 slaveId=-1] postion=EntryPosition[included=false journalName=mysql-bin.000007 position=313931 serverId=27 gtid= timestamp=1531208924000]] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.receiveMessages(SimpleCanalConnector.java:338) ~[classes/:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:315) ~[classes/:na] 	at com.alibaba.otter.canal.example.AbstractCanalClientTest.process(AbstractCanalClientTest.java:123) ~[classes/:na] 	at com.alibaba.otter.canal.example.AbstractCanalClientTest$2.run(AbstractCanalClientTest.java:87) [classes/:na] 	at java.lang.Thread.run(Thread.java:722) [na:1.7.0_17] æ•°æ®åº“10.2.12-MariaDB ä»€ä¹ˆé—®é¢˜ï¼Œæ±‚å¤§ç¥è§£å†³  Received error packet: errno = 4052  sqlstate = HY000 errmsg = A slave with the same server_uuid/server_id as this slave has connected to the master; the first event 'mysql-bin.000007' at 313931  the last event read from 'mysql-bin.000007' at 313931  the last byte read from 'mysql-bin.000007' at 313962.
743,å…³äºå¯¹MySQL8 çš„æ”¯æŒ. å’¨è¯¢å’±ä»¬è¿™ä¸ªé¡¹ç›®æœ‰å¯¹MySQL8 æä¾›æ”¯æ’‘çš„è®¡åˆ’å—?  ä¼šæ”¯æŒçš„  ä½ ä»¬å·²ç»å¼€å§‹ç”¨ä¸Šmysql8äº†? @agapple å—¯ å·²ç»å¼€å§‹æ›´æ¢8äº†
742,mysqlå’Œcanaléƒ¨ç½²åœ¨è…¾è®¯äº‘ä¸Šé‡è§çš„é—®é¢˜ï¼› ç°åœ¨ åœ¨è…¾è®¯äº‘ä¸Šéƒ¨ç½²äº†mysqlï¼ŒcanalæœåŠ¡ä¹Ÿæ˜¯åœ¨è…¾è®¯äº‘ä¸Šçš„ã€‚å¯åŠ¨canal serveråçš„æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ã€‚ ä¹Ÿè®©è¿ç»´å®¶äº†æƒé™å’Œcanalçš„è´¦å·ã€‚ 2018-07-10 11:03:29.165 [Druid-ConnectionPool-Create-525230202] ERROR com.alibaba.druid.pool.DruidDataSource - create connection SQLException  url: jdbc:h2:../conf/yunjiradartrace899/h2;CACHE_SIZE=1000;MODE=MYSQL;  errorCode 28000  state 28000 org.h2.jdbc.JdbcSQLException: Wrong user name or password [28000-196] 	at org.h2.message.DbException.getJdbcSQLException(DbException.java:345) ~[h2-1.4.196.jar:1.4.196] 	at org.h2.message.DbException.get(DbException.java:179) ~[h2-1.4.196.jar:1.4.196] 	at org.h2.message.DbException.get(DbException.java:155) ~[h2-1.4.196.jar:1.4.196] 	at org.h2.message.DbException.get(DbException.java:144) ~[h2-1.4.196.jar:1.4.196] 	at org.h2.engine.Engine.validateUserAndPassword(Engine.java:336) ~[h2-1.4.196.jar:1.4.196] 	at org.h2.engine.Engine.createSessionAndValidate(Engine.java:162) ~[h2-1.4.196.jar:1.4.196] 	at org.h2.engine.Engine.createSession(Engine.java:137) ~[h2-1.4.196.jar:1.4.196] 	at org.h2.engine.Engine.createSession(Engine.java:27) ~[h2-1.4.196.jar:1.4.196] 	at org.h2.engine.SessionRemote.connectEmbeddedOrServer(SessionRemote.java:354) ~[h2-1.4.196.jar:1.4.196] 	at org.h2.jdbc.JdbcConnection.<init>(JdbcConnection.java:116) ~[h2-1.4.196.jar:1.4.196] 	at org.h2.jdbc.JdbcConnection.<init>(JdbcConnection.java:100) ~[h2-1.4.196.jar:1.4.196] 	at org.h2.Driver.connect(Driver.java:69) ~[h2-1.4.196.jar:1.4.196] 	at com.alibaba.druid.pool.DruidAbstractDataSource.createPhysicalConnection(DruidAbstractDataSource.java:1513) ~[druid-1.1.9.jar:1.1.9] 	at com.alibaba.druid.pool.DruidAbstractDataSource.createPhysicalConnection(DruidAbstractDataSource.java:1578) ~[druid-1.1.9.jar:1.1.9] 	at com.alibaba.druid.pool.DruidDataSource$CreateConnectionThread.run(DruidDataSource.java:2466) ~[druid-1.1.9.jar:1.1.9] ç¡®å®š è´¦å·å¯†ç æ˜¯æ²¡æœ‰é”™çš„ã€‚ å…ˆå…³é—­ä¸€ä¸‹tablemeta tsdbçš„èƒ½åŠ›  è¿™ä¸ªæŠ¥é”™ä¸»è¦æ˜¯æœ¬åœ°ä½¿ç”¨H2çš„é”™è¯¯  å¦‚æœæœ‰å¯¹H2æ¯”è¾ƒäº†è§£çš„å¯ä»¥å°è¯•å®šä½æˆ–è€…ä¿®å¤ä¸€ä¸‹ h2ä½œä¸ºtable ddlçš„å†å²ç‰ˆæœ¬å­˜å‚¨æ—¶ï¼Œä¼šåŸºäºH2çš„é»˜è®¤jdbcé…ç½® ``` canal.instance.tsdb.dir=${canal.file.data.dir:../conf}/${canal.instance.destination:} canal.instance.tsdb.url=jdbc:h2:${canal.instance.tsdb.dir}/h2;CACHE_SIZE=1000;MODE=MYSQL; canal.instance.tsdb.dbUsername=canal canal.instance.tsdb.dbPassword=canal ``` è§£è¯»ä¸€ä¸‹ï¼Œå°±æ˜¯ç¬¬ä¸€æ¬¡æ—¶ä¼šåˆ›å»ºconf/$instance$/$instance.mv.dbï¼Œå¹¶è®¾ç½®è®¿é—®å¯†ç ä¸ºcanal/canalï¼Œå¦‚æœç¬¬äºŒæ¬¡é‡æ–°æ‰“å¼€æ—¶ä¼šæ ¡éªŒxx.mv.dbæ˜¯å¦æœ‰å¤šè¿›ç¨‹åŒæ—¶ä½¿ç”¨(ä¼šå‡ºç°java.lang.IllegalStateException: The file is locked)ï¼Œä¹Ÿä¼šæ ¡éªŒæœ¬æ¬¡çš„è®¿é—®å¯†ç æ˜¯å¦å’Œç¬¬ä¸€æ¬¡åˆ›å»ºæ—¶ç›¸åŒ å¦‚æœçœŸé‡åˆ°ä¸€äº›è«åå…¶å¦™çš„é—®é¢˜ï¼Œä¸‡èƒ½çš„è§£å†³åŠæ³•ï¼šåˆ é™¤conf/å¯¹åº”çš„xx.mv.dbï¼Œä¼šé‡æ–°åˆå§‹åŒ–ä¸€ä¸ªh2æœ¬åœ°æ–‡ä»¶
741,canalçš„ååé‡é”å‡ 2018-07-09 08:10:22.493 - clientId:1001 cursor:[mysql-bin.000274 21149132 1530956958000] address[/10.132.27.103:3306] 2018-07-09 10:11:27.493 - clientId:1001 cursor:[mysql-bin.000274 25141059 1530957528000] address[/10.132.27.103:3306] å‘ç°canalæ—¥å¿—æŠ¥é”™ï¼š 2018-07-09 13:39:29.043 [destination = cube   address = /10.132.27.103:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Unexpected End Stream 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156) ~[canal.parse-1.0.21.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:78) ~[canal.parse-1.0.21.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) [canal.parse-1.0.21.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) [canal.parse-1.0.21.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.7.0_55] 2018-07-09 13:39:29.044 [destination = cube   address = /10.132.27.103:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /10.132.27.103:3306 has an error  retrying. caused by  java.io.IOException: Unexpected End Stream 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156) ~[canal.parse-1.0.21.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:78) ~[canal.parse-1.0.21.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) ~[canal.parse-1.0.21.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) ~[canal.parse-1.0.21.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.7.0_55] 2018-07-09 13:39:29.047 [destination = cube   address = /10.132.27.103:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:cube[java.io.IOException: Unexpected End Stream 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:78) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) 	at java.lang.Thread.run(Thread.java:745) ä»Šå¤©ï¼ˆ9å·ï¼‰å‘ç°canalçš„åŒæ­¥è¶…çº§æ…¢ï¼ŒåŸæ¥æ¯å°æ—¶è¦æ›´æ–°å‡ åæ¬¡ã€‚ä»Šå¤©ä¸ªåŒæ­¥è¦èŠ±1-2ä¸ªå°æ—¶ã€‚ canalç”Ÿäº§è€…ç¯å¢ƒæ­£å¸¸ï¼Œæ¶ˆè´¹è€…ä¹Ÿæ­£å¸¸ã€‚æœ‰é«˜æ‰‹æŒ‡ç‚¹ä¸€ä¸‹æŸ¥é—®é¢˜çš„æ€è·¯å—ï¼Ÿ å¯ä»¥æµ‹è¯•ä¸€ä¸‹1.0.26-SNAPSHOT  é’ˆå¯¹å¤§æ‰¹é‡æ•°æ®DMLåŒæ­¥çš„ å»ºè®®è°ƒå¤§ä¸€ä¸‹jvmå†…å­˜.  ä»æˆ‘çš„æµ‹è¯•æ¥çœ‹åªè¦å†…å­˜èµ„æºå¤Ÿå¤§  è§£æé€Ÿåº¦è¿˜æ˜¯éå¸¸ç¨³å®šçš„ å‚è€ƒFAQé‡Œçš„æ€§èƒ½ï¼šhttps://github.com/alibaba/canal/wiki/FAQ
740,wikiä¸­çš„ä¸€äº›ç–‘é—® AdminGuide  https://github.com/alibaba/canal/wiki/AdminGuide ä¸­å¯¹ springç»„è£…æ–¹å¼åŒºåˆ«çš„ä»‹ç»ä¸­æ˜¯ä¸æ˜¯æœ‰ä¸€ç‚¹æ¨¡ç³Šå•Š ![image](https://user-images.githubusercontent.com/13183268/42429351-1335062e-836b-11e8-9d1e-d0566544cbf8.png) storeä¸æ˜¯åªæœ‰å†…å­˜æ¨¡å¼ä¹ˆï¼Œè¿™é‡Œçš„storeçš„å­˜å‚¨åº”è¯¥æ˜¯åªæœ‰memory è€Œä¸ä¼šå­˜å‚¨åˆ°zookeeperå’Œfileå½“ä¸­å§ã€‚ ä½ çš„ç†è§£æ˜¯æ­£ç¡®çš„  storeè¿™å—åªæœ‰memoryçš„èƒ½åŠ›
739,canal.client-1.0.26-SNAPSHOTåœ¨å“ªä¸ªmavenä¸­æ‹‰å‘¢ï¼Ÿ ```xml                <dependency> 			<groupId>com.alibaba.otter</groupId> 			<artifactId>canal.client</artifactId> 			<version>1.0.26-SNAPSHOT</version> 		</dependency> ``` 1.0.26çš„å®¢æˆ·ç«¯ç‰ˆæœ¬åœ¨å“ªä¸ªmavenåº“å‘¢ï¼Œæ‹‰å–ä¸åˆ°å•Šï¼Ÿ mvn clean install æˆ‘çš„å®¢æˆ·ç«¯ç¨‹åºè¦ç”¨1.0.26-SNAPSHOTï¼Œéš¾é“æŠŠé¡¹ç›®æ‰“åŒ…åå†æ‹‰å–1.0.26-SNAPSHOTçš„jaråŒ…å•ç‹¬åŠ å…¥è‡ªå·±çš„é¡¹ç›®å—ï¼Œä¸èƒ½ä»mavenåº“ä¸­ç›´æ¥æ‹‰å–å—ï¼Œ1.0.25-SNAPSHOTåœ¨å…¬ç½‘mavenä¸­éƒ½æœ‰çš„
738,é˜¿é‡Œäº‘RDSå¦‚ä½•ä½¿ç”¨GTID é˜¿é‡Œäº‘ä¸Šä½¿ç”¨çš„RDSç‰ˆæœ¬æ˜¯5.6ï¼Œä¹‹å‰ç”¨binlog+positionçš„æ–¹å¼å¯ä»¥æ­£å¸¸åŒæ­¥æ•°æ®ï¼Œå°è¯•è®¾ç½® ``canal.instance.gtidon=true``åæŠ¥é”™ï¼š ``` java.io.IOException: Received error packet: errno = 1236   sqlstate = HY000 errmsg = The slave is connecting using CHANGE MASTER TO MASTER_AUTO_POSITION = 1   but the master has purged binary logs containing GTIDs that the slave requires. ``` è¯·é—®æ˜¯ä¸æ˜¯éœ€è¦ä¿®æ”¹RDSçš„é…ç½®ï¼Ÿ æˆ‘çš„canalçš„ç‰ˆæœ¬æ˜¯1.0.26 è¿™ä¸ªéœ€è¦mysqlè®¾ç½®gtidçš„èƒ½åŠ›  ä½ æœç´¢ä¸€ä¸‹errmsgå°±å¯ä»¥äº†  æˆ–è€…çœ‹æˆ‘gtidçš„issue æˆ‘ä¹Ÿé‡åˆ°ç±»ä¼¼çš„é—®é¢˜ã€‚æ£€æŸ¥è¿‡gtidå·²ç»å¯ç”¨äº†ã€‚æœ‰æœç´¢åˆ°æ˜¯å› ä¸ºä¸»åº“ä¸ŠGIT_PURGEDæœ‰å€¼å¯¼è‡´ä»åº“æ— æ³•åŒæ­¥ã€‚å…¶ä»–å¸–å­é‡Œé¢ä¹Ÿæ²¡æœ‰çŸ¥é“åŸå› ã€‚ @agapple 
737,Parallelå‚æ•°ç»†èŠ‚çš„å®Œå–„ ä¸€äº›å°ç»†èŠ‚ï¼š 60%processor anywayéƒ½ä¼šè¢« :16 è¦†ç›–æ‰ã€‚ å…¶æ¬¡ï¼Œ60%processor * 16 å¾ˆå¯èƒ½ä¸æ»¡è¶³ringbufferé™åˆ¶ã€‚ çœ‹çš„éå¸¸ä»”ç»†ï¼Œå¤šè°¢
736,com.alibaba.fastsql.sql.parser.ParserException åœºæ™¯ï¼šTSDBå¼€å¯ fastsqlç‰ˆæœ¬ï¼š371 å‡çº§åˆ°371ç‰ˆæœ¬çš„fastsqlåï¼Œç›®å‰é‡è§ä¸¤ç§ç±»å‹exception. ä¸€ï¼š Student-service 2018-07-05 17:10:13.017  WARN ???? [6   EventParser] c.a.o.c.p.i.m.t.MemoryTableMeta          : [] parse faield : ALTER TABLE `platform`.`notice`  CHANGE COLUMN `content` `content` VARCHAR(3000) CHARACTER SET 'utf8mb4' COLLATE 'utf8mb4_unicode_ci' NOT NULL DEFAULT 'æœªå¡«å†™' COMMENT 'é»˜è®¤' com.alibaba.fastsql.sql.parser.ParserException 	at com.alibaba.fastsql.sql.parser.SQLExprParser.parseCharTypeRest(SQLExprParser.java:2910) ~[Student-service.jar!/:?] 	at com.alibaba.fastsql.sql.parser.SQLExprParser.parseDataType(SQLExprParser.java:2785) ~[Student-service.jar!/:?] 	at com.alibaba.fastsql.sql.parser.SQLExprParser.parseDataType(SQLExprParser.java:2666) ~[Student-service.jar!/:?] 	at com.alibaba.fastsql.sql.dialect.mysql.parser.MySqlExprParser.parseColumn(MySqlExprParser.java:463) ~[Student-service.jar!/:?] 	at com.alibaba.fastsql.sql.dialect.mysql.parser.MySqlStatementParser.parseAlterTable(MySqlStatementParser.java:4315) ~[Student-service.jar!/:?] 	at com.alibaba.fastsql.sql.dialect.mysql.parser.MySqlStatementParser.parseAlter(MySqlStatementParser.java:3307) ~[Student-service.jar!/:?] 	at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:248) ~[Student-service.jar!/:?] 	at com.alibaba.fastsql.sql.SQLUtils.parseStatements(SQLUtils.java:500) ~[Student-service.jar!/:?] 	at com.alibaba.fastsql.sql.repository.SchemaRepository.console(SchemaRepository.java:412) ~[Student-service.jar!/:?] 	 äºŒï¼š Student-service 2018-07-05 17:32:42.210  WARN ???? [6   EventParser] c.a.o.c.p.i.m.t.MemoryTableMeta          : [] parse faield : ALTER TABLE `student` DROP COLUMN `display_name` DROP COLUMN `system` MODIFY COLUMN `id`  bigint(20) UNSIGNED NOT NULL AUTO_INCREMENT FIRST  CHANGE COLUMN `name` `student_name`  varchar(255) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT 'å­¦ç”Ÿå' AFTER `id` MODIFY COLUMN `description`  varchar(255) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT 'å­¦æ ¡æè¿°' AFTER `student_name` MODIFY COLUMN `created_at`  timestamp NOT NULL AFTER `description` MODIFY COLUMN `updated_at`  timestamp NOT NULL AFTER `created_at` CHANGE COLUMN `creator` `created_by`  varchar(50) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL AFTER `updated_at` CHANGE COLUMN `updated_name` `updated_by`  varchar(50) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL AFTER `created_by` ADD COLUMN `is_deleted`  tinyint(1) NOT NULL DEFAULT 0 COMMENT 'åˆ é™¤æ ‡è®°ï¼Œ0ï¼Œæœªåˆ é™¤ï¼Œ1ï¼Œåˆ é™¤' AFTER `description` com.alibaba.fastsql.sql.parser.ParserException: syntax error  error in :'MODIFY COLUMN `id`  bigint(20) UNSIGN  pos 86  line 4  column 9  token COLUMN 	at com.alibaba.fastsql.sql.parser.SQLParser.printError(SQLParser.java:361) ~[Student-service.jar!/:?] 	at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:498) ~[Student-service.jar!/:?] 	at com.alibaba.fastsql.sql.SQLUtils.parseStatements(SQLUtils.java:500) ~[Student-service.jar!/:?] 	at com.alibaba.fastsql.sql.repository.SchemaRepository.console(SchemaRepository.java:412) ~[Student-service.jar!/:?] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:72) [Student-service.jar!/:?] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.apply(DatabaseTableMeta.java:104) [Student-service.jar!/:?] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.apply(TableMetaCache.java:228) [Student-service.jar!/:?] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseQueryEvent(LogEventConvert.java:265) [Student-service.jar!/:?] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:126) [Student-service.jar!/:?] ä½ è¿™ç¬¬äºŒæ¡SQLä¹Ÿå¤Ÿå¤æ‚çš„ ç¬¬ä¸€æ¡çš„parseCharTypeRestå¯¼è‡´çš„exceptionæ¯”ç¬¬äºŒæ¡å¸¸è§~~~éº»çƒ¦å…ˆä¼˜å…ˆå¤„ç†ç¬¬ä¸€æ¡é‚£ç§caseå§ï¼Œå¤šè°¢å¤šè°¢ æµ‹è¯•å‘ç° Alter Tableä¸­æœ‰ COLLATE ä¼šå¯¼è‡´è§£æå¤±è´¥ã€‚ 2.0.0_preview_186ç‰ˆæœ¬ä¹Ÿå­˜åœ¨è¿™ä¸ªé—®é¢˜ã€‚ä¸TSDBæ— å…³ã€‚ è¿™æ˜¯fastsqlå¯¹DDLçš„è§£ææ”¯æŒçš„é—®é¢˜  æˆ‘ä¼šè®°å½•å’Œåé¦ˆ æœ€æ–°çš„fastsqlå·²ç»ä¿®å¤ è¯·é—®æœ€æ–°çš„sqlçš„ç‰ˆæœ¬æ˜¯ ï¼Ÿ
735,å¯åŠ¨å®¢æˆ·ç«¯ä¹‹åï¼Œcpuä½¿ç”¨ç‡é«˜ å¯åŠ¨å®¢æˆ·ç«¯è¿æ¥canal serverçš„æ—¶å€™ï¼Œcpuä¸­å¯¹åº”çš„javaè¿›ç¨‹ä½¿ç”¨ç‡ç¬é—´å‡é«˜åˆ°40% - 50%ä¹‹é—´ï¼Œè¿™ä¸ªä¼¼ä¹ä¸å¤ªæ­£å¸¸å§ï¼Œæˆ‘çœ‹client demoé‡Œé¢ä½¿ç”¨äº†while æ— é™å¾ªç¯ï¼Œè¿™ä¸ªå¯èƒ½æ˜¯cpué£šé«˜çš„åŸå› å§ï¼Œéš¾é“å®¢æˆ·ç«¯æ˜¯é€šè¿‡ä¸æ–­è½®è®­æœåŠ¡ç«¯è·å–æ•°æ®çš„å—ï¼Ÿ å®¢æˆ·ç«¯ä»£ç å¦‚ä¸‹ï¼š CanalConnector connector = CanalConnectors.newSingleConnector(new InetSocketAddress(canalServerIp                 canalServerPort)  serverDestination  canalUserName  canalPassword);         new Thread(                 () -> {                     while(true){                         try{                             connector.connect();                             connector.subscribe(monitorDatabase+"\\..*");                             while(true){                                 Message message = connector.getWithoutAck(batchSize); // è·å–æŒ‡å®šæ•°é‡çš„æ•°æ®                                 long batchId = message.getId();                                 int size = message.getEntries().size();                                 if (batchId != -1 && size != 0) {                                     try{                                         processData(message.getEntries());                                         connector.ack(batchId); // æäº¤ç¡®è®¤                                         //Thread.sleep(500);                                     }catch (Exception e){                                         e.printStackTrace();                                         connector.rollback();//å¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œåˆ™éœ€è¦å›æ»šä¸Šæ¬¡è¯»å–åˆ°çš„binlogä½ç½®                                     }                                 }                             }                         }catch (Exception e){                             e.printStackTrace();                             logger.error("å’Œcanal Serveräº¤äº’å‡ºç°å¼‚å¸¸");                         }finally {                             connector.disconnect();                         }                     }                 }         ).start(); ä¸‹é¢çš„æ˜¯æˆ‘æœºå™¨çš„æ€§èƒ½å‚æ•°ï¼Œè¯·ä¸»è¦å…³æ³¨å¯¹åº”çš„javaè¿›ç¨‹ Processes: 346 total  6 running  340 sleeping  2038 threads            15:09:09 Load Avg: 5.62  5.26  5.03  CPU usage: 58.75% user  19.6% sys  22.18% idle SharedLibs: 185M resident  57M data  27M linkedit. MemRegions: 78596 total  7644M resident  207M private  1706M shared. PhysMem: 16G used (2031M wired)  136M unused. VM: 1565G vsize  1110M framework vsize  0(0) swapins  0(0) swapouts. Networks: packets: 38214974/2633M in  38184606/2541M out. Disks: 284609/7890M read  251982/9950M written. PID   COMMAND             %CPU  TIME     #TH    #WQ  #PORT MEM    PURG   CMPRS  PGRP 3399  mdworker                  0.1   00:00.06 4      2    44    3252K+ 0B     0B     3399 3398  mdworker                  0.0   00:00.06 4      2    44    3272K  0B     0B     3398 3397  mdworker                  0.1   00:00.06 4      2    44    3260K+ 0B     0B     3397 3391  com.apple.au            0.0   00:00.01 2      2    16    972K   0B     0B     3391 3353  Google Chrom          0.0   00:00.10 15     1    113   13M    0B     0B     526 **3347  java                            25.9  01:28.67 144/2  1    326   1327M+ 0B     0B     665** 3344  top                            4.1   00:23.44 1/1    0    30    3668K+ 0B     0B     3344 **3333  java                           38.9  03:29.43 30     1    98    260M   0B     0B     665 3322  java                           48.9  04:08.49 33/1   1    104   606M   0B     0B     3312** 3295  tail                            0.0   00:00.14 1      0    10    360K   0B     0B     3295 å¦å¤–ï¼Œæˆ‘çš„ç‰ˆæœ¬æ˜¯  v1.0.24 clientå¯åŠ¨ä¹‹åï¼ŒæœåŠ¡ç«¯å°±ä¼šå¼€å§‹è§£æå·¥ä½œ
734,add create database support å¢åŠ create database è¯­å¥æ”¯æŒ [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=734) <br/>All committers have signed the CLA. tks
733,v1.0.24  canal.instance.filter.regexæ— æ•ˆ ä½¿ç”¨1.0.24ç‰ˆæœ¬ åªéœ€è¦ç›‘å¬ä¸¤å¼ è¡¨çš„binlog  åœ¨instance.propertiesæ–‡ä»¶ä¸­æœ‰è®¾å®š: canal.instance.defaultDatabaseName = mall canal.instance.filter.regex = mall.users mall.users_extra_info å®¢æˆ·ç«¯ä»£ç æ²¡æœ‰å†™connector.subscribe()è¯­å¥ ä½†æ˜¯æ¥æ”¶åˆ°çš„ä»ç„¶æ˜¯mallæ•°æ®åº“æ‰€æœ‰è¡¨çš„binlog æ±‚è§£ æ­£åˆ™åº”è¯¥åªæœ‰ç¡¬ç¼–ç æ˜¯okçš„ï¼Œå¦å¤–æ­£åˆ™ä¸æ”¯æŒå¤æ‚çš„ï½æ…é‡
732,æ”¯æŒoracleçš„ç‰ˆæœ¬ä»€ä¹ˆæ—¶å€™å¼€æºï¼Ÿ å¦‚é¢˜ oracleè¿™å—ä¸ä¼šå¼€æºäº†  å¯ä»¥å‚è€ƒä¸€ä¸‹https://github.com/alibaba/yugong(åŸºäºç‰©åŒ–è§†å›¾åšå¢é‡) å…¶ä½™çš„å¯ä»¥å‚è€ƒ: oracleçš„LogMinerå·¥å…·æˆ–è€…CDCæ¥å®ç°  æˆ–è€…
731,canalæ˜¾ç¤ºè¿æ¥æˆåŠŸï¼Œä½†æ˜¯æ•°æ®åº“æ”¹å˜çš„æ—¶å€™æ”¶ä¸åˆ°è®¢é˜…æ¶ˆæ¯ canalå¯åŠ¨å¹¶æ²¡æœ‰æŠ¥é”™ï¼Œä½†æ˜¯æ— è®ºæ€ä¹ˆæ“ä½œæ•°æ®åº“ï¼Œéƒ½æ²¡æœ‰æ•°æ®åº“æ”¹å˜çš„æ—¥å¿—æ‰“å°å‡ºæ¥ã€‚æ±‚å¤§ç¥æŒ‡æ•™ã€‚ ![image](https://user-images.githubusercontent.com/8399936/42198827-071f8a10-7ebd-11e8-95ee-d0438707b334.png) æˆ‘ä¹Ÿé‡åˆ°ç±»ä¼¼çš„é—®é¢˜ï¼Œç”¨çš„.26ç‰ˆæœ¬å®¢æˆ·ç«¯ï¼Œ.24ç‰ˆæœ¬serverï¼Œzké›†ç¾¤è¿æ¥ï¼Œå¯åŠ¨åº”ç”¨çš„æ—¶å€™å¯ä»¥æ¶ˆè´¹ï¼Œä½†æ˜¯è¿‡äº†ä¸€æ®µæ—¶é—´åï¼Œé€šè¿‡å †æ ˆå‘ç°clientç¨‹åºè¢«é˜»å¡åœ¨ä¿¡å·é‡è·å–çš„åœ°æ–¹ï¼Œæ˜¯ä¸æ˜¯å“ªé‡Œæ²¡æœ‰å¤„ç†å¥½æ­»é”äº†ï¼Œ2ä¸ªclientå®ä¾‹æ¶ˆè´¹ï¼æ±‚è§£ è§£å†³äº†å—ï¼Ÿ æ¨èç”¨v1.1.1æ–°ç‰ˆæœ¬äº†
730,canal å¢åŠ  create databaseæ”¯æŒ æ‹‰äº†1.0.26-preview3åˆ†æ”¯æµ‹è¯•ï¼Œç›®å‰canalåœ¨å¤„ç†Queryäº‹ä»¶create databaseï¼Œæ²¡æœ‰å¯¹å»ºåº“è¯­å¥è¿›è¡Œparser è°ƒç”¨é€»è¾‘ LogEventConvert#parseQueryEvent -> DruidDdlParser.parse(queryString  event.getDbName()); -> fastsql_preview366#SQLCreateDatabaseStatement ç›®å‰æ²¡æœ‰fastsqlçš„ä»£ç ï¼Œå¤§è‡´ä¿®æ”¹å¦‚ä¸‹ï¼Œéº»çƒ¦å¤§ç¥çœ‹çœ‹æ˜¯å¦åˆé€‚ ![qq 20180702202624](https://user-images.githubusercontent.com/5847660/42163743-3e061f4e-7e36-11e8-8126-24af0d1386cf.jpg) æœ€æ–°çš„trunk masterä¹Ÿæ²¡æœ‰å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œfastsqlä»€ä¹ˆæ—¶å€™å¼€æº<_- ä½ æäº¤ä¸€ä¸ªMRç»™æˆ‘å§ #734 æäº†ä¸€ä¸ªPRï¼ŒGitHubçš„MRæ˜¯æ€ä¹ˆæ“ä½œçš„
729,update è¯­å¥ä¸ºä»€ä¹ˆæ˜¯ddl ï¼Ÿ ![image](https://user-images.githubusercontent.com/5965173/42151092-603695a8-7e0e-11e8-8386-8920b4bc4d70.png) å¦‚å›¾ã€‚  mysql 5.5.24   è¯·é—®è¿™ä¸ªç‰ˆæœ¬æ”¯æŒä¼šæœ‰é—®é¢˜å—ï¼Ÿ å‘ç°ä¼šæœ‰æ›´æ–°æ•°æ®ä¸¢å¤±çš„é—®é¢˜ï¼Œè¿˜æœ‰ä¼šè§£æå¼‚å¸¸ã€‚ã€‚ã€‚ ![image](https://user-images.githubusercontent.com/5965173/42151207-cd8a93f2-7e0e-11e8-8250-6ac2445ef3a3.png) DDLè¯­æ³•è§£æé”™è¯¯ï¼Œä¸ä¼šå½±å“DMLæ•°æ® æ‰‹åŠ¨æ›´æ–°æ•°æ®åº“ï¼Œè§‚å¯Ÿå‘ç°æœ‰çš„æ•°æ®èƒ½å¤Ÿåœ¨canal client æˆåŠŸæ”¶åˆ°ï¼Œæœ‰ä¸€äº›æ²¡æœ‰ï¼Œå› æ­¤å°±å¾—å‡ºæ•°æ®æœ‰ä¸¢å¤±çš„ç»“è®ºã€‚ â€œå½“å‰çš„canalå¼€æºç‰ˆæœ¬æ”¯æŒ5.7åŠä»¥ä¸‹çš„ç‰ˆæœ¬(é˜¿é‡Œå†…éƒ¨mysql 5.7.13  5.6.10  mysql 5.5.18å’Œ5.1.40/48)â€ å› æ­¤5.5.24 å®˜æ–¹ç‰ˆæœ¬ï¼Œæ˜¯ä¸ä¿è¯æ•°æ®çš„å¯é æ€§ï¼Œå­˜åœ¨ä¸¢å¤±çš„æƒ…å†µå¯¹å—ï¼Ÿ â€œç›®å‰canalæµ‹è¯•å·²æ”¯æŒmysql 5.7.13/5.6.10åŠä»¥ä¸‹çš„ç‰ˆæœ¬ï¼Œmariadb 5.5.35å’Œ10.0.7(ç†è®ºä¸Šå¯æ”¯æŒä»¥ä¸‹ç‰ˆæœ¬)â€ ä½†æ˜¯è¿™é‡Œæè¿°æ¥çœ‹ã€‚5.5.24 åº”è¯¥æ˜¯æ”¯æŒçš„ï¼Œå› æ­¤ä¸çŸ¥é“æ˜¯ä»€ä¹ˆåŸå› ã€‚éº»çƒ¦è§£ç­”ä¸€ä¸‹ã€‚è°¢è°¢ï¼ï¼šD è¿™ä¸ªæŠ¥é”™å’Œmariadbæ²¡å…³ç³»ï¼Œå°±æ˜¯å•çº¯çš„SQLè¯­æ³•è§£æå‡ºé”™ï¼Œæ— æ³•ç²¾ç¡®è¿‡æ»¤æ•°æ®è€Œå·²ï¼Œä¸æ‰“ç´§ ç”¨çš„æ˜¯Mysql5.5.24 ï¼Œ å‡ºç°æ•°æ®æ›´æ–°ä¸¢å¤±è¿™ç§æƒ…å†µå¦‚ä½•å®šä½å‘¢ã€‚ PSï¼šäº¤æµä¸€ç›´åŠ ä¸è¿›å»ï¼Œèƒ½å¦æ‹‰ä¸€ä¸‹å‘¢ï¼Œ 469673467   è°¢è°¢ï¼ ï¼šD
728,jaråŒ…å†²çª spring-codeå’Œcanal.common å¼•ç”¨canal.client 1.0.12åï¼Œä»£ç æŠ¥å‡º org.springframework.core.MethodParameterï¼ˆCannot resolve method 'hasParameterAnnotation(java.lang.Class<>ï¼‰ spring-code 4.3.14.RELEASE æ“ä½œ <dependency>     <groupId>com.alibaba.otter</groupId>     <artifactId>canal.client</artifactId>     <version>1.0.12</version>     <exclusions> 	...... 	<exclusion> 		<artifactId>canal.common</artifactId> 		<groupId>com.alibaba.otter</groupId> 	</exclusion>     </exclusions> </dependency>åæ­£å¸¸ï¼Œ è¿è¡Œä»£ç æŠ¥é”™java.lang.NoClassDefFoundError: com/alibaba/otter/canal/common/utils/BooleanMutex è¯¥å¦‚ä½•è§£å†³ï¼Ÿ ä½ åœ¨canalç‰ˆæœ¬ä¹Ÿæœ‰ç‚¹ä½äº†ï¼Œå‡çº§ä¸€ä¸‹åˆ°1.0.26
727,canalæ”¯æŒaliyun rdsçš„binlogè®¢é˜… aliyunæ˜¯ä¸€å®¶ä¼Ÿå¤§çš„å…¬å¸ï¼Œä¹Ÿæ˜¯ç›®å‰å›½å†…äº‘å¸‚åœºå æ¯”æœ€é«˜çš„ï¼Œè€ƒè™‘å‰é¢æœ‰å¤ªå¤šçš„å°ä¼™ä¼´å’Œæˆ‘åé¦ˆè¿‡æœŸæœ›èƒ½æ›´å…¨é¢çš„æ”¯æŒRDS binlogçš„è®¢é˜…ã€‚aliyun RDSä¸»è¦æ»¡è¶³ç”¨æˆ·å¯¹äºMySQLçš„ç®€å•æ–¹ä¾¿ä½¿ç”¨ï¼Œé’ˆå¯¹ç”¨æˆ·ä¸šåŠ¡å‘å±•è¿…é€Ÿï¼Œå¯¹äºæœªæ¥å­˜å‚¨/è®¡ç®—æ‰©å±•æ€§æœ‰é¢„æœŸçš„ä¹Ÿä¼šä½¿ç”¨aliyun [DRDSï¼ˆ Distributed Relational Database Serviceï¼‰](https://www.aliyun.com/product/drds)ï¼Œä¸€ä¸ªåŸºäºMySQL shardingçš„åˆ†å¸ƒå¼æ•°æ®åº“è§£å†³æ–¹æ¡ˆï¼Œå› ä¸ºå­˜å‚¨æœ¬èº«æ˜¯MySQLä¹Ÿå¯ä»¥æ¯”è¾ƒæ–¹ä¾¿çš„åŸºäºcanalè¿›è¡Œæ•°æ®è®¢é˜…ã€‚ é¦–å…ˆæ˜ç¡®ä¸€ä¸‹é’ˆå¯¹è¿™ç±»äº‘MySQLçš„binlogè®¢é˜…ï¼Œé€šå¸¸ä¼šé¢ä¸´çš„å‡ ä¸ªé—®é¢˜ï¼š 1.  è´¦å·æƒé™é—®é¢˜ [å·²è§£å†³]  * canalçš„ç­–ç•¥æ˜¯æ¨¡æ‹Ÿäº†MySQL Slaveçš„è¡Œä¸ºï¼Œå› æ­¤éœ€è¦æœ‰SELECT  REPLICATION SLAVE  REPLICATION CLIENTçš„æƒé™  * è§£å†³æ€è·¯ï¼šç›®å‰aliyunä¸Šçš„RDSé»˜è®¤åˆ›å»ºçš„è´¦å·å·²ç»è‡ªå¸¦äº†è¿™äº›æƒé™ï¼Œé’ˆå¯¹RDS 5.6/5.7çš„é«˜æƒé™å®ä¾‹ï¼Œå¯ä»¥ç”¨rootè´¦å·é¢å¤–è¿›è¡Œä¸€ä¸‹æˆæƒï¼Œæˆæƒæ“ä½œå¯å‚è€ƒ[QuickStart] 2.  binlogè¢«åˆ é™¤çš„é—®é¢˜ [å·²è§£å†³]  * å¯¹åº”çš„[binlogæ¸…ç†ç­–ç•¥](https://help.aliyun.com/knowledge_detail/41815.html)  è¶…è¿‡18å°æ—¶ä¹‹åä¼šåˆ é™¤å¹¶å¤‡ä»½åˆ°ossä¹‹ä¸Šï¼Œå¦‚æœcanalä»»åŠ¡åœæ­¢è¶…è¿‡18å°æ—¶å°±ä¼šé‡åˆ°xxç±»ä¼¼é”™è¯¯ï¼Œ   * è§£å†³æ€è·¯ï¼šRDSé»˜è®¤æä¾›äº†ä¸€æ®µæ—¶é—´oss binlogçš„ä¸‹è½½èƒ½åŠ›ï¼Œ[å‚è€ƒæ–‡æ¡£](https://help.aliyun.com/document_detail/26291.html)ã€‚canalå¯ä»¥è¯†åˆ«ä½ç‚¹ä¸­çš„æ—¶é—´æˆ³ï¼Œå¯¹æ¯”ä¸€ä¸‹RDSä¸­show binary logsé‡Œæœ€æ—©çš„ä¸€æ¡binlogï¼Œå¦‚æœä¸æ»¡è¶³åˆ™ä¼šé€šè¿‡ossæ¥å£è¿›è¡Œä¸‹è½½åˆ°æœ¬æœºè¿›è¡Œè§£æï¼Œè¿½å¹³å†å²binlogä¹‹åå†åˆ‡æ¢åˆ°RDS binlogä¸­ç»§ç»­æ¶ˆè´¹ ã€canalä»£ç ä¼šæ”¯æŒã€‘ ![image](https://user-images.githubusercontent.com/834743/43991319-e6de1772-9d9c-11e8-9407-fe74e48da1ce.png) 3. ä¸»å¤‡åˆ‡æ¢å¯¼è‡´çš„é—®é¢˜ [å·²è§£å†³]  * ä¸€èˆ¬äº‘MySQLçš„ä¸»å¤‡æ–¹æ¡ˆéƒ½é‡‡ç”¨äº†vipæ¨¡å¼ï¼Œå±è”½äº†åç«¯ç‰©ç†èŠ‚ç‚¹ä¹‹é—´çš„ä¸»å¤‡åˆ‡æ¢ï¼Œä¹Ÿå°±æ˜¯å¯¹äºcanalæ¥è¯´åªçœ‹åˆ°äº†å•èŠ‚ç‚¹çš„MySQL ipï¼Œé’ˆå¯¹ç‰©ç†ä¸Šè¿›è¡Œä¸»å¤‡åˆ‡æ¢æ—¶æ‹¿ç€è€ä¸»åº“ä½ç‚¹å»è®¢é˜…æ—¶ä¼šé‡åˆ°xxç±»ä¼¼é”™è¯¯  * è§£å†³æ€è·¯:  é’ˆå¯¹MySQL5.6+å¯ä»¥ä½¿ç”¨canal gtidçš„è®¢é˜…æ–¹å¼(é’ˆå¯¹å‡ºç°é—®é¢˜2æ—¶ï¼Œéœ€è¦è¿›è¡Œæœ¬åœ°binlogè§£æå°±æ— æ³•å¾ˆå¥½çš„æ”¯æŒ)ï¼Œæˆ–è€…æ¯”è¾ƒæ¨èçš„å°±æ˜¯åŸºäºserverIdè‡ªåŠ¨è¯†åˆ«ä¸»å¤‡åˆ‡æ¢ï¼Œæ¯æ¬¡è¿›è¡Œbinlogè®¢é˜…æ—¶ï¼Œæ£€æŸ¥ä¸€ä¸‹ä½ç‚¹ä¸­çš„serverIdå’Œå½“å‰æ•°æ®åº“èŠ‚ç‚¹çš„serverIdæ˜¯å¦ä¸€è‡´ï¼Œå¦‚æœä¸ä¸€è‡´è¯´æ˜æœåŠ¡ç«¯äº§ç”Ÿäº†ä¸»å¤‡åˆ‡æ¢ï¼Œå¯ä»¥åŸºäºæ—¶é—´æˆ³é‡æ–°åœ¨æ–°çš„ä¸»åº“ä¸­å®šä½åˆ°å¯¹åº”çš„binlogï¼Œå†ç»§ç»­åç»­çš„æ¶ˆè´¹å³å¯ã€‚ps.  è¿™é‡Œå®šä½ä½ç‚¹æ—¶éœ€è¦è€ƒè™‘binlogè¢«åˆ é™¤çš„æƒ…å†µï¼Œå‚è€ƒé—®é¢˜2 ä»£ç æäº¤ï¼šhttps://github.com/alibaba/canal/commit/ea6391d1c3231406e241ef09217ea1c78f885373 å…·ä½“aliyun rdsä½¿ç”¨æ–‡æ¡£ï¼šhttps://github.com/alibaba/canal/wiki/aliyun-RDS-QuickStart
726,canalæ•´ä½“æ€§èƒ½ä¼˜åŒ– ä¹‹å‰æœ‰è¾ƒå¤šçš„å°ä¼™ä¼´  åé¦ˆåœ¨å¤§è§„æ¨¡æ•°æ®DMLå˜æ›´æ—¶æ¶ˆè´¹é€Ÿåº¦æœ‰ç‚¹è·Ÿä¸ä¸Š   åé¦ˆçš„é—®é¢˜åˆ—è¡¨: 1. https://github.com/alibaba/canal/issues/672 2. https://github.com/alibaba/canal/issues/547  3. https://github.com/alibaba/canal/issues/355 4. https://github.com/alibaba/canal/issues/267 è¿™é‡Œä¼šåšä¸€ä¸ªç›¸å¯¹å®Œæ•´çš„æµ‹è¯•ï¼Œè¿›è¡Œé’ˆå¯¹æ€§çš„ä¼˜åŒ–ï¼ŒåŒæ—¶ä¹Ÿéå¸¸æ¬¢è¿å¤§å®¶çš„å‚ä¸å’Œä»£ç MRï¼Œä¸€èµ·åŠªåŠ›è§£å†³å¥½æ€§èƒ½å’Œç¨³å®šæ€§çš„é—®é¢˜.  ps.  1.0.26ä¼šæ˜¯ä¸€ä¸ªé‡Œç¨‹ç¢‘å¼çš„ç‰ˆæœ¬ã€‚ ---- æœ€åçš„ä¼˜åŒ–ç»“æœï¼šhttps://github.com/alibaba/canal/wiki/Performance ![image](https://user-images.githubusercontent.com/834743/42986955-1f40b0d6-8c2a-11e8-8eb5-c5b885d8040a.png) èµèµèµ æœŸå¾…ingï¼ŒæœŸå¾…ing èµï¼  æˆ‘å…ˆæ¥æŠ›ä¸ªç –ï¼Œè¯´è¯´ä»¥å‰é‡åˆ°çš„issueå’Œä¸€äº›æ€è·¯ï¼š åœºæ™¯æ˜¯ï¼Œä½¿ç”¨load backup fileçš„æ–¹å¼çŒæ•°æ®ï¼ŒåŒæ—¶ä½¿ç”¨canalè¿›è¡ŒåŒæ­¥ã€‚ æ¯ä¸ªè¡¨ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ï¼Œç”±äºæ¯ä¸ªæ–‡ä»¶ä¸­çš„è¡Œéƒ½åŒå±äºä¸€å¼ è¡¨çš„åŒä¸€äº‹ä»¶ï¼ˆINSERTï¼‰ï¼Œmysql-binlogä¼šmergeä¸€å®šé‡çš„è¡Œï¼ˆå–å†³äºbinlog-row-event-max-sizeï¼‰åˆ°åŒä¸€eventã€‚ *å•å¥DMLå½±å“åˆ°å¤šè¡Œæ•°æ®çš„æƒ…å†µåº”è¯¥ä¹Ÿé€‚ç”¨ã€‚ å‹ç¼©çš„eventç»è¿‡è§£æä¸ºprotobufå¯¹è±¡ï¼Œå†…å­˜å ç”¨æ€¥å‰§è†¨èƒ€ï¼Œé€ æˆfgcé¢‘ç¹ï¼Œç”šè‡³oomã€‚ åœ¨MySQL 5.6çš„ç‰ˆæœ¬ï¼Œå®˜æ–¹é»˜è®¤å°†binlog-row-event-max-sizeä»1024è°ƒé«˜åˆ°äº†8192ã€‚ å½“æ—¶æˆ‘ä»¬é€šè¿‡å°†binlog-row-event-max-sizeè®¾å›1024ï¼Œé—®é¢˜è¢«ç»•è¿‡ã€‚ å¦‚æœå°†server/client çš„netty3å‡çº§ä¸º4ï¼Œç”¨PooledByteBufåº”è¯¥å¯ä»¥ç¼“è§£ä¸€å°éƒ¨åˆ†ã€‚ä½†å¤§å¤´è¿˜æ˜¯protobufè¿™ä¸ªmemory hogs. è¡¥å……ä¸€ä¸‹ï¼Œringbuffer sizeè¢«è®¾ç½®ä¸º4096ã€‚å†…å­˜æ˜¯4g.ç”±äºload backup fileä»¥åå°±æ˜¯å¹³ç¨³çš„æ­£å¸¸trafficã€‚å› æ­¤å¹¶ä¸æƒ³è°ƒæ•´å†…å­˜æˆ–è¿›ä¸€æ­¥å‡å°ringbuffer ç¬¬ä¸€æ­¥ç½‘ç»œä¼˜åŒ–(åªåšheaderè§£æï¼Œè¯†åˆ«åŒ…å¤§å°ã€ä½ç‚¹ç­‰ä¿¡æ¯ï¼Œä¸åšå…·ä½“çš„è®°å½•çº§åˆ«è§£æ) ç»“æœï¼šé»˜è®¤è®¾ç½®çš„32kçš„socket bufferï¼Œé’ˆå¯¹å¤§ååé‡ä¼ è¾“æ—¶æœ‰ç‚¹è¿‡å°ï¼Œå»æ‰äº†é»˜è®¤è®¾ç½®ï¼Œè®©socketè‡ªæˆ‘åè°ƒï¼Œé»˜è®¤åœ¨24c96gçš„ç‰©ç†æœºä¸Šæµ‹è¯•ï¼ŒreceiveBufferåè°ƒç»“æœä¸º180k.  è°ƒæ•´å‰åçš„æ€§èƒ½ååé‡å¯¹æ¯”ï¼š 18MB VS  117MBï¼Œæä¾›6å€å¤šï¼Œsocket bufferä¼˜åŒ–ä¹‹ååŸºæœ¬å¯ä»¥è·‘æ»¡ç½‘å¡ ç¬¬äºŒæ­¥ä¼˜åŒ–è§£æçš„èƒ½åŠ›ï¼Œè·‘äº†ä¸‹ç®€å•çš„å¯¹è±¡è§£æ(ä¸åšprotobufçš„å¯¹è±¡æ„å»º)ï¼Œåˆšå¼€å§‹é€Ÿåº¦æ˜¯20MBï¼Œä¸»è¦ä¼˜åŒ–äº†æ—¶é—´å­—æ®µçš„è§£æä¸Šï¼Œæå‡åˆ°äº†45MB.  ç›®å‰é‡åˆ°ç“¶é¢ˆäº†ï¼Œè§‚å¯Ÿç³»ç»Ÿçš„è´Ÿè½½cpuæœ€é«˜åœ¨1.5æ ¸å·¦å³ï¼Œjvm gcä¸»è¦é›†ä¸­åœ¨youngåŒºï¼Œä¸‹ä¸€æ­¥çš„ä¼˜åŒ–æ€è·¯ï¼šå¤šçº¿ç¨‹å¹¶è¡Œè§£æï¼Œæœ€å¤§åŒ–çš„ä½¿ç”¨ç³»ç»Ÿè´Ÿè½½è¿›è¡Œä¼˜åŒ– ç¬¬ä¸‰æ­¥æ•´ä½“å¹¶å‘æ¨¡å‹è®¾è®¡ï¼ŒæŒ‰ç…§å‰é¢çš„ä¼˜åŒ–ç½‘ç»œå’Œå¯¹è±¡è§£æï¼Œç“¶é¢ˆéƒ½åœ¨å¯¹è±¡çš„æ·±åº¦è§£æä¸Šï¼Œå¦‚æœè¦æœ€å¤§åŒ–æ€§èƒ½ï¼Œå¿…é¡»å¾—å¼•å…¥å¹¶å‘è®¾è®¡ï¼Œæ•´ä½“è®¾è®¡æ€è·¯å¦‚ä¸‹ï¼š ![image](https://user-images.githubusercontent.com/834743/42207319-3e58ac2c-7edc-11e8-966e-33f46c57e4bc.png) åŸºäºringbufferçš„å¹¶å‘æ¨¡å‹ï¼Œæ•´ä¸ªè¿‡ç¨‹ä¼šåˆ†ä¸º4ä¸ªé˜¶æ®µï¼Œå¤šä¸ªé˜¶æ®µä¹‹é—´äº’ç›¸éš”ç¦»å’Œä¾èµ–ï¼ŒæŠŠæœ€è€—ç“¶é¢ˆçš„è§£æè¿™å—é‡‡ç”¨å¤šçº¿ç¨‹çš„æ¨¡å‹è¿›è¡ŒåŠ é€Ÿï¼Œé¢„è®¡æ•´ä¸ªä¼˜åŒ–å®Œæˆï¼Œæ•´ä¸ªè§£æå¯ä»¥è·‘æ»¡æ•´ä¸ªåƒå…†ç½‘å¡.   ps.  å¦‚æœå„ä½æœ‰ä¸‡å…†ç½‘å¡çš„æœºå‹ï¼Œåˆ°æ—¶å€™å¯ä»¥ä¹Ÿå¸®å¿™è·‘ä¸€ä¸‹æ•ˆæœ @lcybo é’ˆå¯¹å†…å­˜å ç”¨çš„é—®é¢˜ï¼Œä½ æœ‰ä»€ä¹ˆä¼˜åŒ–å»ºè®®ä¹ˆï¼Ÿæ¢æ‰protobufï¼Ÿ ä¸ªäººä¸€ç‚¹ä¸æˆç†Ÿçš„æƒ³æ³•ï¼š å› ä¸ºä¸è·¨è¯­è¨€ï¼Œå¯ä»¥ç”¨åŸºäºprotobufå’Œjavaçš„protostuffã€‚ ç›¸å¯¹æ¥è¯´ï¼Œä¼˜ç‚¹ï¼š - æ¯”protobufå¿«ï¼Œå ç”¨å†…å­˜æ›´å°‘ï¼Œç›¸åŒçš„data sizeã€‚ - å¯ä»¥ä½¿ç”¨POJOï¼Œä¸ç”¨protoæ–‡ä»¶ã€‚protobufçš„generated codeå¯¹äººå¤ªä¸å‹å¥½äº†ã€‚ ä¸è¶³çš„åœ°æ–¹ï¼š - ç¤¾åŒºä¸å¤ªæ´»è·ƒã€‚ - å¾…è¡¥å……å“ˆå“ˆã€‚ è´´å‡ºä¸€äº›ç»†èŠ‚ï¼š // Re-use (manage) this buffer to avoid allocating on every serialization     LinkedBuffer buffer = LinkedBuffer.allocate(512); å¯¹æ¯”protobufï¼š byte[] result = new byte[this.getSerializedSize()]; æ­¤å¤–ï¼ŒPOJOè¿˜å¯ä»¥å‚è€ƒnettyçš„Recycleræˆ–å…¶ä»–çš„å¯¹è±¡æ± ï¼Œç†è®ºä¸Šï¼Œringbufferä¸­eventå ç”¨Entryå¯¹è±¡çš„å³°å€¼å°±æ˜¯ObjectPooléœ€è¦ç¼“å­˜çš„å¯¹è±¡ä¸ªæ•°ã€‚ ProtostuffIOUtil.mergeFrom(protostuff  **fooParsed**  schema);  //fooParsedæ˜¯å¯ä»¥æä¾›çš„ï¼Œååºåˆ—åŒ–å¯ä»¥ä»ObjectPoolå—ç›Šã€‚ å½“ç„¶è¿™ä¹ˆåšä»£ç ä¼šå¤æ‚äº›ã€‚ byte[]çš„å¤ç”¨å€’æ˜¯æœ‰  åŸºäºObjectPoolçš„æ€è·¯ä»¥å‰è¿˜çœŸæ²¡è€ƒè™‘è¿‡  å¯¹è±¡é‡Œçš„å„ç§åµŒå¥—ç»“æ„ä½“ä¹Ÿä¸å¤ªä¸€æ ·  ä¸å¤ªç†è§£å¤ç”¨çš„åŸç† @lcybo  å¹¶è¡Œè§£æå¦‚ä½•ä¿è¯binlog eventçš„æœ‰åºæ€§ï¼Ÿ@agapple åŠæ³•æŒºå¤šï¼Œä¸¾ä¸ªæ —å­ï¼ŒæŠŠç»“æœä½œä¸ºå«æ˜Ÿæ•°æ®ï¼Œcountdownlatchæˆ–å…¶ä»–çš„é—­é”æˆ–parallelstreamï¼Œæœ€åè¿˜ä¸ç”¨reorder @agappleï¼Œåœ¨å¤–é¢çˆªæœºä¸å¤ªæ–¹ä¾¿ï¼Œå›å»å†ç å­—ã€‚ @lan1994 ä¸²è¡Œå’Œå¹¶è¡Œçš„ç»“åˆä½“ï¼Œä¸²è¡ŒæŠŠåŸºæœ¬çš„å¯¹è±¡è§£æåšå¥½ï¼Œå¹¶è¡Œä¸»è¦å¤„ç†ä¸€äº›è€—æ—¶æ¯”è¾ƒé•¿çš„ï¼Œæ¯”å¦‚DMLçš„å…·ä½“å­—æ®µè§£æã€protobufå¯¹è±¡æ„é€ ç­‰.    ç›®å‰åˆæ­¥çš„æµ‹è¯•ç»“æœï¼Œ24ä¸ªå¹¶å‘åŸºæœ¬å¯ä»¥æŠŠä¸€å°24coreçš„ç‰©ç†æœºcpuç»™è·‘æ»¡ï¼Œååé‡èƒ½è·‘åˆ°80MB/s  (ä»binlogæ¥æ”¶åˆ°ç”ŸæˆCanalEntryæ•´ä½“ï¼Œä¼˜åŒ–å‰å¤§æ¦‚7MB/sï¼Œæå‡ä¸€ä¸ªæ•°é‡çº§)ï¼Œç›®å‰ç“¶é¢ˆåŸºæœ¬åœ¨cpuä¸Šäº†(å­—ç¬¦ä¸²çš„åºåˆ—åŒ–å æ¯”éå¸¸é«˜)ï¼Œä¸‹åˆä¼šç»§ç»­æµ‹è¯•ä¸€ä¸‹ä»mysql -> canal server -> canal clientçš„æ•´ä½“ååé‡ å…³äºåµŒå¥—ç»“æ„ï¼š å‡è®¾RowåµŒå¥—Columnçš„list ä¸¤ä¸ªç±»éƒ½ä½¿ç”¨äº†ObjectPoolï¼Œéƒ½å®ç°äº†Recycableæ¥å£å’Œrecycleæ–¹æ³•ã€‚ å¯¹Rowè°ƒç”¨recycleæ—¶ï¼Œæ¸…æ¥šæ•°æ®fieldsï¼Œå¯¹æ¯ä¸ªColumnåµŒå¥—è°ƒç”¨recycleï¼Œå†list.clear() è¦æ³¨æ„çš„æ˜¯å†…åµŒçš„Columnç”Ÿå‘½å‘¨æœŸä¸åº”è¯¥ä¹…äºRowã€‚ å…³äºnettyçš„Recyclerï¼Œæ¯ä¸ªå¯¹è±¡newå‡ºæ¥ä¼šbind ThreadLocalçš„å›æ”¶stackï¼Œå¦‚æœåœ¨åŒä¸€çº¿ç¨‹è¿›è¡Œrecycle/getï¼Œé‚£ä¹ˆå°±å®Œå…¨ä¸ä¼šæœ‰ç«äº‰ã€‚å¦‚æœä¸¤è€…åˆ†ç¦»ï¼Œåˆ™ä¼šæ¶‰åŠåˆ°æ½œåœ¨çº¿ç¨‹é—´å…±äº«çš„WeakOrderQueueã€‚ æŒ‰ï¼š**ä¸²è¡Œæµ…è§£æ->å¹¶å‘æ·±åº¦è§£æ&protoå¯¹è±¡->ringbufferä¸²è¡Œget** çš„å¤„ç†é€»è¾‘ï¼Œåºåˆ—åŒ–çš„ç‚¹åœ¨SessionHandlerçš„getï¼Œä¼šå¼•å‘æ·±åº¦è§£æçº¿ç¨‹ä¹‹é—´çš„ç«äº‰ï¼ˆè§£æçº¿ç¨‹stackç©ºçš„æ—¶å€™å®ƒä»¬ä¼šå»WeakOrderQueueå·ä¸€äº›å¯¹è±¡å›æ¥ï¼‰ï¼Œçœ‹èµ·æ¥è‡³å°‘nettyçš„Recyclerä¸é€‚åˆè¿™é‡Œåº”ç”¨ã€‚ï¼ˆé™¤éææ—©åºåˆ—åŒ–ï¼ŒæŠŠåºåˆ—åŒ–ç»“æœæ”¾åˆ°ringbufferï¼‰ å‚è€ƒï¼š io.netty.util.Recycler<T> å¯¹è±¡å‚è€ƒï¼š io.netty.util.internal.RecyclableArrayList BTWï¼Œsessionhandleré‡Œé¢çš„åºåˆ—åŒ–ï¼š NettyUtils.write(ctx.getChannel()  packetBuilder.build().toByteArray()  null);// è¾“å‡ºæ•°æ® packetBuilder.build().toByteArray()æ¯æ¬¡éƒ½new byte[]ï¼Œåº”è¯¥æœ‰ä¼˜åŒ–çš„ç©ºé—´ã€‚ ç¬¬ä¸‰æ­¥ä¼˜åŒ–å·²ç»å®Œæˆï¼Œè§£æè¿™å—å¼•å…¥äº†ringbuferæ¨¡å‹ï¼Œåˆ†æˆäº†å¤šä¸ªé˜¶æ®µï¼šç½‘ç»œæ¥æ”¶ã€ç®€å•è§£æã€DMLæ·±åº¦è§£æã€æŠ•é€’åˆ°storeï¼ŒæŠŠä¸­é—´æœ€è€—æ—¶çš„DMLæ·±åº¦è§£ææ¢æˆäº†å¹¶å‘è§£æçš„æ¨¡å‹.   ä»binlogæ¥æ”¶åˆ°ç”ŸæˆEntryå¯¹è±¡ï¼Œæµ‹è¯•äº†ä¸€ä¸‹å¯¹æ¯”ï¼š 1.  æœªåšå¹¶è¡ŒåŒ–æ”¹é€ å‰ï¼Œå¤§æ¦‚æ˜¯5MB/s (å•çº¿ç¨‹) 2. åšäº†å¹¶è¡ŒåŒ–æ”¹é€ ï¼Œ16ä¸ªå¹¶å‘è§£æï¼Œå¤§æ¦‚æ˜¯80MB/Sï¼ŒåŸºæœ¬æ˜¯æ­£ç›¸å…³çš„çº¿æ€§æ‰©å±• (åŸºæœ¬è·‘æ»¡äº†cpuçš„ç“¶é¢ˆï¼Œå¦‚æœè¦è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œåªèƒ½ä¼˜åŒ–Entryå¯¹è±¡çš„æ„é€ åè®®äº†) ç¬¬å››æ­¥ä¼˜åŒ–å·²ç»å¼€å§‹ï¼Œä¸»è¦æ˜¯å…³æ³¨binlogè§£æåˆ°clientæ”¶åˆ°æ•°æ®çš„ååé‡ï¼Œç›®å‰é€æ­¥å‹æµ‹çš„æƒ…å†µï¼Œå¤§æ¦‚æ˜¯binlogä¸‹è½½åååœ¨8MB/sï¼ŒEntryå¯¹è±¡çš„ååå¤§æ¦‚åœ¨55MB/sï¼Œå¤§æ¦‚æ˜¯1:7çš„æ•°æ®è†¨èƒ€ç‡.  ç›®å‰profileçœ‹åˆ°çš„ç“¶é¢ˆä¸»è¦åœ¨serveråœ¨åºåˆ—åŒ–Entryå¯¹è±¡æ—¶ï¼Œç›¸æ¯”äºç½‘ç»œä¼ åŒ…å äº†50%ï¼Œæµ‹è¯•çš„è®°å½•å¤§æ¦‚æ˜¯100å­—èŠ‚ï¼Œæ¢ç®—åˆ°è®°å½•çš„tpsï¼Œç›®å‰å¤§æ¦‚æ˜¯åœ¨20w record/så·¦å³. (æˆ‘æµ‹è¯•æ•°æ®æ˜¯æ‰¹é‡insertå’Œupdateï¼Œbinlogé‡Œä¼šæ›´åŠ ç´§å‡‘) ---- å¦‚æœä¼˜åŒ–æ‰è¿™å—ï¼Œç†è®ºä¸ŠEntryå¯¹è±¡å¯ä»¥è·‘æ»¡ç½‘ç»œå¸¦å®½ï¼Œé¢„è®¡å¯ä»¥æ•´ä½“æå‡150% (ç›¸æ¯”äºæœªä¼˜åŒ–å‰ï¼Œå› ä¸ºæœ€åç«¯çš„ç½‘ç»œä¼ è¾“ç“¶é¢ˆæ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥åƒæ‰äº†å‰é¢çš„å‡ ä¸ªä¼˜åŒ–å¸¦æ¥çš„æå‡ï¼Œå¦‚æœè¦è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œå¾—æ”¹åŠ¨protobufåè®®è®¾è®¡) ---- åˆæ­¥ä¼˜åŒ–æ€è·¯ 1. å¤šçº¿ç¨‹æå‰æ„é€ å¥½Entryçš„åºåˆ—åŒ–ç»“æœï¼Œé¿å…åœ¨client getæ“ä½œæ—¶ä¸´æ—¶åšåºåˆ—åŒ– (å› ä¸ºå•çº¿ç¨‹ï¼Œä¼šæœ‰ç“¶é¢ˆ) 2. å¦‚æœæ”¹åŠ¨protobufåè®®ï¼Œå¯ä»¥é€šè¿‡è®¾è®¡ä¸€äº›å­—å…¸è¡¨ï¼Œå‹ç¼©éƒ¨åˆ†çš„æ•°æ®å­˜å‚¨ ![image](https://user-images.githubusercontent.com/834743/42286259-d9dede60-7fe4-11e8-9220-4ae70469bd12.png) æ‹œè¯»äº†ä»£ç ï¼Œparallelå‚æ•°æœ‰äº›ç»†èŠ‚ï¼š[Pr#737](https://github.com/alibaba/canal/pull/737) èµ!!!!!ğŸ‘ éå¸¸æ¬¢è¿å¤§å®¶æäº¤PRå“ˆï¼Œæœ€è¿‘åœ¨æ€è€ƒprotobufçš„ä¸€äº›ä¼˜åŒ–ç»†èŠ‚ï¼Œç›®å‰ä¸»è¦ç“¶é¢ˆç‚¹åœ¨äºprotobufçš„åºåˆ—åŒ–å’Œå­—èŠ‚æ”¾å¤§é—®é¢˜ã€‚ æˆ‘ä¼šå°½å¯èƒ½å»ä¿è¯å…¼å®¹æ€§ï¼Œä½†ä¹Ÿä¸æ’é™¤æç«¯æƒ…å†µä¸‹åœ¨åè®®è®¾è®¡æ”¹åŠ¨å‡ºç°ä¸å…¼å®¹çš„æƒ…å†µ so.  å¦‚æœæœ‰å¥½çš„æƒ³æ³•ï¼Œå¯ä»¥å°½å¿«åé¦ˆåˆ°æˆ‘è¿™é‡Œ.   enum Compression {     NONE = 1;     ZLIB = 2;     GZIP = 3;     LZF = 4; } protoé‡Œé¢„ç•™äº†å‹ç¼©ï¼Œå¦‚æœåœ¨**å¹¶å‘æ·±åº¦è§£æ**è¿™ä¸€æ­¥é¢å¤–è¿›è¡Œåºåˆ—åŒ–å’Œå¹¶å‘å‹ç¼©ã€‚ SessionHandleré‚£é‡Œï¼š _packetBuilder.setBody(//å‹ç¼©åæ•°æ®);_     ç„¶åï¼Œclienté‚£é‡Œä¸²è¡Œæ¥æ”¶+å¹¶è¡Œè§£å‹å’Œååºåˆ—åŒ–ã€‚ å¹¶è¡Œå‹ç¼©+ç½‘ç»œä¼ è¾“ VS æ— å‹ç¼©ç½‘ç»œä¼ è¾“ï¼Œä¸çŸ¥é“è¡¨ç°å¦‚ä½•ã€‚ 1.  å•çº¿ç¨‹å‹ç¼©å’Œç½‘ç»œä¼ è¾“ï¼Œè¿™ä¼šæ˜¯ä¸€ä¸ªå¹³è¡¡ç‚¹ 2. protobufåºåˆ—åŒ–ä¹‹åçš„æ•°æ®ï¼Œå‹ç¼©æ¯”ä¹Ÿéœ€è¦è¯„æµ‹ ç¬¬å››æ­¥ä¼˜åŒ–å·²ç»è¿›è¡Œäº†ä¸€å¤§åŠï¼Œå¤§è‡´çš„æ•ˆæœç›¸æ¯”äºå®Œå…¨æœªä¼˜åŒ–ä¹‹å‰æå‡äº†35%çš„ååé‡ï¼Œå¯ä»¥è·‘åˆ°8~9ä¸‡çš„TPS  (æœ¬æ¬¡å‹æµ‹æ•°æ®å’Œä¹‹å‰çš„æ‰¹é‡insertä¸åŒï¼Œé€‰æ‹©äº†ä¸šåŠ¡ä¸Šéšæœºçš„ä¸€ä¸ªåº“è¿›è¡Œè·‘ï¼Œ19MBçš„binlogï¼Œå¤§æ¦‚ç½‘ç»œä¼ è¾“åœ¨35MBå·¦å³) ä¼˜åŒ–ç‚¹ï¼š 1.  CanalEntryå¯¹è±¡çš„åºåˆ—åŒ–æå‰åœ¨è¿›å…¥ringbufferä¹‹å‰å°±å®Œæˆï¼Œæœ€åsessionHandleråªåšByteStringæ‹·è´ï¼Œæœ‰éƒ¨åˆ†æå‡ 2.  SimpleCanalConnectorå¢åŠ äº†lazyParseEntryå‚æ•°ï¼Œæ”¯æŒlazyè§£æCanalEntryå¯¹è±¡ï¼Œå‡å°‘æ•´ä¸ªget/ackä¸²è¡Œæ“ä½œçš„æˆæœ¬ï¼Œæœ€å¤§åŒ–æå‡ä¸²è¡Œçš„ååé‡.  ç›®å‰çš„profileåˆ†ææ¥çœ‹ï¼Œæœ€å¤§çš„ç“¶é¢ˆå°±åœ¨äºæ„é€ ç½‘ç»œä¼ è¾“æ—¶æœ‰å¤šæ¬¡æ•°ç»„æ‹·è´ã€‚ ç°åœ¨çš„ä»£ç ï¼š  ``` Packet.Builder packetBuilder = CanalPacket.Packet.newBuilder();                         packetBuilder.setType(PacketType.MESSAGES);                         Messages.Builder messageBuilder = CanalPacket.Messages.newBuilder();                         messageBuilder.setBatchId(message.getId());                         if (message.getId() != -1) {                             if (message.isRaw()) {                                 // for performance                                 if (!CollectionUtils.isEmpty(message.getRawEntries())) {                                     messageBuilder.addAllMessages(message.getRawEntries());                                 }                             } else {                                 if (!CollectionUtils.isEmpty(message.getEntries())) {                                     for (Entry entry : message.getEntries()) {                                         messageBuilder.addMessages(entry.toByteString());                                     }                                 }                             }                         }                                                 packetBuilder.setBody(messageBuilder.build().toByteString());                          NettyUtils.write(ctx.getChannel()  packetBuilder.build().toByteArray()  null);// è¾“å‡ºæ•°æ® ``` 1.  messageBuilder.build().toByteString()ï¼Œä¼šæ‹·è´ä¸€æ¬¡message.getRawEntries()çš„æ‰€æœ‰æ•°æ®åˆ°ä¸€ä¸ªbyte[]é‡Œ 2.  packetBuilder.build().toByteArray()ï¼Œä¼šæ‹·è´ä¸€æ¬¡messageçš„æ•´ä¸ªæ•°æ®åˆ°ä¸€ä¸ªpacketçš„byte[]é‡Œ 3. NettyUtils.write ç½‘ç»œå‘é€ åŸå§‹çš„10MBçš„è®°å½•ï¼Œä¼šè‡³å°‘æ˜¯åŸå…ˆçš„3å€+ï¼Œé’ˆå¯¹æ€§çš„ä¼˜åŒ–å°±æ˜¯ç›´ä»£ç ä¸€æ¬¡æ€§æ„é€ protobufçš„æ•°æ®æ ¼å¼ï¼Œè€Œä¸æ˜¯é€šè¿‡builder + toByteStringçš„æ–¹å¼ï¼Œé¢„è®¡è¿˜èƒ½å†æå‡10%å·¦å³.  å°è¯•ç”¨ä¸€æ¬¡byte[]æ•°ç»„ç»•è¿‡protobufçš„å¤šæ¬¡æ‹·è´ï¼Œä¸‹ä¸€æ­¥å¯ä»¥ä¼˜åŒ–å¦‚ä½•å¤ç”¨byte[]æ•°ç»„ï¼Œé¿å…æ¯æ¬¡è¯·æ±‚éƒ½å¼€è¾Ÿä¸€ä¸ªæ–°çš„byte[]æ•°ç»„ï¼Œä¸€æ¬¡æ€§å¼€10MBçš„å†…å­˜å—ï¼Œè¿˜æ˜¯æœ‰ä¸€äº›å¼€é”€çš„ï¼ŒåŒ…æ‹¬clientå±‚é¢ æµ‹è¯•ç»“è®ºï¼š https://github.com/alibaba/canal/wiki/Performance ![image](https://user-images.githubusercontent.com/834743/42986934-0bae041a-8c2a-11e8-8f31-f3f8e016bc8d.png) 
725,EventParser] ERROR c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta EventParser] ERROR c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - pls submit github issue    show create table ddl:CREATE TABLE `batch_job_seq` (   `ID` bigint(20) NOT NULL   `UNIQUE_KEY` char(1) NOT NULL   UNIQUE KEY `UNIQUE_KEY_UN` (`UNIQUE_KEY`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8   compare failed .   db : TableMeta [schema=test  table=batch_job_seq  fileds= 	FieldMeta [columnName=ID  columnType=bigint(20)  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=UNIQUE_KEY  columnType=char(1)  defaultValue=null  nullable=false  key=true] ]   mem : TableMeta [schema=test  table=batch_job_seq  fileds= 	FieldMeta [columnName=ID  columnType=bigint(20)  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=UNIQUE_KEY  columnType=char(1)  defaultValue=null  nullable=false  key=false] ] ä½ è¿™æ˜¯è€ç‰ˆæœ¬25çš„å§  å‡çº§åˆ°26  å·²ç»ä¿®å¤ @qingmu2017 è¯·é—®ä½ è¿™ä¸ªé—®é¢˜å‡çº§åˆ°26åè§£å†³äº†å—ï¼Ÿæˆ‘ç°åœ¨ç”¨çš„æ˜¯26-SNAPSHOTï¼Œè¿˜æ˜¯æœ‰è¿™ä¸ªé—®é¢˜
724,scheudle applySnapshotToDB faield ![image](https://user-images.githubusercontent.com/9798724/42080735-3392c10c-7bb6-11e8-8f56-23829972429c.png) 2018-06-27 22:09:34.820 [[scheduler-table-meta-snapshot]] ERROR c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - scheudle applySnapshotToDB faield com.alibaba.otter.canal.parse.exception.CanalParseException: java.net.SocketException: Broken pipe (Write failed) Caused by: java.net.SocketException: Broken pipe (Write failed) 	at java.net.SocketOutputStream.socketWrite0(Native Method) ~[na:1.8.0_144] 	at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:111) ~[na:1.8.0_144] 	at java.net.SocketOutputStream.write(SocketOutputStream.java:143) ~[na:1.8.0_144] 	at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannel.write(BioSocketChannel.java:35) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.writeBody0(PacketManager.java:42) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.writeBody(PacketManager.java:35) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.query(MysqlQueryExecutor.java:55) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:94) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.compareTableMetaDbAndMemory(DatabaseTableMeta.java:296) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.applySnapshotToDB(DatabaseTableMeta.java:251) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.access$100(DatabaseTableMeta.java:45) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta$2.run(DatabaseTableMeta.java:84) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [na:1.8.0_144] 	at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308) [na:1.8.0_144] 	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180) [na:1.8.0_144] 	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294) [na:1.8.0_144] 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_144] 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_144] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_144] è¿™æ˜¯ä¸€ä¸ªå®šæ—¶scheduleçš„ä»»åŠ¡  æ˜å¤©ä¼šå°†å†…å­˜ä¸­çš„table metaçš„æ•°æ®åšcheckpoint  åœ¨è¿›è¡Œçš„è¿‡ç¨‹ä¸­ä¼šå¯¹æ¯”å†…å­˜å€¼å’Œæ•°æ®åº“çš„è¡¨ç»“æ„  è¿™ä¸ªå¼‚å¸¸å°±æ˜¯åœ¨è·å–æ•°æ®åº“è¡¨ç»“æ„æ—¶äº§ç”Ÿäº†broke pipe  åç»­æˆ‘ä¼šå¢åŠ ä¸€æ¬¡é‡è¯•æ¥ç¡®ä¿ç½‘ç»œçš„æœ‰æ•ˆæ€§ æˆ‘å½“æ—¶è§£å†³æ–¹æ¡ˆæ˜¯æ³¨é‡Šæ‰ canal.propertiesçš„å…³äºtsdb çš„æ³¨é‡Šä¾‹å¦‚ï¼Œcanal.instance.tsdb.spring.xmlï¼Œä»¥åŠè®¾ç½®canal.instance.tsdb.enable=falseï¼Œè¿™æ ·æ˜¯ä¸æ˜¯ç†è§£å½»åº•çš„å…³æ‰äº†table metaçš„æ—¶é—´åºåˆ—ç‰ˆæœ¬è®°å½•åŠŸèƒ½ @agapple æ­¤é—®é¢˜æœ‰ä»€ä¹ˆè§£å†³æ–¹æ¡ˆå— @qingmu2017 åªè¦è®¾ç½®canal.instance.tsdb.enable=falseï¼Œå°±æ˜¯å…³é—­table metaæ—¶é—´åºåˆ—åŠŸèƒ½
723,EventParser å½“é‡åˆ°SQLè¯­å¥æ‰§è¡Œé”™è¯¯çš„ã€‚ä¸€ç›´parserã€‚ 2018-06-28 11:43:52.463 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [canal.properties] 2018-06-28 11:43:52.470 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [example/instance.properties] 2018-06-28 11:43:52.727 [main] WARN  o.s.beans.GenericTypeAwarePropertyDescriptor - Invalid JavaBean property 'connectionCharset' being accessed! Ambiguous write methods found next to actually used [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.nio.charset.Charset)]: [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.lang.String)] 2018-06-28 11:43:52.817 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [canal.properties] 2018-06-28 11:43:52.817 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [example/instance.properties] 2018-06-28 11:43:53.154 [main] ERROR com.alibaba.druid.pool.DruidDataSource - testWhileIdle is true  validationQuery not set 2018-06-28 11:43:53.598 [main] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start CannalInstance for 1-example 2018-06-28 11:43:53.743 [main] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - subscribe filter change to .*\..* 2018-06-28 11:43:53.743 [main] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - start successful.... 2018-06-28 11:43:53.779 [destination = example   address = /172.16.0.2:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position  {"identity":{"slaveId":-1 "sourceAddress":{"address":"172.16.0.2" "port":3306}} "postion":{"gtid":"" "included":false "journalName":"mysql-bin.000004" "position":15872 "serverId":1 "timestamp":1530090101000}} 2018-06-28 11:43:54.357 [destination = example   address = /172.16.0.2:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : GRANT ALL PRIVILEGES ON *.* TO 'canal'@'%' IDENTIFIED WITH 'mysql_native_password' AS '*E3619321C1A937C46A0D8BD1DAC39F93B27D4458' com.alibaba.fastsql.sql.parser.ParserException: syntax error  error in :'IDENTIFIED WITH 'mysql_native_password' A'  expect BY  actual WITH  pos 58  line 1  column 55  token WITH         at com.alibaba.fastsql.sql.parser.SQLParser.printError(SQLParser.java:361) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371]         at com.alibaba.fastsql.sql.parser.SQLParser.accept(SQLParser.java:369) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371]         at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseGrant(SQLStatementParser.java:1022) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371]         at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:266) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371]         at com.alibaba.fastsql.sql.SQLUtils.parseStatements(SQLUtils.java:500) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371]         at com.alibaba.fastsql.sql.repository.SchemaRepository.console(SchemaRepository.java:412) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:72) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.applyHistoryOnMemory(DatabaseTableMeta.java:382) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:121) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:84) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:173) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at java.lang.Thread.run(Thread.java:748) [na:1.8.0_171] 2018-06-28 11:43:54.357 [destination = example   address = /172.16.0.2:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : GRANT SELECT  REPLICATION SLAVE  REPLICATION CLIENT ON *.* TO 'canal'@'%' IDENTIFIED WITH 'mysql_native_password' AS '*E3619321C1A937C46A0D8BD1DAC39F93B27D4458' com.alibaba.fastsql.sql.parser.ParserException: syntax error  error in :'IDENTIFIED WITH 'mysql_native_password' A'  expect BY  actual WITH  pos 89  line 1  column 86  token WITH         at com.alibaba.fastsql.sql.parser.SQLParser.printError(SQLParser.java:361) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371]         at com.alibaba.fastsql.sql.parser.SQLParser.accept(SQLParser.java:369) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371]         at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseGrant(SQLStatementParser.java:1022) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371]         at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:266) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371]         at com.alibaba.fastsql.sql.SQLUtils.parseStatements(SQLUtils.java:500) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371]         at com.alibaba.fastsql.sql.repository.SchemaRepository.console(SchemaRepository.java:412) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:72) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.applyHistoryOnMemory(DatabaseTableMeta.java:382) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:121) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:84) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:173) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at java.lang.Thread.run(Thread.java:748) [na:1.8.0_171] 2018-06-28 11:43:54.384 [destination = example   address = /172.16.0.2:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - find start position : EntryPosition[included=false journalName=mysql-bin.000004 position=15872 serverId=1 gtid= timestamp=1530090101000] 2018-06-28 11:43:54.543 [destination = example   address = /172.16.0.2:3306   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - dup apply for sql : CREATE TABLE `t_comment` (   `id` bigint NOT NULL AUTO_INCREMENT   `chapter_id` bigint not NULL   `comment_member_id` bigint not NULL   `comment_nickname` varchar(32) not NULL   `comment_headicon` varchar(256) not NULL   `is_reply` int(11) DEFAULT 0 COMMENT 'å›å¤æ•°é‡'   `content` TEXT NOT NULL COMMENT 'å†…å®¹'   `agrees` int(11) NOT NULL DEFAULT 0 COMMENT 'èµåŒ'   `product_time` bigint(20) DEFAULT '0' COMMENT 'ç”Ÿäº§æ—¶é—´'   `create_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP   PRIMARY KEY (`id`) ) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT = 'è¯„è®ºè¡¨' **2018-06-28 11:43:54.577 [destination = example   address = /172.16.0.2:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Cannot replicate anonymous transaction when @@GLOBAL.GTID_MODE = ON  at file ./mysql-bin.000004  position 16561.; the first event 'mysql-bin.000004' at 15872  the last event read from './mysql-bin.000004' at 16626  the last byte read from './mysql-bin.000004' at 16626.**         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at java.lang.Thread.run(Thread.java:748) [na:1.8.0_171] 2018-06-28 11:43:54.577 [destination = example   address = /172.16.0.2:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /172.16.0.2:3306 has an error  retrying. caused by java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Cannot replicate anonymous transaction when @@GLOBAL.GTID_MODE = ON  at file ./mysql-bin.000004  position 16561.; the first event 'mysql-bin.000004' at 15872  the last event read from './mysql-bin.000004' at 16626  the last byte read from './mysql-bin.000004' at 16626.         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at java.lang.Thread.run(Thread.java:748) [na:1.8.0_171] 2018-06-28 11:43:54.580 [destination = example   address = /172.16.0.2:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Cannot replicate anonymous transaction when @@GLOBAL.GTID_MODE = ON  at file ./mysql-bin.000004  position 16561.; the first event 'mysql-bin.000004' at 15872  the last event read from './mysql-bin.000004' at 16626  the last byte read from './mysql-bin.000004' at 16626.         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227)         at java.lang.Thread.run(Thread.java:748) ] = Cannot replicate anonymous transaction when @@GLOBAL.GTID_MODE = ON  at file ./mysql-bin.000004  position 16561.; the first event 'mysql-bin.000004' at 15872  the last event read from './mysql-bin.000004' at 16626  the last byte read from './mysql-bin.000004' at 16626. mysqlçš„å¼‚å¸¸
722,canal serverå’Œmysqléƒ¨ç½²åœ¨åŒä¸€å°æœºå™¨ï¼Œè§£æbinlogå¤±è´¥ canalç‰ˆæœ¬1.0.25   mysqlç‰ˆæœ¬5.7.10   æœ€å¼€å§‹æˆ‘å°†canal serveréƒ¨ç½²åœ¨è·ŸmysqlåŒä¸€å°æœºå™¨ä¸Šï¼Œå¯åŠ¨æ­£å¸¸ï¼Œæ“ä½œæ•°æ®åº“è®°å½•ï¼Œbinlogæ—¥å¿—æœ‰æ›´æ–°ï¼Œä½†æ˜¯canalçš„å®¢æˆ·ç«¯æœªè¯»å–åˆ°ã€‚åæ¥å°†canal serveréƒ¨ç½²åœ¨å…¶ä»–æœºå™¨ä¸Šï¼Œå°±èƒ½æ­£å¸¸æ•è·åˆ°binlogçš„ä¿¡æ¯äº†ã€‚ä¸å¤ªæ¸…æ¥šä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§ç°è±¡ï¼Œæˆ–è€…æ˜¯ä¸æ˜¯æˆ‘æ¼äº†å“ªäº›é…ç½®ï¼Ÿ canal 25ç‰ˆæœ¬ä¸å»ºè®®ä½¿ç”¨äº† æ›´æ¢äº†ä¸€ä¸ªç‰ˆæœ¬1.0.24ï¼Œç¡®å®å¯ä»¥äº†
721,canal ä¸èƒ½è¯»å–bin-log OpenJDK 64-Bit Server VM warning: ignoring option PermSize=96m; support was removed in 8.0 OpenJDK 64-Bit Server VM warning: ignoring option MaxPermSize=256m; support was removed in 8.0 OpenJDK 64-Bit Server VM warning: UseCMSCompactAtFullCollection is deprecated and will likely be removed in a future release. 2018-06-27 14:20:28.945 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## set default uncaught exception handler 2018-06-27 14:20:29.015 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## load canal configurations 2018-06-27 14:20:29.020 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## start the canal server. 2018-06-27 14:20:29.096 [main] INFO  com.alibaba.otter.canal.deployer.CanalController - ## start the canal server[172.16.0.2:8765] 2018-06-27 14:20:29.794 [main] WARN  o.s.beans.GenericTypeAwarePropertyDescriptor - Invalid JavaBean property 'connectionCharset' being accessed! Ambiguous write methods found next to actually used [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.nio.charset.Charset)]: [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.lang.String)] 2018-06-27 14:20:30.194 [main] ERROR com.alibaba.druid.pool.DruidDataSource - testWhileIdle is true  validationQuery not set 2018-06-27 14:20:30.634 [destination = example   address = /172.16.0.2:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /172.16.0.2:3306 has an error  retrying. caused by com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: connect /172.16.0.2:3306 failure Caused by: java.io.IOException: connect /172.16.0.2:3306 failure         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:77) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:79) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:87) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:163) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at java.lang.Thread.run(Thread.java:748) [na:1.8.0_171] Caused by: java.io.IOException: Error When doing Client Authentication:ErrorPacket [errorNumber=1045  fieldCount=-1  message=Access denied for user 'canal'@'172.16.0.2' (using password: YES)  sqlState=28000  sqlStateMarker=#]         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.negotiate(MysqlConnector.java:199) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:74) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na]         ... 4 common frames omitted 2018-06-27 14:20:30.645 [destination = example   address = /172.16.0.2:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: connect /172.16.0.2:3306 failure Caused by: java.io.IOException: connect /172.16.0.2:3306 failure         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:77)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:79)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:87)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:163)         at java.lang.Thread.run(Thread.java:748) Caused by: java.io.IOException: Error When doing Client Authentication:ErrorPacket [errorNumber=1045  fieldCount=-1  message=Access denied for user 'canal'@'172.16.0.2' (using password: YES)  sqlState=28000  sqlStateMarker=#]         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.negotiate(MysqlConnector.java:199)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:74)         ... 4 more ] 2018-06-27 14:20:30.659 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## the canal server is running now ...... ä½ è¦mysqlåˆ›å»ºä¸€ä¸ªcanalç”¨å¯å GRANT SELECT  REPLICATION SLAVE  REPLICATION CLIENT ON *.* TO 'canal'@'%' IDENTIFIED BY 'canal';
720,canal.instance.filter.regex è¿™ä¸ªå±æ€§å€¼çš„é•¿åº¦æœ‰é™åˆ¶å— å¦‚é¢˜ï¼šå› ä¸ºéœ€æ±‚é‡ŒåŒä¸€ä¸ªmysqlï¼Œéœ€è¦å–çš„ä¸åŒæ•°æ®åº“ï¼Œè¡¨ä¹Ÿä¸åŒï¼Œæˆ‘æ‹…å¿ƒè¿™ä¸ªå€¼è¶Šæ¥è¶Šå¤§ è¯·é—®æœ‰é•¿åº¦é™åˆ¶å— æ­£åˆ™è¡¨è¾¾å¼æœ‰é•¿åº¦é™åˆ¶ï¼Œæˆ‘å°è±¡ä¸­æ˜¯4k
719,ä¸ºä»€ä¹ˆclientè¿ä¸ä¸Šä¸åŒçš„instance 2018-06-27 11:05:51 165 INFO (ZooKeeper.java:438)- Initiating client connection  connectString=10.204.52.173:2181 10.204.52.174:2181 10.204.52.175:2181 sessionTimeout=90000 watcher=com.alibaba.otter.canal.common.zookeeper.ZkClientx@2ca65ce4 2018-06-27 11:05:51 184 INFO (ClientCnxn.java:1032)- Opening socket connection to server 10.204.52.174/10.204.52.174:2181. Will not attempt to authenticate using SASL (unknown error) 2018-06-27 11:05:51 186 INFO (ClientCnxn.java:876)- Socket connection established to 10.204.52.174/10.204.52.174:2181  initiating session 2018-06-27 11:05:51 190 INFO (ClientCnxn.java:1299)- Session establishment complete on server 10.204.52.174/10.204.52.174:2181  sessionid = 0x263fdc9445e0090  negotiated timeout = 40000 2018-06-27 11:05:51 191 INFO (ZkClient.java:449)- zookeeper state changed (SyncConnected) æˆ‘ä¸¤ä¸ªclientè¿æ¥åŒä¸€ä¸ªserverçš„ä¸åŒinstanceï¼Œä¸ºä»€ä¹ˆä¼šå¡ä½ã€‚ zookeeper state changed (SyncConnected) 
718,v1.0.26 alpha 3 æ€ä¹ˆä½¿ç”¨ v1.0.26 alpha 3 æ€ä¹ˆä½¿ç”¨ å®‰è£…example ä¸­é…ç½®äº†ä¸€ä¸‹ æ•°æ®å†™å…¥åˆ°kafka ä¸­ä¸å®Œå…¨ æ¼æ•°æ®è¿˜æ˜¯ï¼Ÿ
717,ddlæ–°å¢å­—æ®µå¼‚å¸¸ï¼šcom.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Duplicate column name 'name2' å‰æï¼šé…ç½®äº†å¤šä¸ªchannelï¼Œå„ä¸ªchannelçš„æºè¡¨éƒ½æ˜¯åŒä¸€å¼ è¡¨ï¼Œç›®æ ‡è¡¨æ˜¯å¦ä¸€ä¸ªé›†ç¾¤çš„åŒä¸€ä¸ªåº“çš„ä¸åŒè¡¨ã€‚ mysql5.7.20 canal:1.0.26ï¼Œddlæ–°å¢å­—æ®µæŠ¥é”™å¦‚ä¸‹ï¼š 2018-06-26 15:02:25.895 [pipelineId = 15 taskName = LoadWorker] ERROR com.alibaba.otter.node.etl.load.LoadTask - [15] loadWork executor is error! data:EtlEventData[currNid=8 nextNid=8 desc=[MemoryPipeKey[identity=Identity[channelId=15 pipelineId=15 processId=89] time=1529996545875 dataType=DB_BATCH]] processId=89 startTime=1529996545271 endTime=<null> firstTime=1529996545000 batchId=6 number=1 size=<null> exts=<null> pipelineId=15] com.alibaba.otter.node.etl.load.exception.LoadException: java.util.concurrent.ExecutionException: com.alibaba.otter.node.etl.load.exception.LoadException: com.alibaba.otter.node.etl.load.exception.LoadException: org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Duplicate column name 'name2' Caused by: java.util.concurrent.ExecutionException: com.alibaba.otter.node.etl.load.exception.LoadException: com.alibaba.otter.node.etl.load.exception.LoadException: org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Duplicate column name 'name2'         at java.util.concurrent.FutureTask.report(FutureTask.java:122) [na:1.8.0_102]         at java.util.concurrent.FutureTask.get(FutureTask.java:192) [na:1.8.0_102]         at com.alibaba.otter.node.etl.load.loader.db.DataBatchLoader.load(DataBatchLoader.java:107) ~[node.etl-4.2.16-SNAPSHOT.jar:na]         at com.alibaba.otter.node.etl.load.loader.OtterLoaderFactory.load(OtterLoaderFactory.java:50) ~[node.etl-4.2.16-SNAPSHOT.jar:na]         at com.alibaba.otter.node.etl.load.LoadTask$1.run(LoadTask.java:85) ~[node.etl-4.2.16-SNAPSHOT.jar:na]         at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [na:1.8.0_102]         at java.util.concurrent.FutureTask.run(FutureTask.java:266) [na:1.8.0_102]         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [na:1.8.0_102]         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [na:1.8.0_102]         at java.lang.Thread.run(Thread.java:745) [na:1.8.0_102] Caused by: com.alibaba.otter.node.etl.load.exception.LoadException: com.alibaba.otter.node.etl.load.exception.LoadException: org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Duplicate column name 'name2' Caused by: com.alibaba.otter.node.etl.load.exception.LoadException: org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Duplicate column name 'name2' ä¼°è®¡é‡å¤æ‰§è¡Œäº†DDLï¼Œå¿½ç•¥æ‰å½“å‰çš„DDLå¼‚å¸¸å¯è·³è¿‡ è¿™ä¸ªè¦å¦‚ä½•å¿½ç•¥å‘¢ï¼Ÿæˆ‘æ˜¯otteré…ç½®å®ç°çš„ã€‚otteråªæœ‰â€œè·³è¿‡selectå¼‚å¸¸â€å’Œâ€œè·³è¿‡Loadå¼‚å¸¸â€ï¼Œæˆ‘ä»¬è¿™ä¸Šé¢æŠ¥é”™çš„æ˜¯loadå¼‚å¸¸ï¼Œä½†å¦‚æœè·³è¿‡loadå¼‚å¸¸ï¼Œåˆ™æ€•ä¼šæŠŠæ‰€æœ‰çš„loadå¼‚å¸¸éƒ½è·³è¿‡ï¼Œè€Œä¸æ˜¯åªé’ˆå¯¹ddlå¼‚å¸¸è·³è¿‡ã€‚é‚£è¿™ä¸ªè¦å¦‚ä½•è§£å‘¢ï¼Ÿ æœ‰ä¸€ä¸ªå¿½ç•¥DDLå¼‚å¸¸çš„é€‰é¡¹ è·³è¿‡å¼‚å¸¸ï¼Œä¼šå‡ºç°ï¼šæ²¡æœ‰åŒæ­¥è¿‡æ¥ã€‚ æ¯”å¦‚ï¼šåŒä¸€æºè¡¨ï¼ŒåŒæ­¥åˆ°åŒä¸€ä¸ªç›®æ ‡åº“çš„ä¸åŒè¡¨ï¼Œç›®æ ‡è¡¨1åŒæ­¥æˆåŠŸï¼Œç›®æ ‡è¡¨2è¢«è·³è¿‡å¼‚å¸¸ï¼Œå°±æ²¡æœ‰åŒæ­¥äº†ã€‚
716,tableMetaTSDBæ‰¾ä½ç‚¹è¿›å…¥æ— é™å¾ªç¯ä¸­ åœ¨è¿™ä¸ªç±»**MysqlEventParser** ä¸‹é¢è¿™ä¸ªæ–¹æ³•    **### /**      * æ ¹æ®ç»™å®šçš„æ—¶é—´æˆ³ï¼Œåœ¨æŒ‡å®šçš„binlogä¸­æ‰¾åˆ°æœ€æ¥è¿‘äºè¯¥æ—¶é—´æˆ³(å¿…é¡»æ˜¯å°äºæ—¶é—´æˆ³)çš„ä¸€ä¸ªäº‹åŠ¡èµ·å§‹ä½ç½®ã€‚      * é’ˆå¯¹æœ€åä¸€ä¸ªbinlogä¼šç»™å®šendPositionï¼Œé¿å…æ— å°½çš„æŸ¥è¯¢      */     private EntryPosition findAsPerTimestampInSpecificLogFile(MysqlConnection mysqlConnection                                                               final Long startTimestamp                                                               final EntryPosition endPosition                                                               final String searchBinlogFile                                                               final Boolean justForPositionTimestamp)** æˆ‘çš„é…ç½®æ–‡ä»¶é‡Œé¢æŒ‡å®šäº† canal.instance.master.journal.name=mysql-bin.000344 canal.instance.master.position=106199547 å¼€å¯tsdbåŠŸèƒ½å canalæœåŠ¡å¯åŠ¨çš„æ—¶å€™ ç¨‹åºä¼šè¿›å…¥è¿™é‡Œæ‰¾èµ·å§‹ä½ç‚¹ ç”±äºæ²¡æœ‰æ‰¾åˆ°è¿™ä¸ªä½ç‚¹ç¨‹åºä¼šä¸€è‡´æ‰¾ä¸‹å»ç”šè‡³å¤§äº106199547 äº†è¿˜åœ¨æ‰¾å¯¼è‡´ä¸€ç›´å‡ºäºåˆå§‹åŒ–é˜¶æ®µï¼Œç„¶åå°±ä¼šå‡ºç° å®¢æˆ·ç«¯æ— æ³•åˆ›å»ºcursor ã€‚https://github.com/alibaba/canal/issues/715 æ˜¯ä½ç‚¹ä¸å­˜åœ¨è¿˜æ˜¯ï¼Ÿ  æˆ‘æ˜¯é€šè¿‡è¿™ä¸ªå‘½ä»¤æ‰¾çš„   show binlog events in'mysql-bin.000344' mysql-bin.000344	106199500	Rotate	609344520	106199547	mysql-bin.000345;pos=4 è¿™æ¡æ˜¯æœ€åä¸€æ¡è®°å½• ç„¶åå»å–äº†106199547 ä½œä¸ºcanal.instance.master.position ç„¶åä¸Šé¢çš„æºç å°±è¿›å…¥æ— é™å¾ªç¯å½“ä¸­ ä½ æ˜¯æ‹¿åˆ°ä¸€ä¸ªä½ç‚¹ä¹‹åï¼Œä¸€ç›´æ²¡æœ‰æ–°çš„æ•°æ®ä¹ˆï¼Ÿ æœ‰æ•°æ®çš„ ä½†æ˜¯å·²ç»è¿›å…¥ä¸‹ä¸€ä¸ªæ–‡ä»¶çš„äº†ã€‚    106199547 æ˜¯mysql-bin.000344çš„æœ€åä¸€ä¸ªä½ç‚¹ï¼Œ ä½†æ˜¯ä¸‹é¢æ˜¯æœ‰ mysql-bin.000345æ–‡ä»¶çš„ æœ€æ–°çš„26ç‰ˆæœ¬ä¼˜åŒ–äº†ï¼Œåˆ¤æ–­é€€å‡ºæ¡ä»¶ä¸º<=
715,canal1.0.25   otterå®¢æˆ·ç«¯å¯åŠ¨å åœ¨zookeeper ä¸­ä¸åˆ›å»º cursor ä¸æ›´æ–°binlogä½ç½®ä¿¡æ¯  ç›®å‰æˆ‘ä»¬ä¹Ÿé‡åˆ°äº†è¿™ä¸ªé—®é¢˜ https://github.com/alibaba/canal/issues/541 ç¦ç”¨tsdbåŠŸèƒ½å³å¯ 1.0.25ç‰ˆæœ¬æœ‰ä¸€äº›é—®é¢˜ï¼Œæ¢1.0.26å§
714,filterä¸èµ·ä½œç”¨ æœåŠ¡ç«¯æŒ‡å®šäº†canal.instance.filter.regex  å®¢æˆ·ç«¯connector.subscribe(); ä½†æ˜¯æœåŠ¡ç«¯è§£æbinlogæ—¶  é‡åˆ°å·²ç»è¢«dropçš„è¡¨(ä¸éœ€è¦åŒæ­¥çš„è¡¨)çš„ç›¸å…³æ—¥å¿—æ—¶  è¿˜æ˜¯ä¼šæŠ¥é”™  å°±è¯´desc db_name.table_nameå¤±è´¥. å…¶å®è¿™äº›è¡¨æ˜¯ä¸ä¼šå‡ºç°åœ¨canal.instance.filter.regexé‡Œçš„  ä¸çŸ¥é“è¯¥å¦‚ä½•è§£å†³?
713,CanalParseException: parse row data failed. CanalParseException: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first åŒæ­¥è¿‡ç¨‹çªç„¶æŠ¥é”™ï¼Œã€€mysql5.7.20ï¼Œcanal:1.0.25ï¼Œç›¸å…³å®‰è£…åŒ…ï¼šmanager.deployer-4.2.15.tar.gzï¼Œnode.deployer-4.2.15.tar.gz(psï¼šè¿™ç§canalåµŒå¥—é‡Œé¢ï¼Œå¦‚æœå•ç‹¬çš„canalæœ‰åœ¨é«˜ç‰ˆæœ¬ä¿®å¤è¯¥é—®é¢˜çš„è¯ï¼Œmanageå’Œnodeæ˜¯å¦ä¹Ÿä¼šæä¾›ç›¸åº”çš„ä¿®å¤ç‰ˆæœ¬ï¼Ÿæˆ–è€…æœ‰æ²¡æœ‰æä¾›manager/node/canalç‹¬ç«‹éƒ¨ç½²(canaléåµŒå¥—)çš„å®‰è£…è¯´æ˜ï¼Ÿ~)ã€‚ æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ï¼š com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first Caused by: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first         at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4832) ~[guava-18.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:160) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:759) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:428) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:114) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:66) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:337) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:184) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:145) [canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220) [canal.parse-1.0.25.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.8.0_102] Caused by: java.io.IOException: should execute connector.connect() first         at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.<init>(MysqlQueryExecutor.java:30) ~[canal.parse.driver-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:87) [canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMetaByDB(TableMetaCache.java:80) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.access$000(TableMetaCache.java:30) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:55) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:50) ~[canal.parse-1.0.25.jar:na]         at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3527) ~[guava-18.0.jar:na]         at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2319) ~[guava-18.0.jar:na]         at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2282) ~[guava-18.0.jar:na]         at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2197) ~[guava-18.0.jar:na]         at com.google.common.cache.LocalCache.get(LocalCache.java:3937) ~[guava-18.0.jar:na]         at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3941) ~[guava-18.0.jar:na]         at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4824) ~[guava-18.0.jar:na]         at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4830) ~[guava-18.0.jar:na]         ... 10 common frames omitted çœ‹ä¸‹[Issue604](https://github.com/alibaba/canal/issues/640)ã€‚å‡çº§åˆ°26ç‰ˆæœ¬ å¥½çš„ï¼Œæˆ‘è¯•è¯•å…ˆï¼Œè°¢è°¢
712,org.h2.message.DbException: General error: "java.lang.IllegalStateException: The file is locked: nio:/usr/local/canal/conf/business/h2.mv.db ç‰ˆæœ¬1.0.25ï¼ŒcanalæœåŠ¡å¯åŠ¨çš„æ˜¯2ä¸ªinstanceï¼Œå‡ºç°ä»¥ä¸‹2ä¸ªé—®é¢˜ 1.canal serverå¯åŠ¨åä¼šäº§ç”Ÿunauthenticated user éè®¤è¯ç”¨æˆ·è¿æ¥ 2.é”æ–‡ä»¶ 2018-06-22 14:08:32 database: flush org.h2.message.DbException: General error: "java.lang.IllegalStateException: The file is locked: nio:/usr/local/canal/conf/business/h2.mv.db [1.4.196/7]" [50000-196] 	at org.h2.message.DbException.get(DbException.java:168) 	at org.h2.message.DbException.convert(DbException.java:295) 	at org.h2.mvstore.db.MVTableEngine$1.uncaughtException(MVTableEngine.java:95) 	at org.h2.mvstore.MVStore.panic(MVStore.java:378) 	at org.h2.mvstore.MVStore.<init>(MVStore.java:361) 	at org.h2.mvstore.MVStore$Builder.open(MVStore.java:2930) 	at org.h2.mvstore.db.MVTableEngine$Store.open(MVTableEngine.java:155) 	at org.h2.mvstore.db.MVTableEngine.init(MVTableEngine.java:100) 	at org.h2.engine.Database.getPageStore(Database.java:2476) 	at org.h2.engine.Database.open(Database.java:697) 	at org.h2.engine.Database.openDatabase(Database.java:276) 	at org.h2.engine.Database.<init>(Database.java:270) 	at org.h2.engine.Engine.openSession(Engine.java:64) 	at org.h2.engine.Engine.openSession(Engine.java:176) 	at org.h2.engine.Engine.createSessionAndValidate(Engine.java:154) 	at org.h2.engine.Engine.createSession(Engine.java:137) 	at org.h2.engine.Engine.createSession(Engine.java:27) 	at org.h2.engine.SessionRemote.connectEmbeddedOrServer(SessionRemote.java:354) 	at org.h2.jdbc.JdbcConnection.<init>(JdbcConnection.java:116) 	at org.h2.jdbc.JdbcConnection.<init>(JdbcConnection.java:100) 	at org.h2.Driver.connect(Driver.java:69) 	at com.alibaba.druid.pool.DruidAbstractDataSource.createPhysicalConnection(DruidAbstractDataSource.java:1510) 	at com.alibaba.druid.pool.DruidAbstractDataSource.createPhysicalConnection(DruidAbstractDataSource.java:1575) 	at com.alibaba.druid.pool.DruidDataSource$CreateConnectionThread.run(DruidDataSource.java:2450) Caused by: org.h2.jdbc.JdbcSQLException: General error: "java.lang.IllegalStateException: The file is locked: nio:/usr/local/canal/conf/business/h2.mv.db [1.4.196/7]" [50000-196] 	at org.h2.message.DbException.getJdbcSQLException(DbException.java:345) 	... 24 more Caused by: java.lang.IllegalStateException: The file is locked: nio:/usr/local/canal/conf/business/h2.mv.db [1.4.196/7] 	at org.h2.mvstore.DataUtils.newIllegalStateException(DataUtils.java:765) 	at org.h2.mvstore.FileStore.open(FileStore.java:173) 	at org.h2.mvstore.MVStore.<init>(MVStore.java:347) 	... 19 more @agapple  è¿™é”™è¯¯è¿˜æ˜¯ç¬¬ä¸€æ¬¡è§ï¼Œæ˜¯å¦ä¸Šä¸€æ¬¡çš„canalå‡ºç°å¼‚å¸¸crashï¼Ÿ è¿™æ˜¯åœ¨æ­£å¼ç¯å¢ƒä¸­ç¬¬ä¸€æ¬¡å¯åŠ¨ï¼Œå°±å‡ºç°äº†è¿™2ç§æƒ…å†µ @agapple  The file is lockedï¼Œä¼°è®¡æ˜¯é‡å¤å¯åŠ¨åŒä¸€ä¸ªinstanceçš„ï¼Œæ£€æŸ¥ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶: /usr/local/canal/conf/business/h2.mv.db  å¯¹åº”çš„æ–‡ä»¶å¥æŸ„è¢«å“ªä¸ªè¿›ç¨‹å·²ç»æ‰“å¼€äº†
711,canalè¿æ¥é˜¿é‡Œäº‘RDS ç›¸å…³rdsçš„é…ç½®æ–‡ä»¶å¥½åƒæ²¡æœ‰å•Šï¼Ÿå¦å¤–canal.instance.rds.open.url=https://rds.aliyuncs.com/ è¿™ä¸ªé…ç½®æ˜¯é’ˆå¯¹å¤–ç½‘çš„  æ˜¯å¦æœ‰å†…ç½‘åœ°å€ï¼Ÿ è¿™ä¸ªæ˜¯RDS binlogçš„openapiä¸‹è½½çš„é…ç½®ï¼Œç›®å‰è¿˜æœªå®Œå…¨æˆå‹ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨å¯ä»¥äº†è§£ä¸€ä¸‹ä»£ç  å‚è€ƒï¼šhttps://github.com/alibaba/canal/wiki/FAQ
710,java.io.IOException: connect /xxx:3306 failure:java.io.IOException: Unexpected End å¯åŠ¨canalæœåŠ¡å°±æŠ¥è¿™ä¸ªé”™ï¼Œcanalç‰ˆæœ¬1.0.22 2018-06-19 11:26:44.358 [destination = example   address = /xxx:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser -  dump address /xxx:3306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: connect /xxx:3306 failure:java.io.IOException: Unexpected End Stream 	at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.readBytesAsBuffer(PacketManager.java:22) 	at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.readHeader(PacketManager.java:13) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.negotiate(MysqlConnector.java:199) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:71) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:52) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:85) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:158) 	at java.lang.Thread.run(Thread.java:745) Caused by: java.io.IOException: connect /xxx:3306 failure:java.io.IOException: Unexpected End Stream 	at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.readBytesAsBuffer(PacketManager.java:22) 	at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.readHeader(PacketManager.java:13) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.negotiate(MysqlConnector.java:199) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:71) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:52) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:85) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:158) 	at java.lang.Thread.run(Thread.java:745) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:74) ~[canal.parse.driver-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:52) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:85) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:158) ~[canal.parse-1.0.22.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_11] 3306ç«¯å£æ˜¯é€šçš„ java.io.IOException: connect /xxx:3306 failure:java.io.IOException: Unexpected End Stream å¯ä»¥è¯•è¯•1.0.26
709,å¢åŠ canal-kafka-clientçš„runningçŠ¶æ€ç›‘æ§ å¢åŠ canal-kafka-clientçš„runningçŠ¶æ€ç›‘æ§ kafka clientè¿è¡Œé›†ç¾¤çš„è¯ä¹Ÿå’Œcanal clientç±»ä¼¼ï¼Œå…ˆå¯åŠ¨çš„å…ˆæŠ¢å ï¼Œåå¯åŠ¨çš„é˜»å¡ç­‰å¾… åŸºäº topic-groupIdæŠ¢å ï¼Œzookeeperä¸­ç›®å½•ä¸ºï¼š /otter/canal/topics/example/groupId tks @rewerma é’ˆå¯¹kafkaçš„ä½¿ç”¨ï¼Œèƒ½å†™ä¸€ä¸ªç®€å•çš„è¯´æ˜æ–‡æ¡£ç»™æˆ‘ä¹ˆï¼Ÿç¾¤é‡Œæœ‰äººå’¨è¯¢ @agapple   ä½¿ç”¨è¯´æ˜: æ‰“åŒ…ä»¥åä½¿ç”¨kafka/targetä¸‹çš„canalæ–‡ä»¶å¤¹ä½œä¸ºæœåŠ¡ç«¯ã€‚conf/canal.properties çš„é…ç½®ä¿®æ”¹ canal.withoutNetty = trueï¼Œå…¶ä»–çš„é…ç½®é¡¹å’ŒåŸå…ˆä¸€æ ·ã€‚ æ–°å¢conf/kafka.ymlé…ç½®ï¼š servers: slave1:6667 slave2:6667 slave3:6667    # kafka serveråœ°å€ retries: 0    # kafka é‡è¯•æ¬¡æ•° batchSize: 16384    # kafka æ‰¹é‡å¤§å° lingerMs: 1 bufferMemory: 33554432 canalBatchSize: 50    # canalçš„æ‰¹æ¬¡å¤§å°ï¼Œå•ä½ k;å¦‚æœæ•°æ®åº“å†™æ“ä½œé‡å¤§å»ºè®®ä¿®æ”¹ä¸º1M filterTransactionEntry: true canalDestinations:   - canalDestination: example    # canalå®ä¾‹     topic: example    # kafka topic     partition:    # åˆ†åŒº     topics:       #  ä¸€ä¸ªdestinationå¯ä»¥å¯¹åº”å¤šä¸ªtopic       - topic: example         partition: canal kafka clientçš„ä½¿ç”¨å‚è€ƒ test ä¸­çš„ com.alibaba.otter.canal.kafka.client.running.CanalKafkaClientExample 
708,æ•°æ®å¤„ç†å¤±è´¥ï¼Œå›æ»šåï¼Œä¼šæœ‰é‡å¤å¤„ç†çš„æƒ…å†µ å› ä¸ºæ˜¯æŒ‰ æ‰¹æ¬¡id   ackå’Œrollbackçš„ï¼Œå¦‚æœä¸€ä¸ªæ‰¹æ¬¡é‡Œçš„ä¸€æ¡å¤„ç†å¤±è´¥äº†ï¼Œè¿™ä¸ªæ—¶å€™å¼€å§‹å›æ»šï¼Œç„¶åé‡æ–°å¤„ç†åˆšæ‰å¤„ç†å¤±è´¥çš„æ‰¹æ¬¡æ•°æ®ï¼Œå¦‚æœé‚£ä¸ªæ‰¹æ¬¡çš„å¤„ç†å¤±è´¥çš„ä¹‹å‰çš„éƒ½æ˜¯å¤„ç†æˆåŠŸçš„ï¼Œè¿™æ¬¡å¤„ç†å²‚ä¸æ˜¯åˆé‡å¤å¤„ç†äº†ï¼Ÿ @agapple  é‡å¤æ— æ³•é¿å… é‚£åªèƒ½åœ¨è‡ªå·±çš„ä»£ç ä¸­å»é‡ æˆ‘é‡åˆ°è¿‡è¿™ä¸ªæƒ…å†µ  æˆ‘æ˜¯æ˜¯æ•è·å¼‚å¸¸åå°†å½“å‰æ‰¹æ¬¡çš„æ•°æ®æŒä¹…åŒ–åˆ°æ•°æ®åº“è®°å½•å¼‚å¸¸ä¿¡æ¯. ç„¶åæ­£å¸¸æäº¤è¯¥æ‰¹æ¬¡çš„æ•°æ®  ä¸ºäº†é¿å…é‡å¤å¤„ç†.  é™¤äº†è¿™ä¸ªæªæ–½ä¹‹å¤–è¿˜éœ€è¦é¿å…å¤„ç†äº†ä¸€åŠå°±å¼‚å¸¸å´©æºƒçš„æƒ…å†µå§ï¼Ÿ
707,canalå¯åŠ¨æ­£å¸¸ canalå®¢æˆ·ç«¯è®¢é˜…å¡ä½ é”™è¯¯æ—¥å¿—ï¼š2018-06-20 13:43:46.730 [ZkClient-EventThread-26-vm153:2181 vm154:2181 vm155:2181] ERROR org.I0Itec.zkclient.ZkEventThread - Error handling event ZkEvent[Data of /otter/canal/destinations/yuantong_order_mysql_10.1.240.87_3307_0/1001/running changed sent to com.alibaba.otter.canal.client.impl.running.ClientRunningMonitor$1@4e7d0621] com.alibaba.otter.canal.protocol.exception.CanalClientException: something goes wrong in initRunning method.  	at com.alibaba.otter.canal.client.impl.running.ClientRunningMonitor.initRunning(ClientRunningMonitor.java:142) 	at com.alibaba.otter.canal.client.impl.running.ClientRunningMonitor$1.handleDataDeleted(ClientRunningMonitor.java:71) 	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549) 	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71) Caused by: com.alibaba.otter.canal.protocol.exception.CanalClientException: java.net.ConnectException: æ‹’ç»è¿æ¥ 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.doConnect(SimpleCanalConnector.java:171) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.access$000(SimpleCanalConnector.java:48) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector$1.processActiveEnter(SimpleCanalConnector.java:396) 	at com.alibaba.otter.canal.client.impl.running.ClientRunningMonitor.processActiveEnter(ClientRunningMonitor.java:207) 	at com.alibaba.otter.canal.client.impl.running.ClientRunningMonitor.initRunning(ClientRunningMonitor.java:118) 	... 3 common frames omitted Caused by: java.net.ConnectException: æ‹’ç»è¿æ¥ 	at sun.nio.ch.Net.connect0(Native Method) 	at sun.nio.ch.Net.connect(Net.java:454) 	at sun.nio.ch.Net.connect(Net.java:446) 	at sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:648) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.doConnect(SimpleCanalConnector.java:132) 	... 7 common frames omitted æœ‰æ—¶å€™å°±ä¼šä¸€ç›´å¡åœ¨è¿™ä¸ªé”™è¯¯ä¸Šï¼Œéœ€è¦é‡å¯æ‰æ­£å¸¸ï¼Œ ä½†æœ‰æ—¶å€™è¿™ä¸ªé”™è¯¯ä¼šå‡ºç°ï¼Œä½†æœ€åèƒ½è®¢é˜…æˆåŠŸï¼Œä¸éœ€è¦é‡å¯ï¼Œcanalçš„ç‰ˆæœ¬æ˜¯24çš„ æˆ‘æœ‰æ—¶å€™ä¹Ÿä¼šå‡ºç°è¿™ä¸ªé—®é¢˜  è¯·é—®ä½ è§£å†³äº†å—? å°è¯•ä¸€ä¸‹æœ€æ–°çš„v1.1.1
706,ä¸ºä»€ä¹ˆæˆ‘å¯åŠ¨ä¸¤ä¸ªjavaç«¯çš„clientè¿æ¥canal serverè¿ä¸ä¸Š å¯åŠ¨ä¸¤ä¸ªclientè¿æ¥canalserver ç¬¬äºŒä¸ªå¯åŠ¨æ—¶ä¸€ç›´å¡åœ¨ subcribe()é‚£é‡Œï¼Œå¯åŠ¨ä¸æˆåŠŸ
705,mysql5.7.22 canal æç¤º  java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not open log file 2018-06-20 12:02:29.240 [destination = dev   address = /192.168.255.2:3306   EventParser] INFO  c.a.otter.canal.parse.inbound.mysql.MysqlConnection - COM_BINLOG_DUMP with position:BinlogDumpCommandPacket[binlogPosition=309144234 slaveServerId=1201 binlogFileName=mysql-bin.000333 command=18] 2018-06-20 12:02:29.244 [destination = dev   address = /192.168.255.2:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not open log file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) ~[canal.parse-1.0.25-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:122) [canal.parse-1.0.25-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) [canal.parse-1.0.25-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_171] 2018-06-20 12:02:29.244 [destination = dev   address = /192.168.255.2:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /192.168.255.2:3306 has an error  retrying. caused by java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not open log file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) ~[canal.parse-1.0.25-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:122) ~[canal.parse-1.0.25-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) ~[canal.parse-1.0.25-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_171] 2018-06-20 12:02:29.244 [destination = dev   address = /192.168.255.2:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:dev[java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not open log file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:122) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) 	at java.lang.Thread.run(Thread.java:748) ] 2018-06-20 12:02:29.244 [destination = dev   address = /192.168.255.2:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - disConnect MysqlConnection to /192.168.255.2:3306... Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not open log file æ£€æŸ¥ä¸€ä¸‹binlogæ–‡ä»¶å’Œä½ç‚¹çš„æœ‰æ•ˆæ€§
704,å½“è¡¨è®¾ç½®çš„ä¸»é”®å¯¹å­—æ®µé•¿åº¦è¿›è¡Œé™å®šæ—¶ï¼Œcanalä¸è¯†åˆ«è¯¥åˆ— CREATE TABLE `job_execution_script` (   `app_id` INT(11) NOT NULL   `job_id` INT(11) NOT NULL   `script_name` VARCHAR(512) NOT NULL DEFAULT ''   `committer_name` VARCHAR(128) NOT NULL DEFAULT ''   PRIMARY KEY (`app_id` `job_id` `script_name`(100) `committer_name`) ) ENGINE=INNODB DEFAULT CHARSET=utf8; å½“è¡¨ç»“æ„å¦‚ä¸Šæ—¶ï¼Œcanalä¼šæŠ¥ â€œunknow column `script_name`(100)â€ çš„ERROR~ è°¢è°¢~ å¼‚å¸¸æ ˆä¸ºï¼š 2018-06-20 10:51:32.960 [destination = ido001   address = ido001/180.137.128.151:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:ido001[java.lang.RuntimeException: unknow column : `script_name`(100) 	at com.alibaba.otter.canal.parse.inbound.TableMeta.getFieldMetaByName(TableMeta.java:73) 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.processTableElement(MemoryTableMeta.java:215) 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.parse(MemoryTableMeta.java:151) 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.find(MemoryTableMeta.java:106) 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.compareTableMetaDbAndMemory(DatabaseTableMeta.java:288) 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.applySnapshotToDB(DatabaseTableMeta.java:251) 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:129) 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) 	at java.lang.Thread.run(Thread.java:745) ] ä½ ç”¨çš„æ˜¯æœ€æ–°çš„1.0.26ç‰ˆæœ¬ä¹ˆï¼Ÿè¿™ä¸ªæˆ‘è®°å¾—å·²ç»ä¿®å¤è¿‡ æˆ‘ç”¨çš„æ˜¯1.0.25ç‰ˆæœ¬çš„ï¼Œè¿™ä¸ªé—®é¢˜è¿˜æ˜¯å­˜åœ¨~ è¯•è¯•1.0.26ç‰ˆæœ¬
703,RDSçš„binlogä¿ç•™å‘¨æœŸ RDSçš„binlogé»˜è®¤ä¿ç•™18å°æ—¶!å¦‚æœæˆ‘æƒ³å›æº¯ é‡æ–°ä»æŒ‡å®šcursoræ¶ˆè´¹ åº”è¯¥æ˜¯æ‰¾ä¸åˆ°binlogæ–‡ä»¶æˆ–ç›¸åº”ä½ç½®çš„! RDSbinlogä¿å­˜åœ¨ossä¸­ï¼Œéœ€è¦ä¸‹è½½ossè¿›è¡Œæœ¬åœ°è§£æå¤„ç† å‚è€ƒï¼šhttps://github.com/alibaba/canal/wiki/FAQ
702,æŒ‡å®šFilterä¸èµ·ä½œç”¨ï¼Œè¿˜æ˜¯èƒ½å¤Ÿè·å–åˆ°å…¨åº“çš„ç›‘å¬æ•°æ®ã€‚ `connector.subscribe("databaseName.tableName");` è¿™æ®µä»£ç æˆ‘æŒ‡å®šäº†filterï¼Œå¯è¿˜æ˜¯èƒ½å¤Ÿæ”¶åˆ°æ‰€æœ‰è¡¨çš„binlogæ•°æ®ï¼Œè¯·é—®æ˜¯ä¸æ˜¯ä¸ºå“ªé‡Œé…ç½®æœ‰é—®é¢˜ï¼Ÿ æœç´¢ä¸€ä¸‹å†å²issue filterä½¿ç”¨çš„æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œä½ è¿™ä¸ªæ­£åˆ™è¦è½¬ä¹‰ä¸€ä¸‹æ‰èƒ½ç”¨ï¼Œæ¯”å¦‚ä½ è¿™ä¸ªä¾‹å­ï¼šdatabaseName.tableNameéœ€è¦è½¬ä¹‰æˆ > databaseName\\\\.tableName æ‰èƒ½ç”¨ã€‚"."åœ¨æ­£åˆ™ä¸­ä»£è¡¨ä»»æ„å­—ç¬¦ã€‚â€œ\\.â€å«ä¹‰æ‰æ˜¯ç‚¹ï¼Œç”±äºå•ä¸ªåæ–œæ ä»£è¡¨è½¬ä¹‰ï¼Œå› æ­¤ä¹Ÿéœ€è¦è¢«è½¬ä¹‰ï¼Œæ‰€ä»¥å°±å˜æˆä¸Šé¢é‚£ä¸ªæ ·å­äº† çœ‹ä¸€ä¸‹ FAQ : https://github.com/alibaba/canal/wiki/FAQ
701,canal è¿ç»­è¿è¡Œä¸¤å¤©å·¦å³ï¼Œå°±ä¼šå‡ºç° å¼‚å¸¸ï¼Œä¸ç¨³å®š çœ‹ä¸å‡ºæ¥æ˜¯ä»€ä¹ˆå½±å“çš„ï¼Œcanal æ²¡æœ‰å‡ºé”™æ¢å¤çš„æœºåˆ¶å—ï¼Ÿ com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:145) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:87) [canal.parse-1.0.25.jar:na] Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first Caused by: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first 	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4832) ~[guava-18.0.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:759) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:160) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:428) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:114) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:66) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:337) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:184) ~[canal.parse-1.0.25.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_171] Caused by: java.io.IOException: should execute connector.connect() first 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.<init>(MysqlQueryExecutor.java:30) ~[canal.parse.driver-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMetaByDB(TableMetaCache.java:80) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.access$000(TableMetaCache.java:30) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:55) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:50) ~[canal.parse-1.0.25.jar:na] 	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3527) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2319) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2282) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2197) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3941) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache.get(LocalCache.java:3937) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4824) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4830) ~[guava-18.0.jar:na] 	... 10 common frames omitted åŒæ—¶è¿æ¥äº†3ä¸ªæ•°æ®åº“å®ä¾‹ï¼Œåªæœ‰å…¶ä¸­ä¸€ä¸ªå®ä¾‹downæ‰äº†ï¼Œå¹¶ä¸”ä¼¼ä¹æ²¡æœ‰åŠæ³•æ¢å¤ 1.0.26ç‰ˆæœ¬è¯•è¯•
700,é™ä½kafkaä¾èµ–ç‰ˆæœ¬ï¼Œç”³æ˜serverçš„runningä¸ºvolatile tks
699,Could not find first log file name in binary log index file mysql:10.1.25-MariaDB canal:å°è¯•äº†1.0.26alpha3ã€1.0.25 é…ç½®æ–‡ä»¶ä¸­ï¼Œpositionæœªé…ç½® å·²ç»ç¿»éäº†issuesä¸­ç±»ä¼¼é—®é¢˜è§£å†³æ–¹æ¡ˆï¼Œå°è¯•åˆ é™¤canal metaæ–‡ä»¶ï¼Œh2.mv.dbæ–‡ä»¶ï¼Œéƒ½ä¸è¡Œ mysqlä¾§å‘ç”Ÿå˜åŒ–åï¼Œcanal exampleè¿˜å…ˆæŠ¥è¿™ä¸ªï¼š com.alibaba.fastsql.sql.parser.ParserException: syntax error  error in :'utf8 PAGE_CHECKSUM=0  pos 626  line 13  column 50  token IDENTIFIER PAGE_CHECKSUM æ¥ä¸‹æ¥æŠ¥è¿™ä¸ªï¼š Could not find first log file name in binary log index file å…·ä½“å¼‚å¸¸å¤šè´´ä¸€ç‚¹ 2018-06-15 11:30:11.805 [destination = example   address = /10.10.38.39:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just show master status 2018-06-15 11:32:09.338 [destination = example   address = /10.10.38.39:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TEMPORARY TABLE `ALL_PLUGINS` (   `PLUGIN_NAME` varchar(64) NOT NULL DEFAULT ''   `PLUGIN_VERSION` varchar(20) NOT NULL DEFAULT ''   `PLUGIN_STATUS` varchar(16) NOT NULL DEFAULT ''   `PLUGIN_TYPE` varchar(80) NOT NULL DEFAULT ''   `PLUGIN_TYPE_VERSION` varchar(20) NOT NULL DEFAULT ''   `PLUGIN_LIBRARY` varchar(64) DEFAULT NULL   `PLUGIN_LIBRARY_VERSION` varchar(20) DEFAULT NULL   `PLUGIN_AUTHOR` varchar(64) DEFAULT NULL   `PLUGIN_DESCRIPTION` longtext   `PLUGIN_LICENSE` varchar(80) NOT NULL DEFAULT ''   `LOAD_OPTION` varchar(64) NOT NULL DEFAULT ''   `PLUGIN_MATURITY` varchar(12) NOT NULL DEFAULT ''   `PLUGIN_AUTH_VERSION` varchar(80) DEFAULT NULL ) ENGINE=Aria DEFAULT CHARSET=utf8 PAGE_CHECKSUM=0 com.alibaba.fastsql.sql.parser.ParserException: syntax error  error in :'utf8 PAGE_CHECKSUM=0  pos 723  line 15  column 50  token IDENTIFIER PAGE_CHECKSUM 	at com.alibaba.fastsql.sql.parser.SQLParser.printError(SQLParser.java:361) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:498) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.SQLUtils.parseStatements(SQLUtils.java:500) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.repository.SchemaRepository.console(SchemaRepository.java:412) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:72) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:84) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:173) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-06-15 11:32:09.340 [destination = example   address = /10.10.38.39:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TEMPORARY TABLE `COLUMNS` (   `TABLE_CATALOG` varchar(512) NOT NULL DEFAULT ''   `TABLE_SCHEMA` varchar(64) NOT NULL DEFAULT ''   `TABLE_NAME` varchar(64) NOT NULL DEFAULT ''   `COLUMN_NAME` varchar(64) NOT NULL DEFAULT ''   `ORDINAL_POSITION` bigint(21) unsigned NOT NULL DEFAULT '0'   `COLUMN_DEFAULT` longtext   `IS_NULLABLE` varchar(3) NOT NULL DEFAULT ''   `DATA_TYPE` varchar(64) NOT NULL DEFAULT ''   `CHARACTER_MAXIMUM_LENGTH` bigint(21) unsigned DEFAULT NULL   `CHARACTER_OCTET_LENGTH` bigint(21) unsigned DEFAULT NULL   `NUMERIC_PRECISION` bigint(21) unsigned DEFAULT NULL   `NUMERIC_SCALE` bigint(21) unsigned DEFAULT NULL   `DATETIME_PRECISION` bigint(21) unsigned DEFAULT NULL   `CHARACTER_SET_NAME` varchar(32) DEFAULT NULL   `COLLATION_NAME` varchar(32) DEFAULT NULL   `COLUMN_TYPE` longtext NOT NULL   `COLUMN_KEY` varchar(3) NOT NULL DEFAULT ''   `EXTRA` varchar(27) NOT NULL DEFAULT ''   `PRIVILEGES` varchar(80) NOT NULL DEFAULT ''   `COLUMN_COMMENT` varchar(1024) NOT NULL DEFAULT '' ) ENGINE=Aria DEFAULT CHARSET=utf8 PAGE_CHECKSUM=0 com.alibaba.fastsql.sql.parser.ParserException: syntax error  error in :'utf8 PAGE_CHECKSUM=0  pos 1078  line 22  column 50  token IDENTIFIER PAGE_CHECKSUM 	at com.alibaba.fastsql.sql.parser.SQLParser.printError(SQLParser.java:361) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:498) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.SQLUtils.parseStatements(SQLUtils.java:500) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.repository.SchemaRepository.console(SchemaRepository.java:412) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:72) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:84) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:173) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-06-15 11:32:09.341 [destination = example   address = /10.10.38.39:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TEMPORARY TABLE `EVENTS` (   `EVENT_CATALOG` varchar(64) NOT NULL DEFAULT ''   `EVENT_SCHEMA` varchar(64) NOT NULL DEFAULT ''   `EVENT_NAME` varchar(64) NOT NULL DEFAULT ''   `DEFINER` varchar(189) NOT NULL DEFAULT ''   `TIME_ZONE` varchar(64) NOT NULL DEFAULT ''   `EVENT_BODY` varchar(8) NOT NULL DEFAULT ''   `EVENT_DEFINITION` longtext NOT NULL   `EVENT_TYPE` varchar(9) NOT NULL DEFAULT ''   `EXECUTE_AT` datetime DEFAULT NULL   `INTERVAL_VALUE` varchar(256) DEFAULT NULL   `INTERVAL_FIELD` varchar(18) DEFAULT NULL   `SQL_MODE` varchar(8192) NOT NULL DEFAULT ''   `STARTS` datetime DEFAULT NULL   `ENDS` datetime DEFAULT NULL   `STATUS` varchar(18) NOT NULL DEFAULT ''   `ON_COMPLETION` varchar(12) NOT NULL DEFAULT ''   `CREATED` datetime NOT NULL DEFAULT '0000-00-00 00:00:00'   `LAST_ALTERED` datetime NOT NULL DEFAULT '0000-00-00 00:00:00'   `LAST_EXECUTED` datetime DEFAULT NULL   `EVENT_COMMENT` varchar(64) NOT NULL DEFAULT ''   `ORIGINATOR` bigint(10) NOT NULL DEFAULT '0'   `CHARACTER_SET_CLIENT` varchar(32) NOT NULL DEFAULT ''   `COLLATION_CONNECTION` varchar(32) NOT NULL DEFAULT ''   `DATABASE_COLLATION` varchar(32) NOT NULL DEFAULT '' ) ENGINE=Aria DEFAULT CHARSET=utf8 PAGE_CHECKSUM=0 com.alibaba.fastsql.sql.parser.ParserException: syntax error  error in :'utf8 PAGE_CHECKSUM=0  pos 1234  line 26  column 50  token IDENTIFIER PAGE_CHECKSUM 	at com.alibaba.fastsql.sql.parser.SQLParser.printError(SQLParser.java:361) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:498) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.SQLUtils.parseStatements(SQLUtils.java:500) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.repository.SchemaRepository.console(SchemaRepository.java:412) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:72) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:84) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:173) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-06-15 11:32:09.342 [destination = example   address = /10.10.38.39:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TEMPORARY TABLE `PARAMETERS` (   `SPECIFIC_CATALOG` varchar(512) NOT NULL DEFAULT ''   `SPECIFIC_SCHEMA` varchar(64) NOT NULL DEFAULT ''   `SPECIFIC_NAME` varchar(64) NOT NULL DEFAULT ''   `ORDINAL_POSITION` int(21) NOT NULL DEFAULT '0'   `PARAMETER_MODE` varchar(5) DEFAULT NULL   `PARAMETER_NAME` varchar(64) DEFAULT NULL   `DATA_TYPE` varchar(64) NOT NULL DEFAULT ''   `CHARACTER_MAXIMUM_LENGTH` int(21) DEFAULT NULL   `CHARACTER_OCTET_LENGTH` int(21) DEFAULT NULL   `NUMERIC_PRECISION` int(21) DEFAULT NULL   `NUMERIC_SCALE` int(21) DEFAULT NULL   `DATETIME_PRECISION` bigint(21) unsigned DEFAULT NULL   `CHARACTER_SET_NAME` varchar(64) DEFAULT NULL   `COLLATION_NAME` varchar(64) DEFAULT NULL   `DTD_IDENTIFIER` longtext NOT NULL   `ROUTINE_TYPE` varchar(9) NOT NULL DEFAULT '' ) ENGINE=Aria DEFAULT CHARSET=utf8 PAGE_CHECKSUM=0 com.alibaba.fastsql.sql.parser.ParserException: syntax error  error in :'utf8 PAGE_CHECKSUM=0  pos 853  line 18  column 50  token IDENTIFIER PAGE_CHECKSUM 	at com.alibaba.fastsql.sql.parser.SQLParser.printError(SQLParser.java:361) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:498) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.SQLUtils.parseStatements(SQLUtils.java:500) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.repository.SchemaRepository.console(SchemaRepository.java:412) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:72) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:84) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:173) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-06-15 11:32:09.342 [destination = example   address = /10.10.38.39:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TEMPORARY TABLE `PARTITIONS` (   `TABLE_CATALOG` varchar(512) NOT NULL DEFAULT ''   `TABLE_SCHEMA` varchar(64) NOT NULL DEFAULT ''   `TABLE_NAME` varchar(64) NOT NULL DEFAULT ''   `PARTITION_NAME` varchar(64) DEFAULT NULL   `SUBPARTITION_NAME` varchar(64) DEFAULT NULL   `PARTITION_ORDINAL_POSITION` bigint(21) unsigned DEFAULT NULL   `SUBPARTITION_ORDINAL_POSITION` bigint(21) unsigned DEFAULT NULL   `PARTITION_METHOD` varchar(18) DEFAULT NULL   `SUBPARTITION_METHOD` varchar(12) DEFAULT NULL   `PARTITION_EXPRESSION` longtext   `SUBPARTITION_EXPRESSION` longtext   `PARTITION_DESCRIPTION` longtext   `TABLE_ROWS` bigint(21) unsigned NOT NULL DEFAULT '0'   `AVG_ROW_LENGTH` bigint(21) unsigned NOT NULL DEFAULT '0'   `DATA_LENGTH` bigint(21) unsigned NOT NULL DEFAULT '0'   `MAX_DATA_LENGTH` bigint(21) unsigned DEFAULT NULL   `INDEX_LENGTH` bigint(21) unsigned NOT NULL DEFAULT '0'   `DATA_FREE` bigint(21) unsigned NOT NULL DEFAULT '0'   `CREATE_TIME` datetime DEFAULT NULL   `UPDATE_TIME` datetime DEFAULT NULL   `CHECK_TIME` datetime DEFAULT NULL   `CHECKSUM` bigint(21) unsigned DEFAULT NULL   `PARTITION_COMMENT` varchar(80) NOT NULL DEFAULT ''   `NODEGROUP` varchar(12) NOT NULL DEFAULT ''   `TABLESPACE_NAME` varchar(64) DEFAULT NULL ) ENGINE=Aria DEFAULT CHARSET=utf8 PAGE_CHECKSUM=0 com.alibaba.fastsql.sql.parser.ParserException: syntax error  error in :'utf8 PAGE_CHECKSUM=0  pos 1323  line 27  column 50  token IDENTIFIER PAGE_CHECKSUM 	at com.alibaba.fastsql.sql.parser.SQLParser.printError(SQLParser.java:361) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:498) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.SQLUtils.parseStatements(SQLUtils.java:500) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.repository.SchemaRepository.console(SchemaRepository.java:412) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:72) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:84) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:173) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-06-15 11:32:09.343 [destination = example   address = /10.10.38.39:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TEMPORARY TABLE `PLUGINS` (   `PLUGIN_NAME` varchar(64) NOT NULL DEFAULT ''   `PLUGIN_VERSION` varchar(20) NOT NULL DEFAULT ''   `PLUGIN_STATUS` varchar(16) NOT NULL DEFAULT ''   `PLUGIN_TYPE` varchar(80) NOT NULL DEFAULT ''   `PLUGIN_TYPE_VERSION` varchar(20) NOT NULL DEFAULT ''   `PLUGIN_LIBRARY` varchar(64) DEFAULT NULL   `PLUGIN_LIBRARY_VERSION` varchar(20) DEFAULT NULL   `PLUGIN_AUTHOR` varchar(64) DEFAULT NULL   `PLUGIN_DESCRIPTION` longtext   `PLUGIN_LICENSE` varchar(80) NOT NULL DEFAULT ''   `LOAD_OPTION` varchar(64) NOT NULL DEFAULT ''   `PLUGIN_MATURITY` varchar(12) NOT NULL DEFAULT ''   `PLUGIN_AUTH_VERSION` varchar(80) DEFAULT NULL ) ENGINE=Aria DEFAULT CHARSET=utf8 PAGE_CHECKSUM=0 com.alibaba.fastsql.sql.parser.ParserException: syntax error  error in :'utf8 PAGE_CHECKSUM=0  pos 719  line 15  column 50  token IDENTIFIER PAGE_CHECKSUM 	at com.alibaba.fastsql.sql.parser.SQLParser.printError(SQLParser.java:361) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:498) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.SQLUtils.parseStatements(SQLUtils.java:500) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.repository.SchemaRepository.console(SchemaRepository.java:412) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:72) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:84) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:173) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-06-15 11:32:09.344 [destination = example   address = /10.10.38.39:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TEMPORARY TABLE `PROCESSLIST` (   `ID` bigint(4) NOT NULL DEFAULT '0'   `USER` varchar(128) NOT NULL DEFAULT ''   `HOST` varchar(64) NOT NULL DEFAULT ''   `DB` varchar(64) DEFAULT NULL   `COMMAND` varchar(16) NOT NULL DEFAULT ''   `TIME` int(7) NOT NULL DEFAULT '0'   `STATE` varchar(64) DEFAULT NULL   `INFO` longtext   `TIME_MS` decimal(22 3) NOT NULL DEFAULT '0.000'   `STAGE` tinyint(2) NOT NULL DEFAULT '0'   `MAX_STAGE` tinyint(2) NOT NULL DEFAULT '0'   `PROGRESS` decimal(7 3) NOT NULL DEFAULT '0.000'   `MEMORY_USED` int(7) NOT NULL DEFAULT '0'   `EXAMINED_ROWS` int(7) NOT NULL DEFAULT '0'   `QUERY_ID` bigint(4) NOT NULL DEFAULT '0'   `INFO_BINARY` blob   `TID` bigint(4) NOT NULL DEFAULT '0' ) ENGINE=Aria DEFAULT CHARSET=utf8 PAGE_CHECKSUM=0 com.alibaba.fastsql.sql.parser.ParserException: syntax error  error in :'utf8 PAGE_CHECKSUM=0  pos 774  line 19  column 50  token IDENTIFIER PAGE_CHECKSUM 	at com.alibaba.fastsql.sql.parser.SQLParser.printError(SQLParser.java:361) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:498) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.SQLUtils.parseStatements(SQLUtils.java:500) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.repository.SchemaRepository.console(SchemaRepository.java:412) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:72) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:84) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:173) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-06-15 11:32:09.344 [destination = example   address = /10.10.38.39:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TEMPORARY TABLE `ROUTINES` (   `SPECIFIC_NAME` varchar(64) NOT NULL DEFAULT ''   `ROUTINE_CATALOG` varchar(512) NOT NULL DEFAULT ''   `ROUTINE_SCHEMA` varchar(64) NOT NULL DEFAULT ''   `ROUTINE_NAME` varchar(64) NOT NULL DEFAULT ''   `ROUTINE_TYPE` varchar(9) NOT NULL DEFAULT ''   `DATA_TYPE` varchar(64) NOT NULL DEFAULT ''   `CHARACTER_MAXIMUM_LENGTH` int(21) DEFAULT NULL   `CHARACTER_OCTET_LENGTH` int(21) DEFAULT NULL   `NUMERIC_PRECISION` int(21) DEFAULT NULL   `NUMERIC_SCALE` int(21) DEFAULT NULL   `DATETIME_PRECISION` bigint(21) unsigned DEFAULT NULL   `CHARACTER_SET_NAME` varchar(64) DEFAULT NULL   `COLLATION_NAME` varchar(64) DEFAULT NULL   `DTD_IDENTIFIER` longtext   `ROUTINE_BODY` varchar(8) NOT NULL DEFAULT ''   `ROUTINE_DEFINITION` longtext   `EXTERNAL_NAME` varchar(64) DEFAULT NULL   `EXTERNAL_LANGUAGE` varchar(64) DEFAULT NULL   `PARAMETER_STYLE` varchar(8) NOT NULL DEFAULT ''   `IS_DETERMINISTIC` varchar(3) NOT NULL DEFAULT ''   `SQL_DATA_ACCESS` varchar(64) NOT NULL DEFAULT ''   `SQL_PATH` varchar(64) DEFAULT NULL   `SECURITY_TYPE` varchar(7) NOT NULL DEFAULT ''   `CREATED` datetime NOT NULL DEFAULT '0000-00-00 00:00:00'   `LAST_ALTERED` datetime NOT NULL DEFAULT '0000-00-00 00:00:00'   `SQL_MODE` varchar(8192) NOT NULL DEFAULT ''   `ROUTINE_COMMENT` longtext NOT NULL   `DEFINER` varchar(189) NOT NULL DEFAULT ''   `CHARACTER_SET_CLIENT` varchar(32) NOT NULL DEFAULT ''   `COLLATION_CONNECTION` varchar(32) NOT NULL DEFAULT ''   `DATABASE_COLLATION` varchar(32) NOT NULL DEFAULT '' ) ENGINE=Aria DEFAULT CHARSET=utf8 PAGE_CHECKSUM=0 com.alibaba.fastsql.sql.parser.ParserException: syntax error  error in :'utf8 PAGE_CHECKSUM=0  pos 1603  line 33  column 50  token IDENTIFIER PAGE_CHECKSUM 	at com.alibaba.fastsql.sql.parser.SQLParser.printError(SQLParser.java:361) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:498) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.SQLUtils.parseStatements(SQLUtils.java:500) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.repository.SchemaRepository.console(SchemaRepository.java:412) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:72) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:84) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:173) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-06-15 11:32:09.345 [destination = example   address = /10.10.38.39:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TEMPORARY TABLE `SYSTEM_VARIABLES` (   `VARIABLE_NAME` varchar(64) NOT NULL DEFAULT ''   `SESSION_VALUE` varchar(2048) DEFAULT NULL   `GLOBAL_VALUE` varchar(2048) DEFAULT NULL   `GLOBAL_VALUE_ORIGIN` varchar(64) NOT NULL DEFAULT ''   `DEFAULT_VALUE` varchar(2048) DEFAULT NULL   `VARIABLE_SCOPE` varchar(64) NOT NULL DEFAULT ''   `VARIABLE_TYPE` varchar(64) NOT NULL DEFAULT ''   `VARIABLE_COMMENT` varchar(2048) NOT NULL DEFAULT ''   `NUMERIC_MIN_VALUE` varchar(21) DEFAULT NULL   `NUMERIC_MAX_VALUE` varchar(21) DEFAULT NULL   `NUMERIC_BLOCK_SIZE` varchar(21) DEFAULT NULL   `ENUM_VALUE_LIST` longtext   `READ_ONLY` varchar(3) NOT NULL DEFAULT ''   `COMMAND_LINE_ARGUMENT` varchar(64) DEFAULT NULL ) ENGINE=Aria DEFAULT CHARSET=utf8 PAGE_CHECKSUM=0 com.alibaba.fastsql.sql.parser.ParserException: syntax error  error in :'utf8 PAGE_CHECKSUM=0  pos 768  line 16  column 50  token IDENTIFIER PAGE_CHECKSUM 	at com.alibaba.fastsql.sql.parser.SQLParser.printError(SQLParser.java:361) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:498) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.SQLUtils.parseStatements(SQLUtils.java:500) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.repository.SchemaRepository.console(SchemaRepository.java:412) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:72) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:84) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:173) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-06-15 11:32:09.346 [destination = example   address = /10.10.38.39:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TEMPORARY TABLE `TRIGGERS` (   `TRIGGER_CATALOG` varchar(512) NOT NULL DEFAULT ''   `TRIGGER_SCHEMA` varchar(64) NOT NULL DEFAULT ''   `TRIGGER_NAME` varchar(64) NOT NULL DEFAULT ''   `EVENT_MANIPULATION` varchar(6) NOT NULL DEFAULT ''   `EVENT_OBJECT_CATALOG` varchar(512) NOT NULL DEFAULT ''   `EVENT_OBJECT_SCHEMA` varchar(64) NOT NULL DEFAULT ''   `EVENT_OBJECT_TABLE` varchar(64) NOT NULL DEFAULT ''   `ACTION_ORDER` bigint(4) NOT NULL DEFAULT '0'   `ACTION_CONDITION` longtext   `ACTION_STATEMENT` longtext NOT NULL   `ACTION_ORIENTATION` varchar(9) NOT NULL DEFAULT ''   `ACTION_TIMING` varchar(6) NOT NULL DEFAULT ''   `ACTION_REFERENCE_OLD_TABLE` varchar(64) DEFAULT NULL   `ACTION_REFERENCE_NEW_TABLE` varchar(64) DEFAULT NULL   `ACTION_REFERENCE_OLD_ROW` varchar(3) NOT NULL DEFAULT ''   `ACTION_REFERENCE_NEW_ROW` varchar(3) NOT NULL DEFAULT ''   `CREATED` datetime DEFAULT NULL   `SQL_MODE` varchar(8192) NOT NULL DEFAULT ''   `DEFINER` varchar(189) NOT NULL DEFAULT ''   `CHARACTER_SET_CLIENT` varchar(32) NOT NULL DEFAULT ''   `COLLATION_CONNECTION` varchar(32) NOT NULL DEFAULT ''   `DATABASE_COLLATION` varchar(32) NOT NULL DEFAULT '' ) ENGINE=Aria DEFAULT CHARSET=utf8 PAGE_CHECKSUM=0 com.alibaba.fastsql.sql.parser.ParserException: syntax error  error in :'utf8 PAGE_CHECKSUM=0  pos 1228  line 24  column 50  token IDENTIFIER PAGE_CHECKSUM 	at com.alibaba.fastsql.sql.parser.SQLParser.printError(SQLParser.java:361) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:498) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.SQLUtils.parseStatements(SQLUtils.java:500) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.repository.SchemaRepository.console(SchemaRepository.java:412) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:72) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:84) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:173) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-06-15 11:32:09.347 [destination = example   address = /10.10.38.39:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TEMPORARY TABLE `VIEWS` (   `TABLE_CATALOG` varchar(512) NOT NULL DEFAULT ''   `TABLE_SCHEMA` varchar(64) NOT NULL DEFAULT ''   `TABLE_NAME` varchar(64) NOT NULL DEFAULT ''   `VIEW_DEFINITION` longtext NOT NULL   `CHECK_OPTION` varchar(8) NOT NULL DEFAULT ''   `IS_UPDATABLE` varchar(3) NOT NULL DEFAULT ''   `DEFINER` varchar(189) NOT NULL DEFAULT ''   `SECURITY_TYPE` varchar(7) NOT NULL DEFAULT ''   `CHARACTER_SET_CLIENT` varchar(32) NOT NULL DEFAULT ''   `COLLATION_CONNECTION` varchar(32) NOT NULL DEFAULT ''   `ALGORITHM` varchar(10) NOT NULL DEFAULT '' ) ENGINE=Aria DEFAULT CHARSET=utf8 PAGE_CHECKSUM=0 com.alibaba.fastsql.sql.parser.ParserException: syntax error  error in :'utf8 PAGE_CHECKSUM=0  pos 626  line 13  column 50  token IDENTIFIER PAGE_CHECKSUM 	at com.alibaba.fastsql.sql.parser.SQLParser.printError(SQLParser.java:361) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:498) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.SQLUtils.parseStatements(SQLUtils.java:500) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.fastsql.sql.repository.SchemaRepository.console(SchemaRepository.java:412) ~[fastsql-2.0.0_preview_371.jar:2.0.0_preview_371] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:72) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:84) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:173) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-06-15 11:32:17.341 [destination = example   address = /10.10.38.39:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - find start position : EntryPosition[included=false journalName=mysql-bin.000001Ã—{G? position=4239821 serverId=3839 gtid=<null> timestamp=1529033212000] 2018-06-15 11:32:18.653 [destination = example   address = /10.10.38.39:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-06-15 11:32:18.655 [destination = example   address = /10.10.38.39:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /10.10.38.39:3306 has an error  retrying. caused by  java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-06-15 11:32:18.658 [destination = example   address = /10.10.38.39:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) 	at java.lang.Thread.run(Thread.java:748) ] 2018-06-15 11:32:30.620 [destination = example   address = /10.10.38.39:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just show master status 2018-06-15 11:32:45.110 [destination = example   address = /10.10.38.39:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - find start position : EntryPosition[included=false journalName=mysql-bin.000001Ã—{G? position=4240327 serverId=3839 gtid=<null> timestamp=1529033528000] 2018-06-15 11:32:45.287 [destination = example   address = /10.10.38.39:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-06-15 11:32:45.288 [destination = example   address = /10.10.38.39:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /10.10.38.39:3306 has an error  retrying. caused by  java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-06-15 11:32:45.289 [destination = example   address = /10.10.38.39:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) 	at java.lang.Thread.run(Thread.java:748) ] 2018-06-15 11:32:56.095 [destination = example   address = /10.10.38.39:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just show master status 2018-06-15 11:35:34.307 [destination = example   address = /10.10.38.39:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - find start position : EntryPosition[included=false journalName=mysql-bin.000001Ã—{G? position=4240471 serverId=3839 gtid=<null> timestamp=1529033565000] 2018-06-15 11:35:34.724 [destination = example   address = /10.10.38.39:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-06-15 11:35:34.725 [destination = example   address = /10.10.38.39:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /10.10.38.39:3306 has an error  retrying. caused by  java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-06-15 11:35:34.725 [destination = example   address = /10.10.38.39:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) 	at java.lang.Thread.run(Thread.java:748) ] 2018-06-15 11:35:52.169 [destination = example   address = /10.10.38.39:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just show master status 2018-06-15 11:50:06.738 [destination = example   address = /10.10.38.39:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - find start position : EntryPosition[included=false journalName=mysql-bin.000001Ã—{G? position=4240821 serverId=3839 gtid=<null> timestamp=1529033734000] 2018-06-15 11:50:07.002 [destination = example   address = /10.10.38.39:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-06-15 11:50:07.003 [destination = example   address = /10.10.38.39:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /10.10.38.39:3306 has an error  retrying. caused by  java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-06-15 11:50:07.006 [destination = example   address = /10.10.38.39:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) 	at java.lang.Thread.run(Thread.java:748) ] 2018-06-15 11:50:24.984 [destination = example   address = /10.10.38.39:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just show master status 2018-06-15 11:51:40.902 [destination = example   address = /10.10.38.39:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - find start position : EntryPosition[included=false journalName=mysql-bin.000001Ã—{G? position=4241171 serverId=3839 gtid=<null> timestamp=1529034606000] 2018-06-15 11:51:41.216 [destination = example   address = /10.10.38.39:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-06-15 11:51:41.217 [destination = example   address = /10.10.38.39:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /10.10.38.39:3306 has an error  retrying. caused by  java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:105) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:146) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:227) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] PAGE_CHECKSUM è¿™æ˜¯mariadbçš„å…³é”®å­—å§ï¼Ÿ æ˜¯mariadbçš„å…³é”®å­— çœ‹è¿™ä¸ªæŠ¥é”™ï¼Œæ˜¯åˆ›å»ºæœ¬åœ°å†…å­˜è¡¨çš„æ—¶å€™ï¼Œä¸èƒ½è¯†åˆ«è¿™ä¸ªå…³é”®å­—ã€‚ã€‚ã€‚ å¦‚æœç”¨mysqlæ›¿æ¢æ‰å†…å­˜æ•°æ®åº“ï¼Œéœ€è¦æ€ä¹ˆæ æˆ‘æŠŠtsdbå…³äº†ï¼Œç›®å‰æ­£å¸¸äº†ã€‚ã€‚ã€‚ åœ¨instance.propertiesä¸­ï¼Œé…ç½®äº†canal.instance.defaultDatabaseName=aaaï¼Œè¿˜æ˜¯ä¼šæ”¶åˆ°å½“å‰å®ä¾‹ä¸Šï¼Œæ‰€æœ‰æ•°æ®åº“çš„å˜æ›´äº‹ä»¶ï¼Œé‚£é…ç½®è¿™ä¸ªdefaultçš„æ„ä¹‰æ˜¯ï¼Ÿ è¿™ä¸ªdefaultæ²¡å•¥æ„ä¹‰ I have seen the same problem.There is my log: environment:mysql5.7.16-log Source distribution  canal:canal.deployer-1.0.24 2018-07-11 16:44:26.054 [destination = example   address = /***.***.**.**:3307   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) [canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) [canal.parse-1.0.22.jar:na] 	at java.lang.Thread.run(Unknown Source) [na:1.8.0_161] 2018-07-11 16:44:26.054 [destination = example   address = /***.***.**.**:3307   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /***.***.**.**:3307 has an error  retrying. caused by  java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) ~[canal.parse-1.0.22.jar:na] 	at java.lang.Thread.run(Unknown Source) [na:1.8.0_161] 2018-07-11 16:44:26.055 [destination = example   address = /***.***.**.**:3307   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) 	at java.lang.Thread.run(Unknown Source) ] sqlstate = HY000 errmsg = Could not find first log file name in binary log index file    binlogè¢«åˆ é™¤ but I can execute the sql to find out that file show binary logs 
698,ClientRunningMonitor shutdown delayExector threadpool #697 #697 tks
697,ClientRunningMonitor shutdown delayExector threadpool Versionï¼š1.0.26.alpha2 å½“clientåœ¨clusteræ¨¡å¼ä¸‹å‘ç”Ÿhaåˆ‡æ¢æ—¶ï¼Œcom.alibaba.otter.canal.client.impl.running.ClientRunningMonitor ä¼šsubmit jobåˆ°delayExectorï¼Œå¿…é¡»åœ¨stopæ–¹æ³•é‡Œæ‰§è¡ŒdelayExector.shutdown()ï¼Œå¦åˆ™ä¸èƒ½ä¼˜é›…shutdownåº”ç”¨ ä¸€ä¼šå„¿æäº¤prï¼Œplease assign the issue to me. Thanx.
696,ä½¿ç”¨canal1.0.24å’Œ1.0.25çš„é—®é¢˜ springåœºæ™¯ï¼š default-instance.xml 1.0.24ç‰ˆæœ¬çš„connector.subscribeï¼ˆï¼‰æ–¹æ³•æœ‰æ—¶ä¼šå¡ä½ï¼Œè€Œä¸”å¾—ä¸åˆ°binlogçš„è®¢é˜…æ¶ˆæ¯ã€‚zookeeperä¸Šçš„ä¿¡æ¯ä¸€åˆ‡æ­£å¸¸ï¼Œä½†å°±æ˜¯æ¶ˆè´¹ä¸äº†binlogæ¶ˆæ¯ã€‚ 1.0.25ç‰ˆæœ¬çš„åˆ™ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜ã€‚ ç°åœ¨ç”Ÿäº§ç¯å¢ƒä¸Šä½¿ç”¨çš„æ˜¯1.0.24ï¼Œæƒ³é—®ä¸‹ï¼Œè¿™ä¸ªæ˜¯1.0.24å·²æœ‰çš„bugå— æ€ä¸ªthread dumpçœ‹ä¸€ä¸‹å¡åœ¨å“ªé‡Œã€‚ä¸€èˆ¬æ˜¯æ²¡æœ‰è·å¾—zkä¸Šçš„runningé”ã€‚æ˜¯å‡ ä¸ªå®¢æˆ·ç«¯èŠ‚ç‚¹ï¼Ÿ @nbqyqx å°±ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œç°åœ¨ä¸ç”¨zkï¼Œç›´è¿ä¹Ÿæ˜¯æ”¶ä¸åˆ°binlogæ¶ˆæ¯ï¼Œæ¢1.025å°±èƒ½æ”¶åˆ°äº†ã€‚1.0.24ç°åœ¨ä»€ä¹ˆéƒ½åšä¸äº† 2018-06-15 10:32:57.010 [destination = szctest   address = /47.97.185.74:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - connect MysqlConnection to /47.97.185.74:3306... 2018-06-15 10:32:57.072 [destination = szctest   address = /47.97.185.74:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - handshake initialization packet received  prepare the client authentication packet to send 2018-06-15 10:32:57.073 [destination = szctest   address = /47.97.185.74:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - client authentication packet is sent out. 2018-06-15 10:32:57.105 [destination = szctest   address = /47.97.185.74:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - disConnect MysqlConnection to /47.97.185.74:3306... 2018-06-15 10:32:57.105 [destination = szctest   address = /47.97.185.74:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /47.97.185.74:3306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: connect /47.97.185.74:3306 failure:java.io.IOException: Error When doing Client Authentication:ErrorPacket [errorNumber=1045  fieldCount=-1  message=Access denied for user 'retl'@'113.116.141.191' (using password: YES)  sqlState=28000  sqlStateMarker=#] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.negotiate(MysqlConnector.java:208) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:71) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:56) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:86) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:157) 	at java.lang.Thread.run(Unknown Source) Caused by: java.io.IOException: connect /47.97.185.74:3306 failure:java.io.IOException: Error When doing Client Authentication:ErrorPacket [errorNumber=1045  fieldCount=-1  message=Access denied for user 'retl'@'113.116.141.191' (using password: YES)  sqlState=28000  sqlStateMarker=#] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.negotiate(MysqlConnector.java:208) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:71) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:56) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:86) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:157) 	at java.lang.Thread.run(Unknown Source) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:74) ~[canal.parse.driver-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:56) ~[canal.parse-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:86) ~[canal.parse-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:157) ~[canal.parse-1.0.24.jar:na] 	at java.lang.Thread.run(Unknown Source) [na:1.8.0_172] æ— è¯­å•Š/47.97.185.74:3306  è¿™ä¸ªæ˜¯æˆ‘çš„mysql   ä½†è¿™ä¸ªæ˜¯å•¥  'retl'@'113.116.141.191'  æ‰¾åˆ°åŸå› äº†ï¼Œæ˜¯æˆ‘çš„instanceé‡Œçš„é…ç½®å’Œdefault-instance.xmlé‡Œçš„é…ç½®ä¸ä¸€æ ·ï¼Œ æˆ‘çš„instanceé‡Œæ˜¯canal.instance.master.dbUsernameï¼Œ è€Œxmlé‡Œç”¨çš„æ˜¯${canal.instance.dbUsername} ä¹‹å‰ æ”¹groupæ—¶ æ²¡å¼„å›æ¥
695,å¢åŠ kafkaå¯¹canal binlogä¿¡æ¯çš„ç”Ÿæˆæ¶ˆè´¹æ”¯æŒ 1.åœ¨canal serverç«¯ç›´æ¥è®¢é˜…destinationè·å–messageå‘é€åˆ°kafka 2.åœ¨canal.propertiesä¸­å¢åŠ canal.withoutNettyå±æ€§ï¼Œå¯ä»¥å…³é—­serverç«¯çš„nettyæœåŠ¡ 3å¢åŠ kafkaçš„clientæ¥ç›´æ¥æ¶ˆè´¹messageæ•°æ® åŸæ¥çš„ canal server -- netty -- message --> nio -- canal client æ¶æ„ é€šè¿‡kafkaæ”¯æŒçš„æ¶æ„ï¼š canal server -- kafka prducer -- message --> KAFKA --> kafka consumer -- canal kafka client  Great support! Looking forward to accept the patch. https://github.com/alibaba/canal/issues/669 éå¸¸niceçš„PRï¼Œæˆ‘ä¼šä»”ç»†çœ‹ä¸€ä¸‹ å·²ç»åˆå¹¶ æ•ˆç‡çœŸé«˜ ï¼šï¼‰
694,canalè§£æé€Ÿåº¦é—®é¢˜ ä¸€ä¸ªåº“é‡Œé¢ä»Šå¤©40åˆ†é’Ÿå†…æˆ‘ä»¬åšäº†2kwæ•°æ®æ’å…¥æ“ä½œï¼Œå¯¼è‡´å¤§é‡binglogç”Ÿæˆï¼Œä½†æ˜¯canalè§£æé€Ÿåº¦éå¸¸æ…¢ï¼Œè¯äº†å°†è¿‘6ä¸ªå°æ—¶æ‰è¿½ä¸Šå®é™…ä½ç‚¹ã€‚ä¸çŸ¥é“è¿™ä¸ªå¦‚ä½•è°ƒä¼˜ï¼Ÿ å‚è€ƒFAQé‡Œçš„æ€§èƒ½ï¼šhttps://github.com/alibaba/canal/wiki/FAQ
693,ç›‘å¬ä¸åˆ°binlog ä½¿ç”¨1.0.23ç›‘å¬çš„æ—¶å€™ï¼Œmysqlçš„binlogé…ç½®log-bin=mysql186-binè¿™ç§ç»“æ„ï¼Œç›‘å¬ä¸åˆ°ã€‚è¯·é—®æ˜¯å¦å’Œbinlogæ–‡ä»¶åç§°æœ‰å…³ç³»ï¼Ÿ è¿˜æ²¡äººåé¦ˆè¿‡ç±»ä¼¼é—®é¢˜ï¼Œè¯·æè¿°é‡ç°æ­¥éª¤ åº”è¯¥æ˜¯æˆ‘æ¥å›åˆ‡æ¢é›†ç¾¤æ¨¡å¼é€ æˆçš„ï¼Œæ¸…ç†zkä¸‹ç”Ÿæˆçš„æ–‡ä»¶å°±å¥½äº†
692,æŒ‡å®šä½ç‚¹è¿›è¡ŒåŒæ­¥çš„çš„æ—¶å€™ä½¿ç”¨æ—¶é—´æˆ³æŒ‡å®šçš„é—®é¢˜ å¦‚æœåªä½¿ç”¨æ—¶é—´æˆ³æŒ‡å®šï¼Œä¸ä½¿ç”¨binlogæ–‡ä»¶åè¾…åŠ©ï¼Œä»£ç ä¼šå»è·å–å¤´å°¾ä½ç½®çš„binlogæ–‡ä»¶ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœdbaç²—æš´ç®¡ç†æˆ–è€…å…¶ä»–æƒ…å†µå¯¼è‡´binlogæ–‡ä»¶è¢«ç‰©ç†åˆ é™¤ï¼Œä¼šè·å–ä¸åˆ°binlogèµ·å§‹æ–‡ä»¶å¯¼è‡´æŠ¥é”™ã€‚ å…³é”®ä»£ç ï¼š ``` class MysqlEventParser ã€‚ã€‚ã€‚ // æ ¹æ®æ—¶é—´æŸ¥æ‰¾binlogä½ç½®     private EntryPosition findByStartTimeStamp(MysqlConnection mysqlConnection  Long startTimestamp) {         EntryPosition endPosition = findEndPosition(mysqlConnection);         EntryPosition startPosition = findStartPosition(mysqlConnection); ã€‚ã€‚ã€‚   /* æŸ¥è¯¢å½“å‰çš„binlogä½ç½®      */     private EntryPosition findStartPosition(MysqlConnection mysqlConnection) {         try {             ResultSetPacket packet = mysqlConnection.query("show binlog events limit 1");             List<String> fields = packet.getFieldValues();             if (CollectionUtils.isEmpty(fields)) {                 throw new CanalParseException("command : 'show binlog events limit 1' has an error! pls check. you need (at least one of) the SUPER REPLICATION CLIENT privilege(s) for this operation");             }             EntryPosition endPosition = new EntryPosition(fields.get(0)  Long.valueOf(fields.get(1)));             return endPosition;         } catch (IOException e) {             throw new CanalParseException("command : 'show binlog events limit 1' has an error!"  e);         }     } ```   show binlog events limit 1 çš„æ—¶å€™ä¼šæŠ¥é”™ï¼š > MySQL [(none)]> show binlog events limit 1; > ERROR 29 (HY000): File './mysqlmaster-bin.000001' not found (Errcode: 2 - No such file or directory) æ˜¯ä¸æ˜¯ä½¿ç”¨ show binary logs; å‘½ä»¤è·å– size å¤§äº 0 çš„æ–‡ä»¶ï¼Œç„¶åå†ä½¿ç”¨ show binlog events æ¥è·å–èµ·å§‹ä½ç‚¹ä¿¡æ¯ä¼šå¥½ä¸€ç‚¹ï¼Ÿ å¯ä»¥è€ƒè™‘æäº¤ä¸€ä¸ªPRç»™æˆ‘
691,javaé›†ç¾¤é“¾æ¥çš„æ—¶å€™æŠ¥é”™äº† com.alibaba.otter.canal.protocol.exception.CanalClientException: java.io.IOException: end of stream when reading header 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:277) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:248) 	at com.alibaba.otter.canal.client.impl.ClusterCanalConnector.getWithoutAck(ClusterCanalConnector.java:174) 	at com.dangdang.canal.DDPimJob.run(DDPimJob.java:55) 	at java.lang.Thread.run(Unknown Source) Caused by: java.io.IOException: end of stream when reading header 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.read(SimpleCanalConnector.java:374) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.readNextPacket(SimpleCanalConnector.java:365) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.receiveMessages(SimpleCanalConnector.java:282) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:275) ä½ è¿˜æ˜¯æŠ¥ä¸€ä¸‹ç‰ˆæœ¬å·å§ï¼Œæˆ‘è§‰å¾—åº”è¯¥åŠ ä¸ªæ¨¡æ¿çš„ã€‚ã€‚ã€‚ã€‚ä¸ç„¶å„å¼å„æ ·çš„é—®é¢˜ã€‚ã€‚ã€‚ã€‚ çœ‹ä½ çš„æ ·å­ä½¿ç”¨çš„æ˜¯25ç‰ˆæœ¬çš„
690,canal.instance.filter.regexæ”¯æŒåŒ¹é…å¤šä¸ªschemaå— æ¯”å¦‚æˆ‘æœ‰3ä¸ªæ•°æ®åº“ï¼Œåˆ†åº“äº†ã€‚åˆ†åˆ«æ˜¯pay_n_1  pay_n_2  pay_n_3ï¼Œå…¶å®ƒåº“ä¸æ˜¯æˆ‘å…³å¿ƒçš„ï¼Œæˆ‘åªå…³å¿ƒè¿™ä¸‰ä¸ªã€‚ canal.instance.filter.regex æ€ä¹ˆå†™ï¼Œæˆ‘å†™æˆcanal.instance.filter.regex=pay_n_\*\\..\*  ä¸èµ·ä½œç”¨ pay_n_\\\w+\\..\*  è¿™æ ·å°±è¡Œäº†
689,canalå®ä¾‹è¦æ‰‹åŠ¨åˆ›å»ºå—ï¼Ÿ å¦‚é¢˜ï¼Œå®ä¾‹è¦æ¯æ¬¡æ‰‹åŠ¨åˆ›å»ºå—ï¼Ÿå¦‚æœè‡ªåŠ¨é…ç½® åº”è¯¥æ€ä¹ˆé…ç½®ã€‚æ¯æ¬¡å¥½åƒåªèƒ½è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œä½†æ˜¯å®¢æˆ·ç«¯è¿æ¥æ—¶ä¼šæŠ¥é”™
688,canal.instance.defaultDatabaseNameè®¾ç½®æˆæŒ‡å®šçš„åº“åï¼Œä¸ºå•¥å…¶å®ƒåº“çš„å¢åˆ æ”¹ä¹Ÿèƒ½æ”¶åˆ°æ¶ˆæ¯ å¦‚é¢˜ï¼Œæˆ‘åªæŒ‡å®šäº†ä¸€ä¸ªinstanceï¼Œinstanceé‡ŒåªæŒ‡å®šäº†ä¸€ä¸ªåº“ï¼Œä½†æ˜¯æ¶ˆè´¹æ—¶ï¼Œæ‰€æœ‰åº“çš„æ”¹å˜éƒ½èƒ½ç›‘å¬åˆ° æŸ¥ä¸€ä¸‹å†å²çš„issue @agapple è°¢è°¢
687,windowsä¸Šçš„canal serverä¼šä¸æ—¶çš„æŠ¥é”™ï¼šè¿œç¨‹ä¸»æœºå¼ºè¿«å…³é—­äº†ä¸€ä¸ªç°æœ‰çš„è¿æ¥ã€‚ æŠ¥é”™çš„æ—¥å¿—æ˜¯instanceçš„æ—¥å¿— canalæ—¥å¿—æ²¡æœ‰æŠ¥é”™ï¼›stackæ—¥å¿—å¦‚ä¸‹ï¼š 2018-06-11 19:21:30.110 [New I/O server worker #1-1] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x0c80035e  /10.204.241.135:58426 => /10.204.241.135:11111]  exception=java.io.IOException: è¿œç¨‹ä¸»æœºå¼ºè¿«å…³é—­äº†ä¸€ä¸ªç°æœ‰çš„è¿æ¥ã€‚ 	at sun.nio.ch.SocketDispatcher.write0(Native Method) 	at sun.nio.ch.SocketDispatcher.write(Unknown Source) 	at sun.nio.ch.IOUtil.writeFromNativeBuffer(Unknown Source) 	at sun.nio.ch.IOUtil.write(Unknown Source) 	at sun.nio.ch.SocketChannelImpl.write(Unknown Source) 	at org.jboss.netty.channel.socket.nio.SocketSendBufferPool$PooledSendBuffer.transferTo(SocketSendBufferPool.java:243) 	at org.jboss.netty.channel.socket.nio.NioWorker.write0(NioWorker.java:470) 	at org.jboss.netty.channel.socket.nio.NioWorker.writeFromUserCode(NioWorker.java:388) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:137) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76) 	at org.jboss.netty.channel.Channels.write(Channels.java:611) 	at org.jboss.netty.channel.Channels.write(Channels.java:578) 	at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:28) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:144) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:444) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:350) 	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:281) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:201) 	at org.jboss.netty.util.internal.IoWorkerRunnable.run(IoWorkerRunnable.java:46) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) 	at java.lang.Thread.run(Unknown Source) ä¸»è¦è¿˜æ˜¯è¶…æ—¶æœºåˆ¶å¯¼è‡´ï¼Œ26ç‰ˆæœ¬ä¼šåšä¸€ä¸‹ä¼˜åŒ– https://github.com/alibaba/canal/issues/640ï¼Œå…³æ³¨ä¸€ä¸‹è¿™ä¸ª
686,canal server swapè¢«å æ»¡ï¼Œå¯¼è‡´ç£ç›˜ç©ºé—´100%ä½¿ç”¨ å¦‚é¢˜ï¼Œv1.0.26 alpha 2ç‰ˆæœ¬ canal server swapè¢«å æ»¡ï¼Œå¯¼è‡´ç£ç›˜ç©ºé—´100%ä½¿ç”¨ swapå†…å­˜ï¼Ÿ %Cpu(s):  0.2 us   0.2 sy   0.0 ni  99.6 id   0.0 wa   0.0 hi   0.0 si   0.0 st KiB Mem:   8193776 total   8050240 used    143536 free     87860 buffers KiB Swap:        0 total         0 used         0 free   6344652 cached canal serverçš„è¿™ä¸ªswap cached åªå¢ä¸å‡ï¼Œå¯¼è‡´æœ€ç»ˆç£ç›˜ç©ºé—´ä½¿ç”¨ç‡ä¸º100% å½“å‰ï¼šrootfs           60G   12G   46G  20% / é‡å¯canal serverä»¥åï¼Œswap cachedä¸º0ï¼Œç£ç›˜ç©ºé—´æ¢å¤æ­£å¸¸ï¼Œç„¶åå°±å¼€å§‹ä¸‹ä¸€è½®åªå¢ä¸å‡çš„è¿‡ç¨‹äº†
685,æ•°æ®åº“è¿æ¥é—®é¢˜ @agapple  ä½ å¥½!æˆ‘ç°åœ¨åŸºäºV25 å–æ¶ˆäº†å®¢æˆ·ç«¯ æ”¹ä¸ºeventStore2Kafka;ç°åœ¨æ•°æ®åº“è¿æ¥å‡ºäº†é—®é¢˜!ä½ èƒ½å¸®å¿™çœ‹ä¸€ä¸‹å—? ![gf vm9d xhrh z s5 f ps](https://user-images.githubusercontent.com/24663485/41216549-63ed2b40-6d87-11e8-99d9-d1c750d0d7d9.png) 
684,å¼€å¯detectingï¼Œç»å¸¸æŠ¥Connection reset by peer çœ‹åˆ°å…¶ä»–issueè¯´å»ºè®®å¼€å¯å¿ƒè·³ï¼Œæ‰€ä»¥æŠŠå®ƒå¼€å¯ canal.instance.detecting.enable =true canal.instance.detecting.heartbeatHaEnable = true ç»“æœå¾ˆå®¹æ˜“å‡ºé”™ï¼ŒæŠ¥é”™æ—¶ä¸å½±å“æ•°æ®æ•è·ï¼Œç¬¬äºŒå¤©å†çœ‹å°±æ— æ³•æ•è·æ•°æ®ã€‚å…³é—­åæ­£å¸¸ã€‚ 1.0.25ç‰ˆæœ¬ï¼Œæˆ‘çš„è¿™ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯falseï¼Œè¿˜æ˜¯ä¸ç¨³å®šï¼Œæˆ‘è¿™æ˜¯å®¢æˆ·ç«¯é—´éš”ä¸€æ®µæ—¶é—´è¿ï¼ŒæœåŠ¡ç«¯å°±ä¼šå‡ºConnection reset by peerï¼Œä½†ä¹Ÿä¸æ˜¯å¿…å‡ºç°ï¼Œåœ¨æˆ‘ä»¬çš„Î±ç¯å¢ƒå‡ºï¼Œåœ¨æˆ‘æœ¬åœ°æµ‹è¯•äº†ä¸€ä¸‹åˆï¼Œå°±ä¸å‡ºè¿™ä¸ªé”™ å»ºè®®æ›´æ–°åˆ°26ç‰ˆæœ¬çš„ https://github.com/alibaba/canal/issues/640ï¼Œå…³æ³¨ä¸€ä¸‹è¿™ä¸ª
683,æ±‚é—®ï¼šv1.0.26 alpha 2ç‰ˆæœ¬å‡ºç°æ¶ˆè´¹å †ç§¯ï¼Œå¹¶ä¸”serverç«¯ç£ç›˜è¢«å æ»¡ å¦‚é¢˜ï¼Œæ±‚é—®ï¼Œåœ¨v1.0.26 alpha 2ç‰ˆæœ¬ï¼Œæ˜¨å¤©æœ‰å¤§æ¦‚å››ä¸ªå°æ—¶çš„æ—¶é—´ï¼Œå‘ç°canalæ¶ˆè´¹å‡ºç°å»¶è¿Ÿ(å³å½“å‰æ¶ˆè´¹çš„æ•°æ®ä¸»è¦æ˜¯updateæ•°æ®ï¼Œå‡ºç°å»¶è¿Ÿï¼Œæ˜¯ä¸¤å°æ—¶å‰å·²ç»æ›´æ–°çš„æ•°æ®åº“ï¼Œç„¶åcanal clientæ‰æ¶ˆè´¹åˆ°ã€‚ï¼ˆinsertæ•°æ®æ²¡æœ‰é—®é¢˜ï¼‰)å¦å¤–canal serverçš„ç£ç›˜ä¸çŸ¥é“æ˜¯è¢«é‚£ä¸ªæ–‡ä»¶ç»™å æ»¡äº†ã€‚é‡å¯serveråï¼Œç£ç›˜ç©ºé—´æ¢å¤æ­£å¸¸ï¼Œä½†å½“æ—¶æœåŠ¡å¹¶æœªæ¢å¤ï¼Œä¸€æ®µæ—¶é—´åè‡ªåŠ¨æ¢å¤äº†ã€‚ä¹Ÿæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ¥é”™ï¼Œæ‰€ä»¥æƒ³è¯·æ•™ä¸‹å¤§å®¶æœ‰æ²¡æœ‰é‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼Œä»¥åŠå‡ºç°é—®é¢˜çš„åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Œå¤šè°¢
682,Fix #631 Boolean java type support tks
681,fix issue #680 [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=681) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=681) before we can accept your contribution.<br/><hr/>**winger** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=681) it.</sub> [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=681) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=681) before we can accept your contribution.<br/><hr/>**winger** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=681) it.</sub> è¿™å—ä¸»å¹²å·²ç»ä¿®å¤äº†ï¼Œéè¿™æ ·çš„æ”¹åŠ¨æ¨¡å¼
680,å½“table çš„unique key æ˜¯"éæ ‡å‡†"å­—æ®µåæ—¶ï¼Œtsdbè§£æå‡ºé”™ å¦‚ä¸‹å›¾æ‰€ç¤ºè¡¨ç»“æ„: ![image](https://user-images.githubusercontent.com/33280738/41092395-58152322-6a7b-11e8-9d54-3208c4863e27.png) canal é€šè¿‡fastsql è§£æå‡ºæ¥çš„ç»“æœå¦‚ä¸‹ï¼š ![image](https://user-images.githubusercontent.com/33280738/41092506-9d2a60bc-6a7b-11e8-918b-407415af0e6d.png) è€Œæ­¤æ—¶ canal é€šè¿‡ `name(200)`æ¯”å¯¹å†…å­˜ä¸å®é™…è¡¨å­—æ®µæ—¶å°±ä¼šå‡ºç°å­—æ®µåå¯¹åº”ä¸ä¸Šçš„é—®é¢˜ã€‚ ä¸‹è½½æœ€æ–°çš„1.0.26å‘å¸ƒåŒ…
679,Merge pull request #1 from alibaba/master merge from master [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=679) <br/>All committers have signed the CLA. [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=679) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=679) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=679) it.</sub>
678,com.alibaba.otter.canal.parse.exception.CanalParseException: can't find start position for example ![image](https://user-images.githubusercontent.com/9798724/41083138-0893606a-6a63-11e8-89e7-9fad84702144.png) ![image](https://user-images.githubusercontent.com/9798724/41083182-1f12c8f8-6a63-11e8-81f8-66bb0c8e52d3.png) æ‰¾ä¸åˆ°åˆé€‚çš„ä½ç‚¹
677,canal.instance.gtidon è¯¥æœ‰ç¼ºçœå€¼ï¼Œä¸èƒ½å¼ºåˆ¶è¦æ±‚é…ç½®ä¿è¯å‘å‰å…¼å®¹ ç‰ˆæœ¬: v1.0.26 alpha 3 2018-06-07 12:25:29.861 [main] ERROR c.a.o.c.common.zookeeper.running.ServerRunningMonitor - start failed com.google.common.collect.ComputationException: com.alibaba.otter.canal.common.CanalException: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'instance' defined in class path resource [spring/default-instance.xml]: Cannot resolve reference to bean 'eventParser' while setting bean property 'eventParser'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'eventParser' defined in class path resource [spring/default-instance.xml]: Initialization of bean failed; nested exception is org.springframework.beans.TypeMismatchException: Failed to convert property value of type 'java.lang.String' to required type 'boolean' for property 'isGTIDMode'; nested exception is java.lang.IllegalArgumentException: Invalid boolean value []         at com.google.common.collect.MapMaker$ComputingMapAdapter.get(MapMaker.java:889) ~[guava-18.0.jar:na]         at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.start(CanalServerWithEmbedded.java:98) ~[canal.server-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.deployer.CanalController$2$1.processActiveEnter(CanalController.java:128) ~[canal.deployer-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.common.zookeeper.running.ServerRunningMonitor.processActiveEnter(ServerRunningMonitor.java:245) ~[canal.common-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.common.zookeeper.running.ServerRunningMonitor.initRunning(ServerRunningMonitor.java:150) ~[canal.common-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.common.zookeeper.running.ServerRunningMonitor.start(ServerRunningMonitor.java:104) ~[canal.common-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.deployer.CanalController.start(CanalController.java:415) [canal.deployer-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.deployer.CanalLauncher.main(CanalLauncher.java:38) [canal.deployer-1.0.26-SNAPSHOT.jar:na] Caused by: com.alibaba.otter.canal.common.CanalException: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'instance' defined in class path resource [spring/default-instance.xml]: Cannot resolve reference to bean 'eventParser' while setting bean property 'eventParser'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'eventParser' defined in class path resource [spring/default-instance.xml]: Initialization of bean failed; nested exception is org.springframework.beans.TypeMismatchException: Failed to convert property value of type 'java.lang.String' to required type 'boolean' for property 'isGTIDMode'; nested exception is java.lang.IllegalArgumentException: Invalid boolean value [] Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'instance' defined in class path resource [spring/default-instance.xml]: Cannot resolve reference to bean 'eventParser' while setting bean property 'eventParser'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'eventParser' defined in class path resource [spring/default-instance.xml]: Initialization of bean failed; nested exception is org.springframework.beans.TypeMismatchException: Failed to convert property value of type 'java.lang.String' to required type 'boolean' for property 'isGTIDMode'; nested exception is java.lang.IllegalArgumentException: Invalid boolean value []         at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:334) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE]         at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:108) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE]         at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1417) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE]         at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1158) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE]         at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE]         at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:458) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE]         at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:296) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE]         at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:223) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE]         at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:293) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE]         at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:194) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE]         at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:633) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE]         at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:932) ~[spring-context-3.2.9.RELEASE.jar:3.2.9.RELEASE]
676,è¿™ä¸ªä¹Ÿæ˜¯404å‘€manager.deployer-x.y.z.tar.gz https://github.com/alibaba/otter/releases/download/otter-x.y.z/manager.deployer-x.y.z.tar.gz xyzæ›¿æ¢æˆå…·ä½“ç‰ˆæœ¬
675,serverå¤šä¸ªinstanceåŒæ—¶å¯åŠ¨ï¼Œæ¯æ¬¡åªèƒ½æœ€å¤š5ä¸ªå·¥ä½œ ä¸€å°canal server éƒ¨ç½²äº†15ä¸ªinstanceï¼Œæ¯æ¬¡èµ·æ¥åªæœ‰5ä¸ªinstanceèƒ½è·å–åˆ°ä½ç‚¹ä¿¡æ¯ã€‚è€Œä¸”é‡å¯è¿™äº”ä¸ªä¸å›ºå®šã€‚ æœ‰å…¶ä¸­ä¸€ä¸ªæŠ¥SHOW VIEW commandæ²¡æƒé™ï¼Œéœ€è¦ç»™è´¦å·å¼€è¿™ä¸ªæƒé™ï¼Ÿ æ–‡æ¡£é‡Œåªæåˆ°selectï¼Œreplication slaveï¼Œreplication clientæƒé™ 2018-06-06 19:18:22.458 [destination = mysql.05.upanb.cn   address = mysql.05.upanb.cn/192.168.250.214:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address mysql.05.upanb.cn/192.168.250.214:3306 has an error  retrying. caused by com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: ErrorPacket [errorNumber=1142  fieldCount=-1  message=SHOW VIEW command denied to user 'canal'@'192.168.249.54' for table 'taglist'  sqlState=42000  sqlStateMarker=#] with command: show create table `pointstore`.`admin`;show create table `pointstore`.`blacklist`;show create table `pointstore`.`clearuk`;show create table `pointstore`.`duibaorder`;show create table `pointstore`.`point_detail_description`;show create table `pointstore`.`returnpoint`;show create table `pointstore`.`s_admin`;show create table `pointstore`.`t_adminlog`;show create table `pointstore`.`t_broker`;show create table `pointstore`.`t_broker_copy`;show create table `pointstore`.`t_brokercompany`;show create table `pointstore`.`t_exchangerule`;show create table `pointstore`.`t_luckproduct`;show create table `pointstore`.`t_luckrecord`;show create table `pointstore`.`t_luckrecord2`;show create table `pointstore`.`t_luckrecord3`;show create table `pointstore`.`t_luckrecord4`;show create table `pointstore`.`t_oauthinfo`;show create table `pointstore`.`t_oauthinfo_bak1`;show create table `pointstore`.`t_oauthinfo_copy`;show create table `pointstore`.`t_pointactivity`;show create table `pointstore`.`t_pointdetail_new`;show create table `pointstore`.`t_pointmain_new`;show create table `pointstore`.`t_pointmain_new_20180212`;show create table `pointstore`.`t_pointmain_new_bak`;show create table `pointstore`.`t_pointmain_new_copy`;show create table `pointstore`.`t_pointproduct`;show create table `pointstore`.`t_pointrule`;show create table `pointstore`.`t_pointsetting`;show create table `pointstore`.`t_pointstoreadminauthority`;show create table `pointstore`.`t_pointstoreinvoice`;show create table `pointstore`.`t_pointstorevisitlog`;show create table `pointstore`.`t_productinventory`;show create table `pointstore`.`t_productpic`;show create table `pointstore`.`t_productscategory`;show create table `pointstore`.`t_productsexchange_new`;show create table `pointstore`.`t_productsexpand`;show create table `pointstore`.`t_productshow`;show create table `pointstore`.`t_provincecityarea`;show create table `pointstore`.`t_ruletocity`;show create table `pointstore`.`taglist`;show create table `pointstore`.`test`;show create table `pointstore`.`timelist`;show create table `pointstore`.`v_brokerpoint`;show create table `pointstore`.`v_luckrecord`;show create table `pointstore`.`v_pointstoreinvoicetotal`;show create table `pointstore`.`v_pointstoreinvoicetotal_a`;show create table `pointstore`.`v_productshow`;show create table `pointstore`.`v_productshowlist`;show create table `pointstore`.`v_productwarehouse`;show create table `pointstore`.`yearlist`; Caused by: java.io.IOException: ErrorPacket [errorNumber=1142  fieldCount=-1  message=SHOW VIEW command denied to user 'canal'@'192.168.249.54' for table 'taglist'  sqlState=42000  sqlStateMarker=#] 2018-06-06 19:18:22.459 [destination = mysql.05.upanb.cn   address = mysql.05.upanb.cn/192.168.250.214:3306   EventParser] INFO c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - disConnect MysqlConnection to mysql.05.upanb.cn/192.168.250.214:3306... 2018-06-06 19:18:22.459 [destination = mysql.05.upanb.cn   address = mysql.05.upanb.cn/192.168.250.214:3306   EventParser] INFO c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - disConnect MysqlConnection to mysql.05.upanb.cn/192.168.250.214:3306.. tsdbç»å¸¸æŠ¥é”™ï¼Œå¯ä»¥ä¸ç”¨å—ï¼Ÿ 2018-06-07 00:44:16.671 [destination = mysql.13.upanb.cn   address = mysql.13.upanb.cn/192.168.250.226:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - pls submit github issue  show create table ddl:CREATE TABLE `group_order_history_detail_new` (   `result_id` int(11) NOT NULL DEFAULT '0' COMMENT 'è®¢å•å·'   `year` int(11) NOT NULL DEFAULT '2018' COMMENT 'å¹´'   `month` int(11) NOT NULL DEFAULT '2' COMMENT 'æœˆ'   `order_id` int(11) NOT NULL DEFAULT '0' COMMENT 'è®¢å•ä¸­å¿ƒå•å·'   `product_id` int(11) NOT NULL DEFAULT '0' COMMENT 'é¡¹ç›®ID'   `product_name` varchar(50) NOT NULL DEFAULT '' COMMENT 'é¡¹ç›®åç§°'   `broker_id` int(11) NOT NULL DEFAULT '0' COMMENT 'ç»çºªäººID'   `broker_name` varchar(50) NOT NULL DEFAULT '' COMMENT 'ç»çºªäººåå­—'   `broker_phone` varchar(50) NOT NULL DEFAULT '' COMMENT 'ç»çºªäººç”µè¯å·ç '   `building_id` int(11) NOT NULL DEFAULT '0' COMMENT 'æ¥¼ç›˜ID'   `sale_id` int(11) NOT NULL DEFAULT '0' COMMENT 'é”€å”®ID'   `sale_name` varchar(50) NOT NULL DEFAULT '' COMMENT 'é”€å”®äººå‘˜åç§°'   `sale_group_id` int(11) NOT NULL DEFAULT '0' COMMENT 'é”€å”®å°ç»„ID'   `sale_group_name` varchar(45) NOT NULL DEFAULT '' COMMENT 'é”€å”®å°ç»„åå­—'   `expand_id` int(11) NOT NULL DEFAULT '0' COMMENT 'æ‹“å±•ID'   `expand_name` varchar(50) NOT NULL DEFAULT '' COMMENT 'æ‹“å±•äººå‘˜åç§°'   `expand_group_id` int(11) NOT NULL DEFAULT '0' COMMENT 'æ‹“å±•å°ç»„ID'   `expand_group_name` varchar(45) NOT NULL DEFAULT '' COMMENT 'æ‹“å±•å°ç»„åç§°'   `accounts_amount` bigint(20) NOT NULL DEFAULT '0' COMMENT 'åº”æ”¶æ¬¾'   `out_accounts_amount` bigint(20) NOT NULL DEFAULT '0' COMMENT 'åº”ä»˜æ¬¾'   `actual_ascription_amount` bigint(20) NOT NULL DEFAULT '0' COMMENT 'å½’å±æ”¶å…¥ï¼ˆåº”æ”¶-åº”ä»˜ï¼‰'   `sale_actual_ascription_amount` bigint(20) NOT NULL DEFAULT '0' COMMENT 'é”€å”®å½’å±æ”¶å…¥'   `expand_actual_ascription_amount` bigint(20) NOT NULL DEFAULT '0' COMMENT 'æ‹“å±•å½’å±æ”¶å…¥'   `public_amount` bigint(20) NOT NULL DEFAULT '0' COMMENT 'å…¬å…±æ± æ”¶å…¥(å½’å±æ”¶å…¥)'   `cav_accounts_amount` bigint(20) NOT NULL DEFAULT '0' COMMENT 'ä½äº180å¤©çš„å®é™…å·²æ”¶æ¬¾'   `out_cav_accounts_amount` bigint(20) NOT NULL DEFAULT '0' COMMENT 'è¶…è¿‡180å¤©çš„å®é™…å·²æ”¶æ¬¾'   `sale_divide_rate` double(5 4) NOT NULL DEFAULT '0.0000' COMMENT 'é”€å”®æ‹“å±•åˆ†æˆæ¯”ä¾‹'   `subscription_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' ON UPDATE CURRENT_TIMESTAMP COMMENT 'è®¤è´­æ—¶é—´'   `handle_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'å®¢æˆ·æˆäº¤æ—¥æœŸ'   `confirm_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'ä¸Šä¼ å›æ‰§å•æ—¶é—´'   `confirmation_cycle` int(11) NOT NULL DEFAULT '0' COMMENT 'ç¡®è®¤å‘¨æœŸ'   `sale_actual_accounts_amount` bigint(20) NOT NULL DEFAULT '0' COMMENT 'é”€å”®å°ç»„åº”æ”¶é‡‘é¢'   `sale_actual_cav_accounts_amount` bigint(20) NOT NULL DEFAULT '0' COMMENT 'é”€å”®å°ç»„å·²æ”¶é‡‘é¢'   `expand_actual_accounts_amount` bigint(20) NOT NULL DEFAULT '0' COMMENT 'æ‹“å±•å°ç»„åº”æ”¶é‡‘é¢'   `expand_actual_cav_accounts_amount` bigint(20) NOT NULL DEFAULT '0' COMMENT 'æ‹“å±•å°ç»„å·²æ”¶é‡‘é¢'   `is_baoxiao` tinyint(4) NOT NULL DEFAULT '0' COMMENT 'è®¢å•æ˜¯å¦åŒ…é”€ éåŒ…é”€ 0 åŒ…é”€ 1 ç±»åŒ…é”€'   `actual_cost` bigint(20) NOT NULL DEFAULT '0' COMMENT 'å®é™…é”€å”®è´¹ç”¨ï¼ˆå®é™…æ˜“å¿«æŠ¥ä¸­ææŠ¥ç”³è¯·æ”¯ä»˜çš„ä¸šç»©ææˆé‡‘é¢ï¼‰'   `fixed_amount` bigint(20) NOT NULL DEFAULT '0' COMMENT 'å›ºå®šæ”¶ç›Š'   `cav_fixed_amount` bigint(20) NOT NULL DEFAULT '0' COMMENT 'å·²å›å›ºå®šæ”¶ç›Š'   `receivable_commission` bigint(20) NOT NULL DEFAULT '0' COMMENT 'åº”æ”¶ä½£é‡‘'   `cav_commission` bigint(20) NOT NULL DEFAULT '0' COMMENT 'å·²å›ä½£é‡‘'   `pay_commission` bigint(20) NOT NULL DEFAULT '0' COMMENT 'åº”ä»˜ä½£é‡‘'   `cav_commission` bigint(20) NOT NULL DEFAULT '0' COMMENT 'å·²å›ä½£é‡‘'   `pay_commission` bigint(20) NOT NULL DEFAULT '0' COMMENT 'åº”ä»˜ä½£é‡‘'   `receivable_deal` bigint(20) NOT NULL DEFAULT '0' COMMENT 'åº”æ”¶æˆäº¤å¥–'   `cav_deal` bigint(20) NOT NULL DEFAULT '0' COMMENT 'å·²å›æˆäº¤å¥–'   `pay_deal` bigint(20) NOT NULL DEFAULT '0' COMMENT 'åº”ä»˜æˆäº¤å¥–'   `receivable_jump` bigint(20) NOT NULL DEFAULT '0' COMMENT 'åº”æ”¶è·³ç‚¹'   `cav_jump` bigint(20) NOT NULL DEFAULT '0' COMMENT 'å·²å›è·³ç‚¹'   `pay_jump` bigint(20) NOT NULL DEFAULT '0' COMMENT 'åº”ä»˜è·³ç‚¹'   `receivable_premium` bigint(20) NOT NULL DEFAULT '0' COMMENT 'åº”æ”¶æº¢ä»·'   `cav_premium` bigint(20) NOT NULL DEFAULT '0' COMMENT 'å·²å›æº¢ä»·'   `pay_premium` bigint(20) NOT NULL DEFAULT '0' COMMENT 'åº”ä»˜æº¢ä»·'   `create_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´'   `close_time` timestamp NULL DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP COMMENT 'è®¢å•å…³é—­æ—¶é—´'   `is_close` tinyint(4) NOT NULL DEFAULT '0' COMMENT '0ï¼šè®¢å•æœªå…³é—­ï¼Œ1ï¼šè®¢å•å…³é—­'   `sys_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'ç³»ç»Ÿæ—¶é—´'   `is_delete` tinyint(4) NOT NULL DEFAULT '0' COMMENT 'æ˜¯å¦åˆ é™¤ 0:æœªåˆ é™¤ 1ï¼šåˆ é™¤'   UNIQUE KEY `index` (`result_id` `year` `month`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8   compare failed .  db : TableMeta [schema=tops_data_gdm  table=group_order_history_detail_new  fileds=         FieldMeta [columnName=result_id  columnType=int(11)  defaultValue=0  nullable=false  key=true]         FieldMeta [columnName=year  columnType=int(11)  defaultValue=2018  nullable=false  key=true]         FieldMeta [columnName=month  columnType=int(11)  defaultValue=2  nullable=false  key=true]         FieldMeta [columnName=order_id  columnType=int(11)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=product_id  columnType=int(11)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=product_name  columnType=varchar(50)  defaultValue=  nullable=false  key=false]         FieldMeta [columnName=broker_id  columnType=int(11)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=broker_name  columnType=varchar(50)  defaultValue=  nullable=false  key=false]         FieldMeta [columnName=broker_phone  columnType=varchar(50)  defaultValue=  nullable=false  key=false]         FieldMeta [columnName=building_id  columnType=int(11)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=sale_id  columnType=int(11)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=sale_name  columnType=varchar(50)  defaultValue=  nullable=false  key=false]         FieldMeta [columnName=sale_group_id  columnType=int(11)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=sale_group_name  columnType=varchar(45)  defaultValue=  nullable=false  key=false]         FieldMeta [columnName=expand_id  columnType=int(11)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=expand_name  columnType=varchar(50)  defaultValue=  nullable=false  key=false]         FieldMeta [columnName=expand_group_id  columnType=int(11)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=expand_group_name  columnType=varchar(45)  defaultValue=  nullable=false  key=false]         FieldMeta [columnName=accounts_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=out_accounts_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=actual_ascription_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=sale_actual_ascription_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=expand_actual_ascription_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=public_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=cav_accounts_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=out_cav_accounts_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]   FieldMeta [columnName=cav_accounts_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=out_cav_accounts_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=sale_divide_rate  columnType=double(5 4)  defaultValue=0.0000  nullable=false  key=false]         FieldMeta [columnName=subscription_time  columnType=timestamp  defaultValue=0000-00-00 00:00:00  nullable=false  key=false]         FieldMeta [columnName=handle_time  columnType=timestamp  defaultValue=CURRENT_TIMESTAMP  nullable=false  key=false]         FieldMeta [columnName=confirm_time  columnType=timestamp  defaultValue=CURRENT_TIMESTAMP  nullable=false  key=false]         FieldMeta [columnName=confirmation_cycle  columnType=int(11)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=sale_actual_accounts_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=sale_actual_cav_accounts_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=expand_actual_accounts_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=expand_actual_cav_accounts_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=is_baoxiao  columnType=tinyint(4)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=actual_cost  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=fixed_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=cav_fixed_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=receivable_commission  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=cav_commission  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=pay_commission  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=receivable_deal  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=cav_deal  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=pay_deal  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=receivable_jump  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=cav_jump  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=pay_jump  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=receivable_premium  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=cav_premium  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=pay_premium  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=create_time  columnType=timestamp  defaultValue=CURRENT_TIMESTAMP  nullable=false  key=false]         FieldMeta [columnName=close_time  columnType=timestamp  defaultValue=null  nullable=true  key=false]         FieldMeta [columnName=is_close  columnType=tinyint(4)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=sys_time  columnType=timestamp  defaultValue=CURRENT_TIMESTAMP  nullable=false  key=false]         FieldMeta [columnName=is_delete  columnType=tinyint(4)  defaultValue=0  nullable=false  key=false] ]  mem : TableMeta [schema=tops_data_gdm  table=group_order_history_detail_new  fileds=         FieldMeta [columnName=result_id  columnType=int(11)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=year  columnType=int(11)  defaultValue=2018  nullable=false  key=false]         FieldMeta [columnName=month  columnType=int(11)  defaultValue=2  nullable=false  key=false]         FieldMeta [columnName=order_id  columnType=int(11)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=product_id  columnType=int(11)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=product_name  columnType=varchar(50)  defaultValue=  nullable=false  key=false]         FieldMeta [columnName=broker_id  columnType=int(11)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=broker_name  columnType=varchar(50)  defaultValue=  nullable=false  key=false]         FieldMeta [columnName=broker_phone  columnType=varchar(50)  defaultValue=  nullable=false  key=false]         FieldMeta [columnName=building_id  columnType=int(11)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=sale_id  columnType=int(11)  defaultValue=0  nullable=false  key=false]   FieldMeta [columnName=building_id  columnType=int(11)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=sale_id  columnType=int(11)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=sale_name  columnType=varchar(50)  defaultValue=  nullable=false  key=false]         FieldMeta [columnName=sale_group_id  columnType=int(11)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=sale_group_name  columnType=varchar(45)  defaultValue=  nullable=false  key=false]         FieldMeta [columnName=expand_id  columnType=int(11)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=expand_name  columnType=varchar(50)  defaultValue=  nullable=false  key=false]         FieldMeta [columnName=expand_group_id  columnType=int(11)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=expand_group_name  columnType=varchar(45)  defaultValue=  nullable=false  key=false]         FieldMeta [columnName=accounts_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=out_accounts_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=actual_ascription_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=sale_actual_ascription_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=expand_actual_ascription_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=public_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=cav_accounts_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=out_cav_accounts_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=sale_divide_rate  columnType=double(5 4)  defaultValue=0.0000  nullable=false  key=false]         FieldMeta [columnName=subscription_time  columnType=timestamp  defaultValue=0000-00-00 00:00:00  nullable=false  key=false]         FieldMeta [columnName=handle_time  columnType=timestamp  defaultValue=CURRENT_TIMESTAMP  nullable=false  key=false]         FieldMeta [columnName=confirm_time  columnType=timestamp  defaultValue=CURRENT_TIMESTAMP  nullable=false  key=false]         FieldMeta [columnName=confirmation_cycle  columnType=int(11)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=sale_actual_accounts_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=sale_actual_cav_accounts_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=expand_actual_accounts_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=expand_actual_cav_accounts_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=is_baoxiao  columnType=tinyint(4)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=actual_cost  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=fixed_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=cav_fixed_amount  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=receivable_commission  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=cav_commission  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=pay_commission  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=receivable_deal  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=cav_deal  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=pay_deal  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=receivable_jump  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=cav_jump  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=pay_jump  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=receivable_premium  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=cav_premium  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=pay_premium  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=create_time  columnType=timestamp  defaultValue=CURRENT_TIMESTAMP  nullable=false  key=false]         FieldMeta [columnName=close_time  columnType=timestamp  defaultValue=null  nullable=true  key=false]         FieldMeta [columnName=is_close  columnType=tinyint(4)  defaultValue=0  nullable=false  key=false]   FieldMeta [columnName=close_time  columnType=timestamp  defaultValue=null  nullable=true  key=false]         FieldMeta [columnName=is_close  columnType=tinyint(4)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=sys_time  columnType=timestamp  defaultValue=CURRENT_TIMESTAMP  nullable=false  key=false]         FieldMeta [columnName=is_delete  columnType=tinyint(4)  defaultValue=0  nullable=false  key=false] ] 2018-06-07 00:59:47.133 [destination = mysql.04.upanb.cn   address = mysql.04.upanb.cn/192.168.250.213:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - pls submit github issue  show create table ddl:CREATE TABLE `tk_broker_tag` (   `broker_id` bigint(20) NOT NULL COMMENT 'ç»çºªäººid'   `tag_id` bigint(20) NOT NULL COMMENT 'æ ‡ç­¾id è¡¨tk_tagçš„ä¸»é”®'   `tag_count` bigint(20) NOT NULL DEFAULT '0' COMMENT 'ç»çºªäººè¢«è¯„ä»·è¯¥æ ‡ç­¾çš„æ¬¡æ•°'   `sys_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP   UNIQUE KEY `IX_broker_tag` (`broker_id` `tag_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4   compare failed .  db : TableMeta [schema=tops_kber  table=tk_broker_tag  fileds=         FieldMeta [columnName=broker_id  columnType=bigint(20)  defaultValue=null  nullable=false  key=true]         FieldMeta [columnName=tag_id  columnType=bigint(20)  defaultValue=null  nullable=false  key=true]         FieldMeta [columnName=tag_count  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=sys_time  columnType=timestamp  defaultValue=CURRENT_TIMESTAMP  nullable=false  key=false] ]  mem : TableMeta [schema=tops_kber  table=tk_broker_tag  fileds=         FieldMeta [columnName=broker_id  columnType=bigint(20)  defaultValue=null  nullable=false  key=false]         FieldMeta [columnName=tag_id  columnType=bigint(20)  defaultValue=null  nullable=false  key=false]         FieldMeta [columnName=tag_count  columnType=bigint(20)  defaultValue=0  nullable=false  key=false]         FieldMeta [columnName=sys_time  columnType=timestamp  defaultValue=CURRENT_TIMESTAMP  nullable=false  key=false] ] ä½ è¿™æ˜¯å•¥ç‰ˆæœ¬ï¼Ÿæ–°çš„ç‰ˆæœ¬å·²ç»ä¿®å¤è¿‡è¿™ä¸ªé—®é¢˜ 1.0.25 Neal Hu nealhu@apache.org > åœ¨ 2018å¹´6æœˆ7æ—¥ï¼Œ09:51ï¼Œagapple <notifications@github.com> å†™é“ï¼š >  > ä½ è¿™æ˜¯å•¥ç‰ˆæœ¬ï¼Ÿæ–°çš„ç‰ˆæœ¬å·²ç»ä¿®å¤è¿‡è¿™ä¸ªé—®é¢˜ >  > â€” > You are receiving this because you authored the thread. > Reply to this email directly  view it on GitHub  or mute the thread. ä½¿ç”¨æœ€æ–°çš„1.0.26
674,v1.0.26 alpha 2ç‰ˆæœ¬clientæœ‰å¯¹åº”mavenåº“çš„jaråŒ…ï¼Ÿåœ¨å“ªä¸ªmavenåº“ä¸­å‘¢ï¼Ÿ ![image](https://user-images.githubusercontent.com/9798724/41032611-83024bf2-69b6-11e8-89fd-542e572f7ed1.png) ä¸‹è½½ä»£ç è¿›è¡Œæœ¬åœ°clean installå§ 
673,æœ¬åœ°æµ‹è¯•è¿æ¥è¿œç¨‹canalä¼¼ä¹æ²¡æœ‰è·å¾—æ¶ˆæ¯ æˆ‘åœ¨æœ¬åœ°ä½¿ç”¨canalæœåŠ¡æ—¶ï¼Œå‘ç°å¯ä»¥æ”¶åˆ°æ¶ˆæ¯ã€‚ åœ¨ä¸€å°è¿œç¨‹æœåŠ¡å™¨ä¸Šä½¿ç”¨canalæ—¶ï¼Œæœ¬åœ°ä¼¼ä¹ä¸€ç›´æ²¡æœ‰æ”¶åˆ°æ¶ˆæ¯ã€‚ `CanalConnectors.newSingleConnector(new InetSocketAddress("xxx.xxx.xxx.xxx"  11111)  "example"  ""  "");` åœ¨æœ¬åœ°æ¯æ¬¡è¿æ¥è¿œç¨‹ï¼Œåœ¨example/example.logé‡Œå¯ä»¥çœ‹åˆ°è¿™æ ·çš„æ—¥å¿— `2018-06-06 17:57:15.309 [New I/O server worker #1-1] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - subscribe filter change to .*\..*` è¿™æ ·çœ‹èµ·æ¥åº”è¯¥å·²ç»è¿æ¥åˆ°è¿œç¨‹çš„cannalæœåŠ¡ã€‚ä½†æ˜¯æœ¬åœ°ä¸€ç›´æ²¡æœ‰æ”¶åˆ°bin-logæ¶ˆæ¯ã€‚ canal logçœ‹äº†å—ï¼Ÿæœ‰é”™è¯¯å—ï¼Ÿ ä»Šå¤©æ—©ä¸Šé‡æ–°æ¢äº†1.0.26-alpha3ï¼Œåœ¨ä¸€å°MySQL5.6.40ä¸Šå·²ç»æ²¡æœ‰é—®é¢˜ã€‚æœ¬åœ°æµ‹è¯•çœ‹èµ·æ¥å·²ç»æ²¡æœ‰ä»€ä¹ˆé—®é¢˜äº†ã€‚åœ¨å¦å¤–ä¸€å°æœåŠ¡å™¨ä¸Šé‡æ–°ä¸‹è½½ç›¸åŒç‰ˆæœ¬çš„canalï¼Œå‘ç°MySQL5.7.21ä¼¼ä¹ä¸å¤ªç¨³å®šï¼Œæœ‰æ—¶å€™æœ¬åœ°å¯ä»¥æ”¶åˆ°æ¶ˆæ¯ï¼Œä½†å¤§éƒ¨åˆ†æ—¶é—´æ˜¯ä¸è¡Œçš„ã€‚ä¸çŸ¥é“ä¸5.7.21æ˜¯å¦å¯¹äºcanalæœ‰å…¼å®¹æ€§é—®é¢˜ï¼Ÿ çœ‹ä¸€ä¸‹canal serverçš„æ—¥å¿—ï¼Œæ˜¯å¦æœ‰ä¸€äº›é“¾æ¥æˆ–è€…è§£æå¼‚å¸¸ **example.log** ``` 2018-06-07 11:03:51.958 [Thread-4] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - stop successful.... 2018-06-07 11:04:30.064 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [canal.properties] 2018-06-07 11:04:30.068 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [example/instance.properties] 2018-06-07 11:04:30.218 [main] WARN  o.s.beans.GenericTypeAwarePropertyDescriptor - Invalid JavaBean property 'connectionCharset' being accessed! Ambiguous write methods found next to actually used [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.nio.charset.Charset)]: [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.lang.String)] 2018-06-07 11:04:30.268 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [canal.properties] 2018-06-07 11:04:30.268 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [example/instance.properties] 2018-06-07 11:04:30.493 [main] ERROR com.alibaba.druid.pool.DruidDataSource - testWhileIdle is true  validationQuery not set 2018-06-07 11:04:30.769 [main] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start CannalInstance for 1-example  2018-06-07 11:04:30.882 [main] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - subscribe filter change to .*\..* 2018-06-07 11:04:30.882 [main] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - start successful.... 2018-06-07 11:04:30.908 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position  {"identity":{"slaveId":-1 "sourceAddress":{"address":"localhost" "port":3306}} "postion":{"gtid":"" "included":false "journalName":"mysql-bin.000002" "position":5818 "serverId":1 "timestamp":1528340336000}} 2018-06-07 11:04:31.332 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - find start position : EntryPosition[included=false journalName=mysql-bin.000002 position=5818 serverId=1 gtid= timestamp=1528340336000] 2018-06-07 11:05:17.176 [New I/O server worker #1-2] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - subscribe filter change to .*\..* 2018-06-07 11:07:50.895 [New I/O server worker #1-3] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - subscribe filter change to .*\..* ``` **canal.log** ``` 2018-06-07 11:03:51.829 [Thread-4] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## stop the canal server 2018-06-07 11:03:51.962 [Thread-4] INFO  com.alibaba.otter.canal.deployer.CanalController - ## stop the canal server[IPä¿å¯†å¤„ç†:11111] 2018-06-07 11:03:51.962 [Thread-4] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## canal server is down. Java HotSpot(TM) 64-Bit Server VM warning: ignoring option PermSize=96m; support was removed in 8.0 Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=256m; support was removed in 8.0 Java HotSpot(TM) 64-Bit Server VM warning: UseCMSCompactAtFullCollection is deprecated and will likely be removed in a future release. 2018-06-07 11:04:29.664 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## set default uncaught exception handler 2018-06-07 11:04:29.707 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## load canal configurations 2018-06-07 11:04:29.707 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## start the canal server. 2018-06-07 11:04:29.749 [main] INFO  com.alibaba.otter.canal.deployer.CanalController - ## start the canal server[IPä¿å¯†å¤„ç†:11111] 2018-06-07 11:04:30.218 [main] WARN  o.s.beans.GenericTypeAwarePropertyDescriptor - Invalid JavaBean property 'connectionCharset' being accessed! Ambiguous write methods found next to actually used [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.nio.charset.Charset)]: [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.lang.String)] 2018-06-07 11:04:30.493 [main] ERROR com.alibaba.druid.pool.DruidDataSource - testWhileIdle is true  validationQuery not set 2018-06-07 11:04:30.908 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position  {"identity":{"slaveId":-1 "sourceAddress":{"address":"localhost" "port":3306}} "postion":{"gtid":"" "included":false "journalName":"mysql-bin.000002" "position":5818 "serverId":1 "timestamp":1528340336000}} 2018-06-07 11:04:30.933 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## the canal server is running now ...... 2018-06-07 11:04:31.332 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - find start position : EntryPosition[included=false journalName=mysql-bin.000002 position=5818 serverId=1 gtid= timestamp=1528340336000] ``` meta.logçœ‹çœ‹æ¶ˆè´¹çš„æƒ…å†µ é—®é¢˜è§£å†³äº†ã€‚å› ä¸ºMySQL5.7.21è¿™å°æœåŠ¡å™¨ä¸ŠæŸä¸ªJavaç¨‹åºå·²ç»è¿æ¥11111ç«¯å£æ¶ˆè´¹ï¼Œæˆ‘çœ‹äº†æ—¥å¿—å‘ç°æ•°æ®è¢«è¯¥ç¨‹åºæ¶ˆè´¹äº†ã€‚å¯¼è‡´æˆ‘æœ¬åœ°æ¶ˆè´¹ä¸åˆ°ã€‚ æ€»ç»“ç»™å…¶ä»–äººçš„å»ºè®®ï¼š 1ï¼‰ å› ä¸ºæœ¬åœ°æ— æ³•æ¶ˆè´¹è¿œç¨‹canalä¿¡æ¯ï¼Œè¯·å‡çº§åˆ°1.0.26ç‰ˆæœ¬ã€‚å‡çº§åè§£å†³äº†æˆ‘æœ¬åœ°æ— æ³•æ¶ˆè´¹è¿œç¨‹ä¸€å°5.6.40çš„bin-logæ•°æ® 2ï¼‰å¦‚æœå‡çº§åè¿˜æ˜¯æ— æ³•æ¶ˆè´¹æ•°æ®ï¼Œè¯·æ£€æŸ¥æ˜¯å¦å…¶ä»–åº”ç”¨æ­£åœ¨æ¶ˆè´¹bin-logæ•°æ® Thanks everyone.
672,Mysqläº§ç”Ÿçš„binlogï¼Œå¤§é‡æ•°æ®çš„æ—¶å€™ï¼ŒåŒæ­¥åˆ°Canalæ…¢ï¼Œè¿™ä¸ªæ€ä¹ˆè§£å†³ï¼Ÿ åšäº†ä¸€äº›å¤§é‡çš„æ•°æ®çš„æµ‹è¯•ï¼Œæ¯”å¦‚æ›´æ–°ä¸€ä¸ª100Wçš„è¡¨ï¼ŒåŒæ­¥åˆ°Canalï¼Œä¼š7-8ç§’æ‰èƒ½åˆ°Canal æˆ‘Getæ•°æ®çš„æ—¶å€™ï¼Œbatchidä¸º-1ï¼Œç„¶åæˆ‘å°±çŒœæƒ³æœåŠ¡ç«¯çš„RingBuffer  doPutåº”è¯¥è¿˜æ²¡æœ‰putåˆ°æ•°æ®ï¼Œæˆ‘æƒ³åº”è¯¥æ˜¯Mysqlåˆ°Canal Serverä¼šæœ‰é˜»å¡çš„è¿‡ç¨‹ï¼Œè¿™ç§æœ‰æ²¡æœ‰åŠæ³•é™é˜»å¡çš„æ—¶é—´ï¼Ÿæ¯”å¦‚mysql5.7çš„å¤šçº¿ç¨‹å¹¶è¡Œçš„æ“ä½œã€‚ å¸®å¿™åˆ†æå‡ ä¸ªè¿‡ç¨‹ï¼Œå†™å…¥åˆ°binlog -> canalæ¥æ”¶åˆ° -> canalè§£æå­˜å‚¨åˆ°memory -> clientæ¥æ”¶ï¼Œçœ‹ä¸€ä¸‹å…·ä½“ç“¶é¢ˆç‚¹ 1. å†™binlogï¼ˆæ¶‰åŠå°IOï¼Œåº”è¯¥é—®é¢˜ä¸å¤§ï¼‰ 2.  canal  ï¼ˆå»fetchçš„æ—¶å€™ç½‘ç»œIOï¼ŒIO/Threadï¼‰ 3. å½“client  è®¾ç½®å–å€¼æ¯”è¾ƒå¤§çš„æ—¶å€™ ä»¥ä¸Šä¸‰ç‚¹è®¾è®¡åˆ°çš„IOæ“ä½œã€‚ æˆ‘ä»¬æœ€è¿‘é€šè¿‡æµ‹è¯•å‘ç°    while (fetcher.fetch())  æ‹‰å–æ•°æ®qpsåœ¨1000çš„æ ·å­  ç”±äºcanalè¯»æ•°æ®æ˜¯å•çº¿ç¨‹çš„ï¼Œå¦‚æœç¬é—´æ’å…¥ç™¾ä¸‡æ•°æ®å¯¹canalå®¢æˆ·ç«¯è¯»å–çš„å»¶é•¿æ€§è¿˜æ˜¯å¾ˆå¤§çš„ï¼Œä¸çŸ¥é“æ¥¼ä¸»è¿™ä¸ªé—®é¢˜è§£å†³äº†å— ä½ ç°åœ¨å»¶è¿Ÿ å¤šä¹… æˆ‘100ä¸‡æ•°æ®å¤§æ¦‚åœ¨25åˆ†å·¦å³ 50Wæ¡æ•°æ® 5åˆ†é’Ÿå·¦å³ 50Wæ¡æ•°æ® 5åˆ†é’Ÿå·¦å³ é‡‡ç”¨çš„å•çº¿ç¨‹æ–¹å¼å—ï¼Ÿ  å°†æ•°æ®åŒæ­¥åˆ°es è¿˜æ˜¯redis  åŠ æˆ‘wx aleenjava æ¢è®¨ä¸€ä¸‹ æˆ‘æ˜¯è¿™æ ·åšçš„ï¼Œå¼€äº†2ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªçº¿ç¨‹ä¸æ–­çš„å–æ•°æ®ï¼Œç„¶åæ”¾åˆ°é˜»å¡é˜Ÿåˆ—ï¼Œç„¶åç¬¬äºŒä¸ªçº¿ç¨‹å°±ä»é˜»å¡é˜Ÿåˆ—æ¶ˆè´¹ï¼Œç„¶åæŒ‰é¡ºåºçš„å‘é€åˆ°MQä¸Šã€‚ @DevWithLin ä½ è¿™è¾¹æ˜¯åŸºäºcanalçš„è§£æï¼Œå®Œæˆäº†å¯¹æ¥kafkaå—ï¼Ÿ æˆ‘è¿™è¾¹ç”¨çš„æ˜¯ åŸºäºé…ç½®ç•Œé¢çš„ç›®å‰å¯å¯¹æ¥rabbitmqå’Œactivemqï¼Œkafkaæ²¡æœ‰ç”¨å‘¢  åç»­ä¼šå®Œæˆkafkaã€‚ @agapple  æˆ‘è¿˜æ‰“ç®— è®©canalClientæ”¯æŒä¸‹Sky-Walking. æˆ‘æ˜¯è¿™æ ·åšçš„ï¼Œå¼€äº†2ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªçº¿ç¨‹ä¸æ–­çš„å–æ•°æ®ï¼Œç„¶åæ”¾åˆ°é˜»å¡é˜Ÿåˆ—ï¼Œç„¶åç¬¬äºŒä¸ªçº¿ç¨‹å°±ä»é˜»å¡é˜Ÿåˆ—æ¶ˆè´¹ï¼Œç„¶åæŒ‰é¡ºåºçš„å‘é€åˆ°MQä¸Šã€‚ è¿™å’Œå•çº¿ç¨‹æ¶ˆè´¹é¡ºåºå‘é€åˆ°MQ ä¸Šæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ å½“MQå‘é€è€—æ—¶å¤§äºä»Canal Server Getæ•°æ®çš„æ—¶å€™ï¼Œè¿™å°±å¾ˆæœ‰æ„ä¹‰äº†ã€‚ ä»£ç åœ¨å“ªé‡Œ æ–¹é¢åˆ†äº«ä¸€ä¸‹å—ï¼Ÿ å¥½ç®€å•çš„ï¼Œéƒ½ä¸ç”¨ä»£ç çš„å•Šã€‚å¼€ä¸¤ä¸ªçº¿ç¨‹ä¸€ä¸ªé˜»å¡é˜Ÿåˆ—ï¼Œæ¨¡æ‹Ÿç”Ÿäº§æ¶ˆè´¹ã€‚ æˆ‘å°±æ˜¯ç”¨è¿™ç§æ–¹å¼ å®ç°çš„ æ²¡è¾¾åˆ°ä½ è¯´å¾—æ•ˆæœ 100ä¸‡æ•°æ®å¤§æ¦‚ 20åˆ†é’Ÿ æˆ‘è¿™è¾¹å¾ˆå¿«å•Š~ ä½ å‘åˆ°å“ªé‡Œçš„ï¼Ÿ å†™å…¥åˆ°es ä¸­ å†™å…¥kafkaçš„è¯ è·Ÿmaxwellå·®ä¸å¤šï¼Ÿ  @chenglinjava68  ä¼°è®¡æ˜¯ ESçš„ç“¶é¢ˆå§ï¼Œæˆ‘å†™rabbitmqçš„ï¼Œå¹³å‡8000å¤šä¸ªæ¶ˆæ¯ã€‚ æ¯ç§’8000? æœ‰ç‚¹å¤¸å¼ äº†å§
671,canal v1.0.25ç‰ˆæœ¬æŠ¥é”™java.nio.channels.ClosedByInterruptException: null 2018-06-05 00:50:56.419 [destination = example   address = testrds1.amazonaws.com/10.8.3.18:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address testrds1.corlbeqxlnts.us-west-2.rds.amazonaws.com/10.8.3.180:3306 has an error  retrying. caused by  java.nio.channels.ClosedByInterruptException: null 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannel.read(SocketChannel.java:49) ~[canal.parse.driver-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:151) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:77) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:137) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220) ~[canal.parse-1.0.25.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_144] 2018-06-05 00:50:56.425 [destination = example   address = testrds1.amazonaws.com/10.8.3.18:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.nio.channels.ClosedByInterruptException 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannel.read(SocketChannel.java:49) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:151) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:77) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:137) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220) 	at java.lang.Thread.run(Thread.java:748) ] è¯•è¯• 26ç‰ˆæœ¬çš„ çœ‹ä¸‹[Issue604](https://github.com/alibaba/canal/issues/640)ã€‚
670,æ”¯æŒmongo->esåŒæ­¥ [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=670) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=670) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=670) it.</sub> [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=670) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=670) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=670) it.</sub> 1. è¿™ä¸ªæ”¹åŠ¨æœ‰ç‚¹å¤§ï¼ŒåŒ…å«äº†mongoçš„è§£æå’ŒåŒæ­¥åŠŸèƒ½ï¼Œéƒ¨åˆ†åº”è¯¥æ˜¯æ‹†åˆ†åˆ°clientä»£ç  2. ä»£ç æœ‰ä¸€äº›å†²çª
669,Canal è®¾è®¡åŸºäºServer Clientæ¨¡å¼çš„ç”¨æ„æ˜¯ä»€ä¹ˆï¼Ÿ Canal è®¾è®¡åŸºäºServer Clientæ¨¡å¼çš„ç”¨æ„æ˜¯ä»€ä¹ˆï¼Ÿ åœ¨Serverç«¯ç›´æ¥è§£æbinlogå¹¶æ¶ˆè´¹æ˜¯ä¸æ˜¯æ›´åŠ å¯é ä¸é«˜æ•ˆï¼Ÿ æ¥¼ä¸»è¿™ä¸ªé—®é¢˜å¯ä»¥è¿™æ ·é—®ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿçš„æ„ä¹‰æ˜¯ä»€ä¹ˆ é™¤äº†è®©å¯ç¼–ç¨‹çš„å®¢æˆ·ç«¯æ›´è½»é‡å¤–ï¼Œè¿˜æœ‰ä»€ä¹ˆè€ƒè™‘ï¼ŸserveråŒæ ·å¯ä»¥åšæˆåˆ†å¸ƒå¼ï¼Œç›®å‰ä¹Ÿæ˜¯æ”¯æŒserver haçš„ ä¸ºäº†åšæ–¹ä¾¿è¿ç»´ç®¡ç†ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åµŒå…¥å¼å¸¦å…¥serverï¼Œç›´è¿mysql å¯¹ï¼Œè¿™æ ·çš„æ•ˆç‡å’Œå¯é æ€§ä¼šæ›´é«˜ã€‚æˆ‘ä»¬æ‰“ç®—å°è£…ä¸‹canal clientçš„ä»£ç ï¼Œæ”¯æŒé…ç½®æˆåµŒå…¥å¼serverã€‚å¦å¤–è¿˜æŠ½è±¡äº†å¯æ‰©å±•çš„outconnector spiæœºåˆ¶ï¼Œç›®å‰åšäº†hbaseï¼Œesï¼Œlog4jçš„connectorã€‚åˆ°æ—¶å€™è€ƒè™‘è´¡çŒ®ç»™ç¤¾åŒº éå¸¸æ¬¢è¿æäº¤PR å·²ç»åˆå¹¶äº†å¯¹åº”çš„kafkaç›¸å…³ä»£ç  æ¬¢è¿ä¸‹è½½ï¼šhttps://github.com/alibaba/canal/releases/tag/canal-1.0.26-preview-3
668,Canal Server HAåˆ‡æ¢æ—¶ä¼šåŒæ­¥binlogçš„offsetä¿¡æ¯å—ï¼Ÿ ä¼šçš„ï¼Œå¯ä»¥æŠŠä½ç‚¹è®°å½•åˆ°zookeeperä¸­ åˆ‡æ¢åˆ°default-instance.xml ç”¨zkè®°å½•ä½ç‚¹ä¿¡æ¯å’¯ åˆ‡æ¢åˆ° StandBy DB çš„æ—¶å€™ï¼Œbinlog ä¼šå®Œå…¨å¯¹ä¸ä¸Šï¼Œè¿™ç§æƒ…å†µæ˜¯éœ€è¦äººå·¥å¤„ç†ï¼Ÿä¸€ç›´ä»¥ä¸ºè¿™é‡Œçš„HAæ˜¯è‡ªåŠ¨çš„ï¼Œä½†æ˜¯æƒ³èµ·æ¥ä¸ä¼šé‚£ä¹ˆç®€å•ã€‚ åŸè°…æˆ‘åœ¨è¿™ä¸ªclosed issueç»§ç»­å‘é—®ï¼Œå› ä¸ºæ²¡æœ‰ä¸€ä¸ªå¯ä»¥ç›´æ¥é«˜æ•ˆæ²Ÿé€šçš„åœ°æ–¹ã€‚ã€‚ã€‚
667,canal Broken pipe  çœ‹ä»£ç å¥½åƒæ˜¯å»æ›´æ–°MySQLä¸­çš„meta_snapshotï¼Œ è¿™å¼ è¡¨æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ ## canal æ—¥å¿— ```bash 2018-06-03 21:24:30.826 [[scheduler-table-meta-snapshot]] ERROR c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - scheudle applySnapshotToDB faield com.alibaba.otter.canal.parse.exception.CanalParseException: java.net.SocketException: Broken pipe (Write failed) Caused by: java.net.SocketException: Broken pipe (Write failed)  at java.net.SocketOutputStream.socketWrite0(Native Method) ~[na:1.8.0_171]  at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:111) ~[na:1.8.0_171]  at java.net.SocketOutputStream.write(SocketOutputStream.java:143) ~[na:1.8.0_171]  at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannel.write(BioSocketChannel.java:35) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na]  at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.writeBody0(PacketManager.java:42) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na]  at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.writeBody(PacketManager.java:35) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na]  at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.query(MysqlQueryExecutor.java:55) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na]  at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:94) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]  at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.compareTableMetaDbAndMemory(DatabaseTableMeta.java:296) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]  at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.applySnapshotToDB(DatabaseTableMeta.java:251) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]  at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.access$100(DatabaseTableMeta.java:45) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]  at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta$2.run(DatabaseTableMeta.java:84) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]  at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [na:1.8.0_171]  at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308) [na:1.8.0_171]  at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180) [na:1.8.0_171]  at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294) [na:1.8.0_171]  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_171]  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_171]  at java.lang.Thread.run(Thread.java:748) [na:1.8.0_171] ``` ##canal-client ```bash mory=0.024801254  InstallDirSize=11.233233  LastUpdatetime=2018-05-31 17:01:28.0}]  old=[\{LastUpdatetime=2018-05-31 17:01:23.0}]} 10:11:45.401 [pool-6-thread-1] INFO com.tops001.foundation.canal.connector.CanalLog4JConnector - \{"data":[\{"Id":1 "NodeName":"æ–°å¢èŠ‚ç‚¹" "NodeCreateTime":1484977299000 "NodeIP":"WIN-8RG5KGC1JNM" "NodeLastUpdatetime":1527757293000 "IfCheckState":false}] "database":"tops_bops_task" "old":[\{"NodeLastUpdatetime":1527757288000}] "sql":"" "table":"task_node" "ts":1528078305401 "type":"UPDATE"} 10:11:45.401 [pool-6-thread-1] DEBUG com.tops001.foundation.canal.connector.es.syn.ElasticsearchSynService - Dml\{database='tops_bops_task'  table='task_node'  type='UPDATE'  ts=1528078305401  sql=''  data=[\{Id=1  NodeName=æ–°å¢èŠ‚ç‚¹  NodeCreateTime=2017-01-21 13:41:39.0  NodeIP=WIN-8RG5KGC1JNM  NodeLastUpdatetime=2018-05-31 17:01:33.0  IfCheckState=false}]  old=[\{NodeLastUpdatetime=2018-05-31 17:01:28.0}]} 10:11:45.402 [Thread-12] WARN com.alibaba.otter.canal.client.impl.ClusterCanalConnector - something goes wrong when getWithoutAck data from server:null com.alibaba.otter.canal.protocol.exception.CanalClientException: java.io.IOException: end of stream when reading header  at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:291) ~[canal.client-1.0.26.4.jar!/:?]  at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:264) ~[canal.client-1.0.26.4.jar!/:?]  at com.alibaba.otter.canal.client.impl.ClusterCanalConnector.getWithoutAck(ClusterCanalConnector.java:182) ~[canal.client-1.0.26.4.jar!/:?]  at com.tops001.foundation.canal.service.CanalWorker.process(CanalWorker.java:120) ~[classes!/:?]  at java.lang.Thread.run(Thread.java:748) [?:1.8.0_171] Caused by: java.io.IOException: end of stream when reading header  at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.read(SimpleCanalConnector.java:396) ~[canal.client-1.0.26.4.jar!/:?]  at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.readNextPacket(SimpleCanalConnector.java:384) ~[canal.client-1.0.26.4.jar!/:?]  at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.readNextPacket(SimpleCanalConnector.java:368) ~[canal.client-1.0.26.4.jar!/:?]  at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.receiveMessages(SimpleCanalConnector.java:296) ~[canal.client-1.0.26.4.jar!/:?]  at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:289) ~[canal.client-1.0.26.4.jar!/:?]  ... 4 more 10:11:50.417 [Thread-12] INFO com.alibaba.otter.canal.client.impl.ClusterCanalConnector - restart the connector for next round retry. ``` ä½ å¼€äº†tableçš„table tsdbçš„èƒ½åŠ›ï¼Œè¿™æ˜¯ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œéä¸»çº¿å½±å“clientè¯»å–å¤±è´¥çš„åŸå› 
666,Macç¯å¢ƒä¸‹è‡ªå·±ç¼–è¯‘å‡ºé—®é¢˜ ä¾èµ–è¿™ä¸ªæ–‡ä»¶ï¼Œè·å–ä¸åˆ°ã€‚ http://code.alibabatech.com/mvn/releases/com/alibaba/fastsql/fastsql/2.0.0_preview_228/fastsql-2.0.0_preview_228.pom éº»çƒ¦æŠŠè¿™ä¸ªä¾èµ–æ”¾åˆ°ä¸€ä¸ªå¯é çš„æºä¸Šã€‚ [ERROR] Failed to execute goal on project canal.parse: Could not resolve dependencies for project com.alibaba.otter:canal.parse:jar:1.0.26-SNAPSHOT: Failed to collect dependencies at com.alibaba.fastsql:fastsql:jar:2.0.0_preview_228: Failed to read artifact descriptor for com.alibaba.fastsql:fastsql:jar:2.0.0_preview_228: Could not transfer artifact com.alibaba.fastsql:fastsql:pom:2.0.0_preview_228 from/to alibaba (http://code.alibabatech.com/mvn/releases/): Connect to code.alibabatech.com:80 [code.alibabatech.com/119.38.217.15] failed: Operation timed out -> [Help 1] same here åŒæ · https://github.com/alibaba/canal/releases/tag/canal-1.0.26-preview-3ï¼Œå‘å¸ƒçš„taråŒ…é‡Œæœ‰å¯¹åº”çš„jar.   fastsqlåç»­ä¹Ÿä¼šå¼€æºï¼Œåœ°è¡¨æœ€å¼ºçš„sql parserå·¥å…·ï¼Œmysqlè§£æå…¼å®¹åº¦ç¨‹åº¦æœ€å¥½
665,è¯·é—®canal æ˜¯å¦æ”¯æŒçº§è”å¤åˆ¶? rt å³canal serverä»mysql çš„slaveèŠ‚ç‚¹å¤åˆ¶binlog åº”è¯¥æ˜¯æ”¯æŒçš„  æˆ‘å…ˆæµ‹è¯•ä¸‹ åªè¦mysqlå¼€å¯log_slave_updateçš„ç‰¹æ€§
664,å…³äºä¸¤ä¸ªcanal serveré…åŒä¸€ä¸ªinstanceçš„ç–‘é—® ä¸¤ä¸ªcanal serveråˆ†åˆ«é…ç½®äº†ä¸¤ä¸ªinstanceï¼šexample1å’Œexample2ï¼Œå¯åŠ¨å…¶ä¸­ä¸€ä¸ªcanal serverï¼Œè¿™æ—¶å€™è¿™ä¸ªserverèƒ½å¤ŸåŒæ­¥example1å’Œexample2è¿™ä¸¤ä¸ªåº“çš„æ•°æ®ï¼Œè¿™æ—¶å€™å¯åŠ¨ç¬¬äºŒä¸ªcanal serverï¼Œè¿™æ—¶å€™è¿™ä¸ªserveræ— æ³•æ¶ˆè´¹example1å’Œexample2ï¼Œè¿™ä¸ªæ—¶å€™é›†ç¾¤å°±æ²¡æœ‰å¤ªå¤§æ„ä¹‰äº†ï¼Œcanalæ˜¯å¦å¯ä»¥åšç±»ä¼¼rebalanceä¹‹ç±»çš„æ“ä½œï¼Ÿæ¯”å¦‚rebalanceä¹‹åcanal server1å’Œcanal server2åˆ†åˆ«åŒæ­¥ä¸€ä¸ªåº“çš„æ•°æ®ï¼Ÿ
663,1.0.26  com.alibaba.fastsql.sql.parser.ParserException: TODO pos 545  line 9  column 83  token NULL durid å·²ç»æ‰‹åŠ¨å‡çº§ä¸ºï¼š1.1.9ï¼Œ å¯åŠ¨è¿˜æ˜¯æŠ¥é”™ï¼š ` 2018-05-29 17:29:36.484 [destination = devmysql4308   address = /192.168.100.4:3308   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : /* ApplicationName=IntelliJ IDEA 2017.2.5 */ CREATE TABLE best_sign_cont_task (   id INTEGER PRIMARY KEY NOT NULL COMMENT 'ä¸»é”®' AUTO_INCREMENT   docid VARCHAR(50) NOT NULL DEFAULT '' COMMENT 'åˆåŒåŸä»¶çš„ä¸Šä¸Šç­¾id'   pdfid VARCHAR(50) NOT NULL DEFAULT '' COMMENT 'åˆåŒpdfçš„ä¸Šä¸Šç­¾id'   contract_id VARCHAR(50) NOT NULL DEFAULT '' COMMENT 'ä¸Šä¸Šç­¾åˆåŒid'   finish TINYINT(1) NOT NULL DEFAULT 0 COMMENT '0ç”²æ–¹æœªç­¾ç½² 1ç”²æ–¹å·²ç­¾ç½² è¡¨ç¤ºä»»åŠ¡å®Œæˆ'   remark VARCHAR(100) NOT NULL DEFAULT '' COMMENT 'å¤‡æ³¨'   sys_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE  CURRENT_TIMESTAMP  NOT NULL COMMENT 'ç³»ç»Ÿæ—¶é—´' )ENGINE=INNODB DEFAULT CHARSET=utf8 COMMENT 'ä¸Šä¸Šç­¾åˆåŒåˆ›å»ºä»»åŠ¡è®°å½•' com.alibaba.fastsql.sql.parser.ParserException: TODO pos 545  line 9  column 83  token NULL         at com.alibaba.fastsql.sql.parser.SQLExprParser.notRationalRest(SQLExprParser.java:2557) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186]         at com.alibaba.fastsql.sql.parser.SQLExprParser.relationalRest(SQLExprParser.java:2323) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186]         at com.alibaba.fastsql.sql.parser.SQLExprParser.exprRest(SQLExprParser.java:109) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186]         at com.alibaba.fastsql.sql.parser.SQLExprParser.expr(SQLExprParser.java:97) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186]         at com.alibaba.fastsql.sql.dialect.mysql.parser.MySqlExprParser.parseColumnRest(MySqlExprParser.java:462) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186]         at com.alibaba.fastsql.sql.parser.SQLExprParser.parseColumnRest(SQLExprParser.java:2801) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186]         at com.alibaba.fastsql.sql.dialect.mysql.parser.MySqlExprParser.parseColumnRest(MySqlExprParser.java:545) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186]         at com.alibaba.fastsql.sql.dialect.mysql.parser.MySqlExprParser.parseColumn(MySqlExprParser.java:455) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186]         at com.alibaba.fastsql.sql.dialect.mysql.parser.MySqlCreateTableParser.parseCreateTable(MySqlCreateTableParser.java:170) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186]         at com.alibaba.fastsql.sql.dialect.mysql.parser.MySqlStatementParser.parseCreate(MySqlStatementParser.java:239) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186]         at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:165) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186]         at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:76) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186]         at com.alibaba.fastsql.sql.SQLUtils.parseStatements(SQLUtils.java:469) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186]         at com.alibaba.fastsql.sql.repository.SchemaRepository.console(SchemaRepository.java:331) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:71) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.applyHistoryOnMemory(DatabaseTableMeta.java:382) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:121) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at java.lang.Thread.run(Thread.java:748) [na:1.8.0_171] ` æˆ‘æ‰‹åŠ¨ä¸‹è½½äº† fastsql_2.0.0_preview_186ï¼Œå®šä½åˆ°äº†é—®é¢˜ï¼Œ é—®é¢˜sqlï¼š  ```sql CREATE TABLE corp_best_sign_info (     sys_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP  ON UPDATE CURRENT_TIMESTAMP   not null  COMMENT 'ç³»ç»Ÿæ—¶é—´' )ENGINE=INNODB DEFAULT CHARSET=utf8 COMMENT 'ä¼ä¸šå¼€é€šä¸Šä¸Šç­¾ä¿¡æ¯è¡¨'; ``` è°ƒæ•´åé€šè¿‡çš„sql:  ```sql CREATE TABLE corp_best_sign_info (     sys_time TIMESTAMP  not null DEFAULT CURRENT_TIMESTAMP  ON UPDATE CURRENT_TIMESTAMP   COMMENT 'ç³»ç»Ÿæ—¶é—´' )ENGINE=INNODB DEFAULT CHARSET=utf8 COMMENT 'ä¼ä¸šå¼€é€šä¸Šä¸Šç­¾ä¿¡æ¯è¡¨'; ``` åŒºåˆ«åœ¨äºï¼Œnot null   æœ‰é—®é¢˜çš„å†™åœ¨äº† on update current_timestamp ä¹‹åï¼Œç±»æ¯”äº†ä¸‹å…¶å®ƒçš„sqlparse  è¿™ç§è¯­æ³•æ˜¯OKçš„ï¼Œéº»çƒ¦çœ‹ä¸‹ï¼Œèƒ½å¦ä¿®å¤ä¸‹ã€‚ çš„ç¡®æ˜¯å­˜åœ¨é—®é¢˜
662,å½“å‰masteråˆ†æ”¯  SimpleCanalConnector#connect()æ–¹æ³•  é€»è¾‘é”™è¯¯ # è¿è¡ŒSimpleCanalClientTestçš„mainæ–¹æ³•ï¼Œä¼šå‡ºå¼‚å¸¸ `process error!java.lang.NullPointerException: null 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.writeWithHeader(SimpleCanalConnector.java:392) ~[classes/:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.writeWithHeader(SimpleCanalConnector.java:380) ~[classes/:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:292) ~[classes/:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:280) ~[classes/:na] 	at com.alibaba.otter.canal.example.AbstractCanalClientTest.process(AbstractCanalClientTest.java:125) ~[classes/:na] 	at com.alibaba.otter.canal.example.AbstractCanalClientTest$2.run(AbstractCanalClientTest.java:85) [classes/:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_171]` ç»æ’æŸ¥ï¼Œæ˜¯SimpleCanalConnectorçš„connectæ–¹æ³•å‡ºé”™ ``` public void connect() throws CanalClientException {         if (connected) {             return;         }         if (runningMonitor != null) {             if (!runningMonitor.isStart()) {                 runningMonitor.start();             }         } else {             waitClientRunning();             if (!running) {                 return;             }             doConnect();             if (filter != null) { // å¦‚æœå­˜åœ¨æ¡ä»¶ï¼Œè¯´æ˜æ˜¯è‡ªåŠ¨åˆ‡æ¢ï¼ŒåŸºäºä¸Šä¸€æ¬¡çš„æ¡ä»¶è®¢é˜…ä¸€æ¬¡                 subscribe(filter);             }             if (rollbackOnConnect) {                 rollback();             }         }         connected = true;     } private void waitClientRunning() {         try {             if (zkClientx != null) {                 if (!connected) {// æœªè°ƒç”¨connect                     throw new CanalClientException("should connect first");                 }                 running = true;                 mutex.get();// é˜»å¡ç­‰å¾…             }         } catch (InterruptedException e) {             Thread.currentThread().interrupt();             throw new CanalClientException(e);         }     } ``` runningåˆå§‹åŒ–ä¸ºfalseï¼Œä¸”ä»…æœ‰ä¸¤ä¸ªæ–¹æ³•æ”¹å˜äº†ä»–çš„å€¼ï¼šwaitClientRunning()  å’Œ  stopRunning() ã€‚ connect()æ–¹æ³•è°ƒç”¨waitClientRunning()æ—¶ï¼Œç”±äºzkClienttx == null æ‰€ä»¥runningä»ç„¶ä¸ºfalseï¼Œæ‰€ä»¥ä¸ä¼šè°ƒç”¨doConnect()ï¼Œä»è€Œæ²¡æœ‰ç»™writableChannelèµ‹å€¼ï¼Œå¹¶å¯¼è‡´å¼‚å¸¸å †æ ˆé‡Œçš„ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚ é—®é¢˜æ˜¯è¿™æ¬¡æäº¤é€ æˆçš„:[https://github.com/alibaba/canal/commit/4141049bb90ce6dc1ce05a58c95f2d974fdd5865](https://github.com/alibaba/canal/commit/4141049bb90ce6dc1ce05a58c95f2d974fdd5865) @rewerma  1ã€å±è”½ä¸¤è¡Œä»£ç å°±è¡Œäº†ï¼Œ ç¬¬ä¸€å¤„ï¼š public void connect() throws CanalClientException {         if (connected) {             return;         }         if (runningMonitor != null) {             if (!runningMonitor.isStart()) {                 runningMonitor.start();             }         } else {             waitClientRunning(); //            if (!running) { //                return; //            }             doConnect();             if (filter != null) { // å¦‚æœå­˜åœ¨æ¡ä»¶ï¼Œè¯´æ˜æ˜¯è‡ªåŠ¨åˆ‡æ¢ï¼ŒåŸºäºä¸Šä¸€æ¬¡çš„æ¡ä»¶è®¢é˜…ä¸€æ¬¡                 subscribe(filter);             }             if (rollbackOnConnect) {                 rollback();             }         }         connected = true;     } ç¬¬äºŒå¤„ï¼š  public void subscribe(String filter) throws CanalClientException {         waitClientRunning(); //        if (!running) { //            return; //        }         try {             writeWithHeader(Packet.newBuilder()                 .setType(PacketType.SUBSCRIPTION)                 .setBody(Sub.newBuilder()                     .setDestination(clientIdentity.getDestination())                     .setClientId(String.valueOf(clientIdentity.getClientId()))                     .setFilter(filter != null ? filter : "")                     .build()                     .toByteString())                 .build()                 .toByteArray());             //             Packet p = Packet.parseFrom(readNextPacket());             Ack ack = Ack.parseFrom(p.getBody());             if (ack.getErrorCode() > 0) {                 throw new CanalClientException("failed to subscribe with reason: " + ack.getErrorMessage());             }             clientIdentity.setFilter(filter);         } catch (IOException e) {             throw new CanalClientException(e);         }     } åŸå› ä¸Šé¢å·²ç»å›ç­”ã€‚zookeeperåˆ¤æ–­æœ‰é—®é¢˜ã€‚å•æœºå¯æœ‰æ²¡æœ‰zookeeper å·²ä¿®å¤
661,äº§ç”Ÿæ•°æ®ç§¯å‹åï¼ŒåŒæ­¥ä¸€æ®µæ—¶é—´å°±ä¼šæŠ¥é”™ã€‚å¼‚å¸¸åï¼Œåˆä¼šé‡æ–°ä»å¼€å§‹çš„ä½ç‚¹åŒæ­¥ã€‚å¯¼è‡´æ— æ³•æŒç»­è¿›è¡Œåé¢çš„åŒæ­¥ã€‚ ç‰ˆæœ¬canal-canal-1.0.26 something goes wrong when acking data from server:null com.alibaba.otter.canal.protocol.exception.CanalClientException: java.io.IOException: Broken pipe 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.ack(SimpleCanalConnector.java:339) 	at com.alibaba.otter.canal.client.impl.ClusterCanalConnector.ack(ClusterCanalConnector.java:246) 	at ins.framework.mysqltoes.client.AbstractCanalClientTest.process(AbstractCanalClientTest.java:140) 	at ins.framework.mysqltoes.client.AbstractCanalClientTest$2.run(AbstractCanalClientTest.java:93) 	at java.lang.Thread.run(Thread.java:745) Caused by: java.io.IOException: Broken pipe 	at sun.nio.ch.FileDispatcherImpl.write0(Native Method) 	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47) 	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93) 	at sun.nio.ch.IOUtil.write(IOUtil.java:65) 	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471) 	at java.nio.channels.Channels.writeFullyImpl(Channels.java:78) 	at java.nio.channels.Channels.writeFully(Channels.java:98) 	at java.nio.channels.Channels.access$000(Channels.java:61) 	at java.nio.channels.Channels$1.write(Channels.java:174) 	at java.nio.channels.Channels$WritableByteChannelImpl.write(Channels.java:458) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.writeWithHeader(SimpleCanalConnector.java:382) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.writeWithHeader(SimpleCanalConnector.java:369) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.ack(SimpleCanalConnector.java:333) 	... 4 common frames omitted restart the connector for next round retry. something goes wrong when getWithoutAck data from server:null com.alibaba.otter.canal.protocol.exception.CanalClientException: something goes wrong with reason: something goes wrong with channel:[id: 0x58c3e872  /10.10.56.23:50475 => /10.10.56.23:11111]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: ack error   clientId:1001 batchId:926 is not exist   please check 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.receiveMessages(SimpleCanalConnector.java:317) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:294) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:269) 	at com.alibaba.otter.canal.client.impl.ClusterCanalConnector.getWithoutAck(ClusterCanalConnector.java:177) 	at ins.framework.mysqltoes.client.AbstractCanalClientTest.process(AbstractCanalClientTest.java:126) 	at ins.framework.mysqltoes.client.AbstractCanalClientTest$2.run(AbstractCanalClientTest.java:93) 	at java.lang.Thread.run(Thread.java:745) restart the connector for next round retry. ------------------------------------------------------------------------------------------------------------- canalçš„serverç«¯ç”Ÿæˆäº†çº¿ç¨‹é”™è¯¯æ—¥å¿—ï¼Œhs_err_pid12248.logï¼Œè®°å½•äº†éƒ¨åˆ†å †æ ˆä¿¡æ¯ï¼Œä½†é‡Œé¢æœ‰ä¸‹é¢çš„å¼‚å¸¸ï¼Œæ˜¯ä¸æ˜¯æœ‰éƒ¨åˆ†ä»£ç æ¼æ‰äº†ï¼Ÿ ------------------------------------------------------------------------------------------------------------- Internal exceptions (10 events): Event: 13725.231 Thread 0x00007f65bc006800 Exception <a 'java/lang/ClassNotFoundException': com/alibaba/otter/canal/protocol/position/PositionBeanInfo> (0x0000000715146718) thrown at [/HUDSON/workspace/8-2-build-linux-amd64/jdk8u51/3951/hotspot/src/share/vm/classfile/systemDictionary.cpp  line 210 Event: 13725.231 Thread 0x00007f65bc006800 Exception <a 'java/lang/ClassNotFoundException': com/alibaba/otter/canal/protocol/position/PositionCustomizer> (0x0000000715156278) thrown at [/HUDSON/workspace/8-2-build-linux-amd64/jdk8u51/3951/hotspot/src/share/vm/classfile/systemDictionary.cpp  line 2 Event: 13725.231 Thread 0x00007f65bc006800 Exception <a 'java/lang/ClassNotFoundException': com/alibaba/otter/canal/protocol/position/TimePositionCustomizer> (0x0000000715168aa0) thrown at [/HUDSON/workspace/8-2-build-linux-amd64/jdk8u51/3951/hotspot/src/share/vm/classfile/systemDictionary.cpp  li Event: 13725.232 Thread 0x00007f65bc006800 Exception <a 'java/lang/ClassNotFoundException': com/alibaba/otter/canal/protocol/position/EntryPositionCustomizer> (0x000000071517e530) thrown at [/HUDSON/workspace/8-2-build-linux-amd64/jdk8u51/3951/hotspot/src/share/vm/classfile/systemDictionary.cpp  l Event: 13725.413 Thread 0x00007f659c1da000 Exception <a 'java/lang/ClassCastException': sun.misc.Cleaner cannot be cast to java.lang.Runnable> (0x00000007168aa620) thrown at [/HUDSON/workspace/8-2-build-linux-amd64/jdk8u51/3951/hotspot/src/share/vm/interpreter/interpreterRuntime.cpp  line 381] Event: 13725.416 Thread 0x00007f659c1da000 Exception <a 'java/lang/NoClassDefFoundError': javassist/ClassPath> (0x00000007168c0840) thrown at [/HUDSON/workspace/8-2-build-linux-amd64/jdk8u51/3951/hotspot/src/share/vm/classfile/systemDictionary.cpp  line 199] Event: 13730.219 Thread 0x00007f65a000a000 Implicit null exception at 0x00007f66653cf735 to 0x00007f66653cfa61 Event: 13743.542 Thread 0x00007f659c1da000 Exception <a 'java/lang/InterruptedException'> (0x0000000709c92318) thrown at [/HUDSON/workspace/8-2-build-linux-amd64/jdk8u51/3951/hotspot/src/share/vm/runtime/objectMonitor.cpp  line 1683] Event: 13743.548 Thread 0x00007f6594003800 Implicit null exception at 0x00007f6665ecfa12 to 0x00007f6665ed0209 Event: 13743.558 Thread 0x00007f6594003800 Implicit null exception at 0x00007f6665b17426 to 0x00007f6665b19e6d ä½ è¿™æ˜¯openjdk ï¼Ÿ ack error   clientId:1001 batchId:926 is not exist   please checkï¼Œ åº”è¯¥æ˜¯canal serverç«¯æœ‰å¼‚å¸¸ï¼Œé‡å¯äº†instance æ£€æŸ¥äº†canalserverçš„æ—¥å¿—ï¼Œå‘ç°è¿‡ä¸€äº›ä¸æ”¯æŒçš„formatæ ¼å¼çš„è­¦å‘Šã€‚ä½†æ˜¯å¹¶ä¸å½±å“åŒæ­¥ã€‚ä½†æ˜¯ä¸€æ—¦å‡ºç°ä¸Šé¢çš„å¼‚å¸¸ï¼ŒæœåŠ¡ç«¯ä¹Ÿä¼šæŠ¥è¿™ä¸ªå¼‚å¸¸ã€‚
660,1.0.26æœ€æ–°ç‰ˆæœ¬ï¼šsomething goes wrong with channel:******clientId:1001 batchId:50560 is not exist   please check ä»Šå¤©æ—©ä¸Šå‘ç°    @@@logs/canalç›®å½•ä¸‹çš„canal.logæ–‡ä»¶å°†è¿‘200Mï¼Œä¸€ç›´æŠ¥å¦‚ä¸‹å¼‚å¸¸ï¼Œä½†æ˜¯æŸ¥çœ‹æ¯ä¸ªinstanceç›®å½•ä¸‹é¢çš„meta.logæ˜¯æ­£å¸¸è®°å½•æ¶ˆè´¹ä½ç‚¹çš„ï¼Œè¯´æ˜æ˜¯æ­£å¸¸æ¶ˆè´¹çš„å§ã€‚ä½†æ˜¯è¿™ä¸ªå¼‚å¸¸ä¸ºä»€ä¹ˆä¸€ç›´å­˜åœ¨ï¼Ÿï¼Ÿ 2018-05-29 09:48:25.896 [New I/O server worker #1-1] ERROR com.alibaba.otter.canal.server.netty.NettyUtils - ErrotCode:400   Caused by : something goes wrong with channel:[id: 0x01f1bec3  /127.0.0.1:35010 => /127.0.0.1:11111]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: ack error   clientId:1001 batchId:50560 is not exist   please check 2018-05-29 09:48:25.907 [New I/O server worker #1-1] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x01f1bec3  /127.0.0.1:35010 :> /127.0.0.1:11111]  exception=java.nio.channels.ClosedChannelException 	at org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:649) 	at org.jboss.netty.channel.socket.nio.NioWorker.writeFromUserCode(NioWorker.java:370) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:137) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76) 	at org.jboss.netty.channel.Channels.write(Channels.java:611) 	at org.jboss.netty.channel.Channels.write(Channels.java:578) 	at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:28) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:144) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.cleanup(ReplayingDecoder.java:542) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.channelDisconnected(ReplayingDecoder.java:450) 	at org.jboss.netty.channel.Channels.fireChannelDisconnected(Channels.java:360) 	at org.jboss.netty.channel.socket.nio.NioWorker.close(NioWorker.java:599) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:119) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76) 	at org.jboss.netty.channel.Channels.close(Channels.java:720) 	at org.jboss.netty.channel.AbstractChannel.close(AbstractChannel.java:208) 	at org.jboss.netty.channel.ChannelFutureListener$1.operationComplete(ChannelFutureListener.java:46) 	at org.jboss.netty.channel.DefaultChannelFuture.notifyListener(DefaultChannelFuture.java:381) 	at org.jboss.netty.channel.DefaultChannelFuture.addListener(DefaultChannelFuture.java:148) 	at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:30) 	at com.alibaba.otter.canal.server.netty.NettyUtils.error(NettyUtils.java:51) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:200) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:444) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:350) 	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:281) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:201) 	at org.jboss.netty.util.internal.IoWorkerRunnable.run(IoWorkerRunnable.java:46) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615) 	at java.lang.Thread.run(Thread.java:745) è¿™ä¸ªæ˜¯bugå§ï¼Œä»€ä¹ˆæ—¶å€™èƒ½æ›´æ–°å•Š serverç«¯è‚¯å®šäº§ç”Ÿäº†å¼‚å¸¸æˆ–è€…é‡å¯äº†instanceï¼Œclientå‚è€ƒdemoåšä¸€ä¸‹é‡è¯• @agapple doConnect() æ–¹æ³•æ˜¯é‡è¯•ï¼Ÿ çœ‹ä¸€ä¸‹clientçš„demo @agapple çœ‹äº†AbstractCanalClientTesté‡Œé¢connector.disconnect()æ–¹æ³•å§ï¼Œå°è¯•äº†ï¼Œä½†æ˜¯æœåŠ¡ç«¯è¿˜æ˜¯ä¸€æ ·çš„å¼‚å¸¸ protected void process() {         int batchSize = 5 * 1024;         while (running) {             try {                 MDC.put("destination"  destination);                 connector.connect();                 connector.subscribe();                 waiting = false;                 while (running) {                     Message message = connector.getWithoutAck(batchSize); // è·å–æŒ‡å®šæ•°é‡çš„æ•°æ®                     long batchId = message.getId();                     int size = message.getEntries().size();                     if (batchId == -1 || size == 0) {                         // try {                         // Thread.sleep(1000);                         // } catch (InterruptedException e) {                         // }                     } else {                         printSummary(message  batchId  size);                         printEntry(message.getEntries());                     }                     connector.ack(batchId); // æäº¤ç¡®è®¤                     // connector.rollback(batchId); // å¤„ç†å¤±è´¥  å›æ»šæ•°æ®                 }             } catch (Exception e) {                 logger.error("process error!"  e);             } finally {                 **connector.disconnect();**                 MDC.remove("destination");             }         }     } @agapple   instanceæ˜¯ä¼šé‡å¯ï¼Œå·²é‡å¯ï¼Œç”Ÿäº§çº¿ä¸ŠåŒæ­¥çš„æ•°æ®å°±é‡å¤è§£æäº†ï¼Œå‘é€åˆ°kafkaçš„   [æ‚è„¸] åˆ†å¸ƒå¼ç³»ç»Ÿçš„extractly-onceæ˜¯å¾ˆéš¾çš„ï¼Œä¸€èˆ¬éƒ½éœ€è¦ä¸šåŠ¡è€ƒè™‘å¹‚ç­‰
659,åŒæ­¥çš„æ—¶å€™åˆå§‹åŒ–sqlæŠ¥é”™ 1.0.25 ç‰ˆæœ¬ï¼Œæ–‡æ¡£ä¸­é»˜è®¤é…ç½® h2æ•°æ®åº“ ` 2018-05-28 14:36:38.957 [destination = myexample   address = /172.16.9.11:3307   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TABLE `columns_priv` (   `Host` char(60) COLLATE utf8_bin NOT NULL DEFAULT ''   `Db` char(64) COLLATE utf8_bin NOT NULL DEFAULT ''   `User` char(16) COLLATE utf8_bin NOT NULL DEFAULT ''   `Table_name` char(64) COLLATE utf8_bin NOT NULL DEFAULT ''   `Column_name` char(64) COLLATE utf8_bin NOT NULL DEFAULT ''   `Timestamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP   `Column_priv` set('Select' 'Insert' 'Update' 'References') CHARACTER SET utf8 NOT NULL DEFAULT ''   PRIMARY KEY (`Host` `Db` `User` `Table_name` `Column_name`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='Column privileges' com.alibaba.druid.sql.parser.ParserException: error pos 428  line 8  column 17  token SET 	at com.alibaba.druid.sql.parser.SQLExprParser.name(SQLExprParser.java:1334) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLExprParser.parseDataType(SQLExprParser.java:2310) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLExprParser.parseDataType(SQLExprParser.java:2301) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlExprParser.parseColumn(MySqlExprParser.java:493) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlCreateTableParser.parseCreateTable(MySqlCreateTableParser.java:115) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseCreate(MySqlStatementParser.java:244) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:159) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:464) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:295) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:69) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.25.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_101] 2018-05-28 14:36:38.960 [destination = myexample   address = /172.16.9.11:3307   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TABLE `db` (   `Host` char(60) COLLATE utf8_bin NOT NULL DEFAULT ''   `Db` char(64) COLLATE utf8_bin NOT NULL DEFAULT ''   `User` char(16) COLLATE utf8_bin NOT NULL DEFAULT ''   `Select_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Insert_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Update_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Delete_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Drop_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Grant_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `References_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Index_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Alter_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_tmp_table_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Lock_tables_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_view_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Show_view_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_routine_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Alter_routine_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Execute_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Event_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Trigger_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   PRIMARY KEY (`Host` `Db` `User`)   KEY `User` (`User`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='Database privileges' com.alibaba.druid.sql.parser.ParserException: syntax error  error in :''Y') CHARACTER SET utf8 NOT NULL DE'  expect RPAREN  actual IDENTIFIER pos 225  line 5  column 31  token IDENTIFIER CHARACTER 	at com.alibaba.druid.sql.parser.SQLParser.printError(SQLParser.java:284) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLParser.accept(SQLParser.java:292) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlCreateTableParser.parseCreateTable(MySqlCreateTableParser.java:191) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseCreate(MySqlStatementParser.java:244) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:159) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:464) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:295) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:69) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.25.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_101] 2018-05-28 14:36:38.961 [destination = myexample   address = /172.16.9.11:3307   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TABLE `event` (   `db` char(64) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL DEFAULT ''   `name` char(64) NOT NULL DEFAULT ''   `body` longblob NOT NULL   `definer` char(77) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL DEFAULT ''   `execute_at` datetime DEFAULT NULL   `interval_value` int(11) DEFAULT NULL   `interval_field` enum('YEAR' 'QUARTER' 'MONTH' 'DAY' 'HOUR' 'MINUTE' 'WEEK' 'SECOND' 'MICROSECOND' 'YEAR_MONTH' 'DAY_HOUR' 'DAY_MINUTE' 'DAY_SECOND' 'HOUR_MINUTE' 'HOUR_SECOND' 'MINUTE_SECOND' 'DAY_MICROSECOND' 'HOUR_MICROSECOND' 'MINUTE_MICROSECOND' 'SECOND_MICROSECOND') DEFAULT NULL   `created` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP   `modified` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00'   `last_executed` datetime DEFAULT NULL   `starts` datetime DEFAULT NULL   `ends` datetime DEFAULT NULL   `status` enum('ENABLED' 'DISABLED' 'SLAVESIDE_DISABLED') NOT NULL DEFAULT 'ENABLED'   `on_completion` enum('DROP' 'PRESERVE') NOT NULL DEFAULT 'DROP'   `sql_mode` set('REAL_AS_FLOAT' 'PIPES_AS_CONCAT' 'ANSI_QUOTES' 'IGNORE_SPACE' 'NOT_USED' 'ONLY_FULL_GROUP_BY' 'NO_UNSIGNED_SUBTRACTION' 'NO_DIR_IN_CREATE' 'POSTGRESQL' 'ORACLE' 'MSSQL' 'DB2' 'MAXDB' 'NO_KEY_OPTIONS' 'NO_TABLE_OPTIONS' 'NO_FIELD_OPTIONS' 'MYSQL323' 'MYSQL40' 'ANSI' 'NO_AUTO_VALUE_ON_ZERO' 'NO_BACKSLASH_ESCAPES' 'STRICT_TRANS_TABLES' 'STRICT_ALL_TABLES' 'NO_ZERO_IN_DATE' 'NO_ZERO_DATE' 'INVALID_DATES' 'ERROR_FOR_DIVISION_BY_ZERO' 'TRADITIONAL' 'NO_AUTO_CREATE_USER' 'HIGH_NOT_PRECEDENCE' 'NO_ENGINE_SUBSTITUTION' 'PAD_CHAR_TO_FULL_LENGTH') NOT NULL DEFAULT ''   `comment` char(64) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL DEFAULT ''   `originator` int(10) unsigned NOT NULL   `time_zone` char(64) CHARACTER SET latin1 NOT NULL DEFAULT 'SYSTEM'   `character_set_client` char(32) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL   `collation_connection` char(32) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL   `db_collation` char(32) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL   `body_utf8` longblob   PRIMARY KEY (`db` `name`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COMMENT='Events' com.alibaba.druid.sql.parser.ParserException: error pos 1035  line 16  column 14  token SET 	at com.alibaba.druid.sql.parser.SQLExprParser.name(SQLExprParser.java:1334) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLExprParser.parseDataType(SQLExprParser.java:2310) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLExprParser.parseDataType(SQLExprParser.java:2301) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlExprParser.parseColumn(MySqlExprParser.java:493) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlCreateTableParser.parseCreateTable(MySqlCreateTableParser.java:115) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseCreate(MySqlStatementParser.java:244) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:159) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:464) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:295) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:69) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.25.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_101] 2018-05-28 14:36:38.964 [destination = myexample   address = /172.16.9.11:3307   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TABLE `func` (   `name` char(64) COLLATE utf8_bin NOT NULL DEFAULT ''   `ret` tinyint(1) NOT NULL DEFAULT '0'   `dl` char(128) COLLATE utf8_bin NOT NULL DEFAULT ''   `type` enum('function' 'aggregate') CHARACTER SET utf8 NOT NULL   PRIMARY KEY (`name`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='User defined functions' com.alibaba.druid.sql.parser.ParserException: syntax error  error in :'te') CHARACTER SET utf8 NOT NULL  '  expect RPAREN  actual IDENTIFIER pos 221  line 5  column 39  token IDENTIFIER CHARACTER 	at com.alibaba.druid.sql.parser.SQLParser.printError(SQLParser.java:284) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLParser.accept(SQLParser.java:292) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlCreateTableParser.parseCreateTable(MySqlCreateTableParser.java:191) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseCreate(MySqlStatementParser.java:244) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:159) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:464) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:295) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:69) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.25.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_101] 2018-05-28 14:36:38.967 [destination = myexample   address = /172.16.9.11:3307   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TABLE `proc` (   `db` char(64) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL DEFAULT ''   `name` char(64) NOT NULL DEFAULT ''   `type` enum('FUNCTION' 'PROCEDURE') NOT NULL   `specific_name` char(64) NOT NULL DEFAULT ''   `language` enum('SQL') NOT NULL DEFAULT 'SQL'   `sql_data_access` enum('CONTAINS_SQL' 'NO_SQL' 'READS_SQL_DATA' 'MODIFIES_SQL_DATA') NOT NULL DEFAULT 'CONTAINS_SQL'   `is_deterministic` enum('YES' 'NO') NOT NULL DEFAULT 'NO'   `security_type` enum('INVOKER' 'DEFINER') NOT NULL DEFAULT 'DEFINER'   `param_list` blob NOT NULL   `returns` longblob NOT NULL   `body` longblob NOT NULL   `definer` char(77) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL DEFAULT ''   `created` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP   `modified` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00'   `sql_mode` set('REAL_AS_FLOAT' 'PIPES_AS_CONCAT' 'ANSI_QUOTES' 'IGNORE_SPACE' 'NOT_USED' 'ONLY_FULL_GROUP_BY' 'NO_UNSIGNED_SUBTRACTION' 'NO_DIR_IN_CREATE' 'POSTGRESQL' 'ORACLE' 'MSSQL' 'DB2' 'MAXDB' 'NO_KEY_OPTIONS' 'NO_TABLE_OPTIONS' 'NO_FIELD_OPTIONS' 'MYSQL323' 'MYSQL40' 'ANSI' 'NO_AUTO_VALUE_ON_ZERO' 'NO_BACKSLASH_ESCAPES' 'STRICT_TRANS_TABLES' 'STRICT_ALL_TABLES' 'NO_ZERO_IN_DATE' 'NO_ZERO_DATE' 'INVALID_DATES' 'ERROR_FOR_DIVISION_BY_ZERO' 'TRADITIONAL' 'NO_AUTO_CREATE_USER' 'HIGH_NOT_PRECEDENCE' 'NO_ENGINE_SUBSTITUTION' 'PAD_CHAR_TO_FULL_LENGTH') NOT NULL DEFAULT ''   `comment` text CHARACTER SET utf8 COLLATE utf8_bin NOT NULL   `character_set_client` char(32) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL   `collation_connection` char(32) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL   `db_collation` char(32) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL   `body_utf8` longblob   PRIMARY KEY (`db` `name` `type`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COMMENT='Stored Procedures' com.alibaba.druid.sql.parser.ParserException: error pos 864  line 16  column 14  token SET 	at com.alibaba.druid.sql.parser.SQLExprParser.name(SQLExprParser.java:1334) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLExprParser.parseDataType(SQLExprParser.java:2310) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLExprParser.parseDataType(SQLExprParser.java:2301) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlExprParser.parseColumn(MySqlExprParser.java:493) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlCreateTableParser.parseCreateTable(MySqlCreateTableParser.java:115) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseCreate(MySqlStatementParser.java:244) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:159) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:464) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:295) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:69) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.25.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_101] 2018-05-28 14:36:38.968 [destination = myexample   address = /172.16.9.11:3307   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TABLE `procs_priv` (   `Host` char(60) COLLATE utf8_bin NOT NULL DEFAULT ''   `Db` char(64) COLLATE utf8_bin NOT NULL DEFAULT ''   `User` char(16) COLLATE utf8_bin NOT NULL DEFAULT ''   `Routine_name` char(64) CHARACTER SET utf8 NOT NULL DEFAULT ''   `Routine_type` enum('FUNCTION' 'PROCEDURE') COLLATE utf8_bin NOT NULL   `Grantor` char(77) COLLATE utf8_bin NOT NULL DEFAULT ''   `Proc_priv` set('Execute' 'Alter Routine' 'Grant') CHARACTER SET utf8 NOT NULL DEFAULT ''   `Timestamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP   PRIMARY KEY (`Host` `Db` `User` `Routine_name` `Routine_type`)   KEY `Grantor` (`Grantor`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='Procedure privileges' com.alibaba.druid.sql.parser.ParserException: syntax error  error in :'RE') COLLATE utf8_bin NOT NULL   `'  expect RPAREN  actual IDENTIFIER pos 313  line 6  column 47  token IDENTIFIER COLLATE 	at com.alibaba.druid.sql.parser.SQLParser.printError(SQLParser.java:284) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLParser.accept(SQLParser.java:292) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlCreateTableParser.parseCreateTable(MySqlCreateTableParser.java:191) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseCreate(MySqlStatementParser.java:244) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:159) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:464) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:295) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:69) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.25.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_101] 2018-05-28 14:36:38.972 [destination = myexample   address = /172.16.9.11:3307   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TABLE `tables_priv` (   `Host` char(60) COLLATE utf8_bin NOT NULL DEFAULT ''   `Db` char(64) COLLATE utf8_bin NOT NULL DEFAULT ''   `User` char(16) COLLATE utf8_bin NOT NULL DEFAULT ''   `Table_name` char(64) COLLATE utf8_bin NOT NULL DEFAULT ''   `Grantor` char(77) COLLATE utf8_bin NOT NULL DEFAULT ''   `Timestamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP   `Table_priv` set('Select' 'Insert' 'Update' 'Delete' 'Create' 'Drop' 'Grant' 'References' 'Index' 'Alter' 'Create View' 'Show view' 'Trigger') CHARACTER SET utf8 NOT NULL DEFAULT ''   `Column_priv` set('Select' 'Insert' 'Update' 'References') CHARACTER SET utf8 NOT NULL DEFAULT ''   PRIMARY KEY (`Host` `Db` `User` `Table_name`)   KEY `Grantor` (`Grantor`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='Table privileges' com.alibaba.druid.sql.parser.ParserException: error pos 422  line 8  column 16  token SET 	at com.alibaba.druid.sql.parser.SQLExprParser.name(SQLExprParser.java:1334) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLExprParser.parseDataType(SQLExprParser.java:2310) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLExprParser.parseDataType(SQLExprParser.java:2301) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlExprParser.parseColumn(MySqlExprParser.java:493) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlCreateTableParser.parseCreateTable(MySqlCreateTableParser.java:115) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseCreate(MySqlStatementParser.java:244) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:159) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:464) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:295) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:69) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.25.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_101] 2018-05-28 14:36:38.974 [destination = myexample   address = /172.16.9.11:3307   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TABLE `user` (   `Host` char(60) COLLATE utf8_bin NOT NULL DEFAULT ''   `User` char(16) COLLATE utf8_bin NOT NULL DEFAULT ''   `Password` char(41) CHARACTER SET latin1 COLLATE latin1_bin NOT NULL DEFAULT ''   `Select_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Insert_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Update_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Delete_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Drop_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Reload_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Shutdown_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Process_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `File_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Grant_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `References_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Index_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Alter_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Show_db_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Super_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_tmp_table_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Lock_tables_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Execute_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Repl_slave_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Repl_client_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_view_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Show_view_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_routine_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Alter_routine_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_user_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Event_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Trigger_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_tablespace_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `ssl_type` enum('' 'ANY' 'X509' 'SPECIFIED') CHARACTER SET utf8 NOT NULL DEFAULT ''   `ssl_cipher` blob NOT NULL   `x509_issuer` blob NOT NULL   `x509_subject` blob NOT NULL   `max_questions` int(11) unsigned NOT NULL DEFAULT '0'   `max_updates` int(11) unsigned NOT NULL DEFAULT '0'   `max_connections` int(11) unsigned NOT NULL DEFAULT '0'   `max_user_connections` int(11) unsigned NOT NULL DEFAULT '0'   `plugin` char(64) COLLATE utf8_bin DEFAULT ''   `authentication_string` text COLLATE utf8_bin   `password_expired` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   PRIMARY KEY (`Host` `User`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='Users and global privileges' com.alibaba.druid.sql.parser.ParserException: syntax error  error in :''Y') CHARACTER SET utf8 NOT NULL DE'  expect RPAREN  actual IDENTIFIER pos 256  line 5  column 31  token IDENTIFIER CHARACTER 	at com.alibaba.druid.sql.parser.SQLParser.printError(SQLParser.java:284) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLParser.accept(SQLParser.java:292) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlCreateTableParser.parseCreateTable(MySqlCreateTableParser.java:191) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseCreate(MySqlStatementParser.java:244) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:159) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:464) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:295) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:69) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.25.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_101] 2018-05-28 14:38:19.380 [destination = myexample   address = /172.16.9.11:3307   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - pls submit github issue  show create table ddl:CREATE TABLE `hierquerysellist` (   `fieldtype_id` bigint(20) NOT NULL   `whereclause` longtext NOT NULL   `filtervariants` char(1) NOT NULL   UNIQUE KEY `fieldtype_id` (`fieldtype_id`) USING BTREE ) ENGINE=MyISAM DEFAULT CHARSET=utf8   compare failed .   db : TableMeta [schema=bboss  table=hierquerysellist  fileds= 	FieldMeta [columnName=fieldtype_id  columnType=bigint(20)  defaultValue=null  nullable=false  key=true] 	FieldMeta [columnName=whereclause  columnType=longtext  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=filtervariants  columnType=char(1)  defaultValue=null  nullable=false  key=false] ]   mem : TableMeta [schema=bboss  table=hierquerysellist  fileds= 	FieldMeta [columnName=fieldtype_id  columnType=bigint(20)  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=whereclause  columnType=longtext  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=filtervariants  columnType=char(1)  defaultValue=null  nullable=false  key=false] ] 2018-05-28 14:38:19.590 [destination = myexample   address = /172.16.9.11:3307   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - pls submit github issue  show create table ddl:CREATE TABLE `hierquerysellist_fields` (   `fieldtype_id` bigint(20) NOT NULL   `sequencenr` smallint(6) NOT NULL   `fieldname` varchar(50) NOT NULL   UNIQUE KEY `fieldtype_id` (`fieldtype_id` `sequencenr`) USING BTREE ) ENGINE=MyISAM DEFAULT CHARSET=utf8   compare failed .   db : TableMeta [schema=bboss  table=hierquerysellist_fields  fileds= 	FieldMeta [columnName=fieldtype_id  columnType=bigint(20)  defaultValue=null  nullable=false  key=true] 	FieldMeta [columnName=sequencenr  columnType=smallint(6)  defaultValue=null  nullable=false  key=true] 	FieldMeta [columnName=fieldname  columnType=varchar(50)  defaultValue=null  nullable=false  key=false] ]   mem : TableMeta [schema=bboss  table=hierquerysellist_fields  fileds= 	FieldMeta [columnName=fieldtype_id  columnType=bigint(20)  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=sequencenr  columnType=smallint(6)  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=fieldname  columnType=varchar(50)  defaultValue=null  nullable=false  key=false] ] 2018-05-28 14:38:20.005 [destination = myexample   address = /172.16.9.11:3307   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - pls submit github issue  show create table ddl:CREATE TABLE `linkquerysellist` (   `fieldtype_id` bigint(20) NOT NULL   `whereclause` longtext NOT NULL   `filtervariants` char(1) NOT NULL   UNIQUE KEY `fieldtype_id` (`fieldtype_id`) USING BTREE ) ENGINE=MyISAM DEFAULT CHARSET=utf8   compare failed .   db : TableMeta [schema=bboss  table=linkquerysellist  fileds= 	FieldMeta [columnName=fieldtype_id  columnType=bigint(20)  defaultValue=null  nullable=false  key=true] 	FieldMeta [columnName=whereclause  columnType=longtext  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=filtervariants  columnType=char(1)  defaultValue=null  nullable=false  key=false] ]   mem : TableMeta [schema=bboss  table=linkquerysellist  fileds= 	FieldMeta [columnName=fieldtype_id  columnType=bigint(20)  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=whereclause  columnType=longtext  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=filtervariants  columnType=char(1)  defaultValue=null  nullable=false  key=false] ] 2018-05-28 14:38:20.837 [destination = myexample   address = /172.16.9.11:3307   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - pls submit github issue  show create table ddl:CREATE TABLE `parentlinkedsellist` (   `fieldtype_id` bigint(20) NOT NULL   `whereclause` longtext NOT NULL   `filtervariants` char(1) NOT NULL   `linkfield` varchar(50) NOT NULL   UNIQUE KEY `fieldtype_id` (`fieldtype_id`) USING BTREE ) ENGINE=MyISAM DEFAULT CHARSET=utf8   compare failed .   db : TableMeta [schema=bboss  table=parentlinkedsellist  fileds= 	FieldMeta [columnName=fieldtype_id  columnType=bigint(20)  defaultValue=null  nullable=false  key=true] 	FieldMeta [columnName=whereclause  columnType=longtext  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=filtervariants  columnType=char(1)  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=linkfield  columnType=varchar(50)  defaultValue=null  nullable=false  key=false] ]   mem : TableMeta [schema=bboss  table=parentlinkedsellist  fileds= 	FieldMeta [columnName=fieldtype_id  columnType=bigint(20)  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=whereclause  columnType=longtext  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=filtervariants  columnType=char(1)  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=linkfield  columnType=varchar(50)  defaultValue=null  nullable=false  key=false] ] 2018-05-28 14:38:21.359 [destination = myexample   address = /172.16.9.11:3307   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - pls submit github issue  show create table ddl:CREATE TABLE `querysellist` (   `fieldtype_id` bigint(20) NOT NULL   `query` longtext NOT NULL   `filtervariants` char(1) NOT NULL   `sort_order` varchar(1) NOT NULL   UNIQUE KEY `fieldtype_id` (`fieldtype_id`) USING BTREE ) ENGINE=MyISAM DEFAULT CHARSET=utf8   compare failed .   db : TableMeta [schema=bboss  table=querysellist  fileds= 	FieldMeta [columnName=fieldtype_id  columnType=bigint(20)  defaultValue=null  nullable=false  key=true] 	FieldMeta [columnName=query  columnType=longtext  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=filtervariants  columnType=char(1)  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=sort_order  columnType=varchar(1)  defaultValue=null  nullable=false  key=false] ]   mem : TableMeta [schema=bboss  table=querysellist  fileds= 	FieldMeta [columnName=fieldtype_id  columnType=bigint(20)  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=query  columnType=longtext  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=filtervariants  columnType=char(1)  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=sort_order  columnType=varchar(1)  defaultValue=null  nullable=false  key=false] ] 2018-05-28 14:38:28.334 [destination = myexample   address = /172.16.9.11:3307   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - compare failed   check log 2018-05-28 14:38:28.356 [destination = myexample   address = /172.16.9.11:3307   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /172.16.9.11:3307 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: can't find init table meta for myexample with position : EntryPosition[included=false journalName=mysql-bin.000001 position=1314 serverId=1 timestamp=1527489302000] 2018-05-28 14:38:28.359 [destination = myexample   address = /172.16.9.11:3307   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:myexample[com.alibaba.otter.canal.parse.exception.CanalParseException: can't find init table meta for myexample with position : EntryPosition[included=false journalName=mysql-bin.000001 position=1314 serverId=1 timestamp=1527489302000] ] 2018-05-28 14:38:40.151 [destination = myexample   address = /172.16.9.11:3307   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just show master status 2018-05-28 14:40:01.773 [destination = myexample   address = /172.16.9.11:3307   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TABLE `columns_priv` (   `Host` char(60) COLLATE utf8_bin NOT NULL DEFAULT ''   `Db` char(64) COLLATE utf8_bin NOT NULL DEFAULT ''   `User` char(16) COLLATE utf8_bin NOT NULL DEFAULT ''   `Table_name` char(64) COLLATE utf8_bin NOT NULL DEFAULT ''   `Column_name` char(64) COLLATE utf8_bin NOT NULL DEFAULT ''   `Timestamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP   `Column_priv` set('Select' 'Insert' 'Update' 'References') CHARACTER SET utf8 NOT NULL DEFAULT ''   PRIMARY KEY (`Host` `Db` `User` `Table_name` `Column_name`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='Column privileges' com.alibaba.druid.sql.parser.ParserException: error pos 428  line 8  column 17  token SET 	at com.alibaba.druid.sql.parser.SQLExprParser.name(SQLExprParser.java:1334) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLExprParser.parseDataType(SQLExprParser.java:2310) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLExprParser.parseDataType(SQLExprParser.java:2301) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlExprParser.parseColumn(MySqlExprParser.java:493) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlCreateTableParser.parseCreateTable(MySqlCreateTableParser.java:115) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseCreate(MySqlStatementParser.java:244) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:159) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:464) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:295) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:69) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.25.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_101] 2018-05-28 14:40:01.775 [destination = myexample   address = /172.16.9.11:3307   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TABLE `db` (   `Host` char(60) COLLATE utf8_bin NOT NULL DEFAULT ''   `Db` char(64) COLLATE utf8_bin NOT NULL DEFAULT ''   `User` char(16) COLLATE utf8_bin NOT NULL DEFAULT ''   `Select_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Insert_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Update_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Delete_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Drop_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Grant_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `References_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Index_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Alter_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_tmp_table_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Lock_tables_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_view_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Show_view_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_routine_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Alter_routine_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Execute_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Event_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Trigger_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   PRIMARY KEY (`Host` `Db` `User`)   KEY `User` (`User`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='Database privileges' com.alibaba.druid.sql.parser.ParserException: syntax error  error in :''Y') CHARACTER SET utf8 NOT NULL DE'  expect RPAREN  actual IDENTIFIER pos 225  line 5  column 31  token IDENTIFIER CHARACTER 	at com.alibaba.druid.sql.parser.SQLParser.printError(SQLParser.java:284) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLParser.accept(SQLParser.java:292) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlCreateTableParser.parseCreateTable(MySqlCreateTableParser.java:191) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseCreate(MySqlStatementParser.java:244) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:159) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:464) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:295) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:69) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.25.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_101] 2018-05-28 14:40:01.776 [destination = myexample   address = /172.16.9.11:3307   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TABLE `event` (   `db` char(64) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL DEFAULT ''   `name` char(64) NOT NULL DEFAULT ''   `body` longblob NOT NULL   `definer` char(77) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL DEFAULT ''   `execute_at` datetime DEFAULT NULL   `interval_value` int(11) DEFAULT NULL   `interval_field` enum('YEAR' 'QUARTER' 'MONTH' 'DAY' 'HOUR' 'MINUTE' 'WEEK' 'SECOND' 'MICROSECOND' 'YEAR_MONTH' 'DAY_HOUR' 'DAY_MINUTE' 'DAY_SECOND' 'HOUR_MINUTE' 'HOUR_SECOND' 'MINUTE_SECOND' 'DAY_MICROSECOND' 'HOUR_MICROSECOND' 'MINUTE_MICROSECOND' 'SECOND_MICROSECOND') DEFAULT NULL   `created` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP   `modified` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00'   `last_executed` datetime DEFAULT NULL   `starts` datetime DEFAULT NULL   `ends` datetime DEFAULT NULL   `status` enum('ENABLED' 'DISABLED' 'SLAVESIDE_DISABLED') NOT NULL DEFAULT 'ENABLED'   `on_completion` enum('DROP' 'PRESERVE') NOT NULL DEFAULT 'DROP'   `sql_mode` set('REAL_AS_FLOAT' 'PIPES_AS_CONCAT' 'ANSI_QUOTES' 'IGNORE_SPACE' 'NOT_USED' 'ONLY_FULL_GROUP_BY' 'NO_UNSIGNED_SUBTRACTION' 'NO_DIR_IN_CREATE' 'POSTGRESQL' 'ORACLE' 'MSSQL' 'DB2' 'MAXDB' 'NO_KEY_OPTIONS' 'NO_TABLE_OPTIONS' 'NO_FIELD_OPTIONS' 'MYSQL323' 'MYSQL40' 'ANSI' 'NO_AUTO_VALUE_ON_ZERO' 'NO_BACKSLASH_ESCAPES' 'STRICT_TRANS_TABLES' 'STRICT_ALL_TABLES' 'NO_ZERO_IN_DATE' 'NO_ZERO_DATE' 'INVALID_DATES' 'ERROR_FOR_DIVISION_BY_ZERO' 'TRADITIONAL' 'NO_AUTO_CREATE_USER' 'HIGH_NOT_PRECEDENCE' 'NO_ENGINE_SUBSTITUTION' 'PAD_CHAR_TO_FULL_LENGTH') NOT NULL DEFAULT ''   `comment` char(64) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL DEFAULT ''   `originator` int(10) unsigned NOT NULL   `time_zone` char(64) CHARACTER SET latin1 NOT NULL DEFAULT 'SYSTEM'   `character_set_client` char(32) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL   `collation_connection` char(32) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL   `db_collation` char(32) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL   `body_utf8` longblob   PRIMARY KEY (`db` `name`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COMMENT='Events' com.alibaba.druid.sql.parser.ParserException: error pos 1035  line 16  column 14  token SET 	at com.alibaba.druid.sql.parser.SQLExprParser.name(SQLExprParser.java:1334) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLExprParser.parseDataType(SQLExprParser.java:2310) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLExprParser.parseDataType(SQLExprParser.java:2301) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlExprParser.parseColumn(MySqlExprParser.java:493) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlCreateTableParser.parseCreateTable(MySqlCreateTableParser.java:115) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseCreate(MySqlStatementParser.java:244) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:159) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:464) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:295) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:69) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.25.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_101] 2018-05-28 14:40:01.778 [destination = myexample   address = /172.16.9.11:3307   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TABLE `func` (   `name` char(64) COLLATE utf8_bin NOT NULL DEFAULT ''   `ret` tinyint(1) NOT NULL DEFAULT '0'   `dl` char(128) COLLATE utf8_bin NOT NULL DEFAULT ''   `type` enum('function' 'aggregate') CHARACTER SET utf8 NOT NULL   PRIMARY KEY (`name`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='User defined functions' com.alibaba.druid.sql.parser.ParserException: syntax error  error in :'te') CHARACTER SET utf8 NOT NULL  '  expect RPAREN  actual IDENTIFIER pos 221  line 5  column 39  token IDENTIFIER CHARACTER 	at com.alibaba.druid.sql.parser.SQLParser.printError(SQLParser.java:284) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLParser.accept(SQLParser.java:292) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlCreateTableParser.parseCreateTable(MySqlCreateTableParser.java:191) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseCreate(MySqlStatementParser.java:244) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:159) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:464) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:295) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:69) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.25.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_101] 2018-05-28 14:40:01.780 [destination = myexample   address = /172.16.9.11:3307   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TABLE `proc` (   `db` char(64) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL DEFAULT ''   `name` char(64) NOT NULL DEFAULT ''   `type` enum('FUNCTION' 'PROCEDURE') NOT NULL   `specific_name` char(64) NOT NULL DEFAULT ''   `language` enum('SQL') NOT NULL DEFAULT 'SQL'   `sql_data_access` enum('CONTAINS_SQL' 'NO_SQL' 'READS_SQL_DATA' 'MODIFIES_SQL_DATA') NOT NULL DEFAULT 'CONTAINS_SQL'   `is_deterministic` enum('YES' 'NO') NOT NULL DEFAULT 'NO'   `security_type` enum('INVOKER' 'DEFINER') NOT NULL DEFAULT 'DEFINER'   `param_list` blob NOT NULL   `returns` longblob NOT NULL   `body` longblob NOT NULL   `definer` char(77) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL DEFAULT ''   `created` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP   `modified` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00'   `sql_mode` set('REAL_AS_FLOAT' 'PIPES_AS_CONCAT' 'ANSI_QUOTES' 'IGNORE_SPACE' 'NOT_USED' 'ONLY_FULL_GROUP_BY' 'NO_UNSIGNED_SUBTRACTION' 'NO_DIR_IN_CREATE' 'POSTGRESQL' 'ORACLE' 'MSSQL' 'DB2' 'MAXDB' 'NO_KEY_OPTIONS' 'NO_TABLE_OPTIONS' 'NO_FIELD_OPTIONS' 'MYSQL323' 'MYSQL40' 'ANSI' 'NO_AUTO_VALUE_ON_ZERO' 'NO_BACKSLASH_ESCAPES' 'STRICT_TRANS_TABLES' 'STRICT_ALL_TABLES' 'NO_ZERO_IN_DATE' 'NO_ZERO_DATE' 'INVALID_DATES' 'ERROR_FOR_DIVISION_BY_ZERO' 'TRADITIONAL' 'NO_AUTO_CREATE_USER' 'HIGH_NOT_PRECEDENCE' 'NO_ENGINE_SUBSTITUTION' 'PAD_CHAR_TO_FULL_LENGTH') NOT NULL DEFAULT ''   `comment` text CHARACTER SET utf8 COLLATE utf8_bin NOT NULL   `character_set_client` char(32) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL   `collation_connection` char(32) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL   `db_collation` char(32) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL   `body_utf8` longblob   PRIMARY KEY (`db` `name` `type`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COMMENT='Stored Procedures' com.alibaba.druid.sql.parser.ParserException: error pos 864  line 16  column 14  token SET 	at com.alibaba.druid.sql.parser.SQLExprParser.name(SQLExprParser.java:1334) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLExprParser.parseDataType(SQLExprParser.java:2310) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLExprParser.parseDataType(SQLExprParser.java:2301) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlExprParser.parseColumn(MySqlExprParser.java:493) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlCreateTableParser.parseCreateTable(MySqlCreateTableParser.java:115) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseCreate(MySqlStatementParser.java:244) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:159) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:464) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:295) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:69) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.25.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_101] 2018-05-28 14:40:01.783 [destination = myexample   address = /172.16.9.11:3307   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TABLE `procs_priv` (   `Host` char(60) COLLATE utf8_bin NOT NULL DEFAULT ''   `Db` char(64) COLLATE utf8_bin NOT NULL DEFAULT ''   `User` char(16) COLLATE utf8_bin NOT NULL DEFAULT ''   `Routine_name` char(64) CHARACTER SET utf8 NOT NULL DEFAULT ''   `Routine_type` enum('FUNCTION' 'PROCEDURE') COLLATE utf8_bin NOT NULL   `Grantor` char(77) COLLATE utf8_bin NOT NULL DEFAULT ''   `Proc_priv` set('Execute' 'Alter Routine' 'Grant') CHARACTER SET utf8 NOT NULL DEFAULT ''   `Timestamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP   PRIMARY KEY (`Host` `Db` `User` `Routine_name` `Routine_type`)   KEY `Grantor` (`Grantor`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='Procedure privileges' com.alibaba.druid.sql.parser.ParserException: syntax error  error in :'RE') COLLATE utf8_bin NOT NULL   `'  expect RPAREN  actual IDENTIFIER pos 313  line 6  column 47  token IDENTIFIER COLLATE 	at com.alibaba.druid.sql.parser.SQLParser.printError(SQLParser.java:284) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLParser.accept(SQLParser.java:292) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlCreateTableParser.parseCreateTable(MySqlCreateTableParser.java:191) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseCreate(MySqlStatementParser.java:244) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:159) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:464) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:295) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:69) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.25.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_101] 2018-05-28 14:40:01.789 [destination = myexample   address = /172.16.9.11:3307   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTab` ä½¿ç”¨ mysql é…ç½®å åˆæœ‰ä¸‹é¢çš„é”™è¯¯ `2018-05-28 15:06:27.531 [destination = myexample   address = /172.16.9.11:3307   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TABLE `user` (   `Host` char(60) COLLATE utf8_bin NOT NULL DEFAULT ''   `User` char(16) COLLATE utf8_bin NOT NULL DEFAULT ''   `Password` char(41) CHARACTER SET latin1 COLLATE latin1_bin NOT NULL DEFAULT ''   `Select_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Insert_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Update_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Delete_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Drop_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Reload_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Shutdown_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Process_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `File_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Grant_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `References_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Index_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Alter_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Show_db_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Super_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_tmp_table_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Lock_tables_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Execute_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Repl_slave_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Repl_client_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_view_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Show_view_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_routine_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Alter_routine_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_user_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Event_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Trigger_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_tablespace_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `ssl_type` enum('' 'ANY' 'X509' 'SPECIFIED') CHARACTER SET utf8 NOT NULL DEFAULT ''   `ssl_cipher` blob NOT NULL   `x509_issuer` blob NOT NULL   `x509_subject` blob NOT NULL   `max_questions` int(11) unsigned NOT NULL DEFAULT '0'   `max_updates` int(11) unsigned NOT NULL DEFAULT '0'   `max_connections` int(11) unsigned NOT NULL DEFAULT '0'   `max_user_connections` int(11) unsigned NOT NULL DEFAULT '0'   `plugin` char(64) COLLATE utf8_bin DEFAULT ''   `authentication_string` text COLLATE utf8_bin   `password_expired` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   PRIMARY KEY (`Host` `User`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='Users and global privileges'` æ¢æˆ26ç‰ˆæœ¬è¯•è¯•ï¼Œè¿™æ˜¯25ç‰ˆæœ¬çš„bugã€‚ æˆ‘å‡çº§åˆ°26ä¹Ÿæ˜¯è¿™ä¸ªé—®é¢˜ã€‚ä¸è¿‡ï¼Œæˆ‘æ„Ÿè§‰è¿™åƒæ˜¯ä¸ªæƒé™é—®é¢˜ï¼Œæˆ‘ç»™mysqlä¸­çš„canalç”¨æˆ·èµ‹äº†å…¨éƒ¨æƒé™ï¼Œå°±æ²¡é—®é¢˜äº†ã€‚ GRANT ALL PRIVILEGES ON *.* TO 'canal'@'%' ; FLUSH PRIVILEGES; LSæ­£è§£ ç‰ˆæœ¬v1.0.25 å¼€å¯ tsdbä¹‹åï¼Œ å‡ºç°è¿™ç§é”™è¯¯ã€‚åˆ é™¤ä¹‹åå°±å¥½äº†
658,canalå¯åŠ¨æŠ¥é”™ï¼ˆv1.0.25ï¼‰ 2018-05-28 01:42:57.009 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## the canal server is running now ...... 2018-05-28 01:42:57.876 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just show master status 2018-05-28 01:44:10.494 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  com.taobao.tddl.dbsync.binlog.CharsetConversion - Unexpect mysql charset: 246 2018-05-28 01:44:10.495 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  com.taobao.tddl.dbsync.binlog.CharsetConversion - Unexpect mysql charset: 246 2018-05-28 01:44:10.495 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  com.taobao.tddl.dbsync.binlog.CharsetConversion - Unexpect mysql charset: 246 2018-05-28 01:44:10.495 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  com.taobao.tddl.dbsync.binlog.LogEvent - unsupported character set in query log:  è¿™æ˜¯è­¦å‘Š ä¸æ˜¯é”™è¯¯ @agapple @DevWithLin ä¸¤ä¸ªcanalå®ç°ä¸»å¤‡æ¨¡å¼å…¶slaveIdæ˜¯å¦è¦ç›¸åŒï¼ˆä»…ä¸€ä¸ªå·¥ä½œï¼‰ï¼Ÿ ä¸»å¤‡æ¨¡å¼ï¼Œåº”è¯¥ä¸ç›¸åŒæ‰æ˜¯ã€‚1.0.26ä¼šé»˜è®¤éšæœºç”Ÿæˆä¸€ä¸ª
657,æå‡ºä¸€ä¸ªå…³äºMemoryMetaManagerä¼˜åŒ–çš„å»ºè®® åœ¨é¡¹ç›®è¿è¡Œå¯åŠ¨è®¢é˜…æ—¶æœ‰é‡åˆ°ä¸€ä¸ªå¼‚å¸¸(é¡¹ç›®é‡‡ç”¨çš„æ˜¯CanalServerWithEmbeddedå†…åµŒï¼Œå…³é”®çš„é…ç½®MetaMode.MIXED & IndexMode.MEMORY_META_FAILBACK)ï¼Œæ ˆè¾“å‡ºå¦‚ä¸‹ï¼š ``` dump address /xxx.xx.xx.xxx:3306 has an error  retrying. caused by  java.util.ConcurrentModificationException 	at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:901)  	at java.util.ArrayList$Itr.next(ArrayList.java:851)  	at com.alibaba.otter.canal.parse.index.MetaLogPositionManager.getLatestIndexBy(MetaLogPositionManager.java:56)  	at com.alibaba.otter.canal.parse.index.FailbackLogPositionManager.getLatestIndexBy(FailbackLogPositionManager.java:68)  	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPositionInternal(MysqlEventParser.java:567)  	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPosition(MysqlEventParser.java:509) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:167)  	at java.lang.Thread.run(Thread.java:745)  ``` çœ‹ä»£ç å‘ç°CanalServerWithEmbeddedä¸­çš„subscribeæ–¹æ³•ä¸­æœ‰è°ƒç”¨MetaManagerçš„**subscribe**æ–¹æ³•ï¼Œæœ€ç»ˆä¼šè°ƒç”¨åˆ°MemoryMetaManagerçš„subscribeæ–¹æ³•ï¼Œåœ¨å¾—åˆ°destinationsä¸­keyå¯¹åº”çš„liståï¼Œä¿®æ”¹listï¼ˆå‘listé‡Œaddå…ƒç´ ï¼‰ã€‚ä»£ç : ```     public synchronized void subscribe(ClientIdentity clientIdentity) throws CanalMetaManagerException {         List<ClientIdentity> clientIdentitys = destinations.get(clientIdentity.getDestination());         if (clientIdentitys.contains(clientIdentity)) {             clientIdentitys.remove(clientIdentity);         }         clientIdentitys.add(clientIdentity);     } ``` è€ŒMemoryMetaManagerç±»ä¸­è¿˜æœ‰ä¸€ä¸ªæ–¹æ³•**listAllSubscribeInfo**ä¼šç›´æ¥è¿”å›destinationsä¸­keyå¯¹åº”çš„listã€‚ä»£ç ï¼š ```     public synchronized List<ClientIdentity> listAllSubscribeInfo(String destination) throws CanalMetaManagerException {         return destinations.get(destination);     } ``` æˆ‘é‡åˆ°çš„é—®é¢˜æ˜¯åœ¨MetaLogPositionManagerçš„getLatestIndexByæ–¹æ³•éå†metaManager.listAllSubscribeInfoè°ƒç”¨ç»“æœæ—¶ï¼Œä¸šåŠ¡ä»£ç çº¿ç¨‹è°ƒç”¨äº†subscribeæ–¹æ³•ä¿®æ”¹äº†éå†çš„listé›†åˆï¼Œå¯¼è‡´äº†ConcurrentModificationExceptionã€‚ ```     public LogPosition getLatestIndexBy(String destination) {         List<ClientIdentity> clientIdentities = metaManager.listAllSubscribeInfo(destination);         LogPosition result = null;         if (!CollectionUtils.isEmpty(clientIdentities)) {             // å°è¯•æ‰¾åˆ°ä¸€ä¸ªæœ€å°çš„logPosition             for (ClientIdentity clientIdentity : clientIdentities) {  //åœ¨æ­¤å¤„éå†æ—¶é“¾è¡¨è¢«å…¶å®ƒçº¿ç¨‹ä¿®æ”¹                 LogPosition position = (LogPosition) metaManager.getCursor(clientIdentity);                 if (position == null) {                     continue;                 }                 if (result == null) {                     result = position;                 } else {                     result = CanalEventUtils.min(result  position);                 }             }         }         return result;     } ``` è¿™é‡Œæ„Ÿè§‰åœ¨MemoryMetaManagerä¸­çš„listAllSubscribeInfoæ–¹æ³•æœ‰æ¯”è¾ƒå¤§çš„éšæ‚£ï¼Œå¤–éƒ¨æ‹¿åˆ°å¼•ç”¨ä»¥åå¯èƒ½åœ¨ä¸åŒçš„çº¿ç¨‹ä¸­åšéå†æˆ–è€…ä¿®æ”¹ã€‚ å¦‚æœè¿™é‡Œæ¯æ¬¡éƒ½æ‹·è´ä¸€ä¸ªæ–°listè¿”å›çš„è¯ä¸çŸ¥é“å¯¹æ•ˆç‡ä¸Šçš„æŸå¤±æ˜¯å¦å¤ªå¤§ï¼Œå¦‚æœä¸å¸Œæœ›è¿‡å¤šæ‹·è´çš„è¯å¯ä»¥è¿”å›unmodifiableListï¼Œé˜»æ­¢å…¶ä»–ç±»å¯¹è¿™ä¸ªé›†åˆçš„ä¿®æ”¹ï¼Œä½†æ˜¯è¿™æ ·åœ¨å…¶å®ƒç±»éå†è¿™ä¸ªé›†åˆæ—¶è¿˜æ˜¯å¯èƒ½å‡ºç°æˆ‘è¿™ç§ConcurrentModificationExceptionã€‚ æƒ³é—®ä¸€ä¸‹ä½ å¯¹è¿™ä¸ªé—®é¢˜æ˜¯æ€ä¹ˆè€ƒè™‘çš„å‘¢ @agapple æˆ‘ä¹Ÿé‡åˆ°è¿™ä¸ªé—®é¢˜äº†ï¼Œæˆ‘æ˜¯åœ¨å¤šä¸ªclientè®¢é˜…ä¸€ä¸ªdestinationçš„åœºæ™¯ ` 2018-05-29 15:02:37.929 ERROR [test-firehose-20] c.a.o.c.c.a.LogAlarmHandler:19 - destination:test-firehose-20[java.util.ConcurrentModificationException 	at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:901) 	at java.util.ArrayList$Itr.next(ArrayList.java:851) 	at com.alibaba.otter.canal.parse.index.MetaLogPositionManager.getLatestIndexBy(MetaLogPositionManager.java:56) 	at com.alibaba.otter.canal.parse.index.FailbackLogPositionManager.getLatestIndexBy(FailbackLogPositionManager.java:68) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPositionInternal(MysqlEventParser.java:405) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPosition(MysqlEventParser.java:347) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:164) 	at java.lang.Thread.run(Thread.java:748) ` listAllSubscribeInfoä¿®æ”¹ä¸ºè¿”å›ä¸€ä¸ªæ‹·è´å¯¹è±¡
656,æœ€æ–°releaseç‰ˆæœ¬ä¸­ regex è¿‡æ»¤ä¸èµ·ä½œç”¨ canal-server é…ç½®äº†regexå¦‚ä¸‹ canal.instance.dbUsername=canal canal.instance.dbPassword=canal canal.instance.defaultDatabaseName=EDU_DISCOUNT_PRICE_TEST canal.instance.connectionCharset=UTF-8 # table regex #canal.instance.filter.regex=.*\\..* canal.instance.filter.regex=EDU_DISCOUNT_PRICE_TEST\\..* # table black regex #canal.instance.filter.black.regex=ONLINE_EDU_TEST\\..* ################################################# Client ä»£ç  connector.subscribe("EDU_DISCOUNT_PRICE_TEST.t_online_discount"); åŒæ ·é…ç½®äº†è¿‡æ»¤ï¼Œä½†æ˜¯ä»ç„¶æœ‰ä¸ç›¸å…³çš„åº“çš„è¡¨æ›´æ–°ä¿¡æ¯ã€‚æ•°æ®åº“ç¡®è®¤binlogæ ¼å¼ä¸º ROW canal å®šä½é—®é¢˜çœŸçš„å¾ˆä¸æ–¹ä¾¿ã€‚ã€‚ã€‚QQç¾¤ä¹ŸåŠ ä¸è¿›å»ï¼Œæ±‚è§£ç­”ã€‚ `connector.subscribe("EDU_DISCOUNT_PRICE_TEST.t_online_discount"); ` æ”¹æˆ `connector.subscribe("EDU_DISCOUNT_PRICE_TEST\\.t_online_discount");` LSæ­£è§£
655,SimpleCanalClientTest è¿Canal ä¸€ç›´æŠ¥NullPointerException é”™è¯¯ æŒ‰ç…§QuickStart å’Œ ClientSample æ­å»ºäº†Canal ç¯å¢ƒï¼Œä½†è·‘SimpleCanalClientTest ä¸€ç›´æŠ¥ä¸€ä¸ªNullPointerException é”™è¯¯ï¼Œåå¤å¯¹ç…§æ£€æŸ¥äº†é…ç½®ç«¯å£ç­‰ï¼Œçš„ç¡®æ²¡å‘ç°ä»€ä¹ˆé—®é¢˜ï¼Œæœ›èƒ½ç»™ç‚¹å»ºè®®æ’æŸ¥é”™è¯¯ï¼Œå…·ä½“é”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼š 2018-05-26 19:53:29.679 [Thread-1] ERROR com.alibaba.otter.canal.example.AbstractCanalClientTest - process error! java.lang.NullPointerException: null 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.writeWithHeader(SimpleCanalConnector.java:392) ~[classes/:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.writeWithHeader(SimpleCanalConnector.java:380) ~[classes/:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:292) ~[classes/:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:280) ~[classes/:na] 	at com.alibaba.otter.canal.example.AbstractCanalClientTest.process(AbstractCanalClientTest.java:125) ~[classes/:na] é—®é¢˜æ‰¾åˆ°äº†ï¼Œæ˜¯æœ¬åœ°1.26 snapshot ç‰ˆæœ¬çš„æºä»£ç æ²¡æœ‰buildæˆåŠŸå¯¼è‡´çš„ï¼Œæ¢æˆ1.25 æˆåŠŸbuild åï¼Œé—®é¢˜æ¶ˆå¤±
654,æœåŠ¡ç«¯æ€»æ˜¯æ„å¤–å…³é—­ ç‰ˆæœ¬1.0.22 ![image](https://user-images.githubusercontent.com/15358736/40471583-a9d97202-5f69-11e8-8c22-ae02a30da03a.png) è¿›ç¨‹æ„å¤–ç»ˆæ­¢ æ˜¯å› ä¸ºsqlæŠ¥é”™è¿‡å¤šå— å»ºè®®ä½¿ç”¨1.0.26ç‰ˆæœ¬
653,ROWæ¨¡å¼ä¸‹rowChangeï¼ševentType = 'query' show binlog events ç»“æœå¦‚ä¸‹ï¼š ![aaaaaaaaaa](https://user-images.githubusercontent.com/21019407/40354822-61a69268-5de7-11e8-9809-49405492b60f.jpg) å®¢æˆ·ç«¯æ¶ˆè´¹æ—¶Entryæ•°é‡ä¸º3ï¼Œåˆ†åˆ«æ˜¯TRANSACTIONBEGINï¼ŒROWDATAå’ŒTRANSACTIONENDï¼Œå…¶ä¸­ROWDATAè§£æårowChangeæ‰“å°å¦‚ä¸‹ï¼š ![bbbbbbbbbb](https://user-images.githubusercontent.com/21019407/40354993-e068b05e-5de7-11e8-9cd9-985081534f54.jpg) å¯¹åº”binlogé…ç½®ï¼š ![ccccccccc](https://user-images.githubusercontent.com/21019407/40355107-26765a9c-5de8-11e8-9907-80a065b961f9.jpg) å®¢æˆ·ç«¯é…ç½®é”™è¯¯ï¼Œå¯¼è‡´canalæœåŠ¡ç«¯å¿½ç•¥äº†å¯¹åº”è¡¨çš„binlog
652,parser  information_schemaä¸­çš„è¡¨å‡ºé”™ 2018-05-22 15:12:39.374 [destination = example   address = zhenghongchen.cn/60.205.220.19:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TEMPORARY TABLE `SYSTEM_VARIABLES` (   `VARIABLE_NAME` varchar(64) NOT NULL DEFAULT ''   `SESSION_VALUE` varchar(2048) DEFAULT NULL   `GLOBAL_VALUE` varchar(2048) DEFAULT NULL   `GLOBAL_VALUE_ORIGIN` varchar(64) NOT NULL DEFAULT ''   `DEFAULT_VALUE` varchar(2048) DEFAULT NULL   `VARIABLE_SCOPE` varchar(64) NOT NULL DEFAULT ''   `VARIABLE_TYPE` varchar(64) NOT NULL DEFAULT ''   `VARIABLE_COMMENT` varchar(2048) NOT NULL DEFAULT ''   `NUMERIC_MIN_VALUE` varchar(21) DEFAULT NULL   `NUMERIC_MAX_VALUE` varchar(21) DEFAULT NULL   `NUMERIC_BLOCK_SIZE` varchar(21) DEFAULT NULL   `ENUM_VALUE_LIST` longtext DEFAULT NULL   `READ_ONLY` varchar(3) NOT NULL DEFAULT ''   `COMMAND_LINE_ARGUMENT` varchar(64) DEFAULT NULL ) ENGINE=Aria DEFAULT CHARSET=utf8 PAGE_CHECKSUM=0 com.alibaba.fastsql.sql.parser.ParserException: syntax error  error in :'utf8 PAGE_CHECKSUM=0'  expect IDENTIFIER  actual IDENTIFIER pos 781  line 16  column 50  token IDENTIFIER PAGE_CHECKSUM 	at com.alibaba.fastsql.sql.parser.SQLParser.printError(SQLParser.java:305) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186] 	at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:427) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186] 	at com.alibaba.fastsql.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:76) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186] 	at com.alibaba.fastsql.sql.SQLUtils.parseStatements(SQLUtils.java:469) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186] 	at com.alibaba.fastsql.sql.repository.SchemaRepository.console(SchemaRepository.java:331) ~[fastsql-2.0.0_preview_186.jar:2.0.0_preview_186] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:71) ~[classes/:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [classes/:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [classes/:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:84) [classes/:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:173) [classes/:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_51] æ‰¾åˆ°åŸå› æ˜¯ï¼Œfastsql-2.0.0_preview_186.jarå¯¹MariaDBçš„ariaå¼•æ“çš„è¡¨æ”¯æŒçš„ä¸å¥½ ç‰ˆæœ¬1.0.26-SNAPSHOT
651,blobå­—æ®µå¦‚ä½•åŒæ­¥ï¼Ÿ blobå­—æ®µç”¨column.getValue()çš„è¯æ˜¯ä¸ªstringæ— æ³•å†è½¬ä¸ºbyte[]ï¼Œå…¶ä¸­æœ‰ä¸ªä¸€ä¸ªcolumn.getValueBytes()æ–¹æ³•å¥½åƒä¹Ÿæ— æ³•è·å–ä»–åŸå…ˆçš„byte[]å€¼
650,mysql5.7æ–°å»ºè¡¨ä¼šå¯¼è‡´canalæœåŠ¡å™¨æŒ‚èµ· ![qq 20180522085329](https://user-images.githubusercontent.com/30070755/40336666-a225b214-5d9d-11e8-9257-389d5d78cd0c.png) å»ºè®®ä½¿ç”¨1.0.26ç‰ˆæœ¬
649,fastsqlçš„previewåŒ…æ— æ³•ä¸‹è½½ æ‹‰å–æœ€æ–°çš„masterä»£ç åï¼Œæœ¬åœ°ç¼–è¯‘å¤±è´¥ï¼Œæ— æ³•ä¸‹è½½fastsqlçš„previewåŒ…ã€‚ mavenåœ°å€ä¸ºï¼š ```  <dependency>                 <groupId>com.alibaba.fastsql</groupId>                 <artifactId>fastsql</artifactId>                 <version>2.0.0_preview_228</version> </dependency> ```
648,TSDB show create tableæ—¶æ²¡è¿‡æ»¤View å¼€å¯TSDBä¹‹åï¼Œå‡ºç°show create tableæ‰¾ä¸åˆ°è¡¨çš„æƒ…å†µï¼Œä»”ç»†ä¸€çœ‹æ˜¯å› ä¸ºæˆ‘ä»¬çš„åº“ä¸­æœ‰ä¸€äº›viewã€‚ å…¶å®æˆ‘æœ‰ç‚¹ä¸æ˜ç™½å³æ˜¯å› ä¸ºè¦ç”¨ show create tableå‘¢ï¼Ÿåƒä¹‹å‰ä¸€æ ·ç”¨ describe tablename çš„æ–¹å¼ä¸æ˜¯å¾ˆå¥½å—ï¼Ÿ show create tableå¤±è´¥ä¹‹åä¼šå›é€€åˆ°desc table name.  ä¸»è¦ä¸ºè§£å†³unique keyçš„è·å–ï¼Œshow create tableé’ˆå¯¹å¤šä¸ªå”¯ä¸€é”®æ—¶å¯ä»¥æ­£ç¡®æå–
647,rds_instance.propertiesé…ç½®æ–‡ä»¶ä¸­çš„å‡ ä¸ªå‚æ•° canal.instance.rds.open.accesskey= canal.instance.rds.open.secretkey= canal.instance.rds.instanceId= canal.instance.rds.startTime= canal.instance.rds.endTime= è¿™å‡ ä¸ªå‚æ•°å¥½åƒåœ¨ä»‹ç»ä¸­æ²¡æœ‰è¯´æ˜æ„æ€ã€‚ éº»çƒ¦ç»™æä¾›ä¸‹ã€‚ è¦è®¾ç½®ä»å›ºå®šbinlogæ–‡ä»¶çš„ä½ç‚¹è¯»æ•°æ®ï¼Œè¿˜æ˜¯ç”¨ canal.instance.master.journal.name= canal.instance.master.position= canal.instance.master.timestamp= çš„é…ç½®å—ï¼Ÿä½†æ˜¯é…ç½®å®Œåï¼Œåˆ é™¤ meta.dat åæ²¡æœ‰ç”Ÿæ•ˆï¼Œçœ‹åˆ°meta.daté‡Œè¿˜æ˜¯ä¹‹å‰çš„ä½ç‚¹è€Œä¸æ˜¯è‡ªå·±è®¾ç½®çš„ä½ç‚¹ã€‚ 
646,a little improve about the safety of canal high available å› ä¸ºåœé¡¿å¯¼è‡´çš„zookeeperä¼šè¯è¶…æ—¶(ä¾‹å¦‚gc)  å†æ¬¡initRunningå¤±è´¥(`å³ä½¿åˆ«çš„canal serverå»¶è¿ŸinitRunning`)  éœ€è¦åœæ­¢å¯¹binglogçš„è®¢é˜…  @agapple å…³äºè¿™ä¸ªå‰é¢æˆ‘ä»¬æœ‰è¿‡ç®€çŸ­çš„è®¨è®º è§ #600   æˆ‘åšäº†ä¸€äº›ä¼˜åŒ–   è¯·reviewä¸€ä¸‹ @agapple éº»çƒ¦çœ‹ä¸€ä¸‹  3Q ^-^ @spccold ä¸ºå•¥å…³é—­äº†ï¼Ÿ
645,a little improve about the safety of canal high available  å› ä¸ºåœé¡¿å¯¼è‡´çš„zookeeperä¼šè¯è¶…æ—¶(ä¾‹å¦‚gc)  å†æ¬¡initRunningå¤±è´¥(`å³ä½¿åˆ«çš„canal serverå»¶è¿ŸinitRunning`)  éœ€è¦åœæ­¢å¯¹binglogçš„è®¢é˜…  @agapple å…³äºè¿™ä¸ªå‰é¢æˆ‘ä»¬æœ‰è¿‡ç®€çŸ­çš„è®¨è®º è§ #600   æˆ‘åšäº†ä¸€äº›ä¼˜åŒ–   è¯·reviewä¸€ä¸‹ [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=645) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=645) before we can accept your contribution.<br/><hr/>**wuwo** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=645) it.</sub> [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=645) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=645) before we can accept your contribution.<br/><hr/>**wuwo** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=645) it.</sub> see #646 
644,A slave with the same server_uuid/server_id as this slave has connected to the master MANAGER/NODE4.2.14åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¸æ–­å‡ºç°ç›¸åŒçš„server_uuid/server_idï¼Œä¸çŸ¥è¯¥å¦‚ä½•æ¶ˆé™¤è¿™ä¸ªé”™è¯¯ï¼Ÿ pid:31 nid:11 exception:canal:MiddleEast:java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = A slave with the same server_uuid/server_id as this slave has connected to the master; the first event 'mysql-bin.000011' at 77235  the last event read from './mysql-bin.000012' at 150  the last byte read from './mysql-bin.000012' at 150.     at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95)     at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:121)     at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209)     at java.lang.Thread.run(Thread.java:748) è¿™ä¸ªé—®é¢˜é€šè¿‡åˆ é™¤åŸå­˜å‚¨ç€server_uuidçš„auto.cnfæ–‡ä»¶ï¼Œå¹¶é€šè¿‡é‡å¯Mysqlæ•°æ®åº“é‡æ–°ç”Ÿæˆæ–°çš„server_uuidåï¼Œç›®å‰ä¸å†æŠ¥ä»¥ä¸Šé”™è¯¯ä¿¡æ¯äº†ï¼Œè§‚å¯Ÿä¸€æ®µæ—¶é—´å†è¿½åŠ è¯„è®ºã€‚ å‡ å¤©åï¼Œç»§ç»­å‡ºç°åŒæ ·çš„æ•…éšœæŠ¥é”™ã€‚ ç»è¿‡è¯•éªŒï¼Œæš‚æ—¶åˆ¤æ–­ä¸ºå¦‚æœpiplineå¼€å¯äº†è¶…æ—¶æˆ–è€…å»¶æ—¶çš„æŠ¥è­¦ç›‘æ§ï¼Œå¹¶ä¸”è¿™äº›ç›‘æ§å¼€å¯äº†è‡ªåŠ¨é‡å¯é€‰é¡¹ï¼Œé‚£ä¹ˆå½“ç›‘æ§è®¤ä¸ºè¶…æ—¶åï¼Œä¼šå¼€å¯æ–°çš„åŒæ­¥è¿›ç¨‹ï¼Œè€Œäº‹å®ä¸Šè¿œç«¯çš„nodeåªæ˜¯å› ä¸ºç½‘é€Ÿè¿‡æ…¢å½±å“äº†ç›¸åº”æ—¶é—´ï¼Œå¹¶æ²¡æœ‰çœŸæ­£çš„æŒ‚æ‰ï¼Œå› æ­¤å¼€å¯æ–°çš„è¿›ç¨‹åå°±å¯¼è‡´äº†é‡å¤çš„slaveåœ¨è¯·æ±‚masterã€‚å‡ºç°äº†â€œA slave with the same server_uuid/server_id as this slave has connected to the masterâ€çš„æç¤ºï¼Œç›®å‰åœ¨ç›‘æ§ä¸Šï¼Œåªä¿ç•™äº†â€œå¼‚å¸¸â€çš„ç›‘æ§ï¼Œåˆ æ‰äº†å…¶ä½™çš„ç›‘æ§ï¼Œè¿è¡Œè¿˜ç®—æ­£å¸¸ï¼Œæ­£åœ¨è§‚å¯Ÿã€‚ è§£å†³é—®é¢˜å°±å¥½ï¼Œæ–°çš„canal 1.0.26ä¼šé‡‡ç”¨éšæœºuuidçš„åšæ³•æ¥è§„é¿
643,canal server log æ˜¾ç¤ºparse error mysqlä¸ºå…¬å¸å†…éƒ¨å®šåˆ¶ç‰ˆæœ¬ï¼Œå¯¹åº”mysqlå®˜æ–¹å¯èƒ½æ˜¯5.5ï¼Œè¯·é—®å¦‚æœè¦ä¿®æ”¹è¿™é‡Œçš„è§£æè§„åˆ™ï¼Œå¯è¡Œæ€§é«˜å—ï¼Ÿå¦‚æœå¯ä»¥çš„è¯ï¼Œèƒ½æä¾›ä¸€ä¸ªå­¦ä¹ è·¯å¾„ï¼Œæ–¹ä¾¿å»å®šåˆ¶è¿™é‡Œçš„parserå—ï¼Ÿæ„Ÿè°¢ï¼ .mysql.tsdb.MemoryTableMeta - parse faield : CREATE TABLE `procs_priv` (   `Host` char(60) COLLATE utf8_bin NOT NULL DEFAULT ''   `Db` char(64) COLLATE utf8_bin NOT NULL DEFAULT ''   `User` char(16) COLLATE utf8_bin NOT NULL DEFAULT ''   `Routine_name` char(64) CHARACTER SET utf8 NOT NULL DEFAULT ''   `Routine_type` enum('FUNCTION' 'PROCEDURE') COLLATE utf8_bin NOT NULL   `Grantor` char(77) COLLATE utf8_bin NOT NULL DEFAULT ''   `Proc_priv` set('Execute' 'Alter Routine' 'Grant') CHARACTER SET utf8 NOT NULL DEFAULT ''   `Timestamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP   PRIMARY KEY (`Host` `Db` `User` `Routine_name` `Routine_type`)   KEY `Grantor` (`Grantor`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='Procedure privileges' com.alibaba.druid.sql.parser.ParserException: syntax error  error in :'RE') COLLATE utf8_bin NOT NULL   `'  expect RPAREN  actual IDENTIFIER pos 313  line 6  column 47  token IDENTIFIER COLLATE 	at com.alibaba.druid.sql.parser.SQLParser.printError(SQLParser.java:284) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLParser.accept(SQLParser.java:292) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlCreateTableParser.parseCreateTable(MySqlCreateTableParser.java:191) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseCreate(MySqlStatementParser.java:244) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:159) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:464) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:295) ~[druid-1.1.6.jar:1.1.6] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:69) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.25.jar:na] ä½¿ç”¨å½“å‰æœ€æ–°ç‰ˆæœ¬canalï¼Œå·²ç»ä¿®å¤
642,WritableByteChannel channel ä¸ºnull ä½¿ç”¨ç‰ˆæœ¬ä¸º1.0.26  CanalConnector connector = CanalConnectors.newSingleConnector(new InetSocketAddress(ip  11111)             destination "" ""); 1.åœ¨åˆ›å»ºCanalConnector å¯¹è±¡ä¹‹åå‘ç°channel ä¸ºnullä¸çŸ¥é“æ˜¯ä»€ä¹ˆé—®é¢˜ 2.mysqlçš„è´¦å·ï¼Œä¹Ÿæ˜¯æ ¹æ®æ•™ç¨‹çš„è¯­å¥ç›´æ¥ç”Ÿæˆçš„ 3.serverä¹Ÿå¯åŠ¨äº† start cmd :  java   -Xms128m -Xmx512m -XX:PermSize=128m  -Djava.awt.headless=true -Djava.net.preferIPv4Stack=true -Dapplication.codeset=UTF-8 -Dfile.encoding=UTF-8  -server -Xdebug -Xnoagent -Djava.compiler=NONE -Xrunjdwp:transport=dt_socket address=9099 server=y suspend=n  -DappName=otter-canal -Dlogback.configurationFile="E:\canal-dep\bin\\..\conf\logback.xml" -Dcanal.conf="E:\canal-dep\bin\\..\conf\canal.properties" -classpath "E:\canal-dep\bin\\..\conf\..\lib\*;E:\canal-dep\bin\\..\conf" java   -Xms128m -Xmx512m -XX:PermSize=128m  -Djava.awt.headless=true -Djava.net.preferIPv4Stack=true -Dapplication.codeset=UTF-8 -Dfile.encoding=UTF-8  -server -Xdebug -Xnoagent -Djava.compiler=NONE -Xrunjdwp:transport=dt_socket address=9099 server=y suspend=n  -DappName=otter-canal -Dlogback.configurationFile="E:\canal-dep\bin\\..\conf\logback.xml" -Dcanal.conf="E:\canal-dep\bin\\..\conf\canal.properties" -classpath "E:\canal-dep\bin\\..\conf\..\lib\*;E:\canal-dep\bin\\..\conf" com.alibaba.otter.canal.deployer.CanalLauncher Java HotSpot(TM) 64-Bit Server VM warning: ignoring option PermSize=128m; support was removed in 8.0 Listening for transport dt_socket at address: 9099 2018-05-17 15:17:09.947 [main] WARN  o.s.beans.GenericTypeAwarePropertyDescriptor - Invalid JavaBean property 'connectionCharset' being accessed! Ambiguous write methods found next to actually used [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.nio.charset.Charset)]: [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.lang.String)] 2018-05-17 15:17:10.143 [main] ERROR com.alibaba.druid.pool.DruidDataSource - testWhileIdle is true  validationQuery not set 2018-05-17 15:17:10.427 [destination = example   address = /192.168.2.165:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just show master status 4. è¿è¡Œcanal.example-1.0.26-SNAPSHOT é—ªé€€ è‡ªå·±ç¼–è¯‘çš„åŒ…ï¼Ÿ å·²ç»ä¿®å¤ï¼Œå¯ä»¥é‡æ–°ä¸‹è½½1.0.26-alpha 3
641,è¡¨ç»“æ„è§£æå¤±è´¥ï¼Œunknow column tag: canal-1.0.26-preview-2 è¡¨ä¸­æœ‰ä¸€åˆ—åï¼šconf_key 2018-05-17 13:28:36.412 [destination = xxxxx   address = xxxxx   EventParser] ERROR c.a.otter.canal.p arse.inbound.mysql.MysqlEventParser - dump address /10.4.217.125:5002 has an error  retrying. caused by java.lang.RuntimeException: unknow column : `conf_key`(8)         at com.alibaba.otter.canal.parse.inbound.TableMeta.getFieldMetaByName(TableMeta.java:74) ~[canal.parse-1.0.26-SN APSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.processTableElement(MemoryTableMeta.java:227 ) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.parse(MemoryTableMeta.java:153) ~[canal.pars e-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.find(MemoryTableMeta.java:108) ~[canal.parse -1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.compareTableMetaDbAndMemory(DatabaseTableM eta.java:289) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.applySnapshotToDB(DatabaseTableMeta.java:2 51) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:129) ~[can al.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParse r.java:72) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) ~[canal.parse-1 .0.26-SNAPSHOT.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.8.0_45] ![image](https://user-images.githubusercontent.com/1378499/40158776-dc4bd130-59d8-11e8-9f1c-7c82d3d4774a.png) å’Œ1.0.25 æ¯”è¾ƒï¼ŒMemoryTableMeta åˆ æ‰è¿™å‡ è¡Œï¼Œå°±ä¸ä¼šå‡ºé”™äº†
640,channalç»å¸¸å…³é—­ ä½ å¥½ï¼Œæˆ‘è¿™è¾¹è¿è¡Œä¸€æ®µæ—¶é—´åï¼Œå‡ å°æ—¶å§ï¼Œconfiä¸‹é¢é…ç½®äº†9ä¸ª instance ç„¶åæœ‰äº›instanceä¸‹é¢å°±æŠ¥ä¸‹é¢çš„æ—¥å¿—äº†ï¼Œbinlogæ–‡ä»¶å˜æ›´ä¹Ÿæ‹¿ä¸åˆ°äº†ï¼Œç»å¸¸é‡åˆ°è¿™ç§é—®é¢˜ï¼Œä»£ç é‡Œé¢ï¼Œæ˜¯ä¸€ç›´è·å–æ•°æ®çš„çŠ¶æ€ï¼Œæ²¡å“Ÿå…³é—­channalçš„æ“ä½œã€‚ 2018-05-16 16:07:37.638 [New I/O server worker #1-7] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x58f255d8  /192.168.47.232:59420 :> /192.16 8.47.243:11111]  exception=java.nio.channels.ClosedChannelException         at org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:643)         at org.jboss.netty.channel.socket.nio.NioWorker.writeFromUserCode(NioWorker.java:370)         at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:137)         at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76)         at org.jboss.netty.channel.Channels.write(Channels.java:611)         at org.jboss.netty.channel.Channels.write(Channels.java:578)         at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:28)         at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:144)         at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48)         at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:275)         at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302)         at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndFireMessageReceived(ReplayingDecoder.java:525)         at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:506)         at org.jboss.netty.handler.codec.replay.ReplayingDecoder.cleanup(ReplayingDecoder.java:541)         at org.jboss.netty.handler.codec.replay.ReplayingDecoder.channelDisconnected(ReplayingDecoder.java:449)         at org.jboss.netty.channel.Channels.fireChannelDisconnected(Channels.java:360)         at org.jboss.netty.channel.socket.nio.NioWorker.close(NioWorker.java:593)         at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:119)         at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76)         at org.jboss.netty.channel.Channels.close(Channels.java:720)         at org.jboss.netty.channel.AbstractChannel.close(AbstractChannel.java:200)         at org.jboss.netty.channel.ChannelFutureListener$1.operationComplete(ChannelFutureListener.java:46)         at org.jboss.netty.channel.DefaultChannelFuture.notifyListener(DefaultChannelFuture.java:381)         at org.jboss.netty.channel.DefaultChannelFuture.addListener(DefaultChannelFuture.java:148)         at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:30)         at com.alibaba.otter.canal.server.netty.NettyUtils.error(NettyUtils.java:51)         at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:200)         at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48)         at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:275)         at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302)         at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndFireMessageReceived(ReplayingDecoder.java:525)         at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:506)         at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:443)         at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274)         at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261)         at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:349)         at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:280)         at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:200)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)         at java.lang.Thread.run(Thread.java:722) æˆ‘è¿™ä¹Ÿå‡ºç°äº†ç±»å‹ä½ è¿™ç§ something goes wrong with channelé”™è¯¯ï¼Œæˆ‘çš„æ˜¯åªè¦å®¢æˆ·ç«¯ä¸€ç›´è¿ç€æœåŠ¡å™¨å°±æ²¡äº‹ï¼Œæˆ‘æµ‹è¯•è¿‡å®¢æˆ·ç«¯è·‘äº†ä¸€å¤©ä¸€å¤œæ˜¯æ²¡æœ‰æ–­è¿‡çš„ï¼Œä½†æ˜¯å®¢æˆ·ç«¯ä¸€æ—¦ä¸è¿æ¥canalæœåŠ¡ç«¯ï¼Œè¶…è¿‡ä¸€å®šæ—¶é—´(å…·ä½“å¤šä¹…ä¸æ¸…æ¥š)ï¼Œå†æ¬¡è¿æ¥æœåŠ¡ç«¯æ—¶ï¼Œå°±ä¼šå‡ºç°ä¸‹é¢çš„è¿™ç§é”™è¯¯ã€‚ 2018-05-15 15:13:52.219 [New I/O server worker #1-2] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x24e1e7e8  /192.168.2.128:55307   => /192.168.1.38:11111  ]  exception=java.io .IOException: Connection reset by peer at sun.nio.ch  .FileDispatcherImpl.read0(Native Method) at sun.nio.ch .SocketDispatcher.read(SocketDispatcher.java:39) at sun.nio.ch .IOUtil.readIntoNativeBuffer(IOUtil.java:223) at sun.nio.ch .IOUtil.read(IOUtil.java:192) at sun.nio.ch .SocketChannelImpl.read(SocketChannelImpl.java:379)         at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:322)         at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:281)         at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:201)         at org.jboss.netty.util.internal.IoWorkerRunnable.run(IoWorkerRunnable.java:46)         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)         at java.lang.Thread.run(Thread.java:745) è¯·è¯´æ˜ä¸‹canalçš„ç‰ˆæœ¬ã€‚ è°¢è°¢å›ç­”ï¼ï¼æˆ‘ç”¨çš„æ˜¯1.0.25. @DevWithLin  ä½ æ¢æˆ1.0.26è¯•è¯•ã€‚ èƒ½è¯´æ˜ä¸‹æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„å˜›ï¼Ÿï¼Ÿ @DevWithLin  25ç‰ˆæœ¬ä½¿ç”¨äº†nioåšbinlogè¯»å–ï¼Œä¸å¤ªç¨³å®šï¼Œä¸å»ºè®®ä½¿ç”¨äº† Nettyæœ‰idleè¶…æ—¶closeæœºåˆ¶ï¼Œå®¢æˆ·ç«¯åœ¨åˆ›å»ºconnectoræ—¶å¯ä»¥è®¾ç½®ï¼Œå¦‚æœä¸è®¾ç½®æœåŠ¡ç«¯é»˜è®¤5åˆ†é’Ÿä¸»åŠ¨æ–­å¼€channelï¼Œå†æ¬¡è·å–æ•°æ®å°±ä¼šæŠ¥é”™ï¼Œéœ€è¦é‡è¿connectorã€‚ com.alibaba.otter.canal.server.netty.handler.ClientAuthenticationHandler IdleStateHandler idleStateHandler = new IdleStateHandler(NettyUtils.hashedWheelTimer     readTimeout     writeTimeout     0     TimeUnit.MILLISECONDS); ctx.getPipeline().addBefore(SessionHandler.class.getName()     IdleStateHandler.class.getName()     idleStateHandler); IdleStateAwareChannelHandler idleStateAwareChannelHandler = new IdleStateAwareChannelHandler() {     public void channelIdle(ChannelHandlerContext ctx  IdleStateEvent e) throws Exception {         logger.warn("channel:{} idle timeout exceeds  close channel to save server resources..."             ctx.getChannel());         ctx.getChannel().close();     } }; ctx.getPipeline().addBefore(SessionHandler.class.getName()     IdleStateAwareChannelHandler.class.getName()     idleStateAwareChannelHandler); @agapple  26ç‰ˆæœ¬ã€‚ä¼šä¸å®šæ—¶é‡å¯instanceï¼Œæˆ‘ä¸€ä¸ªcanalæœåŠ¡å¤§æ¦‚20ä¸ªinstanceã€‚è¿™ä¸ªæœ‰é™åˆ¶å— æ²¡æœ‰instanceçš„æ•°é‡é™åˆ¶å•Šï¼Œæ˜¯å¦å¼€å¯äº†scan=trueï¼Œæ‰¾åˆ°å˜æ›´çš„æ–‡ä»¶ 25ç‰ˆæœ¬ä½¿ç”¨äº†nioåšbinlogè¯»å–ï¼Œä¸å¤ªç¨³å®šï¼Œä¸å»ºè®®ä½¿ç”¨äº†ã€‚ã€‚ã€‚ @agapple é‚£æ‚¨å»ºè®®ä½¿ç”¨å“ªä¸ªç‰ˆæœ¬ï¼Ÿå¯ä»¥ç¨³å®šçš„è¯»å–binlogæ—¥å¿— 1.0.26 1.0.26ä¹Ÿä¼šæ—¶ä¸æ—¶å‡ºç° Connection reset by peerï¼Œæ­¤æ—¶binlogå˜æ›´å¯è¢«æ•æ‰ã€‚ä½¿ç”¨çš„å®¢æˆ·ç«¯æ˜¯å®˜æ–¹example fa34eb0e59f257574996cb03da58cd2e8353e94dï¼Œè°ƒæ•´äº†ä¸‹é»˜è®¤çš„ç©ºé—²é“¾æ¥è¶…æ—¶æ—¶é—´ï¼Œä¹‹å‰åªæœ‰1åˆ†é’Ÿç©ºé—²è¶…æ—¶ï¼Œè°ƒæ•´ä¸º1å°æ—¶ ![image](https://user-images.githubusercontent.com/834743/41271502-9e424160-6e43-11e8-984b-29f03d187889.png) å¤§ä¼™å¯¹è¶…æ—¶çš„ç®¡ç†ä¸å¤Ÿç²¾ç»†ï¼Œåªèƒ½è°ƒå¤§è¿›è¡Œç²—æ”¾å‹ç®¡ç† æˆ‘ç”¨çš„1.0.25ç‰ˆæœ¬ï¼Œchannelä¹Ÿè€è¢«å…³é—­ï¼Œä¸€æ—¦è¢«å…³é—­äº† ä½ç‚¹éƒ½ä¸ä¼šå†ç§»åŠ¨äº†ï¼Œä½†æ˜¯æ¸…æ‰meta.dat é‡å¯å°±åˆokäº†ã€‚å¦‚æœæ˜¯å› ä¸ºè¶…æ—¶åŸå› å¯¼è‡´channelå…³é—­äº†ï¼ŒeventParserä¼šé‡æ–°å’Œmysqlå»ºç«‹è¿æ¥ï¼ŒæŒ‰é“ç†è®²ä½ç‚¹åº”è¯¥ç»§ç»­ç§»åŠ¨æ‰å¯¹ã€‚ @fangchunsheng ä½ çš„ä½ç‚¹å¯èƒ½æ˜¯å¦ä¸€ä¸ªé—®é¢˜ï¼Œ1.0.25å’Œmysqläº¤äº’ä½¿ç”¨äº†netty nioçš„æ¨¡å¼ï¼Œåœ¨26ç‰ˆæœ¬æ¢æˆäº†bioï¼Œå¯ä»¥è¯•è¯•1.0.26
639,å¼‚å¸¸ï¼šfetch failed by table metaï¼Œç‰ˆæœ¬1.0.26ï¼Œtsdb.enable=true åŸsqlæ˜¯å¯¹è¡¨card_record è¿›è¡Œäº†ä¸¤æ¬¡alteræ“ä½œ alter table card_record modify column customization_id bigint unsigned NOT NULL COMMENT 'å®šåˆ¶id' | æŸ¥çœ‹è¯¦æƒ… alter table card_record modify column upgraded_customization_id bigint unsigned NOT NULL COMMENT 'å‡çº§åå®šåˆ¶id' | æŸ¥çœ‹è¯¦æƒ… çº¿ä¸Šä¸€æ¬¡alteræ“ä½œæ­¥éª¤æ˜¯ï¼š 1. DROP TABLE IF EXISTS `_card_record_gho` 2. DROP TABLE IF EXISTS `_card_record_del` 3. create table `yushitai_test`.`_card_record_gho` like `yushitai_test`.`card_record` 4. alter table `yushitai_test`.`_card_record_gho`  modify column customization_id bigint unsigned NOT NULL COMMENT 'ÅšÄ£Ã¶ÅšÄ…âˆ‚id' 5. insert æ•°æ®åˆ°_card_record_gho 6. rename table `yushitai_test`.`card_record` to `yushitai_test`.`_card_record_del` `yushitai_test`.`_card_record_gho` to `yushitai_test`.`card_record` æ‰‹åŠ¨è®¾ç½®ä½ç‚¹åˆ°ä¸¤æ¡alteræ“ä½œæ—¶é—´ä¹‹å‰ï¼Œé‡æ–°æ¶ˆè´¹æ—¶ï¼Œå½“æ‰§è¡Œç¬¬äºŒæ¬¡alter æ“ä½œæ—¶ï¼Œåˆ°æ­¥éª¤5æ—¶ï¼Œä¼šå‡ºç°exceptionï¼š fetch failed by table meta:`yushitai_test`.`_card_record_gho` 2018-05-14 15:32:44.078 [destination = yushitai_test   address = /10.32.200.228:5002   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - dup apply for sql : DROP TABLE IF EXISTS `_card_record_gho` /* generated by server */ 2018-05-14 15:32:44.078 [destination = yushitai_test   address = /10.32.200.228:5002   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - dup apply for sql : DROP TABLE IF EXISTS `_card_record_del` /* generated by server */ 2018-05-14 15:32:44.078 [destination = yushitai_test   address = /10.32.200.228:5002   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - dup apply for sql : DROP TABLE IF EXISTS `_card_record_ghc` /* generated by server */ 2018-05-14 15:32:44.079 [destination = yushitai_test   address = /10.32.200.228:5002   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - dup apply for sql : create /* gh-ost */ table `yushitai_test`.`_card_record_ghc` ( id bigint auto_increment last_update timestamp not null DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP hint varchar(64) charset ascii not null value varchar(255) charset ascii not null primary key(id) unique key hint_uidx(hint) ) auto_increment=256 2018-05-14 15:32:44.079 [destination = yushitai_test   address = /10.32.200.228:5002   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - dup apply for sql : create /* gh-ost */ table `yushitai_test`.`_card_record_gho` like `yushitai_test`.`card_record` 2018-05-14 15:32:44.080 [destination = yushitai_test   address = /10.32.200.228:5002   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - dup apply for sql : alter /* gh-ost */ table `yushitai_test`.`_card_record_gho`  modify column customization_id bigint unsigned NOT NULL COMMENT 'ÅšÄ£Ã¶ÅšÄ…âˆ‚id' 2018-05-14 15:32:44.085 [destination = yushitai_test   address = /10.32.200.228:5002   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - dup apply for sql : create /* gh-ost */ table `yushitai_test`.`_card_record_del` ( id int auto_increment primary key ) engine=InnoDB comment='ghost-cut-over-sentry' 2018-05-14 15:32:44.090 [destination = yushitai_test   address = /10.32.200.228:5002   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - dup apply for sql : DROP TABLE IF EXISTS `_card_record_del` /* generated by server */ 2018-05-14 15:32:44.090 [destination = yushitai_test   address = /10.32.200.228:5002   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - dup apply for sql : rename /* gh-ost */ table `yushitai_test`.`card_record` to `yushitai_test`.`_card_record_del`  `yushitai_test`.`_card_record_gho` to `yushitai_test`.`card_record` 2018-05-14 15:32:44.091 [destination = yushitai_test   address = /10.32.200.228:5002   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - dup apply for sql : DROP TABLE IF EXISTS `_card_record_ghc` /* generated by server */ 2018-05-14 15:32:44.104 [destination = yushitai_test   address = /10.32.200.228:5002   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - dup apply for sql : rename table `_card_record_del` to _card_record_del_bak20180508125310 2018-05-14 15:32:45.093 [destination = yushitai_test   address = /10.32.200.228:5002   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - dup apply for sql : DROP TABLE IF EXISTS `_card_record_gho` /* generated by server */ 2018-05-14 15:32:45.094 [destination = yushitai_test   address = /10.32.200.228:5002   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - dup apply for sql : DROP TABLE IF EXISTS `_card_record_del` /* generated by server */ 2018-05-14 15:32:45.094 [destination = yushitai_test   address = /10.32.200.228:5002   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - dup apply for sql : DROP TABLE IF EXISTS `_card_record_ghc` /* generated by server */ 2018-05-14 15:32:45.096 [destination = yushitai_test   address = /10.32.200.228:5002   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - dup apply for sql : create /* gh-ost */ table `yushitai_test`.`_card_record_ghc` ( id bigint auto_increment last_update timestamp not null DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP hint varchar(64) charset ascii not null value varchar(255) charset ascii not null primary key(id) unique key hint_uidx(hint) ) auto_increment=256 2018-05-14 15:32:45.096 [destination = yushitai_test   address = /10.32.200.228:5002   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - dup apply for sql : create /* gh-ost */ table `yushitai_test`.`_card_record_gho` like `yushitai_test`.`card_record` 2018-05-14 15:32:45.097 [destination = yushitai_test   address = /10.32.200.228:5002   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - dup apply for sql : alter /* gh-ost */ table `yushitai_test`.`_card_record_gho`  modify column upgraded_customization_id bigint unsigned NOT NULL COMMENT 'ÅšÄ‡Ã¡ÃÄ¼ÃŸÅšÅºÃ©ÅšÄ£Ã¶ÅšÄ…âˆ‚id' 2018-05-14 15:32:45.103 [destination = yushitai_test   address = /10.32.200.228:5002   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - ERROR ## parse this event has an error   last position : [EntryPosition[included=false journalName=mysql-bin.000056 position=286998741 serverId=32114196 timestamp=1525755246000]] com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: fetch failed by table meta:`yushitai_test`.`_card_record_gho` Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: fetch failed by table meta:`yushitai_test`.`_card_record_gho` Caused by: java.io.IOException: ErrorPacket [errorNumber=1146  fieldCount=-1  message=Table 'yushitai_test._card_record_gho' doesn't exist  sqlState=42S02  sqlStateMarker=#]  with command: show create table `yushitai_test`.`_card_record_gho` at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.query(MysqlQueryExecutor.java:61) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:94) [canal.parse-1.0.26-SNAPSHOT.jar:na] at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:167) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:759) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:428) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:114) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:66) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:337) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:184) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:152) [canal.parse-1.0.26-SNAPSHOT.jar:na] at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220) [canal.parse-1.0.26-SNAPSHOT.jar:na] at java.lang.Thread.run(Thread.java:745) [na:1.8.0_45] å®šä½ä¸ºä¸€ä¸ªddlè§£æbug
638,ä¸ºä»€ä¹ˆaddresså­˜å‚¨çš„æ˜¯hostnameè€Œä¸æ˜¯ ip  {   "@type": "com.alibaba.otter.canal.protocol.position.LogPosition"   "identity": {     "slaveId": -1     "sourceAddress": {       "address": "DESKTOP-1RFA2LT"       "port": 3306     }   }   "postion": {     "included": false     "journalName": "mysql-bin.000011"     "position": 3382     "serverId": 1     "timestamp": 1526277481000   } } é»˜è®¤åºåˆ—åŒ–ä¹‹åçš„ç»“æœï¼Œæ²¡æœ‰ç‰¹æ®Šå¤„ç†
637,canal1.0.22 å¯åŠ¨é—®é¢˜ 2018-05-11 00:00:24.243 [destination = yuntu-management   address = rm-wz91b2j3ypnw1fbr6o.mysql.rds.aliyuncs.com/112.74.151.78:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - disconnect address rm-wz91b2j3ypnw1fbr6o.mysql.rds.aliyuncs.com/112.74.151.78:3306 has an error  retrying.  caused by  java.io.IOException: KILL DUMP 470730777 failure:java.io.IOException: ErrorPacket [errorNumber=1094  fieldCount=-1  message=Unknown thread id: 470730777  sqlState=HY000  sqlStateMarker=#]  with command: KILL CONNECTION 470730777 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlUpdateExecutor.update(MysqlUpdateExecutor.java:49) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.disconnect(MysqlConnector.java:104) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.disconnect(MysqlConnection.java:60) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:242) 	at java.lang.Thread.run(Thread.java:745) å°è¯•ç”¨ä¸€ä¸‹æœ€æ–°çš„1.0.26ç‰ˆæœ¬
636,canal çš„file store æˆ–mix store æœ‰è®¡åˆ’ä»€ä¹ˆæ—¶å€™å¼€å‘ï¼Ÿ å¦‚é¢˜ã€‚ æš‚æ—¶æ²¡æœ‰ï¼Œå¯ä»¥å¯¹æ¥ä¸€ä¸‹æ•°æ®å†™å…¥åˆ°kafkaä¸­ @agapple   è¿™å‡ å¤©ä¹Ÿåœ¨çŠ¹è±«å†™åˆ°kafkaè¿˜æ˜¯rocketmqï¼Œæœ‰ä»€ä¹ˆå»ºè®®å—ï¼Ÿ æˆ‘è§‰å¾—éƒ½å¯ä»¥æŠŠï¼Œæˆ‘ä»¬å…¬å¸ç”¨çš„æ˜¯rocketmq @agapple ä½ å¥½ï¼Œæƒ³è¯·æ•™ä¸‹ã€‚æˆ‘ä»¬ç°åœ¨è‡ªç ”æ•°æ®ç®¡é“æœåŠ¡ï¼Œå…¶ä¸­ä¸€ç‚¹ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œbinlogè§£æä¹‹åå†™åˆ°mqæ˜¯ä¸æ˜¯å¥½ä¸€äº›ï¼Ÿè¿™æ ·å°±å¯ä»¥é€šè¿‡mqæä¾›è®¢é˜…æœåŠ¡äº†ï¼Œè¿™æ˜¯æ¯”è¾ƒç®€å•çš„åšæ³•ï¼Œä¸‹æ¸¸çš„clientä¹Ÿå¯å’Œç®¡é“æœåŠ¡è¿›è¡Œè§£è€¦ã€‚ ä½†æ˜¯canalè‡ªå·±å®ç°ç±»ä¼¼mqçš„ä¸€å¥—å¤æ‚çš„è®¢é˜…apiï¼Œè™½ç„¶æœ‰æä¾›javaå®¢æˆ·ç«¯sdkï¼Œä½†æ˜¯goã€rustè¿™äº›éƒ½æ²¡æœ‰ï¼Œä¸æ–¹ä¾¿ä½¿ç”¨ã€‚ æ‰€ä»¥ï¼Œæœ‰å‡ ä¸ªé—®é¢˜ï¼Œæƒ³è¯·æ•™ä¸‹ï¼š 1. canalè‡ªå·±å®ç°è®¢é˜…apiæ˜¯åŸºäºä»€ä¹ˆè€ƒè™‘å‘¢ï¼Ÿæ˜¯è€ƒè™‘mqçš„ä¸€äº›æ½œåœ¨çš„å‘ï¼Œæ¯”å¦‚æ¶ˆæ¯å¤§å°é™åˆ¶ã€atleast onceç­‰å› ç´ å—ï¼Ÿ 2. canalçš„è®¢é˜…apiè™½ç„¶æä¾›è®©client ackçš„æœºåˆ¶ã€‚è¿™åº”è¯¥æ˜¯æƒ³å°½é‡è®©clientä¸æ”¶åˆ°é‡å¤æ¶ˆæ¯ï¼ˆå‡è®¾clientæ¯å¤„ç†ä¸€ä¸ªæ¶ˆæ¯ä¹‹åå°±ackï¼‰ã€‚ä½†æ˜¯ackä½ç‚¹æœ‰åšæŒä¹…åŒ–å’Œå®¹ç¾å—ï¼Ÿä¹Ÿå³æ˜¯canal leaderåˆ‡æ¢åï¼Œclient ä¸ä¼šé‡å¤æ”¶åˆ°æŸæ¡æ¶ˆæ¯ OR ä»ç„¶æœ‰å¯èƒ½æ”¶åˆ°é‡å¤çš„æ¶ˆæ¯ã€‚ 3. å¦‚æœclientæœ‰å¯èƒ½æ”¶åˆ°é‡å¤æ¶ˆæ¯ï¼Œå»ºè®®å®¢æˆ·ç«¯æ˜¯å¦‚ä½•åšå¹‚ç­‰å¤„ç†ï¼Ÿ 4. å¯¹äºå¤§äº‹åŠ¡ï¼ˆæ¯”å¦‚å¥½å‡ Gå¤§å°ï¼‰ï¼Œcanalçš„apiæ˜¯æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ helloï¼Œanybody hereï¼Ÿ canalçš„server/clientç»“æ„ä¸»è¦æ˜¯åŸºäºè¿ç»´ç®¡ç†çš„è§’åº¦è€ƒè™‘ï¼Œä¹‹å‰æœ‰æƒ³æ³•æ˜¯å†…ç½®ä¸€å¥—kafkaçš„èƒ½åŠ›ï¼Œä½†è€ƒè™‘æˆç†Ÿåº¦ï¼Œå»ºè®®æ˜¯ç›´æ¥ç”¨clientæ¥åˆ°æ•°æ®åå­˜å‚¨åˆ°MQä¸€ä»½
634,Canalæ˜¯å¦‚ä½•åœ¨é«˜å¹¶å‘ä¸‹ä¿è¯äº‹åŠ¡ä¸€è‡´çš„ Hiï¼Œ æƒ³é—®ä¸€ä¸‹ä¸‹è¿°æƒ…å†µCanalæ˜¯å¦‚ä½•å®ç°çš„ï¼š äº‹åŠ¡A å…ˆå‘èµ· æ›´æ–° æŸä¸ªå­—æ®µä¸ºA äº‹åŠ¡B åå‘èµ· æ›´æ–° ä¸Šè¿°å­—æ®µä¸ºB ä½†æ˜¯Aäº‹åŠ¡åœ¨Bäº‹åŠ¡åæäº¤ Canalæ˜¯å¦‚ä½•ä¿è¯å€¼æ›´æ–°æ­£ç¡®çš„å‘¢ canalåªæ˜¯è´Ÿè´£è§£æbinlogè€Œå·²ï¼Œä½ å…ˆç†è§£ä¸€ä¸‹ä½•è°“binlog
633,binlogä½ç‚¹å‰ç§»ï¼Œddlæ“ä½œä¸¢å¤± canal ç‰ˆæœ¬ï¼š1.0.25 æ‰‹åŠ¨è®¾ç½®cursorçš„timestampè‡³ t1ï¼Œå½“å‰æ—¶é—´ä¸ºt2ï¼Œt2 > t1 å¦‚æœt1~t2è¿™æ®µæ—¶é—´ä¹‹å†…äº§ç”Ÿäº†ddl æ“ä½œï¼Œbinlog ä½ç‚¹å‰ç§»è‡³t1ï¼Œé‡æ–°æ¶ˆè´¹è¿™æ®µæ—¶é—´çš„binlogï¼Œddlæ“ä½œä¸¢å¤± canal server log å¦‚ä¸‹ï¼š canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - dup apply for sql : CREATE TABLE     canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - dup apply for sql : alter table screen_fee add  è¿™ä¸æ˜¯ddlä¸¢å¤±ï¼Œè€Œæ˜¯å›åˆ°äº†T1æ—¶é—´ä¹‹åï¼Œåœ¨é‡æ–°è§£æå‘ç°åœ¨t1 -> t2ä¸­æœ‰ddlï¼Œé‡æ–°åŠ å…¥åˆ°tsdbä¸­å‘ç°å·²ç»åŠ è¿‡äº†
631,MySQLé©±åŠ¨åŒ…æ”¯æŒBooleanç±»å‹ï¼Œcanalä¸æ”¯æŒbooleanç±»å‹è½¬æ¢ MySQLçš„é©±åŠ¨åŒ…ä¸­å¯¹tinyintçš„é•¿åº¦ä¸º1ï¼Œå¯¹åº”sqlType=-7 è½¬åŒ–ä¸ºJavaå¸ƒå°”ç±»å‹ï¼Œå‚è€ƒMySQLé©±åŠ¨æºç  ![image](https://user-images.githubusercontent.com/9798724/39748475-bff67406-52e2-11e8-9233-21df121524b9.png) è€ŒCanalå¯¹å¯¹tinyintçš„é•¿åº¦ä¸º1ï¼Œå¯¹åº”sqlType=-6ï¼Œæ— æ³•å¤„ç†ä¸ºJavaçš„å¸ƒå°”ç±»å‹ æ²¡æœ‰ä¸“é—¨é’ˆå¯¹tinyint(1)åšè¿‡ç‰¹æ®Šå¤„ç†ï¼Œç›®å‰ç»Ÿä¸€æŒ‰ç…§äº†tinyintç±»å‹-6 æœ‰è®¡åˆ’æ”¯æŒå—ï¼Ÿ å¯ä»¥è€ƒè™‘æäº¤ä¸€ä¸ªPRç»™æˆ‘ https://github.com/alibaba/canal/pull/682 @agapple please assign the issue to me :)
630,åŒä¸€ä¸ªserver æ— æ³•å¼€å¯ä¸¤ä¸ªå®¢æˆ·ç«¯è®¢é˜… å¦‚é¢˜ å¯åŠ¨ä¸€ä¸ªserver ç„¶ååœ¨åŒä¸€ä¸ªå®¢æˆ·ç«¯ ç”¨ä¸¤ä¸ªçº¿ç¨‹è®¢é˜…  ä¼šæŠ¥ batchid ä¸å­˜åœ¨ æ˜¯å› ä¸ºè®¢é˜…ç«¯å¿…é¡»å”¯ä¸€ è¿˜æ˜¯å› ä¸ºæŸä¸ªè®¢é˜…IDä¸€è‡´çš„åŸå› ? ä¸€ä¸ªinstanceåŒæ—¶åªèƒ½ä¸€ä¸ªè®¢é˜…æˆåŠŸï¼Œå…¶ä»–clientä¼šé˜»å¡standbyï¼Œç­‰å¾…å·¥ä½œä¸­çš„clienté‡Šæ”¾è®¢é˜…åæ‰èƒ½è®¢é˜…æˆåŠŸ LSæ­£è§£
629,å¦‚ä½•é…ç½®åªè®¢é˜…æŒ‡å®šåº“ è€Œä¸æ˜¯æ‰€æœ‰DB å¦‚é¢˜ å¯ä»¥é…ç½®canal.instance.filter.regex å‚è€ƒ[AdminGuide](https://github.com/alibaba/canal/wiki/AdminGuide) å·²è§£å†³ è¢«å®¢æˆ·ç«¯è¦†ç›–äº†
628,DML çš„ rowChage.getSql() è·å–ä¸åˆ°sqlä¿¡æ¯ DML çš„ rowChage.getSql() è·å–ä¸åˆ°sqlä¿¡æ¯ @rewerma getSql()æ–¹æ³•æ˜¯è·å–DDLè¯­å¥çš„ LSæ­£è§£ é‚£ä¹ˆDMLå°±æ— æ³•è·å–SQLäº†ï¼Ÿmaxwellæ˜¯èƒ½å¤Ÿè·å–åˆ°sqlï¼Œå¸Œæœ›åŠ å…¥æ­¤åŠŸèƒ½ ä½ è¦ç†è§£å®ƒè·å–çš„æ˜¯ä»€ä¹ˆeventäº‹ä»¶çš„sqlï¼Œ5.6ä¹‹åæœ‰ä¸€ä¸ªrowsQueryLogEventï¼Œæœ‰å¯¹åº”DMLçš„sqlæ–‡æœ¬
627,canal serverç»å¸¸ä¼šæŒ‚ï¼Œè€Œä¸”è¿›ç¨‹ä¸é€€å‡º canal serverç»å¸¸ä¼šæŒ‚ï¼Œè€Œä¸”è¿›ç¨‹ä¸é€€å‡ºï¼Œæ ¹æœ¬ç›‘æµ‹ä¸åˆ°serveræ˜¯ä¸æ˜¯æŒ‚äº†ï¼Œæœ¬æ¥å†™äº†ä¸ªç›‘æ§è¿›ç¨‹è„šæœ¬æŒ‚äº†å°±é‡å¯ï¼Œä½†æ˜¯æ²¡ä»€ä¹ˆç”¨ï¼Œæ¯æ¬¡é‡å¯éƒ½è¦åˆ æ‰meta.dat ï¼Œå¦åˆ™ä¼šæŠ¥ çº¿ç¨‹ID ä¸å­˜åœ¨ã€‚ã€‚ å¸Œæœ›èƒ½åšçš„äººæ€§åŒ–ç‚¹ã€‚ è¡¥å……ä¸€ä¸‹ï¼Œåœ¨äºšé©¬é€Šrdsä¸Šç”¨è¿™ä¸ªï¼ŒåŸŸåè®¿é—®ï¼Œç»å¸¸åŸŸåå¯¹åº”çš„IPä¼šè‡ªåŠ¨å˜åŠ¨ï¼Œå˜åŒ–æ—¶canal serverå°±æ˜¯è§£æä¸åˆ°ipï¼Œlogé‡Œä¸€ç›´æŠ¥é”™ã€‚åªæœ‰é‡å¯canal serveræ‰èƒ½è§£å†³ã€‚ç»´æŠ¤å¾ˆéº»çƒ¦ï¼Œæ˜¯å¦å¯ä»¥åŠ ä¸Šè‡ªåŠ¨é‡è¿åŠŸèƒ½ ä¸€ç›´éƒ½æœ‰è‡ªåŠ¨é‡è¯•çš„æœºåˆ¶ï¼Œæ€€ç–‘æ˜¯jvmçš„dns cacheï¼Œå¯¼è‡´ipè§£æåˆ°çš„ä¸€ç›´æ˜¯åŒä¸€ä¸ªipï¼Œå¯ä»¥å°è¯•å…³é—­jvm dns cache
626,æ”¯æŒMySQL5.7çš„XA binlogäº‹ä»¶ æ”¯æŒä¸€ä¸‹MySQL 5.7ä¹‹åçš„XAèƒ½åŠ›ï¼šhttps://mysqlserverteam.com/improvements-to-xa-support-in-mysql-5-7/ ` TRANSACTION_CONTEXT_EVENT= 36   VIEW_CHANGE_EVENT= 37   /* Prepared XA transaction terminal event similar to Xid */   XA_PREPARE_LOG_EVENT= 38 ` > | mysql-bin.000011 | 13688 | Gtid           |         1 |       13753 | SET @@SESSION.GTID_NEXT= 'f1ceb61a-a5d5-11e7-bdee-107c3dbcf8a7:26' | | mysql-bin.000011 | 13753 | Query          |         1 |       13846 | XA START X'74657374' X'' 1                                         | | mysql-bin.000011 | 13846 | Rows_query     |         1 |       13897 | # update test set id = id + 5                                      | | mysql-bin.000011 | 13897 | Table_map      |         1 |       13985 | table_id: 256 (test.test)                                          | | mysql-bin.000011 | 13985 | Update_rows_v1 |         1 |       14167 | table_id: 256 flags: STMT_END_F                                    | | mysql-bin.000011 | 14167 | Query          |         1 |       14258 | XA END X'74657374' X'' 1                                           | | mysql-bin.000011 | 14258 | XA_prepare     |         1 |       14298 | XA PREPARE X'74657374' X'' 1                                       | | mysql-bin.000011 | 14298 | Gtid           |         1 |       14363 | SET @@SESSION.GTID_NEXT= 'f1ceb61a-a5d5-11e7-bdee-107c3dbcf8a7:27' | | mysql-bin.000011 | 14363 | Query          |         1 |       14459 | XA ROLLBACK X'74657374' X'' 1                                      | | mysql-bin.000011 | 14459 | Gtid           |         1 |       14524 | SET @@SESSION.GTID_NEXT= 'f1ceb61a-a5d5-11e7-bdee-107c3dbcf8a7:28' | | mysql-bin.000011 | 14524 | Query          |         1 |       14617 | XA START X'74657374' X'' 1                                         | | mysql-bin.000011 | 14617 | Rows_query     |         1 |       14668 | # update test set id = id + 5                                      | | mysql-bin.000011 | 14668 | Table_map      |         1 |       14756 | table_id: 256 (test.test)                                          | | mysql-bin.000011 | 14756 | Update_rows_v1 |         1 |       14938 | table_id: 256 flags: STMT_END_F                                    | | mysql-bin.000011 | 14938 | Query          |         1 |       15029 | XA END X'74657374' X'' 1                                           | | mysql-bin.000011 | 15029 | XA_prepare     |         1 |       15069 | XA PREPARE X'74657374' X'' 1                                       | | mysql-bin.000011 | 15069 | Gtid           |         1 |       15134 | SET @@SESSION.GTID_NEXT= 'f1ceb61a-a5d5-11e7-bdee-107c3dbcf8a7:29' | | mysql-bin.000011 | 15134 | Query          |         1 |       15228 | XA COMMIT X'74657374' X'' 1      mysql  xaçš„binlogæäº¤æ ¼å¼ï¼Œä¼šåœ¨prepareæ—¶å°±è®°å½•åˆ°binlogå¹¶ä¸”å¯¹å¤–å¯è§ï¼Œè€Œåç»­ä¼šå¯¹xaç»§ç»­è¿›è¡Œcommitæˆ–è€…rollbackï¼Œå¦‚æœæ‰§è¡Œrollbackæ—¶è¿˜éœ€è¦æ‰§è¡Œå›æ»šå¯¹åº”çš„SQL(xa rollbackæ²¡æœ‰è®°å½•å¯¹åº”çš„é€†å‘binlogï¼Œéœ€è¦åœ¨å†…å­˜é‡Œæš‚ç¼“å­˜xa prepareçš„å˜æ›´) http://mysql.taobao.org/monthly/2017/11/06/ï¼Œ ä¸€ç‰‡æ¯”è¾ƒä¸é”™ä»‹ç»MySQL XA ä¸Šé¢åœ°å€404... ä¸Šé¢åœ°å€å»æ‰åé¢çš„é€—å·å°±èƒ½çœ‹äº†  http://mysql.taobao.org/monthly/2017/11/06/ è¾“å‡ºæ ¼å¼ç±»ä¼¼ï¼š ``` ================> binlog[mysql-bin.000012:35614]   BEGIN ----> Thread id: 3 ------> XA START  X'63' X'' 1  END ----> transaction id: 0 ------> XA END  X'63' X'' 1 ================> binlog[mysql-bin.000012:36022] ----------------> binlog[mysql-bin.000012:35459]  ------> XA ROLLBACK  X'62' X'' 1 ----------------> binlog[mysql-bin.000012:36209]  ------> XA COMMIT  X'63' X'' 1 ``` æ‰“å°xaä¿¡æ¯ï¼š ``` protected void printXAInfo(List<Pair> pairs) {         if (pairs == null) {             return;         }         String xaType = null;         String xaXid = null;         for (Pair pair : pairs) {             String key = pair.getKey();             if (StringUtils.endsWithIgnoreCase(key  "XA_TYPE")) {                 xaType = pair.getValue();             } else if (StringUtils.endsWithIgnoreCase(key  "XA_XID")) {                 xaXid = pair.getValue();             }         }         if (xaType != null && xaXid != null) {             logger.info(" ------> " + xaType + " " + xaXid);         }     } ```
625, batchId:73 is not the firstly:72 2018-05-06 10:26:53.805 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position  {"identity":{"slaveId":-1 "sourceAddress":{"address":"localhost" "port":3306}} "postion":{"included":false "journalName":"mysql-bin.000002" "position":26359074 "serverId":1 "timestamp":1525570849000}} 2018-05-06 10:26:53.845 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - find start position : EntryPosition[included=false journalName=mysql-bin.000002 position=26359074 serverId=1 timestamp= 1525570849000] 2018-05-06 10:29:45.154 [New I/O server worker #1-1] ERROR com.alibaba.otter.canal.server.netty.NettyUtils - ErrotCode:400   Caused by :  something goes wrong with channel:[id: 0x61b78711  /192.168.0.111:60228 => /192.168.0.111:11111]  exception=com.alibaba.otter.canal.meta.exception.CanalMetaManagerException: batchId:72 is not the firstly:71 2018-05-06 10:29:45.171 [New I/O server worker #1-1] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x61b78711  /192.168.0.111:60228 :> /192.168.0.111:11111]  exception=java.nio.channels.ClosedChannelException 	at org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:649) 	at org.jboss.netty.channel.socket.nio.NioWorker.writeFromUserCode(NioWorker.java:370) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:137) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76) 	at org.jboss.netty.channel.Channels.write(Channels.java:611) 	at org.jboss.netty.channel.Channels.write(Channels.java:578) 	at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:28) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:144) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.cleanup(ReplayingDecoder.java:542) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.channelDisconnected(ReplayingDecoder.java:450) 	at org.jboss.netty.channel.Channels.fireChannelDisconnected(Channels.java:360) 	at org.jboss.netty.channel.socket.nio.NioWorker.close(NioWorker.java:599) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:119) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76) 	at org.jboss.netty.channel.Channels.close(Channels.java:720) 	at org.jboss.netty.channel.AbstractChannel.close(AbstractChannel.java:208) 	at org.jboss.netty.channel.ChannelFutureListener$1.operationComplete(ChannelFutureListener.java:46) 	at org.jboss.netty.channel.DefaultChannelFuture.notifyListener(DefaultChannelFuture.java:381) 	at org.jboss.netty.channel.DefaultChannelFuture.addListener(DefaultChannelFuture.java:148) 	at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:30) 	at com.alibaba.otter.canal.server.netty.NettyUtils.error(NettyUtils.java:51) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:200) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:444) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:350) 	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:281) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:201) 	at org.jboss.netty.util.internal.IoWorkerRunnable.run(IoWorkerRunnable.java:46) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) 	at java.lang.Thread.run(Thread.java:748) æ²¡æœ‰é¡ºåºack æ²¡æœ‰é¡ºåºackï¼Ÿä»€ä¹ˆæ„æ€ï¼Ÿèƒ½ä¸èƒ½è¯´å¾—æ›´è¯¦ç»†ç‚¹ï¼Œè°¢è°¢ @mennyzfy è°ƒç”¨getWithoutAckè·å–Messageçš„æ—¶å€™ä¼šç”Ÿæˆä¸€ä¸ªé€’å¢çš„batchIdå¹¶èµ‹å€¼åˆ°Messageçš„idå­—æ®µã€‚åœ¨ackçš„æ—¶å€™éœ€è¦å®¢æˆ·ç«¯ä¿è¯æŒ‰ç…§è·å–Messageçš„é¡ºåºæ¥ackç¡®è®¤æ¶ˆæ¯ã€‚ @zwangbo æˆ‘æ˜¯æŒ‰ç…§è¿™ä¸ªdemoæ¥è¿è¡Œçš„ï¼Œä¸‹é¢æ˜¯ä»£ç ï¼š while (running) {             try {                 MDC.put("destination"  destination);                 connector.connect();                 connector.subscribe("");                 while (running) {                     Message message = connector.getWithoutAck(batchSize); // è·å–æŒ‡å®šæ•°é‡çš„æ•°æ®                     long batchId = message.getId();                     int size = message.getEntries().size();                     if (batchId == -1 || size == 0) {                         try {                             Thread.sleep(1000);                         } catch (InterruptedException e) {                         }                     } else {                             resolveEntry(message.getEntries());                     }                     connector.ack(batchId); // æäº¤ç¡®è®¤                 }             } catch (Exception e) {                 logger.error("process error!"  e);             } finally {                 connector.disconnect();                 MDC.remove("destination");             }         } ä¹Ÿæ˜¯æ¶ˆæ¯è¢«æ¶ˆè´¹åæ‰ç¡®è®¤çš„ï¼Œè€Œä¸”æ˜¯å•çº¿ç¨‹ï¼Œä¸ºä»€ä¹ˆé¡ºåºè¿˜ä¼šä¸ä¸€æ ·ï¼Ÿ @agapple  è™½ç„¶ï¼Œç¡®å®æ˜¯ç”±äºæ²¡æœ‰é¡ºåºç¡®è®¤ackå¼•èµ·çš„ï¼Œä½†æ˜¯ï¼Œè¿™æ— å½¢ä¸­å°±è®©æˆ‘çš„ååé‡å’Œtpsä¸‹é™äº†ä¸å°‘ï¼Œæˆ‘è¿™è¾¹æ˜¯é€šè¿‡å¼€å¤šçº¿ç¨‹å¤„ç†çš„ï¼Œç°åœ¨åªèƒ½å•çº¿ç¨‹å¤„ç† @cjj137783 è¿™ä¸€å—å¯ä»¥è€ƒè™‘è‡ªå·±èµ°å¼‚æ­¥å¤„ç†ç„¶ååšä¸€ä¸ªbufferæ¥æ§åˆ¶acké¡ºåºä»¥åŠackä¸ä¸¢ã€‚è™½ç„¶æˆ‘è§‰å¾—è¿™ä¸ªåŠŸèƒ½å®ç°åœ¨canalè¿™ä¸€è¾¹ä¹Ÿæ˜¯ä¸é”™çš„ã€‚ otterçš„åšæ³•å°±æ˜¯åšäº†ä¸€ä¸ªå¼‚æ­¥bufferï¼Œæ¥é¡ºåºack batchId @mennyzfy æ€ä¹ˆè§£å†³çš„é—®é¢˜å•Š ä¸ºå•¥ä¼šæ¼æ‰ä¸€ä¸ªbranchID å‚è€ƒFAQ :  https://github.com/alibaba/canal/wiki/FAQ
624,Caused by: java.net.ConnectException: Connection refused: connect canalæœåŠ¡ç«¯å·²ç»æˆåŠŸè¿è¡Œï¼Œæ–°å»ºmavené¡¹ç›®æµ‹è¯•ï¼Œå‡ºç°æ‹’ç»è¿æ¥è¯·æ±‚ã€‚ ![](https://ww1.sinaimg.cn/large/005zWjpngy1fr2wcvwun6j310q0eemyo.jpg) è‡ªå·±ç¯å¢ƒæˆ–è€…ç½‘ç»œé—®é¢˜
623,åœ¨CanalConnectoræ¥å£åŠ å…¥stopRunningæ–¹æ³•ï¼Œç”¨äºä¼˜é›…åœæ­¢client [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=623) <br/>All committers have signed the CLA. [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=623) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=623) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=623) it.</sub> tks 
622,block waiting interrupted  by stop request resolve issue https://github.com/alibaba/canal/issues/619 [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=622) <br/>All committers have signed the CLA. [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=622) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=622) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=622) it.</sub> tks
621,close zkclientx if necessary when stop canal and fix CanalInstanceWithManager#doInitEventParser bug tksï¼Œçš„ç¡®æ˜¯ä»£ç copyé—®é¢˜
620,close zkclientx when stop canal [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=620) <br/>All committers have signed the CLA. æ€ä¹ˆå…³é—­äº†ï¼Ÿ æ–°æäº†ä¸€ä¸ª #621  å—¯ï¼Œå·²ç»åˆå¹¶
619,åœ¨cluster clientæ¨¡å¼ä¸‹æ— æ³•è·å¾—æ’ä»–é”æ—¶ä¸èƒ½ä¼˜é›…åœæœº com.alibaba.otter.canal.client.impl.SimpleCanalConnector:448                 mutex.get();// é˜»å¡ç­‰å¾… æ— æ³•é€€å‡º å»ºè®®åœ¨CanalConnectoræ¥å£ä¸­åŠ ä¸€ä¸ªstopSubscribeæ–¹æ³•åœæ­¢é˜»å¡ç­‰å¾… ä½ è¿™ä¸ªåªèƒ½è§£å†³subscribeæ—¶é˜»å¡çš„é—®é¢˜å§ï¼Œå¦‚æœæ˜¯connectæˆ–è€…å…¶ä»–æ“ä½œè¢«mutex.get()é”å®š éƒ½å¯ä»¥åœ¨stopæ—¶ç”¨thread.interrupté€€å‡ºï¼Œæ•è·å¹¶æ·¹æ²¡å¼‚å¸¸åªå¤„ç†äº†subscribeï¼Œå› ä¸ºè¿™ä¸ªæƒ…å†µåœ¨clusteræƒ…å†µä¸‹å¾ˆå¸¸è§ Neal Hu nealhu@apache.org > åœ¨ 2018å¹´5æœˆ7æ—¥ï¼Œ10:18ï¼Œagapple <notifications@github.com> å†™é“ï¼š >  > ä½ è¿™ä¸ªåªèƒ½è§£å†³subscribeæ—¶é˜»å¡çš„é—®é¢˜å§ï¼Œå¦‚æœæ˜¯connectæˆ–è€…å…¶ä»–æ“ä½œè¢«mutex.get()é”å®š >  > â€” > You are receiving this because you authored the thread. > Reply to this email directly  view it on GitHub  or mute the thread. >  æœ‰PRæäº¤æä¾›äº†stopRunningçš„æ–¹æ³•ï¼Œå¯ä»¥é€€å‡º
618,æ”¯æŒé€šè¿‡GTIDåŒæ­¥binlog 1. å¢åŠ instanceçº§é…ç½®`gtidon`ï¼ŒæŒ‡ç¤ºè¯¥instanceæ˜¯å¦å¯ç”¨GTIDæ¨¡å¼ã€‚ 2. driveråŒ…å¢åŠ GTIDç›¸å…³ç±»ï¼š`GTIDSet`ï¼Œ`UUIDSet`æ˜¯GTIDè¡¨ç¤ºï¼Œ`BinlogDumpGTIDCommandPacket`æ˜¯`COM_BINLOG_DUMP_GTID`å‘½ä»¤ã€‚ 3. è¡¥å…¨dbsyncåŒ…ä¸‹çš„`GtidLogEvent`äº‹ä»¶çš„è§£æã€‚ 4. protocolåŒ…ä¸‹ï¼Œå¢åŠ äº†`EntryType`æšä¸¾é¡¹`GTIDLOG`ï¼Œæ˜¯binlogæµä¸­çš„GTIDLOGäº‹ä»¶ï¼›`Header`å¢åŠ äº†å­—æ®µ`gtid`ï¼Œè¿™é‡Œåé¢å•ç‹¬æ®µè½è¯¦ç»†è¯´æ˜ã€‚ 5. parseåŒ…ä¸‹ï¼Œ`ErosaConnection`å¢åŠ æ ¹æ®GTIDåŒæ­¥çš„dumpæ–¹æ³•ã€‚ 6. parseåŒ…ä¸‹ï¼Œ`AbstractEventParser.startå†…`ï¼Œå¦‚æœinstanceä½¿ç”¨GTIDæ¨¡å¼ï¼Œåˆ™å‘é€`COM_BINLOG_DUMP_GTID`å‘½ä»¤ç»™mysqlã€‚ [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=618) <br/>All committers have signed the CLA. éå¸¸èµçš„Pull Requestï¼Œåˆå¹¶ä¹‹åæˆ‘å†ç¨å¾®è°ƒæ•´ä¸€ä¸‹ç»†èŠ‚ :smile: å¾ˆé«˜å…´èƒ½æœ‰è´¡çŒ®ï½ good job 
617,something goes wrong when acking data from server:null å®¢æˆ·ç«¯æŠ¥é”™å¦‚ä¸‹ï¼š 2018-05-03 17:26:50.735 [pool-2-thread-1]  WARN com.alibaba.otter.canal.client.impl.ClusterCanalConnector.?:? - something goes wrong when acking data from server:null com.alibaba.otter.canal.protocol.exception.CanalClientException: java.io.IOException: Broken pipe 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.ack(SimpleCanalConnector.java:324) 	at com.alibaba.otter.canal.client.impl.ClusterCanalConnector.ack(ClusterCanalConnector.java:253) 	at com.lyj.order.es.sync.service.impl.AbstractCanalListenerServiceImpl.lambda$startListener$2(AbstractCanalListenerServiceImpl.java:137) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) 	at java.lang.Thread.run(Thread.java:745) Caused by: java.io.IOException: Broken pipe 	at sun.nio.ch.FileDispatcherImpl.write0(Native Method) 	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47) 	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93) 	at sun.nio.ch.IOUtil.write(IOUtil.java:65) 	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.writeWithHeader(SimpleCanalConnector.java:358) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.ack(SimpleCanalConnector.java:318) 	... 5 more æœåŠ¡ç«¯æŠ¥é”™å¦‚ä¸‹ï¼š ERROR com.alibaba.otter.canal.server.netty.NettyUtils 50 - ErrotCode:400   Caused by: something goes wrong with  channel:[id:0x0f4b9efb  /10.0.39.56:50004 => /10.0.11.161:11111]  exception=com.alibaba.otter.canal.server.exception.CanalServerException:  ack error   clientId:1001 batchld:718 is not exist   pleasecheck è¯·å„ä½å¤§ç‰›å¸®å¿™çœ‹ä¸‹æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Ÿ @agapple     æ¬¢è¿å¤§ç¥æŒ‡ç‚¹~ æœåŠ¡ç«¯instanceé‡å¯æˆ–è€…å‘ç”Ÿäº†rollbackï¼Œå®¢æˆ·ç«¯åšé‡è¯•å³å¯
616,canal.instance.filter.regex Perlæ­£åˆ™è¡¨è¾¾å¼é—®é¢˜ ä½¿ç”¨ canal\\.canal.* å’Œcanal.test1ä¸¤ç§å½¢å¼æ— æ³•è·å–åˆ°binlog å¯ä»¥å¤šçœ‹ä¸‹adminGuideæˆ–è€…FAQ
615,manageç®¡ç†æœ‰æ²¡æœ‰exampleçœ‹çœ‹å‘¢ å¯ä»¥çœ‹çœ‹ä½ ä»¬å†…éƒ¨managerç®¡ç†æ˜¯å¦‚ä½•åšçš„å— å¯ä»¥å‚è€ƒä¸‹otterçš„manager
614,cursoråœæ­¢æ›´æ–° æ‚¨å¥½ï¼Œæˆ‘åœ¨ä½¿ç”¨canalæœŸé—´é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œæè¿°å¦‚ä¸‹ï¼š æˆ‘ä»¬ç›®å‰ä½¿ç”¨canalæ˜¯å•æœºéƒ¨ç½²ï¼Œä¸€å°canal serverå’Œä¸€å°canal clientï¼Œcanal serverç«¯è¿è¡Œä¸€æ®µæ—¶é—´ä¹‹åmeta.datå’Œcursoråœæ­¢æ›´æ–°ï¼Œclientç«¯æ— æ³•æ¥å—åˆ°æ•°æ®å˜æ›´æ¨é€ï¼Œmeta.logå¦‚ä¸‹æ‰€ç¤ºï¼š 2018-04-23 15:06:39.109 - clientId:1001 cursor:[mysql-bin.000673 73407748 1524467197000] address[rm-uf6u3c8i3cejqaia6.mysql.rds.aliyuncs.com/172.19.153.0:3306] 2018-04-23 15:06:45.109 - clientId:1001 cursor:[mysql-bin.000673 73410335 1524467203000] address[rm-uf6u3c8i3cejqaia6.mysql.rds.aliyuncs.com/172.19.153.0:3306] 2018-04-23 15:06:51.109 - clientId:1001 cursor:[mysql-bin.000673 73412633 1524467209000] address[rm-uf6u3c8i3cejqaia6.mysql.rds.aliyuncs.com/172.19.153.0:3306] 2018-04-23 15:06:57.109 - clientId:1001 cursor:[mysql-bin.000673 73438765 1524467215000] address[rm-uf6u3c8i3cejqaia6.mysql.rds.aliyuncs.com/172.19.153.0:3306] 2018-04-23 15:07:02.109 - clientId:1001 cursor:[mysql-bin.000673 73456385 1524467221000] address[rm-uf6u3c8i3cejqaia6.mysql.rds.aliyuncs.com/172.19.153.0:3306] åœ¨04.23æ—¥å°±ä¸å†æ›´æ–°ï¼Œåˆ é™¤meta.daté‡å¯æœåŠ¡ç«¯ä¹‹åä¹Ÿæ²¡ç”¨ å¹¶ä¸”åœ¨meta.datä¸­ä¹Ÿæ²¡æœ‰cursorä¿¡æ¯ï¼š ``` {"clientDatas":[{"clientIdentity":{"clientId":1001 "destination":"rm-uf6u3c8i3cejqaia6" "filter":""}}] "destination":"rm-uf6u3c8i3cejqaia6"} ``` å¦‚æœçœ‹åˆ°äº†çƒ¦è¯·å›å¤ä¸€ä¸‹ï¼Œå¦‚æœæœ‰è§‰å¾—æè¿°ä¸æ¸…çš„åœ°æ–¹ï¼Œçƒ¦è¯·æŒ‡å‡ºï¼Œè°¢è°¢ã€‚ ç‰ˆæœ¬æ˜¯1.0.25 è¿™æ˜¯aliyunçš„rds? å¾—å…³æ³¨ä¸€ä¸‹è§£æè¿‡ç¨‹æ˜¯å¦æœ‰å¼‚å¸¸äº† ç‰ˆæœ¬æ˜¯1.0.25çš„æ—¶å€™æœ‰æŠ¥è¿™ä¸ªé”™ï¼š ``` 2018-04-27 18:29:02.113 [destination = financial   address = /10.44.88.50:13306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address EulerOS-BaseTemplate/10.44.88.50:13306 has an error  retrying. caused by java.nio.channels.ClosedByInterruptException: null at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannel.read(SocketChannel.java:49) ~[canal.parse.driver-1.0.25.jar:na] at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:151) ~[canal.parse-1.0.25.jar:na] at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:77) ~[canal.parse-1.0.25.jar:na] at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:137) ~[canal.parse-1.0.25.jar:na] at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220) ~[canal.parse-1.0.25.jar:na] at java.lang.Thread.run(Thread.java:748) [na:1.8.0_131] 2018-04-27 18:29:02.118 [destination = financial   address = /10.44.88.50:13306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:financial[java.nio.channels.ClosedByInterruptException at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannel.read(SocketChannel.java:49) at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:151) at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:77) at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:137) at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220) at java.lang.Thread.run(Thread.java:748) ] ``` å‡çº§ä¸º1.0.26-SNAPSHOTçš„æ—¶å€™ï¼ŒåˆšåˆšæŠ¥äº†è¿™ä¸ªé”™ï¼Œç„¶åè§£æåœæ­¢ï¼š ``` 2018-05-09 10:10:56.214 [destination = mysql-qry-1   address = mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: EOF encountered. 	at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannel.read(BioSocketChannel.java:80) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:174) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:80) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:144) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_131] 2018-05-09 10:10:56.215 [destination = mysql-qry-1   address = mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306 has an error  retrying. caused by java.io.IOException: EOF encountered. 	at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannel.read(BioSocketChannel.java:80) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:174) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:80) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:144) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_131] 2018-05-09 10:10:56.217 [destination = mysql-qry-1   address = mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:mysql-qry-1[java.io.IOException: EOF encountered. 	at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannel.read(BioSocketChannel.java:80) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:174) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:80) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:144) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220) 	at java.lang.Thread.run(Thread.java:748) ] 2018-05-09 10:11:11.241 [destination = mysql-qry-1   address = mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306 has an error  retrying. caused by com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: connect mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306 failure Caused by: java.io.IOException: connect mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306 failure 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:77) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:77) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:87) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:160) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_131] Caused by: java.net.ConnectException: Connection refused (Connection refused) 	at java.net.PlainSocketImpl.socketConnect(Native Method) ~[na:1.8.0_131] 	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350) ~[na:1.8.0_131] 	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206) ~[na:1.8.0_131] 	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188) ~[na:1.8.0_131] 	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392) ~[na:1.8.0_131] 	at java.net.Socket.connect(Socket.java:589) ~[na:1.8.0_131] 	at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannelPool.open(BioSocketChannelPool.java:20) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannelPool.open(SocketChannelPool.java:18) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:72) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	... 4 common frames omitted 2018-05-09 10:11:11.242 [destination = mysql-qry-1   address = mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:mysql-qry-1[com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: connect mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306 failure Caused by: java.io.IOException: connect mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306 failure 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:77) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:77) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:87) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:160) 	at java.lang.Thread.run(Thread.java:748) Caused by: java.net.ConnectException: Connection refused (Connection refused) 	at java.net.PlainSocketImpl.socketConnect(Native Method) 	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350) 	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206) 	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188) 	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392) 	at java.net.Socket.connect(Socket.java:589) 	at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannelPool.open(BioSocketChannelPool.java:20) 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannelPool.open(SocketChannelPool.java:18) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:72) 	... 4 more ] 2018-05-09 10:11:24.537 [destination = mysql-qry-1   address = mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306 has an error  retrying. caused by com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: connect mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306 failure Caused by: java.io.IOException: connect mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306 failure 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:77) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:77) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:87) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:160) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_131] Caused by: java.net.ConnectException: Connection refused (Connection refused) 	at java.net.PlainSocketImpl.socketConnect(Native Method) ~[na:1.8.0_131] 	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350) ~[na:1.8.0_131] 	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206) ~[na:1.8.0_131] 	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188) ~[na:1.8.0_131] 	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392) ~[na:1.8.0_131] 	at java.net.Socket.connect(Socket.java:589) ~[na:1.8.0_131] 	at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannelPool.open(BioSocketChannelPool.java:20) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannelPool.open(SocketChannelPool.java:18) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:72) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	... 4 common frames omitted 2018-05-09 10:11:24.538 [destination = mysql-qry-1   address = mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:mysql-qry-1[com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: connect mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306 failure Caused by: java.io.IOException: connect mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306 failure 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:77) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:77) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:87) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:160) 	at java.lang.Thread.run(Thread.java:748) Caused by: java.net.ConnectException: Connection refused (Connection refused) 	at java.net.PlainSocketImpl.socketConnect(Native Method) 	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350) 	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206) 	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188) 	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392) 	at java.net.Socket.connect(Socket.java:589) 	at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannelPool.open(BioSocketChannelPool.java:20) 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannelPool.open(SocketChannelPool.java:18) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:72) 	... 4 more ] 2018-05-09 10:11:35.676 [destination = mysql-qry-1   address = mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306 has an error  retrying. caused by com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: connect mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306 failure Caused by: java.io.IOException: connect mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306 failure 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:77) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:77) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:87) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:160) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_131] Caused by: java.net.ConnectException: Connection refused (Connection refused) 	at java.net.PlainSocketImpl.socketConnect(Native Method) ~[na:1.8.0_131] 	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350) ~[na:1.8.0_131] 	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206) ~[na:1.8.0_131] 	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188) ~[na:1.8.0_131] 	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392) ~[na:1.8.0_131] 	at java.net.Socket.connect(Socket.java:589) ~[na:1.8.0_131] 	at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannelPool.open(BioSocketChannelPool.java:20) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannelPool.open(SocketChannelPool.java:18) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:72) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	... 4 common frames omitted 2018-05-09 10:11:35.676 [destination = mysql-qry-1   address = mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:mysql-qry-1[com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: connect mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306 failure Caused by: java.io.IOException: connect mysql-qry-1.db.prod.alsh.xingbianli.com/10.0.96.8:3306 failure 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:77) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:77) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:87) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:160) 	at java.lang.Thread.run(Thread.java:748) Caused by: java.net.ConnectException: Connection refused (Connection refused) 	at java.net.PlainSocketImpl.socketConnect(Native Method) 	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350) 	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206) 	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188) 	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392) 	at java.net.Socket.connect(Socket.java:589) 	at com.alibaba.otter.canal.parse.driver.mysql.socket.BioSocketChannelPool.open(BioSocketChannelPool.java:20) 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannelPool.open(SocketChannelPool.java:18) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:72) 	... 4 more ] ``` æ‰¾åˆ°ä»£ç æ˜¯è¿™é‡Œï¼š ![image](https://user-images.githubusercontent.com/20578246/39792999-ffc6327c-5375-11e8-9fca-b1db368d953f.png) è¯¥è´¦æˆ·ä¸æ•°æ®åº“çš„é“¾æ¥ä¹Ÿä¸­æ–­äº† è¯·é—®ä¸€ä¸‹è¿™ä»€ä¹ˆåŸå› ï¼Ÿè°¢è°¢äº† è¿‡äº†ä¸€æ®µæ—¶é—´ï¼Œå¤§æ¦‚åŠå°æ—¶ä¹‹ååˆé‡è¿ä¸Šäº† Caused by: java.net.ConnectException: Connection refused (Connection refused)
613,java.nio.channels.ClosedByInterruptException 2018-04-27 18:29:02.113 [destination = financial   address = /10.44.88.50:13306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address EulerOS-BaseTemplate/10.44.88.50:13306 has an error  retrying. caused by java.nio.channels.ClosedByInterruptException: null         at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannel.read(SocketChannel.java:49) ~[canal.parse.driver-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:151) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:77) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:137) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220) ~[canal.parse-1.0.25.jar:na]         at java.lang.Thread.run(Thread.java:748) [na:1.8.0_131] 2018-04-27 18:29:02.118 [destination = financial   address = /10.44.88.50:13306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:financial[java.nio.channels.ClosedByInterruptException         at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannel.read(SocketChannel.java:49)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:151)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:77)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:137)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220)         at java.lang.Thread.run(Thread.java:748) ] canalï¼š1.0.25ç‰ˆæœ¬ destinationï¼šfinancialï¼Œdeduct åœºæ™¯ï¼šdeductä¸€ç›´èƒ½å¤Ÿç›‘æµ‹mysqlçš„binlogï¼Œfinancialç›‘æµ‹ä¸€æ®µæ—¶é—´ä¹‹åæŠ›äº†ä¸€ä¸ªè¿™ä¸ªå¼‚å¸¸ï¼Œç„¶åcanal clienté‚£è¾¹ä¸€ç›´æ¶ˆè´¹canal serverçš„financalï¼Œä½†æ˜¯financialä¸èƒ½ç›‘æµ‹binlogï¼Œé‡å¯ä¹‹ååˆæ­£å¸¸äº†ï¼Œä½†æ˜¯è¿‡ä¸€æ®µä¸€æ—¶é—´æœ‰è¿™æ ·é‡å¤äº† å¤§çº¦è¿‡äº†2.5hours financal destinationå°±æŒ‚äº† è¯•è¯•1.0.26ç‰ˆæœ¬ æˆ‘ä»¬ç”¨çš„æ˜¯1.0.26ï¼Œä¹Ÿæœ‰è¿™ä¸ªé—®é¢˜ã€‚åœ¨DUMPæ—¶æŠ¥ java.nio.channels.ClosedByInterruptExceptionï¼Œæ®ç½‘ä¸Šåé¦ˆ1.0.24æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œæ­£åœ¨åšé™çº§éªŒè¯ã€‚
612,c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta 1.0.25ç‰ˆæœ¬ canal.instance.tsdb.enable=false 2018-04-27 17:11:17.990 [destination = billingondemandfee01db   address = /10.179.171.159:40002   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - pls submit github issue  show create table ddl:CREATE TABLE `t_billing_accumulator_conf` (   `serviceTypeCode` varchar(64) NOT NULL   `resourceTypeCode` varchar(64) NOT NULL   `accumulateFactorName` varchar(64) NOT NULL   `amount` int(11) NOT NULL   `measureId` int(11) NOT NULL   `logTime` datetime DEFAULT NULL   `memo` varchar(200) DEFAULT NULL   `extendParams` varchar(1024) DEFAULT NULL   UNIQUE KEY `uniqueRecord` (`serviceTypeCode` `resourceTypeCode` `accumulateFactorName`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8   compare failed .  db : TableMeta [schema=billingondemandfee01db  table=t_billing_accumulator_conf  fileds=         FieldMeta [columnName=serviceTypeCode  columnType=varchar(64)  defaultValue=null  nullable=false  key=true]         FieldMeta [columnName=resourceTypeCode  columnType=varchar(64)  defaultValue=null  nullable=false  key=true]         FieldMeta [columnName=accumulateFactorName  columnType=varchar(64)  defaultValue=null  nullable=false  key=true]         FieldMeta [columnName=amount  columnType=int(11)  defaultValue=null  nullable=false  key=false]         FieldMeta [columnName=measureId  columnType=int(11)  defaultValue=null  nullable=false  key=false]         FieldMeta [columnName=logTime  columnType=datetime  defaultValue=null  nullable=true  key=false]         FieldMeta [columnName=memo  columnType=varchar(200)  defaultValue=null  nullable=true  key=false]         FieldMeta [columnName=extendParams  columnType=varchar(1024)  defaultValue=null  nullable=true  key=false] ]  mem : TableMeta [schema=billingondemandfee01db  table=t_billing_accumulator_conf  fileds=         FieldMeta [columnName=serviceTypeCode  columnType=varchar(64)  defaultValue=null  nullable=false  key=false]         FieldMeta [columnName=resourceTypeCode  columnType=varchar(64)  defaultValue=null  nullable=false  key=false]         FieldMeta [columnName=accumulateFactorName  columnType=varchar(64)  defaultValue=null  nullable=false  key=false]         FieldMeta [columnName=amount  columnType=int(11)  defaultValue=null  nullable=false  key=false]         FieldMeta [columnName=measureId  columnType=int(11)  defaultValue=null  nullable=false  key=false]         FieldMeta [columnName=logTime  columnType=datetime  defaultValue=null  nullable=true  key=false]         FieldMeta [columnName=memo  columnType=varchar(200)  defaultValue=null  nullable=true  key=false]         FieldMeta [columnName=extendParams  columnType=varchar(1024)  defaultValue=null  nullable=true  key=false] ] 2018-04-27 17:11:20.911 [destination = billingondemandfee01db   address = /10.179.171.159:40002   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - compare failed   check log å·²çŸ¥é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨1.0.26ç‰ˆæœ¬æµ‹è¯•ä¸€ä¸‹
611,canalå¯åŠ¨æ­£å¸¸ï¼ŒæŠ“ä¸åˆ°binlogæ•°æ® canalå¯åŠ¨æ­£å¸¸ï¼ŒæŠ“ä¸åˆ°binlogæ•°æ®ã€‚è¯·æ•™å„ä½å¤§ç¥ã€‚ å¤šçœ‹ä¸‹FAQ
610,DDLè¯­å¥çš„commentä¸­æ–‡å‡ºç°ä¹±ç  MySQLä¸­ï¼Œcharsetä¸º utf8mb4ï¼Œcollationä¸º utf8mb4_general_ci æµ‹è¯•è¿‡ç¨‹ä¸­å»ºè¡¨è¯­å¥å¦‚ä¸‹ï¼š ```sql CREATE TABLE `xxx` (   `id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®idï¼Œè‡ªå¢'   `run_time` int(13) NOT NULL DEFAULT '0' COMMENT 'è¿è¡Œæ€»æ—¶é•¿-ç§’'   `init_time` int(13) NOT NULL DEFAULT '0' COMMENT 'åˆå§‹åŒ–æ—¶é•¿-ç§’'   `simulation_time` int(13) NOT NULL DEFAULT '0' COMMENT 'æ¨¡æ‹Ÿè®¡ç®—è€—æ—¶-ç§’'   `create_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´'   `update_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´'   PRIMARY KEY (`id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='hadoopå¤„ç†èƒ½åŠ›æ ‡å‡†ç›‘æ§ç¨‹åºè¿è¡Œæ—¶é•¿'; ``` Canal serveræ¥æ”¶åï¼Œå¾—åˆ°çš„SQLè¯­å¥å¦‚ä¸‹ï¼š ```sql create table `xxx` ( `id` int(11) NOT NULL auto_increment COMMENT 'Å¡Å‚Ä½Å¥Ä’Ä£idÃ”Ä¾Ä†Å¤Ã¡â„¢ÅšÄ˜Ä›' `run_time` int(13) NOT NULL DEFAULT 0 COMMENT 'Å¤Å…ÅºÅ¤Â°Ä†Å›Ã„Ä½Å›Ã³âˆ‚Å¥Ä“Å…-ÃÃŸÃ­' `init_time` int(13) NOT NULL DEFAULT 0 COMMENT 'ÅšÄ…ÄšÅšÃŸÄÅšÄ†Ä–Å›Ã³âˆ‚Å¥Ä“Å…-ÃÃŸÃ­'   `simulation_time` int(13) NOT NULL DEFAULT 0 COMMENT 'Å›Â®Â°Å›ÄÃ¼Å¤Ä£Â°ÃÄ£Ã³Å¤Ã„Ã³Å›Ã³âˆ‚-ÃÃŸÃ­'   `create_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'ÅšÄ…ÃµÅšÄ½Ä¼Å›Ã³âˆ‚Å¥Ã³Ä«' `update_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Å›ÃµÄ«Å›Ä–Ä¯Å›Ã³âˆ‚Å¥Ã³Ä«' PRIMARY KEY(`id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT 'hadoopÅšÂ§Ä„ÃÅºÃœÅ¤Ã‰Ä¹ÅšÃ¤ÃµÅ›â€ Ã¡ÅšÃ¡ÃœÃÃµÄÅ›Ã©ÃŸÃÂ®ÄÅšÄ¼Å¹Å¤Å…ÅºÅ¤Â°Ä†Å›Ã³âˆ‚Å¥Ä“Å…'; ``` é—®é¢˜å¯èƒ½çš„åŸå› ï¼Œåœ¨canal serveræ¥æ”¶åˆ°binlogæ—¥å¿—æ—¶ï¼Œä¼šä»binlogæ—¥å¿—ä¸­å¾—åˆ° clientCharset = 45ï¼Œä»è€Œå¾—åˆ° charsetName = MacCentralEuropeï¼Œå†è§£ç å¾—å‡ºä¸Šè¿°çš„å¸¦ä¸­æ–‡ä¹±ç çš„SQL https://github.com/alibaba/canal/blob/f46133d1168071741e8e3e4235aa635c5870a976/dbsync/src/main/java/com/taobao/tddl/dbsync/binlog/event/QueryLogEvent.java#L482 https://github.com/alibaba/canal/blob/f46133d1168071741e8e3e4235aa635c5870a976/dbsync/src/main/java/com/taobao/tddl/dbsync/binlog/CharsetConversion.java#L106 ```java         // è¿™ä¸¤é¡¹å®šä¹‰æ˜¯å¦æ­£ç¡®ï¼Ÿ         putEntry(45  "utf8mb4"  "utf8mb4_general_ci"  "MacCentralEurope");         putEntry(46  "utf8mb4"  "utf8mb4_bin"  "MacCentralEurope"); ``` ä½ æœ€å¥½debugä¸€ä¸‹eventæ”¶åˆ°çš„ç¼–ç æ˜¯å•¥ 1ã€MySQLä¸­ï¼Œcharsetä¸º utf8mb4ï¼Œcollationä¸º utf8mb4_general_ciï¼Œåœ¨mysqlå®˜ç½‘å¯¹åº”çš„ ID= 45ï¼Œåœ¨ç”Ÿäº§åº“ä¸­æ‰§è¡Œè¿™ä¸ªsql ```SQL SHOW COLLATION WHERE Charset = 'utf8mb4'; ``` æŸ¥å‡ºæ¥ä¹Ÿæ˜¯ä¸€æ ·çš„ ![image](https://user-images.githubusercontent.com/4264237/39353745-2b1011a8-4a3b-11e8-973d-ceda62a823c7.png) 2ã€å¹¶ä¸”åœ¨debugæ—¶ï¼Œåœ¨ä¸‹é¢ä»£ç æ‰§è¡Œè¿‡ç¨‹ï¼Œä»binlogæ—¥å¿—ä¸­å¾—åˆ° clientCharset = 45ï¼Œä»è€Œå¾—åˆ° charsetName = MacCentralEurope  ```java         /* A 2nd variable part; this is common to all versions */         final int queryLen = dataLen - dbLen - 1;         dbname = buffer.getFixString(dbLen + 1);         if (clientCharset >= 0) {             charsetName = CharsetConversion.getJavaCharset(clientCharset);             if ((charsetName != null) && (Charset.isSupported(charsetName))) {                 query = buffer.getFixString(queryLen  charsetName);             } else {                 logger.warn("unsupported character set in query log: " + "\n    ID = " + clientCharset + "  Charset = "                             + CharsetConversion.getCharset(clientCharset) + "  Collation = "                             + CharsetConversion.getCollation(clientCharset));                 query = buffer.getFixString(queryLen);             }         } else {             query = buffer.getFixString(queryLen);         } ``` debugæˆªå›¾ ![image](https://user-images.githubusercontent.com/4264237/39354991-8745483c-4a3e-11e8-89b4-7d3d54a943de.png) 3ã€æˆ‘å°è¯•æŠŠ ```java putEntry(45  "utf8mb4"  "utf8mb4_general_ci"  "MacCentralEurope"); ``` æ”¹æˆäº† ```java putEntry(45  "utf8mb4"  "utf8mb4_general_ci"  "UTF-8"); ``` ç„¶åï¼Œä¹±ç å°±è§£å†³äº† debugæˆªå›¾ ![image](https://user-images.githubusercontent.com/4264237/39354985-80b28a34-4a3e-11e8-8765-3238ef3d0b02.png) 4ã€åœ¨ä»£ç ä¸­ï¼Œä¸ utf8mb4 å¯¹åº”çš„ javaCharset åªæœ‰ 45ï¼Œ46 ä¸¤é¡¹æ‰€ä¸º ```MacCentralEurope```ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œå…¶ä»–éƒ½å¯¹åº”åˆ°äº† ```UTF-8``` ![image](https://user-images.githubusercontent.com/4264237/39353950-bc57543c-4a3b-11e8-9ba1-0a066b8f9573.png) https://github.com/alibaba/canal/blob/f46133d1168071741e8e3e4235aa635c5870a976/dbsync/src/main/java/com/taobao/tddl/dbsync/binlog/CharsetConversion.java#L106 åº”è¯¥æ˜¯å½“æ—¶çš„ç¬”è¯¯ï¼Œå·²ä¿®å¤
609,æ•°æ®è§£æç±»å‹é”™è¯¯ insert->query header {   version: 1   logfileName: "mysql-bin.001545\302\243\302\235E\004"   logfileOffset: 86861287   serverId: 5243   serverenCode: "UTF-8"   executeTime: 1524571682000   sourceType: MYSQL   schemaName: ""   tableName: ""   eventLength: 112   eventType: QUERY } entryType: ROWDATA storeValue: "\020\aZYinsert into data_compare.lzw_receive_json_log(min_id max_id) values (116521634 116521636)" æ˜¯å› ä¸ºè§£æçš„ä¹±ç é—®é¢˜å— è¿™æ˜¯mysql5.6çš„rows_query_log_eventï¼Œå°±æ˜¯ä¸€æ¡query
608,no match ack positionLogPosition message[batchId=1 size=259]  15:00:18.080 [kafka-producer-network-thread | producer-1] DEBUG o.apache.kafka.clients.NetworkClient - [Producer clientId=producer-1] Using older server API v2 to send PRODUCE {acks=-1 timeout=30000 partitionSizes=[case_flow_topic-1=3032]} with correlation id 9 to node 1003 . . 15:00:18.623 [kafka-producer-network-thread | producer-1] DEBUG o.apache.kafka.clients.NetworkClient - [Producer clientId=producer-1] Using older server API v2 to send PRODUCE {acks=-1 timeout=30000 partitionSizes=[case_flow_topic-1=4021]} with correlation id 56 to node 1003 com.alibaba.otter.canal.protocol.exception.CanalClientException: something goes wrong with reason: something goes wrong with channel:[id: 0x6c969f24  /192.168.113.5:38172 => /192.168.113.5:11111]  exception=com.alibaba.otter.canal.store.CanalStoreException: no match ack positionLogPosition[identity=LogIdentity[sourceAddress=192.168.113.243/192.168.113.243:3306 slaveId=-1] postion=EntryPosition[included=false journalName=mysql-bin.001543 position=916315835 serverId=1803306 timestamp=1524553202000]] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.receiveMessages(SimpleCanalConnector.java:245) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:222) 	at com.alibaba.otter.canal.client.impl.ClusterCanalConnector.getWithoutAck(ClusterCanalConnector.java:183) 	at com.zichan360.bigdata.canal.client.caseflow.SyncCaseFlowTables.main(SyncCaseFlowTables.java:32) 15:00:24.652 [main] INFO  c.a.o.c.c.impl.ClusterCanalConnector - restart the connector for next round retry. message[batchId=2 size=259]  . . . ä»£ç  String destination = args[0];         String topic = args[1];         CanalConnector connector = CanalConnectors.newClusterConnector("zk"  destination  ""  "");         int batchSize = 1000;         int emptyCount = 0;         try {             connector.connect();             connector.rollback();             int totalEmptyCount = 120;             while (emptyCount < totalEmptyCount) {                 Message message = connector.getWithoutAck(batchSize 2000L  TimeUnit.MILLISECONDS);                 long batchId = message.getId();                 int size = message.getEntries().size();                 if (batchId == -1 || size == 0) {                     emptyCount++;                     try {                         Thread.sleep(1000);                     } catch (InterruptedException e) {                     }                 } else {                     emptyCount = 0;                     System.out.printf("message[batchId=%s size=%s] \n"  batchId  size);                     produceKafkaData(message.getEntries()  topic);                     try {                         Thread.sleep(1000);                     } catch (InterruptedException e) {                     }                 }                 try {                     connector.ack(batchId);                 } catch (Exception e) {                     e.printStackTrace();                     connector.rollback(batchId);                 }             }         } finally {             connector.disconnect();         } no match ack ä¼°è®¡æ˜¯æœåŠ¡ç«¯é‡å¯äº†instanceï¼Œclientåšä¸€ä¸‹é‡è¯•æ¢å¤å³å¯
607,serverå¯åŠ¨å¤šä¸ªinstanceï¼Œæ€»æœ‰instanceæœªå¯åŠ¨ æˆ‘æœ‰ä¸¤ä¸ªserverï¼Œåˆ†åˆ«å¯åŠ¨3ä¸ªinstance server1å¯åŠ¨æˆåŠŸäº†1ä¸ª server2å¯åŠ¨æˆåŠŸäº†2ä¸ª å¯åŠ¨å¤±è´¥çš„instanceæ²¡æœ‰æŠ¥é”™ã€‚ åªæ˜¯å¯åŠ¨çš„æ—¶å€™æ²¡æœ‰å»å¯»æ‰¾ä½ç‚¹ï¼Œinstanceæ–‡ä»¶å¤¹ä¸‹çš„meta.datä¸­ä¹Ÿæ²¡æœ‰postionçš„ä¿¡æ¯ è·Ÿåº“çš„å…³ç³»åº”è¯¥ä¸å¤§ï¼Œå› ä¸ºå¯åŠ¨å¤±è´¥çš„instanceå¹¶ä¸æ˜¯å›ºå®šçš„ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€ä¸ªserveræ¨èé…ç½®æ˜¯æœ€å¤šå¯åŠ¨å‡ ä¸ªinstanceçš„ æ²¡æœ‰çº¦æŸinstanceçš„æ•°é‡ï¼Œä½ è¦å¼€å¯clientæ¶ˆè´¹æ‰ä¼šæœ‰meta.datçš„position
606,canalæœåŠ¡ç«¯å®•æœºåï¼Œä¸ºä»€ä¹ˆéœ€è¦é‡å¯2æ¬¡canal æœåŠ¡ç«¯æ‰èƒ½é‡æ–°è·å–åˆ°binlogæ—¥å¿—æ•°æ®     å‘å„ä½è¯·æ•™ä¸ªé—®é¢˜ï¼Œé—®é¢˜å¦‚ä¸‹æ‰€è¿°ã€‚     å½“canalï¼ˆ1.0.25ï¼‰æœåŠ¡ç«¯å®•æœºåï¼Œä¸ºä»€ä¹ˆéœ€è¦é‡å¯2æ¬¡canal æœåŠ¡ç«¯ï¼Œæ‰èƒ½é‡æ–°è·å–åˆ°æ•°æ®åº“binlogæ—¥å¿—æ•°æ®ã€‚é‡å¯1æ¬¡æ— æ³•è·å–åˆ°æ•°æ®åº“binlogæ—¥å¿—æ•°æ®ã€‚ ä»Šå¤©è¯•äº†å‡ æ¬¡åˆæ²¡é—®é¢˜äº†ã€‚å›å¤´å†æ‰¾æ‰¾åŸå› ã€‚
605,äº‹åŠ¡è¾ƒå¤§çš„æƒ…å†µä¸‹binlogæ•°æ®ä¸¢å¤± åœ¨æµ‹è¯•canalåŒæ­¥æ•°æ®åˆ°esçš„æ—¶å€™ï¼Œä»mysql dumpå‡ºä¸€ä¸ªè¡¨ï¼Œå¯¼å‡ºçš„æ—¶å€™æ¯250è¡Œåˆ‡åˆ†ä¸ºä¸€ä¸ªäº‹åŠ¡ï¼Œç„¶åæŠŠè¡¨truncateæ‰ï¼Œå†importå¯¼å‡ºçš„sqlï¼Œå‘ç°åŒæ­¥å®Œæˆåesä¸­ä¼šæ¯”mysqlå°‘ä¸‰ç™¾æ¡å·¦å³çš„æ•°æ®ï¼ˆæ€»æ•°æ®é‡4W+ï¼‰ã€‚ç»è°ƒè¯•å‘ç°æ˜¯canalåœ¨åŒæ­¥binlogè¿‡ç¨‹ä¸­å‘ç”Ÿäº†æ•°æ®ä¸¢å¤±ï¼Œå¤§éƒ¨åˆ†äº‹åŠ¡éƒ½è¢«å®Œæ•´åŒæ­¥äº†ï¼Œæœ‰å‡ ä¸ªäº‹åŠ¡åªåŒæ­¥è¿‡æ¥ä¸åˆ°100æ¡æ•°æ®ã€‚åæ¥æŠŠäº‹åŠ¡æ¯10è¡Œæ•°æ®åˆ‡åˆ†ä¸€ä¸ªäº‹åŠ¡ï¼Œå°±ä¸ä¼šå‡ºç°ä¸¢æ•°æ®çš„æƒ…å†µäº†ã€‚è¯·é—®ä¸€ä¸‹è¿™å’Œç½‘ç»œçŠ¶å†µæœ‰å…³å—ï¼Ÿæˆ–è€…åªæ˜¯å› ä¸ºäº‹åŠ¡è¿‡å¤§ï¼Ÿ è¿™ä¸ªé—®é¢˜æ€ä¹ˆå¤„ç†äº†ï¼Ÿ
604,æ‰¾ä¸åˆ° com.alibaba.fastsql:fastsql:jar:2.0.0_preview_228 åŒ…ï¼Œæ”¹æˆcom.alibaba.fastsql:fastsql:jar:2.0.0_preview_186 [ERROR] Failed to execute goal on project canal.parse: Could not resolve dependencies for project com.alibaba.otter:canal.parse:jar:1.0.26-SNAPSHOT: Failure to find com.alibaba.fastsql:fastsql:jar:2.0.0_preview_228 in http://maven.aliyun.com/nexus/content/groups/public was cached in the local repository  resolution will not be reattempted until the update interval of nexus-aliyun has elapsed or updates are forced -> [Help 1] com.alibaba.fastsql:fastsql:jar:2.0.0_preview_228 è¿™ä¸ªåŒ…ä»€ä¹ˆæ—¶å€™èƒ½æ”¾å‡ºå‘¢ï¼Ÿ çœ‹ä¸€ä¸‹äºŒè¿›åˆ¶å‘å¸ƒåŒ…é‡Œæœ‰
603,com.alibaba.otter.canal.protocol.exception.CanalClientException: java.io.IOException: æ‚¨çš„ä¸»æœºä¸­çš„è½¯ä»¶ä¸­æ­¢äº†ä¸€ä¸ªå·²å»ºç«‹çš„è¿æ¥ã€‚ 2018-04-23 15:05:05.780-[ERROR]-[Thread-0]-com.clickplus.canal.AbstractCanalClientTest:151-process error! com.alibaba.otter.canal.protocol.exception.CanalClientException: java.io.IOException: æ‚¨çš„ä¸»æœºä¸­çš„è½¯ä»¶ä¸­æ­¢äº†ä¸€ä¸ªå·²å»ºç«‹çš„è¿æ¥ã€‚ 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.ack(SimpleCanalConnector.java:257) ~[canal.client-1.0.4.jar:na] 	at com.clickplus.canal.AbstractCanalClientTest.process(AbstractCanalClientTest.java:143) ~[classes/:na] 	at com.clickplus.canal.AbstractCanalClientTest$2.run(AbstractCanalClientTest.java:86) [classes/:na] 	at java.lang.Thread.run(Thread.java:722) [na:1.7.0_17] Caused by: java.io.IOException: æ‚¨çš„ä¸»æœºä¸­çš„è½¯ä»¶ä¸­æ­¢äº†ä¸€ä¸ªå·²å»ºç«‹çš„è¿æ¥ã€‚ 	at sun.nio.ch.SocketDispatcher.write0(Native Method) ~[na:1.7.0_17] 	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:51) ~[na:1.7.0_17] 	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:94) ~[na:1.7.0_17] 	at sun.nio.ch.IOUtil.write(IOUtil.java:65) ~[na:1.7.0_17] 	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:450) ~[na:1.7.0_17] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.writeWithHeader(SimpleCanalConnector.java:289) ~[canal.client-1.0.4.jar:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.ack(SimpleCanalConnector.java:253) ~[canal.client-1.0.4.jar:na] 	... 3 common frames omitted é—®é¢˜æè¿°æœ€å¥½è¯¦ç»†ç‚¹ï¼Œå¦åˆ™ä¸å¥½åˆ†æ @jnliao è°¢è°¢å›ç­”ï¼Œå°æ•°æ®é‡æ—¶ï¼Œcanalè¿è¡Œæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œå½“æœ‰å¤§äº‹åŠ¡æ‰§è¡Œæ—¶ï¼ˆåƒçº§ä¸‡çº§çš„insertï¼‰ï¼Œå°±ä¼šæŠ¥è¿™ä¸ªé”™è¯¯ï¼Œè°ƒå¤§äº†buffersizeå’Œå®¢æˆ·ç«¯çš„batchsizeéƒ½æ²¡ä»€ä¹ˆç”¨ æˆ‘ä¹‹å‰å¤„ç†æ•°æ®æ—¶ä¹Ÿé‡åˆ°è¿‡è¿™ç§é—®é¢˜ã€‚ 1ã€ä½¿ç”¨åœºæ™¯ æˆ‘ä½¿ç”¨çš„æ˜¯canal 1.0.25ï¼Œå®¢æˆ·ç«¯é‡‡ç”¨å®šæ—¶ä»»åŠ¡å®æ—¶å¤„ç†canalæœåŠ¡ç«¯è·å–çš„æ—¥å¿—æ•°æ®ï¼Œå¹¶ä¸”æ¯ä¸ªå®šæ—¶ä»»åŠ¡éƒ½æ˜¯ä½¿ç”¨åŒä¸€ä¸ªå®¢æˆ·ç«¯é“¾æ¥å¯¹è±¡ã€‚æ•°æ®åº“ç¬é—´æ›´æ–°1wæ¡æ•°æ®æ—¶ï¼Œcanalå®¢æˆ·ç«¯å¤„ç†æ•°æ®æ—¶ï¼Œè¿è¡Œä¸€ä¼šå°±ä¼šä¸€ç›´æŠ¥ä½ è¯´çš„è¿™ç§é”™è¯¯â€”â€”â€œCaused by: java.io.IOException: æ‚¨çš„ä¸»æœºä¸­çš„è½¯ä»¶ä¸­æ­¢äº†ä¸€ä¸ªå·²å»ºç«‹çš„è¿æ¥ã€‚â€ 2ã€è§£å†³åŠæ³• æ¯ä¸ªå®šæ—¶ä»»åŠ¡éƒ½ä½¿ç”¨æ–°åˆ›å»ºçš„å®¢æˆ·ç«¯é“¾æ¥å¯¹è±¡ã€‚å¹¶åœ¨ä»»åŠ¡ç»“æŸæ—¶æ–­å¼€é“¾æ¥ã€‚ https://github.com/alibaba/canal/issues/640ï¼Œå…³æ³¨ä¸€ä¸‹è¿™ä¸ª
602,è¿å‡ºä»£ç åï¼Œmvn æ„å»ºcanal.common:jar:1.0.26-SNAPSHOT åŒ…æ‰¾ä¸åˆ° Could not find artifact com.alibaba.otter:canal.common:jar:1.0.26-SNAPSHOT in nexus-aliyun (http://maven.aliyun.com/nexus/content/groups/public) æŸ¥äº†ä¸‹ï¼Œåªæœ‰1.0.25 ä»¥åŠ 9.0.0 æˆ‘å¯¹common åŒ…é‡æ–° install åæˆåŠŸäº†ï¼›  æ²¡æœ‰aliyun çš„ deploy æƒé™
601,canalè¿è¡Œ38ä¸ªå°æ—¶å·¦å³ï¼Œå®¢æˆ·ç«¯æŠ¥é”™Broken pipeï¼ŒæœåŠ¡ç«¯æ²¡æŠ¥é”™ï¼Œä»€ä¹ˆåŸå›  com.alibaba.otter.canal.protocol.exception.CanalClientException: java.io.IOException: Broken pipe 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.ack(SimpleCanalConnector.java:343) Caused by: java.io.IOException: Broken pipe 	at sun.nio.ch.FileDispatcherImpl.write0(Native Method) 	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47) 	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93) 	at sun.nio.ch.IOUtil.write(IOUtil.java:65) 	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471) 	at java.nio.channels.Channels.writeFullyImpl(Channels.java:78) 	at java.nio.channels.Channels.writeFully(Channels.java:98) 	at java.nio.channels.Channels.access$000(Channels.java:61) 	at java.nio.channels.Channels$1.write(Channels.java:174) 	at java.nio.channels.Channels$WritableByteChannelImpl.write(Channels.java:458) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.writeWithHeader(SimpleCanalConnector.java:400) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.writeWithHeader(SimpleCanalConnector.java:387) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.ack(SimpleCanalConnector.java:337) 	... 6 more è¿™æ˜¯è¢«æœåŠ¡ç«¯ä¸»åŠ¨æ–­å¼€è¿æ¥äº† æœåŠ¡ç«¯ä¸ºä»€ä¹ˆä¸»åŠ¨æ–­å¼€è¿æ¥äº†ï¼Œè¿™æ˜¯ä¸æ˜¯canalçš„é—®é¢˜ï¼Ÿæˆ–è€…è¯·é—®è¦æ€ä¹ˆå¤„ç†ï¼Ÿ æ£€æŸ¥serverçš„æ—¥å¿— serverç«¯æ²¡æŠ¥é”™ï¼Œå°±å®¢æˆ·ç«¯æŠ¥é”™äº† æˆ‘ä¹Ÿæœ‰è¿™ä¸ªé—®é¢˜ï¼Œè¯·é—®è¿™æ˜¯å’‹å›äº‹ï¼Ÿæˆ‘ç”¨çš„æ˜¯25ç‰ˆæœ¬çš„ã€‚ https://github.com/alibaba/canal/issues/640ï¼Œå…³æ³¨ä¸€ä¸‹è¿™ä¸ª
599,å¤§æ•°æ®é‡æ—¶ canalæœåŠ¡ç«¯æŠ¥c.a.o.c.server.netty.handler.ClientAuthenticationHandler - idle timeout exceeds  close channel to save server resources é—®é¢˜åœºæ™¯ï¼š ä¸‡çº§çš„æ•°æ®è¿›è¡Œinsertæ“ä½œæ—¶ï¼ŒcanalæœåŠ¡ç«¯ä¼šæŠ¥ c.a.o.c.server.netty.handler.ClientAuthenticationHandler - channel:[id: 0x3c24ea0e  /192.168.1.111:64402 => /192.168.1.111:11111] idle timeout exceeds  close channel to save server resources é”™è¯¯``ã€‚ å®¢æˆ·ç«¯çš„æ—¥å¿—æ˜¾ç¤ºï¼Œè®¢é˜…çš„binlogä¼šä¸€ç›´é‡å¤å‡ºç°(0-10000å†å¾ªç¯0-10000) å¯¼è‡´delayæ—¶é—´å˜å¾—å¾ˆé•¿ï¼Œåˆ«çš„è¡¨çš„åŒæ­¥å°±è¿›ä¸å»äº†ã€‚ è¿™ç§æƒ…å†µæ˜¯è¦æ‰©å¤§canalçš„ringbufferå’Œå®¢æˆ·ç«¯çš„batchsizeå—ï¼Œæœ¬åœ°æµ‹è¯•äº†ä¸€ä¸‹éƒ½æ²¡æœ‰è§£å†³é—®é¢˜ ä½ è¿™ä¸ªå¼‚å¸¸æ—¶é“¾æ¥idle timeoutè¶…æ—¶ï¼Œæœ€å¥½ä½ éœ€è¦è§‚å¯Ÿä¸€ä¸‹è¿è¡Œå †æ ˆ æˆ‘ä¹Ÿé‡åˆ°è¿™ä¸ªé—®é¢˜äº†ï¼Œæ€ä¹ˆè§£å†³çš„ serverç«¯ batchModeè®¾ç½®ä¸ºitemSize  ç„¶åï¼Œclientç«¯çš„batchSizeè®¾ç½®å°ä¸€ç‚¹ï¼Œé»˜è®¤è¶…æ—¶æ—¶é—´ 30s ackæ‰å°±å¯ä»¥ã€‚ https://github.com/alibaba/canal/issues/640ï¼Œå…³æ³¨ä¸€ä¸‹è¿™ä¸ª
598,ä¸€ä¸ªrds   mysqlåº“é…ç½®ä¸‰ä¸ªinstanceï¼Œåªæœ‰ä¸¤ä¸ªèƒ½æ­£å¸¸è¯»åˆ°binlogï¼Ÿ rdsä¸Šä¸€ä¸ªåº“çš„ä¸€ä¸ªè¡¨åˆ†äº†ä¸€åƒå¼ ï¼Œæ‰€ä»¥é…ç½®äº†ä¸‰ä¸ªinstanceï¼Œç„¶åæ¯ä¸ªè¿‡æ»¤ä¸åŒçš„è¡¨ã€‚ä½†æ˜¯åªæœ‰ä¸¤ä¸ªinstanceèƒ½æ­£å¸¸æ¶ˆè´¹åˆ°binlogæ—¥å¿—ã€‚å¦å¤–ä¸€ä¸ªinstanceå³ä½¿ è¡¨æœ‰æ•°æ®ï¼Œä¹Ÿæ¶ˆè´¹ä¸åˆ°    batchId è¿”å›çš„æ˜¯-1 æˆ‘ä¹Ÿç¢°åˆ°ç±»ä¼¼çš„é—®é¢˜ï¼Œæ€»æ˜¯æœ‰instanceæ²¡æœ‰å»è·å–ä½ç‚¹ï¼Œinstanceæ–‡ä»¶ä¸‹çš„meta.datä¸­æ²¡æœ‰postionä¿¡æ¯ å‡çº§åˆ°1.0.26ç‰ˆæœ¬ï¼Œæ­£å¸¸äº†ã€‚
597,com.alibaba.otter.canal.protocol.exception.CanalClientException: java.io.IOException: Broken pipeï¼› å½“æ•°æ®é‡å°çš„æ—¶å€™æ²¡æœ‰é—®é¢˜ï¼Œå½“æœ‰ä¸‡çº§çš„æ•°æ®åŒæ­¥æ’å…¥æ—¶ï¼Œcanalå°±ä¼šæŠ¥com.alibaba.otter.canal.protocol.exception.CanalClientException: java.io.IOException: Broken pipe é”™è¯¯ã€‚ ç°è±¡æ˜¯canalä¸€ç›´è¯»å–æ’å…¥ä¸‡çº§çš„æ—¥å¿—ï¼Œå¾ªç¯è°ƒç”¨ã€‚å¯¼è‡´åœ¨mysqlä¸­å…ˆæ’å…¥åˆåˆ é™¤ï¼Œå†æ’å…¥åˆ é™¤ï¼Œä¸€ç›´é‡å¤ã€‚è¯·é—®æ˜¯ä»€ä¹ˆåŸå›  https://github.com/alibaba/canal/issues/640ï¼Œå…³æ³¨ä¸€ä¸‹è¿™ä¸ª
596,canalé›†ç¾¤æ¨¡å¼ä¸‹ï¼Œå®¢æˆ·ç«¯è°ƒç”¨connector.subscribe("schema1\\..")æ— æ•ˆ hi ï¼Œdear   åœ¨ä½¿ç”¨canalè¿›è¡Œå¼€å‘çš„æ—¶å€™ç¢°åˆ°äº†å¦‚ä¸‹çš„é—®é¢˜ï¼š 1. é—®é¢˜æè¿°ï¼š    canalé›†ç¾¤ç¯å¢ƒä¸‹ï¼Œå®¢æˆ·ç«¯è°ƒç”¨connector.subscribe("schema1\\..")æ— æ•ˆï¼Œå‹æ ¹ç›‘å¬ä¸åˆ°schema1æ•°æ®åº“ä¸‹çš„è¡¨æ•°æ®å˜åŒ–çš„æ—¥å¿—ã€‚å¹¶ä¸”ä¿®æ”¹å›å»connector.subscribe()å†æ¬¡é‡å¯å®¢æˆ·ç«¯ï¼Œä¹‹å‰èƒ½æ­£å¸¸ç›‘å¬æ‰€æœ‰è¡¨çš„åŠŸèƒ½ä¹Ÿç«‹é©¬å¤±æ•ˆã€‚é‡å¯canalæœåŠ¡ç«¯ä¹Ÿæ²¡ç”¨ã€‚ä½†æ˜¯ä¿®æ”¹canalæœåŠ¡ç«¯çš„zookeeperæŒ‡å‘ï¼Œå†é‡å¯canalæœåŠ¡ç«¯ï¼Œåˆèƒ½æ­£å¸¸æ¢å¤ç›‘å¬æ‰€æœ‰çš„è¡¨ã€‚å¦‚æœå†æ¬¡åœ¨å®¢æˆ·ç«¯å¤„è°ƒç”¨å¸¦æœ‰filterå‚æ•°çš„subscribeæ–¹æ³•ï¼Œåˆ™ä¼šé‡å¤ä¸Šè¿°é—®é¢˜ã€‚ 2. ç¯å¢ƒ    æœºå™¨A canal server 1 (ç‰ˆæœ¬1.0.24)     æœºå™¨B  canal server 2 (ç‰ˆæœ¬1.0.24)    æœºå™¨C  zookeeper  é¢å¤–åœ¨é—®ä¸‹ï¼šconnector.subscribeä¸­çš„filterå†™æ³•æœ‰æ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šçš„è¦æ±‚ï¼Œåªæ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼å—è¿˜æ˜¯æœ‰ä»€ä¹ˆå…¶ä»–çš„è§„åˆ™ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ QQç¾¤åŠ ä¸è¿›å»ï¼Œæ‰€ä»¥åªæœ‰é‚®ä»¶é—®è¯¢ï¼Œå¸Œæœ›èƒ½å—åˆ°ä½ çš„å›å¤ï¼Œè°¢è°¢ å¦‚æœè¦è®¢é˜…çš„æ•°æ®åº“æ˜¯testï¼Œè¡¨æ˜¯userå’Œlog åˆ™è°ƒç”¨ connector.subscribe("test.user test.log"); LSæ­£è§£
595, 'show master status' has an error! 2018-04-02 04:12:46.303 [destination = example   address = /192.168.1.111:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just show master status 2018-04-02 04:12:46.307 [destination = example   address = /192.168.1.111:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /192.168.1.111:3306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: command : 'show master status' has an error! pls check. you need (at least one of) the SUPER REPLICATION CLIENT privilege(s) for this operation å¯ä»¥è®¾ç½®æ•°æ®åº“ç”¨æˆ·æƒé™ä¸º GRANT SELECT  SUPER  REPLICATION SLAVE  REPLICATION CLIENT  SHOW VIEW ON *.*  TO 'xxx'@'%' æˆ–GRANT ALL PRIVILEGES ON *.*  TO 'xxx'@'%' è¯•è¯• è¿™ä¸ªè®¾ç½®äº†æƒé™ä¹Ÿä¸å¥½ç”¨å•Šã€‚è¯·é—®æ˜¯å› ä¸ºç‰ˆæœ¬çš„é—®é¢˜å—? è¯·é—®è§£å†³äº†æ²¡æœ‰?@sunsetyan
594,canal ä¸€ç›´åœ¨prepare to find start position just show master status 2018-04-19 14:43:12.055 [Thread-4] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - stop successful.... 2018-04-19 14:43:17.670 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [canal.properties] 2018-04-19 14:43:17.677 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [walleter/instance.properties] 2018-04-19 14:43:17.755 [main] WARN  org.springframework.beans.TypeConverterDelegate - PropertyEditor [com.sun.beans.editors.EnumEditor] found through deprecated global PropertyEditorManager fallback - consider using a more isolated form of registration  e.g. on the BeanWrapper/BeanFactory! 2018-04-19 14:43:17.886 [main] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start CannalInstance for 1-walleter 2018-04-19 14:43:17.921 [main] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - start successful.... 2018-04-19 14:43:17.952 [destination = walleter   address = /10.45.14.188:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just show master status 2018-04-19 14:46:55.129 [Thread-4] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - stop CannalInstance for null-walleter 2018-04-19 14:46:55.134 [Thread-4] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - stop successful.... prepare to find start position just show master  status è¿™ä¸ªä¸æ˜¯å¼‚å¸¸çŠ¶æ€ ä½†æ˜¯æ•°æ®åº“postionæœ‰å˜åŒ– canalæ²¡æœ‰å˜åŒ– ä¸€ç›´æ˜¯è¿™ä¸ªåŠ¨é™ å‘è‡ªç½‘æ˜“é‚®ç®±å¤§å¸ˆ åœ¨2018å¹´04æœˆ26æ—¥ 19:36ï¼Œagapple<notifications@github.com> å†™é“ï¼š prepare to find start position just show master status è¿™ä¸ªä¸æ˜¯å¼‚å¸¸çŠ¶æ€ â€” You are receiving this because you authored the thread. Reply to this email directly  view it on GitHub  or mute the thread. @mersap  å¯èƒ½æ˜¯ä½ çš„positioné…ç½®çš„å¤ªè€äº† mysqlé‚£è¾¹å·²ç»åˆ é™¤äº†å¯¹åº”çš„binlogã€‚ å¯èƒ½æ˜¯ä¾‹å­é‡Œç»™çš„é»˜è®¤batchSizeå¤ªå¤§äº†   æ”¹å°ç‚¹å°±å¥½äº†
593,1.0.26 è¿™ä¸ªç‰ˆæœ¬bugé€ æˆçš„å—? è¯·é—®canalçš„ç‰ˆæœ¬å…¼å®¹mysql5.xæ‰€æœ‰ç‰ˆæœ¬å—?æˆ‘çš„æ˜¯5.1.73 2018-04-01 14:11:50.712 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [canal.properties] 2018-04-01 14:11:51.147 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [example/instance.properties] 2018-04-01 14:11:52.319 [main] WARN  o.s.beans.GenericTypeAwarePropertyDescriptor - Invalid JavaBean property 'connectionCharset' being accessed! Ambiguous write methods found next to actually used [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.lang.String)]: [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.nio.charset.Charset)] 2018-04-01 14:11:52.700 [main] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start CannalInstance for 1-example  2018-04-01 14:11:52.774 [main] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - start successful.... 2018-04-01 14:11:52.815 [destination = example   address = /192.168.1.110:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /192.168.1.110:3306 has an error  retrying. caused by  java.lang.NoSuchMethodError: method java.net.InetSocketAddress.getHostString with signature ()Ljava.lang.String; was not found.         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.<init>(MysqlConnector.java:53) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.<init>(MysqlConnector.java:63) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.<init>(MysqlConnection.java:70) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.buildMysqlConnection(MysqlEventParser.java:308) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.buildErosaConnection(MysqlEventParser.java:76) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:154) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at java.lang.Thread.run(libgcj.so.10) [na:na] 2018-04-01 14:11:52.960 [destination = example   address = /192.168.1.110:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.lang.NoSuchMethodError: method java.net.InetSocketAddress.getHostString with signature ()Ljava.lang.String; was not found.    at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.<init>(MysqlConnector.java:53)    at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.<init>(MysqlConnector.java:63)    at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.<init>(MysqlConnection.java:70)    at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.buildMysqlConnection(MysqlEventParser.java:308)    at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.buildErosaConnection(MysqlEventParser.java:76)    at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:154)    at java.lang.Thread.run(libgcj.so.10) ] 2018-04-01 14:11:52.965 [destination = example   address = /192.168.1.110:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - parse events has an error java.lang.NullPointerException: null         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.afterDump(MysqlEventParser.java:137) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:249) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at java.lang.Thread.run(libgcj.so.10) ~[na:na] java.lang.NoSuchMethodError: method java.net.InetSocketAddress.getHostString with signature ()Ljava.lang.String; was not found. ä½ è¿™æ˜¯å•¥jdkç‰ˆæœ¬å•Š 25ç‰ˆæœ¬ä¹Ÿæœ‰è¿™ä¸ªé—®é¢˜ã€‚jdk1.8 å¯¹åº”çš„ é…ç½®i canal.instance.dbUsername=canal canal.instance.dbPassword=canal canal.instance.defaultDatabaseName=test canal.instance.connectionCharset=UTF-8 è¿™ä¸ªæˆ‘åªèƒ½æ€€ç–‘æ˜¯jdkçš„é—®é¢˜ï¼Œä»£ç å±‚é¢oracleçš„jdk7å’Œjdk8æˆ‘æœ¬åœ°éƒ½è·‘è¿‡ æœ‰å…·ä½“çš„å¤ç°æ–¹æ³•ï¼Œå†reopenå§
592,å¼€å¯druid.ddl=trueä»¥åŠä½¿ç”¨tsdbï¼Œä¼šå‡ºç°æ”¹è¡¨ç»“æ„ä¸€ç›´æŠ¥column size is not matchçš„é—®é¢˜ æœ€è¿‘ç¢°ä¸Šä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºdruidåœ¨è§£ææˆ‘ä»¬çš„è¡¨ç»“æ„çš„æ—¶å€™æ€»æ˜¯æŠ¥é”™ï¼Œæ— æ³•é€šè¿‡ã€‚æ‰€ä»¥å…³æ‰äº†druidçš„ddlä»¥åŠcanal query ddlçš„è¯†åˆ«ã€‚å¦‚æœæ­¤æ—¶æ›´æ–°äº†ä¸šåŠ¡è¡¨çš„åˆ—ï¼Œä¾‹å¦‚å¢åŠ åˆ—ã€‚åœ¨æ–°çš„eventæ¥çš„æ—¶å€™ï¼Œä¼šå‘ç”Ÿï¼Œeventé‡Œçš„fieldsæ•°é‡å¤šï¼Œè€ŒtableMetaé‡Œçš„åˆ—æ•°å°‘ï¼Œè€ŒæŠ›å‡ºå¼‚å¸¸ã€‚ ` public TableMeta getTableMeta(String schema  String table  boolean useCache  EntryPosition position) {         TableMeta tableMeta = null;         if (tableMetaTSDB != null) {             //TODO è§‰å¾—æ­¤å¤„åº”è¯¥åŠ ä¸ŠuseCacheåˆ¤æ–­ï¼Œå¦‚æœä½¿ç”¨äº†cacheï¼Œä»ç¼“å­˜èµ°ã€‚å¦‚æœä¸ä½¿ç”¨cacheï¼Œå°±èµ°æ•°æ®åº“ç›´è¿æŸ¥è¯¢             tableMeta = tableMetaTSDB.find(schema  table);             if (tableMeta == null) {                 // å› ä¸ºæ¡ä»¶å˜åŒ–ï¼Œå¯èƒ½ç¬¬ä¸€æ¬¡çš„tableMetaæ²¡å–åˆ°ï¼Œéœ€è¦ä»dbè·å–ä¸€æ¬¡ï¼Œå¹¶è®°å½•åˆ°snapshotä¸­                 String fullName = getFullName(schema  table);                 try {                     ResultSetPacket packet = connection.query("show create table " + fullName);                     String createDDL = null;                     if (packet.getFieldValues().size() > 0) {                         createDDL = packet.getFieldValues().get(1);                     }                     // å¼ºåˆ¶è¦†ç›–æ‰å†…å­˜å€¼                     tableMetaTSDB.apply(position  schema  createDDL  "first");                     tableMeta = tableMetaTSDB.find(schema  table);                 } catch (IOException e) {                     throw new CanalParseException("fetch failed by table meta:" + fullName  e);                 }             }             return tableMeta;         } else {             if (!useCache) {                 tableMetaDB.invalidate(getFullName(schema  table));             }             return tableMetaDB.getUnchecked(getFullName(schema  table));         }     }` ä½ å…³æ‰äº†tsdbï¼Œå°±æ²¡æ³•è§£å†³è¿™ä¸ªåˆ—ä¸åŒ¹é…çš„é—®é¢˜ã€‚å¦‚æœé’ˆå¯¹DDLæ— æ³•è§£æï¼Œå»ºè®®åé¦ˆå¯¹åº”çš„DDLï¼Œæ¨åŠ¨TSDBçš„å®Œå–„ DDLçš„é”™è¯¯æ˜¯å› ä¸ºåº•å±‚çš„DruidåŒ…çš„é—®é¢˜ã€‚å› ä¸ºä¸€ç›´çº¿ä¸Šä½¿ç”¨ï¼Œæ‰€ä»¥æš‚æ—¶æ²¡æ³•ç­‰å¾…Druidæ›´æ–°ã€‚ç„¶åTSDBè¿™ä¸ªé—®é¢˜ä¸ªäººè®¤ä¸ºæ˜¯CanalåŒ…é‡Œtsdbåˆ†æ”¯çš„é€»è¾‘é—®é¢˜ã€‚æš‚æ—¶ä½¿ç”¨ä¸Šæˆ‘ä»¬åœæ­¢äº†tsdbçš„ä½¿ç”¨ã€‚è¿™æ®µæ—¶é—´æ²¡æœ‰å‘ç°æ–°çš„é—®é¢˜ã€‚ ç”¨çš„æ˜¯fastsqlï¼Œå’Œdruidä¸åŒçš„package
591,å…³äºsqltype çš„ä¸€äº›ç–‘é—® hiï¼Œ çœ‹CanalEntry.java ä¸­ SqlTypeæ˜¯å­—æ®µåœ¨javaä¸­çš„ç±»å‹ getSqlType()å‡ºæ¥çš„æ˜¯æ•°å€¼ï¼ŒæŠ±æ­‰ï¼Œæˆ‘æ²¡æœ‰æ‰¾åˆ°æ•°å€¼å¯¹åº”çš„javaç±»å‹ï¼Œå¯ä»¥åœ¨é‚£é‡ŒæŸ¥åˆ°å—ï¼Ÿ thx æ‰¾åˆ°äº† > æ‰¾åˆ°äº† åœ¨å“ªï¼Ÿ
590,Fix issue #586 event sizeä¸å‡†ç¡®çš„é—®é¢˜ calculateSizeç”±binlogäº‹ä»¶å¤§å°æ”¹ä¸ºè¿”å›serializedSizeï¼Œå†…å­˜å¤§å°æ›´å‡†ç¡®å¯æ§ [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=590) <br/>All committers have signed the CLA. è¿™ä¸ªgetSerializedSizeçš„æ–¹æ³•å®ç°åŸç†æ˜¯éå†æ‰€æœ‰çš„æ•°æ®è¿›è¡Œå¤§å°è®¡ç®—ï¼Œæ˜¯æœ‰ä¸€äº›æˆæœ¬ å·²ç»æœ‰æ–°çš„æ–¹æ¡ˆäº†  è·å–äº†åºåˆ—åŒ–ä¹‹åçš„é•¿åº¦
589,å…³äºEventTransactionBufferä¸MemoryEventStoreWithBufferçš„ä¸€äº›ç–‘é—® # æˆ‘ç°åœ¨çš„ç†è§£ ## EventTransactionBuffer sinkå°†eventåˆ†å‘ç»™EventTransactionBufferï¼Œå¦‚æœæ”¶é›†åˆ°ä¸€ä¸ªå®Œæ•´çš„transactionï¼Œæˆ–è€…è¾¾åˆ°äº†bufferçš„sizeä¸Šé™å°±ä¼šè§¦å‘flushï¼Œå°†ç¼“å­˜æ•°æ®é€šè¿‡callbackç»è¿‡filterç­‰æ“ä½œä»¥åå‘é€åˆ°MemoryEventStoreWithBuffer. ## MemoryEventStoreWithBuffer æ¥æ”¶åˆ°ä¸€ä¸ªList<Event>ï¼ˆåº”è¯¥å°±æ˜¯åˆšåˆšå‘è¿‡æ¥çš„listäº‹åŠ¡ï¼‰ï¼Œæ£€æŸ¥å¦‚æœç©ºä½ç©ºé—´è¶³å¤Ÿï¼Œå°±éå†listä¸­çš„æ•°æ®ï¼Œé€æ¡åŠ å…¥entriesä¸­ã€‚ æ¯ä¸€æ¬¡getæ•°æ®çš„æ—¶å€™ï¼Œæ˜¯æ ¹æ®ä¼ å…¥çš„batchSizeæ¥æ‹¿çš„ï¼Œæ‹¿å®Œä»¥åä¼šè®¡ç®—æ¶ˆæ¯çš„PositionRangeï¼ˆè¿™æ¬¡getçš„å¤´å°¾LogPositionï¼‰ï¼Œä¼šsetå¯è¢«ackçš„ç‚¹ä¸ºè¿™æ®µæ¶ˆæ¯ä¸­çš„æœ€åä¸€ä¸ªTRANSACTIONBEGINæˆ–è€…TRANSACTIONENDã€‚è¿™ä¸ªackä¼šåœ¨å…ƒæ•°æ®ç®¡ç†updateCursoræ—¶ä¼ è¿›å»ï¼Œä¸ºäº†è®©cursorä¸­æ€»æ˜¯è®°å½•çš„äº‹åŠ¡çš„å¼€å§‹æˆ–è€…ç»“æŸã€‚ # æˆ‘çš„ç–‘é—® ç°åœ¨æˆ‘ä»¬åœ¨å¼€å‘çš„ä¸œè¥¿ï¼Œæ˜¯å¸Œæœ›ä»¥Transactionæ¥ä½œä¸ºå•ä½æ¥å°†æ¶ˆæ¯å‘ç»™ä¸‹æ¸¸çš„ï¼ˆå¦‚æœè¿‡å¤§çš„transactionä¼šåˆ†å‰²æˆå¤šä¸ªtransactionåŒ…ï¼Œé‡Œé¢è®°å½•ä¸€ä¸ªå¸ƒå°”å€¼è¡¨ç¤ºæ˜¯å¦æ˜¯äº‹åŠ¡ç»“æŸåŒ…ï¼‰ï¼Œç°åœ¨ä¸»è¦çŸ›ç›¾æ˜¯MemoryEventStoreWithBufferé‡Œé¢å­˜å‚¨çš„ç²’åº¦æ˜¯entryï¼Œæ‰€ä»¥æ ¹æ®batchSIzeæ¥æ‹¿çš„è¯æ‹¿å‡ºå»å¯èƒ½åŒä¸ªäº‹åŠ¡ä¸­æ•°æ®æ˜¯ä¼šè¢«åˆ†2æ¬¡æ‹¿åˆ°çš„ã€‚ å¦‚æœæ˜¯ä»MemoryEventStoreWithBufferæ‹¿å‡ºæ•°æ®ä¹‹åï¼Œå†åµŒå¥—ä¸€ä¸ªç±»ä¼¼EventTransactionBufferçš„ç¼“å­˜ï¼Œ ackçš„æ—¶å€™ä¹Ÿè¿˜è¦ä¿ç•™åŸæ¥çš„batchIdæ¥ackã€‚ ç›®å‰è§‰å¾—å¯ä»¥å»å®ç°ä¸€ä¸ªè‡ªå·±çš„MemoryTransactionStoreWithBufferï¼Œé‡Œé¢çš„ç¼“å­˜çš„ç²’åº¦ç”¨transactionåŒ…ï¼Œè¿™æ ·æ¯æ¬¡getå‡ºæ¥éƒ½æ˜¯ä»¥transactionåŒ…ä¸ºå•ä½çš„å½¢å¼ï¼Œä¹‹åå¯ä»¥ç»§æ‰¿CanalInstanceWithManagerè¦†ç›–é‡Œé¢çš„initEventStoreæ–¹æ³•ï¼Œå°†MemoryEventStoreWithBufferæ›¿æ¢ä¸ºè‡ªå·±å®ç°çš„MemoryTransactionStoreWithBufferã€‚ æƒ³è¯·æ•™ä¸€ä¸‹å½“æ—¶canalè®¾è®¡çš„è€ƒè™‘ï¼Œä»¥åæœ‰æ²¡æœ‰è€ƒè™‘æä¾›æŒ‰transactionåŒ…ä¸ºå•ä½çš„putï¼Œgetï¼Œackã€‚ç„¶åæˆ‘ç›®å‰çš„æƒ³æ³•æ˜¯ä¸æ˜¯åˆç†ï¼Œä¸çŸ¥é“æˆ‘ä¸Šé¢çš„è¡¨è¿°æ˜¯ä¸æ˜¯å¤Ÿæ¸…æ¥šï¼Œæœ›å›å¤ã€‚ è¦è€ƒè™‘å¤§äº‹åŠ¡çš„æƒ…å†µï¼Œä¸€èˆ¬æˆ‘ä»¬å†…éƒ¨ä¸å»ºè®®è¿™ä¹ˆç©ã€‚å¾ˆå¤šå·¥ä½œä½ å¯ä»¥åœ¨clientå±‚é¢æ¥æ”¯æŒï¼Œæ¯”å¦‚clientå±‚é¢æœ¬èº«æ”¯æŒå¼‚æ­¥ackä¹‹åï¼Œä½ å¯ä»¥è‡ªå·±æä¸€ä¸ªbufferï¼Œå‡‘è¶³ä¸€ä¸ªäº‹åŠ¡åå›è°ƒä¸šåŠ¡ æ„Ÿè°¢å»ºè®®å“ˆï¼Œclientå±‚é¢æ˜¯å¯ä»¥åšè¿™ä¸ªã€‚ä½†æ˜¯æˆ‘è¿˜æœ‰äº›è€ƒè™‘ï¼š ç›®å‰æˆ‘ä»¬å…¶å®ç”¨äº†å†…åµŒcanal+ä¸€ä¸ªæ¶ˆæ¯ä¸­é—´ä»¶æ¥æä¾›ä¸‹æ¸¸æ•°æ®è®¢é˜…ã€‚ç°åœ¨æ˜¯æƒ³è¦å¾€æ¶ˆæ¯ä¸­é—´ä»¶ä¸­å‘äº‹åŠ¡ç²’åº¦çš„æ¶ˆæ¯ï¼ˆä¸šåŠ¡ä¸­å‡ ä¹éƒ½æ˜¯å°äº‹åŠ¡ï¼‰ã€‚å¦‚æœåœ¨canal clientå±‚getWithoutAckæ–¹æ³•æ‹¿å‡ºbatchSizeæ•°æ®ï¼Œç„¶åæ”¾å…¥ä¸€ä¸ªbufferï¼Œè¿™æ ·æ„Ÿè§‰ä»£ç ç»“æ„ä¸Šåˆå¤šäº†ä¸€å±‚ï¼Œåœ¨batchSizeä¸ªæ•°æ®ä¸­åŒ…å«å¤šä¸ªäº‹åŠ¡çš„æƒ…å†µä¸‹ï¼Œè¦åè°ƒæ ¹æ®äº‹åŠ¡å‘é€æ¶ˆæ¯ç»™mqï¼Œä»¥åŠæ¶ˆè´¹å®Œä¸€ä¸ªbatchSizeæ•°æ®ä»¥åæ ¹æ®MessageIdå»ack canalã€‚ï¼ˆå› ä¸ºè¿™ç§æƒ…å†µä¸‹çš„å‘é€ç»™mqçš„Trasactionä¸ä»canalæ‹‰å‡ºæ¥çš„MessageIdæ²¡æœ‰ä»€ä¹ˆè”ç³»ã€‚å¦‚æœæ˜¯serveré‡Œé¢ä¿è¯äº†getå‡ºæ¥çš„ä¸€ä¸ªMessageå°±æ˜¯ä¸€ä¸ªäº‹ç‰©åŒ…ï¼Œé‚£å°±ç›´æ¥å‘é€å®Œèµ°acké€»è¾‘å°±å¯ä»¥äº†ï¼‰ å¦‚æœè€ƒè™‘serverå±‚é¢æŒ‰ä¸‹é¢çš„åšæ³•æ˜¯ä¸æ˜¯èƒ½é¿å…å¤§äº‹åŠ¡çš„å½±å“å‘¢ï¼š è€ƒè™‘flushå‡ºä¸€ä¸ªäº‹ç‰©åŒ…ï¼ŒåŒ…é‡ŒåŠ ä¸€ä¸ªæ ‡è®°ä½ã€‚å¦‚æœå°äº‹åŠ¡å°±å•ç‹¬çš„äº‹ç‰©åŒ…ï¼Œæ ‡è®°ä½è¡¨ç¤ºæ²¡æœ‰åç»­åŒ…ï¼›å¤§äº‹åŠ¡å°±ä¼šå› ä¸ºbufferæ»¡ä»¥ååˆ‡æˆå¤šä¸ªï¼Œé™¤äº†æœ€åä¸€ä¸ªéƒ½æ ‡è®°ä¸ºæœ‰åç»­åŒ…ã€‚è¿™æ ·å­åšçš„è¯åº”è¯¥ä¹Ÿèƒ½å¤„ç†å¤§äº‹åŠ¡çš„é—®é¢˜å§ã€‚ æˆ‘è¿™æ ·çš„éœ€æ±‚ï¼Œæ˜¯ä¸æ˜¯å®ç°åœ¨serverç«¯æ¯”è¾ƒå¥½å‘¢ï¼Œå†™å®Œä»¥åçš„æ„Ÿè§‰æ˜¯getWithoutAckæ‹¿å‡ºæ¥çš„æ•°æ®æ˜¯ä»¥äº‹ç‰©åŒ…ä¸ºå•å…ƒçš„ï¼ˆå¤§äº‹åŠ¡ä¼šæ˜¯å¤šä¸ªäº‹ç‰©åŒ…ï¼ˆå°‘æ•°æƒ…å†µï¼‰ï¼‰ã€‚ å¦‚æœæ˜¯æ‰“æ ‡çš„æ–¹å¼ï¼Œæ˜¯å»ºè®®åœ¨serverä¸Šæ“ä½œ å¥½çš„ï¼Œæ„Ÿè°¢å›å¤ï¼Œè¾›è‹¦ï¼ å¦‚æœé’ˆå¯¹ä¸€ä¸ªå¤§è¡¨çš„ä¸€ä¸ªå¤§äº‹ç‰©åŒ…å«äº†å¤ªå¤šæ•°æ®ï¼Œå¾ˆå®¹æ˜“å¼•å‘OOMé—®é¢˜ï¼Œä¹‹å‰é¡¹ç›®é‡Œé”™è¯¯è®¾ç½®äº†batchSizeï¼ˆ5*1024ï¼‰ï¼Œç»“æœclientç»å¸¸å¼‚å¸¸ä¸­æ­¢ã€‚è¿™ä¸æ˜¯å°‘è§çš„æƒ…å†µï¼Œç³Ÿç³•çš„å†å²ç³»ç»Ÿï¼Œç»å¸¸ä¸€ä¸ªäº‹ç‰©ä¿®æ”¹æˆåƒä¸Šä¸‡æ¡æ•°æ®ï¼Œç”šè‡³æ¥ä¸ªæ¸…ç©ºè¡¨ï¼Œè¡¨æœ¬èº«æ•°æ®é‡è¿˜ä¸å° @shang7053 å—¯å—¯ï¼Œä¼šæœ‰è®¾ç½®ä¸Šé™ï¼Œé’ˆå¯¹å¤§çš„äº‹åŠ¡ä¼šæˆªæ–­å¤šæ¬¡flushçš„ çœ‹äº†ä½ çš„æè¿°ï¼Œåˆç»“åˆæºç çœ‹äº†ä¸‹ 1ã€æœåŠ¡å™¨ç«¯çš„canal.instance.transactionn.sizeè¿™ä¸ªå‚æ•°çš„é…ç½®å’Œclientç«¯çš„batchSizeçš„è®¾ç½®æ˜¯ä¸æ˜¯åº”è¯¥è®¾ç½®çš„ä¸€æ ·ä¼šæ¯”è¾ƒåˆç†äº›ï¼Ÿ 2ã€å¦‚æœä¸€ä¸ªå®Œæ•´äº‹åŠ¡æ•°æ®çš„é•¿åº¦è¶…è¿‡äº†å®¢æˆ·ç«¯è®¾ç½®çš„è¿™ä¸ªbatchSizeï¼Œæ¯”å¦‚ä¸€ä¸ªäº‹åŠ¡çš„å®é™…é•¿åº¦æ˜¯1.5å€ä¸ªbatchSizeï¼Œç¬¬ä¸€æ¬¡getè·å–ä¸€ä¸ªbatchSizeçš„æ•°æ®ï¼Œå†æ¬¡getæ—¶ï¼Œæ˜¯ä¸æ˜¯åªä¼šç»™æˆ‘è¿”å‰©ä¸‹çš„0.5å€çš„æ•°æ®ï¼Ÿä¼šä¸ä¼šæŠŠä¸‹ä¸€ä¸ªäº‹åŠ¡çš„æ•°æ®ä¹Ÿè¿”å›ç»™æˆ‘ï¼Ÿ @zwangbo  @jingshenbusi6530 ç›®å‰Canalä¸­å®ç°çš„æ¶ˆæ¯è·å–æ˜¯ä»¥Entryï¼ˆEventï¼‰ä¸ºç²’åº¦çš„ï¼ˆåœ¨MemoryEventStoreWithBufferä¸­ï¼‰ï¼Œæ‰€ä»¥batchSizeåªæ˜¯é’ˆå¯¹çš„æ‹¿å¤šå°‘ä¸ªEntryï¼Œä¸ä¼šé’ˆå¯¹äº‹åŠ¡åšæˆªæ–­è¿”å›ã€‚ æ‰€ä»¥æ„Ÿè§‰ï¼š 1. è¿™ä¸¤ä¸ªé…ç½®æ²¡æœ‰å¿…ç„¶çš„è”ç³»ï¼ŒbatchSizeä¸»è¦çœ‹è‡ªå·±è¿™è¾¹çš„æ¶ˆè´¹æ•ˆç‡è°ƒæ•´å°±å¥½äº†ã€‚ 2. åªè¦buffä¸­å‚¨å­˜äº†è¶³å¤Ÿå¤šçš„æ•°æ®ï¼Œæ¯æ¬¡ä¸€getéƒ½èƒ½æ‹¿åˆ°batchSizeä¸ªEventï¼Œä¸ä¼šå› ä¸ºäº‹åŠ¡æˆªæ–­ã€‚ï¼ˆä½†æ˜¯äº‹åŠ¡å¤´å°¾è¿›å…¥MemoryEventStoreWithBufferæ—¶ï¼Œä¼šè¢«è®¾ç½®ä¸ºå¯è¢«ackçš„ä½ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´ackä¸€ä¸ªMessageIdçš„æ—¶å€™æ€»æ˜¯ä¼šé€‰æ‹©ä¸€ä¸ªBatchSizeç»„ä¸­äº‹åŠ¡å¤´å°¾çš„positionï¼‰ LSç†è§£æ­£ç¡®
588, Could not find artifact com.alibaba.fastsql:fastsql:jar:2.0.0_preview_159 åˆå§‹åŒ–å·¥ç¨‹çš„æ—¶å€™ï¼Œå‡ºç°: Caused by: org.eclipse.aether.resolution.DependencyResolutionException: Could not find artifact com.alibaba.fastsql:fastsql:jar:2.0.0_preview_159 in central  ç›®å‰äºŒè¿›åˆ¶å‘å¸ƒåŒ…é‡Œæœ‰åŒ…å« @agapple äºŒè¿›åˆ¶æ–‡ä»¶åœ¨å“ªé‡Œã€‚æœ€æ–°çš„228ï¼Œ386æ²¡æœ‰çœ‹åˆ° https://github.com/alibaba/canal/releases/tag/canal-1.0.26-preview-3ï¼Œè¿™é‡Œæœ‰äºŒè¿›åˆ¶çš„åŒ…
587,è¿™ä¸ªé¡¹ç›®èƒ½æ‰“åŒ…æˆä¸€ä¸ªjarå— è¿™ä¸ªé¡¹ç›®èƒ½æ‰“åŒ…æˆä¸€ä¸ªjarå—ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªtarçš„æ–‡ä»¶ï¼Œé¡¹ç›®é‡Œé¢å¾ˆå¤šmainæ–‡ä»¶ï¼Œåˆ°åº•ç”¨çš„æ˜¯å“ªä¸€ä¸ªæ–‡ä»¶å¯åŠ¨çš„ çœ‹ä¸€ä¸‹wikié‡Œçš„quickStart
586,MemoryEventStoreWithBuffer event sizeä¸å‡†ç¡® MemoryEventStoreWithBuffer `    private long calculateSize(Event event) {         // ç›´æ¥è¿”å›binlogä¸­çš„äº‹ä»¶å¤§å°         return event.getEntry().getHeader().getEventLength();     }` binlogäº‹ä»¶ç»è¿‡Canalè§£æï¼Œå®é™…å†…å­˜å ç”¨æ˜¯event_lengthçš„åå€ä»¥ä¸Šï¼Œè¿™æ ·bufferSize * bufferMemUnitç®—å‡ºçš„å®ä¾‹å†…å­˜å ç”¨å°±ä¸å‡†ç¡®äº†ï¼Œæ˜¯ä¸æ˜¯è€ƒè™‘æ”¹æˆevent.getEntry().getSerializedSize(); æµ‹è¯•ç»“æœï¼š calculateSize 179ï¼ŒSerializedSize 1790 calculateSize 8291ï¼Œ ï¼ŒSerializedSize 155000 æ˜¯æœ‰è¿™ä¹ˆä¸€ä¸ªé—®é¢˜ï¼Œæ‹¿çš„æ˜¯binlogé‡Œçš„å¤§å°ï¼Œå±•å¼€ä¹‹åä¼šè¡¥å……å­—æ®µï¼Œç±»å‹ç­‰ä¿¡æ¯ï¼Œä¼šæ¯”ä¹‹å‰è¦è†¨èƒ€å¾ˆå¤š æ–°çš„1.0.26ç‰ˆæœ¬å·²ç»æŒ‰ç…§åºåˆ—åŒ–å¤§å°è¿›è¡Œè®¡ç®—äº†
585,RowsQueryEventä¸æ”¯æŒå¯¹è¡¨åçš„é»‘ç™½åå•filter.regexå’Œfilter.black.regexè¿‡æ»¤å‘¢ æ˜¯æ€ä¹ˆè€ƒè™‘çš„ï¼Œçœ‹æºç LogEventConverté‡Œé¢å¯¹ROWS_QUERY_LOG_EVENTã€ANNOTATE_ROWS_EVENTéƒ½æ²¡è¿‡æ»¤è¡¨åã€‚  å¦å¤– å¦å¤–å¯¹äºæ–‡æ¡£ä¸­çš„canal.instance.filter.query.dmlå±æ€§çš„æè¿°ï¼š > æ˜¯å¦å¿½ç•¥DMLçš„queryè¯­å¥ï¼Œæ¯”å¦‚insert/update/delete table.(mysql5.6çš„ROWæ¨¡å¼å¯ä»¥åŒ…å«statementæ¨¡å¼çš„queryè®°å½•) æœ‰ç‚¹çœ‹ä¸æ‡‚ï¼Œè®¾ç½®ä¸ºtrueä¹‹åDMLé‡Œæ’é™¤selectï¼Œè¿˜æ˜¯æ’é™¤insert/update/delete tableï¼Ÿå¦‚æœæˆ‘ä½¿ç”¨canalæ˜¯æƒ³åŒæ­¥æ•°æ®åˆ°å¦ä¸€ä¸ªå­˜å‚¨ä»‹è´¨ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥è®¾ç½®æˆtrueï¼Ÿ RowsQueryLogEventï¼Œåªèƒ½è·å–åˆ°tableNameï¼Œæ— æ³•è·å–åº“åï¼Œè¡¨è¾¾å¼è¿‡æ»¤çš„æ—¶å€™æ— æ³•ç²¾ç¡®åŒ¹é…
584,1.0.19ç‰ˆæœ¬ï¼Œcanal.instance.filter.query.dcl\dml è¿‡æ»¤å¤±æ•ˆ 1.0.19ç‰ˆæœ¬ï¼Œcanal.instance.filter.query.dcl\dml è¿‡æ»¤å¤±æ•ˆï¼Œä»ç„¶ä¼šæ‰“å°update\delete\insertç­‰æ—¥å¿— ä½ è®¾ç½®æˆtrueè¿˜æ˜¯falseï¼Ÿ
583,å…³äºæ•°æ®åº“ç‰ˆæœ¬ï¼Œ5.7.18çš„å’¨è¯¢ï¼Ÿ ç›®å‰æˆ‘ä»¬çš„æ•°æ®åº“æ˜¯5.7.18ï¼Œä½†æ˜¯åœ¨ä½ ä»¬çš„æ–‡æ¡£ä¸­è¯´æ˜¯æ”¯æŒ5.7ï¼Œæ‹¬å·ä¸­åˆç‰¹åˆ«æ³¨æ˜äº†æ˜¯5.7.13ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯æ„å‘³ç€ä»…æµ‹è¯•äº†5.7.13ï¼Ÿå¯¹äº18ç‰ˆæœ¬æœ‰ä»€ä¹ˆå½±å“å—ï¼Ÿ 18ç‰ˆæœ¬æ²¡æœ‰åšè¿‡æµ‹è¯•ï¼Œä½ å¯ä»¥åšä¸€ä¸‹è¯„æµ‹ï¼Œä¸€èˆ¬å°ç‰ˆæœ¬ä¸å¤ªä¼šæœ‰binlogå˜åŒ– å¥½çš„ï¼Œæˆ‘ä»¬åœ¨æ­£å¼ç¯å¢ƒä¸­è¿˜æ²¡æœ‰é‡åˆ°å°ç‰ˆæœ¬é—®é¢˜ï¼Œçœ‹äº†çœ‹change logï¼Œå¥½åƒä¹Ÿæ²¡æœ‰ç‰¹åˆ«æŒ‡æ˜binlogçš„å˜åŒ–ã€‚
582,canalå’Œmycat canalå¯ä»¥æ­é…mycatä½¿ç”¨å— åªèƒ½ç›´è¿ä¸€ä¸ªç‰©ç†MySQL mycatåªæ˜¯ä¸€ä¸ªsqlè·¯ç”±ï¼Œä»–æ— æ³•äº§ç”Ÿbinlogæ—¥å¿—ï¼Œcanalä¹Ÿå·§å¦‡éš¾ä¸ºæ— ç±³ä¹‹ç‚Š
581,HAæ¨¡å¼ï¼Œæ­£å¸¸å…³é—­ä¸€ä¸ªserverèŠ‚ç‚¹ï¼Œzookeeperåˆ‡æ¢èŠ‚ç‚¹ä¹‹åï¼Œclientæ¶ˆè´¹ä¸åˆ°æ•°æ® æˆ‘å…ˆå¯åŠ¨äº†ä¸¤ä¸ªserveræ³¨å†Œè‡³zookeeperï¼Œ clientè¿æ¥zookeeperï¼Œé€‰æ‹©äº†ä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œè®¢é˜…ã€‚ å½“æˆ‘å…³é—­æ­£åœ¨è¢«è®¢é˜…çš„serverèŠ‚ç‚¹ä¹‹åï¼Œ zookeeperè¿›è¡Œäº†èŠ‚ç‚¹åˆ‡æ¢ï¼Œåˆ‡æ¢è‡³äº†å¦ä¸€ä¸ªèŠ‚ç‚¹ã€‚ ä½†æ˜¯clientæŠ¥é”™ 16:13:46.186 [main] WARN  c.a.o.c.c.impl.ClusterCanalConnector - something goes wrong when getWithoutAck data from server:/192.168.1.158:11111 com.alibaba.otter.canal.protocol.exception.CanalClientException: java.io.IOException: end of stream when reading header 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:224) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:207) 	at com.alibaba.otter.canal.client.impl.ClusterCanalConnector.getWithoutAck(ClusterCanalConnector.java:165) 	at ClientSample.start(ClientSample.java:43) 	at ClientSample.main(ClientSample.java:116) Caused by: java.io.IOException: end of stream when reading header 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.read(SimpleCanalConnector.java:307) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.readNextPacket(SimpleCanalConnector.java:295) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.receiveMessages(SimpleCanalConnector.java:229) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:222) 	... 4 more ç„¶åè®¢é˜…ä¸åˆ°æ•°æ®ï¼Œåªæ˜¯ä¸åœçš„æ‰“å° 16:19:29.846 [main-SendThread(192.168.0.81:2181)] DEBUG org.apache.zookeeper.ClientCnxn - Got ping response for sessionid: 0x161835c99bb1978 after 3ms åˆ‡æ¢è‡³çš„æ–°serveræ—¥å¿— 2018-04-10 15:40:09.114 [pool-2-thread-1] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [canal.properties] 2018-04-10 15:40:09.118 [pool-2-thread-1] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [gjj/instance.properties] 2018-04-10 15:40:09.284 [pool-2-thread-1] WARN  o.s.beans.GenericTypeAwarePropertyDescriptor - Invalid JavaBean property 'connectionCharset' being accessed! Ambiguous write methods found next to actually used [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.nio.charset.Charset)]: [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.lang.String)] 2018-04-10 15:40:09.381 [pool-2-thread-1] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [canal.properties] 2018-04-10 15:40:09.387 [pool-2-thread-1] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [gjj/instance.properties] 2018-04-10 15:40:09.496 [New I/O server worker #1-1] ERROR com.alibaba.otter.canal.server.netty.NettyUtils - ErrotCode:400   Caused by :  something goes wrong with channel:[id: 0x6cf56c87  /192.168.43.133:54479 => /192.168.1.158:11111]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: destination:gjj should start first 2018-04-10 15:40:09.501 [New I/O server worker #1-1] ERROR com.alibaba.otter.canal.server.netty.NettyUtils - ErrotCode:400   Caused by :  something goes wrong with channel:[id: 0x6cf56c87  /192.168.43.133:54479 :> /192.168.1.158:11111]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: destination:gjj should start first 2018-04-10 15:40:09.509 [New I/O server worker #1-1] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x6cf56c87  /192.168.43.133:54479 :> /192.168.1.158:11111]  exception=java.nio.channels.ClosedChannelException 	at org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:649) 	at org.jboss.netty.channel.socket.nio.NioWorker.writeFromUserCode(NioWorker.java:370) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:137) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76) 	at org.jboss.netty.channel.Channels.write(Channels.java:611) 	at org.jboss.netty.channel.Channels.write(Channels.java:578) 	at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:30) 	at com.alibaba.otter.canal.server.netty.NettyUtils.error(NettyUtils.java:51) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:200) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.cleanup(ReplayingDecoder.java:542) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.channelDisconnected(ReplayingDecoder.java:450) 	at org.jboss.netty.channel.Channels.fireChannelDisconnected(Channels.java:360) 	at org.jboss.netty.channel.socket.nio.NioWorker.close(NioWorker.java:599) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:119) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76) 	at org.jboss.netty.channel.Channels.close(Channels.java:720) 	at org.jboss.netty.channel.AbstractChannel.close(AbstractChannel.java:208) 	at org.jboss.netty.channel.ChannelFutureListener$1.operationComplete(ChannelFutureListener.java:46) 	at org.jboss.netty.channel.DefaultChannelFuture.notifyListener(DefaultChannelFuture.java:381) 	at org.jboss.netty.channel.DefaultChannelFuture.addListener(DefaultChannelFuture.java:148) 	at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:30) 	at com.alibaba.otter.canal.server.netty.NettyUtils.error(NettyUtils.java:51) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:200) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:444) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:350) 	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:281) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:201) 	at org.jboss.netty.util.internal.IoWorkerRunnable.run(IoWorkerRunnable.java:46) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) 	at java.lang.Thread.run(Thread.java:745) 2018-04-10 15:40:09.649 [pool-2-thread-1] ERROR com.alibaba.druid.pool.DruidDataSource - testWhileIdle is true  validationQuery not set 2018-04-10 15:40:10.337 [pool-2-thread-1] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start CannalInstance for 1-gjj  2018-04-10 15:40:10.392 [pool-2-thread-1] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - subscribe filter change to bshousingfund.bsh_data_log 2018-04-10 15:40:10.392 [pool-2-thread-1] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - start successful.... 2018-04-10 15:40:11.537 [destination = gjj   address = /192.168.0.72:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position  {"identity":{"slaveId":-1 "sourceAddress":{"address":"192.168.0.72" "port":3306}} "postion":{"included":false "journalName":"mysql-bin.000017" "position":864668422 "serverId":2821031644 "timestamp":1523346001000}} 2018-04-10 15:41:13.152 [New I/O server worker #1-3] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - subscribe filter change to bshousingfund.bsh_data_log 2018-04-10 16:07:49.172 [New I/O server worker #1-4] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - subscribe filter change to bshousingfund.bsh_data_log æˆ‘çœ‹æœ€åæ˜¯èµ·æ¥äº†å•Šï¼Œåˆ‡æ¢åˆ°äº†æ–°serverä¸Š serveræ˜¯åˆ‡æ¢è¿‡å»äº†ï¼Œä½†æ˜¯clientæ¶ˆè´¹ä¸èƒ½æ­£å¸¸æ¶ˆè´¹äº† @CXninesuns é‡åˆ°åŒæ ·çš„é—®é¢˜ã€‚zkä¸Šçœ‹runningçš„instanceå·²ç»åˆ‡æ¢åœ°å€ï¼Œä½†zkä¸Šçš„èŠ‚ç‚¹è¿˜æ˜¯æ—§çš„åœ°å€ã€‚è¿™æ ·clientç¡®å®ä¸èƒ½ç»§ç»­æ¶ˆè´¹æ•°æ®ã€‚æˆ‘ä½¿ç”¨çš„æ˜¯canal_1.0.20å‡ºç°äº†è¿™ä¸ªé—®é¢˜ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦å·²ç»è§£å†³äº†è¯¥é—®é¢˜ã€‚ å»ºè®®éƒ½ç”¨26-alphaç‰ˆæœ¬è¯•è¯•ï¼Œå°è±¡ä¸­é«˜å¯ç”¨åˆ‡æ¢ä¿®å¤è¿‡å‡ ä¸ªé—®é¢˜
580,æ— æ³•è¿æ¥canalæœåŠ¡ç«¯ ä½¿ç”¨ä¸‹é¢æ–¹æ³•åˆ›å»ºcanalè¿æ¥ `CanalConnector canalConnector = CanalConnectors.newSingleConnector(new InetSocketAddress(canalHost Integer.parseInt(canalPort)) canalDestination "" ""); canalConnector.connect();` ä½†æ˜¯è°ƒç”¨connect()æ–¹æ³•æ—¶æŠ¥é”™ã€‚æŠ¥é”™å¦‚ä¸‹ï¼š ` Caused by: com.alibaba.otter.canal.protocol.exception.CanalClientException: java.net.ConnectException: Connection timed out: connect 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.doConnect(SimpleCanalConnector.java:178) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.connect(SimpleCanalConnector.java:102)` è¯·é—®æ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿä¹‹å‰ä¸€ç›´è¿˜å¥½å¥½çš„ã€‚ä»ä»Šå¤©å¼€å§‹çªç„¶æŠ¥è¿™ä¸ªé”™äº†ã€‚ä½¿ç”¨çš„canalç‰ˆæœ¬ä¸ºcanal.deployer-1.0.25 æ‰¾åˆ°åŸå› äº†ï¼Œæ˜¯canalæœåŠ¡ç«¯æ‰€åœ¨æœåŠ¡å™¨çš„é˜²ç«å¢™æ‹¦æˆªäº†11111ç«¯å£ã€‚å¼€æ”¾æ­¤ç«¯å£å°±å¥½äº†ã€‚
579,canal server å–ä¸åˆ°RDS  binlog? æƒ…å†µæ˜¯è¿™æ ·çš„ï¼Œæˆ‘ä»¬mysql æ˜¯é˜¿é‡Œäº‘çš„rdsï¼Œcanal serverå¯åŠ¨åï¼Œcanal clientä¹Ÿå¯åŠ¨ï¼Œç„¶åå¾€mysqlæ•°æ®åº“å¹¶å‘å†™æ•°æ®ï¼Œåˆšå¼€å§‹æ˜¯å¯ä»¥çœ‹åˆ°clientæœ‰æ¥åˆ°æ•°æ®å¹¶è§£æåˆ°hbaseçš„å¹¶ä¸”æ•°æ®æ²¡æœ‰ä¸¢å¤±ã€‚ç„¶åè¿‡æ®µæ—¶é—´å†å¹¶å‘å†™æ•°æ®ï¼Œclientå°±æ¥ä¸åˆ°æ•°æ®äº†ã€‚ã€‚ã€‚ã€‚å½“æˆ‘é‡å¯canal serveråï¼Œå°±çœ‹åˆ°clientå¯ä»¥æ¥åˆ°æ•°æ®å¹¶è§£æäº†ã€‚ éƒ¨ç½²çš„otterï¼Œä¹Ÿå‡ºç°äº†è¿è¡Œä¸€æ®µæ—¶é—´(å‡ å¤©æˆ–è€…ä¸€ä¸ªæœˆ)åï¼Œä¸èƒ½ä»canalæ¥åˆ°æ•°æ®ï¼Œå¯¼è‡´otterä¸Šçš„åŒæ­¥é€šé“åœæ­¢ï¼Ÿ @songpengpeng ä½ é…ç½®äº†å¤šä¸ªdestinationå—?destination æ¯ä¸ªdestinationä¸­çš„serveidæ˜¯ä¸€æ ·çš„å—ï¼Ÿ @mjjian0 ä½ ç”¨çš„æ˜¯å•¥ç‰ˆæœ¬ï¼Ÿå»ºè®®æ˜¯ç”¨1.0.24+ä»¥ä¸Šçš„ @agapple  æˆ‘ç”¨çš„æ˜¯ 1.0.25çš„ç‰ˆæœ¬ @agapple è¿™ç§æƒ…å†µä¸‹çš„  meta.dat  é‡Œé¢å†…å®¹æ²¡æœ‰cursorå’Œpostionçš„ä¿¡æ¯ã€‚ å‡ ä¸ªdestinationç›®å½•ä¸­ meta.dat   clientIdæ˜¯ä¸€æ ·çš„è¿™ä¸ªæœ‰å…³ç³»å—ï¼Ÿ @agapple å¤šä¸ªinstance é…ç½®çš„æ—¶å€™  canal.instance.rds.instanceIdå‚æ•°éœ€è¦é…ç½®å—ï¼Œä¿è¯å”¯ä¸€ï¼Ÿï¼Ÿ ä½ çœ‹åˆ°çš„æ˜¯rds localbinlogè§£æçš„é…ç½®æ–‡ä»¶å§ï¼Œä¸æ˜¯ç›´è¿binlog @agapple   æ˜¯ rds_instance.properties è¿™ä¸ªä¸æ˜¯ è§£ærdsçš„åº“çš„é…ç½®å— rds_instanceåªæ˜¯æ‹‰å–rdsä¸Šçš„oss binlogï¼Œä¸ä½œä¸ºè§£æç”¨ @agapple å—¯ï¼Œæˆ‘ä»¬mysqlæ˜¯é˜¿é‡Œäº‘ rdsï¼Œç„¶åé…ç½®æ–‡ä»¶æˆ‘å°±ä½¿ç”¨çš„è¿™ä¸ªã€‚ å‚è€ƒFAQï¼š https://github.com/alibaba/canal/wiki/FAQ
578,æ±‚é—®1.0.26çš„ç¨³å®šç‰ˆä»€ä¹ˆæ—¶å€™å‘å¸ƒï¼Ÿè°¢è°¢~ å¦‚å›¾ï¼Œæ±‚é—®ï¼Œè°¢è°¢ ç›®å‰è¿˜æœ‰1ï¼Œ2ä¸ªå·²çŸ¥bugï¼Œéœ€è¦è¿›è¡Œä¿®å¤ è°¢è°¢å›å¤ï¼Œå¦å¤–æƒ³é—®ä¼šæœ‰ä¸€ä¸ªå¤§æ¦‚æ—¶é—´å—ï¼Œæ¯”å¦‚ä¼šåœ¨6æœˆä»½åˆæˆ–è€…åä¸€å‰æˆ–è€…å¹´åº•è¿™æ ·ç¨å¾®å‡†ç¡®çš„æ—¶é—´ç‚¹å—ï¼Œè°¢è°¢ é¢„è®¡åœ¨è¿‘1ï¼Œ2ä¸ªæœˆä¹‹å†…å§ ä¸€å¹´è¿‡å»äº† éå¸¸æ„Ÿè°¢ä½ çš„å›å¤ æœ€æ–°çš„ç‰ˆæœ¬å·²å‘å¸ƒ
577,æŠŠcanalæœåŠ¡ç«¯çš„æ—¥å¿—çº§åˆ«æ”¹æˆDEBUG ç„¶åæ— é™å¿«é€Ÿæ‰“å°ä¸‹é¢è¿™ä¸€æ¡æ—¥å¿—ï¼Œç„¶åè·å–ä¸åˆ°å˜æ›´æ•°æ®ï¼Œè¿™æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ 2018-04-09 15:12:46.395 [destination = xxx_2   address = /xxx.xxx.xxx.xxx:3306   EventParser] DEBUG c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - set EntryPosition[included=false journalName=mysql-bin.000789 position=8764275 serverId=10294 timestamp=1523224556000] to be pending start position before finding another proper one... 2018-04-09 15:39:33.727 [destination = xxx   address = /192.168.xxx.94:3306   EventParser] DEBUG c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - set EntryPosition[included=false journalName=mysql-bin.000789 position=12934350 serverId=xxx94 timestamp=1523224841000] to be pending start position before finding another proper one... 2018-04-09 15:39:33.804 [destination = xxx   address = /192.168.xxx.94:3306   EventParser] DEBUG c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - compare exit condition:mysql-bin.000789 12934977 1523224841000  startTimestamp=1523259171081... 2018-04-09 15:39:33.805 [destination = xxx   address = /192.168.xxx.94:3306   EventParser] DEBUG c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - set EntryPosition[included=false journalName=mysql-bin.000789 position=12934977 serverId=xxx94 timestamp=1523224841000] to be pending start position before finding another proper one... 2018-04-09 15:39:33.886 [destination = xxx   address = /192.168.xxx.94:3306   EventParser] DEBUG c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - compare exit condition:mysql-bin.000789 12935073 1523224841000  startTimestamp=1523259171081... 2018-04-09 15:39:33.886 [destination = xxx   address = /192.168.xxx.94:3306   EventParser] DEBUG c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - set EntryPosition[included=false journalName=mysql-bin.000789 position=12935073 serverId=xxx94 timestamp=1523224841000] to be pending start position before finding another proper one... 2018-04-09 15:39:33.972 [destination = xxx   address = /192.168.xxx.94:3306   EventParser] DEBUG c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - compare exit condition:mysql-bin.000789 12935687 1523224841000  startTimestamp=1523259171081... 2018-04-09 15:39:33.972 [destination = xxx   address = /192.168.xxx.94:3306   EventParser] DEBUG c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - set EntryPosition[included=false journalName=mysql-bin.000789 position=12935687 serverId=xxx94 timestamp=1523224841000] to be pending start position before finding another proper one... 2018-04-09 15:39:34.052 [destination = xxx   address = /192.168.xxx.94:3306   EventParser] DEBUG c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - compare exit condition:mysql-bin.000789 12935783 1523224841000  startTimestamp=1523259171081... 2018-04-09 15:39:34.052 [destination = xxx   address = /192.168.xxx.94:3306   EventParser] DEBUG c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - set EntryPosition[included=false journalName=mysql-bin.000789 position=12935783 serverId=xxx94 timestamp=1523224841000] to be pending start position before finding another proper one... 2018-04-09 15:39:34.128 [destination = xxx   address = /192.168.xxx.94:3306   EventParser] DEBUG c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - compare exit condition:mysql-bin.000789 12938728 1523224841000  startTimestamp=1523259171081... 2018-04-09 15:39:34.128 [destination = xxx   address = /192.168.xxx.94:3306   EventParser] DEBUG c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - set EntryPosition[included=false journalName=mysql-bin.000789 position=12938728 serverId=xxx94 timestamp=1523224841000] to be pending start position before finding another proper one... 2018-04-09 15:39:34.207 [destination = xxx   address = /192.168.xxx.94:3306   EventParser] DEBUG c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - compare exit condition:mysql-bin.000789 12938824 1523224841000  startTimestamp=1523259171081... 2018-04-09 15:39:34.207 [destination = xxx   address = /192.168.xxx.94:3306   EventParser] DEBUG c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - set EntryPosition[included=false journalName=mysql-bin.000789 position=12938824 serverId=xxx94 timestamp=1523224841000] to be pending start position before finding another proper one... 2018-04-09 15:39:34.280 [destination = xxx   address = /192.168.xxx.94:3306   EventParser] DEBUG c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - compare exit condition:mysql-bin.000789 12939336 1523224841000  startTimestamp=1523259171081... è¿™æ˜¯åœ¨å®šä½ä½ç‚¹æ—¶æ‰“å°çš„debugä¿¡æ¯
576,canal.deployer-1.0.26-SNAPSHOTæŠ¥é”™ æœ‰ä¸¤ä¸ªinstanceé…ç½®ï¼Œåˆ†åˆ«ä¸ºexampleå’Œexample1é‡Œé¢çš„ æ­£å¸¸å¯åŠ¨è¿‡åè¿‡ä¸€ä¼šå„¿ä¼šå®¢æˆ·ç«¯æŠ¥é”™ï¼š java.lang.NullPointerException  at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.writeWithHeader(SimpleCanalConnector.java:358) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.ack(SimpleCanalConnector.java:318) ack batchIdçš„æ—¶å€™æŠ¥çš„ç©ºæŒ‡é’ˆ æŠ¥é”™çš„ä»£ç è¡Œä¸ºï¼šconnector.ack(batchId); ä»£ç è¡Œå’Œæˆ‘è¿™è¾¹å¯¹ä¸ä¸Šï¼Œè‡ªå·±æ”¹åŠ¨è¿‡ï¼Ÿ
575,MySQLSyntaxErrorException: Duplicate column name 'REQUIRED' è«åå‡ºç°äº†ä¸‹é¢çš„é—®é¢˜ï¼Œä½†è¡¨ä¸­åˆ—æ˜¯æ²¡æœ‰é‡å¤çš„ï¼Œä¸çŸ¥é“åˆ°åº•æ˜¯å› ä¸ºä»€ä¹ˆï¼Œéº»çƒ¦å¤§ç¥ç»™ä¸ªæ€è·¯ pid:1 nid:1 exception:setl:com.alibaba.otter.node.etl.load.exception.LoadException: java.util.concurrent.ExecutionException: com.alibaba.otter.node.etl.load.exception.LoadException: com.alibaba.otter.node.etl.load.exception.LoadException: org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Duplicate column name 'REQUIRED' Caused by: java.util.concurrent.ExecutionException: com.alibaba.otter.node.etl.load.exception.LoadException: com.alibaba.otter.node.etl.load.exception.LoadException: org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Duplicate column name 'REQUIRED' DDLé‡å¤åŒæ­¥ï¼Ÿ
574,canalç›‘æ§è¿‡æ»¤é—®é¢˜ï¼Œbinlogæ¨¡å¼ä¸ºMixed binlogæ¨¡å¼ä¸ºMixedï¼Œå¦‚ä½•å®ç°åªå¯¹æŸä¸ªå›ºå®šåº“åè¿›è¡Œbinlogç›‘æ§ã€‚ ä½¿ç”¨1.0.26ç‰ˆæœ¬ï¼Œç›®å‰å·²ç»åŸºäºSQLå®Œæ•´è§£ææ¥æ”¯æŒè¿‡æ»¤
573,è¿æ¥é˜¿é‡ŒRDSï¼Œå½“å‘ç”Ÿä¸»å¤‡åˆ‡æ¢åï¼ŒcanalæŠ¥é”™ï¼Œå¹¶ä¸”é‡å¯canalä¸èƒ½æ­£å¸¸å¯åŠ¨ 
572,binlogçš„ddlä¸­å‡ºç°æ³¨é‡Šå¯¼è‡´æ­¤æ¶ˆæ¯è¢«ä¸¢å¼ƒï¼Ÿ å½“dbaæ“ä½œddlæ—¶ï¼Œä¾‹å¦‚æ–°å¢ä¸€ä¸ªå­—æ®µï¼Œå¦‚æœåœ¨å‘½ä»¤å‰æœ‰æ³¨é‡Šçš„è¯ï¼Œcanalæœ€ç»ˆè§£æä¸åˆ°è¿™ä¸ªäº‹ä»¶ã€‚ ä½†æ˜¯å¦‚æœæ²¡æœ‰å‰é¢è¿™è¡Œæ³¨é‡Šï¼Œå°±èƒ½è§£æåˆ°è¿™æ¡binlogï¼Œ `  /**      * <code>optional bool isDdl = 10 [default = false];</code>      *      * <pre>      ** æ ‡è¯†æ˜¯å¦æ˜¯ddlè¯­å¥  *      * </pre>      */     public boolean getIsDdl() {       return isDdl_;     }` ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ‰§è¡Œddlæ—¶æŒ‡å®šäº†æ³¨é‡Šï¼š `# at 708574121 #180403  0:33:33 server id 248037  end_log_pos 708574490 CRC32 0x0e8bdfed       Query   thread_id=15086636      exec_time=1647  error_code=0 SET TIMESTAMP=1522686813/*!*/; -- æ³¨é‡Šæ³¨é‡Š  ALTER TABLE on_ord_act_paid03  ADD receivables_mch_id VARCHAR(50) DEFAULT NULL COMMENT 'Foo'   MODIFY COLUMN payment_method SMALLINT NOT NULL COMMENT 'Bar' /*!*/; # at 708574490 #180403  1:01:00 server id 248037  end_log_pos 708574578 CRC32 0x51d11ba5       Query   thread_id=15086688      exec_time=0     error_code=0 SET TIMESTAMP=1522688460/*!*/;` é‚£ä¹ˆè¿™æ¡binlogçš„rowChange.getIsDdl()åº”è¯¥ç›®å‰æ˜¯è¿”å›çš„falseã€‚ å¦‚æœå»æ‰â€œ-- æ³¨é‡Šæ³¨é‡Š â€ï¼Œåˆ™è¿”å›trueã€‚ å½“å‰æ•°æ®åº“ç›¸å…³ä¿¡æ¯ï¼š Server version: 5.6.21-log Source distribution innodb_version        5.6.21 å½“å‰å®ä¾‹çš„binlogé…ç½®ä¿¡æ¯ï¼š `| binlog_cache_size                       | 2097152                          | | binlog_checksum                         | CRC32                            | | binlog_direct_non_transactional_updates | OFF                              | | binlog_format                           | ROW                              | | binlog_max_flush_queue_time             | 0                                | | binlog_order_commits                    | ON                               | | binlog_row_image                        | FULL                             | | binlog_rows_query_log_events            | OFF                              | | binlog_stmt_cache_size                  | 2097152                          | | binlogging_impossible_mode              | IGNORE_ERROR                     | | innodb_api_enable_binlog                | OFF                              | | innodb_locks_unsafe_for_binlog          | OFF                              | | log_bin                                 | ON                               | | log_bin_basename                        | /data/mysql_3306/mysql-bin       | | log_bin_index                           | /data/mysql_3306/mysql-bin.index | | log_bin_trust_function_creators         | OFF                              | | log_bin_use_v1_row_events               | OFF                              | | max_binlog_cache_size                   | 18446744073709547520             | | max_binlog_size                         | 1073741824                       | | max_binlog_stmt_cache_size              | 18446744073709547520             | | simplified_binlog_gtid_recovery         | OFF                              | | sql_log_bin                             | ON                               | | sync_binlog                             | 100                              |` mysql.conf [mysqld] basedir=/usr/local/mysql datadir=/data/mysql_3306 socket=/data/mysql_3306/mysql.sock port=3306 server_id=248037 log-bin=mysql-bin binlog_format = ROW relay-log=mysqld-relay-bin sync_binlog = 100 relay_log_purge=0 log_slave_updates query_cache_type = 0 query_cache_size = 0 table_definition_cache = 2048 table_open_cache = 4096 table_open_cache_instances = 8 sql_mode=NO_ENGINE_SUBSTITUTION STRICT_TRANS_TABLES skip-name-resolve back_log = 100 max_connections = 1000 max_connect_errors = 100000 max_allowed_packet = 16M binlog_cache_size = 2M binlog_stmt_cache_size = 2M max_heap_table_size = 256M tmp_table_size = 8M sort_buffer_size = 8M thread_cache_size = 256 ft_min_word_len = 4 thread_stack = 192K long_query_time = 3 tmpdir = /tmp key_buffer_size = 8M read_buffer_size = 8M join_buffer_size = 8M read_rnd_buffer_size = 8M bulk_insert_buffer_size = 8M character_set_server = utf8 collation_server = utf8_general_ci transaction_isolation = REPEATABLE-READ default_storage_engine = InnoDB default_tmp_storage_engine = InnoDB innodb_buffer_pool_size = 30G innodb_file_per_table = 1 innodb_file_io_threads = 4 innodb_thread_concurrency = 32 innodb_flush_log_at_trx_commit = 2 innodb_log_buffer_size = 256M innodb_log_file_size = 512M innodb_log_files_in_group = 3 innodb_flush_method = O_DIRECT innodb_lock_wait_timeout = 120 innodb_open_files = 32768 innodb_online_alter_log_max_size = 32G slow_query_log = on long_query_time = 0.5 slow_query_log_file = mysql-slow [mysql] default-character-set=utf8 sock = /data/mysql_3306/mysql.sock [mysqld_safe] log-error=/data/mysql_3306/mysqld.err pid-file=/data/mysql_3306/mysqld.pid å°è¯•ä½¿ç”¨æœ€æ–°çš„26ç‰ˆæœ¬ï¼Œå·²ç»åŸºäºDDLçš„SQLå…¨è§£æçš„æ–¹å¼ï¼Œå¯ä»¥æ”¯æŒæ³¨é‡Š
571,java.net.SocketTimeoutException 1ã€canal çš„serverå’Œclient è·‘ä¸€æ®µæ—¶é—´ä¹‹åå‡ºç°è¿™ä¸ªå¼‚å¸¸ï¼Œé‡å¯ä¹‹åä¾ç„¶æŠ¥è¿™ä¸ªå¼‚å¸¸ï¼Œé‡æ–°åˆ æ‰meta.daté‡æ–°å¯åŠ¨ä¹‹ååˆæœ‰æ•°æ®äº†è¯·é—®è¿™æ˜¯ä¸ºå•¥ï¼Ÿ 2ã€canal ä¸ç®¡æ˜¯ç½‘ç»œè¿˜æ˜¯ç‰©ç†æœºå‡ºé—®é¢˜äº†ï¼Œå¦‚ä½•ä¿è¯æ•°æ®ä¸ä¸¢å¤±ã€‚ ![default](https://user-images.githubusercontent.com/23053967/38133429-c0a550e4-3441-11e8-8080-79e82950539e.png) å¦‚å›¾æˆ‘æƒ³ä»è¯¥ä½ç‚¹é‡æ–°å¼€å§‹åŒæ­¥æ•°æ®ï¼Œé‡å¯ä¸å¥½ç”¨ï¼Œè¯¥å¦‚ä½•åšï¼Ÿ å¤šçœ‹ä¸€ä¸‹wiki
570,â€˜FULLTEXT KEYâ€™  and â€˜ADD INDEX USING BTREEâ€™   cause parse error v1.0.25 `parse faield : ALTER TABLE `xxxxx` ADD INDEX `idx_order_id` (`order_id`) USING BTREE com.alibaba.druid.sql.parser.ParserException: syntax error  error in :'SING BTREE'  expect IDENTIFIER  actual IDENTIFIER pos 132  line 4  column 45  token IDENTIFIER BTREE         at com.alibaba.druid.sql.parser.SQLParser.printError(SQLParser.java:284) ~[druid-1.1.6.jar:1.1.6]         at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:421) ~[druid-1.1.6.jar:1.1.6] ` `2018-03-26 09:11:52.244 [destination = kd_caesar_yf   address = test.kuaihuoyun.com/118.178.142.131:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TABLE `xxxx` (   `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT ''   ...   FULLTEXT KEY `ft_query_oid` (`query_oid`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='' com.alibaba.druid.sql.parser.ParserException: syntax error  error in :' KEY `ft_query_oid` (`query_oid`) )'  expect RPAREN  actual IDENTIFIER pos 2255  line 37  column 16  token IDENTIFIER `ft_query_oid`         at com.alibaba.druid.sql.parser.SQLParser.printError(SQLParser.java:284) ~[druid-1.1.6.jar:1.1.6]         at com.alibaba.druid.sql.parser.SQLParser.accept(SQLParser.java:292) ~[druid-1.1.6.jar:1.1.6]         at com.alibaba.druid.sql.dialect.mysql.parser.MySqlCreateTableParser.parseCreateTable(MySqlCreateTableParser.java:191) ~[druid-1.1.6.jar:1.1.6]         at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseCreate(MySqlStatementParser.java:244) ~[druid-1.1.6.jar:1.1.6]         at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:159) ~[druid-1.1.6.jar:1.1.6]         at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.6.jar:1.1.6]         at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:464) ~[druid-1.1.6.jar:1.1.6]         at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:295) ~[druid-1.1.6.jar:1.1.6]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:69) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.apply(DatabaseTableMeta.java:104) [canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.apply(TableMetaCache.java:203) [canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseQueryEvent(LogEventConvert.java:194) [canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:107) [canal.parse-1.0.25.jar:na] ` èƒ½æä¾›ä¸€ä¸‹å®Œæ•´çš„SQLï¼Ÿæˆ–è€…è¯•è¯•1.0.26çš„ç‰ˆæœ¬ï¼Ÿ @agapple sql å¦‚ä¸‹ ALTER TABLE xxxxx ADD INDEX idx_order_id(order_id) USING BTREE; CREATE TABLE xxxx (    id int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT ''    ft_query_oid varchar(32) NOT NULL default ''    FULLTEXT KEY ft_query_oid(query_oid)  ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='' ; æˆ‘è¿™è¾¹ä¹Ÿå‡ºç°è¿™ä¸ªé—®é¢˜ï¼šå…·ä½“ä»£ç å¦‚ä¸‹ï¼š 2018-04-03 11:39:30.726 [destination = eam   address = /172.16.XX.XX:XXXX   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : ALTER TABLE `TB_AT_CREDITCARD_WITHHOLD_INFO` ADD UNIQUE INDEX `IDX_UNIQ_IDCARD_ACCOUNT` (`CUSTOMER_ID_CARD`  `CUSTOMER_BANK_ACCOUNT`) USING BTREE com.alibaba.druid.sql.parser.ParserException: syntax error  error in :'SING BTREE'  expect IDENTIFIER  actual IDENTIFIER pos 139  line 2  column 96  token IDENTIFIER BTREE         at com.alibaba.druid.sql.parser.SQLParser.printError(SQLParser.java:284) ~[druid-1.1.6.jar:1.1.6]         at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:421) ~[druid-1.1.6.jar:1.1.6]         at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.6.jar:1.1.6]         at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:464) ~[druid-1.1.6.jar:1.1.6]         at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:295) ~[druid-1.1.6.jar:1.1.6]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:69) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.applyHistoryOnMemory(DatabaseTableMeta.java:387) [canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:121) [canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.25.jar:na]         at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] ç¡®è®¤ä¸ºDDLè§£æbugï¼Œ26ç‰ˆæœ¬é‡Œè¿‘æœŸä¼šä¿®å¤ å‡çº§fastsqlåå·²ä¿®å¤ æ‚¨å¥½ã€‚fastsqlåªèƒ½æ‰¾åˆ°2.0.0_preview_186å’Œ2.0.0_preview_151ç‰ˆæœ¬ã€‚ éº»çƒ¦è¯·é—®371çš„ç‰ˆæœ¬åœ°å€ http://mvnrepository.com/artifact/com.alibaba.fastsql/fastsql å¯ä»¥ä»æˆ‘çš„äºŒè¿›åˆ¶åŒ…é‡Œä¸‹è½½ä¸€ä»½
569,msyql 5.6.16-log canal server1.0.26 è§£ævarcharå­—æ®µ å‡ºç° > ç¬¦å·   msyql  é˜¿é‡Œäº‘rds é«˜å¯ç”¨ç‰ˆ 5.6.16-log ï¼Œcanal server è§£ævarcharå­—æ®µ ä¸­æ–‡å­—ç¬¦ å‡ºç° > ç¬¦å·   ä¹±ç äº†å§ æœ€å¥½èƒ½ç»™åˆ°ä¸€ä¸ªå¯å¤ç°çš„æµ‹è¯•æ–¹å¼
568,canal1.0.26/1.0.25 åˆ é™¤meta.dat è®¾å®šcanal.instance.master.timestampä¸º1522209915000 å¯åŠ¨åå‘ç°è¯»å–canalæ¶ˆæ¯ä¸€ä¼šåï¼Œå°±è¯»å–åˆ°messageçš„real sizeè¿œè¿œå°‘äºè®¾å®šçš„batchSizeï¼Œæœ‰æ—¶å€™ç”šè‡³result is nullã€‚æ’é™¤mysqlçš„binlogè®°å½•æ•°ä¸å¤Ÿï¼Œæœ‰ä»€ä¹ˆåŸå› å—ï¼Ÿ real sizeæ˜¯æŒ‰ç…§å†…å­˜å¤§å°è·å–çš„ï¼Œéè®°å½•æ•°
567, canal.deployer-1.0.26-SNAPSHOTç‰ˆæœ¬rdsè·å–ä¸åˆ°æ—¥å¿—ä¿¡æ¯ é…ç½®åœ¨æœ¬åœ°çš„mysqlï¼Œç„¶åè¿›è¡Œæ“ä½œå¯ä»¥è·å–åˆ°æ“ä½œä¿¡æ¯ é…ç½®rdsä¸Šçš„ï¼Œæ“ä½œæ— æ³•è·å–åˆ°æ“ä½œä¿¡æ¯ åªé…ç½®äº†instance.propertiesï¼Œè¿˜éœ€è¦é…ç½®rds_instance.propertieså—ï¼Ÿ rdsä¸ŠæŠ¥ï¼šcanal.logé‡Œé¢æŠ¥é”™ 2018-03-28 15:28:06.345 [New I/O server worker #1-2] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x729a1c21  /192.168.10.156:64481 => /192.168.10.156:11111]  exception=java.io.IOException: è¿œç¨‹ä¸»æœºå¼ºè¿«å…³é—­äº†ä¸€ä¸ªç°æœ‰çš„è¿æ¥ã€‚ 	at sun.nio.ch.SocketDispatcher.read0(Native Method) 	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:43) 	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223) 	at sun.nio.ch.IOUtil.read(IOUtil.java:192) 	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:322) 	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:281) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:201) 	at org.jboss.netty.util.internal.IoWorkerRunnable.run(IoWorkerRunnable.java:46) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) 	at java.lang.Thread.run(Thread.java:745) exception=java.io.IOException: è¿œç¨‹ä¸»æœºå¼ºè¿«å…³é—­äº†ä¸€ä¸ªç°æœ‰çš„è¿æ¥ã€‚ ä¼°è®¡å’Œcanal serveræ–­é“¾äº† æ•°æ®åº“è¿˜åœ¨è¿è¡Œï¼Œå°±æ˜¯æ„Ÿè§‰canalè¿™è¾¹è¿ä¸ä¸Šæ•°æ®åº“ï¼Œè¯·é—®é‚£è¦æ€ä¹ˆå¤„ç†å‘¢
566,canal serverå¯åŠ¨åä¼šäº§ç”Ÿå¤§é‡çš„unauthenticated user éè®¤è¯ç”¨æˆ·è¿æ¥ã€‚canal serveråœæ­¢åï¼Œunauthenticated user éè®¤è¯ç”¨æˆ·è¿æ¥æ¶ˆå¤±äº†ã€‚ canal version 1.0.24ï¼Œcanal serveræ˜¯ä¸»å¤‡æ¨¡å¼ å»ºè®®æ¢1.0.26ç‰ˆæœ¬
565,canal serverå¯åŠ¨åä¼šäº§ç”Ÿå¤§é‡çš„unauthenticated user éè®¤è¯ç”¨æˆ·è¿æ¥ã€‚canal serveråœæ­¢åï¼Œunauthenticated user éè®¤è¯ç”¨æˆ·è¿æ¥æ¶ˆå¤±äº†ï¼Œä½†æ˜¯instanceé…ç½®çš„æ•°æ®åº“è¿æ¥å¹¶æ²¡æœ‰æ–­å¼€ï¼Œçœ‹é“¾æ¥å¤„äºsleepçŠ¶æ€ã€‚ canalç‰ˆæœ¬1.0.24 
564,CanalConnector connector=CanalConnectors.newClusterConnector(canalProperties.getZkServers() canalProperties.getDestination() "" ""); CanalConnector connector=CanalConnectors.newClusterConnector(canalProperties.getZkServers() canalProperties.getDestination() "" "")serverç«¯å¦‚ä½•è®¾ç½®password https://github.com/alibaba/canal/issues/192ï¼Œå‚è€ƒè¿™ä¸ª
563,æ¥æ”¶ç«¯å¦‚ä½•åŒºåˆ†è¯¥è®°å½•æ˜¯Rowè¿˜æ˜¯STATEMENT æ¥æ”¶ç«¯å¦‚ä½•åŒºåˆ†è¯¥è®°å½•æ˜¯Rowè¿˜æ˜¯STATEMENT String sql=rowChage.getSql(); å¯ä»¥æ ¹æ®sqlæ˜¯å¦ä¸ºç©ºæ¥åˆ¤æ–­å—ã€‚ å¤šçœ‹æ–‡æ¡£å§
562,canal.instance.filter.regex serverç«¯çš„canal.instance.filter.regexå’Œclientç«¯çš„connector.subscribe(subscribe_pattern)æœ‰ä»€ä¹ˆå…³ç³»ï¼Œå°è¯•äº†ä¸€ä¸‹å‘ç°serverç«¯çš„è®¾ç½®è²Œä¼¼ä¸èµ·ä½œç”¨ï¼  connector.subscribe(subscribe_pattern)  æ‰æ˜¯æœ€ä½³å§¿åŠ¿ï¼ LSæ­£è§£
561,å¦‚ä½•åœ¨å®¢æˆ·ç«¯é‡ç½®Canalçš„ä½ç½®ï¼Ÿç°åœ¨çš„ä½ç‚¹åœ¨è¿œç¨‹Canalæ‰€ç›‘å¬çš„mysql binlogæ—¶é—´é•¿äº†å·²ç»åˆ äº† message message.getId()ä¸º-1 ## å¦‚ä½•åœ¨å®¢æˆ·ç«¯é‡ç½®Canalçš„ä½ç½®ï¼Ÿ   ### é—®é¢˜æè¿°ï¼š   ç°åœ¨çš„ä½ç‚¹åœ¨è¿œç¨‹Canalæ‰€ç›‘å¬çš„mysql binlogæ—¶é—´é•¿äº†å·²ç»åˆ äº†ã€‚    message message.getId()ä¸ºæ°¸è¿œä¸º-1ã€‚   message.getEntries().size() æ°¸è¿œä¸º 0ï¼Œæ°¸è¿œè¯»ä¸å‡ºæ•°æ®ï¼ï¼ ### ç–‘é—®ï¼š   è¯·é—®å¦‚ä½•åœ¨ä¸æ”¹åŠ¨ è¿œç¨‹CanalæœåŠ¡çš„é…ç½®æˆ–å…¶ä»–å•Šå“¦åšçš„æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯è‡ªå·±é‡ç½®ä½ç½®ä¸ºæœ€æ–°çš„ï¼Ÿ   å°±æ˜¯ç›‘å¬æœ€æ–°çš„binlogæ¶ˆæ¯ï¼Œä¹‹å‰çš„binlogå°±å¿½ç•¥ï¼Ÿï¼Ÿï¼Ÿ ## Canal æœåŠ¡destinationé…ç½® ``` canal.instance.mysql.slaveId = 617 # position info canal.instance.master.address = 10.1.6.226:3307 canal.instance.master.journal.name = canal.instance.master.position = canal.instance.master.timestamp = #canal.instance.standby.address = #canal.instance.standby.journal.name = #canal.instance.standby.position = #canal.instance.standby.timestamp = # username/password canal.instance.dbUsername = mescanal canal.instance.dbPassword = mescanal canal.instance.defaultDatabaseName = canal.instance.connectionCharset = UTF-8 # table regex canal.instance.filter.regex = .*\\..* # table black regex canal.instance.filter.black.regex = ``` ## meta.data ``` cat meta.dat {"clientDatas":[{"clientIdentity":{"clientId":1001 "destination":"mysql_b7_gaotaiunyue" "filter":".*\\..*"} "cursor":{"identity":{"slaveId":-1 "sourceAddress":{"address":"10.1.6.226" "port":3307}} "postion":{"included":false "journalName":"my3307-bin.000303" "position":77593731 "serverId":3307 "timestamp":1521010166000}}}] "destination":"mysql_b7_gaotaiunyue"} ``` ## è¿™æ˜¯æ—¥å¿—ä»£ç  ``` 2018-03-22 10:41:54.051 [destination = mysql_b7_gaotianyue   address = /10.1.6.226:3307   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /10.1.6.226:3307 has an error  retrying. caused by java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) ~[canal.parse-1.0.22.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_65] 2018-03-22 10:41:54.051 [destination = mysql_b7_gaotianyue   address = /10.1.6.226:3307   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:mysql_b7_liupengchun[java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) 	at java.lang.Thread.run(Thread.java:745) ``` Could not find first log file name in binary log index fileï¼Œä½ç‚¹ä¸å­˜åœ¨ åŒæ„Ÿï¼Œèƒ½ä¸èƒ½åœ¨ä½ç‚¹å¼‚å¸¸é”™è¯¯çš„æƒ…å†µä¸‹ï¼Œè‡ªåŠ¨é‡ç½®åˆ°æœ€æ–°çš„ä½ç‚¹ +1 å‡ºç°æ¬¡æ•°è¾ƒå¤š åŒä¸Š å¦‚æœæ˜¯é˜¿é‡Œäº‘è¿™ç±»rdsçš„æƒ…å†µ(ä¸€ä¸ªvipæŒ‚åç«¯ä¸»å¤‡)ï¼Œä¼šè‡ªåŠ¨é‡æ–°å®šä½ï¼Œå…¶ä½™çš„mysqlæƒ…å†µï¼Œå› ä¸ºbinlogè¢«åˆ é™¤ï¼Œå³ä½¿é‡æ–°å®šä½ä¹Ÿæ²¡ç”¨ +1  å‚è€ƒFAQ :  https://github.com/alibaba/canal/wiki/FAQ +1 è¢«ææ­»äº†
560,å¯åŠ¨æŠ¥é”™ PropertyAccessException 1: org.springframework.beans.MethodInvocationException: Property 'tsdbSpringXml' threw exception; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'tableMetaTSDB' defined in class path resource [spring/tsdb/h2-tsdb.xml]: Cannot resolve reference to bean 'metaHistoryDAO' while setting bean property 'metaHistoryDAO'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'metaHistoryDAO' defined in class path resource [spring/tsdb/h2-tsdb.xml]: Cannot resolve reference to bean 'sqlMapClient' while setting bean property 'sqlMapClient'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlMapClient' defined in class path resource [spring/tsdb/h2-tsdb.xml]: Cannot resolve reference to bean 'dataSource' while setting bean property 'dataSource'; nested exception is org.springframework.beans.factory.CannotLoadBeanClassException: Error loading class [com.alibaba.druid.pool.DruidDataSource] for bean with name 'dataSource' defined in class path resource [spring/tsdb/h2-tsdb.xml]: problem with class file or dependent class; nested exception is java.lang.LinkageError: loading constraint violated 	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1453) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE] 	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1158) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE] 	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE] 	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:458) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE] 	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:296) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE] 	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:223) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE] 	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:293) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE] 	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:194) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE] 	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:328) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE] 	... 30 common frames omitted Caused by: org.springframework.beans.PropertyBatchUpdateException: Failed properties: Property 'tsdbSpringXml' threw exception; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'tableMetaTSDB' defined in class path resource [spring/tsdb/h2-tsdb.xml]: Cannot resolve reference to bean 'metaHistoryDAO' while setting bean property 'metaHistoryDAO'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'metaHistoryDAO' defined in class path resource [spring/tsdb/h2-tsdb.xml]: Cannot resolve reference to bean 'sqlMapClient' while setting bean property 'sqlMapClient'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlMapClient' defined in class path resource [spring/tsdb/h2-tsdb.xml]: Cannot resolve reference to bean 'dataSource' while setting bean property 'dataSource'; nested exception is org.springframework.beans.factory.CannotLoadBeanClassException: Error loading class [com.alibaba.druid.pool.DruidDataSource] for bean with name 'dataSource' defined in class path resource [spring/tsdb/h2-tsdb.xml]: problem with class file or dependent class; nested exception is java.lang.LinkageError: loading constraint violated 	at org.springframework.beans.AbstractPropertyAccessor.setPropertyValues(AbstractPropertyAccessor.java:101) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE] 	at org.springframework.beans.AbstractPropertyAccessor.setPropertyValues(AbstractPropertyAccessor.java:57) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE] 	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1450) ~[spring-beans-3.2.9.RELEASE.jar:3.2.9.RELEASE] 	... 38 common frames omitted java.lang.LinkageError: loading constraint violatedï¼Œåšè¿‡äºŒæ¬¡å¼€å‘ï¼Ÿ
559,canal.instance.rds.startTime è¯·é—®canalæ”¯æŒé˜¿é‡Œäº‘çš„RDSäº†ï¼Œä½† canal.instance.rds.startTime= canal.instance.rds.endTime= ä¸çŸ¥é“å¦‚ä½•è®¾ç½®ï¼Œæ—¶é—´æ ¼å¼æ˜¯ä»€ä¹ˆæ ·çš„? åœ¨é˜¿é‡Œäº‘RDSæ§åˆ¶å°å¦‚ä½•çœ‹åˆ°è¿™ä¸ªtimeï¼Ÿ è°¢è°¢ è¿™æ˜¯è·å–rds oss binlogçš„è§£æï¼Œè¿™ä¸ªæ—¶é—´æ˜¯æ ‡å‡†çš„GMT 0æ—¶åŒºçš„æ—¶é—´
558,com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. æ›´å¤šçš„å†…å®¹æè¿°å•Š ![image](https://user-images.githubusercontent.com/18360996/37639699-6a6d3832-2c4d-11e8-9004-32a054adc0de.png) otterè¿˜ç»å¸¸æœ‰å‡æ­»ç°è±¡ï¼Œæ²¡æœ‰ä»»ä½•æ—¥å¿—ï¼Œchannelæ²¡æœ‰æŒ‚èµ·ï¼Œpipelineä¹Ÿæ˜¯å·¥ä½œä¸­ï¼Œä½†æ˜¯å½“æºåº“æ•°æ®å˜åŒ–åï¼Œæ²¡æœ‰ä»»ä½•æ“ä½œã€‚é‡å¯channelä¹‹ååŸºæœ¬å°±èƒ½æ¢å¤ï¼Œä¸çŸ¥é“è¿™æ˜¯ä»€ä¹ˆåŸå›  otter managerï¼Œæˆ‘ä¸çŸ¥é“æ˜¯ä¸æ˜¯æˆ‘ä»¬ç”¨çš„æ–¹å¼ä¸å¯¹ã€‚å‡å¦‚æˆ‘æœ‰ä¸Šç™¾å¼ è¡¨éœ€è¦åŒæ­¥æ•°æ®ï¼Œæ²¡æœ‰æ›´å¿«æ·çš„é…ç½®åŠæ³•ä¹ˆï¼Ÿåªèƒ½ä¸€ä¸ªä¸€ä¸ªçš„æï¼Ÿ otterçš„æ—¥å¿—éƒ¨åˆ†ï¼Œå»ºè®®åŠ å¼ºï¼Œä¸€å¤§å †æ—¥å¿—ä½†å´æ²¡æœ‰å¤ªå¤šæœ‰ä»·å€¼ä¿¡æ¯è¾“å‡º
557,å¯åŠ¨æŠ¥é”™ã€‚çœŸä½©æœé˜¿é‡Œçš„ç¨‹åºå‘˜ï¼Œå¹NBæŒºå‰å®³ï¼Œå†™çš„ä¸œè¥¿çœŸä¸æ•¢æ­ç»´ã€‚ 2018-03-15 13:35:46.673 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [canal.properties] 2018-03-15 13:35:46.677 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [example/instance.properties] 2018-03-15 13:35:46.782 [main] WARN  o.s.beans.GenericTypeAwarePropertyDescriptor - Invalid JavaBean property 'connectionCharset' being accessed! Ambiguous write methods found next to actually used [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.nio.charset.Charset)]: [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.lang.String)] 2018-03-15 13:35:46.786 [main] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start CannalInstance for 1-example  2018-03-15 13:35:47.162 [main] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - subscribe filter change to olot\..* 2018-03-15 13:35:47.163 [main] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - start successful.... 2018-03-15 13:35:47.163 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position by switch ::1520690568000 2018-03-15 13:35:47.445 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - Didn't find the corresponding binlog files from mysql-bin.000001 to mysql-bin.000002 2018-03-15 13:35:47.447 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /127.0.0.1:3306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: can't find start position for example 2018-03-15 13:35:47.449 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: can't find start position for example ] 2018-03-15 13:35:47.452 [nioEventLoopGroup-2-5] ERROR c.a.o.canal.parse.driver.mysql.socket.SocketChannelPool - business error. java.lang.NullPointerException: null 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannel.writeCache(SocketChannel.java:34) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannelPool$BusinessHandler.channelRead0(SocketChannelPool.java:96) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannelPool$BusinessHandler.channelRead0(SocketChannelPool.java:73) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105) ~[netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:373) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:359) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:351) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1334) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:373) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:359) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:926) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:129) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:651) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:574) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:488) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:450) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:873) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:144) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_131] 2018-03-15 13:35:57.859 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position by switch ::1520690568000 2018-03-15 13:35:58.136 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - Didn't find the corresponding binlog files from mysql-bin.000001 to mysql-bin.000002 2018-03-15 13:35:58.137 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /127.0.0.1:3306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: can't find start position for example 2018-03-15 13:35:58.137 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: can't find start position for example ] 2018-03-15 13:35:58.145 [nioEventLoopGroup-2-3] ERROR c.a.o.canal.parse.driver.mysql.socket.SocketChannelPool - business error. java.lang.NullPointerException: null 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannel.writeCache(SocketChannel.java:34) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannelPool$BusinessHandler.channelRead0(SocketChannelPool.java:96) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannelPool$BusinessHandler.channelRead0(SocketChannelPool.java:73) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105) ~[netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:373) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:359) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:351) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1334) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:373) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:359) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:926) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:129) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:651) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:574) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:488) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:450) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:873) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:144) [netty-all-4.1.6.Final.jar:4.1.6.Final] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_131] æœ‰é—®é¢˜å°±åé¦ˆï¼Œæ²¡å¿…è¦ä¸Šçº²ä¸Šçº¿ï¼Œä¸€ä¸ªsnapshotç‰ˆæœ¬
556,Centosä¸‹ç¼–ä¸è¿‡ [INFO] Total time: 2.336s [INFO] Finished at: Thu Mar 15 13:48:55 CST 2018 [INFO] Final Memory: 18M/248M [INFO] ------------------------------------------------------------------------ [ERROR] Failed to execute goal on project canal.parse: Could not resolve dependencies for project com.alibaba.otter:canal.parse:jar:1.0.26-SNAPSHOT: Failed to collect dependencies for [com.alibaba.otter:canal.common:jar:1.0.26-SNAPSHOT (compile)  com.alibaba.otter:canal.protocol:jar:1.0.26-SNAPSHOT (compile)  com.alibaba.otter:canal.meta:jar:1.0.26-SNAPSHOT (compile)  com.alibaba.otter:canal.sink:jar:1.0.26-SNAPSHOT (compile)  com.alibaba.otter:canal.parse.dbsync:jar:1.0.26-SNAPSHOT (compile)  com.alibaba.otter:canal.filter:jar:1.0.26-SNAPSHOT (compile)  com.alibaba.otter:canal.parse.driver:jar:1.0.26-SNAPSHOT (compile)  com.alibaba:druid:jar:1.1.9 (compile)  com.alibaba.fastsql:fastsql:jar:2.0.0_preview_135 (compile)  mysql:mysql-connector-java:jar:5.1.40 (compile)  org.apache.ibatis:ibatis-sqlmap:jar:2.3.4.726 (compile)  com.h2database:h2:jar:1.4.196 (compile)  org.apache.httpcomponents:httpclient:jar:4.5.1 (compile)  org.apache.commons:commons-compress:jar:1.9 (compile)  junit:junit:jar:4.12 (test)  org.springframework:spring-test:jar:3.2.9.RELEASE (test)]: Failed to read artifact descriptor for com.alibaba.fastsql:fastsql:jar:2.0.0_preview_135: Could not transfer artifact com.alibaba.fastsql:fastsql:pom:2.0.0_preview_135 from/to alibaba (http://code.alibabatech.com/mvn/releases/): Connection to http://code.alibabatech.com refused: Connection refused (Connection refused) -> [Help 1] [ERROR]  [ERROR] To see the full stack trace of the errors  re-run Maven with the -e switch. [ERROR] Re-run Maven using the -X switch to enable full debug logging. [ERROR]  [ERROR] For more information about the errors and possible solutions  please read the following articles: [ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/DependencyResolutionException [ERROR]  é‡æ–°æ›´æ–°ä¸€ä¸‹ä»£ç ï¼Œfastsqlä»£ç å·²ç»ä¸Šä¼ åˆ°mavenä»“åº“
555,renew an InetSocketAddress to resolve address again resolve [issue427](https://github.com/alibaba/otter/issues/427) [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=555) <br/>All committers have signed the CLA. [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=555) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=555) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=555) it.</sub> tks
554,javax.mail.AuthenticationFailedException: 526 Authentication failure ç¯å¢ƒï¼šé˜¿é‡Œäº‘ä¼ä¸šé‚®ç®±ï¼ŒSSLç«¯å£ï¼ŒSMTP è¦æ±‚ç”¨æˆ·éªŒè¯ã€‚ 2018-03-12 21:51:02.457 ERROR c.a.otter.manager.biz.common.alarm.AbstractAlarmService - send alarm [AlarmMessage[message=pid:1 nid:2 exception:canal:ZjcsToDsb:java.io.IOException: socket read timeout occured ! readSize = 4  readableBytes = 0  timeout = 16000         at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannel.read(SocketChannel.java:172)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:174)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:80)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:144)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220)         at java.lang.Thread.run(Thread.java:745) receiveKey=otterteam]] to drgoon agent error! org.springframework.mail.MailAuthenticationException: Authentication failed; nested exception is javax.mail.AuthenticationFailedException: 526 Authentication failure[0]         at org.springframework.mail.javamail.JavaMailSenderImpl.doSend(JavaMailSenderImpl.java:392) ~[spring-context-support-3.1.2.RELEASE.jar:3.1.2.RELEASE]         at org.springframework.mail.javamail.JavaMailSenderImpl.send(JavaMailSenderImpl.java:306) ~[spring-context-support-3.1.2.RELEASE.jar:3.1.2.RELEASE]         at org.springframework.mail.javamail.JavaMailSenderImpl.send(JavaMailSenderImpl.java:296) ~[spring-context-support-3.1.2.RELEASE.jar:3.1.2.RELEASE]         at com.alibaba.otter.manager.biz.common.alarm.DefaultAlarmService.doSendMail(DefaultAlarmService.java:62) ~[manager.biz-4.2.16-SNAPSHOT.jar:na]         at com.alibaba.otter.manager.biz.common.alarm.DefaultAlarmService.doSend(DefaultAlarmService.java:52) ~[manager.biz-4.2.16-SNAPSHOT.jar:na]         at com.alibaba.otter.manager.biz.common.alarm.AbstractAlarmService.sendAlarmInternal(AbstractAlarmService.java:60) [manager.biz-4.2.16-SNAPSHOT.jar:na]         at com.alibaba.otter.manager.biz.common.alarm.AbstractAlarmService.access$000(AbstractAlarmService.java:38) [manager.biz-4.2.16-SNAPSHOT.jar:na]         at com.alibaba.otter.manager.biz.common.alarm.AbstractAlarmService$1.run(AbstractAlarmService.java:77) [manager.biz-4.2.16-SNAPSHOT.jar:na]         at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471) [na:1.7.0_79]         at java.util.concurrent.FutureTask.run(FutureTask.java:262) [na:1.7.0_79]         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145) [na:1.7.0_79]         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615) [na:1.7.0_79]         at java.lang.Thread.run(Thread.java:745) [na:1.7.0_79] Caused by: javax.mail.AuthenticationFailedException: 526 Authentication failure[0]         at com.sun.mail.smtp.SMTPTransport$Authenticator.authenticate(SMTPTransport.java:826) ~[mail-1.4.7.jar:1.4.7]         at com.sun.mail.smtp.SMTPTransport.authenticate(SMTPTransport.java:761) ~[mail-1.4.7.jar:1.4.7]         at com.sun.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:685) ~[mail-1.4.7.jar:1.4.7]         at javax.mail.Service.connect(Service.java:295) ~[mail-1.4.7.jar:1.4.7]         at org.springframework.mail.javamail.JavaMailSenderImpl.doSend(JavaMailSenderImpl.java:389) ~[spring-context-support-3.1.2.RELEASE.jar:3.1.2.RELEASE]         ... 12 common frames omitted JavaMailSenderImplåªè°ƒé€šäº†163å’Œgmailï¼Œå…¶ä»–çš„éœ€è¦åšä¸€äº›è°ƒè¯•
553,ä¿®æ”¹ï¼šä¼˜åŒ–åœ¨é»˜è®¤ç¼“å­˜å¤§å°ä¸å¤Ÿç”¨æ—¶è‡ªåŠ¨æ¸…ç†æˆ–æ‰©å……å†…å­˜ï¼Œå°½é‡é¿å…é¢‘ç¹åˆ†é…æˆ–ç§»åŠ¨å†…å­˜ï¼Œæ§åˆ¶å†…å­˜æœ€å¤§åˆ†é…ç©ºé—´æˆ–å¼‚å¸¸è‡ªæ„ˆã€‚æ‰€æœ‰è¿™äº›æ£€æŸ¥å’Œå¤„ç†éƒ½åœ¨å†™ç¼“å­˜çº¿ç¨‹ä¸­è¿›è¡Œã€‚ ä¿®å¤ï¼šåœ¨â€œåŒæ­¥ç®¡ç†â€ä¸­åœç”¨Channelæ—¶å¯èƒ½ä¼šå¯¼è‡´ç›¸å…³Nodeè¿›ç¨‹å´©æºƒï¼šA fatal error has been detected by the Java Runtime Environment: EXCEPTION_ACCESS_VIOLATION (0xc0000005) æ­¤ä¸ºç»§ #536 çš„ç»§ç»­å®Œå–„ï¼Œç›®å‰å·²ç»ç¨³å®šè¿è¡Œ 4 å¤©ã€‚é…åˆ otter çš„ PRï¼Œç›®å‰å·²æ”¯æŒå¤§é™„ä»¶å¤åˆ¶ï¼ˆå®æµ‹è¶…è¿‡ 8 MB ï¼‰ã€‚ æ³¨æ„ï¼š æœ¬æ¬¡ä¿®æ”¹å¢åŠ çš„æ—¥å¿—ç¡®å®å­˜åœ¨ #548 ä¸­æåˆ°çš„é”™ä½ç°è±¡ï¼Œåˆšæ¥è§¦ canal è¿˜ä¸ç”šäº†è§£ï¼Œå¾…ä¿®å¤ã€‚ ä»£ç å·²ç»æäº¤ï¼Œ-Dcanal.socketChannel=netty å¯ä»¥åˆ‡æ¢ æ”¶åˆ°ï¼Œæ„Ÿè°¢ï¼
552,bugå®åœ¨å¤ªå¤šï¼Œcanal.instance.master.positionä¸èµ·ä½œç”¨ï¼Œä¹Ÿä¸æŠ¥å‡ºä¸€ç‚¹æœ‰ç”¨çš„ä¿¡æ¯ã€‚ canal.instance.master.journal.name=mysql-bin.000001 canal.instance.master.position=1 canal.instance.master.timestamp=1509862400000  è®¾ç½®äº†åç§»é‡ä½†æ˜¯ä¸èµ·ä½œç”¨ï¼Œè¿˜æ˜¯ä»æ€»åä¸€è¡Œå¼€å§‹æ‰«æã€‚ WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position positionæœ€å°å€¼æ˜¯4
551,æ‰§è¡Œæœ‰æ³¨é‡Šçš„ddlè¯­å¥ï¼Œcanalè§£æddl eventTypeä¸ºQUERYï¼Œbinlogä¸ºrowæ¨¡å¼ï¼Œæ˜¯å¦æ˜¯bugï¼Ÿ **canalè§£æ** æ‰§è¡Œè¯­å¥ï¼ˆå¸¦æœ‰æ³¨é‡Šï¼‰ï¼š #æµ‹è¯•start #2018-02-22 #æµ‹è¯•end alter table test_2018 add loan_amount_backstage_adjust1 varchar(64) DEFAULT NULL COMMENT 'æµ‹è¯•å†…å®¹ï¼š1ï¼šæ— ï¼Œ2ï¼šæœ‰'  è§£æç»“æœï¼š eventType: QUERY isDdlï¼šfalse sql: "#\305\233\304\266\304\215\305\244\304\256\304\223start\r\n#2018-02-22\r\n#\305\233\304\266\304\215\305\244\304\256\304\223end\r\nalter table test_2018 add loan_amount_backstage_adjust varchar(64) DEFAULT NULL COMMENT \'\305\233\304\266\304\215\305\244\304\256\304\223\305\232\303\234\303\226\305\232\304\243\304\273\303\224\304\276\303\2661\303\224\304\276\303\266\305\233\303\263\342\200\240\303\224\304\276\304\2062\303\224\304\276\303\266\305\233\303\272\304\214\'" ddlSchemaName: "test" â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” æ‰§è¡Œè¯­å¥ï¼ˆæ— æ³¨é‡Šï¼‰ï¼š alter table test_2018 add loan_amount_backstage_adjust1 varchar(64) DEFAULT NULL COMMENT 'æµ‹è¯•å†…å®¹ï¼š1ï¼šæ— ï¼Œ2ï¼šæœ‰'  è§£æç»“æœï¼š eventType: ALTER isDdl: true sql: "alter table test_2018 add loan_amount_backstage_adjust1 varchar(64) DEFAULT NULL COMMENT \'\305\233\304\266\304\215\305\244\304\256\304\223\305\232\303\234\303\226\305\232\304\243\304\273\303\224\304\276\303\2661\303\224\304\276\303\266\305\233\303\263\342\200\240\303\224\304\276\304\2062\303\224\304\276\303\266\305\233\303\272\304\214\'" ddlSchemaName: "test" canalè§£æddl eventTypeä¸ºQUERYï¼Œbinlogä¸”ä¸ºrowæ¨¡å¼ï¼Œinsert update delete éƒ½æ­£å¸¸ï¼Œè¿™ä¸ªæ˜¯canalæœªè€ƒè™‘åˆ°å—? mysqlä»€ä¹ˆç‰ˆæœ¬ï¼Ÿ æ˜¯å¸¦ç€#å·çš„æ³¨é‡Šä¹ˆï¼Ÿ @agapple  æ˜¯çš„  @fefine 5.6.29 @agapple åªè¦å¸¦æœ‰#å·çš„æ³¨é‡Š è§£æeventType: QUERY  å‡çº§canalåˆ°æœ€æ–°çš„ç‰ˆæœ¬ï¼Œå¯ä»¥è§£å†³ @liuwenfeng554  æ„Ÿè§‰è¿™ä¸ªé—®é¢˜ç®—ä¸€ä¸ªå‘ï¼Œè¯·é—®å‡çº§äº†è§£å†³äº†å—ï¼Ÿ @renjin1984 æ®è¯´æ–°çš„ç‰ˆæœ¬  è¿˜ä¸å¤Ÿç¨³å®š  æš‚æ—¶æ²¡å‡  åç»­å¦‚æœæœ‰æ—¶é—´çœ‹çœ‹
550,com.alibaba.otter.canal.protocol.exception.CanalClientException: java.io.IOException: Broken pipe è¿™ä¸ªæ˜¯å®‰è£…å®Œcanalåè¿è¡Œexampleç¤ºä¾‹ä»£ç å‡ºç°çš„é—®é¢˜ com.alibaba.otter.canal.protocol.exception.CanalClientException: java.io.IOException: Broken pipe 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:296) ~[canal.client-1.0.25.jar:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:269) ~[canal.client-1.0.25.jar:na] 	at com.iwaimai.CanalTest.AbstractCanalClientTest.process(AbstractCanalClientTest.java:116) ~[classes/:na] 	at com.iwaimai.CanalTest.AbstractCanalClientTest$2.run(AbstractCanalClientTest.java:83) [classes/:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_162] Caused by: java.io.IOException: Broken pipe 	at sun.nio.ch.FileDispatcherImpl.write0(Native Method) ~[na:1.8.0_162] 	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47) ~[na:1.8.0_162] 	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93) ~[na:1.8.0_162] 	at sun.nio.ch.IOUtil.write(IOUtil.java:65) ~[na:1.8.0_162] 	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471) ~[na:1.8.0_162] 	at java.nio.channels.Channels.writeFullyImpl(Channels.java:78) ~[na:1.8.0_162] 	at java.nio.channels.Channels.writeFully(Channels.java:98) ~[na:1.8.0_162] 	at java.nio.channels.Channels.access$000(Channels.java:61) ~[na:1.8.0_162] 	at java.nio.channels.Channels$1.write(Channels.java:174) ~[na:1.8.0_162] 	at java.nio.channels.Channels$WritableByteChannelImpl.write(Channels.java:458) ~[na:1.8.0_162] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.writeWithHeader(SimpleCanalConnector.java:382) ~[canal.client-1.0.25.jar:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.writeWithHeader(SimpleCanalConnector.java:369) ~[canal.client-1.0.25.jar:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:281) ~[canal.client-1.0.25.jar:na] 	... 4 common frames omitted 10:26:39.350 [Thread-0] ERROR c.i.C.AbstractCanalClientTest - process error! com.alibaba.otter.canal.protocol.exception.CanalClientException: something goes wrong with reason: something goes wrong with channel:[id: 0x57943e05  /10.11.61.139:53053 => /10.11.61.139:11111]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: destination:example should start first 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.receiveMessages(SimpleCanalConnector.java:317) ~[canal.client-1.0.25.jar:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:294) ~[canal.client-1.0.25.jar:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:269) ~[canal.client-1.0.25.jar:na] 	at com.iwaimai.CanalTest.AbstractCanalClientTest.process(AbstractCanalClientTest.java:116) ~[classes/:na] 	at com.iwaimai.CanalTest.AbstractCanalClientTest$2.run(AbstractCanalClientTest.java:83) [classes/:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_162] 10:26:39.351 [Thread-0] ERROR c.i.C.AbstractCanalClientTest - process error! com.alibaba.otter.canal.protocol.exception.CanalClientException: something goes wrong with reason: something goes wrong with channel:[id: 0x4f01a4c1  /10.11.61.139:53054 => /10.11.61.139:11111]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: destination:example should start first 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.receiveMessages(SimpleCanalConnector.java:317) ~[canal.client-1.0.25.jar:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:294) ~[canal.client-1.0.25.jar:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:269) ~[canal.client-1.0.25.jar:na] 	at com.iwaimai.CanalTest.AbstractCanalClientTest.process(AbstractCanalClientTest.java:116) ~[classes/:na] 	at com.iwaimai.CanalTest.AbstractCanalClientTest$2.run(AbstractCanalClientTest.java:83) [classes/:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_162] 10:26:39.352 [Thread-0] ERROR c.i.C.AbstractCanalClientTest - process error! com.alibaba.otter.canal.protocol.exception.CanalClientException: something goes wrong with reason: something goes wrong with channel:[id: 0x7e3c718f  /10.11.61.139:53055 => /10.11.61.139:11111]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: destination:example should start first 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.receiveMessages(SimpleCanalConnector.java:317) ~[canal.client-1.0.25.jar:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:294) ~[canal.client-1.0.25.jar:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:269) ~[canal.client-1.0.25.jar:na] 	at com.iwaimai.CanalTest.AbstractCanalClientTest.process(AbstractCanalClientTest.java:116) ~[classes/:na] 	at com.iwaimai.CanalTest.AbstractCanalClientTest$2.run(AbstractCanalClientTest.java:83) [classes/:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_162] å®¢æˆ·ç«¯åšä¸€ä¸‹é‡è¯• å‡çº§ä¸€ä¸‹26ç‰ˆæœ¬
549,è§£æå‡ºé”™ï¼Œæ±‚å¸®åŠ©ã€‚ 2018-03-07 16:33:44.617 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TABLE `procs_priv` (   `Host` char(60) COLLATE utf8_bin NOT NULL DEFAULT ''   `Db` char(64) COLLATE utf8_bin NOT NULL DEFAULT ''   `User` char(16) COLLATE utf8_bin NOT NULL DEFAULT ''   `Routine_name` char(64) CHARACTER SET utf8 NOT NULL DEFAULT ''   `Routine_type` enum('FUNCTION' 'PROCEDURE') COLLATE utf8_bin NOT NULL   `Grantor` char(77) COLLATE utf8_bin NOT NULL DEFAULT ''   `Proc_priv` set('Execute' 'Alter Routine' 'Grant') CHARACTER SET utf8 NOT NULL DEFAULT ''   `Timestamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP   PRIMARY KEY (`Host` `Db` `User` `Routine_name` `Routine_type`)   KEY `Grantor` (`Grantor`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='Procedure privileges' com.alibaba.druid.sql.parser.ParserException: syntax error  error in :'RE') COLLATE utf8_bin NOT NULL   `'  expect RPAREN  actual IDENTIFIER pos 313  line 6  column 47  token IDENTIFIER COLLATE         at com.alibaba.druid.sql.parser.SQLParser.printError(SQLParser.java:284) ~[druid-1.1.8.jar:1.1.8]         at com.alibaba.druid.sql.parser.SQLParser.accept(SQLParser.java:292) ~[druid-1.1.8.jar:1.1.8]         at com.alibaba.druid.sql.dialect.mysql.parser.MySqlCreateTableParser.parseCreateTable(MySqlCreateTableParser.java:217) ~[druid-1.1.8.jar:1.1.8]         at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseCreate(MySqlStatementParser.java:243) ~[druid-1.1.8.jar:1.1.8]         at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:161) ~[druid-1.1.8.jar:1.1.8]         at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:72) ~[druid-1.1.8.jar:1.1.8]         at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:464) ~[druid-1.1.8.jar:1.1.8]         at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:297) ~[druid-1.1.8.jar:1.1.8]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:71) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-03-07 16:33:44.801 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /127.0.0.1:3306 has an error  retrying. caused by java.lang.NullPointerException: null         at com.alibaba.druid.sql.dialect.mysql.visitor.MySqlOutputVisitor.visit(MySqlOutputVisitor.java:611) ~[druid-1.1.8.jar:1.1.8]         at com.alibaba.druid.sql.ast.expr.SQLCharExpr.accept0(SQLCharExpr.java:50) ~[druid-1.1.8.jar:1.1.8]         at com.alibaba.druid.sql.ast.SQLObjectImpl.accept(SQLObjectImpl.java:41) ~[druid-1.1.8.jar:1.1.8]         at com.alibaba.druid.sql.dialect.mysql.visitor.MySqlOutputVisitor.visit(MySqlOutputVisitor.java:275) ~[druid-1.1.8.jar:1.1.8]         at com.alibaba.druid.sql.ast.statement.SQLColumnDefinition.accept0(SQLColumnDefinition.java:167) ~[druid-1.1.8.jar:1.1.8]         at com.alibaba.druid.sql.ast.SQLObjectImpl.accept(SQLObjectImpl.java:41) ~[druid-1.1.8.jar:1.1.8]         at com.alibaba.druid.sql.visitor.SQLASTOutputVisitor.printTableElements(SQLASTOutputVisitor.java:2567) ~[druid-1.1.8.jar:1.1.8]         at com.alibaba.druid.sql.dialect.mysql.visitor.MySqlOutputVisitor.visit(MySqlOutputVisitor.java:457) ~[druid-1.1.8.jar:1.1.8]         at com.alibaba.druid.sql.dialect.mysql.ast.statement.MySqlCreateTableStatement.accept0(MySqlCreateTableStatement.java:89) ~[druid-1.1.8.jar:1.1.8]         at com.alibaba.druid.sql.dialect.mysql.ast.statement.MySqlCreateTableStatement.accept0(MySqlCreateTableStatement.java:82) ~[druid-1.1.8.jar:1.1.8]         at com.alibaba.druid.sql.ast.SQLObjectImpl.accept(SQLObjectImpl.java:41) ~[druid-1.1.8.jar:1.1.8]         at com.alibaba.druid.sql.dialect.mysql.ast.statement.MySqlCreateTableStatement.output(MySqlCreateTableStatement.java:359) ~[druid-1.1.8.jar:1.1.8]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.snapshot(MemoryTableMeta.java:138) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.applySnapshotToDB(DatabaseTableMeta.java:241) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:129) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at java.lang.Thread.run(Thread.java:748) [na:1.8.0_161] 2018-03-07 16:33:44.802 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.lang.NullPointerException         at com.alibaba.druid.sql.dialect.mysql.visitor.MySqlOutputVisitor.visit(MySqlOutputVisitor.java:611)         at com.alibaba.druid.sql.ast.expr.SQLCharExpr.accept0(SQLCharExpr.java:50)         at com.alibaba.druid.sql.ast.SQLObjectImpl.accept(SQLObjectImpl.java:41)         at com.alibaba.druid.sql.dialect.mysql.visitor.MySqlOutputVisitor.visit(MySqlOutputVisitor.java:275)         at com.alibaba.druid.sql.ast.statement.SQLColumnDefinition.accept0(SQLColumnDefinition.java:167)         at com.alibaba.druid.sql.ast.SQLObjectImpl.accept(SQLObjectImpl.java:41)         at com.alibaba.druid.sql.visitor.SQLASTOutputVisitor.printTableElements(SQLASTOutputVisitor.java:2567)         at com.alibaba.druid.sql.dialect.mysql.visitor.MySqlOutputVisitor.visit(MySqlOutputVisitor.java:457)         at com.alibaba.druid.sql.dialect.mysql.ast.statement.MySqlCreateTableStatement.accept0(MySqlCreateTableStatement.java:89)         at com.alibaba.druid.sql.dialect.mysql.ast.statement.MySqlCreateTableStatement.accept0(MySqlCreateTableStatement.java:82)         at com.alibaba.druid.sql.ast.SQLObjectImpl.accept(SQLObjectImpl.java:41)         at com.alibaba.druid.sql.dialect.mysql.ast.statement.MySqlCreateTableStatement.output(MySqlCreateTableStatement.java:359)         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.snapshot(MemoryTableMeta.java:138)         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.applySnapshotToDB(DatabaseTableMeta.java:241)         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:129)         at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170)         at java.lang.Thread.run(Thread.java:748) ] druidæš‚æ—¶ä¸æ”¯æŒenumç±»å‹ï¼Œå·²æäº¤issue https://github.com/alibaba/canal/releases/tag/canal-1.0.26-preview-2ï¼Œä½¿ç”¨è¿™ä¸ªç‰ˆæœ¬çš„åŒ…è¯•è¯•
548,å¯¹äºbinlog dumpæœ¬èº«å°±æ˜¯é˜»å¡å¼çš„è¯»å†™ï¼Œä½¿ç”¨æ›´ç®€å•çš„BIO è¿™ä¸ªprä¼šè¦†ç›–å…¶ä»–opençš„pr 536ï¼Œ539ã€‚ æœ€è¿‘è¿›è¡Œçš„æµ‹è¯•ï¼Œå‘ç°äº†SocketChannelçš„ä¸€äº›å…¶ä»–é—®é¢˜ï¼š åœ¨æ„å»ºæ–°SocketChannelæ—¶ï¼ŒEventLoopGroupè°ƒnext()å°±è¿‘åˆ†é…EventLoopè¿›è¡Œæ³¨å†Œï¼Œç»è¿‡é•¿æ—¶é—´è¿è¡Œï¼ŒæŸä¸€ä¸ªinstanceçš„channelå¦‚æœæœŸé—´ä¸­æ–­è¿‡å¤šæ¬¡ï¼Œå¯èƒ½roundåˆ°ä¸€ä¸ªå…¶ä»–instanceçš„channelæ³¨å†Œçš„EventLoopã€‚ç”±äºæ²¡æœ‰åœ¨è®°å½•logå‰åè®¾ç½®MDCï¼Œæ—¥å¿—ä¼šè®°åˆ°å…¶ä»–instanceçš„æ—¥å¿—æ–‡ä»¶ä¸­ã€‚å¤šä¸ªchannelå…±äº«ä¸€ä¸ªEventLoopï¼Œè½®æµä½¿ç”¨æ—¶é—´ç‰‡ä¼šä½¿è¯»æ€§èƒ½å˜å·®ï¼ˆå¦‚æœæ¶ˆè´¹çš„å¿«ï¼‰ã€‚ BIOä½¿ç”¨è¾ƒå°çš„SO_TIMEOUT(1s)ï¼Œå¤„ç†é—ªæ–­å’Œinterruptã€‚ å…¶ä»–æ”¹åŠ¨ï¼šREAD_TIMEOUT_MILLISECONDSä¿®æ”¹ä¸º(MASTER_HEARTBEAT_PERIOD_SECONDS + 10) * 1000. +1sçš„æƒ…å†µï¼Œåœ¨ä¸€ä¸ªinstanceæ— trafficæ”¾ç½®ä¸€å¤©çš„æµ‹è¯•ä¸­ï¼Œå‡ºç°äº†å‡ æ¬¡è¯»å–header timeoutï¼Œé¢‘ç‡å¤§è‡´å‡ å°æ—¶ä¸€æ¬¡ã€‚ @lcybo ä¸çŸ¥ #547 çš„é—®é¢˜æ˜¯ä¸æ˜¯å’Œè¿™ä¸ªä¹Ÿæœ‰å…³ç³»ï¼Ÿ @lcybo æ ¹æ®ä½ ä¹‹å‰çš„å»ºè®®ï¼Œæˆ‘å¯¹ #536 çš„ä¿®æ”¹ç¨ä½œè°ƒæ•´ã€‚æˆ‘è§‰å¾—å¼‚æ­¥æ¨¡å¼ä¹Ÿä¸é”™çš„ï¼Œè¯»å†™å¯ä»¥å¼‚æ­¥è¿›è¡Œã€‚ @wingerx åˆ°æ—¶å€™å¯¹åŒæ­¥å’Œå¼‚æ­¥æ¨¡å¼åˆ†åˆ«å‹æµ‹ä¸€ä¸‹è¯•è¯•ã€‚æœ€è¿‘å› ä¸ºå‘ç°è¿˜æœ‰å…¶å®ƒé—®é¢˜ï¼Œç­‰ç­‰å†æäº¤ã€‚ @wingerx è°¢è°¢ä½ çš„æµ‹è¯•ã€‚è¯·é—®ï¼Œå½“å‹æµ‹åœçš„æ—¶å€™canalçš„metaé‡Œçš„positionå’Œshow master status;ä¹‹é—´çš„gapæ˜¯å¤šå°‘ï¼Œdumpæ‰€ä½¿ç”¨çš„interfaceçš„ç½‘ç»œæµé‡æƒ…å†µæ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ @Wu-Jianqiang BIOå’ŒNIOå„æœ‰ä¼˜åŠ¿ï¼Œå„æœ‰é€‚ç”¨çš„åœºæ™¯ã€‚å°±MySQL dumpæ¥è¯´ï¼Œåœ¨æ¡æ‰‹æˆåŠŸï¼Œè®¢é˜…æŒ‡å®šä½ç½®ä¹‹åï¼Œcanalå•æ–¹é¢æ¥æ”¶MySQLçš„dataã€‚â€œè¯»å†™å¯ä»¥å¼‚æ­¥è¿›è¡Œâ€  netty handleré‡Œåšä»…ä»…æ˜¯å°†è¯»åˆ°çš„dataâ€˜å†™å…¥â€™cacheï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯è¯»ã€‚å¯¹äºè¿™æ ·çš„æ•°é‡æœ‰é™ï¼ˆå¸¸æ•°ï¼‰çš„é•¿è¿æ¥ï¼Œæˆ‘è®¤ä¸ºè¿˜æ˜¯ä¼ ç»ŸBIOæ›´ä¸ºé€‚åˆã€‚å¦‚æœç»§ç»­ä½¿ç”¨Nettyï¼Œè¿˜æœ‰ä¸€äº›é—®é¢˜éœ€è¦è§£å†³ï¼š å¦‚æœå¤šä¸ªchannelè¢«registeråˆ°åŒä¸€ä¸ªEventLoopï¼ˆå¤šæ¬¡ä¸­æ–­é‡æ–°è¿æ¥ï¼Œæˆ–ä¿®æ”¹io.netty.eventLoopThreadsï¼‰ï¼Œå¤šä¸ªinstanceçš„â€˜business errorâ€™æ—¥å¿—ä¼šè®°å½•åˆ°ä¸€ä¸ªinstanceä¸­ï¼Œå¹¶ä¸”ä¸€ä¸ªEventLoopåŒæ—¶å¤„ç†å¤šä¸ªchannelï¼Œåè€Œå½±å“æ€§èƒ½ã€‚å¾—å®ç°ä¸€ä¸ªEventExecutorChooserä¿è¯ä¸€ä¸ªEventLoopä¸€ä¸ªChannelã€‚è®°å½•Business erroræ—¶è¿˜éœ€è¦ç”¨MDC dispatch. ä»£ç å·²ç»åˆå¹¶äº†ï¼Œè®¾è®¡ä¸Šç›®å‰æš‚æ—¶éƒ½ä¿ç•™äº†bioå’Œnettyï¼Œæ–¹ä¾¿åšéªŒè¯å’Œå¯¹æ¯”
547,Canal Server è§£ææ€§èƒ½é—®é¢˜ ä¸çŸ¥æœ‰äººå‹æµ‹è¿‡ Canal çš„è§£ææ€§èƒ½å—ï¼Ÿç›®å‰å‹æµ‹ v1.0.26 alpha 1 (ä¸ºå±è”½å¯èƒ½æ¶ˆè´¹æ…¢çš„åŸå› ï¼Œä¿®æ”¹ä»£ç å°†event ä¸æ”¾å…¥store)ï¼Œå¼€å§‹å¤§æ¦‚æ¯ç§’å¯ä»¥decode ä¸‡çº§åˆ«çš„eventï¼Œä½†æ˜¯æŒç»­ä¸€æ®µæ—¶é—´åæ¯ç§’ä¸‹é™åˆ°ç™¾çº§åˆ«çš„event (åç»­å®šä½åˆ°æ˜¯å‹æµ‹åœçš„æ—¶å€™)ã€‚ä¸çŸ¥æœ‰äººé‡åˆ°è¿‡è¿™ä¸ªé—®é¢˜æ²¡ï¼Ÿ è¡¥ä¸Šæµ‹è¯•æ•°æ®  ï¼ˆçº¯æµ‹è¯•è§£æï¼Œå› ä¸ºä¸å­˜storeï¼Œæ•…æ— æ¶ˆè´¹ç«¯å½±å“) 1. çº¯insert åœºæ™¯æµ‹è¯• ![image](https://user-images.githubusercontent.com/33280738/36956528-cf5f270e-2069-11e8-9962-18fd16789b1a.png) 2. Canal Server æ¥æ”¶åˆ°æ•°æ® * ä½¿ç”¨ v1.0.26 ç‰ˆæœ¬çš„ SocketChannel ä¸ SocketChannelPool æµ‹è¯•æƒ…å†µ ![image](https://user-images.githubusercontent.com/33280738/36957343-b5f908fc-206e-11e8-903c-cd2a9a9e4c6f.png) å½“å‹æµ‹åœæ­¢æ—¶ï¼Œæ€§èƒ½å‡ºç°é™¡é™(æ­¤æ—¶event å¹¶æ²¡æœ‰åŒæ­¥ç»“æŸ): çº¢çº¿æ ‡æ³¨çš„æ˜¯å…³æ‰å‹æµ‹çš„ç¬é—´ ![image](https://user-images.githubusercontent.com/33280738/36957403-23727e86-206f-11e8-8756-808af88c7aee.png) å‹æµ‹é‡æ–°å¯åŠ¨åï¼Œæ€§èƒ½å›å‡ä½†æŠ–åŠ¨å¾ˆå¤§ï¼ŒæŒç»­ä¸€æ®µæ—¶é—´åï¼Œæ€§èƒ½å›åˆ°åœä¹‹å‰çš„çŠ¶æ€ ![image](https://user-images.githubusercontent.com/33280738/36957479-a5c07a6e-206f-11e8-9e49-bf0f3287f50b.png) ![image](https://user-images.githubusercontent.com/33280738/36957515-cde4f088-206f-11e8-9132-492a18168cdf.png) * ä½¿ç”¨ #548 @lcybo æä¾›çš„ç®€å•BIO ç‰ˆæœ¬çš„ SocketChannel ä¸ SocketChannelPool æµ‹è¯•æƒ…å†µ ![image](https://user-images.githubusercontent.com/33280738/36957583-44780c9e-2070-11e8-990f-3fb942380ff2.png) å½“å‹æµ‹åœæ­¢æ—¶ï¼Œæ€§èƒ½å‡ºç°æå‡(è¿™ä¸ªç°è±¡å’ŒMySQL slave è§‚å¯Ÿåˆ°çš„ç½‘ç»œæµé‡ç°è±¡ä¸€è‡´): ![image](https://user-images.githubusercontent.com/33280738/36957655-d170aa5c-2070-11e8-8313-3bd71242fc90.png) æ˜¯å¦è¿™ä¹ˆä¸€ä¸ªç»“è®ºï¼ŒåŸºäºBIOæ¨¡å¼çš„è¯»å–ï¼Œæ€§èƒ½æ›´åŠ ç¨³å®šï¼Ÿ @wingerx PRäº†å¼‚æ­¥ä¿®å¤ç‰ˆ #553 ï¼Œæœ‰ç©ºå†è¯•è¯•ï¼
546,canalserverå‡çº§åˆ°1.0.25å¯åŠ¨å‡ºç°create connection SQLException 2018-03-02 16:10:49.030 [Druid-ConnectionPool-Create-124634922] ERROR com.alibaba.druid.pool.DruidDataSource - create connection SQLException  url:   errorCode 0  state null java.sql.SQLException: connect error  url   driverClass org.h2.Driver         at com.alibaba.druid.pool.DruidAbstractDataSource.createPhysicalConnection(DruidAbstractDataSource.java:1579) ~[druid-1.1.6.jar:1.1.6]         at com.alibaba.druid.pool.DruidDataSource$CreateConnectionThread.run(DruidDataSource.java:2450) ~[druid-1.1.6.jar:1.1.6] å¯åŠ¨æ—¶ä¼šåˆå§‹åŒ–ä¸€ä¸ªåµŒå…¥å¼çš„H2å†…å­˜æ•°æ®åº“ï¼Œçœ‹çœ‹å¯åŠ¨å¤±è´¥çš„å…·ä½“åŸå› å§
545,[question]è¯·é—® canal å¯ä»¥è®¢é˜…ä»åº“çš„ binlogå—ï¼Ÿ canal æ˜¯ä»¥ä»åº“çš„è§’è‰²å¯¹ä¸»åº“è®¢é˜… bin-logï¼Œç°åœ¨æˆ‘æœ‰ä¸¤ä¸ªç–‘é—®ï¼š 1.canal æ˜¯å¦æ”¯æŒè®¢é˜…ä»åº“çš„bin-logï¼Ÿ 2.canal è®¢é˜…ä¸»åº“çš„ bin-log å¯¹ä¸»åº“çš„æ€§èƒ½æŸè€—ï¼Œæ˜¯å¦æœ‰å¿…è¦è¿ç§»åˆ°è®¢é˜…ä»åº“bin-logï¼Ÿ æœ‰å“ªä½è¯•éªŒè¿‡è®¢é˜…ä»åº“bin-logçš„ï¼Œå¸®å¸®å¿™åˆ†æä¸‹ï¼Œè°¢è°¢äº†ã€‚ canal æ˜¯å¦æ”¯æŒè®¢é˜…ä»åº“çš„bin-logï¼Ÿæˆ‘ä¹Ÿæƒ³çŸ¥é“è¿™ä¸ªé—®é¢˜ã€‚ ç›®å‰æˆ‘ä»¬æœ‰ä¸€ä¸ªéœ€æ±‚æ˜¯æŠŠå¾ˆå¤šä¸åŒåŒºåŸŸçš„åº“åŒæ­¥åˆ°ä¸€ä¸ªæ€»åº“ï¼Œä¹Ÿåœ¨è€ƒè™‘canalæ€ä¹ˆç”¨ä¸€ä¸ªå®¢æˆ·ç«¯ç›‘å¬å¤šä¸ªæœåŠ¡ç«¯çš„é—®é¢˜ã€‚ ç›®å‰çœ‹exampleé‡Œé¢çš„é›†ç¾¤å®¢æˆ·ç«¯æ˜¯ä¸€ç§ä¸»å¤‡æ¨¡å¼ï¼Œä¹Ÿä¸æ»¡è¶³è¿™ç§éœ€æ±‚ã€‚ ä½†æ˜¯å¦‚æœå¯åŠ¨å¤šä¸ªCanalConnectorsåº”è¯¥å¯ä»¥è§£å†³å§ã€‚ @yookacn ä½ æ˜¯æƒ³ä¸€ä¸ªcanal-serverï¼Œè®¢é˜…å¤šä¸ªmasterå®ä¾‹å—ï¼Ÿ å¦‚æœæ˜¯ï¼Œå¯ä»¥ä½¿ç”¨defaultæ¨¡å¼ï¼Œé…ç½®å¤šä¸ªdestinationã€‚å°±å¯ä»¥å®ç°äº†ã€‚ @smileMrLeeè°¢è°¢ç›¸å‘Šï¼Œæˆ‘ä¹‹å‰è¿˜æ²¡è€ƒè™‘åˆ°ä»æœåŠ¡ç«¯è®¢é˜…å¤šä¸ªå®ä¾‹ï¼Œç¿»äº†ä¸€ä¸‹ä»£ç æ‰¾åˆ°äº†ã€‚è¿™ä¸ªå¯ä»¥æ»¡è¶³æˆ‘çš„éœ€æ±‚ã€‚
544,canalæ— æ³•å¯åŠ¨ mysqlç‰ˆæœ¬:5.6.39  ä½¿ç”¨canalç‰ˆæœ¬1.0.25 å¦‚ä¸‹ è¯¦ç»†æè¿°ä¸‹:ä½¿ç”¨mysqlç‰ˆæœ¬:5.6.39  ä½¿ç”¨canalç‰ˆæœ¬1.0.25 ç°è±¡: ![image](https://user-images.githubusercontent.com/5006160/36886406-31d37966-1e27-11e8-8c9d-a4832afb76c5.png) canalå¯åŠ¨çš„æ—¶å€™ é€šè¿‡jstackå‘ç°å µå¡åœ¨è¿™ä¸€è¡Œ. ç¿»äº†ä¸‹ä»£ç : ![image](https://user-images.githubusercontent.com/5006160/36886423-4a49d81e-1e27-11e8-8da3-5b3e2b0a21a0.png) è¿™é‡Œå°±è¿æ¥ä¸ä¸Šäº† ä¸€ç›´é˜»å¡ ä¸å¯èƒ½æ˜¯æƒé™é—®é¢˜ å› ä¸ºå·²ç»å°†binlogçš„ä½ç½®éƒ½è¯»å‡ºæ¥äº† å¿…ç°ï¼Ÿ https://github.com/alibaba/canal/releases/tag/canal-1.0.26-preview-2ï¼Œä½¿ç”¨è¿™ä¸ªç‰ˆæœ¬çš„åŒ…è¯•è¯• å¿…ç° è¿™ä¸ªåŒ…æˆ‘è¯•è¯• è°¢è°¢ æˆ‘ä¹Ÿç¢°åˆ°è¿™ä¸ªé—®é¢˜ï¼Œæ€»æ˜¯å¡åœ¨è¯»å–ä½ç‚¹ä¹‹åçš„reconnectæˆ–è€…connectè¯»ä½ç‚¹ã€‚
543,å˜æ›´ç±»å‹ä¸ºupdateç±»å‹ï¼Œä½†æ˜¯å­—æ®µä¸­æ²¡æœ‰ä¸€ä¸ªcolumn.getUpdated()ä¸ºtrueï¼Œå…¨éƒ¨ä¸ºfalse å¦‚é¢˜ æè¿°å¤ç°åœºæ™¯
542,canalå¯åŠ¨å¤±è´¥[MysqlEventParser - ERROR ## findAsPerTimestampInSpecificLogFile has an error] æ— è®ºå¦‚ä½• æ¯æ¬¡å¯åŠ¨canaléƒ½ä¼šå¤±è´¥ ## æ•°æ®åº“é…ç½® ``` [mysqld] log_bin=mysql-bin binlog_format='ROW' server_id=1 datadir=/var/lib/mysql socket=/var/lib/mysql/mysql.sock symbolic-links=0 sql_mode=NO_ENGINE_SUBSTITUTION STRICT_TRANS_TABLES [mysqld_safe] log-error=/var/log/mysqld.log pid-file=/var/run/mysqld/mysqld.pid ``` ## mysql canalç”¨æˆ·çš„æƒé™é…ç½®(å¯ä»¥çœ‹åˆ°æƒé™æ²¡æœ‰é—®é¢˜) ``` mysql> select host user password from mysql.user  where user like '%canal%'; +-----------+-------+-------------------------------------------+ | host      | user  | password                                  | +-----------+-------+-------------------------------------------+ | %         | canal | *E3619321C1A937C46A0D8BD1DAC39F93B27D4458 | | 127.0.0.1 | canal | *E3619321C1A937C46A0D8BD1DAC39F93B27D4458 | | localhost | canal | *E3619321C1A937C46A0D8BD1DAC39F93B27D4458 | +-----------+-------+-------------------------------------------+ 3 rows in set (0.05 sec) ``` ## canal é…ç½® ``` ## mysql serverId canal.instance.mysql.slaveId=0 # position info canal.instance.master.address=127.0.0.1:3306 canal.instance.master.journal.name= canal.instance.master.position= canal.instance.master.timestamp= # table meta tsdb info canal.instance.tsdb.enable=true canal.instance.tsdb.dir=${canal.file.data.dir:../conf}/${canal.instance.destination:} canal.instance.tsdb.url=jdbc:h2:${canal.instance.tsdb.dir}/h2;CACHE_SIZE=1000;MODE=MYSQL; #canal.instance.tsdb.url=jdbc:mysql://127.0.0.1:3306/canal_tsdb canal.instance.tsdb.dbUsername=canal canal.instance.tsdb.dbPassword=canal #canal.instance.standby.address = #canal.instance.standby.journal.name = #canal.instance.standby.position =  #canal.instance.standby.timestamp =  # username/password canal.instance.dbUsername=canal canal.instance.dbPassword=canal canal.instance.defaultDatabaseName=canal_test canal.instance.connectionCharset=UTF-8 # table regex canal.instance.filter.regex=.*\\..* # table black regex canal.instance.filter.black.regex= ``` ## å¯åŠ¨canalçš„ canal.log ``` Java HotSpot(TM) 64-Bit Server VM warning: ignoring option PermSize=96m; support was removed in 8.0 Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=256m; support was removed in 8.0 Java HotSpot(TM) 64-Bit Server VM warning: UseCMSCompactAtFullCollection is deprecated and will likely be removed in a future release. 2018-03-01 12:04:36.678 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## set default uncaught exception handler 2018-03-01 12:04:36.781 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## load canal configurations 2018-03-01 12:04:36.783 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## start the canal server. 2018-03-01 12:04:36.932 [main] INFO  com.alibaba.otter.canal.deployer.CanalController - ## start the canal server[172.17.251.157:11111] 2018-03-01 12:04:37.993 [main] WARN  o.s.beans.GenericTypeAwarePropertyDescriptor - Invalid JavaBean property 'connectionCharset' being accessed! Ambiguous write methods found next to actually used [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.nio.charset.Charset)]: [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.lang.String)] 2018-03-01 12:04:38.661 [main] ERROR com.alibaba.druid.pool.DruidDataSource - testWhileIdle is true  validationQuery not set 2018-03-01 12:04:39.284 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## the canal server is running now ...... 2018-03-01 12:04:40.265 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just show master status 2018-03-01 12:04:43.385 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - ERROR ## findAsPerTimestampInSpecificLogFile has an error java.io.IOException: connect /127.0.0.1:3306 failure         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:74) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.reconnect(MysqlConnector.java:83) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.reconnect(MysqlConnection.java:76) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findAsPerTimestampInSpecificLogFile(MysqlEventParser.java:713) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findEndPositionWithMasterIdAndTimestamp(MysqlEventParser.java:373) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPositionInternal(MysqlEventParser.java:428) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPosition(MysqlEventParser.java:347) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:164) [canal.parse-1.0.26-SNAPSHOT.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.8.0_91] Caused by: java.io.IOException: socket read timeout occured !         at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannel.read(SocketChannel.java:78) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.readHeader(PacketManager.java:18) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.negotiate(MysqlConnector.java:150) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:71) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na]         ... 8 common frames omitted 2018-03-01 12:04:43.390 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /127.0.0.1:3306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: can't find start position for example 2018-03-01 12:04:43.398 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: can't find start position for example ] 2018-03-01 12:05:05.951 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /127.0.0.1:3306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: connect /127.0.0.1:3306 failure Caused by: java.io.IOException: connect /127.0.0.1:3306 failure         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:74) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:72) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:87) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:160) ~[canal.parse-1.0.26-SNAPSHOT.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.8.0_91] Caused by: java.io.IOException: socket read timeout occured !         at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannel.read(SocketChannel.java:78) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.readHeader(PacketManager.java:18) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.negotiate(MysqlConnector.java:150) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:71) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na]         ... 4 common frames omitted 2018-03-01 12:05:05.952 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: connect /127.0.0.1:3306 failure Caused by: java.io.IOException: connect /127.0.0.1:3306 failure         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:74)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:72)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:87)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:160)         at java.lang.Thread.run(Thread.java:745) Caused by: java.io.IOException: socket read timeout occured !         at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannel.read(SocketChannel.java:78)         at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.readHeader(PacketManager.java:18)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.negotiate(MysqlConnector.java:150)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:71)         ... 4 more ] ``` me too mysql 5.7.19 https://github.com/alibaba/canal/releases/tag/canal-1.0.26-preview-2ï¼Œä½¿ç”¨è¿™ä¸ªç‰ˆæœ¬çš„åŒ…è¯•è¯• @snailbing è¯·é—®é—®é¢˜è§£å†³äº†æ²¡æœ‰å•Š 
541,canal1.0.25 åœ¨zookeeper ä¸­ä¸åˆ›å»º cursor  ä¸æ›´æ–°binlogä½ç½®ä¿¡æ¯ å¼€å§‹ä½¿ç”¨çš„æ˜¯ canal_1.0.24    zk_3.4.10ä¸­æœ‰cursor èŠ‚ç‚¹ï¼Œä¹Ÿæœ‰binlogä½ç½®ä¿¡æ¯(mysql_5.7.20)ï¼Œ ä½†æ˜¯ä¸æ›´æ–°zkä¸­çš„binlogä½ç½®ä¿¡æ¯ã€‚åæ¥å‡çº§åˆ°canal_1.0.25 è¿˜æ˜¯ä¸æ›´æ–°ï¼Œ ç„¶åæ‰‹åŠ¨åˆ é™¤äº† zk ä¸‹çš„ /otter ç›®å½•ï¼Œ é‡æ–°å¯åŠ¨canal ç»“æœéƒ½ä¸åˆ›å»º cursor èŠ‚ç‚¹ã€‚  é…ç½®è¿‡ç¨‹å‚è€ƒ https://github.com/alibaba/canal/wiki/AdminGuide  åœ°å€ä¸­å†™çš„ã€‚ 1.0.25+ç‰ˆæœ¬ä¹‹åé»˜è®¤å¯åŠ¨æ—¶ï¼Œä¼šæœ‰ä¸€ä¸ªå®šä½ä½ç‚¹çš„è¿‡ç¨‹ï¼Œhttps://github.com/alibaba/canal/releases/tag/canal-1.0.26-preview-2ï¼Œä½¿ç”¨è¿™ä¸ªç‰ˆæœ¬çš„åŒ…è¯•è¯•
540,groupæ¨¡å¼ä¸‹æœ‰æ—¶å€™æ•°æ®åº“æ•°æ®å˜åŠ¨æ— æ³•è¯»å– åœºæ™¯:ä¸¤å°æœºå™¨  æœºå™¨ä¸€ ï¼šéƒ¨ç½²canal server å’Œmysql1 æœºå™¨äºŒï¼šéƒ¨ç½² mysql2 instance.propertieså†…å®¹å¦‚ä¸‹ canal.instance.master1.address=127.0.0.1:3306 canal.instance.master2.address=host2:3306 éƒ¨ç½²äº†canal serverçš„é‚£å°æœºå™¨æ•°æ®åº“å˜åŠ¨æ— æ³•è¯»å–åˆ° å¦‚æœinstance.propertiesä¿®æ”¹ä¸º canal.instance.master1.address=host1:3306 canal.instance.master2.address=host2:3306 åˆ™å¯ä»¥æ­£ç¡®è¯»å–  ä¸çŸ¥é“æ˜¯æˆ‘é…ç½®é—®é¢˜ è¿˜æ˜¯ä»£ç bug åŸºæœ¬æœªç¯å¢ƒé—®é¢˜
539,å¯¹äºPR#536ä¸­é—®é¢˜çš„ä¸€ä¸ªç®€å•äº›çš„æ”¹åŠ¨ è¯¦æƒ…è¯·è§issue[#537](https://github.com/alibaba/canal/issues/537) æ”¯æŒäº†ä¸‹nettyå’Œbioä¸¤ç§æ¨¡å¼ï¼Œæä¾›canal.socketChannel=bio/nettyè¿›è¡Œåˆ‡æ¢ï¼Œé»˜è®¤é€‰æ‹©äº†bioæ¨¡å¼.  ä¹‹å‰æœ€æ—©ä¹Ÿæ˜¯ä½¿ç”¨bioçš„æ¨¡å¼ï¼Œé’ˆå¯¹é•¿é“¾æ¥é¢å‘é«˜ååçš„åœºæ™¯ï¼Œbioæ¨¡å¼ä¼šæ¯”è¾ƒæœ‰ä¼˜åŠ¿ï¼Œä¹‹å‰ä¸»è¦æ˜¯æ— æ³•è§£å†³é“¾æ¥å‡æ­»çš„é—®é¢˜ å’Œä¸»å¹²ä»£ç å†²çªæ¯”è¾ƒå¤šäº†ï¼Œäººè‚‰åˆå¹¶äº†ä»£ç ï¼Œä¸‹æ¬¡æäº¤PRä¹‹å‰å¯ä»¥åˆä¸€ä¸‹masterä»£ç 
538,rdsä¸­å¯¹binlogä¿ç•™å¤šä¹…ï¼Ÿ **å¦‚é¢˜** ä»Šå¤©åœ¨é‡ç½®æ¶ˆè´¹ç‚¹çš„æ—¶å€™ï¼Œå‡ºç°æ‰¾ä¸åˆ°æ¶ˆè´¹ç‚¹çš„æƒ…å†µï¼Œä½†æˆ‘åªæ˜¯é‡ç½®åˆ°6å°æ—¶å‰è€Œå·²ã€‚ã€‚ã€‚ é»˜è®¤åº”è¯¥æ˜¯ä¿å­˜18ä¸ªå°æ—¶
537,SocketChannelä¸­cacheçš„ä¸€äº›é—®é¢˜ ä½œè€…ä½ å¥½ï¼ æœ€è¿‘é¡¹ç›®ä¹Ÿé‡åˆ°äº†pr[#487](https://github.com/alibaba/canal/pull/487)ä¸­çš„é—®é¢˜ï¼Œå¦‚æœclientæ¶ˆè´¹ä¸å¤Ÿå¿«ï¼Œcanal serverä¼šå°†directByteBufæ‰©å®¹åˆ°æº¢å‡ºã€‚ pr[#487](https://github.com/alibaba/canal/pull/487)ç¡®å®èƒ½è§£å†³é—®é¢˜ï¼Œä½†ä¼šå¼•å‘å‡ºpr[#536](https://github.com/alibaba/canal/pull/536)çš„é—®é¢˜ã€‚ pr[#536](https://github.com/alibaba/canal/pull/536) æœ‰ç‚¹é—®é¢˜ï¼š 1. MASTER_HEARTBEAT_PERIODåœ¨ä½¿ç”¨change master toè¯­å¥æ—¶çš„å•ä½æ‰æ˜¯ç§’ï¼Œcanalä¸èƒ½ä½¿ç”¨change master toåªèƒ½ç”¨set @MASTER_HEARTBEAT_PERIODï¼Œå•ä½æ˜¯çº³ç§’ï¼Œå¯ä»¥æµ‹è¯•ä¸€ä¸‹ã€‚ 2. åœ¨è¯»çš„æ—¶å€™åŠ¨æ€å»æ ¹æ®packetSizeå»è°ƒæ•´ByteBufï¼Œé€»è¾‘æ¯”è¾ƒå¤æ‚ã€‚å…¶å®å¯ä»¥æ ¹æ®maxThreeBytes(ç•¥å°äº16M)ç›´æ¥è®¾ç½®åˆå§‹capacityï¼Œç»“åˆpr[#487](https://github.com/alibaba/canal/pull/487)å°±å¯ä»¥äº†ã€‚ å‚è§pr[#539](https://github.com/alibaba/canal/pull/539) BTWï¼Œdumpçº¿ç¨‹ä½¿ç”¨netty+nioè®©è¿™é‡Œçš„ä»£ç å¤æ‚åŒ–äº†ã€‚ç›´æ¥ç”¨InputStreamï¼Œç„¶åè®¾ç½®ä¸€ä¸ªè¾ƒçŸ­çš„SO_TIMEOUTï¼Œæ¯”å¦‚1ç§’ 1. å¯¹äºä¸­æ–­çš„åœºæ™¯ï¼š try {      return in.read(bytes  index  length); } catch (SocketTimeoutException e) {      //æ¯ä¸ª1sæ£€æŸ¥çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ } 2. å¯¹äºéœ€è¦timeoutçš„åœºæ™¯ï¼š try {      return in.read(bytes  index  length); } catch (SocketTimeoutException e) {      //å’Œç°åœ¨çš„å®ç°ç±»ä¼¼ï¼Œåˆ¤æ–­accumulatedWaitTime+SO_TIMEOUTæ˜¯å¦è¶…è¿‡real timeout } è¿™æ ·å¯ä»¥åº”å¯¹ä¸­æ–­åœºæ™¯å’Œé—ªæ–­é˜»å¡çš„é—®é¢˜äº†ï¼Œå®ç°ä¹Ÿä¼šæ¯”è¾ƒç®€å•ï¼ˆæ„Ÿè§‰dump IOå‡ºçš„é—®é¢˜æ¯”è¾ƒå¤šï¼‰ã€‚ è¿™åªæ˜¯æˆ‘çš„proposalå“ˆã€‚ å·²ç»åˆå¹¶äº†PRä»£ç 
536,ä¸»è¦ä¿®å¤ SocketChannel é»˜è®¤ç¼“å­˜å¤§å°ï¼ˆ1MBï¼‰ä¸å¤Ÿç”¨æ—¶éœ€è‡ªåŠ¨æ‰©å……ï¼Œå¦åˆ™å°†å› ç¼“å­˜ç©ºé—´ä¸è¶³è€Œé€ æˆI/Oè¶…æ—¶å‡è±¡ é€šå¸¸å¤åˆ¶åŒ…å« CLOB/BLOB å­—æ®µç±»å‹æ•°æ®æ—¶ä¼šé­é‡è¿™ä¸ªé—®é¢˜ã€‚1.0.24ç‰ˆå¼€å§‹è¡¨ç°ä¸ºæ²¡æœ‰ä»»ä½•ååº”ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•é”™è¯¯æ—¥å¿—ã€‚å‡çº§åˆ°1.0.25ç‰ˆä¹‹åå³æŠ¥"socket read timeout occured !"é”™è¯¯ï¼Œç»™äººè¯¯ä»¥ä¸ºç½‘ç»œæˆ–è€…æ•°æ®åº“é—®é¢˜ï¼ˆå¤åˆ¶æ˜¯åœ¨ç»è¿‡å…¬ç½‘SSHè½¬å‘çš„ä¸¤ä¸ªç§ç½‘ä¹‹é—´ï¼‰ã€‚åç»è°ƒè¯•è·Ÿè¸ªå‘ç°å®è´¨æ˜¯å›ºå®š1MBç¼“å­˜å¤§å°é—®é¢˜ã€‚å®é™…è¿è¡Œæµ‹è¯•å‘ç°ä¸€æ¬¡æ€§readSizeè¾¾åˆ°15MBåŠä»¥ä¸Šã€‚æˆªæ­¢ç›®å‰çš„ 1.0.26-SNAPSHOT ç¼–è¯‘å‘å¸ƒï¼Œå·²ç¨³å®šè¿è¡Œã€‚ [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=536) <br/>All committers have signed the CLA. [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=536) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=536) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=536) it.</sub> lcyboï¼Œè°¢è°¢ä½ çš„æŒ‡æ­£ã€‚ æ ¹æ®ä½ æä¾›çš„çº¿ç´¢ï¼Œæˆ‘æœç´¢äº†ä¸‹ MySQL jdbc ä¸­ com.mysql.jdbc.MysqlIO æºç ï¼Œéƒ¨åˆ†æ‘˜å½•å¦‚ä¸‹ï¼š `        if (versionMeetsMinimum(4  0  8)) {             this.maxThreeBytes = (256 * 256 * 256) - 1;             this.useNewLargePackets = true;         } else {             this.maxThreeBytes = 255 * 255 * 255;             this.useNewLargePackets = false;         } ` çœ‹èµ·æ¥ç¡®å®å¯ä»¥ç®€å•çš„è®¾ç½®ä¸ºï¼š 16MB = 256 * 256 * 256 ä¸è¿‡æˆ‘è¿˜æ˜¯å¸Œæœ›ä»£ç ä¸­åšå¿…è¦çš„æ£€æŸ¥å’Œè¯¦ç»†æ—¥å¿—ï¼Œä¸ç„¶å¤ªçƒ§è„‘äº†ã€‚ å—¯ï¼Œå…¶å®ä¸ªäººè§‰å¾—dump IOè¿™é‡Œæ²¡æœ‰ç”¨netty NIOçš„å¿…è¦ï¼Œå‰²è£‚äº†è¯»å†™çº¿ç¨‹ï¼Œå¼•å…¥äº†ä¸å¿…è¦çš„å¤æ‚åº¦ã€‚ ç”¨BIOé€šè¿‡è®¾ç½®è¾ƒå°çš„SO_TIMEOUTè¿›è¡Œæ•æ‰å¯ä»¥è§„é¿é—ªæ–­é—®é¢˜å’Œå¤„ç†çº¿ç¨‹ä¸­æ–­åœºæ™¯ï¼Œä¹Ÿæ›´åŠ ç®€æ´ã€‚ tks
535,canal serverå¯åŠ¨æ—¶å¯¹uniquekeyæŠ¥é”™compare failed ``` 2018-02-25 10:23:39.643 [destination = example   address = rds9h7gi6v2fo2og5202.mysql.rds.aliyuncs.com/100.98.57.68:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - pls submit github issue  show create table ddl:CREATE TABLE `center_institution_admin` (   `id` bigint(20) NOT NULL AUTO_INCREMENT   `account` varchar(20) NOT NULL COMMENT 'è´¦å·'   `cinst_id` bigint(20) NOT NULL COMMENT 'æœºæ„id'   `status` int(11) DEFAULT '1' COMMENT '0:å…³é—­ 1:å¼€å¯'   `gmt_create` datetime DEFAULT CURRENT_TIMESTAMP   `gmt_modify` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP   `name` varchar(50) DEFAULT NULL COMMENT 'è´¦å·è§’è‰²åç§°'   `parent_id` bigint(20) NOT NULL DEFAULT '0' COMMENT 'çˆ¶è´¦å·ID'   `permissions` varchar(500) DEFAULT '0' COMMENT 'è´¦å·æƒé™ç '   `remark` varchar(256) DEFAULT NULL   `default_account` int(11) DEFAULT '0'   PRIMARY KEY (`id`)   UNIQUE KEY `inst_account_unique_index` (`cinst_id` `account`)   KEY `parent_id_index` (`parent_id`)   KEY `center_institution_admin_account_index` (`account`) ) ENGINE=InnoDB AUTO_INCREMENT=967573674662035553 DEFAULT CHARSET=utf8 COMMENT='ä¸­å¿ƒæœºæ„ç®¡ç†è´¦å·è¡¨'   compare failed .  db : TableMeta [schema=xiaomai  table=center_institution_admin  fileds=         FieldMeta [columnName=id  columnType=bigint(20)  nullable=false  key=true  defaultValue=null  extra=auto_increment  unique=false]         FieldMeta [columnName=account  columnType=varchar(20)  nullable=false  key=false  defaultValue=null  extra=  unique=false]         FieldMeta [columnName=cinst_id  columnType=bigint(20)  nullable=false  key=false  defaultValue=null  extra=  unique=false]         FieldMeta [columnName=status  columnType=int(11)  nullable=true  key=false  defaultValue=1  extra=  unique=false]         FieldMeta [columnName=gmt_create  columnType=datetime  nullable=true  key=false  defaultValue=CURRENT_TIMESTAMP  extra=  unique=false]         FieldMeta [columnName=gmt_modify  columnType=datetime  nullable=true  key=false  defaultValue=CURRENT_TIMESTAMP  extra=on update CURRENT_TIMESTAMP  unique=false]         FieldMeta [columnName=name  columnType=varchar(50)  nullable=true  key=false  defaultValue=null  extra=  unique=false]         FieldMeta [columnName=parent_id  columnType=bigint(20)  nullable=false  key=false  defaultValue=0  extra=  unique=false]         FieldMeta [columnName=permissions  columnType=varchar(500)  nullable=true  key=false  defaultValue=0  extra=  unique=false]         FieldMeta [columnName=remark  columnType=varchar(256)  nullable=true  key=false  defaultValue=null  extra=  unique=false]         FieldMeta [columnName=default_account  columnType=int(11)  nullable=true  key=false  defaultValue=0  extra=  unique=false] ]  mem : TableMeta [schema=xiaomai  table=center_institution_admin  fileds=         FieldMeta [columnName=id  columnType=bigint(20)  nullable=false  key=true  defaultValue=null  extra=null  unique=false]         FieldMeta [columnName=account  columnType=varchar(20)  nullable=false  key=false  defaultValue=null  extra=null  unique=true]         FieldMeta [columnName=cinst_id  columnType=bigint(20)  nullable=false  key=false  defaultValue=null  extra=null  unique=true]         FieldMeta [columnName=status  columnType=int(11)  nullable=true  key=false  defaultValue=1  extra=null  unique=false]         FieldMeta [columnName=gmt_create  columnType=datetime  nullable=true  key=false  defaultValue=CURRENT_TIMESTAMP  extra=null  unique=false]         FieldMeta [columnName=gmt_modify  columnType=datetime  nullable=true  key=false  defaultValue=CURRENT_TIMESTAMP  extra=null  unique=false]         FieldMeta [columnName=name  columnType=varchar(50)  nullable=true  key=false  defaultValue=null  extra=null  unique=false]         FieldMeta [columnName=parent_id  columnType=bigint(20)  nullable=false  key=false  defaultValue=0  extra=null  unique=false]         FieldMeta [columnName=permissions  columnType=varchar(500)  nullable=true  key=false  defaultValue=0  extra=null  unique=false]         FieldMeta [columnName=remark  columnType=varchar(256)  nullable=true  key=false  defaultValue=null  extra=null  unique=false]         FieldMeta [columnName=default_account  columnType=int(11)  nullable=true  key=false  defaultValue=0  extra=null  unique=false] ] ``` ä½¿ç”¨çš„æ˜¯ç›®å‰masteråˆ†æ”¯æœ€æ–°ä»£ç ï¼Œhttps://github.com/alibaba/canal/issues/507 çš„é—®é¢˜ä¼¼ä¹æ²¡æœ‰è§£å†³. æµ‹è¯•è¡¨ä¸­UKæ˜¯ä¸€ä¸ªè”åˆç´¢å¼•ï¼ˆ`cinst_id` `account`ï¼‰ï¼Œå› æ­¤åœ¨å•ç‹¬fieldä¸Šçš„uniqueæ ‡å¿—åº”è¯¥ä¸ºfalseï¼Œä½†memä¸­çš„æ•°æ®å¯¹äºå•ç‹¬fieldä¹Ÿä¸ºtrue é€šè¿‡desc tableè¿™æ ·çš„æ–¹å¼ï¼Œè·å–ukæ—¶é’ˆå¯¹å¤šåˆ—æƒ…å†µä¼šå‡ºç°MULçš„åˆ—ï¼Œå¯¼è‡´æ— æ³•ç²¾ç¡®è·å–å¯¹åº”çš„ukåˆ—ã€‚ä¿®å¤çš„æ–¹å¼ä½¿ç”¨show create tableè¿›è¡Œå®Œæ•´è§£æ
534,com.alibaba.otter.canal.parse.exception.CanalParseException: column size is not match for table è¿è¡Œä¸€æ®µæ—¶é—´åï¼Œåå°æ€»æ˜¯æŠ¥è¯¥é”™è¯¯ï¼Œä¸çŸ¥é“æ˜¯ä»€ä¹ˆæƒ…å†µã€‚ åšäº†ä¸‹ddlå˜æ›´ï¼Œå¯¼è‡´åˆ—ä¸åŒ¹é… ä½¿ç”¨æœ€æ–°çš„26ç‰ˆæœ¬ï¼Œå¼€å¯tsdbå¯ä»¥è§£å†³ 26ç‰ˆæœ¬äº†ï¼Œå¼€æˆ·äº†tsdbï¼Œè¿è¡Œä¸€æ®µæ—¶é—´ï¼Œè¿˜æ˜¯é‡åˆ°è¿™é—®é¢˜äº†
533, findAsPerTimestampInSpecificLogFile has an error ![qq 20180223182635](https://user-images.githubusercontent.com/2507568/36590126-8ceea370-18c8-11e8-9cfb-2175cf9535f9.png) é›†ç¾¤æ–¹å¼ï¼Œå¯åŠ¨ä¸€ä¸ªserveræˆåŠŸï¼Œå¯åŠ¨å¦ä¸€ä¸ªserveræŠ¥é”™ï¼Œå¦‚å›¾
532,fix(dbsync): json column of zero length has no value  value parsing sâ€¦ @see https://github.com/LavaCoref/canal/issues/1 [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=532) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=532) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=532) it.</sub> [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=532) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=532) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=532) it.</sub> tks
531,æƒ³é—®ä¸€ä¸‹å¦‚æœMemoryEventStoreWithBufferä¸­bufferMemUnit=16 *1024 ä¼šé€ æˆç¨‹åºè¿è¡Œä¸€æ®µæ—¶é—´åå¡ä¸»çš„æƒ…å†µå—ï¼Ÿ MemoryEventStoreWithBufferä¸­ï¼ŒbufferSize    = 16 * 1024ï¼ŒbufferMemUnit=16 *1024ï¼ŒmaxMemSize = batchSize * bufferMemUnit =  16 * 1024 * 16 *1024 ï¼Œ ç¨‹åºåœ¨æ­£å¸¸è¿è¡Œ2ä¸ªå¤šå°æ—¶åå¡ä½ï¼Œä¼šæœ‰mysqlæ•°æ®åº“ killæ‰ socket é“¾æ¥çˆ†å‡ºï¼Œæ— å…¶ä»–æ˜æ˜¾å¼‚å¸¸ ã€‚ è¯·é—®ä¸‹æ˜¯è¿™ä¸ªåŸå› å¯¼è‡´å—ï¼Ÿ bufferMemUnité»˜è®¤å€¼å¤§å°ä¸º =1024 serverçš„æœºå™¨å†…å­˜å¤šå¤§ï¼Ÿ server jvm å†…å­˜é…äº†8Gï¼ŒåŒæ­¥çš„æ•°æ®åº“ binlogæ–‡ä»¶å¤§å°ä¸€å¤©æœ‰80ä¸ªGå·¦å³ã€‚ å‘è‡ªç½‘æ˜“é‚®ç®±å¤§å¸ˆ åœ¨2018å¹´02æœˆ22æ—¥ 09:45ï¼Œfefine å†™é“: serverçš„æœºå™¨å†…å­˜å¤šå¤§ï¼Ÿ â€” You are receiving this because you authored the thread. Reply to this email directly  view it on GitHub  or mute the thread. æˆ‘è¿™è¾¹ä¹Ÿæ˜¯å‡ºç°äº†è¿™æ ·çš„é—®é¢˜  ä½†æ˜¯ä¸ç¡®å®šæ˜¯ä»€ä¹ˆåœ°æ–¹çš„ã€‚ ä½ çš„bufferMemUnit é…ç½®ä¸ºå¤šå°‘ï¼Ÿ åœ¨2018å¹´02æœˆ23æ—¥ 09:27ï¼Œfefine å†™é“: æˆ‘è¿™è¾¹ä¹Ÿæ˜¯å‡ºç°äº†è¿™æ ·çš„é—®é¢˜  ä½†æ˜¯ä¸ç¡®å®šæ˜¯ä»€ä¹ˆåœ°æ–¹çš„ã€‚ â€” You are receiving this because you authored the thread. Reply to this email directly  view it on GitHub  or mute the thread. é»˜è®¤é…ç½®ï¼ŒbufferSize = 16 * 1024ï¼ŒbufferMemUnit= 1024ï¼Œè¿™ä¸¤ä¸ªä¹˜ç§¯æ˜¯16MBï¼Œä¸åº”è¯¥å‡ºç°å†…å­˜ä¸å¤Ÿçš„é—®é¢˜ã€‚ ä½ é‚£é‡Œå¡ä½ è¡¨ç°ä¸º ä»€ä¹ˆç—‡çŠ¶ï¼Ÿ ä½ çœ‹ä¸€ä¸‹è¿™ä¸ªissue[Instanceå‡æ­»](https://github.com/alibaba/canal/issues/527) çœ‹ç€æœ‰ç‚¹åƒsocketè¶…æ—¶å¡ä¸»çš„é—®é¢˜ï¼Œå¯ä»¥å°è¯•ä¸€ä¸‹æœ€æ–°çš„1.1.1ç‰ˆæœ¬
530,è¯·é—®canalä¸æ”¯æŒrdsçš„mysql5.6ç‰ˆæœ¬ä¹ˆï¼ŸcanalV1.0.25å¯åŠ¨ä¼šæ²¡æƒé™å¼‚å¸¸ 2018-02-12 11:38:47.267 [destination = example   address = rm-xxxxx.mysql.rds.aliyuncs.com/47.206.15.124:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: ErrorPacket [errorNumber=1142  fieldCount=-1  message=SHOW command denied to user 'canal_monitor'@'122.177.246.186' for table 'db'  sqlState=42000  sqlStateMarker=#]  with command: show create table `mysql`.`columns_priv`;show create table `mysql`.`db`;show create table `mysql`.`db_view`;show create table `mysql`.`dml_health_check`;show create table `mysql`.`event`;show create table `mysql`.`failover_info`;show create table `mysql`.`func`;show create table `mysql`.`general_log`;show create table `mysql`.`ha_health_check`;show create table `mysql`.`help_category`;show create table `mysql`.`help_keyword`;show create table `mysql`.`help_relation`;show create table `mysql`.`help_topic`;show create table `mysql`.`innodb_index_stats`;show create table `mysql`.`innodb_table_stats`;show create table `mysql`.`ndb_binlog_index`;show create table `mysql`.`plugin`;show create table `mysql`.`proc`;show create table `mysql`.`procs_priv`;show create table `mysql`.`proxies_priv`;show create table `mysql`.`servers`;show create table `mysql`.`slave_master_info`;show create table `mysql`.`slave_relay_log_info`;show create table `mysql`.`slave_worker_info`;show create table `mysql`.`slow_log`;show create table `mysql`.`slow_log_view`;show create table `mysql`.`tables_priv`;show create table `mysql`.`time_zone`;show create table `mysql`.`time_zone_leap_second`;show create table `mysql`.`time_zone_name`;show create table `mysql`.`time_zone_transition`;show create table `mysql`.`time_zone_transition_type`;show create table `mysql`.`user`;show create table `mysql`.`user_view`; Caused by: java.io.IOException: ErrorPacket [errorNumber=1142  fieldCount=-1  message=SHOW command denied to user 'canal_monitor'@'122.177.246.186' for table 'db'  sqlState=42000  sqlStateMarker=#]  with command: show create table `mysql`.`columns_priv`;show create table `mysql`.`db`;show create table `mysql`.`db_view`;show create table `mysql`.`dml_health_check`;show create table `mysql`.`event`;show create table `mysql`.`failover_info`;show create table `mysql`.`func`;show create table `mysql`.`general_log`;show create table `mysql`.`ha_health_check`;show create table `mysql`.`help_category`;show create table `mysql`.`help_keyword`;show create table `mysql`.`help_relation`;show create table `mysql`.`help_topic`;show create table `mysql`.`innodb_index_stats`;show create table `mysql`.`innodb_table_stats`;show create table `mysql`.`ndb_binlog_index`;show create table `mysql`.`plugin`;show create table `mysql`.`proc`;show create table `mysql`.`procs_priv`;show create table `mysql`.`proxies_priv`;show create table `mysql`.`servers`;show create table `mysql`.`slave_master_info`;show create table `mysql`.`slave_relay_log_info`;show create table `mysql`.`slave_worker_info`;show create table `mysql`.`slow_log`;show create table `mysql`.`slow_log_view`;show create table `mysql`.`tables_priv`;show create table `mysql`.`time_zone`;show create table `mysql`.`time_zone_leap_second`;show create table `mysql`.`time_zone_name`;show create table `mysql`.`time_zone_transition`;show create table `mysql`.`time_zone_transition_type`;show create table `mysql`.`user`;show create table `mysql`.`user_view`; 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.queryMulti(MysqlQueryExecutor.java:109) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.queryMulti(MysqlConnection.java:93) 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:173) 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) 	at java.lang.Thread.run(Thread.java:748) 1. ä½ å¯ä»¥æŒ‡å®šè®¢é˜…çš„è¡¨ï¼Œè€Œä¸æ˜¯æ‰€æœ‰ 2. æˆæƒè¶³å¤Ÿå¤§çš„æƒé™ @agapple æˆ‘å·²ç»æŒ‰ä½ è¯´çš„æµ‹è¯•äº†æŒ‡å®šè®¢é˜…äº†æŸä¸ªè¡¨ï¼Œç»“æœæ˜¯ä¸€æ ·çš„é”™è¯¯ï¼Œé˜¿é‡Œäº‘rds mysql5.6ç‰ˆæœ¬æˆ‘æå·¥å•å®¢æœè¯´ä¸æ”¯æŒSHOW CREATE TABLE `mysql`.`db_view`;è¿™æ ·çš„æƒé™ï¼ˆæˆ‘ç”¨é«˜æƒé™æƒè´¦å·æ‰§è¡Œç¡®å®ä¸€ç›´æŠ¥æ²¡æƒé™ï¼‰ï¼Œæ˜¯ä¸æ˜¯è¿™æ ·å¯¼è‡´çš„å‘¢ï¼Ÿ æ˜¯çš„ï¼Œå¦‚æœä½ æ²¡æœ‰æŒ‡å®šè¡¨ï¼Œé‚£å°±æ˜¯é»˜è®¤ä¼šè®¢é˜…æ‰€æœ‰çš„è¡¨ï¼Œè®¢é˜…ä¹‹å‰ä¼šå…¨å±€æ‹¿ä¸€æ¬¡è¡¨ç»“æ„ï¼Œæ‰€ä»¥ä¼šå‡ºç°ç±»ä¼¼çš„æƒé™æŠ¥é”™
529,TimelineTransactionBarrier import CanalSinkException; Maven Compile çš„ä¸€äº› Warning - `TimelineTransactionBarrier.java` ä¸­ `import com.alibaba.otter.canal.sink.exception.CanalSinkException;` - Fix Maven Wranning: The expression ${pom.version} is deprecated. Please use ${project.version} instead. - Fix MavenWranning : 'build.plugins.plugin.version' for org.apache.maven.plugins:maven-jar-plugin is missing. [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=529) <br/>All committers have signed the CLA. [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=529) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=529) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=529) it.</sub> tks
528,Use mysql master heartbeat to detect phycial tcp connection failure. åœ¨æµ‹è¯•ç½‘ç»œnegative caseçš„æ—¶å€™ï¼Œcanal dumpçš„readä¼šä¸€ç›´é˜»å¡ã€‚ SocketChannelPoolé‡Œçš„SO_KEEPALIVEï¼Œé»˜è®¤éœ€è¦ä¸¤å°æ—¶ã€‚ å¯ä»¥å¼€å¯master heartbeat(5.5ä»¥å)ï¼Œè®©masteråœ¨ç©ºé—²æ—¶ä¸»åŠ¨ç»™canalå‘heartbeat eventï¼Œcanalå½“å‰ä¼šdropè¿™ä¸ªäº‹ä»¶ã€‚ ç»æµ‹è¯•ï¼Œé€šè¿‡set @master_heartbeat_period çš„æ—¶é—´å•ä½æ˜¯çº³ç§’ã€‚ DirectLogFetcherè°ƒç”¨å¸¦æœ‰timeoutçš„readï¼Œtimeoutæ—¶é—´è®¾ä¸ºMASTER_HEARTBEAT_PERIOD+1sï¼Œç¡®ä¿è¶…è¿‡heartbeaté—´éš”ä¹‹åå†timeoutï¼Œé˜²æ­¢è¯¯æ€ã€‚ tks
527,Instanceå‡æ­» Serverç«¯è¿è¡Œæ­£å¸¸ï¼Œä½†æ˜¯Instanceå…¨éƒ¨çº¿ç¨‹æ— å“åº”ï¼Œæ—¥å¿—ç­‰çº§å¼€å¯ä¸ºInfoï¼Œå¹¶æœªå‘ç°å¼‚å¸¸æ—¥å¿— è¿™æ˜¯Serveræ—¥å¿—ï¼š ![http://7xo1fz.com1.z0.glb.clouddn.com/server.png](http://7xo1fz.com1.z0.glb.clouddn.com/server.png) è¿™æ˜¯Instanceæ—¥å¿—ï¼š ![http://7xo1fz.com1.z0.glb.clouddn.com/server.png](http://7xo1fz.com1.z0.glb.clouddn.com/instance.png) æˆ‘åœ¨Instanceä¸­ä¹Ÿå¼€å¯äº†å¦å¤–ä¸€ä¸ªå®šæ—¶çš„çº¿ç¨‹ï¼Œä½†æ˜¯åœ¨å¡æ­»çš„æ—¶é—´å†…æ¯«æ— å“åº”ã€‚æ•°æ®åº“åœ¨ä»Šå¤©ä¸‹åˆå¹¶æ— å…¶ä»–ç‰¹æ®Šæ“ä½œã€‚ é—®ä¸€ä¸‹è¿™æœ‰å¯èƒ½æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Ÿ æ²¡æ•°æ®å˜æ›´ï¼Ÿ æœ‰ï¼Œæ•°æ®ä¸€ç›´åœ¨å˜æ›´ æˆ‘è¿™æ˜¯canal server å¯åŠ¨æ—¶æ­£å¸¸ï¼Œbinlogä¼šè¢«clientæ¶ˆè´¹æ‰ã€‚ä½†å¦‚æœå‡ ä¸ªå°æ—¶ï¼Œä¸€ç›´æ²¡æœ‰binlongäº§ç”Ÿï¼Œå†äº§ç”Ÿbinlogè¯ï¼Œserverå°±ä¸ä¼šè¯»åˆ°è¿™äº›binlogã€‚ @agapple  å¦‚æœæ²¡æœ‰æ•°æ®å˜æ›´ï¼Œéš”ä¸€æ®µæ—¶é—´instanceå°±ä¸ä¼šå†æ¶ˆè´¹binlogäº†å§ï¼Ÿ æˆ‘æµ‹è¯•çš„ç»“æœï¼Œä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œéœ€è¦enable detectingï¼Œå¹¶ä½¿ç”¨ insert retl.xdualåšä¸ºå¿ƒè·³sql. è¿˜æœ‰å…¶ä»–çš„è§£å†³æ–¹æ³•å—ï¼Ÿ ä½ ç”¨çš„æ˜¯è‡ªå·±æ‰“åŒ…çš„1.0.25ç‰ˆæœ¬ï¼Ÿ æ˜¯çš„ï¼Œä¸‹è½½çš„æºç æ‰“åŒ… @fefine ä½¿ç”¨æœ€æ–°çš„26  alpha 2ä»£ç å†è¯•è¯•ï¼Œå¯¹äºtcpåŠ äº†so_timeoutæœºåˆ¶ï¼Œå¯ä»¥å“åº”é•¿æ—¶é—´æ— binlogä½ç‚¹è¢«mysql serverä¸»åŠ¨æ–­å¼€çš„é—®é¢˜
526,is it possible that canal set with multiple mysql database source I will use canal to.. database sync.. daily  every 10minuites snapshot. but we use many mysql database servers.  I want set mltiple mysql servers as canal's input. example.  canal.instance1.master.address = 192.168.0.1:3306 <-- MYSQL A canal.instance2.master.address = 192.168.0.2:3306 <-- MYSQL B(not a slave of A) How can I set many mysql servers as canal's instance You can use group-instance.xml In the canal.properties set ***canal.instance.global.spring.xml = classpath:spring/group-instance.xml***   then update the conf/example/instance.properties  like: ``` canal.instance.master1.address=192.168.0.1:3306 canal.instance.master1.journal.name= canal.instance.master1.position=4 canal.instance.master1.timestamp= canal.instance.master2.address=192.168.0.2:3306 canal.instance.master2.journal.name=mysql-bin.000394 canal.instance.master2.position=4 canal.instance.master2.timestamp=  ``` and then update the conf/spring/group-instance.xml  like this: ``` <beans> 	<bean id="eventParser" class="com.alibaba.otter.canal.parse.inbound.group.GroupEventParser"> 		<property name="eventParsers"> 			<list> 				<ref bean="eventParser1" /> 				<ref bean="eventParser2" /> 			</list> 		</property> 	</bean> 	<bean id="eventParser1" class="com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser"> 		<!-- database1 info --> 		<property name="masterInfo"> 			<bean class="com.alibaba.otter.canal.parse.support.AuthenticationInfo"> 				<property name="address" value="${canal.instance.master1.address}" /> 				<property name="username" value="${canal.instance.dbUsername:retl}" /> 				<property name="password" value="${canal.instance.dbPassword:retl}" /> 				<property name="defaultDatabaseName" value="${canal.instance.defaultDatabaseName:retl}" /> 			</bean> 		</property> 		<property name="masterPosition"> 			<bean class="com.alibaba.otter.canal.protocol.position.EntryPosition"> 				<property name="journalName" value="${canal.instance.master1.journal.name}" /> 				<property name="position" value="${canal.instance.master1.position}" /> 				<property name="timestamp" value="${canal.instance.master1.timestamp}" /> 			</bean> 		</property> 	</bean> 	<bean id="eventParser2" class="com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser"> 		<!-- database2 info --> 		<property name="masterInfo"> 			<bean class="com.alibaba.otter.canal.parse.support.AuthenticationInfo"> 				<property name="address" value="${canal.instance.master2.address}" /> 				<property name="username" value="${canal.instance.dbUsername:retl}" /> 				<property name="password" value="${canal.instance.dbPassword:retl}" /> 				<property name="defaultDatabaseName" value="${canal.instance.defaultDatabaseName:retl}" /> 			</bean> 		</property> 		<property name="masterPosition"> 			<bean class="com.alibaba.otter.canal.protocol.position.EntryPosition"> 				<property name="journalName" value="${canal.instance.master2.journal.name}" /> 				<property name="position" value="${canal.instance.master2.position}" /> 				<property name="timestamp" value="${canal.instance.master2.timestamp}" /> 			</bean> 		</property> 	</bean> </beans> ``` That's exactly what i find. Now I will do that! Thank for your speedy answer. 
525,mysqlæ–°å¢å­—æ®µ æ–°å¢å­—æ®µåï¼Œå¯¹è¯¥å­—æ®µçš„å€¼åšä¿®æ”¹ï¼Œæ¶ˆè´¹è€…å¾—ä¸åˆ°è¿™ä¸ªå­—æ®µæ›´æ–°çš„æ¶ˆæ¯ ä½¿ç”¨æœ€æ–°ç‰ˆçš„26ç‰ˆæœ¬ï¼Œå¼€å¯TSDBçš„èƒ½åŠ›
524,åœ¨å¼€å¯binlog_rows_query_log_eventså¼€å…³åè§£æbinlogå…¨éƒ¨éƒ½æ˜¯queryç±»å‹ ç°è±¡ä¸ #517 ç›¸åŒ  åœ¨å¼€å¯binlog_rows_query_log_eventså¼€å…³åï¼Œå®¢æˆ·ç«¯æŠ“åˆ°çš„dmlè¯­å¥ä¸ºEventType.QUERY ç±»å‹ï¼Œå¹¶ä¸”rowChange.getIsDdl()ä¸ºfalseã€‚ ç”±äºé¡¹ç›®ä¸­éœ€è¦é’ˆå¯¹ddlè¯­å¥åšä¸åŒçš„å¤„ç†ï¼Œå› æ­¤æƒ³ç¡®è®¤ä¸‹ï¼Œddlè¯­å¥çš„åˆ¤æ–­æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿwikiä¸­çš„ ![](https://camo.githubusercontent.com/73b451bd00ff40ec80ed3bd4904d4052fd34fa03/687474703a2f2f646c322e69746579652e636f6d2f75706c6f61642f6174746163686d656e742f303039302f363438332f36316366313161622d313932342d333730352d386236662d6534363431316263363036612e6a7067) åˆ¤æ–­æ¡ä»¶åœ¨è¿™ç§çŠ¶å†µä¸‹æ˜¾ç„¶æœ‰é—®é¢˜ã€‚ DDLè¯­å¥çš„åˆ¤æ–­æ˜¯å¯¹create/drop/alter tableç­‰çš„ç›¸å…³æ“ä½œ
523,Merge pull request #1 from alibaba/master merge from master [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=523) <br/>All committers have signed the CLA. [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=523) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=523) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=523) it.</sub>
522,ä¿®å¤æ­»é”bug å½“é€šè¿‡zk-cursorå¯åŠ¨çš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªEventç±»å‹æ˜¯TransactionEndï¼Œé‚£ä¹ˆtxStateå˜ä¸º2çš„è§¦å‘æ¡ä»¶ä¸ä»…ä»…æœ‰ddlå’Œdclï¼Œclearæ–¹æ³•ä¸­isTransactionEndçš„åˆ¤æ–­åº”è¯¥æ”¾åˆ°txState.intValue() == 2çš„åé¢ï¼Œå¦åˆ™å°†å¯¼è‡´æ­»é” [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=522) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=522) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=522) it.</sub> æ„Ÿè°¢ï¼Œé«˜è´¨é‡çš„bugä¿®å¤ @lulu2panpan é¡ºä¾¿é—®ä¸€ä¸‹ï¼Œä½ ä»¬group sinkåœ¨ç”¨ï¼Œæºç«¯çš„TPSå¤§æ¦‚å¤šå°‘ï¼Ÿå› ä¸ºä»¥å‰è¿™ç§è®¾è®¡æ–¹å¼å­˜åœ¨å¤§é‡çš„çº¿ç¨‹é€šçŸ¥æœºåˆ¶ï¼Œä¸æ˜¯æœ€ä¼˜çš„æ€§èƒ½è®¾è®¡ï¼Œç†æƒ³æƒ…å†µçš„è®¾è®¡åº”è¯¥æ˜¯åšä¸€ä¸ªmerge sortçš„å½’å¹¶é˜Ÿåˆ—ï¼Œä¸¤å±‚storeçš„æ¨¡å¼æ€§èƒ½ä¼šæ¯”è¾ƒok @agapple æˆ‘ä¹Ÿé‡åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œä¸€æ®µæ—¶é—´æ•°æ®æ²¡æœ‰å˜æ›´ï¼Œå†æœ‰æ•°æ®å˜æ›´ï¼Œserverä¹Ÿä¸ä¼šè¯»åˆ°ã€‚è¯·é—®è¿™ä¸ªæ˜¯åœ¨å“ªä¸ªç‰ˆæœ¬é‡Œè§£å†³çš„ï¼Ÿ @handmail æ˜¯ç”¨çš„group sink ï¼Ÿ æ€§èƒ½çš„ç¡®æ˜¯æœ‰ç‚¹å„¿é—®é¢˜ æœ‰äº›å­åº“é•¿æ—¶é—´ä¸äº§ç”Ÿæ•°æ®ï¼Œæˆ‘ä»¬æ˜¯é€šè¿‡å¿ƒè·³sqlï¼Œå¼ºåˆ¶äº§ç”Ÿbinlogè§£å†³çš„ï¼Œå¿ƒè·³æ˜¯3sä¸€æ¬¡ï¼Œè¿™ç§æƒ…å†µä¸‹æ—¥å¸¸å»¶è¿Ÿæ—¶é—´åœ¨5så·¦å³ï¼Œå¯¹äºé«˜å¹¶å‘åœºæ™¯ï¼Œè¿˜æ˜¯æœ‰å¾ˆå¤§ç“¶é¢ˆçš„ æ˜¯çš„ï¼Œåç»­å¯ä»¥è®¾è®¡ä¸€ä¸ªGroupXXParseræ¥æ”¯æŒå¤šåº“èšåˆï¼Œæ€§èƒ½ä¸Šä¼šå¥½å¾ˆå¤š æ©ï¼Œè¿™ä¸ªåŠŸèƒ½è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œè¿™æ ·é…ä¸€ä¸ªå®ä¾‹å°±okäº†ï¼Œå¤§å¤§èŠ‚çœè¿ç»´æˆæœ¬ åé¢æœ‰æ—¶é—´ï¼Œä¸€èµ·è®¾è®¡ä¸€ä¸‹å§ @lulu2panpan æƒ³é‚€è¯·ä½ å‚åŠ canalçš„ä»£ç å…±å»ºï¼Œå¯ä»¥è”ç³»æˆ‘é‚®ç®±ï¼šjianghang115@gmail.com
521,ä¿®æ”¹InstanceConfigæœªç”Ÿæˆæˆ–å·²é”€æ¯æ—¶é€ æˆServerRunningMonitor runningçŠ¶æ€ä¸å®é™…ä¸ä¸€è‡´çš„é—®é¢˜ å¦‚æœinstanceåœ¨serverç«¯æœªå¯åŠ¨ï¼Œæˆ–å·²ç»stopçš„æƒ…å†µï¼Œæ­¤æ—¶clientç«¯è¿›è¡Œè®¢é˜…ï¼Œåœ¨SessionHandlerä¸­ï¼Œä¼šå°è¯•å¯åŠ¨è¿™ä¸ªinstanceçš„ServerRunningMonitorï¼š                         _// å°è¯•å¯åŠ¨ï¼Œå¦‚æœå·²ç»å¯åŠ¨ï¼Œå¿½ç•¥                         if (!embeddedServer.isStart(clientIdentity.getDestination())) {                             ServerRunningMonitor runningMonitor = ServerRunningMonitors.getRunningMonitor(clientIdentity.getDestination());                             if (!runningMonitor.isStart()) {                                 runningMonitor.start();                             }                         }_ ç„¶åCanalServerWithEmbedded#start(final String destination)ä¸­ç¬¬ä¸€è¡Œï¼š _final CanalInstance canalInstance = canalInstances.get(destination);_ ä¼šå› ä¸ºæ‰¾ä¸åˆ°InstanceConfigåœ¨generate instanceæ—¶æŠ›å‡ºæ‰¾ä¸åˆ°destinationçš„å¼‚å¸¸ï¼š _if (config == null) {         throw new CanalServerException("can't find destination:{}"); }_ ServerRunningMonitor#start()ç¬¬ä¸€è¡Œå°±æŠŠçŠ¶æ€ç½®ä¸ºtrueã€‚æ­£å¸¸å¯åŠ¨å®ä¾‹æ—¶ï¼Œè®¤ä¸ºå·²ç»å¯åŠ¨ï¼Œå°±ä¼šå¿½ç•¥ã€‚ å¦‚æœå¯åŠ¨å¤±è´¥ï¼Œåº”è¯¥å›æ»šæ‰€æœ‰å·²æ”¹å˜çš„çŠ¶æ€ã€‚å› ä¸ºstart/stopä¼šåœ¨scanå’Œnetty workçº¿ç¨‹ï¼Œæ‰€ä»¥start/stopåŠ äº†åŒæ­¥ã€‚ æ„Ÿè°¢ï¼Œä¸€ä¸ªå®¹é”™çš„è€ƒè™‘
520,canal haæ—¶å€™ ä¸èƒ½ä¿è¯æœåŠ¡æ­£å¸¸å¹³ç§»ã€‚ canal server ha çš„æ—¶å€™ï¼Œå¦‚æœç›´æ¥kill -9 æ–¹å¼å…³é—­ï¼Œhaä¸èƒ½å¾ˆå¥½å¹³ç§»ï¼ŒæœåŠ¡ä¼šå‡ºç°å½“æ‰çš„æƒ…å†µã€‚ å¦‚æœ ç”¨å‘½ä»¤æ­£å¸¸stop server åˆ™ä¸ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ã€‚ kill -9éœ€è¦zookeeper session timeoutè¶…æ—¶æ‰èƒ½åšhaè¿ç§»
519,canalå¯¹åº“è¡¨çš„perlæ­£åˆ™è¿‡æ»¤ï¼Œä¸ºä½•â€œåº“å.è¡¨åâ€çš„å…¨åŒ¹é…æ–¹å¼ï¼Œè·å–ä¸åˆ°æ—¥å¿—ï¼Ÿ ![image](https://user-images.githubusercontent.com/20380664/35789590-2cec3a0e-0a78-11e8-858c-54bf51ba011b.png) mysqlæ•°æ®è§£æå…³æ³¨çš„è¡¨ä¸ºå¯ä»¥é€šè¿‡"åº“åç§°\\..*"æ–¹å¼ç²¾ç¡®åˆ°å…·ä½“çš„åº“ï¼Œä½†ä½¿ç”¨mysql.test1 mysql.test2 è¿™ç§æ–¹å¼æ— æ³•è§£æå¯¹åº”è¡¨çš„æ—¥å¿—ï¼Ÿæ˜¯ä¸æ˜¯canalæ–‡æ¡£ä¸Šå†™çš„æœ‰å‡ºå…¥ï¼Ÿï¼Ÿ æ˜¯å¦è€ƒè™‘ä¸‹é¢è¿™ä¸ªç‚¹ï¼š void subscribe(String filter)                throws com.alibaba.otter.canal.protocol.exception.CanalClientException å®¢æˆ·ç«¯è®¢é˜…ï¼Œé‡å¤è®¢é˜…æ—¶ä¼šæ›´æ–°å¯¹åº”çš„filterä¿¡æ¯  è¯´æ˜ï¼š  a. å¦‚æœæœ¬æ¬¡è®¢é˜…ä¸­filterä¿¡æ¯ä¸ºç©ºï¼Œåˆ™ç›´æ¥ä½¿ç”¨canal serveræœåŠ¡ç«¯é…ç½®çš„filterä¿¡æ¯  b. å¦‚æœæœ¬æ¬¡è®¢é˜…ä¸­filterä¿¡æ¯ä¸ä¸ºç©ºï¼Œç›®å‰ä¼šç›´æ¥æ›¿æ¢canal serveræœåŠ¡ç«¯é…ç½®çš„filterä¿¡æ¯ï¼Œä»¥æœ¬æ¬¡æäº¤çš„ä¸ºå‡†    TODO: åç»­å¯ä»¥è€ƒè™‘ï¼Œå¦‚æœæœ¬æ¬¡æäº¤çš„filterä¸ä¸ºç©ºï¼Œåœ¨æ‰§è¡Œè¿‡æ»¤æ—¶ï¼Œæ˜¯å¯¹canal server filter + æœ¬æ¬¡filterçš„äº¤é›†å¤„ç†ï¼Œè¾¾åˆ°åªå–1ä»½binlogæ•°æ®ï¼Œå¤šä¸ªå®¢æˆ·ç«¯æ¶ˆè´¹ä¸åŒçš„è¡¨   å‚æ•°: clientIdentity - æŠ›å‡º: com.alibaba.otter.canal.protocol.exception.CanalClientException ç”¨mysql\\.test1ï¼Œmysql\\.test2å‘¢ï¼Ÿ å‚è€ƒFAQ: https://github.com/alibaba/canal/wiki/FAQ
518,åˆå§‹å¯åŠ¨æ—¥å¿—è¦æ±‚æIssues ERROR c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - pls submit github issue  show create table ddl:CREATE TABLE `REPO_VER_REFS` (   `NODE_ID` varbinary(16) NOT NULL   `REFS_DATA` longblob NOT NULL   UNIQUE KEY `REPO_VER_REFS_IDX` (`NODE_ID`) ) ENGINE=InnoDB DEFAULT CHARSET=latin1   compare failed .   db : TableMeta [schema=urule  table=REPO_VER_REFS  fileds= 	FieldMeta [columnName=NODE_ID  columnType=varbinary(16)  defaultValue=null  nullable=false  key=true] 	FieldMeta [columnName=REFS_DATA  columnType=longblob  defaultValue=null  nullable=false  key=false] ]   mem : TableMeta [schema=urule  table=REPO_VER_REFS  fileds= 	FieldMeta [columnName=NODE_ID  columnType=varbinary(16)  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=REFS_DATA  columnType=longblob  defaultValue=null  nullable=false  key=false] ] ç±»ä¼¼é—®é¢˜ï¼Œä»£ç å·²ç»ä¿®å¤
517,rowChage.getEventType()è·å–çš„ç±»å‹å…¨éƒ¨æ˜¯æ˜¯QUERY ä½†æ˜¯rowChage.getSql()è·å–sqlè¯­å¥éƒ½æ˜¯INSERTæˆ–è€…UPDATEæˆ–è€…DELETE å¦‚é¢˜ï¼Œåœ¨ç›‘æ§mysqlä¸€ä¸ªæ•°æ®åº“æ—¶ï¼ŒrowChage.getEventType()æ‹¿åˆ°çš„æ‰€æœ‰ç±»å‹éƒ½æ˜¯QUERY ä½†æ˜¯rowChage.getSql()æ‹¿åˆ°çš„è¯­å¥å´éƒ½æ˜¯INSERTæˆ–è€…UPDATEæˆ–è€…DELETEï¼Œæ€€ç–‘rowChage.getEventType()æ²¡æœ‰è·å–åˆ°å€¼ï¼Œç»™äº†ä¸€ä¸ªé»˜è®¤QUERYå€¼ ä»£ç ä¸­æ‰“å°çš„æ—¥å¿—çš„è¯­å¥ï¼š                   logger.info("æ­¤æ¬¡æ“ä½œç±»å‹:"+rowChage.getEventType().toString());                 logger.info("sql------>:"+rowChage.getSql());                 logger.info("æ˜¯å¦æ˜¯ddl----->"+rowChage.getIsDdl()); æ§åˆ¶å°æ‰“å°å‡ºæ¥çš„æ—¥å¿—ï¼š                [2018-02-01 11:29:02.614][INFO][Thread-6]c.p.mycode.canal.ClusterCanalClient-handleData:æ­¤æ¬¡æ“ä½œç±»å‹:QUERY                 [2018-02-01 11:29:02.615][INFO][Thread-6]c.p.mycode.canal.ClusterCanalClient-handleData:sql------>:DELETE FROM QRTZ_CREDITCARD_FIRED_TRIGGERS WHERE ENTRY_ID = 'cfc-sit-jd-web04.haomoney.local15174069672781517407028267'                 [2018-02-01 11:29:02.615][INFO][Thread-6]c.p.mycode.canal.ClusterCanalClient-handleData:æ˜¯å¦æ˜¯ddl----->false binlogérowæ¨¡å¼
516,å¦‚ä½•ä¿è¯è¿æ¥ä¸æ–­ æˆ‘æƒ³é—®é—®ï¼Œå¦‚æœcanalä¸ä¸»åº“çš„è¿æ¥ï¼Œæ­»äº¡æˆ–è€…ç½‘ç»œä¸­æ–­ï¼Œcanalæœ‰é‡è¿çš„æœºåˆ¶å— æœ‰çš„ï¼Œçœ‹ä¸‹example clientä¾‹å­
515,canal clientçš„springç‰ˆæœ¬é—®é¢˜ canal clientä½¿ç”¨çš„è¿˜æ˜¯3.2.9.RELEASEç‰ˆæœ¬çš„springï¼Œå¦‚æœç›´æ¥ä½¿ç”¨spring4çš„ä¾èµ–ä¼šå‡ºç°å¥‡æ€ªçš„å¼‚å¸¸ã€‚éœ€è¦åœ¨é¡¹ç›®ä¸­excludeæ‰springç›¸å…³çš„ä¾èµ–ï¼Œè¿™ä¹ˆåšæ€»è§‰å¾—ä¼šåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å­˜åœ¨ä¸€äº›é£é™©ã€‚ å»ºè®®ï¼š 1. èƒ½å¦è·Ÿä¸Šspringå¤§ç‰ˆæœ¬å‡çº§ï¼Œä¾‹ï¼šspring3 -> spring4 2. å¦‚æœcanalä½¿ç”¨springçš„åŠŸèƒ½å¾ˆå°‘çš„è¯ï¼Œèƒ½ä¸èƒ½å°†springçš„ä¾èµ–è®¾ç½®ä¸ºoptionalçš„ã€‚ referenceï¼š#371  å¦å¤–ï¼Œæˆ‘åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œlogbackä¹ŸåŒæ ·æœ‰ç‰ˆæœ¬å†²çªçš„é—®é¢˜ã€‚ä¹ŸåŒæ ·å»ºè®®å˜ä¸ºoptionalçš„ä¾èµ–ã€‚ canalå°±åªç”¨äº†springä¾èµ–æ³¨å…¥ LSæ­£è§£
514,å¯¹æ•°æ®ä½œå‡ºæ›´æ”¹æ—¶ï¼Œclientç«¯åªè§£æåˆ°äº†äº‹åŠ¡çš„å¼€å§‹å’Œç»“æŸ å¯¹æ•°æ®ä½œå‡ºæ›´æ”¹æ—¶ï¼Œclientç«¯åªè§£æåˆ°äº†äº‹åŠ¡çš„å¼€å§‹å’Œç»“æŸï¼Œmessage.getEntries()æ–¹æ³•è¿”å›çš„liståªæœ‰ä¸¤ä¸ªå…ƒç´ ï¼Œä¸€ä¸ªå¯¹åº”äº‹åŠ¡å¼€å§‹ä¸€ä¸ªå¯¹åº”äº‹åŠ¡ç»“æŸï¼Œæ²¡æœ‰è¡Œæ›´æ”¹å¯¹åº”çš„entry æ•°æ®è¢«è¿‡æ»¤äº†
513,Canalçš„Filteræ”¯æŒå‰ç¼€åŒ¹é…å—ï¼Ÿ æ¯”å¦‚schemaæ˜¯actionlog+å››ä½æ•°å­—ï¼Œtableæ˜¯actionlog+å…«ä½æ•°å­—ï¼Œfilterèƒ½åŒ¹é…è¿™ç§å—ï¼Ÿæ­£åˆ™éœ€è¦æ€ä¹ˆå†™å‘¢ï¼Ÿ å¯ä»¥å†™ï¼Œactionlog\\d{4}\\.actionlog\\d{8}
512,æœåŠ¡ç«¯å¯åŠ¨ä¸€ç›´å¤±è´¥ï¼Œæ±‚åŠ©ï¼ï¼ canal.instance.tsdb.enableæ— è®ºå¼€å¯è¿˜æ˜¯å…³é—­éƒ½å‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š ERROR com.alibaba.druid.pool.DruidDataSource - create connection SQLException  url: jdbc:h2:../conf/example/h2;CACHE_SIZE=1000;MODE=MYSQL;  errorCode 28000  state 28000 org.h2.jdbc.JdbcSQLException: Wrong user name or password [28000-196] æˆ‘çš„instanceé…ç½®ï¼š `################################################# ## mysql serverId canal.instance.mysql.slaveId=1234 # position info canal.instance.master.address=192.168.3.200:3306 canal.instance.master.journal.name=mysql-bin.000001 canal.instance.master.position= canal.instance.master.timestamp= # table meta tsdb info canal.instance.tsdb.enable=false canal.instance.tsdb.dir=${canal.file.data.dir:../conf}/${canal.instance.destination:} canal.instance.tsdb.url=jdbc:h2:${canal.instance.tsdb.dir}/h2;CACHE_SIZE=1001;MODE=MYSQL; #canal.instance.tsdb.url=jdbc:mysql://127.0.0.1:3306/Test #canal.instance.tsdb.dbUsername=canal #canal.instance.tsdb.dbPassword=canal #canal.instance.standby.address = #canal.instance.standby.journal.name = #canal.instance.standby.position =  #canal.instance.standby.timestamp =  # username/password canal.instance.dbUsername=canal canal.instance.dbPassword=canal canal.instance.defaultDatabaseName= canal.instance.connectionCharset=UTF-8 # table regex canal.instance.filter.regex=Test\\..* # table black regex canal.instance.filter.black.regex= ################################################# ` >b. canalçš„åŸç†æ˜¯æ¨¡æ‹Ÿè‡ªå·±ä¸ºmysql slaveï¼Œæ‰€ä»¥è¿™é‡Œä¸€å®šéœ€è¦åšä¸ºmysql slaveçš„ç›¸å…³æƒé™. CREATE USER canal IDENTIFIED BY 'canal';   GRANT SELECT  REPLICATION SLAVE  REPLICATION CLIENT ON *.* TO 'canal'@'%'; -- GRANT ALL PRIVILEGES ON *.* TO 'canal'@'%' ; FLUSH PRIVILEGES; https://github.com/alibaba/canal/wiki/QuickStart æ˜¯mysqlæ²¡æœ‰è®¾ç½®canalç”¨æˆ·åå’Œå¯†ç å—? @HeChuanXUPT    ä½ å¥½ï¼Œç¡®è®¤ä¸æ˜¯æƒé™é—®é¢˜ã€‚ @hsh075623201  å¦‚æœä¸ä½¿ç”¨tsdbçš„è¯ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨ä¸‹ä¹‹å‰çš„ç‰ˆæœ¬ 1.0.19 ï¼Œ 1.0.19è¿™ä¸ªæˆ‘æ˜¯å¯åŠ¨æˆåŠŸäº†çš„ é‡åˆ°åŒæ ·çš„é—®é¢˜ @WilliamGai æ³¨é‡Štsdbå°±å¯ä»¥äº† é‡åˆ°åŒæ ·çš„é—®é¢˜ @hsh075623201 è¯·é—®ä¸‹ï¼Œä½ æ˜¯æŠŠ tsdbçš„å…¨æ³¨é‡Šäº†å—ï¼Ÿ æˆ‘æ³¨é‡Šäº†ç„¶åæŠ¥å¼‚å¸¸ï¼š java.sql.SQLException: connect error  url   driverClass org.h2.Driver h2çš„é—®é¢˜  æœ‰å‡ ä¸ªåé¦ˆäº†   å¦‚æœå¯¹H2æ¯”è¾ƒäº†è§£çš„å¯ä»¥å°è¯•ä¼˜åŒ–è§£å†³ h2ä½œä¸ºtable ddlçš„å†å²ç‰ˆæœ¬å­˜å‚¨æ—¶ï¼Œä¼šåŸºäºH2çš„é»˜è®¤jdbcé…ç½® ``` canal.instance.tsdb.dir=${canal.file.data.dir:../conf}/${canal.instance.destination:} canal.instance.tsdb.url=jdbc:h2:${canal.instance.tsdb.dir}/h2;CACHE_SIZE=1000;MODE=MYSQL; canal.instance.tsdb.dbUsername=canal canal.instance.tsdb.dbPassword=canal ``` è§£è¯»ä¸€ä¸‹ï¼Œå°±æ˜¯ç¬¬ä¸€æ¬¡æ—¶ä¼šåˆ›å»ºconf/$instance$/$instance.mv.dbï¼Œå¹¶è®¾ç½®è®¿é—®å¯†ç ä¸ºcanal/canalï¼Œå¦‚æœç¬¬äºŒæ¬¡é‡æ–°æ‰“å¼€æ—¶ä¼šæ ¡éªŒxx.mv.dbæ˜¯å¦æœ‰å¤šè¿›ç¨‹åŒæ—¶ä½¿ç”¨(ä¼šå‡ºç°java.lang.IllegalStateException: The file is locked)ï¼Œä¹Ÿä¼šæ ¡éªŒæœ¬æ¬¡çš„è®¿é—®å¯†ç æ˜¯å¦å’Œç¬¬ä¸€æ¬¡åˆ›å»ºæ—¶ç›¸åŒ å¦‚æœçœŸé‡åˆ°ä¸€äº›è«åå…¶å¦™çš„é—®é¢˜ï¼Œä¸‡èƒ½çš„è§£å†³åŠæ³•ï¼šåˆ é™¤conf/å¯¹åº”çš„xx.mv.dbï¼Œä¼šé‡æ–°åˆå§‹åŒ–ä¸€ä¸ªh2æœ¬åœ°æ–‡ä»¶
511,èƒ½ç»“åˆkafkaä½¿ç”¨å—ï¼Ÿ ä½ å¥½ï¼š    èƒ½ç»“åˆkafkaä½¿ç”¨å—ï¼Ÿç›´æ¥æŠŠæ•°æ®å†™å…¥åˆ°kafkaï¼Œè¿˜æ˜¯éœ€è¦è‡ªå·±å†™æ¶ˆè´¹è€…ï¼Ÿ ç›®å‰è‡ªå·±å†™ çº¿ç¨‹çš„ç”¨maxwell  debezium   å»ºè®®ä¿®æ”¹otterçš„loader æ”¯æŒä¸‹å…¶ä»–æ•°æ®æºã€‚otterç®¡ç†å¥½äº†canal
510,canalæœåŠ¡å¯åŠ¨åè¿æ¥mysql æŠ¥ java.io.IOException: socket read timeout occured ! mysqlæœåŠ¡å·²å¯åŠ¨ï¼Œç”¨æˆ·æƒé™ä¹Ÿåˆ†é…äº†ï¼Œå¯åŠ¨canalåä¼šæŠ¥å‡ åˆ†é’Ÿçš„è¿ä¸ä¸Šmysqlçš„é”™è¯¯ï¼Œä½†æ˜¯è¿‡ä¸ªå‡ åˆ†é’Ÿåè‡ªå·±åˆè¿ä¸Šäº†ï¼Œè¿™ä¸ªé—®é¢˜å·²ç»å›°æ‰°æˆ‘å‡ å¤©äº†ã€‚ `java.io.IOException: connect /10.11.30.3:3306 failure 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:74) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:72) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:162) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_131] Caused by: java.io.IOException: socket read timeout occured ! 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannel.read(SocketChannel.java:78) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.readHeader(PacketManager.java:18) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.negotiate(MysqlConnector.java:150) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:71) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	... 3 common frames omitted 2018-01-26 09:35:09.559 [destination = example   address = /10.11.30.3:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.io.IOException: connect /10.11.30.3:3306 failure 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:74) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:72) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:162) 	at java.lang.Thread.run(Thread.java:748) Caused by: java.io.IOException: socket read timeout occured ! 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannel.read(SocketChannel.java:78) 	at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.readHeader(PacketManager.java:18) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.negotiate(MysqlConnector.java:150) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:71) 	... 3 more ] 2018-01-26 09:35:27.296 [destination = example   address = /10.11.30.3:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /10.11.30.3:3306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: connect /10.11.30.3:3306 failure Caused by: java.io.IOException: connect /10.11.30.3:3306 failure 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:74) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:72) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:87) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:160) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_131] Caused by: java.io.IOException: socket read timeout occured ! 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannel.read(SocketChannel.java:78) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.readHeader(PacketManager.java:18) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.negotiate(MysqlConnector.java:150) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:71) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	... 4 common frames omitted 2018-01-26 09:35:27.298 [destination = example   address = /10.11.30.3:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: connect /10.11.30.3:3306 failure Caused by: java.io.IOException: connect /10.11.30.3:3306 failure 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:74) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:72) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:87) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:160) 	at java.lang.Thread.run(Thread.java:748) Caused by: java.io.IOException: socket read timeout occured ! 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannel.read(SocketChannel.java:78) 	at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.readHeader(PacketManager.java:18) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.negotiate(MysqlConnector.java:150) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:71) 	... 4 more ] 2018-01-26 09:35:47.022 [destination = example   address = /10.11.30.3:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position  {"identity":{"slaveId":-1 "sourceAddress":{"address":"10.11.30.3" "port":3306}} "postion":{"included":false "journalName":"mysql-log-bin.000005" "position":4353 "serverId":999 "timestamp":1516859980000}}` æˆ‘ä¹Ÿæ˜¯è¿™ä¸ªé—®é¢˜ï¼Œä¸çŸ¥é“æ€ä¹ˆå›äº‹mysql5.7.13 çœ‹æ¥å®˜æ–¹çš„è¯´æ˜è¿™ä¸ªç‰ˆæœ¬çš„mysqlåº”è¯¥æ˜¯æ²¡æœ‰é—®é¢˜ä¸çŸ¥é“æ€ä¹ˆå‡ºç°è¿™ä¸ªé—®é¢˜ 2018-01-31 17:04:22.134 [destination = yfmalldb   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : GRANT SELECT  REPLICATION SLAVE  REPLICATION CLIENT ON *.* TO 'canal'@'127.0.0.1' IDENTIFIED WITH 'mysql_native_password' AS '*E3619321C1A937C46A0D8BD1DAC39F93B27D4458' com.alibaba.druid.sql.parser.ParserException: syntax error  error in :'FIED WITH 'mysql_native_password' A'  expect BY  actual WITH pos 97  line 1  column 93  token WITH 	at com.alibaba.druid.sql.parser.SQLParser.printError(SQLParser.java:283) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.parser.SQLParser.accept(SQLParser.java:292) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseGrant(SQLStatementParser.java:738) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:207) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:464) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:295) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:69) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.applyHistoryOnMemory(DatabaseTableMeta.java:388) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:121) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_111] 2018-01-31 17:04:22.134 [destination = yfmalldb   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : GRANT SELECT  REPLICATION SLAVE  REPLICATION CLIENT ON *.* TO 'canal'@'localhost' IDENTIFIED WITH 'mysql_native_password' AS '*E3619321C1A937C46A0D8BD1DAC39F93B27D4458' com.alibaba.druid.sql.parser.ParserException: syntax error  error in :'FIED WITH 'mysql_native_password' A'  expect BY  actual WITH pos 97  line 1  column 93  token WITH 	at com.alibaba.druid.sql.parser.SQLParser.printError(SQLParser.java:283) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.parser.SQLParser.accept(SQLParser.java:292) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseGrant(SQLStatementParser.java:738) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:207) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:464) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:295) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:69) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.applyHistoryOnMemory(DatabaseTableMeta.java:388) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:121) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_111] çœ‹ç€å¥½åƒæ˜¯æˆæƒé—®é¢˜ï¼Œä½†æ˜¯æƒé™æŒ‰ç…§è¯´æ˜å¤„ç†è¿‡äº†ï¼Œéƒé—·ä¸­ Caused by: java.io.IOException: socket read timeout occured ! at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannel.read(SocketChannel.java:78) æ„æ€æ˜¯è¯´ä½ æºåº“è¶…è¿‡100ç§’éƒ½æ²¡æœ‰æ–°çš„æ•°æ®ï¼Œä¼šè‡ªåŠ¨é‡è¿
509,canal clientæ‹‰å–binlogï¼Œserverç«¯æŠ¥é”™java.nio.channels.ClosedByInterruptException: null ------------------------------------------------------------------------------------------- 2018-01-26 14:04:56.245  INFO 121070 --- [       Thread-4] com.gome.canalmq.service.MonitorService  : lmis speed:2461.1record/sec  can al speed:6273.7record/sec 2018-01-26 14:05:06.245  INFO 121070 --- [       Thread-4] com.gome.canalmq.service.MonitorService  : lmis speed:3666.6record/sec  can al speed:8312.6record/sec 2018-01-26 14:05:16.246  INFO 121070 --- [       Thread-4] com.gome.canalmq.service.MonitorService  : lmis speed:4077.8record/sec  can al speed:12065.4record/sec 2018-01-26 14:05:26.246  INFO 121070 --- [       Thread-4] com.gome.canalmq.service.MonitorService  : lmis speed:2859.6record/sec  can al speed:6839.5record/sec 26 2018-01-26 14:05:36.246  INFO 121070 --- [       Thread-4] com.gome.canalmq.service.MonitorService  : lmis speed:329.2record/sec  cana l speed:920.5record/sec 27 2018-01-26 14:05:46.246  INFO 121070 --- [       Thread-4] com.gome.canalmq.service.MonitorService  : lmis speed:149.3record/sec  cana l speed:419.7record/sec 2018-01-26 14:05:56.247  INFO 121070 --- [       Thread-4] com.gome.canalmq.service.MonitorService  : lmis speed:76.4record/sec  canal  speed:212.2record/sec 2018-01-26 14:06:06.247  INFO 121070 --- [       Thread-4] com.gome.canalmq.service.MonitorService  : lmis speed:23.6record/sec  canal  speed:68.9record/sec 2018-01-26 14:06:16.248  INFO 121070 --- [       Thread-4] com.gome.canalmq.service.MonitorService  : lmis speed:58.0record/sec  canal  speed:165.8record/sec 2018-01-26 14:06:26.248  INFO 121070 --- [       Thread-4] com.gome.canalmq.service.MonitorService  : lmis speed:38.7record/sec  canal  speed:108.9record/sec 2018-01-26 14:06:36.248  INFO 121070 --- [       Thread-4] com.gome.canalmq.service.MonitorService  : lmis speed:29.9record/sec  canal  speed:86.6record/sec ------------------------------------------------------------------------------------------- 2018-01-26 14:05:22.693 [destination = lmis65   address = /10.128.35.65:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address 10.128.35.65/10.128.35.65:3306 has an error  retrying. caused by  java.nio.channels.ClosedByInterruptException: null         at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannel.read(SocketChannel.java:49) ~[canal.parse.driver-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:151) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:77) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:137) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220) ~[canal.parse-1.0.25.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.8.0_91] 2018-01-26 14:05:22.697 [destination = lmis65   address = /10.128.35.65:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:lmis65[java.nio.channels.ClosedByInterruptException         at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannel.read(SocketChannel.java:49)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:151)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:77)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:137)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220)         at java.lang.Thread.run(Thread.java:745) ] 2018-01-26 14:05:41.309 [destination = lmis65   address = /10.128.35.65:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position  {"identity":{"slaveId":-1 "sourceAddress":{"address":"10.128.35.65" "port":3306}} "postion":{"included":false "journalName":"mysql-bin.003759" "position":891656455 "serverId":1 "timestamp":1516929456000}} ç¯å¢ƒ canalç‰ˆæœ¬1.0.25 ï¼Œzkç®¡ç†ï¼Œcentos7.2 ï¼Œmysqlç‰ˆæœ¬5.7.11 canal 1.0.25å’Œ1.0.26å¾ˆæ…¢ï¼Œæˆ‘æ¢åˆ°è€ç‰ˆæœ¬1.0.24å°±æ²¡é—®é¢˜äº† æˆ‘ä¹Ÿæ˜¯é™åˆ°1.0.24å°±æ²¡é—®é¢˜äº†ã€‚åœ¨1.0.25ä¸‹å°±ä¼šæŠ¥é”™ ``` 2018-01-25 19:36:37.799 [destination = databus   address = /127.0.0.1:43306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - parse events has an error com.alibaba.otter.canal.parse.exception.CanalParseException: dump address /127.0.0.1:43306 has an error  retrying. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: connect /127.0.0.1:43306 failure Caused by: java.io.IOException: connect /127.0.0.1:43306 failure         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:72) ~[canal.parse.driver-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:71) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:88) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:160) ~[canal.parse-1.0.25.jar:na]         at java.lang.Thread.run(Thread.java:745) ~[na:1.7.0_79] Caused by: java.nio.channels.ClosedByInterruptException: null         at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannel.read(SocketChannel.java:55) ~[canal.parse.driver-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.readHeader(PacketManager.java:12) ~[canal.parse.driver-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.negotiate(MysqlConnector.java:148) ~[canal.parse.driver-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:69) ~[canal.parse.driver-1.0.25.jar:na]         ... 4 common frames omitted ``` å»ºè®®å‡çº§åˆ°26ç‰ˆæœ¬ï¼Œè§£å†³äº†è¶…æ—¶æ—¶é—´è¿‡çŸ­ä»¥åŠé“¾æ¥mysqlåˆ‡å›bioçš„æ¨¡å¼
508,canal client 
507,desc tableName ä¸ show create table tableName å¯¹æ¯”ä¸ä¸€è‡´ CREATE TABLE `IM_GROUP_USER` (   `GROUPID` int(11) NOT NULL   `USERID` int(11) NOT NULL   `MANA` int(11) DEFAULT NULL   `NOTE` varchar(200) COLLATE gbk_bin DEFAULT NULL   UNIQUE KEY `IM_GROUP_USER_INDEX` (`GROUPID` `USERID`) ) ENGINE=InnoDB DEFAULT CHARSET=gbk COLLATE=gbk_bin   compare failed .   db : TableMeta [schema=imserver  table=IM_GROUP_USER  fileds= 	FieldMeta [columnName=GROUPID  columnType=int(11)  defaultValue=null  nullable=false  key=true] 	FieldMeta [columnName=USERID  columnType=int(11)  defaultValue=null  nullable=false  key=true] 	FieldMeta [columnName=MANA  columnType=int(11)  defaultValue=null  nullable=true  key=false] 	FieldMeta [columnName=NOTE  columnType=varchar(200)  defaultValue=null  nullable=true  key=false] ]   mem : TableMeta [schema=imserver  table=IM_GROUP_USER  fileds= 	FieldMeta [columnName=GROUPID  columnType=int(11)  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=USERID  columnType=int(11)  defaultValue=null  nullable=false  key=false] 	FieldMeta [columnName=MANA  columnType=int(11)  defaultValue=null  nullable=true  key=false] 	FieldMeta [columnName=NOTE  columnType=varchar(200)  defaultValue=null  nullable=true  key=false] ] ä½ è¿™mysqlæ˜¯å•¥ç‰ˆæœ¬æ¥ç€ï¼Ÿçœ‹ä¸Šå»UNIQUE KEY IM_GROUP_USER_INDEX (GROUPID USERID)ï¼Œè¢«å½“åšäº†pkï¼Œå‘æˆ‘ä¸€ä¸‹desc imserver.IM_GROUP_USER å’Œ  show create table imserver.IM_GROUP_USER çš„ç»“æœ æˆ‘æœ¬åœ°é‡ç°äº†
506,mvn è¿è¡Œ canal.exampleå·¥ç¨‹ jar åŒ…ä¸¢å¤± åœ¨ä½¿ç”¨mvn exec:java -Dexec.mainClass="com.alibaba.otter.canal.example.SimpleCanalClientTest"è¿è¡Œcanal.exampleå·¥ç¨‹æ—¶ï¼Œæç¤ºä¿©ä¸ªjaråŒ…ä¸¢å¤±ã€‚ [WARNING] The POM for com.alibaba.otter:canal.client:jar:1.0.26-SNAPSHOT is missing  no dependency information available [WARNING] The POM for com.alibaba.otter:canal.protocol:jar:1.0.26-SNAPSHOT is missing  no dependency information available mvn clean install eclipse:eclipse -Dmaven.test.skip
505,æœ¬æœºè¿è¡Œæ­£å¸¸ï¼ŒæœåŠ¡å™¨æŠ¥æ•°æ®åº“è¿æ¥å¤±è´¥ è¯·é—®åœ¨æœ¬æœºç”¨æºç æ‰§è¡ŒCanalLauncherç±»ï¼Œgroup-instance.xmlæ–¹å¼è¿è¡Œæ­£å¸¸ï¼Œæ”¾åœ¨centosæœåŠ¡å™¨ä¸Šè¿è¡Œå°±ä¼šæŠ¥ä»¥ä¸‹é”™è¯¯ï¼Œé…ç½®æ–‡ä»¶å®Œå…¨ä¸€æ ·ã€‚ç„¶åæœåŠ¡å™¨ä¸Šç”¨instance.propertiesæ–¹å¼è¿è¡Œè¿æ¥æ­£å¸¸ã€‚è¯·é—®æ€ä¹ˆä¿®å¤ 2018-01-25 13:35:30.225 [destination = group_mysql   address = /10.138.225.198:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - parse events has an error com.alibaba.otter.canal.parse.exception.CanalParseException: dump address /10.138.225.198:3306 has an error  retrying.  Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: connect /10.138.225.198:3306 failure Caused by: java.io.IOException: connect /10.138.225.198:3306 failure 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:72) ~[canal.parse.driver-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:71) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:88) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:160) ~[canal.parse-1.0.25.jar:na] 	at java.lang.Thread.run(Thread.java:745) ~[na:1.8.0_102] Caused by: java.lang.InterruptedException: null 	at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1302) ~[na:1.8.0_102] 	at com.alibaba.otter.canal.common.utils.BooleanMutex$Sync.innerGet(BooleanMutex.java:123) ~[canal.common-1.0.25.jar:na] 	at com.alibaba.otter.canal.common.utils.BooleanMutex.get(BooleanMutex.java:53) ~[canal.common-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannelPool.open(SocketChannelPool.java:71) ~[canal.parse.driver-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:67) ~[canal.parse.driver-1.0.25.jar:na] 	... 4 common frames omitted ç›´æ¥æŠŠæºç æ”¾ä¸Šå»è·‘æŠ¥çš„é”™ï¼Œdebugæ—¥å¿— 2018-01-26 15:44:43.706 [destination = group_mysql   address = /10.138.225.198:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - the channel /10.138.225.198:3306 is not connected 2018-01-26 15:44:43.708 [destination = group_mysql   address = /10.138.225.198:3306   EventParser] ERROR c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - java.lang.InterruptedException: AbstractBootstrap$PendingRegistrationPromise@6d9c2400(incomplete) 	at io.netty.util.concurrent.DefaultPromise.await(DefaultPromise.java:230) 	at io.netty.channel.DefaultChannelPromise.await(DefaultChannelPromise.java:129) 	at io.netty.channel.DefaultChannelPromise.await(DefaultChannelPromise.java:28) 	at io.netty.util.concurrent.DefaultPromise.sync(DefaultPromise.java:340) 	at io.netty.channel.DefaultChannelPromise.sync(DefaultChannelPromise.java:117) 	at io.netty.channel.DefaultChannelPromise.sync(DefaultChannelPromise.java:28) 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannelPool.open(SocketChannelPool.java:60) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:70) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:74) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:87) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:160) 	at java.lang.Thread.run(Thread.java:745) 2018-01-26 15:44:43.710 [destination = group_mysql   address = /10.138.225.198:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - the channel /10.138.225.198:3306 is not connected 2018-01-26 15:44:43.710 [destination = group_mysql   address = /10.138.225.198:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - the channel /10.138.225.198:3306 is not connected 2018-01-26 15:44:43.713 [destination = group_mysql   address = /10.138.225.198:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - parse events has an error com.alibaba.otter.canal.parse.exception.CanalParseException: dump address /10.138.225.198:3306 has an error  retrying.  Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: connect /10.138.225.198:3306 failure Caused by: java.io.IOException: connect /10.138.225.198:3306 failure 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:76) ~[class/:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:74) ~[class/:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:87) ~[class/:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:160) ~[class/:na] 	at java.lang.Thread.run(Thread.java:745) ~[na:1.8.0_102] Caused by: java.lang.InterruptedException: AbstractBootstrap$PendingRegistrationPromise@6d9c2400(incomplete) 	at io.netty.util.concurrent.DefaultPromise.await(DefaultPromise.java:230) ~[netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.DefaultChannelPromise.await(DefaultChannelPromise.java:129) ~[netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.DefaultChannelPromise.await(DefaultChannelPromise.java:28) ~[netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.util.concurrent.DefaultPromise.sync(DefaultPromise.java:340) ~[netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.DefaultChannelPromise.sync(DefaultChannelPromise.java:117) ~[netty-all-4.1.6.Final.jar:4.1.6.Final] 	at io.netty.channel.DefaultChannelPromise.sync(DefaultChannelPromise.java:28) ~[netty-all-4.1.6.Final.jar:4.1.6.Final] 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannelPool.open(SocketChannelPool.java:60) ~[class/:na] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:70) ~[class/:na] 	... 4 common frames omitted 2018-01-26 15:44:43.713 [canal-instance-scan-0] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - disConnect MysqlConnection to /10.138.225.197:3306... 2018-01-26 15:44:43.713 [canal-instance-scan-0] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - the channel /10.138.225.197:3306 is not connected 2018-01-26 15:44:43.713 [destination = group_mysql   address = /10.138.225.197:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - the channel /10.138.225.197:3306 is not connected 2018-01-26 15:44:43.713 [destination = group_mysql   address = /10.138.225.197:3306   EventParser] ERROR c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - java.lang.InterruptedException 	at java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:998) 	at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1304) 	at java.util.concurrent.CountDownLatch.await(CountDownLatch.java:231) 	at com.alibaba.otter.canal.parse.driver.mysql.socket.SocketChannelPool.open(SocketChannelPool.java:63) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:70) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:74) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:87) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:160) 	at java.lang.Thread.run(Thread.java:745) å‘ç°ç”¨startup.shå¯åŠ¨å°±ä¼šæœ‰è¿™ä¸ªé—®é¢˜ï¼Œè‡ªå·±å†™ä¸ªè„šæœ¬å¯åŠ¨å°±æ­£å¸¸å¯åŠ¨äº†ï¼Œç»§ç»­æ‰¾åŸå›  æ‰¾åˆ°äº†ï¼Œå¯åŠ¨å‚æ•°é‡Œçš„-DappName=otter-canalå»æ‰å°±å¥½äº†ã€‚ã€‚ã€‚å¥‡æ€ªä¸ºå•¥è¿™ä¸ªå‚æ•°ä¼šæœ‰å½±å“
504, ERROR ## findAsPerTimestampInSpecificLogFile has an error ![_qyd8 tx sr 6qc8 gb74g](https://user-images.githubusercontent.com/35767127/35331901-f8093d74-0143-11e8-9e2f-89528c232bc2.png) é…ç½® canal.instance.master.journal.name= canal.instance.master.position= ä¹Ÿæœ‰ç›¸åŒé”™è¯¯ï¼Œ ![kqa al2uno vd1 0u_3h](https://user-images.githubusercontent.com/35767127/35332342-a2deabb6-0145-11e8-8d54-ac1735efdce7.png) æ–°ç‰ˆæœ¬å·²ç»ä¿®å¤
503,compile failed [ERROR] Failed to execute goal on project canal.parse: Could not resolve dependencies for project com.alibaba.otter:canal.parse:jar:1.0.26-SNAPSHOT: Failed to collect dependencies at com.alibaba:druid:jar:1.1.7-preview_0: Failed to read artifact descriptor for com.alibaba:druid:jar:1.1.7-preview_0: Could not transfer artifact com.alibaba:druid:pom:1.1.7-preview_0 from/to alibaba (http://code.alibabatech.com/mvn/releases/): Connect to code.alibabatech.com:80 [code.alibabatech.com/119.38.217.15] failed: Connection refused (Connection refused) -> [Help 1] druidåˆ‡æ¢åˆ°1.1.5å¥½äº†ã€‚
502,Merge pull request #1 from alibaba/master . [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=502) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=502) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=502) it.</sub> [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=502) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=502) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=502) it.</sub>
501,groupæ¨¡å¼cursoré—®é¢˜ 1.åˆ†åº“æƒ…å†µä¸‹æ€»å…±10ä¸ªåº“ï¼Œé…ç½®äº†group-instance.xmlã€‚ 2.æœ‰ä¸€ä¸ªå®¢æˆ·ç«¯æ¥æ¶ˆè´¹è¿™äº›æ•°æ®ã€‚ 3.æ¶ˆè´¹å®Œäº†ä¹‹åï¼ŒæœåŠ¡ç«¯å†™cursorï¼Œåœ¨è¿™ä¸ªèŠ‚ç‚¹ã€‚/otter/canal/destinations/example/1001/cursorã€‚æ ¼å¼åŒ–å¦‚ä¸‹ï¼š{"@type":"com.alibaba.otter.canal.protocol.position.LogPosition" "identity":{"slaveId":-1 "sourceAddress":{"address":"10.20.144.15" "port":3306}} "postion":{"included":false "journalName":"mysql-bin.002253" "position":2574756 "timestamp":1363688722000}} 4.è¯·é—®æˆ‘æ€»å…±é…ç½®äº†10ä¸ªåº“ï¼Œåˆ†åˆ«éƒ½æ¶ˆè´¹äº†ï¼Œè¿™ä¸ªåœ¨zkæ˜¯æ€ä¹ˆå­˜å‚¨çš„å‘¢?ç›®å‰åœ¨zkä¸­çš„cursorèŠ‚ç‚¹è²Œä¼¼åªå­˜å‚¨äº†ä¸€ä¸ªå§ åªå­˜å‚¨æ—¶é—´æˆ³
500,æœåŠ¡å™¨æ–­ç”µåï¼Œé‡å¯æ•°æ®åº“å’ŒcanalæœåŠ¡ï¼Œä¸€ç›´æŠ¥Client requested master to start replication from position > file size é‡å¯canalServerä¸€ç›´æŠ¥è¿™ä¸ªé”™è¯¯Client requested master to start replication from position > file sizeï¼Œåº”è¯¥æ˜¯æ•°æ®ä¸åŒæ­¥é€ æˆçš„å§ï¼Œè¿™ç§æƒ…å†µè¯¥æ€ä¹ˆè§£å†³ å½“instance.xmlä¸­çš„canal.instance.master.positionæˆ–è€…meta.datä¸­çš„positionå¤§äºå®é™…binlogçš„sizeçš„æ—¶å€™ä¼šæŠ¥è¿™ä¸ªé”™ã€‚ LSæ­£è§£
499,è¿è¡Œä¸€æ®µæ—¶é—´ï¼Œserverçº¿ç¨‹æŒ‚èµ·ï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼Œè¯·é—®å¦‚ä½•è§£å†³  ERROR c.a.o.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta - scheudle applySnapshotToDB faield com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: should execute connector.connect() first Caused by: java.io.IOException: should execute connector.connect() first         at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.<init>(MysqlQueryExecutor.java:30) ~[canal.parse.driver-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:87) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.compareTableMetaDbAndMemory(DatabaseTableMeta.java:294) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.applySnapshotToDB(DatabaseTableMeta.java:251) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.access$100(DatabaseTableMeta.java:45) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta$2.run(DatabaseTableMeta.java:84) ~[canal.parse-1.0.25.jar:na]         at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [na:1.8.0_144]         at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308) [na:1.8.0_144]         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180) [na:1.8.0_144]         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294) [na:1.8.0_144]         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_144]         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_144] å‡çº§ä¸€ä¸‹æ–°ç‰ˆæœ¬
498,ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel 2018-01-19 17:31:34.593 [New I/O server worker #1-1] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x120de79e  /127.0.0.1:51432 :> /127.0.0.1:11111]  exception=java.nio.channels.ClosedChannelException 	at org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:649) 	at org.jboss.netty.channel.socket.nio.NioWorker.writeFromUserCode(NioWorker.java:370) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:137) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76) 	at org.jboss.netty.channel.Channels.write(Channels.java:611) 	at org.jboss.netty.channel.Channels.write(Channels.java:578) 	at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:28) 	at com.alibaba.otter.canal.server.netty.NettyUtils.ack(NettyUtils.java:35) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:80) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.cleanup(ReplayingDecoder.java:542) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.channelDisconnected(ReplayingDecoder.java:450) 	at org.jboss.netty.channel.Channels.fireChannelDisconnected(Channels.java:360) 	at org.jboss.netty.channel.socket.nio.NioWorker.close(NioWorker.java:599) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:119) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76) 	at org.jboss.netty.channel.Channels.close(Channels.java:720) 	at org.jboss.netty.channel.AbstractChannel.close(AbstractChannel.java:208) 	at org.jboss.netty.channel.ChannelFutureListener$1.operationComplete(ChannelFutureListener.java:46) 	at org.jboss.netty.channel.DefaultChannelFuture.notifyListener(DefaultChannelFuture.java:381) 	at org.jboss.netty.channel.DefaultChannelFuture.addListener(DefaultChannelFuture.java:148) 	at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:30) 	at com.alibaba.otter.canal.server.netty.NettyUtils.error(NettyUtils.java:51) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:200) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:444) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:350) 	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:281) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:201) 	at org.jboss.netty.util.internal.IoWorkerRunnable.run(IoWorkerRunnable.java:46) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) 	at java.lang.Thread.run(Thread.java:748) è¿™è°çŸ¥é“è¿™æ˜¯ä»€ä¹ˆé”™è¯¯ç ï¼Ÿ ERROR com.alibaba.otter.canal.server.netty.NettyUtils - ErrotCode:400   Caused by :  something goes wrong with channel:[id: 0x27361109  /172.50.3.52:37230 => /172.50.3.52:11111]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: ack error   clientId:1001 batchId:6135 is not exist   please check 2018-02-08 13:36:55.521 [New I/O server worker #1-7] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x27361109  /172.50.3.52:37230 :> /172.50.3.52:11111]  exception=java.nio.channels.ClosedChannelException 	at org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:649) 	at org.jboss.netty.channel.socket.nio.NioWorker.writeFromUserCode(NioWorker.java:370) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:137) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76) 	at org.jboss.netty.channel.Channels.write(Channels.java:611) 	at org.jboss.netty.channel.Channels.write(Channels.java:578) 	at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:28) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:144) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.cleanup(ReplayingDecoder.java:542) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.channelDisconnected(ReplayingDecoder.java:450) 	at org.jboss.netty.channel.Channels.fireChannelDisconnected(Channels.java:360) 	at org.jboss.netty.channel.socket.nio.NioWorker.close(NioWorker.java:599) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:119) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76) 	at org.jboss.netty.channel.Channels.close(Channels.java:720) 	at org.jboss.netty.channel.AbstractChannel.close(AbstractChannel.java:208) 	at org.jboss.netty.channel.ChannelFutureListener$1.operationComplete(ChannelFutureListener.java:46) 	at org.jboss.netty.channel.DefaultChannelFuture.notifyListener(DefaultChannelFuture.java:381) 	at org.jboss.netty.channel.DefaultChannelFuture.addListener(DefaultChannelFuture.java:148) 	at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:30) 	at com.alibaba.otter.canal.server.netty.NettyUtils.error(NettyUtils.java:51) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:200) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:276) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndfireMessageReceived(ReplayingDecoder.java:526) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:507) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:444) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:350) 	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:281) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:201) 	at org.jboss.netty.util.internal.IoWorkerRunnable.run(IoWorkerRunnable.java:46) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) 	at java.lang.Thread.run(Thread.java:748) ack ä¸èƒ½ç¡®è®¤åœ¨å¾€å®¢æˆ·ç«¯å†™çš„æ—¶å€™ï¼ŒbatchIdä¸å­˜åœ¨ã€‚batchsize=1000 @FataliBud è¿™ä¸ªé—®é¢˜è§£å†³äº†å—ï¼Ÿå®¢æˆ·ç«¯å¹¶æ²¡æœ‰é‡å¤è¿›è¡Œackï¼Œä½†æ˜¯ç¡®å®ä¼šæŠ¥è¿™ä¸ªé”™è¯¯ã€‚ è¿™ä¸ªé—®é¢˜æœ‰äººè§£å†³å—ï¼Ÿ è¿™ä¸ªæˆ‘è§‰å¾—æ˜¯å®¢æˆ·ç«¯è¿æ¥è¶…æ—¶å¯¼è‡´çš„ï¼Œæˆ‘å»¶é•¿çš„å®¢æˆ·ç«¯çš„è¿æ¥æ—¶é—´ï¼Œåœ¨SIMPLECONNECTORä¸­ã€‚ è¯·é—®è¿™ä¸ªé—®é¢˜æœ‰äººè§£å†³äº†å—....... ack error   clientId:1001 batchId:6135 is not exist   please checkã€‚ æœåŠ¡ç«¯åšäº†æ‰¹æ¬¡å›æ»šå§ @agapple èƒ½ä¸èƒ½ç»™ä¸ªè§£å†³æ–¹æ¡ˆï¼Œæˆ–è€…ï¼Œè¿™ä¸ªæ˜¯bugå§ï¼Œä»€ä¹ˆæ—¶å€™èƒ½æ›´æ–°ä¸‹å•Šï¼Œè°¢è°¢ï¼ å‚è€ƒclientçš„demoï¼Œåšä¸€ä¸‹rollbackå†é‡æ–°è®¢é˜…ä¸€ä¸‹ https://github.com/alibaba/canal/issues/640ï¼Œå…³æ³¨ä¸€ä¸‹è¿™ä¸ª
497,é€šä¿¡æ¨¡å—logå°ä¼˜åŒ– ä»¥debugä¸ºä¾‹ï¼Œformatå‚æ•°è¾“å‡ºæœ‰ä»¥ä¸‹å‡ ä¸ªé‡è½½ï¼š public void debug(String format  Object arg); public void debug(String format  Object arg1  Object arg2); public void debug(String format  Object... arguments); æœ‰å¦‚ä¸‹æ³¨é‡Šï¼š This form avoids superfluous string concatenation when the logger is disabled for the DEBUG level. However  this variant incurs the hidden (and relatively small) cost of creating an Object[] before invoking the method  even if this logger is disabled for DEBUG. **The variants taking one and two arguments exist solely in order to avoid this hidden cost.** getå’Œackçš„è°ƒç”¨æ¯”è¾ƒé¢‘ç¹ï¼Œå³ä½¿æ—¥å¿—çº§åˆ«è¾ƒé«˜ä¹Ÿä¼šæœ‰åˆ›å»ºæ•°ç»„çš„å¼€é”€ï¼Œä¼šå¸¦æ¥ä¸€äº›æ€§èƒ½å½±å“ã€‚æ‰€ä»¥å¯¹äºå‚æ•°<=2ï¼Œç”¨é‡è½½çš„å‡½æ•°ã€‚å‚æ•°>2ç”¨logger.isInfoEnabled()ã€‚ tksï¼Œç²¾ç›Šæ±‚ç²¾
496,Merge pull request #1 from alibaba/master merge from master [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=496) <br/>All committers have signed the CLA. [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=496) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=496) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=496) it.</sub>
495,æŒ‰exampleä¸‹çš„ä¾‹å­å†™canal clientè®¢é˜…binlogæ•°æ®ï¼Œæ— æ³•å–åˆ°æ•°æ® æŒ‰exampleä¸‹çš„ä¾‹å­å†™canal clientè®¢é˜…binlogæ•°æ®ï¼Œå¯åŠ¨åï¼Œideaçš„æ§åˆ¶å°ä¼šä¸æ–­è¾“å‡ºDEBUG org.apache.zookeeper.ClientCnxn - Got ping response for sessionidè¿™æ ·çš„æ—¥å¿—ï¼Œåœ¨mysql>ä¸‹æ‰§è¡ŒDDLæˆ–DMLæ“ä½œæ— æ³•è¾“å‡ºbinglogç›¸å…³æ—¥å¿—æ•°æ® å…ˆå¥½å¥½çœ‹ä¸‹wikiï¼Œåº”è¯¥æ˜¯æœ‰åœ°æ–¹é…ç½®ä¸æ­£ç¡®å¯¼è‡´ã€‚ @olin017 æˆ‘ä¹Ÿé‡åˆ°äº†ä¸€æ ·çš„é—®é¢˜ï¼Œ æˆ‘ç”¨çš„ç‰ˆæœ¬æ˜¯ 1.0.25 mysqlç‰ˆæœ¬æ˜¯ mysql  Ver 14.14 Distrib 5.7.21  for Linux (x86_64) using  EditLine wrapper è¯•è¿‡å„ç§æ–¹æ³•ï¼Œå§‹ç»ˆæ— æ³•è·å–åˆ°binlogå˜åŠ¨ã€‚ è¯·é—®ä½ çš„é—®é¢˜è§£å†³äº†å—ï¼Ÿå¯ä»¥è¯´ä¸€ä¸‹è§£å†³æ–¹æ³•å—ï¼Ÿ æ¢æˆ1.0.20ï¼Œä¸€æ ·çš„é…ç½®ï¼Œé—®é¢˜è§£å†³ã€‚ä¸ºäº†è¿›ä¸€æ­¥ç¡®å®šé—®é¢˜ï¼Œå†æ¢æˆ1.0.25ï¼Œä¾æ—§æ— æ³•è·å–ä»»ä½•db changeã€‚ å…·ä½“åŸå› ä¸çŸ¥é“ ï¼Œå»ºè®®ä¸è¦ç”¨å¤ªæ–°çš„ç‰ˆæœ¬ã€‚ æˆ‘æƒ³ç€æœ‰äººä¹Ÿåº”è¯¥é‡åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œåˆšå¥½åœ¨è¿™é‡Œæ‰¾åˆ°äº†ï¼Œ1.0.25ç‰ˆæœ¬ä½¿ç”¨å„ç§æ–¹æ³•æ‰”æ— æ³•è·å–binlogæ›´æ–°ï¼ŒæŒ‰æ¥¼ä¸Šè¯´çš„æ¢æˆ1.0.20ç‰ˆæœ¬è§£å†³é—®é¢˜ï¼Œè°¢äº†å°ä¼™ä¼´ä»¬ã€‚ä¸æ¸…æ¥šé«˜ç‰ˆæœ¬ä¸ºä»€ä¹ˆæ— æ³•è·å–å˜åŠ¨ã€‚ é—®é¢˜è§£å†³äº†å—ï¼Ÿæ˜¯å¦å’Œbinlogæ–‡ä»¶çš„åç§°æ ¼å¼æœ‰å…³ï¼Ÿ å’Œcanalç‰ˆæœ¬æœ‰å…³ç³» | | è™«è™«åŒå­¦ é‚®ç®±ï¼šaiyabeetle@163.com | ç­¾åç”± ç½‘æ˜“é‚®ç®±å¤§å¸ˆ å®šåˆ¶ åœ¨2018å¹´06æœˆ13æ—¥ 09:37ï¼Œfanpeng å†™é“ï¼š é—®é¢˜è§£å†³äº†å—ï¼Ÿæ˜¯å¦å’Œbinlogæ–‡ä»¶çš„åç§°æ ¼å¼æœ‰å…³ï¼Ÿ â€” You are receiving this because you commented. Reply to this email directly  view it on GitHub  or mute the thread. å»ºè®®æ¢æˆ1.0.26
494,å¯åŠ¨æ­£å¸¸ï¼Œæ›´æ–°æ•°æ®åæŠ¥é”™ ä¸‹è½½v1.0.26 alpha 1ç‰ˆæœ¬ï¼Œæ ¹æ®ç½‘ç«™ä¸Šçš„è¯´æ˜ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼›åˆ›å»ºæ•°æ®åº“ï¼štest; å¯åŠ¨ç¨‹åºï¼Œåœ¨testæ•°æ®åº“é‡Œçš„testè¡¨æ’å…¥ä¸€æ¡æ•°æ®ï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼Œé”™è¯¯ä¿¡æ¯é‡Œé¢æ˜¾ç¤ºçš„å…¶ä»–åº“é‡Œé¢çš„è¡¨ã€‚ä¸ºä»€ä¹ˆæˆ‘æ›´æ–°teståº“ï¼Œä¼šæŠ¥å…¶ä»–åº“çš„é”™è¯¯ï¼Ÿ [root@localhost canal]# tail -f logs/canal/canal.log  2018-01-17 23:05:53.957 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## set default uncaught exception handler 2018-01-17 23:05:54.022 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## load canal configurations 2018-01-17 23:05:54.023 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## start the canal server. 2018-01-17 23:05:54.069 [main] INFO  com.alibaba.otter.canal.deployer.CanalController - ## start the canal server[192.168.122.1:11111] 2018-01-17 23:05:54.591 [main] WARN  o.s.beans.GenericTypeAwarePropertyDescriptor - Invalid JavaBean property 'connectionCharset' being accessed! Ambiguous write methods found next to actually used [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.lang.String)]: [public void com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.setConnectionCharset(java.nio.charset.Charset)] 2018-01-17 23:05:54.847 [main] ERROR com.alibaba.druid.pool.DruidDataSource - testWhileIdle is true  validationQuery not set 2018-01-17 23:05:55.127 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## the canal server is running now ...... 2018-01-17 23:05:55.968 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just show master status 2018-01-17 23:06:09.929 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TABLE `columns_priv` (   `Host` char(60) COLLATE utf8_bin NOT NULL DEFAULT ''   `Db` char(64) COLLATE utf8_bin NOT NULL DEFAULT ''   `User` char(16) COLLATE utf8_bin NOT NULL DEFAULT ''   `Table_name` char(64) COLLATE utf8_bin NOT NULL DEFAULT ''   `Column_name` char(64) COLLATE utf8_bin NOT NULL DEFAULT ''   `Timestamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP   `Column_priv` set('Select' 'Insert' 'Update' 'References') CHARACTER SET utf8 NOT NULL DEFAULT ''   PRIMARY KEY (`Host` `Db` `User` `Table_name` `Column_name`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='Column privileges' com.alibaba.druid.sql.parser.ParserException: syntax error  error in :'es') CHARACTER SET utf8 NOT NULL DE'  expect RPAREN  actual IDENTIFIER pos 479  line 8  column 62  token IDENTIFIER CHARACTER 	at com.alibaba.druid.sql.parser.SQLParser.printError(SQLParser.java:283) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.parser.SQLParser.accept(SQLParser.java:292) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlCreateTableParser.parseCreateTable(MySqlCreateTableParser.java:191) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseCreate(MySqlStatementParser.java:244) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:159) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:464) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:295) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:69) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:177) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.7.0_79] 2018-01-17 23:06:09.930 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : CREATE TABLE `db` (   `Host` char(60) COLLATE utf8_bin NOT NULL DEFAULT ''   `Db` char(64) COLLATE utf8_bin NOT NULL DEFAULT ''   `User` char(16) COLLATE utf8_bin NOT NULL DEFAULT ''   `Select_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Insert_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Update_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Delete_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Drop_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Grant_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `References_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Index_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Alter_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_tmp_table_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Lock_tables_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_view_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Show_view_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Create_routine_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Alter_routine_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Execute_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Event_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   `Trigger_priv` enum('N' 'Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N'   PRIMARY KEY (`Host` `Db` `User`)   KEY `User` (`User`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='Database privileges' com.alibaba.druid.sql.parser.ParserException: syntax error  error in :''Y') CHARACTER SET utf8 NOT NULL DE'  expect RPAREN  actual IDENTIFIER pos 225  line 5  column 31  token IDENTIFIER CHARACTER 	at com.alibaba.druid.sql.parser.SQLParser.printError(SQLParser.java:283) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.parser.SQLParser.accept(SQLParser.java:292) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlCreateTableParser.parseCreateTable(MySqlCreateTableParser.java:191) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseCreate(MySqlStatementParser.java:244) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:159) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] 	at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:464) ~[druid-1.1.7-preview_0.jar:1.1.7-preview_0] ä¸€æ¨¡ä¸€æ ·çš„é”™ æ€ä¹ˆè§£å†³? @kaikewang è¿™ä¸ªé—®é¢˜çš„å¼•èµ·åŸå› æ˜¯åˆ›å»ºè¡¨çš„SQLè¯­å¥æœ‰â€œ)"é€ æˆï¼Œæ¯”å¦‚æšä¸¾ç±»å‹çš„å­—æ®µï¼Œå°½é‡é¿å…ï¼Œè¿˜æœ‰ç³»ç»Ÿæ•°æ®åº“ä¸­çš„æœ‰äº›å­—æ®µæ˜¯æšä¸¾çš„ï¼Œä¹Ÿä¼šæŠ¥é”™ï¼Œåªè¦ä¸ç›‘å¬è¿™äº›åº“çš„å˜åŒ–å°±å¯ä»¥è§£å†³ã€‚ å¯ä»¥æŠŠå®ä¾‹ä¸‹é¢çš„åŒ¹é…æ‰€æœ‰åº“ï¼Œä¿®æ”¹ä¸ºåªåŒ¹é…ç‰¹å®šçš„åº“ï¼š ``` # table regex canal.instance.filter.regex=test\\.* ``` ä¾èµ–çš„druidç‰ˆæœ¬æ²¡æ›´æ–°å§ï¼Ÿæˆ–è€…å°†tsdbçš„ç‰¹æ€§å…³é—­ä¹Ÿå¯ä»¥ã€‚ druidå‡çº§åˆ°1.1.8äº†ï¼Œå¯ä»¥è§£å†³setç±»å‹çš„é—®é¢˜ @wingerx å¦‚ä½•å…³é—­ tsdbç‰¹æ€§ï¼Ÿ é‡åˆ°äº†åŒæ ·çš„é—®é¢˜ã€‚ æŠŠconf/canal.propertiesè¿™ä¸ªæ–‡ä»¶é‡Œï¼Œä¸‹é¢ä¸€è¡Œæ³¨é‡Šæ‰ï¼Œé‡å¯å°±å¥½äº†ã€‚ #canal.instance.tsdb.spring.xml=classpath:spring/tsdb/h2-tsdb.xml å‡çº§druidç‰ˆæœ¬å·²ç»æ¥è¿‘
493,1.0.25 ç‰ˆæœ¬è®¾ç½®è¶…æ—¶æŠ¥é”™ #492  æˆ‘å†è¿™ä¸ªbugä¸­æƒ³è§£å†³è¯»å–å¡ä¸»çš„é—®é¢˜ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯è¯´åœ¨1.0.25ä¸­ä½¿ç”¨æ–°çš„æœºåˆ¶å‚è€ƒ #297  ä½†æ˜¯æˆ‘å‘ç°æˆ‘è®¾ç½®è¶…æ—¶ä¼šæŠ¥é”™ï¼Œä¸è®¾ç½®è¶…æ—¶åè€Œä¼šæ­£ç¡® ![image](https://user-images.githubusercontent.com/11556152/34980458-936b5baa-fadf-11e7-8497-7a00673f6810.png) ![image](https://user-images.githubusercontent.com/11556152/34981797-95c6a5f4-fae3-11e7-851f-4ec4359c51f1.png) ä½ è¿™ä¸ªè¶…æ—¶å’Œ297çš„è¶…æ—¶æ˜¯ä¸¤å›äº‹ @agapple   è°¢è°¢ç™¾å¿™ä¹‹ä¸­å›å¤å•Šï¼Œ åœ¨ç¬¬ä¸€ä¸ªé—®é¢˜é‡Œé¢å»ºè®®æ˜¯è®¾ç½®è¶…æ—¶æ—¶é—´çš„ï¼Œä½†æ˜¯åœ¨1.0.25 æˆ‘åªè¦å·²è®¾ç½® è¶…æ—¶æ—¶é—´å°±æŠ¥socketTimoutException  ä½†æ˜¯åœ¨1.0.24 ç‰ˆæœ¬ä¸ä¼šæœ‰è¿™ä¸ªé”™ã€‚ å°±æ˜¯æƒ³é—®ä¸€ä¸‹è¿™ä¸ªè¡Œä¸ºæ˜¯å¦æ˜¯ä¸€ä¸ªé¢„æœŸç»“æœå‘¢ã€‚ 1.0.25æ”¹åŠ¨è¿‡canal serverç«¯è¯»å–mysqlçš„è¶…æ—¶æœºåˆ¶ï¼Œé»˜è®¤æ˜¯3ç§’ï¼Œä¸è¿‡ä½ è¿™ä¸ªè¶…æ—¶å‘é€çš„é¢‘ç‡ä¹Ÿå¤ªé«˜äº†ï¼Œå·®ç½‘ç»œæ¡ä»¶ï¼Ÿ
492,æ˜¯å¦è¦è®¾ç½®getWithoutAckè¶…æ—¶æ—¶é—´ è¯´çœŸçš„ï¼Œæˆ‘è¢«è¿™è¶…æ—¶æ—¶é—´æå¾—å¤´ç—›ï¼Œæˆ‘æœ¬æ¥æ˜¯ä¸è®¾ç½®è¶…æ—¶æ—¶é—´çš„ï¼Œä½†æ˜¯å¥½åƒåœ¨å¼±ç½‘ç¯å¢ƒä¼šå¡ä¸»  #å‚è€ƒï¼š #297  åé¢æˆ‘è®¾ç½®è¶…æ—¶ ä»¥åå‘ç°ï¼Œæ˜¯è¯´åœ¨è§„å®šæ—¶é—´å†…ç­‰å¾…batchSize å¡«æ»¡ï¼Ÿï¼Ÿï¼Ÿ å¹¶ä¸”æˆ‘æµ‹è¯•çš„æ—¶å€™ç¡®å®ä¹Ÿæ˜¯çœ‹åˆ°å®åœ¨ç­‰å¾…è¶…æ—¶æ—¶é—´ã€‚ ![image](https://user-images.githubusercontent.com/11556152/34977258-ca958ca0-fad4-11e7-9bc6-703c495e919f.png) ![image](https://user-images.githubusercontent.com/11556152/34976865-61b85a10-fad3-11e7-80ff-adc7770a9f4c.png) æˆ‘åªæƒ³é¿å…å¡ä¸»ï¼Œè¯·é—®æ˜¯å¦ä¸€å®šè¦è®¾ç½®è¶…æ—¶æ—¶é—´ åœ¨ 1.0.25 ç‰ˆæœ¬è®¾ç½®è¶…æ—¶æŠ¥é”™ ![image](https://user-images.githubusercontent.com/11556152/34979214-9c6dc91c-fadb-11e7-9d00-32884b26ecc1.png) å»ºè®®è®¾ç½®timeoutï¼Œä¸»è¦æ˜¯åç«¯å¦‚æœä¸€ç›´æ²¡æœ‰æ•°æ®å˜æ›´ï¼Œä¼šä¸€ç›´å¡ä¸» @agapple   å—¯ å¥½çš„ å¤§æ¦‚ç†è§£ï¼Œæ‰€ä»¥batchSize è¿˜ä¸èƒ½è®¾ç½®å¾ˆå¤§å¯¹å§ï¼Œå¡«ä¸æ»¡å°±ä¸€ç›´å¡ä¸»å¯¹å§
491,log event entry exceeded max_allowed_packet åº”è¯¥æ˜¯æœ‰å¤§äº‹åŠ¡æ—¶ï¼Œä¼šå‡ºç°ä¸‹é¢çš„å¼‚å¸¸ï¼Œcanalä¼šè§£æä¸è¿‡å»ã€‚ 2018-01-12 12:45:20.537 [destination =xxxx   address = /xxxxxx   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = log event entry exceeded max_allowed_packet; Increase max_allowed_packet on master; the first event 'mysql-bin.007177' at 998888207  the last event read from './mysql-bin.007177' at 123  the last byte read from './mysql-bin.007177' at 998888226. 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) ~[canal.parse-1.0.19.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:117) [canal.parse-1.0.19.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) [canal.parse-1.0.19.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.7.0_76] çœ‹åˆ°æœ‰ä¸€ä¸ªå…³äºmax_allowed_packetçš„issuesï¼Œhttps://github.com/alibaba/canal/issues/85   è²Œä¼¼æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜åŠ äº†ç»„åŒ…çš„é€»è¾‘ï¼Œä½†æ˜¯å¥½åƒæ²¡æœ‰ä»€ä¹ˆæ•ˆæœï¼Œå¤§å®¶æœ‰é‡åˆ°è¿™ä¸ªé—®é¢˜çš„ä¹ˆï¼Ÿ å¯ä»¥å…ˆçœ‹çœ‹binlog-row-event-max-sizeå‚æ•°è®¾ç½®æ˜¯å¤šå°‘ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š https://dev.mysql.com/doc/refman/5.7/en/replication-options-binary-log.html#option_mysqld_binlog-row-event-max-size binlog-row-event-max-sizeé»˜è®¤æ˜¯8kï¼Œmax_allowed_packeté»˜è®¤æ˜¯1Mã€‚binlogä¸ä¼šå°†æ€»å’Œ>binlog-row-event-max-sizeçš„rowsåˆåˆ°ä¸€ä¸ªeventä¸­ï¼Œé™¤éå•rowçš„sizeå·²ç»è¶…è¿‡äº†è¿™ä¸ªé™åˆ¶ï¼Œå¹¶ä¸”>max_allowed_packetï¼Œè¿™ä¸ªæ—¶å€™åªèƒ½æ”¹max_allowed_packetäº†ã€‚ è¡¥å……ä¸€ç‚¹ï¼Œ com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection#updateSettings çœ‹ä¸Šå»æ˜¯åœ¨è¿™é‡Œè®¾ç½®max_allowed_packet(éœ€è¦ä½œè€…ç¡®è®¤ä¸‹) updateSettingsæš‚æ—¶æœªåšmax packetå¤§å°çš„è°ƒæ•´ æ€ä¹ˆè§£å†³å•Šï¼Œæˆ‘æŠŠmax_allowed_packet 16mb åŠ åˆ°64è¿˜æ˜¯ä¼šæœ‰é”™è¯¯ å»ºè®®åœ¨mysqlç«¯ä¿®æ”¹å…¨å±€çš„max_allowed_packetï¼Œcanalæœ¬èº«æ”¯æŒå¤špacketçš„é‡æ–°ç»„åŒ…
490,è·å– table çš„æ—¶å€™é“¾æ¥å¤±æ•ˆ  destination çš„ binlog dump é€€å‡º ``` 2018-01-12 00:49:37.659 [destination = test   address = /192.168.1.0:3307   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:test[com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first Caused by: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first         at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4832)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:160)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:759)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:428)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:120)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:66)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:337)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:184)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:145)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220)         at java.lang.Thread.run(Thread.java:745) Caused by: java.io.IOException: should execute connector.connect() first         at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.<init>(MysqlQueryExecutor.java:30)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:87)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMetaByDB(TableMetaCache.java:80)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.access$000(TableMetaCache.java:30)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:55)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:50)         at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3527)         at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2319)         at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2282)         at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2197)         at com.google.common.cache.LocalCache.get(LocalCache.java:3937)         at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3941)         at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4824)         at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4830)         ... 10 more ] ```  è·å– table ä¿¡æ¯çš„æ—¶å€™ä¼šæŠ¥é“¾æ¥å¤±æ•ˆ ç„¶å binlog dump å°±æ­»æ‰äº† ä¸€èˆ¬æ˜¯åœ¨è¿è¡Œæ•°å°æ—¶åå‘ç”Ÿ mysql Server version: 5.6.29 canal ç‰ˆæœ¬:1.0.25 æœ€æ–°çš„ä¸»å¹²ä¿®å¤è¿‡ï¼Œå¯ä»¥å°è¯•ä¸€ä¸‹æœ€æ–°çš„åŒ…
489,canalæ— æ³•è·å–ä»»ä½•æ•°æ® ä½¿ç”¨canal 1.0.24ç‰ˆæœ¬ï¼Œ mysqlç‰ˆæœ¬ä¸º5.7.20ç‰ˆæœ¬ canalå¯åŠ¨åï¼Œæœ‰å¦‚ä¸‹æ—¥å¿—ï¼š WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just show master status å°±ä¸å†æœ‰å…¶ä»–æ—¥å¿—äº†ï¼Œå¹¶ä¸”zookeeperä¸‹1001èŠ‚ç‚¹ä¸­æ²¡æœ‰cursorèŠ‚ç‚¹ã€‚ æ‰“å¼€æ—¥å¿—debugï¼Œä¸€ç›´è¾“å‡ºæ—¥å¿—å¦‚ä¸‹ï¼š getWithoutAck successfully  clientId:1001 batchSize:1000 but result is null å¦å¤–ï¼Œmysqlå¼€å¯äº†gtid_mode = ONï¼Œ åœ¨canaléƒ¨ç½²çš„æœºå™¨ä¸Šé‡‡ç”¨é…ç½®çš„è´¦å·è¿æ¥æ•°æ®åº“å®ä¾‹ï¼Œæ‰§è¡Œshow master statuså¾—åˆ°ï¼š +------------------+-----------+--------------+------------------+-------------------------------------------------------------------------------------------+ | File             | Position  | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set                                                                         | +------------------+-----------+--------------+------------------+-------------------------------------------------------------------------------------------+ | mysql-bin.000506 | 428663296 |              |                  | f6af278c-cf73-11e7-86ed-801844ea454c:1-6 fb35b001-cf73-11e7-9c62-801844e9f00c:1-87011966 | +------------------+-----------+--------------+------------------+-------------------------------------------------------------------------------------------+ å› æ­¤æˆ‘åˆ¤æ–­è´¦å·é…ç½®æ²¡æœ‰é—®é¢˜ï¼Œåº”è¯¥æ˜¯èƒ½è·å–å¾—åˆ°binlog positionçš„ ä¹‹å‰æƒé™è®¾ç½®ä¸ºï¼š GRANT SELECT  REPLICATION SLAVE  REPLICATION CLIENT ON *.* TO 'canal'@'%';   ç°åœ¨æ”¹ä¸ºï¼š RANT ALL PRIVILEGES ON *.* TO 'canal'@'%' ;  ç„¶åé‡æ–°å¯åŠ¨canalï¼Œè¿™æ—¶å‡ºç°å¦‚ä¸‹æ—¥å¿—ï¼š 2018-01-12 11:57:30.620 [destination = 10_64_1_198_3318_instance   address = /10.64.0.101:3318   EventParser] INFO  c.a.otter.canal.parse.inbound.mysql.MysqlConnection - COM_BINLOG_DUMP with position:BinlogDumpCommandPacket[binlogPosition=523583203 slaveServerId=1234 binlogFileName=mysql-bin.000506 command=18] 2018-01-12 11:57:30.633 [destination = 10_64_1_198_3318_instance   address = /10.64.0.101:3318   EventParser] INFO  com.taobao.tddl.dbsync.binlog.LogEvent - common_header_len= 19  number_of_event_types= 38 2018-01-12 11:57:32.987 [New I/O server worker #1-2] INFO  c.a.otter.canal.server.embedded.CanalServerWithEmbedded - subscribe successfully  ClientIdentity[destination=10_64_1_198_3318_instance clientId=1001 filter=] with first position:null  2018-01-12 11:57:33.002 [New I/O server worker #1-2] DEBUG c.a.otter.canal.server.embedded.CanalServerWithEmbedded - getWithoutAck successfully  clientId:1001 batchSize:1000 but result is null è²Œä¼¼è·å–åˆ°äº†positionï¼Œä½†æ˜¯æœ€åæ˜¯nullï¼š...filter=] with first position:null  tcpdumpæŠ“åŒ…æœ‰ binlogçš„åŒ…è¿›æ¥ï¼Œ çœ‹æ¥æ˜¯canalå¤„ç†è¿‡ç¨‹ä¸­çš„é—®é¢˜äº†ï¼Œå¦‚æœæ˜¯binlogè§£æå¤±è´¥ï¼Œåº”è¯¥ä¼šæŠ›å¼‚å¸¸å§ã€‚ å¥½å¥‡æ€ª debugä»£ç å‘ç° canal.instance.memory.buffer.size = 1048576 canal.instance.memory.buffer.memunit = 1024 è¿™ä¸¤ä¸ªå±æ€§ç›¸ä¹˜ä¸èƒ½å¤§äºæœ€å¤§intï¼Œä¸ç„¶ä¼šæº¢å‡ºå¯¼è‡´åœ¨è®¡ç®—å½“å‰bufferå¤§å°çš„æ—¶å€™å‡ºé—®é¢˜ï¼Œæ— æ³•put EVENTã€‚  è¿™å—å»ºè®®æ–‡æ¡£è¯´æ˜ä¸‹ï¼Œå¹¶ä¸”èƒ½å¤ŸæŠ›å‡ºå¼‚å¸¸å°±æ›´å¥½äº† è¿™ä¸ªæ˜¯ä¸€ä¸ªçº¦æŸï¼Œç›®å‰æ˜¯ä¸èƒ½è¶…è¿‡intçš„æœ€å¤§å€¼
488,ç½‘ç»œä¸å¥½æ–­çº¿ï¼Œæ— æ³•å†æ¬¡é“¾æ¥ hi ä½ å¥½ æˆ‘ä»¬å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æˆ‘ä»¬æœåŠ¡å™¨ç½‘ç»œä¸å¥½çš„æ—¶å€™ä¼šå¯¼è‡´å®¢æˆ·ç«¯æ–­å¼€ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°ï¼Œä¸€æ—¦æˆ‘ä»¬ä¸‹çº¿äº†ä»¥åï¼Œæˆ‘ä»¬å®¢æˆ·ç«¯å†ä¹Ÿæ— æ³•é‡æ–°é“¾æ¥è¿‡æ¥ï¼Œ ä¸çŸ¥é“æ˜¯å¦é‡è¿æœºåˆ¶æ²¡æœ‰å·¥ä½œã€‚ ClosedChannelException æ˜¯å¦å°±ä¸ä¼šå†é‡è¿äº†å¯¹ä¹ˆ æ—¥å¿—å¦‚ä¸‹ï¼š 2018-01-10 12:01:38.228 [New I/O server worker #1-8] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x787f32e8  /*************** => /************]  exception=java.io.IOException: Connection timed out 	at sun.nio.ch.FileDispatcherImpl.read0(Native Method) 	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39) 	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223) 	at sun.nio.ch.IOUtil.read(IOUtil.java:192) 	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:321) 	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:280) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:200) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) 	at java.lang.Thread.run(Thread.java:745) 2018-01-10 12:01:38.230 [New I/O server worker #1-8] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x787f32e8  /************* :> /*****************]  exception=java.nio.channels.ClosedChannelException 	at org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:623) 	at org.jboss.netty.channel.socket.nio.NioWorker.close(NioWorker.java:599) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:119) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76) 	at org.jboss.netty.channel.Channels.close(Channels.java:720) 	at org.jboss.netty.channel.AbstractChannel.close(AbstractChannel.java:200) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.exceptionCaught(SessionHandler.java:216) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.exceptionCaught(ReplayingDecoder.java:461) 	at org.jboss.netty.channel.Channels.fireExceptionCaught(Channels.java:432) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:331) 	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:280) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:200) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) 	at java.lang.Thread.run(Thread.java:745) å’Œ bug é‡å¤ #297
487,dump connection is disconnected For SocketChannel.cache instance  when produced data (dump data) is faster than consume data(canal handled data)  it will caused overflow issue. should be flow control. tks
486,canal.instance.filter.regex è¡¨è¿‡æ»¤é—®é¢˜   
485,CanalParseException: parse row data failedï¼ˆv1.0.25ï¼‰ canal serveré‡å¯åå¯ä»¥æ­£å¸¸è¿è¡Œ ä»¥ä¸‹æ˜¯å¼‚å¸¸ä¿¡æ¯ ------------- 2018-01-08 09:36:30.435 [pool-4-thread-1] INFO  com.alibaba.otter.canal.meta.FileMixedMetaManager - clientId:1001 cursor:[mysql-bin.000914 191343375 1515375389000] address[xxxxxx:3306] 2018/1/8 ä¸Šåˆ9:36:312018-01-08 09:36:31.435 [pool-4-thread-1] INFO  com.alibaba.otter.canal.meta.FileMixedMetaManager - clientId:1001 cursor:[mysql-bin.000914 191344652 1515375390000] address[xxxxxx:3306] 2018/1/8 ä¸Šåˆ9:36:322018-01-08 09:36:32.435 [pool-4-thread-1] INFO  com.alibaba.otter.canal.meta.FileMixedMetaManager - clientId:1001 cursor:[mysql-bin.000914 191346634 1515375391000] address[xxxxxx:3306] 2018/1/8 ä¸Šåˆ9:36:332018-01-08 09:36:33.435 [pool-4-thread-1] INFO  com.alibaba.otter.canal.meta.FileMixedMetaManager - clientId:1001 cursor:[mysql-bin.000914 191348091 1515375392000] address[xxxxxx:3306] 2018/1/8 ä¸Šåˆ9:36:342018-01-08 09:36:34.435 [pool-4-thread-1] INFO  com.alibaba.otter.canal.meta.FileMixedMetaManager - clientId:1001 cursor:[mysql-bin.000914 191349500 1515375393000] address[xxxxxx:3306] 2018/1/8 ä¸Šåˆ9:36:342018-01-08 09:36:34.475 [destination = xxxxxxx   address = xxxxxxxxxxx: 3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - ERROR ## parse this event has an error   last position : [EntryPosition[included=false journalName=mysql-bin.000914 position=191349531 serverId=200 timestamp=1515375394000]] 2018/1/8 ä¸Šåˆ9:36:34com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. 2018/1/8 ä¸Šåˆ9:36:34Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first 2018/1/8 ä¸Šåˆ9:36:34Caused by: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4832) ~[guava-18.0.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:160) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:759) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:428) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:114) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:66) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:337) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:184) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:145) [canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220) [canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at java.lang.Thread.run(Thread.java:745) [na:1.8.0_111] 2018/1/8 ä¸Šåˆ9:36:34Caused by: java.io.IOException: should execute connector.connect() first 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.<init>(MysqlQueryExecutor.java:30) ~[canal.parse.driver-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:87) [canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMetaByDB(TableMetaCache.java:80) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.access$000(TableMetaCache.java:30) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:55) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:50) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3527) ~[guava-18.0.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2319) ~[guava-18.0.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2282) ~[guava-18.0.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2197) ~[guava-18.0.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache.get(LocalCache.java:3937) ~[guava-18.0.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3941) ~[guava-18.0.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4824) ~[guava-18.0.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4830) ~[guava-18.0.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  ... 10 common frames omitted 2018/1/8 ä¸Šåˆ9:36:342018-01-08 09:36:34.479 [destination = weiming-test   address = xxxxxx:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address xxxxxx:3306 has an error  retrying. caused by 2018/1/8 ä¸Šåˆ9:36:34com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. 2018/1/8 ä¸Šåˆ9:36:34Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. 2018/1/8 ä¸Šåˆ9:36:34Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first 2018/1/8 ä¸Šåˆ9:36:34Caused by: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4832) ~[guava-18.0.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:160) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:759) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:428) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:114) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:66) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:337) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:184) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:145) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at java.lang.Thread.run(Thread.java:745) [na:1.8.0_111] 2018/1/8 ä¸Šåˆ9:36:34Caused by: java.io.IOException: should execute connector.connect() first 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.<init>(MysqlQueryExecutor.java:30) ~[canal.parse.driver-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:87) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMetaByDB(TableMetaCache.java:80) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.access$000(TableMetaCache.java:30) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:55) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:50) ~[canal.parse-1.0.25.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3527) ~[guava-18.0.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2319) ~[guava-18.0.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2282) ~[guava-18.0.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2197) ~[guava-18.0.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache.get(LocalCache.java:3937) ~[guava-18.0.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3941) ~[guava-18.0.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4824) ~[guava-18.0.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4830) ~[guava-18.0.jar:na] 2018/1/8 ä¸Šåˆ9:36:34  ... 10 common frames omitted 2018/1/8 ä¸Šåˆ9:36:342018-01-08 09:36:34.480 [destination = weiming-test   address = xxxxxx:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:weiming-test[com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. 2018/1/8 ä¸Šåˆ9:36:34Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. 2018/1/8 ä¸Šåˆ9:36:34Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first 2018/1/8 ä¸Šåˆ9:36:34Caused by: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4832) 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:160) 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:759) 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:428) 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:114) 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:66) 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:337) 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:184) 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:145) 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220) 2018/1/8 ä¸Šåˆ9:36:34  at java.lang.Thread.run(Thread.java:745) 2018/1/8 ä¸Šåˆ9:36:34Caused by: java.io.IOException: should execute connector.connect() first 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.<init>(MysqlQueryExecutor.java:30) 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:87) 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMetaByDB(TableMetaCache.java:80) 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.access$000(TableMetaCache.java:30) 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:55) 2018/1/8 ä¸Šåˆ9:36:34  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:50) 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3527) 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2319) 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2282) 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2197) 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache.get(LocalCache.java:3937) 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3941) 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4824) 2018/1/8 ä¸Šåˆ9:36:34  at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4830) 2018/1/8 ä¸Šåˆ9:36:34  ... 10 more 2018/1/8 ä¸Šåˆ9:36:34] å‚è€ƒ #482 
484,å¸Œæœ›åç»­æœ‰å¯¹ Docker æ”¯æŒçš„è®¡åˆ’ï¼Œç¯å¢ƒè°ƒè¯•ç‰¹åˆ«ä¸æ–¹ä¾¿ã€‚ æˆ‘æœ¬æ¥æ‰“ç®—è‡ªå·±å°è£…é•œåƒçš„ï¼Œæˆ‘å‘ç°éœ€è¦è‡ªå·±å†™ `docker entrypoint.sh` ä¸è¯´ï¼Œä¸»è¦æ˜¯æ—¥å¿—è¿˜æœ‰é…ç½®çš„å¤„ç†éœ€è¦åœ¨åº”ç”¨å±‚åšä¸€äº›å·¥ä½œæœæ–­æ”¾å¼ƒäº†ï¼Œå¸Œæœ›å®˜æ–¹åç»­å¯¹ Docker è¿›è¡Œæ”¯æŒã€‚ æˆ‘ä»¬è‡ªå·±åšäº†ä¸€ä¸ªé•œåƒï¼Œéœ€è¦çš„è¯ï¼Œå¯ä»¥äº¤æµä¸€ä¸‹ï¼Œå¾®ä¿¡gary0526 @freeme ä½ æ–¹ä¾¿æŠŠä½ çš„ `dockerfile` çš„ä»“åº“é“¾æ¥å‘ä¸€ä¸‹å—ï¼Ÿ  > BTW: ä½ å°è£…çš„é•œåƒæ˜¯æ”¹é€ è¿‡å®˜æ–¹çš„ä»£ç å—ï¼Ÿ æˆ‘è¿™è¾¹æœŸæœ›çš„é•œåƒåŠŸèƒ½æœ‰å¦‚ä¸‹ä¸¤ç‚¹ä¸»è¦ç‰¹æ€§ï¼š * æ—¥å¿—å¯ä»¥ç»Ÿä¸€è¾“å‡ºå¹¶æœ‰æ•ˆé€šè¿‡ `docker logging` æ§åˆ¶æ”¶é›†ï¼› * å¯ä»¥é€šè¿‡ `docker environment` ç¯å¢ƒå˜é‡æ§åˆ¶æ ¸å¿ƒé…ç½®ï¼› ä¿®æ”¹startup.shæ–‡ä»¶ï¼Œå˜æˆå‰å°åº”ç”¨å°±å¥½äº†ã€‚ @pczhaoyun è„šæœ¬åªæ˜¯å…¶ä¸­ä¸€æ–¹é¢ï¼Œåº”ç”¨æœ¬èº«çš„æ—¥å¿—å’Œé…ç½®ä¹Ÿè¦åšç›¸åº”é€‚åº”æ€§å¤„ç†çš„ï¼Œå¦åˆ™ä¾ç„¶ç®¡ç†éº»çƒ¦çš„ã€‚ @freeme å¯ä»¥æäº¤ä¸€ä¸ªdockerfile PR æ˜¯å•Šï¼Œæœ‰è¿™ä¸ªä¼šæ–¹ä¾¿å¾ˆå¤š dockerå·²ç»æ”¯æŒï¼Œå‚è€ƒï¼šhttps://github.com/alibaba/canal/wiki/Docker-QuickStart
483,å»ºè®®æ–°å¢ReportSlaveæ¶ˆæ¯ ç°åœ¨è¿ä¸ŠMysqlæ—¶ï¼Œè¿æ¥æˆåŠŸåå°±ç›´æ¥RequestDumpäº†ï¼Œæ‰€ä»¥åœ¨Mysqlä¸Šæ•²show slave hostsï¼Œçœ‹ä¸åˆ°å½“å‰è¿™æ¡Canalè¿æ¥ã€‚è™½ç„¶ä¸å½±å“æ•°æ®åŒæ­¥ï¼Œä½†å¯¹äºå¼ºè¿«ç—‡æ¥è¯´ï¼Œå¥½ä¸èˆ’æœã€‚ è§£å†³æ–¹æ¡ˆæ˜¯åœ¨RequestDumpä¹‹å‰å‘ä¸€æ¡ReportSlaveæ¶ˆæ¯ä¸ŠæŠ¥è‡ªå·±ï¼Œå†æ”¶å›ä¸€æ¡OKæ¶ˆæ¯ï¼Œå°±å¯ä»¥äº†ã€‚ æ¶ˆæ¯å†…å®¹ä»£ç å¦‚ä¸‹ï¼š [RegisterSlaveCommandPacket.java.txt](https://github.com/alibaba/canal/files/1610961/RegisterSlaveCommandPacket.java.txt) ç„¶ååœ¨MysqlConnection.javaä¸­å¢åŠ å¦‚ä¸‹å‡½æ•°ï¼Œåœ¨dump()ä¸­è°ƒç”¨å°±å¥½äº†ã€‚     private void sendRegisterSlave() throws IOException {     	RegisterSlaveCommandPacket cmd = new RegisterSlaveCommandPacket();     	cmd.setReport_host(canalHost);     	cmd.setReport_port(canalPort);     	cmd.setReport_user(connector.getUsername());     	cmd.setServerid(slaveId);     	     	byte[] cmdBody = cmd.toBytes();         logger.info("Register slave {}"  cmd);         HeaderPacket header = new HeaderPacket();         header.setPacketBodyLength(cmdBody.length);         header.setPacketSequenceNumber((byte) 0x00);         PacketManager.write(connector.getChannel()  new ByteBuffer[] { ByteBuffer.wrap(header.toBytes())                 ByteBuffer.wrap(cmdBody) });                  ByteBuffer dest = ByteBuffer.allocate(1024);         connector.getChannel().read(dest);     } å…¶ä¸­çš„å˜é‡æˆ‘æ˜¯é€šè¿‡æ”¹Springçš„xmlï¼Œä»é…ç½®æ–‡ä»¶ä¸­æ‹¿çš„ã€‚ æŒºå¥½çš„ä¼˜åŒ–ï¼Œæ–¹ä¾¿æäº¤ä¸€ä¸ªä»£ç PRç»™æˆ‘ï¼Ÿ æœ€æ–°çš„release æ²¡æœ‰å¸¦å‡ºè¿™ä¸ªç‰¹æ€§å—ï¼Ÿæˆ‘ä¸‹è½½äº†å°è¯•ï¼Œå‘ç°show slave hosts ä»ç„¶æ²¡æœ‰å‘ç°canal serverä¿¡æ¯ã€‚ 26çš„æµ‹è¯•ç‰ˆæœ¬åº”è¯¥æœ‰äº† äº²æµ‹ æœ€æ–°ç‰ˆ1.10ä¸­æ²¡æœ‰å™¢ã€‚ åªæœ‰åœ¨è¿›å…¥dumpé˜¶æ®µæ‰ä¼šæœ‰show slave hostsï¼Œé’ˆå¯¹ä½ç‚¹å®šä½é˜¶æ®µæ²¡æœ‰
482,first parse row data failed should execute connector.connect()  æœ€è¿‘å‡Œæ™¨æŠ¥é”™è¿™ä¸ªï¼Œå¯¼è‡´channelæŒ‚èµ·ï¼Œmysql :5.6.35  canal:1.0.25 2018-01-07 00:00:00.085 [destination = sms_log_2   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - ERROR ## parse this event has an error   last position : [EntryPosition[included=false journalName=mysql-bin.000106 position=583737799 serverId=20563 timestamp=1515254400000]] com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first Caused by: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first 	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4832) ~[guava-18.0.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:160) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:759) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:428) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:114) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:66) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:337) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:184) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:145) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220) [canal.parse-1.0.25.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_151] Caused by: java.io.IOException: should execute connector.connect() first 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.<init>(MysqlQueryExecutor.java:30) ~[canal.parse.driver-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:87) [canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMetaByDB(TableMetaCache.java:80) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.access$000(TableMetaCache.java:30) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:55) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:50) ~[canal.parse-1.0.25.jar:na] 	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3527) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2319) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2282) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2197) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache.get(LocalCache.java:3937) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3941) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4824) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4830) ~[guava-18.0.jar:na] 	... 10 common frames omitted 2018-01-07 00:00:00.087 [destination = sms_log_2   address = /127.0.0.1:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address 127.0.0.1/127.0.0.1:3306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first Caused by: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first 	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4832) ~[guava-18.0.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:160) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:759) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:428) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:114) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:66) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:337) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:184) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:145) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220) ~[canal.parse-1.0.25.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_151] Caused by: java.io.IOException: should execute connector.connect() first 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.<init>(MysqlQueryExecutor.java:30) ~[canal.parse.driver-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:87) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMetaByDB(TableMetaCache.java:80) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.access$000(TableMetaCache.java:30) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:55) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:50) ~[canal.parse-1.0.25.jar:na] 	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3527) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2319) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2282) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2197) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache.get(LocalCache.java:3937) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3941) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4824) ~[guava-18.0.jar:na] 	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4830) ~[guava-18.0.jar:na] 	... 10 common frames omitted 2018-01-07 00:00:00.088 [destination = sms_log_2   address = /127.0.0.1:3306   EventParser] WARN  c.a.o.s.a.i.setl.zookeeper.termin.WarningTerminProcess - nid:3[3:canal:sms_log_2:com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first Caused by: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first 	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4832) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:160) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:759) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:428) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:114) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:66) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:337) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:184) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:145) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220) 	at java.lang.Thread.run(Thread.java:748) Caused by: java.io.IOException: should execute connector.connect() first 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.<init>(MysqlQueryExecutor.java:30) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:87) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMetaByDB(TableMetaCache.java:80) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.access$000(TableMetaCache.java:30) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:55) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:50) 	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3527) 	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2319) 	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2282) 	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2197) 	at com.google.common.cache.LocalCache.get(LocalCache.java:3937) 	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3941) 	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4824) 	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4830) 	... 10 more ]    æˆ‘ä¹Ÿé‡åˆ°è¿‡è¿™ä¸ªé—®é¢˜ æˆ‘ä¹Ÿé‡åˆ°äº†ï¼Œå¯¼è‡´ç›‘æµ‹ä¸åˆ°æ¶ˆæ¯ æˆ‘ä¿®å¤ä»¥ä¸‹ åŒæ ·çš„é—®é¢˜ï¼Œå½±å“ä½¿ç”¨å—ï¼Ÿ `com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector .connect() first Caused by: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first         at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4832)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:160)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:759)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:428)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:114)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:66)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:337)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:184)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:145)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220)         at java.lang.Thread.run(Unknown Source)` @agapple 
481,canalè¯»å–Integerå­—æ®µçš„å€¼ä¸ºnullï¼Œå¯ä»¥ä¸æ˜¯""å— ç°åœ¨è¯»å–Integerå­—æ®µå€¼å¦‚æœä¸ºnullï¼Œè¯»å–å‡ºæ¥å°±æ˜¯å­—ç¬¦æ®µ""ï¼ˆç©ºå­—æ®µï¼‰ å¯ä»¥è¯»å‡ºæ¥ä¹Ÿæ˜¯nullå—ï¼Ÿ æœ‰ä¸€ä¸ªisNullæ–¹æ³•çš„åˆ¤æ–­
480,canalå¯åŠ¨æŠ¥é”™com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: ErrorPacket [errorNumber=1142  fieldCount=-1  message=SHOW command denied to user 'shencesys'@'ip' for table 'slow_log'  sqlState=42000  sqlStateMarker=#] å¯åŠ¨ä¹‹åæŠ¥é”™ ``` 2018-01-05 15:36:23.539 [destination = example   address = ip/ip:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just show master status 2018-01-05 15:36:30.095 [destination = example   address = ip/ip:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address ip/ip:3306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: ErrorPacket [errorNumber=1142  fieldCount=-1  message=SHOW command denied to user 'shencesys'@'ip' for table 'slow_log'  sqlState=42000  sqlStateMarker=#]  with command: show create table `mysql`.`event`;show create table `mysql`.`func`;show create table `mysql`.`general_log`;show create table `mysql`.`help_category`;show create table `mysql`.`help_keyword`;show create table `mysql`.`help_relation`;show create table `mysql`.`help_topic`;show create table `mysql`.`proc`;show create table `mysql`.`slow_log`;show create table `mysql`.`time_zone`;show create table `mysql`.`time_zone_leap_second`;show create table `mysql`.`time_zone_name`;show create table `mysql`.`time_zone_transition`;show create table `mysql`.`time_zone_transition_type`; Caused by: java.io.IOException: ErrorPacket [errorNumber=1142  fieldCount=-1  message=SHOW command denied to user 'shencesys'@'ip' for table 'slow_log'  sqlState=42000  sqlStateMarker=#]  with command: show create table `mysql`.`event`;show create table `mysql`.`func`;show create table `mysql`.`general_log`;show create table `mysql`.`help_category`;show create table `mysql`.`help_keyword`;show create table `mysql`.`help_relation`;show create table `mysql`.`help_topic`;show create table `mysql`.`proc`;show create table `mysql`.`slow_log`;show create table `mysql`.`time_zone`;show create table `mysql`.`time_zone_leap_second`;show create table `mysql`.`time_zone_name`;show create table `mysql`.`time_zone_transition`;show create table `mysql`.`time_zone_transition_type`; 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.queryMulti(MysqlQueryExecutor.java:109) ~[canal.parse.driver-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.queryMulti(MysqlConnection.java:93) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:173) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) ~[canal.parse-1.0.25.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) ~[canal.parse-1.0.25.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_45] 2018-01-05 15:36:30.096 [destination = example   address = ip/ip:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: ErrorPacket [errorNumber=1142  fieldCount=-1  message=SHOW command denied to user 'shencesys'@'ip' for table 'slow_log'  sqlState=42000  sqlStateMarker=#]  with command: show create table `mysql`.`event`;show create table `mysql`.`func`;show create table `mysql`.`general_log`;show create table `mysql`.`help_category`;show create table `mysql`.`help_keyword`;show create table `mysql`.`help_relation`;show create table `mysql`.`help_topic`;show create table `mysql`.`proc`;show create table `mysql`.`slow_log`;show create table `mysql`.`time_zone`;show create table `mysql`.`time_zone_leap_second`;show create table `mysql`.`time_zone_name`;show create table `mysql`.`time_zone_transition`;show create table `mysql`.`time_zone_transition_type`; Caused by: java.io.IOException: ErrorPacket [errorNumber=1142  fieldCount=-1  message=SHOW command denied to user 'shencesys'@'ip' for table 'slow_log'  sqlState=42000  sqlStateMarker=#]  with command: show create table `mysql`.`event`;show create table `mysql`.`func`;show create table `mysql`.`general_log`;show create table `mysql`.`help_category`;show create table `mysql`.`help_keyword`;show create table `mysql`.`help_relation`;show create table `mysql`.`help_topic`;show create table `mysql`.`proc`;show create table `mysql`.`slow_log`;show create table `mysql`.`time_zone`;show create table `mysql`.`time_zone_leap_second`;show create table `mysql`.`time_zone_name`;show create table `mysql`.`time_zone_transition`;show create table `mysql`.`time_zone_transition_type`; 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.queryMulti(MysqlQueryExecutor.java:109) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.queryMulti(MysqlConnection.java:93) 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:173) 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) 	at java.lang.Thread.run(Thread.java:745) ``` è´¦å·æƒé™å¦‚ä¸‹ ``` mysql> show grants for shencesys; +---------------------------------------------------------------------------------------------------------------------------------------------------+ | Grants for shencesys@%                                                                                                                            | +---------------------------------------------------------------------------------------------------------------------------------------------------+ | GRANT PROCESS  REPLICATION SLAVE  REPLICATION CLIENT ON *.* TO 'shencesys'@'%' IDENTIFIED BY PASSWORD '***********************************' | | GRANT SELECT  LOCK TABLES  SHOW VIEW ON `xbdchainfin`.* TO 'shencesys'@'%'                                                                        | | GRANT SELECT ON `performance_schema`.* TO 'shencesys'@'%'                                                                                         | | GRANT SELECT ON `mysql`.`func` TO 'shencesys'@'%'                                                                                                 | | GRANT SELECT ON `mysql`.`help_relation` TO 'shencesys'@'%'                                                                                        | | GRANT SELECT ON `mysql`.`time_zone_leap_second` TO 'shencesys'@'%'                                                                                | | GRANT SELECT ON `mysql`.`time_zone_transition` TO 'shencesys'@'%'                                                                                 | | GRANT SELECT ON `mysql`.`help_keyword` TO 'shencesys'@'%'                                                                                         | | GRANT SELECT ON `mysql`.`slow_log` TO 'shencesys'@'%'                                                                                             | | GRANT SELECT ON `mysql`.`event` TO 'shencesys'@'%'                                                                                                | | GRANT SELECT ON `mysql`.`proc` TO 'shencesys'@'%'                                                                                                 | | GRANT SELECT ON `mysql`.`general_log` TO 'shencesys'@'%'                                                                                          | | GRANT SELECT ON `mysql`.`help_category` TO 'shencesys'@'%'                                                                                        | | GRANT SELECT ON `mysql`.`help_topic` TO 'shencesys'@'%'                                                                                           | | GRANT SELECT ON `mysql`.`time_zone` TO 'shencesys'@'%'                                                                                            | | GRANT SELECT ON `mysql`.`time_zone_name` TO 'shencesys'@'%'                                                                                       | | GRANT SELECT ON `mysql`.`time_zone_transition_type` TO 'shencesys'@'%'                                                                            | +---------------------------------------------------------------------------------------------------------------------------------------------------+ ```  show create table `mysql`.`event`;show create table `mysql`.`func`;show create table `mysql`.`general_log`;show create table `mysql`.`help_category`;show create table `mysql`.`help_keyword`;show create table `mysql`.`help_relation`;show create table `mysql`.`help_topic`;show create table `mysql`.`proc`;show create table `mysql`.`slow_log`;show create table `mysql`.`time_zone`;show create table `mysql`.`time_zone_leap_second`;show create table `mysql`.`time_zone_name`;show create table `mysql`.`time_zone_transition`;show create table `mysql`.`time_zone_transition_type`; æ‰§è¡Œä¸€ä¸‹å¯¹åº”çš„sql å·²ç»è§£å†³ï¼Œè°¢è°¢å“ˆ @jinxiaoxin æ˜¯æ€ä¹ˆè§£å†³çš„å‘€ï¼Ÿæ±‚åˆ†äº« @jinxiaoxin å¯ä»¥åˆ†äº«ä¸‹æ˜¯æ€ä¹ˆè§£å†³çš„é—®é¢˜å—ï¼Ÿè°¢è°¢å•¦ @millinchen ä½ æœ€åè¿™ä¸ªé—®é¢˜è§£å†³äº†å—ï¼Ÿ @agapple å·²ç»æœ‰æƒé™äº†ï¼Œä¸ºå•¥è¿˜è¦å†æ‰§è¡Œä¸€éæ‰è¡Œï¼Ÿ aliyun rdsä¸Šçš„mysqlåº“è¶…çº§è´¦å·ä¹Ÿä¸ä¸€å®šæœ‰æƒé™
479,canal serveråŒæ­¥ä¸»åº“æ—¶ï¼ŒæŠ¥é”™com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: ErrorPacket [errorNumber=1146  fieldCount=-1  message=Table 'mysql.innodb_index_stats' doesn't exist  sqlState=42S02  sqlStateMarker=#] æˆ‘åœ¨ä¸»åº“insertä¸€æ¡æ•°æ®åï¼ˆinsertçš„æ˜¯ä¸€ä¸ªä¸šåŠ¡è¡¨ï¼‰ï¼Œå°±æŠ¥é”™ï¼ŒæŠ¥é”™çš„å†…å®¹ï¼Œæ¶‰åŠå¾ˆå¤šmysqlçš„å†…éƒ¨è¡¨ï¼Œé‡å¯canan serverã€mysqlã€é‡ç½®positionå‡æ— æ•ˆã€‚åªè¦ä¸»åº“æœ‰insertï¼Œupdateç­‰ï¼Œéƒ½æŠ¥è¿™ä¸ªé”™ 2018-01-04 20:51:50.268 [destination = example   address = /10.30.255.151:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /10.30.255.151:3306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: ErrorPacket [errorNumber=1146  fieldCount=-1  message=Table 'mysql.innodb_index_stats' doesn't exist  sqlState=42S02  sqlStateMarker=#]  with command: show create table `mysql`.`columns_priv`;show create table `mysql`.`db`;show create table `mysql`.`event`;show create table `mysql`.`func`;show create table `mysql`.`general_log`;show create table `mysql`.`help_category`;show create table `mysql`.`help_keyword`;show create table `mysql`.`help_relation`;show create table `mysql`.`help_topic`;show create table `mysql`.`innodb_index_stats`;show create table `mysql`.`innodb_table_stats`;show create table `mysql`.`ndb_binlog_index`;show create table `mysql`.`plugin`;show create table `mysql`.`proc`;show create table `mysql`.`procs_priv`;show create table `mysql`.`proxies_priv`;show create table `mysql`.`servers`;show create table `mysql`.`slave_master_info`;show create table `mysql`.`slave_relay_log_info`;show create table `mysql`.`slave_worker_info`;show create table `mysql`.`slow_log`;show create table `mysql`.`tables_priv`;show create table `mysql`.`time_zone`;show create table `mysql`.`time_zone_leap_second`;show create table `mysql`.`time_zone_name`;show create table `mysql`.`time_zone_transition`;show create table `mysql`.`time_zone_transition_type`;show create table `mysql`.`user`; Caused by: java.io.IOException: ErrorPacket [errorNumber=1146  fieldCount=-1  message=Table 'mysql.innodb_index_stats' doesn't exist  sqlState=42S02  sqlStateMarker=#]  with command: show create table `mysql`.`columns_priv`;show create table `mysql`.`db`;show create table `mysql`.`event`;show create table `mysql`.`func`;show create table `mysql`.`general_log`;show create table `mysql`.`help_category`;show create table `mysql`.`help_keyword`;show create table `mysql`.`help_relation`;show create table `mysql`.`help_topic`;show create table `mysql`.`innodb_index_stats`;show create table `mysql`.`innodb_table_stats`;show create table `mysql`.`ndb_binlog_index`;show create table `mysql`.`plugin`;show create table `mysql`.`proc`;show create table `mysql`.`procs_priv`;show create table `mysql`.`proxies_priv`;show create table `mysql`.`servers`;show create table `mysql`.`slave_master_info`;show create table `mysql`.`slave_relay_log_info`;show create table `mysql`.`slave_worker_info`;show create table `mysql`.`slow_log`;show create table `mysql`.`tables_priv`;show create table `mysql`.`time_zone`;show create table `mysql`.`time_zone_leap_second`;show create table `mysql`.`time_zone_name`;show create table `mysql`.`time_zone_transition`;show create table `mysql`.`time_zone_transition_type`;show create table `mysql`.`user`; 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.queryMulti(MysqlQueryExecutor.java:109) ~[canal.parse.driver-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.queryMulti(MysqlConnection.java:94) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.dumpTableMeta(DatabaseTableMeta.java:173) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:127) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) ~[canal.parse-1.0.26-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_60] æ²¡æƒé™å§ æˆ‘ä¹Ÿæ˜¯é‡åˆ°è¿™ä¸ªé—®é¢˜ï¼Œå¸å·æƒé™æ˜¯æœ‰çš„ +1
478,canalè¯»å–æ•°æ®æŠ¥IndexOutOfBoundsException canalè¯»å–æ•°æ®æŠ¥IndexOutOfBoundsException 2018-01-04 17:39:52.043 [pipelineId = 2 taskName = ProcessSelect] WARN c.a.o.s.a.i.setl.zookeeper.termin.WarningTerminProcess - nid:2[2:setl:com.alibaba.otter.node.etl.select.exceptions.SelectException: java.lang.IndexOutOfBoundsException: Index: 0 at com.alibaba.otter.node.etl.select.selector.MessageParser.parse(MessageParser.java:211) at com.alibaba.otter.node.etl.select.selector.canal.CanalEmbedSelector.selector(CanalEmbedSelector.java:258) at com.alibaba.otter.node.etl.select.SelectTask.processSelect(SelectTask.java:236) at com.alibaba.otter.node.etl.select.SelectTask.access$300(SelectTask.java:94) at com.alibaba.otter.node.etl.select.SelectTask$1.run(SelectTask.java:208) at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) Caused by: java.lang.IndexOutOfBoundsException: Index: 0 at java.util.Collections$EmptyList.get(Collections.java:4454) at com.alibaba.otter.canal.protocol.CanalEntry$RowChange.getRowDatas(CanalEntry.java:8107) at com.alibaba.otter.node.etl.select.selector.MessageParser.parse(MessageParser.java:109) ... 9 more otteré—®é¢˜ï¼Œécanal
477,é›†æˆSpringbootå‡ºç°äº†é—®é¢˜ã€‚ @Order(value=1) @Component  public class SimpleCanalClientServer  implements CommandLineRunner{ Exception in thread "restartedMain" java.lang.reflect.InvocationTargetException 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) 	at java.lang.reflect.Method.invoke(Method.java:498) 	at org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:49) Caused by: java.lang.ClassCastException: org.springframework.boot.context.event.ApplicationStartedEvent cannot be cast to org.springframework.boot.context.event.ApplicationEnvironmentPreparedEvent 	at org.springframework.boot.context.config.AnsiOutputApplicationListener.onApplicationEvent(AnsiOutputApplicationListener.java:34) 	at org.springframework.context.event.SimpleApplicationEventMulticaster$1.run(SimpleApplicationEventMulticaster.java:78) 	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50) 	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:76) 	at org.springframework.boot.context.event.EventPublishingRunListener.starting(EventPublishingRunListener.java:69) 	at org.springframework.boot.SpringApplicationRunListeners.starting(SpringApplicationRunListeners.java:48) 	at org.springframework.boot.SpringApplication.run(SpringApplication.java:292) 	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1118) 	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1107) 	at com.jorden.li.ApplicationStart.main(ApplicationStart.java:23) 	... 5 more ä½ è¿™ä¸ªé—®é¢˜è·Ÿcanalæ²¡å…³ç³»ï¼Œæ˜¯ä½¿ç”¨spring bootçš„é—®é¢˜ï¼Œå¯ä»¥åŠ æˆ‘å¾®ä¿¡ï¼ˆgary0526ï¼‰å¸®ä½ çœ‹ä¸€ä¸‹
476,canal client è·å–db serverip+port canal clientç«¯èƒ½è·å–åˆ°db çš„server ip+port ? è¿™ä¸ªæš‚æ—¶æ²¡æœ‰ï¼Œåªæœ‰å¯¹åº”çš„serverId
475,MySQL é‡å¯åï¼ŒCanal æ— é™å¾ªç¯åœ¨SocketChannel.readæ–¹æ³•å†… åœºæ™¯: canal åœ¨dumpçš„æ—¶å€™ï¼Œç›´æ¥é‡å¯MySQL ç°è±¡ï¼š debug å¯ä»¥çœ‹åˆ°ä¸€ç›´åœ¨è¿™ä¸ªåœ°æ–¹å¾ªç¯å‡ºä¸å» ![image](https://user-images.githubusercontent.com/33280738/34552985-e07d80aa-f15f-11e7-806c-c3183b47050c.png) æ§åˆ¶å°æ—¥å¿—ï¼š ![image](https://user-images.githubusercontent.com/33280738/34553015-1ed73ab2-f160-11e7-9eb2-19acbf410a08.png) æ— æ³•è®©Canal é‡æ–°è¿›è¡Œdump åŠå°æ—¶åï¼Œæ§åˆ¶å°å‡ºç°å¦‚ä¸‹æ—¥å¿—ï¼š ` 2018-01-04 15:01:05.400 [Hashed wheel timer #1] WARN  c.a.o.c.server.netty.handler.ClientAuthenticationHandler - channel:[id: 0x15bf0ead  /10.10.80.108:50423 :> /10.10.80.108:11111] idle timeout exceeds  close channel to save server resources... 2018-01-04 15:01:05.403 [New I/O server worker #1-4] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x571b8f50  /10.10.80.108:58807 => /10.10.80.108:11111]  exception=java.io.IOException: Connection reset by peer 	at sun.nio.ch.FileDispatcherImpl.read0(Native Method) 	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39) 	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223) 	at sun.nio.ch.IOUtil.read(IOUtil.java:192) 	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:322) 	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:281) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:201) 	at org.jboss.netty.util.internal.IoWorkerRunnable.run(IoWorkerRunnable.java:46) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) 	at java.lang.Thread.run(Thread.java:745) ` Canal ä»ç„¶æ— æ³•è¿›å…¥é‡æ–°dump çŠ¶æ€ å·²ç»æœ‰äººæäº† PRäº† #473 
474,jvm crash 1. éƒ¨åˆ†å´©æºƒæ—¥å¿— ``` A fatal error has been detected by the Java Runtime Environment: SIGSEGV (0xb) at pc=0x00007f36d5052219  pid=15219  tid=139872797697792 JRE version: Java(TM) SE Runtime Environment (8.0_74-b02) (build 1.8.0_74-b02) Java VM: Java HotSpot(TM) 64-Bit Server VM (25.74-b02 mixed mode linux-amd64 compressed oops) Problematic frame: v  ~StubRoutines::jshort_disjoint_arraycopy Stack: [0x00007f36ac67a000 0x00007f36ac6bb000]   sp=0x00007f36ac6b94a0   free space=253k Native frames: (J=compiled Java code  j=interpreted  Vv=VM code  C=native code) v  ~StubRoutines::jshort_disjoint_arraycopy J 2004 C2 io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(ILio/netty/buffer/ByteBuf;II)Lio/netty/buffer/ByteBuf; (16 bytes) @ 0x00007f36d578d132 [0x00007f36d578cfe0+0x152] J 1955 C2 io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(Lio/netty/channel/AbstractChannelHandlerContext;Ljava/lang/Object;)V (53 bytes) @ 0x00007f36d574ef70 [0x00007f36d574e800+0x770] J 3093 C2 io.netty.channel.nio.NioEventLoop.processSelectedKeys()V (33 bytes) @ 0x00007f36d59a953c [0x00007f36d59a8f00+0x63c] j  io.netty.channel.nio.NioEventLoop.run()V+126 j  io.netty.util.concurrent.SingleThreadEventExecutor$5.run()V+44 j  io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run()V+4 j  java.lang.Thread.run()V+11 v  ~StubRoutines::call_stub V  [libjvm.so+0x68c616]  JavaCalls::call_helper(JavaValue*  methodHandle*  JavaCallArguments*  Thread*)+0x1056 V  [libjvm.so+0x68cb21]  JavaCalls::call_virtual(JavaValue*  KlassHandle  Symbol*  Symbol*  JavaCallArguments*  Thread*)+0x321 V  [libjvm.so+0x68cfc7]  JavaCalls::call_virtual(JavaValue*  Handle  KlassHandle  Symbol*  Symbol*  Thread*)+0x47 V  [libjvm.so+0x723d80]  thread_entry(JavaThread*  Thread*)+0xa0 V  [libjvm.so+0xa69dcf]  JavaThread::thread_main_inner()+0xdf V  [libjvm.so+0xa69efc]  JavaThread::run()+0x11c V  [libjvm.so+0x91d9d8]  java_start(Thread*)+0x108 C  [libpthread.so.0+0x7aa1]  start_thread+0xd1 ``` 2. ä½¿ç”¨çš„æ˜¯1.0.25ç‰ˆæœ¬ï¼Œå¯åŠ¨å‚æ•°é…ç½®å¦‚ä¸‹ï¼š ``` jvm_args: -Xms2048m -Xmx3072m -Xmn1024m -XX:SurvivorRatio=2 -XX:PermSize=96m -XX:MaxPermSize=256m -Xss256k -XX:-UseAdaptiveSizePolicy -XX:MaxTenuringThreshold=15 -XX:+DisableExplicitGC -XX:+UseConcMarkSweepGC -XX:+CMSParallelRemarkEnabled -XX:+UseCMSCompactAtFullCollection -XX:+UseFastAccessorMethods -XX:+UseCMSInitiatingOccupancyOnly -XX:+HeapDumpOnOutOfMemoryError -Djava.awt.headless=true -Djava.net.preferIPv4Stack=true -Dfile.encoding=UTF-8 -DappName=otter-canal -Dlogback.configurationFile=/opt/canal-server/bin/../conf/logback.xml -Dcanal.conf=/opt/canal-server/bin/../conf/canal.properties ``` 3. canal.properties ``` canal.id= 1 canal.ip= canal.port= 11111 canal.zkServers=172.42.11.9:2181 172.42.11.8:2181 172.42.11.7:2181 # flush data to zk canal.zookeeper.flush.period = 1000 # flush meta cursor/parse position to file canal.file.data.dir = ${canal.conf.dir} canal.file.flush.period = 1000 ## memory store RingBuffer size  should be Math.pow(2 n) canal.instance.memory.buffer.size = 16384 ## memory store RingBuffer used memory unit size   default 1kb canal.instance.memory.buffer.memunit = 1024  ## meory store gets mode used MEMSIZE or ITEMSIZE canal.instance.memory.batch.mode = MEMSIZE ## detecing config canal.instance.detecting.enable = true #canal.instance.detecting.sql = insert into retl.xdual values(1 now()) on duplicate key update x=now() canal.instance.detecting.sql = select 1 canal.instance.detecting.interval.time = 3 canal.instance.detecting.retry.threshold = 3 canal.instance.detecting.heartbeatHaEnable = false # support maximum transaction size  more than the size of the transaction will be cut into multiple transactions delivery canal.instance.transaction.size =  1024 # mysql fallback connected to new master should fallback times canal.instance.fallbackIntervalInSeconds = 60 # network config canal.instance.network.receiveBufferSize = 16384 canal.instance.network.sendBufferSize = 16384 canal.instance.network.soTimeout = 30 # binlog filter config canal.instance.filter.query.dcl = false canal.instance.filter.query.dml = false canal.instance.filter.query.ddl = false canal.instance.filter.table.error = false canal.instance.filter.rows = false # binlog format/image check canal.instance.binlog.format = ROW STATEMENT MIXED  canal.instance.binlog.image = FULL MINIMAL NOBLOB # binlog ddl isolation canal.instance.get.ddl.isolation = false ################################################# #########               destinations            #############  ################################################# canal.destinations= example example2 # conf root dir canal.conf.dir = ../conf # auto scan instance dir add/remove and start/stop instance canal.auto.scan = true canal.auto.scan.interval = 5 canal.instance.global.mode = spring  canal.instance.global.lazy = false #canal.instance.global.manager.address = 127.0.0.1:1099 #canal.instance.global.spring.xml = classpath:spring/memory-instance.xml #canal.instance.global.spring.xml = classpath:spring/file-instance.xml canal.instance.global.spring.xml = classpath:spring/default-instance.xml ``` 4. canalè¿è¡ŒæœŸé—´ï¼Œç»å¸¸æŠ¥è¿™ä¸ªé”™ï¼Œä½†æ˜¯åé¢éƒ½èƒ½è‡ªåŠ¨é‡è¿ï¼š ``` 2018-01-03 11:03:57.331 [destination = example   address = /172.42.11.50:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first Caused by: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first         at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4832)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:160)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:759)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:428)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:117)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:66)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:337)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:184)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:145)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220)         at java.lang.Thread.run(Thread.java:745) Caused by: java.io.IOException: should execute connector.connect() first         at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.<init>(MysqlQueryExecutor.java:30)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:87)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMetaByDB(TableMetaCache.java:80)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.access$000(TableMetaCache.java:30)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:55)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.load(TableMetaCache.java:50)         at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3527)         at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2319)         at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2282)         at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2197)         at com.google.common.cache.LocalCache.get(LocalCache.java:3937)         at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3941)         at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4824)         at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4830)         ... 10 more ] ``` 2018-01-03 11:03:57.331 [destination = example   address = /172.42.11.50:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first Caused by: com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: should execute connector.connect() first         at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4832)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:160)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:759)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:428)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:117)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:66)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:337)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:184)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:145)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:220)         at java.lang.Thread.run(Thread.java:745) Caused by: java.io.IOException: should execute connector.connect() first æˆ‘ä¹Ÿç¢°åˆ°è¿™ä¸ªé—®é¢˜ï¼Œæœ‰è§£å†³åŠæ³•ä¹ˆ å‚è€ƒ #482 
473,connect mysql server failed when reconnect mysql server frequently cannot start dump biz due to mysql connection is disconnected by timeout. root cause  multi-thread issue (netty i/o thread vs. biz thread). when invoke connect()  it will return a ChannelFuture instance  and then the "addListener" method is invoked by biz thread  however  "channelRead" method in BusinessHandler is executed by netty I/O thread. ChannelFutureListener -> operationComplete() cannot guarantee that which is executed before than BusinessHandler -> channelRead() method. It will caused new connection is timeout when AbstractEventParser -> start() -> parseThread ->erosaConnection.reconnect() is invoked. ENV: canal: 1.0.25 open-jdk 1.8 OS: CentOS 6.5 -Dio.netty.eventLoopThreads: 1 (very important) another hot bug: mysql dump connection will be disconnected about 10' minutes. It's caused by using Netty4. I'm trying to figure it out.  tks
472,CanalConnector checkValidæ”¹è¿›ï¼šæ£€æŸ¥ä¸‹é“¾æ¥æ˜¯å¦åˆæ³• å¢åŠ äº†å¯¹ä»¥ä¸‹è§„åˆ™çš„åˆ¤æ–­ï¼š - é“¾æ¥canal serverå¤±è´¥ï¼Œä¸€ç›´æ²¡æœ‰ä¸€ä¸ªå¯ç”¨çš„é“¾æ¥ï¼Œè¿”å›false è¿™æ¬¡PRæ„Ÿè§‰ç³…åˆäº†å¾ˆå¤šå…¶ä»–çš„æ”¹åŠ¨ï¼Œä¸å¤ªç†è§£å¯¹äºparseræŸ¥æ‰¾ä½ç‚¹çš„æ”¹åŠ¨ä¸»è¦æ˜¯åŸºäºä»€ä¹ˆè€ƒè™‘ï¼Ÿ éå¸¸æŠ±æ­‰ï¼Œè¿™æ¬¡çš„pull request ä¸æ…å°†å…¶ä»–ä¸ä¸»å¹²æ— å…³çš„æœ¬åœ°ä¿®æ”¹ä¸€èµ·æäº¤äº†ã€‚ æˆ‘è¿™é‡Œæ’¤å›ã€‚
471,è¯·æ•™ï¼šå…³äºcanalå®¢æˆ·ç«¯æŠ¥com.alibaba.otter.canal.protocol.exception.CanalClientException: java.io.IOException: end of stream when reading headerè¿™ä¸ªé”™è¯¯ while (true) {             Message message = connector.getWithoutAck(1); // è·å–æŒ‡å®šæ•°é‡çš„æ•°æ®             long batchId = message.getId();             int size = message.getEntries().size();             if (batchId == -1 || size == 0) {                 System.out.println("empty count : " + emptyCount);             } else {                 System.out.printf("message[batchId=%s size=%s] \n"  batchId  size);             }             try {                 Thread.sleep(40000);             } catch (InterruptedException e) {             }             connector.ack(batchId); // æäº¤ç¡®è®¤         } ä¸Šé¢æˆ‘å–å®Œæ•°æ®ï¼Œsleepä¸ª40ç§’ï¼Œcanalè¿æ¥å°±ä¼šæ–­æ‰ï¼ŒæŠ¥æ ‡é¢˜è¯´æ˜çš„é”™ï¼Œ ä½†æ˜¯æˆ‘å¦‚æœåªæ˜¯Thread.sleep(5000);ï¼Œsleepä¸ª5ç§’ä¹‹ç±»çš„ï¼Œä¸ä¼šæœ‰é—®é¢˜ã€‚ã€‚æ±‚æŒ‡å¯¼è¿™æ˜¯å•¥åŸå› ã€‚ åŸºäºæœ€æ–°ç‰ˆæœ¬1.0.25ã€‚ é‡åˆ°è¿‡åŒæ ·é—®é¢˜ï¼Œä»æ—¥å¿—ä¸Šçœ‹æ˜¯canal serverä¸»åŠ¨å…³é—­äº†è¿æ¥ï¼Œå¯èƒ½æ˜¯é¿å…å®¢æˆ·ç«¯å µæ­»é€ æˆåŒæ­¥ä¸­æ–­çš„ç­–ç•¥ åç­‰æƒå¨å›ç­” SimpleCanalConnectoré‡Œè®¾ç½®çš„soTimeoutä¼šä¼ é€’åˆ°serverç«¯è¿›è¡Œè¶…æ—¶ç®¡ç†ï¼Œé»˜è®¤60ç§’ è¿™ä¸ªsoTimeoutæ—¶é—´çš„æ„æ€æ˜¯ï¼Œç€è¿™ä¸ªæ—¶é—´æ®µå†…ï¼Œå¦‚æœclientæ²¡æœ‰å¤„ç†å®Œè¿™æ‰¹æ•°æ®ï¼Œserverä¼šç»ˆç«¯clientå—ï¼Ÿæˆ‘ç¨‹åºé‡Œclientæ¯æ‰¹æ¬¡å–1000000æ¡æ•°æ®ï¼Œå¤„ç†æ—¶é—´è¾¾åˆ°1åˆ†é’Ÿä»¥ä¸Šï¼Œç„¶åå°±å¯¼è‡´è¿™ä¸ªå¼‚å¸¸ï¼Œè€Œä¸”è¿™1000000æ¡æ•°æ®ä¼šé‡å¤å¤„ç†ï¼Œç„¶åæ¯æ¬¡éƒ½æ˜¯1åˆ†é’Ÿä»¥ä¸Šï¼Œå°±å¾ªç¯æŠ¥è¿™ä¸ªå¼‚å¸¸ã€‚æŠŠsoTimeoutæ”¹åˆ°120ç§’ï¼Œå°±okäº†ã€‚ è¿™ä¸ªé—®é¢˜æ€ä¹ˆè§£å†³å‘¢ https://github.com/alibaba/canal/issues/640ï¼Œå…³æ³¨ä¸€ä¸‹è¿™ä¸ª
470,canalçš„å®¢æˆ·ç«¯æ€»æ˜¯æŠ¥canalæŠ¥com.alibaba.otter.canal.protocol.exception.CanalClientException: java.io.IOException: end of stream when reading headerè¿™ä¸ªé”™è¯¯ ä¸€èˆ¬æ˜¯éœ€è¦å®¢æˆ·ç«¯é‡è¯• æˆ‘ä¹Ÿé‡åˆ°åŒæ ·é—®é¢˜å…³é”®æ˜¯handshake çš„æ—¶å€™å‡ºæ¥çš„ã€‚ åé¢çš„ClientAuth éƒ½è¿˜æ²¡å‘å‘¢ã€‚ Caused by: java.io.IOException: end of stream when reading header 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.read(SimpleCanalConnector.java:401) ~[classes/:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.readNextPacket(SimpleCanalConnector.java:392) ~[classes/:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.readNextPacket(SimpleCanalConnector.java:373) ~[classes/:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.doConnect(SimpleCanalConnector.java:140) ~[classes/:na] 	... 4 common frames omitted 
469,canalæ”¯æŒddlå—ï¼Ÿ æ”¯æŒddlè§£æçš„ï¼Œwikiæ–‡æ¡£æœ‰è®²ã€‚
468,CanalServerException: destination:example1 should start first (æœåŠ¡ç«¯å¦‚ä½•ç¡®è®¤å®ä¾‹å¯åŠ¨) å¼€å¯auto.scan ä¹‹ååœ¨ confä¸‹å¢åŠ äº†ä¸€ä¸ªæ–°å®ä¾‹example1 åœ¨æ—¥å¿—å¯ä»¥å¯ä»¥çœ‹è§ 2017-12-29 14:24:01.056 [canal-instance-scan-0] INFO  c.a.o.canal.deployer.monitor.SpringInstanceConfigMonitor - auto notify start example1 successful. æ—¥å¿—è¯´æ˜æ–°åŠ çš„å®ä¾‹å¯åŠ¨äº†ã€‚ ä½†æ˜¯å®¢æˆ·ç«¯è®¿é—®å’ŒæœåŠ¡ç«¯çºªå½•çš„æ—¥å¿—éƒ½åªæœ‰ exception=com.alibaba.otter.canal.server.exception.CanalServerException: destination:example1 should start first è¿™ç§å¼‚å¸¸ã€‚å¾ˆå¥‡æ€ªçš„æ˜¯åœ¨æœåŠ¡ç«¯æ²¡æœ‰ä»»ä½•å…³äºexample1çš„æ—¥å¿—æ¶ˆæ¯äº§ç”Ÿï¼Œexampleæ˜¯èƒ½æ­£å¸¸äº§ç”Ÿæ—¥å¿—çš„ã€‚ æ‰€ä»¥æƒ³å’¨è¯¢ä¸€ä¸‹å¦‚ä½•ç¡®å®šå®ä¾‹åˆ°åº•å¯åŠ¨æ²¡æœ‰ï¼Œæ—¢æ²¡æœ‰æ—¥å¿—è¾“å‡ºï¼Œä¹Ÿæ²¡æœ‰æœåŠ¡å¼‚å¸¸æŠ›å‡ºï¼Œåªæœ‰è®¿é—®æ—¶æ‰ä¼šäº§ç”Ÿä¸€æ¡ should start firstçš„è¯ï¼Œå¾ˆéš¾è®©äººå»è·Ÿè¸ªé—®é¢˜æ‰€åœ¨ã€‚ ä½ æŠŠlazyæ¨¡å¼ç»™è®¾ç½®ä¸ºfalse å¼€å¯instanceè‡ªåŠ¨æ‰«æ å¦‚æœé…ç½®ä¸ºtrueï¼Œcanal.conf.dirç›®å½•ä¸‹çš„instanceé…ç½®å˜åŒ–ä¼šè‡ªåŠ¨è§¦å‘ï¼š a. instanceç›®å½•æ–°å¢ï¼š è§¦å‘instanceé…ç½®è½½å…¥ï¼Œlazyä¸ºtrueæ—¶åˆ™è‡ªåŠ¨å¯åŠ¨ b. instanceç›®å½•åˆ é™¤ï¼šå¸è½½å¯¹åº”instanceé…ç½®ï¼Œå¦‚å·²å¯åŠ¨åˆ™è¿›è¡Œå…³é—­ c. instance.propertiesæ–‡ä»¶å˜åŒ–ï¼šreload instanceé…ç½®ï¼Œå¦‚å·²å¯åŠ¨è‡ªåŠ¨è¿›è¡Œé‡å¯æ“ä½œ	 æˆ‘æ˜¯æŒ‰è¿™ä¸ªæç¤ºæŠŠlazy è®¾ç½®ä¸º trueçš„ã€‚åŸæœ¬é»˜è®¤å°±æ˜¯false æˆ‘å°è±¡ä¸­lazy=falseæ˜¯é»˜è®¤å€¼ï¼Œlazy=trueæ—¶ä¼šåœ¨ç¬¬ä¸€æ¬¡å®¢æˆ·ç«¯è®¿é—®æ—¶æ‰ä¼šå»åˆå§‹åŒ– å“¦ï¼Œè°¢è°¢
467,AbstractEventParserçš„buildLastPositionå‡½æ•°ï¼Œåç§»é‡æ˜¯ä¸æ˜¯è¯¥åŠ ä¸Šäº‹ä»¶é•¿åº¦æ›´åˆé€‚ï¼Ÿ com.alibaba.otter.canal.parse.inbound.AbstractEventParser Canal Deployer 1.0.24 åŸä»£ç ï¼š     protected LogPosition buildLastPosition(CanalEntry.Entry entry) { // åˆå§‹åŒ–ä¸€ä¸‹         LogPosition logPosition = new LogPosition();         EntryPosition position = new EntryPosition();         position.setJournalName(entry.getHeader().getLogfileName());         position.setPosition(entry.getHeader().getLogfileOffset());         position.setTimestamp(entry.getHeader().getExecuteTime());         // add serverId at 2016-06-28         position.setServerId(entry.getHeader().getServerId());         logPosition.setPostion(position);         LogIdentity identity = new LogIdentity(runningInfo.getAddress()  -1L);         logPosition.setIdentity(identity);         return logPosition;     } ä½†åœ¨setPositionæ—¶ï¼Œè¿™é‡Œå†™å…¥çš„åªæ˜¯è¿™ä¸ªäº‹ä»¶çš„å¼€å§‹ä½ç½®ã€‚è€Œæˆ‘ä»¬åœ¨ä¿å­˜å…¥ZKç­‰ä½ç½®æ—¶ï¼Œæˆ‘ä»¬å¹¶ä¸å¸Œæœ›è¿™ä¸ªäº‹ä»¶å›å¤´å†è¢«å¤„ç†ä¸€éå•Šï¼Ÿæ˜¯ä¸æ˜¯è¯¥æ”¹æˆè¿™æ ·ï¼š         position.setPosition(entry.getHeader().getLogfileOffset()+entry.getHeader().getEventLength()); æˆ‘æ”¹è¿‡ä¹‹åæµ‹è¿‡å¯è¡Œï¼Œæœ€ç»ˆä¿å­˜çš„å°±æ˜¯Eventçš„æœ«å°¾äº†ã€‚æˆ‘çœ‹ä»£ç ä¸­Canalä¸€ç›´å¾ˆå›°æ‰°é‡å¯æ—¶çš„å¼€å§‹ä½ç½®å¯èƒ½ä¸æ˜¯ä¸€ä¸ªäº‹åŠ¡çš„æœ«å°¾ï¼Œç°åœ¨è¿™æ ·æ”¹ä¸€ä¸‹ï¼Œåº”è¯¥å¤„ç†å¾—å¥½å¤šäº†å§ï¼Ÿ æˆ‘åœ¨ä»£ç ä¸­è¿˜åŠ äº†åªæ˜¯XIDã€DDLç­‰äº‹ä»¶æ‰çœŸçš„ä¿å­˜åç§»é‡ï¼Œåˆ«çš„äº‹ä»¶ä¸ä¿å­˜ã€‚è¿™æ ·å¤§ä¸äº†é‡æ–°å¤„ç†ï¼Œä½†ä¸è¯¥å†å‡ºç°å¼€å§‹ä½ç½®ä¸åœ¨äº‹åŠ¡å¼€å¤´è¿™æ ·çš„äº‹äº†å§ã€‚ æ”¶åˆ°äº†æé†’ï¼Œè¿™äº›åœ¨ç›´æ¥Ackçš„æ¨¡å¼ä¸‹æ‰æœ‰ç”¨ã€‚æˆ‘çš„åœºæ™¯å°±æ˜¯ç›¸å½“äºç›´æ¥Ackçš„ï¼Œé‚£è¿™ä¸ªæ”¹åŠ¨åªæ˜¯å¯¹æˆ‘æœ‰ç”¨ï¼Œå¯¹Canalæ— ç”¨äº†å§ã€‚
466,canalæŠ¥CanalParseException: parse row data failed. é”™è¯¯ æˆ‘æ ¹æ®https://github.com/alibaba/canal/issues/161 è·‘äº†FileLogFetcherTestè¿™ä¸ªæµ‹è¯•ã€‚ java.io.IOException: Error binlog file header: [109  121  115  113] æ˜¯ä»€ä¹ˆé—®é¢˜ä¹Ÿã€‚
465,canalåŒæ­¥å‡ºç°æ­»é”é—®é¢˜ æ€ä¹ˆå¤„ç†æ­»é”ï¼Ÿ 2017-12-25 14:18:54 295 (main) [INFO - com.trcloud.hamal.stream.core.operator.impl.sink.GPSinkOperator.processAutoCommit(GPSinkOperator.java:138)] current sql is: INSERT INTO ods_fina_bj.account_user("account_type" "balance" "bank_frozen" "create_date" "cust_no" "del_flag" "id" "local_frozen" "parent_id" "remarks" "update_date" "user_id" "storm_time"  "etl_time") VALUES('1' '0.0' '0.0' '2017-12-25 14:18:26' '201712251418330723046283' '0' '8a32f14f815a40f5868ba7f0c8286cfe' '0.0' null 'DTSå€Ÿæ¬¾äººå¼€æˆ·' '2017-12-25 14:18:26' 'C33DBA5ADEB0415DBC4AE36CA3B66E9B' '2017-12-25 14:18:26'  '2017-12-25 14:18:37'); 2017-12-25 14:19:04 297 (main) [ERROR - com.trcloud.hamal.stream.core.operator.impl.sink.GPSinkOperator.processAutoCommit(GPSinkOperator.java:159)] exec sql one by one failed:  org.postgresql.util.PSQLException: ERROR: deadlock detected   Detail: Process 71574 waits for RowExclusiveLock on relation 2388238 of database 23968; blocked by process 24634. Process 24634 waits for ExclusiveLock on relation 2388316 of database 23968; blocked by process 59646. Process 59646 waits for RowExclusiveLock on relation 2388238 of database 23968; blocked by process 35132. Process 35132 waits for ExclusiveLock on relation 2388238 of database 23968; blocked by process 71574. 	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2182) 	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1911) 	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:173) 	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:622) 	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:458) 	at org.postgresql.jdbc.PgStatement.executeUpdate(PgStatement.java:406) 	at com.zaxxer.hikari.pool.ProxyStatement.executeUpdate(ProxyStatement.java:120) 	at com.zaxxer.hikari.pool.HikariProxyStatement.executeUpdate(HikariProxyStatement.java) 	at com.trcloud.hamal.stream.core.operator.impl.sink.GPSinkOperator.processAutoCommit(GPSinkOperator.java:139) 	at com.trcloud.hamal.stream.core.operator.impl.sink.GPSinkOperator.process(GPSinkOperator.java:92) 	at com.trcloud.hamal.stream.core.operator.impl.canal.CanalOperatorChain.start(CanalOperatorChain.java:49) 	at com.trcloud.hamal.stream.core.StreamJob.start(StreamJob.java:121) 	at com.trcloud.hamal.stream.core.JobRunner.main(JobRunner.java:46) è¿™ä¸æ˜¯åŸç”Ÿcanalæ”¯æŒçš„å§ï¼Ÿçœ‹æŠ¥é”™åº”è¯¥æ˜¯æ‰©å±•æŠ½å–pgæ•°æ®å‡ºç°çš„é—®é¢˜... canal æœ‰æ²¡æœ‰åŠæ³•è§„é¿æˆ–è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ@wingerx  ä¾‹å¦‚ä»¥ä¸‹å‚æ•°æ˜¯å¯ä»¥ï¼Ÿ #canal batch size canal.batch.size=100 
463,canal ddlè¯­å¥é‡æ–°ä»ä¹‹å‰æ‰§è¡Œè¿‡çš„æ—¶é—´å†æ¬¡æ‰§è¡Œä¸€éå¤±è´¥  éœ€è¦åœ¨å“ªé‡Œè¿‡æ»¤æ‰å·²ç»æ¶ˆè´¹è¿‡çš„æ‰§è¡Œæƒ…å†µ 2017-12-22 14:12:47 365 (main) [INFO - com.trcloud.hamal.stream.core.operator.impl.canal.CanalSource.parseColumns(CanalSource.java:238)] parse ddl sql : ALTER TABLE `account_user_info_stream_test` ADD COLUMN `test001` varchar(255) NOT NULL AFTER `modifiedon` 2017-12-22 14:12:47 375 (main) [INFO - com.trcloud.hamal.stream.core.operator.impl.canal.CanalSource.parseColumns(CanalSource.java:336)] ddl result map : {"test001":{"curName":"test001" "key":false "nulled":false "oldName":"" "operPimay":false "operType":"ADD" "type":"varchar(255)"}} 2017-12-22 14:12:47 390 (main) [INFO - com.trcloud.hamal.stream.core.operator.impl.canal.Canal2SqlOperator.transform(Canal2SqlOperator.java:77)] sqlDecorators: [{"eventType":"ALTER" "sql":"ALTER TABLE test.account_user_info_stream_test ADD COLUMN test001 varchar(255)  NOT NULL DEFAULT '' ;" "storm_time":"2017-12-22 14:11:23" "tableName":"account_user_info_stream_test"}] 2017-12-22 14:12:47 432 (main) [WARN - com.trcloud.hamal.stream.core.operator.impl.sink.GPSinkOperator.process(GPSinkOperator.java:92)] batch exec error  try exec one by one 2017-12-22 14:12:47 433 (main) [INFO - com.trcloud.hamal.stream.core.operator.impl.sink.GPSinkOperator.processAutoCommit(GPSinkOperator.java:141)] current sql is: ALTER TABLE test.account_user_info_stream_test ADD COLUMN test001 varchar(255)  NOT NULL DEFAULT '' ; 2017-12-22 14:12:47 465 (main) [ERROR - com.trcloud.hamal.stream.core.operator.impl.sink.GPSinkOperator.processAutoCommit(GPSinkOperator.java:168)] exec sql one by one failed:  org.postgresql.util.PSQLException: ERROR: column "test001" of relation "account_user_info_stream_test" already exists 	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2182) 	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1911) 	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:173) 	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:622) 	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:458) 	at org.postgresql.jdbc.PgStatement.executeUpdate(PgStatement.java:406) 	at com.zaxxer.hikari.pool.ProxyStatement.executeUpdate(ProxyStatement.java:120) 	at com.zaxxer.hikari.pool.HikariProxyStatement.executeUpdate(HikariProxyStatement.java) 	at com.trcloud.hamal.stream.core.operator.impl.sink.GPSinkOperator.processAutoCommit(GPSinkOperator.java:142) 	at com.trcloud.hamal.stream.core.operator.impl.sink.GPSinkOperator.process(GPSinkOperator.java:95) 	at com.trcloud.hamal.stream.core.operator.impl.canal.CanalOperatorChain.start(CanalOperatorChain.java:49) 	at com.trcloud.hamal.stream.core.StreamJob.start(StreamJob.java:121) 	at com.trcloud.hamal.stream.core.JobRunner.main(JobRunner.java:46) 2017-12-22 14:12:47 468 (main) [ERROR - com.trcloud.hamal.stream.core.operator.impl.sink.GPSinkOperator.process(GPSinkOperator.java:97)] exec sql one by one failed: 200001: sink sql failed! 2017-12-22 14:12:49 165 (main) [ERROR - com.trcloud.hamal.stream.core.operator.impl.canal.CanalOperatorChain.start(CanalOperatorChain.java:51)] 200001: sink sql failed! é‡å¤çš„æ•°æ®åªèƒ½æ˜¯å®¢æˆ·ç«¯è¿›è¡Œè®°å½•å’Œè¿‡æ»¤
462,canal æ—¶é—´æˆ³æŒ‡å®š çœ‹æ–‡æ¡£è¯´ï¼š canal.instance.master.timestamp : æŒ‡å®šä¸€ä¸ªæ—¶é—´æˆ³ï¼Œcanalä¼šè‡ªåŠ¨éå†mysql binlogï¼Œæ‰¾åˆ°å¯¹åº”æ—¶é—´æˆ³çš„binlogä½ç‚¹åï¼Œè¿›è¡Œå¯åŠ¨ é‚£ä¹ˆè¯·é—®æ ¼å¼æ˜¯ä»€ä¹ˆï¼Ÿå¿…é¡»è¦åŒæ—¶å†™ä¸Špositionå’Œtimestampå—ï¼Ÿ canal.instance.standby.timestamp = 1513844601 æŠ¥é”™ï¼Œcanal.instance.standby.timestamp = â€˜2017-12-22 xx:xx:xxâ€™ ä¹Ÿæ˜¯ä¸€æ ·çš„é”™è¯¯ é”™è¯¯å¦‚ä¸‹æˆªå›¾ï¼š ![canal_err02](https://user-images.githubusercontent.com/34462344/34283126-062ed3c2-e705-11e7-93d5-802275d5a35b.png) position info conf: canal.instance.master.address = xxxxxx:3306 canal.instance.master.journal.name = MariaDB-bin.000001 canal.instance.master.position = canal.instance.master.timestamp = 1513845143 canal.instance.standby.address = xxxxxxxxx:3306 canal.instance.standby.journal.name = MariaDB-bin.000004 canal.instance.standby.position = canal.instance.standby.timestamp = 1513844601 å†™ç€å¯¹åº”çš„timestampå³å¯
461,æ”¹åŠ¨destinationçš„é…ç½®æ–‡ä»¶ï¼Œç»“æœæ•´ä¸ªCanalè¿›ç¨‹éƒ½é€€å‡ºäº†ï¼ŒæŒ‰ç†ä¸æ˜¯è¯¥é‡å¯å—ï¼Ÿ å„ä½å¥½ï¼Œ æˆ‘ç”¨çš„æ˜¯1.0.24ï¼Œcanal deployerã€‚ ä¸»è¦é…ç½®ï¼š canal.destinations= example canal.conf.dir = ../conf canal.auto.scan = true canal.auto.scan.interval = 5 canal.instance.global.mode = spring  canal.instance.global.lazy = false canal.instance.global.spring.xml = classpath:spring/default-instance.xml â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” ç„¶åæˆ‘è¯•ç€æ”¹åŠ¨example/instance.propertiesï¼Œåœ¨black.regexä¸­åŠ äº†ç‚¹ä¸œè¥¿ï¼Œçœ‹åˆ°æ•´ä¸ªCanaléƒ½é€€å‡ºäº†ã€‚ç®€å•çœ‹äº†ä¸€ä¸‹ä»£ç ä¹Ÿæ²¡æƒ³æ˜ç™½ä¸ºä»€ä¹ˆæ²¡é‡å¯exampleã€‚ logs/example/example.logï¼š 2017-12-20 15:31:15.241 [canal-instance-scan-0] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - stop CannalInstance for null-example  2017-12-20 15:31:15.241 [canal-instance-scan-0] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - disConnect MysqlConnection to edc0.ecloud.com/132.122.1.162:6606... 2017-12-20 15:31:15.246 [destination = example   address = /132.122.1.162:6606   EventParser] INFO  c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O interrupted while reading from client socket java.nio.channels.ClosedByInterruptException: null         at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:202) ~[na:1.8.0_66]         at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:407) ~[na:1.8.0_66]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:154) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:122) [canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:222) [canal.parse-1.0.24.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.8.0_66] 2017-12-20 15:31:15.246 [destination = example   address = /132.122.1.162:6606   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - the channel edc0.ecloud.com/132.122.1.162:6606 is not connected 2017-12-20 15:31:15.246 [destination = example   address = /132.122.1.162:6606   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - disConnect MysqlConnection to edc0.ecloud.com/132.122.1.162:6606... 2017-12-20 15:31:15.247 [destination = example   address = /132.122.1.162:6606   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - connect MysqlConnection to edc0.ecloud.com/132.122.1.162:6606... 2017-12-20 15:31:15.247 [destination = example   address = /132.122.1.162:6606   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - handshake initialization packet received  prepare the client authentication packet to send 2017-12-20 15:31:15.248 [destination = example   address = /132.122.1.162:6606   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - client authentication packet is sent out. 2017-12-20 15:31:15.248 [destination = example   address = /132.122.1.162:6606   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - disConnect MysqlConnection to edc0.ecloud.com/132.122.1.162:6606... 2017-12-20 15:31:15.249 [canal-instance-scan-0] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - stop successful.... 2017-12-20 15:31:15.249 [canal-instance-scan-0] INFO  c.a.otter.canal.server.embedded.CanalServerWithEmbedded - stop CanalInstances[example] successfully logs/canal/canal.logï¼š 2017-12-20 15:14:05.117 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## the canal server is running now ..... . 2017-12-20 15:31:15.250 [Thread-4] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## stop the canal server 2017-12-20 15:31:15.254 [Thread-4] INFO  com.alibaba.otter.canal.deployer.CanalController - ## stop the canal server[132.122.1 .162:11111] 2017-12-20 15:31:15.254 [Thread-4] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## canal server is down. æ€ä¹ˆå…³é—­exampleè¿™ä¸ªDestinationï¼Œå°±å¯¼è‡´äº†JVMçš„é€€å‡ºå‘¢ï¼Ÿæ±‚æŒ‡æ•™ï¼Œè°¢è°¢ï¼ canal.pid æ–‡ä»¶è¿˜åœ¨ Sorry æˆ‘æŠŠcanalServerçš„å¯åœç»™æ³¨é‡Šæ‰äº†ï¼Œæ¢å¤å›æ¥å°±å¥½äº†â€¦â€¦ 
460,ddl å‡ºç°\305\241\305\202\342\211\240\305\233\304\226\303\241ï¼Œç›´æ¥æ‰“å°æ˜¯ä¹±ç  eventType: ALTER isDdl: true sql: "ALTER TABLE `account_user_info_stream_test`\r\nADD COLUMN `test001`  varchar(255) NULL DEFAULT \'\' COMMENT \'\305\241\305\202\342\211\240\305\233\304\226\303\241\' AFTER `modifiedon`" ddlSchemaName: "test" parse ddl sql : ALTER TABLE `account_user_info_stream_test` ADD COLUMN `test001` varchar(255) NULL DEFAULT '' COMMENT 'Å¡Å‚â‰ Å›Ä–Ã¡' AFTER `modifiedon` @agapple  è¿™ä¸ªè¯¥å¦‚ä½•è½¬ç  é»˜è®¤åº”è¯¥æ˜¯iso-8859-1çš„ç¼–ç ï¼ŒæŒ‰ç…§è¿™ä¸ªè½¬ç ä¸€ä¸‹çœ‹çœ‹ è¯•è¿‡ new String(sql  "ISO8859-1")...  æ²¡ç”¨  ä»CanalEntry.Entry entryä¸­è·å– Entry resultï¼šheader {   version: 1   logfileName: "mysql-bin.006352"   logfileOffset: 1073084521   serverId: 3   serverenCode: "UTF-8"   executeTime: 1513863317000   sourceType: MYSQL   schemaName: "test"   tableName: "account_user_info_stream_test"   eventLength: 203   eventType: ALTER } entryType: ROWDATA storeValue: "\020\005P\001Z\224\001alter table test.account_user_info_stream_test add  `test00001_14` varchar(25) not null  DEFAULT \'2\' comment \'\305\233\304\266\304\215\305\244\304\256\304\223\305\232\303\244\302\243\305\232\303\244\305\205\305\232\303\251\303\234\305\232\305\271\342\211\244\'r\004test" CanalEntry.RowChange rowChange = null;                 try {                     rowChange = CanalEntry.RowChange.parseFrom(entry.getStoreValue());             ............ RowChange resultï¼ševentType: ALTER isDdl: true sql: "alter table test.account_user_info_stream_test add  `test00001_14` varchar(25) not null  DEFAULT \'2\' comment \'\305\233\304\266\304\215\305\244\304\256\304\223\305\232\303\244\302\243\305\232\303\244\305\205\305\232\303\251\303\234\305\232\305\271\342\211\244\'" ddlSchemaName: "test" æ˜¯ä¸æ˜¯è¿™é‡ŒCanalEntry.RowChange.parseFrom æœ‰é—®é¢˜ @agapple  CanalEntry.Column  ä¸­æ–‡è¾“å‡ºæ˜¯æ­£å¸¸   CanalEntry.RowChange ä¸­æ–‡å¥½åƒæ˜¯ç›´æ¥ä¸Šé¢ç±»ä¼¼äº8è¿›åˆ¶çš„ä¸€ä¸² @agapple  ä½ ç”¨debugæ¨¡å¼ï¼Œçœ‹ä¸€ä¸‹ä»mysql binlogé‡Œæ”¶åˆ°çš„æ•°æ®æ˜¯å•¥å§ï¼ŒQueryLogEventè¿™ä¸ªç±» **å› ä¸ºæ²¡åŠæ³•æœ¬åœ°è°ƒè¯•ä»£ç  æˆ‘è¯•äº†é‡‡ç”¨OpenReplicatorè§£æMySQL binlog** 2017-12-25 19:03:29 469 [binlog-parser-1] INFO  [com.taihe.cloud.binlog.InstanceListener] - cdcEvent:{ eventId:66 databaseName:test tableName:`account_user_info_stream_test` add eventType:2 timestamp:1514199796000 timestampReceipt:1514199809467 binlogName:null position:398723955 nextPostion:398724150 serverId:3 isDdl:true sql:ALTER TABLE `account_user_info_stream_test` ADD COLUMN `test002`  varchar(255) NULL COMMENT 'ä¸­æ–‡' AFTER `test00001_2` before:null after:null} {   "eventId": 66   "databaseName": "test"   "tableName": "`account_user_info_stream_test`\r\nadd"   "eventType": 2   "timestamp": 1514199796000   "timestampReceipt": 1514199809467   "binlogName": null   "position": 398723955   "nextPostion": 398724150   "serverId": 3   "before": null   "after": null   "isDdl": true   "sql": "ALTER TABLE `account_user_info_stream_test`\r\nADD COLUMN `test002`  varchar(255) NULL COMMENT \u0027ä¸­æ–‡\u0027 AFTER `test00001_2`" } **åŒæ ·ç”¨canal  åˆ™æ˜¾ç¤ºè§£æä¹±ç **  Entry resultï¼šheader {   version: 1   logfileName: "mysql-bin.006360"   logfileOffset: 398723955   serverId: 3   serverenCode: "UTF-8"   executeTime: 1514199796000   sourceType: MYSQL   schemaName: "test"   tableName: "account_user_info_stream_test"   eventLength: 195   eventType: ALTER } entryType: ROWDATA storeValue: "\020\005P\001Z\200\001ALTER TABLE `account_user_info_stream_test`\r\nADD COLUMN `test002`  varchar(255) NULL COMMENT \'\305\241\305\202\342\211\240\305\233\304\226\303\241\' AFTER `test00001_2`r\004test" 2017-12-25 19:02:53 902 (main) [INFO - com.trcloud.hamal.stream.core.operator.impl.canal.CanalSource.fetchEvent(CanalSource.java:142)] RowChange resultï¼ševentType: ALTER isDdl: true sql: "ALTER TABLE `account_user_info_stream_test`\r\nADD COLUMN `test002`  varchar(255) NULL COMMENT \'\305\241\305\202\342\211\240\305\233\304\226\303\241\' AFTER `test00001_2`" ddlSchemaName: "test" 2017-12-25 19:02:53 903 (main) [INFO - com.trcloud.hamal.stream.core.operator.impl.canal.CanalSource.buildEvent(CanalSource.java:179)] RowChange resultï¼ševentType: ALTER isDdl: true sql: "ALTER TABLE `account_user_info_stream_test`\r\nADD COLUMN `test002`  varchar(255) NULL COMMENT \'\305\241\305\202\342\211\240\305\233\304\226\303\241\' AFTER `test00001_2`" ddlSchemaName: "test" 2017-12-25 19:02:53 904 (main) [INFO - com.trcloud.hamal.stream.core.operator.impl.canal.CanalSource.parseColumns(CanalSource.java:239)] parse ddl sql : ALTER TABLE `account_user_info_stream_test` ADD COLUMN `test002` varchar(255) NULL COMMENT 'Å¡Å‚â‰ Å›Ä–Ã¡' AFTER `test00001_2` 2017-12-25 19:02:53 914 (main) [INFO - com.trcloud.hamal.stream.core.operator.impl.canal.CanalSource.parseColumns(CanalSource.java:337)] ddl result map : {"test002":{"comment":"Å¡Å‚â‰ Å›Ä–Ã¡" "curName":"test002" "key":false "nulled":true "oldName":"" "operPimay":false "operType":"ADD" "type":"varchar(255)"}} 2017-12-25 19:02:53 954 (main) [INFO - com.trcloud.hamal.stream.core.operator.impl.canal.Canal2SqlOperator.transform(Canal2SqlOperator.java:77)] sqlDecorators: [{"eventType":"ALTER" "sql":"ALTER TABLE test.account_user_info_stream_test ADD COLUMN test002 varchar(255)  NULL DEFAULT '' ;COMMENT ON COLUMN test.account_user_info_stream_test.test002 IS 'Å¡Å‚â‰ Å›Ä–Ã¡';" "storm_time":"2017-12-25 19:03:16" "tableName":"account_user_info_stream_test"}] ![image](https://user-images.githubusercontent.com/834743/34376917-6f694958-eb29-11e7-81b1-90119700a9dd.png) æˆ‘è¿™é‡ŒéªŒè¯å¯ä»¥æ‹¿åˆ°æ­£ç¡®çš„ç¼–ç ï¼Œè¯·ç¡®ä¿å»ºè¡¨ï¼Œbinlog dumpçš„ç¼–ç ä¿æŒä¸€è‡´ï¼Œæˆ‘è¿™é‡Œå…¨éƒ¨è®¾ç½®ä¸ºutf8 binlog dumpçš„ç¼–ç ä¿æŒä¸€è‡´æ˜¯æŒ‡å“ªå—ï¼Ÿ å»ºè¡¨åŠéƒ½çœ‹äº† å¥½åƒéƒ½æ˜¯UTF8 mysql> show global variables like '%character%'; +--------------------------+-------------------------------------+ | Variable_name            | Value                               | +--------------------------+-------------------------------------+ | character_set_client     | utf8                                | | character_set_connection | utf8                                | | character_set_database   | utf8                                | | character_set_filesystem | binary                              | | character_set_results    | utf8                                | | character_set_server     | utf8                                | | character_set_system     | utf8                                | | character_sets_dir       | /usr/share/percona-server/charsets/ | +--------------------------+-------------------------------------+ 8 rows in set (0.00 sec) mysql>  canal client é…ç½®ä¹Ÿæ˜¯UTF-8 é€šè¿‡å®˜æ–¹å¼€æºcanal.parse.dbsync å•å…ƒæµ‹è¯•æµ‹ä¸‹binlog QueryLogEvent è¾“å‡ºå°±ä¹±ç äº†ï¼Œdmlè¯­å¥æ˜¯æ­£å¸¸çš„  ddl æœ‰é—®é¢˜  ï¼Œbinlogä¹ŸæŸ¥çœ‹äº† ä¹Ÿæ˜¯ä¸­æ–‡çš„ 16:47:31.330 [main] INFO  c.taobao.tddl.dbsync.binlog.LogEvent - common_header_len= 19  number_of_event_types= 35 sql : ALTER TABLE `account_user_info_stream_test` DROP COLUMN `test001_1` DROP COLUMN `testt223` sql : ALTER TABLE `account_user_info_stream_test` ADD COLUMN `test001`  varchar(255) NULL COMMENT 'Å›Ä…ÄÅ›Ä—Ä®Å¡Å‚â‰ Å›Ä–Ã¡Ã”Ä¾Ä†Å¡Ä¹â€ Å¡Ä»ÄªÃâ€ Ä€Å¡Ä¼ÃœÅšÅºÃ³Ã”Ä¾Ã¼' AFTER `modifiedon` sql : ALTER TABLE `account_user_info_stream_test` ADD COLUMN `test002`  varchar(255) NULL COMMENT 'Å›Ä…ÄÅšÄ¯ÄªÅ¡Å‚Ä‡Å¡Å…Â°Å¡Ä¹â€ Å¡Ä»ÄªÃâ€ Ä€' AFTER `test001` sql : ALTER TABLE `account_user_info_stream_test` ADD COLUMN `test003` varchar(255) NULL COMMENT 'Å›Ã„Ã©Å¡Ä»Ä…ÅšÅ¹Ä®Å¡Ä½â€¢Å¡Ä»ÄªÃâ€ Ä€ÅšÄÄ˜' sql : ALTER TABLE `account_user_info_stream_test` ADD COLUMN `test004` varchar(255) NULL COMMENT 'Å¡Å‚Ä¼Å¡Ä½Ã„Å¡Ä»Ä…Å¡Ä»ÄªÃâ€ Ä€' sql : ALTER TABLE `account_user_info_stream_test` ADD COLUMN `test005` varchar(255) NULL COMMENT 'Å¡Å‚Ä¼Å¡Ä½Ã„Å¡Ä»Ä…Å¡Ä»ÄªÃâ€ Ä€112233' æœ€ç»ˆæ’æŸ¥åªèƒ½åˆ°è¿™é‡Œï¼Œæƒ³ç¡®è®¤ä¸‹è¿™å—æ˜¯ä¸æ˜¯æœ‰bug com.taobao.tddl.dbsync.binlog.LogBuffer: /**      * Return next 16-bit unsigned int from buffer. (little-endian)      *       * @see mysql-5.1.60/include/my_global.h - uint2korr      */     public final int getUint16() {         if (position + 1 >= origin + limit) throw new IllegalArgumentException("limit excceed: "                                                                                + (position - origin + 1));         byte[] buf = buffer;         return (0xff & buf[position++]) | ((0xff & buf[position++]) << 8);     } è¿™æ®µä»£ç è·å–åˆ°45  ä¸æ˜¯33  æƒ³é—®ä¸‹å¤§ç¥è¿™é‡Œè§£æè·Ÿmysqlç‰ˆæœ¬æœ‰å…³å—ï¼Ÿæœ¬åœ°ä½¿ç”¨mysqlç‰ˆæœ¬5.6.27 charsetId	45	 javaCharset	"MacCentralEurope" (id=77)	 mysqlCharset	"utf8mb4" (id=80)	 mysqlCollation	"utf8mb4_general_ci" (id=81)	 éº»çƒ¦é—®ä¸‹æœ€åæ€ä¹ˆè§£å†³çš„ï¼Œæˆ‘ä¹Ÿå­˜åœ¨åŒæ ·çš„ç°è±¡ã€‚ã€‚ã€‚
459,å¦‚ä½•é‡å¯å®ä¾‹è€Œä¸é‡å¯server è¯·é—®å¦‚ä½•é‡å¯å®ä¾‹ï¼Œå› ä¸ºæƒ³è¦åº”ç”¨position çš„ä½ç½®ï¼Œ å¦‚æœstop å†startup çš„è¯ ä¼šå¯¼è‡´å…¶ä»–å®ä¾‹ä¹Ÿä¼šæ”¶åˆ°å½±å“ ç§»é™¤æ–‡ä»¶å¤¹ï¼Œç„¶åå†åŠ å›æ¥ @agapple å—¯ å¥½çš„ æˆ‘å»è¯•è¯•çœ‹ï¼Œ èƒ½å¦æŠŠè¿™ä¸ªæ–¹æ³•å†™åˆ°wiki é‡Œé¢ æµ‹è¯•æœ‰æ•ˆ å…³é—­issue
458,å¦‚ä½•è®¾ç½® position ä½ç½® æˆ‘å†å®ä¾‹é‡Œé¢è®¾ç½® position ä½†æ˜¯ï¼Œå®é™…è·å–çš„éƒ½æ˜¯ æœ€æ–°çš„ä½ç½®ï¼Œ ç„¶åçœ‹äº†ä¸€ä¸‹æ—¥å¿— show master status è¿™æ ·ä¸€å®šæ˜¯è·å–æœ€æ–°çš„æ—¥å¿—ï¼Œé‚£ä¹ˆå¦‚ä½•è®¾ç½®position ï¼Ÿ ![image](https://user-images.githubusercontent.com/11556152/34143020-7cd03918-e4c5-11e7-9d17-cf606f8bf555.png) ![image](https://user-images.githubusercontent.com/11556152/34143026-8cbb85f8-e4c5-11e7-8fbe-c2cb78226649.png) æˆ‘è®¾ç½®äº†timestmp å¥½äº†  æˆ‘å›§äº† è¿˜æœ‰å°±æ˜¯ä¸è¦ç»™position åé¢æœ‰ç©ºæ ¼ï¼Œ æˆ‘å°±æ˜¯è¿™æ ·å¥½äº†çš„ã€‚ã€‚ã€‚ 
457,Clientä¸­ subscribe  ç­›é€‰å¤±æ•ˆäº† ä½ å¥½ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯canal 1.0.24 deployer å’Œ client éƒ½æ˜¯è¿™ä¸ªç‰ˆæœ¬ï¼Œ ç¬¬ä¸€æ¬¡æˆ‘è®¾ç½®client ä¸­subscribe  æ˜¯ç”Ÿæ•ˆçš„ï¼Œè·å–æ•°æ®æ˜¯å¯ä»¥æ­£å¸¸ç­›é€‰çš„ï¼Œä½†æ˜¯æˆ‘æ”¹äº†deployer ä¸­positon å¹¶ä¸”åˆ é™¤äº† meta.dat æƒ³é‡æ–°æ’å…¥ä¸€ä¸‹æ•°æ®ï¼Œå‘ç°æˆ‘èƒ½ä¸‹è½½åˆ°å…¶ä»–åº“çš„æ•°æ®ï¼Œå…¶å®æˆ‘åªè¦ä¸¤å¼ è¡¨ã€‚ è¯·é—®å¤§ç¥è¿™æ˜¯ä»€ä¹ˆé—®é¢˜ å®¢æˆ·ç«¯ç­›é€‰ä¸ºï¼šdm_data.person dm_data.student ç»“æœæˆ‘ä¸‹è½½åˆ°äº†å…¶ä»–æ•°æ®åº“çš„æ•°æ® ç°åœ¨meta æ•°æ®å¯ä»¥çœ‹åˆ° æˆ‘åªè¦dm_data åº“çš„æ•°æ® ![image](https://user-images.githubusercontent.com/11556152/34139754-70e7f47e-e4b1-11e7-8a96-133c720f9a58.png) ç°åœ¨ä¸‹è½½åˆ°å…¶ä»–åº“çš„æ•°æ®äº† ![image](https://user-images.githubusercontent.com/11556152/34140115-7e1973be-e4b3-11e7-9150-d4e5f4e83c99.png)dm_ è¯•è¿‡å‡ æ¬¡å¯ä»¥ç¨³å®šé‡ç°ï¼Œ åˆ é™¤conf ä¸­å®ä¾‹ä¸­çš„meta.dat   ç„¶åé‡å¯ é‡æ–°æŒ‡å®šinstance.properties ä¸­çš„position å°±å¤±æ•ˆäº†ï¼Œ ç°åœ¨workaround å°±æ˜¯åœ¨ instance.properties å†å†™ä¸€ä¸ªç­›é€‰ clientçš„subscribeçš„æ¡ä»¶æ˜¯æ¯æ¬¡éƒ½å‘é€çš„å—ï¼Ÿ é‡åˆ°ç±»ä¼¼çš„é—®é¢˜ï¼Œç­›é€‰ä¸€å¤§ä¸²è¡¨ï¼Œä¸ªåˆ«è¡¨å°±ç›‘æµ‹ä¸åˆ°æ•°æ®ï¼Œä½†ï¼Œè®¾ç½®ä¸ºåªç›‘æµ‹è¿™ä¸ªè¡¨æ—¶ï¼Œå¯ä»¥é¡ºåˆ©ç›‘æµ‹åˆ°æ•°æ® å‚è€ƒï¼šhttps://github.com/alibaba/canal/wiki/FAQ
456,server ha æ¨¡æ‹Ÿ å®•æœº something goes wrong when getWithoutAck data from server:null something goes wrong when getWithoutAck data from server:null è¯·é—®æ€ä¹ˆç ´ï¼Œè°¢è°¢ é€‰æ‹©ç”¨canal1.0.25æœ€æ–°ç‰ˆå—ï¼Ÿ canal1.0.25ç°åœ¨ä¹Ÿæœ‰è¿™ä¸ªé—®é¢˜ã€‚åœ¨canalçš„å®¢æˆ·ç«¯æŠ¥é”™ã€‚ æˆ‘ä¹Ÿç¢°åˆ°è¿™ä¸ªé—®é¢˜äº†   1.0.25 çœ‹ä¸€ä¸‹æœåŠ¡ç«¯å¯¹åº”çš„å¼‚å¸¸ æ˜¨å¤©æµ‹è¯•çš„æ—¶å€™åœ¨å®¢æˆ·ç«¯å‡ºç°å¼‚å¸¸ï¼Œæ²¡æœ‰å‘ç°æœåŠ¡å™¨ç«¯çš„å¼‚å¸¸ã€‚æµ‹è¯•çš„è¿‡ç¨‹ä¸­ä¸»è¦åœ¨ä¸¤ä¸ªæ–¹é¢å®¢æˆ·ç«¯å‡ºç°å¼‚å¸¸1.å®¢æˆ·ç«¯å¯åŠ¨å¹¶å¤šæ¬¡è¿æ¥æœåŠ¡å™¨ç«¯ 2 æœåŠ¡å™¨ç«¯åœ¨è¿›è¡ŒHAåˆ‡æ¢çš„æ—¶å€™å®¢æˆ·ç«¯å‡ºç°è¿™ä¸ªå¼‚å¸¸ã€‚
455,mysql semi support and mariadb gtid parse mysqlåŠåŒæ­¥semiåè®®åŒ…è§£æ  mariadb gtid è§£æ å¦‚æœmysql  mariadbå¯åŠ¨äº†semi plugin  ç¨‹åºå¯åŠ¨æ—¶å€™-Ddb.semi=1 å¯ç”¨semiè§£ææ¨¡å¼ [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=455) <br/>All committers have signed the CLA. tks
454,cancal bind ip address error Something goes wrong when starting up the canal Server: org.jboss.netty.channel.ChannelException: Failed to bind to xxxx è¯·é—®canalåªèƒ½ç»‘å®šæœ¬æœºipå—ï¼Ÿ å¦‚æœæ˜¯å°vmï¼Œåˆ†é…äº†ä¸€ä¸ªæ˜ å°„çš„ipï¼ŒæŒ‡å®šç»‘å®šæ­¤IPå°±ä¼šæŠ¥å¦‚ä¸Šçš„é”™è¯¯ã€‚ å¯ä»¥æŒ‡å®šç»‘å®šçš„ip 1.0.25 ç»‘å®švmæ˜ å°„IPå¤±è´¥ã€‚åªèƒ½ç»‘å®šæœ¬æœºvmçš„ç§ç½‘ipã€‚ ![canal_err01](https://user-images.githubusercontent.com/34462344/34280405-6547bbc0-e6f2-11e7-9f3f-a08c14c2ceec.png) 
453,åœ¨master/standbyåˆ‡æ¢åï¼Œclientç«¯è§£æé‡å¤æ˜¯å¦æ­£å¸¸ï¼Ÿ å¦‚é¢˜ï¼Œæ·»åŠ master/standbyçš„é…ç½®åï¼Œä¹‹å‰è§£æä¸€æ¬¡ï¼Œåœæ­¢master mysqlååˆ‡æ¢åˆ°standbyï¼Œè§£æsqlåˆå‡ºç°ä¸€æ¬¡ï¼Œæ˜¯å¦æ­£å¸¸ï¼Ÿ ![tim 20171215145732](https://user-images.githubusercontent.com/34462344/34030567-942a6efa-e1a8-11e7-9943-604a372e450f.png) å¦‚å›¾ï¼Œbinlogæ˜¯ä¸ä¸€æ ·çš„ï¼Œä½†æ˜¯è§£æäº†ç›¸åŒçš„sqlï¼Œè¯·æŒ‡ç‚¹æ˜¯å¦æ­£å¸¸ï¼Ÿ æŠ±æ­‰ï¼Œè¯·å…³é—­ï¼Œæµ‹è¯•ä¸æ­£å¸¸ã€‚
452,Galera Mariadb cluster é…ç½®å¤šèŠ‚ç‚¹è§£æé…ç½®  è¯·é—®ï¼Œå¦‚æœä½¿ç”¨galera mariadb clusterçš„è¯ï¼Œä½œä¸ºcanalçš„masterï¼Œæ ¹æ®æ–‡æ¡£ æˆ‘éœ€è¦å†™masterå’Œstandbyçš„ä¿¡æ¯ï¼Œé‚£ä¹ˆåªéœ€è¦é…ç½®å„è‡ªçš„binlog file-nameå’Œposition? å› ä¸ºcanalä¸æ”¯æŒGTIDï¼Œ3å°çš„binlogä¿¡æ¯ä¸ç»Ÿä¸€ï¼Œèƒ½å¦è¾¾åˆ°æ­£å¸¸åˆ‡æ¢çš„æ•ˆæœï¼Ÿ å¯ä»¥ä½¿ç”¨æ—¶é—´æˆ³
451,canalè¿™ä¸ªæŠ¥é”™æ˜¯ä»€ä¹ˆæ²¡ææ‡‚ canalç‰ˆæœ¬  canal.deployer-1.0.23 mysqlç‰ˆæœ¬5.7.18-log å¯¹æ–¹éè¦è®¾ç½®log-bin=master-binå¹¶élog_bin=mysql-bin ä¸çŸ¥é“æ˜¯ä¸æ˜¯è¿™ä¸ªå¼•èµ·ï¼Œç„¶åæŠ¥é”™ä¸º 2017-12-14 18:25:40.835 [destination = cmp_source   address = /100.100.30.203:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position  {"identity":{"slaveId":-1 "sourceAddress":{"address":"100.100.30.203" "port":3306}} "postion":{"included":false "journalName":"master-bin.000001" "position":92307730 "serverId":312 "timestamp":1513246966000}} 2017-12-14 18:25:41.257 [destination = cmp_source   address = /100.100.30.203:3306   EventParser] WARN  com.taobao.tddl.dbsync.binlog.LogDecoder - Decoding Query failed from: master-bin.000001:92307826 java.io.IOException: Read Q_FLAGS2_CODE error: limit excceed: 71 	at com.taobao.tddl.dbsync.binlog.event.QueryLogEvent.unpackVariables(QueryLogEvent.java:650) ~[canal.parse.dbsync-1.0.23.jar:na] 	at com.taobao.tddl.dbsync.binlog.event.QueryLogEvent.<init>(QueryLogEvent.java:477) ~[canal.parse.dbsync-1.0.23.jar:na] 	at com.taobao.tddl.dbsync.binlog.LogDecoder.decode(LogDecoder.java:154) ~[canal.parse.dbsync-1.0.23.jar:na] 	at com.taobao.tddl.dbsync.binlog.LogDecoder.decode(LogDecoder.java:106) ~[canal.parse.dbsync-1.0.23.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:123) [canal.parse-1.0.23.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) [canal.parse-1.0.23.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_111] Caused by: java.lang.IllegalArgumentException: limit excceed: 71 	at com.taobao.tddl.dbsync.binlog.LogBuffer.getUint32(LogBuffer.java:561) ~[canal.parse.dbsync-1.0.23.jar:na] 	at com.taobao.tddl.dbsync.binlog.event.QueryLogEvent.unpackVariables(QueryLogEvent.java:563) ~[canal.parse.dbsync-1.0.23.jar:na] 	... 6 common frames omitted binlogè§£æé”™è¯¯ï¼Œå‡çº§åˆ°1.0.25å§
449,å½“æŒ‡å®šçš„posåˆšå¥½æ˜¯rowdata(TableMapçš„ä¸‹ä¸€æ¡)æ•°æ®æ—¶ï¼Œcanal server ç«¯ä¼šé™·å…¥æ­»å¾ªç¯BUG æµ‹è¯•ç‰ˆæœ¬ï¼šcanal ç‰ˆæœ¬ 1.0.24 1. Canalåœ¨å®ç°è¯¥åŠŸèƒ½æ—¶ï¼Œé€šè¿‡LogEventConvert.parseRowsEvent è§£æeventæ—¶æŠ›å‡º TableIdNotFoundExceptionï¼Œ ä½†æ˜¯parseRowsEvent ç›´æ¥æ•è·äº†æ‰€æœ‰Exceptionï¼Œå¹¶é‡æ–°æŠ›å‡º CanalParseExceptionï¼Œè¿™æ ·AbstractEventParserçš„parseThread å·¥ä½œçº¿ç¨‹è·å–çš„ä¸€ç›´éƒ½æ˜¯Throwableçš„å¼‚å¸¸ï¼Œæ— æ³•æ„ŸçŸ¥åˆ°TableIdNotFoundExceptionï¼Œå¯¼è‡´é™·å…¥æ­»å¾ªç¯ï¼› 2. ä¿®æ”¹LogEventConvert.parseRowsEvent ä½¿å…¶æŠ›å‡ºTableIdNotFoundExceptionåï¼Œä¸‹æ¬¡å¾ªç¯çº¿ç¨‹ä¼šæ„ŸçŸ¥needTransactionPositionå˜é‡å·²ç»ä¼štrueï¼Œè¿›å…¥findTransactionBeginPositionæ–¹æ³•åï¼Œä¼šè°ƒç”¨seekæ–¹æ³•ï¼Œä½†seekæ–¹æ³•åªè§£æäº‹åŠ¡å¤´/å°¾ï¼Œé‚£ä¹ˆå½“å‰çš„seekæ–¹æ³•ä¸­å®ç°çš„sinkçš„eventäº‹ä»¶å°±è§£æä¸åˆ°(å› ä¸ºrowdataæ•°æ®è¢«è¿‡æ»¤äº†)ï¼Œæ•…reDump ä¸€ç›´éƒ½ä¸ä¼šä¸ºtrueï¼Œä»è€Œä¹Ÿä¸ä¼šè¿›å…¥ä»å¤´è¯»å–binlogçš„é€»è¾‘å†…ï¼Œå°±åˆè¿›å…¥äº†ä¸»çº¿ç¨‹çš„æ­»å¾ªç¯å†…ã€‚ PS: ä¸ªäººç®€å•åˆ†æï¼Œä¸çŸ¥æ˜¯å¦ç†è§£æœ‰è¯¯ï¼ŒæŠ‘æˆ–æ˜¯findTransactionBeginPositionä¸æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªåœºæ™¯çš„?@agapple ä¿®å¤å»ºè®®1ï¼š 1. å°†LogEventConvert.parseRowsEvent åœ¨catch CanalParseExceptionå‰åŠ ä¸ªcatch TableIdNotFoundExceptionå¹¶å°†å…¶æŠ›å‡ºï¼Œè®©ä¸Šå±‚ç»§ç»­æ„ŸçŸ¥ï¼› 2. å°†MysqlEventParser.findTransactionBeginPositionæ–¹æ³•ä¸­çš„ç¬¬ä¸€ä¸ªmysqlConnection.seekæ”¹ä¸ºmysqlConnection.dump å³å¯è§£å†³è¿™ä¸ªBUG ä¿®å¤å»ºè®®2ï¼šå› ä¸ºMysqlEventParser.findTransactionBeginPositionåªåœ¨needTransactionPositionä¸ºtrueæ—¶è°ƒç”¨ï¼Œæ•…åˆ é™¤MysqlEventParser.findTransactionBeginPositionæ–¹æ³•ä¸­çš„ç¬¬ä¸€ä¸ªmysqlConnection.seeké€»è¾‘ï¼Œç›´æ¥è®©å…¶è¿›å…¥reDumpé€»è¾‘å†…ä¹Ÿå¯è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå‡å°‘ä¸€æ¬¡dumpè¯·æ±‚ï¼› è¿™ä¸ª1.0.25æˆ‘è®°å¾—æœ‰ä¿®å¤è¿‡ï¼Œå¯ä»¥å…ˆå°è¯•ä¸€ä¸‹ okï¼Œæˆ‘åˆ‡æ¢åˆ°1.0.25é‡æ–°è¯•ä¸€ä¸‹ @agapple æˆ‘æµ‹äº†1.0.25çš„ä»£ç ï¼Œé€šè¿‡ä»¥ä¸‹åœºæ™¯ä»ç„¶å¯ä»¥éå¸¸å®¹æ˜“å¤ç°ï¼š 1. binlogæ–‡ä»¶å†…å®¹ ![image](https://user-images.githubusercontent.com/33280738/33978900-d4cbc89a-e0dc-11e7-9104-bd4b3c083a0b.png) å›¾ä¸Šæ ‡çº¢çš„æ˜¯rowdata æ•°æ®æ‰€åœ¨pos: 981 2. æŒ‡å®š canalçš„å¯åŠ¨ä½ç‚¹å³ä¸º 981è¿™ä¸ªä½ç½® 3. å¯åŠ¨server è§‚å¯Ÿæ—¥å¿—å¦‚ä¸‹ï¼š ![image](https://user-images.githubusercontent.com/33280738/33979023-720fb1de-e0dd-11e7-8baf-0c29da157c32.png) å¯ä»¥çœ‹åˆ°ä¸€ç›´å¤„äºå¾ªç¯å¯åŠ¨çš„çŠ¶æ€ï¼› é€šè¿‡findTransactionBeginPositionçš„ç¬¬ä¸€ä¸ªmysqlconnection.seekæ–¹æ³•æ˜¯æ‰¾ä¸åˆ° 981è¿™ä¸ªeventçš„ï¼Œå¿…é¡»è¦è®©981 è¿™ä¸ªevent é‡æ–°å‘ç”ŸTableIdNotFoundExceptionï¼ŒreDumpçš„é€»è¾‘æ‰å¯æ‰§è¡Œã€‚ è¿™å—æˆ‘å…³æ³¨ä¸€ä¸‹
448,è¯·é—®mysqlå’Œmariadbçš„binlogæœ‰å•¥åŒºåˆ«ï¼Œcanalå¯¹mysqlå’Œmariadbçš„binlogè§£ææœ‰å•¥åŒºåˆ« å¦‚é¢˜ï¼Œè¯·é—®mysqlå’Œmariadbçš„binlogæœ‰å•¥åŒºåˆ«ï¼Œcanalå¯¹mysqlå’Œmariadbçš„binlogè§£ææœ‰å•¥åŒºåˆ«ï¼Ÿ canal/dbsync/src/main/java/com/taobao/tddl/dbsync/binlog/event/mariadb/BinlogCheckPointLogEvent.javaåœ¨è¿™ä¸ªç±»ä¸‹ï¼Œ  public BinlogCheckPointLogEvent(LogHeader header  LogBuffer buffer  FormatDescriptionLogEvent descriptionEvent){         super(header  buffer  descriptionEvent);         // do nothing   just mariadb binlog checkpoint     }ä¸­çš„// do nothing   just mariadb binlog checkpoint æ˜¯å•¥æ„æ€ï¼Œè¿™ä¸ªç±»æ˜¯æ€ä¹ˆå¤„ç†çš„ å¤šçœ‹wikiï¼Œæœ‰æè¿° æ¯æ‰¾åˆ°ï¼Œå¯ä»¥å‘ä¸ªé“¾æ¥æˆ–è€…æˆªå›¾å—ï¼Œè°¢è°¢ @agapple  wikiä¸Š"BinlogChange(MariaDB5&amp;10)"å¥½åƒå·²ç»åˆ æ‰äº† é‚£ä½ è¿˜æœ‰åŸç‰ˆçš„å— é“¾æ¥ä¿®å¤äº†
447,è§£å†³destinationæ— é™è¿æ¥ç­‰å¾…çš„bug å½“æœ‰å¤šä¸ªdestinationåŒæ—¶ä¸æ•°æ®åº“å»ºç«‹è¿æ¥æ—¶ï¼ˆæˆ‘è¿™é‡Œæ˜¯8ä¸ªä»¥ä¸Šï¼‰ï¼Œä¼šæœ‰å¤§æ¦‚ç‡å‘ç”Ÿéƒ¨åˆ†destinationå¾—ä¸åˆ°æ•°æ®åº“åé¦ˆï¼Œä»¥è‡´æ— é™çš„ç­‰å¾…ï¼Œè€Œæ— æ³•å¼€å§‹æ•°æ®åŒæ­¥ã€‚ å› æ­¤åœ¨åˆå§‹åŒ–destinationæ—¶ï¼ŒåŠ å…¥äº†timeoutå¤„ç†ï¼Œå¦‚æœè¶…æ—¶ï¼ˆç›®å‰æ˜¯3ç§’ï¼‰ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œé‡è¯•ï¼Œä»¥å°è¯•å†æ¬¡å»ºç«‹è¿æ¥ã€‚ [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=447) <br/>All committers have signed the CLA. tks
445,è¯·é—®ç›®å‰canalçš„ç‰ˆæœ¬æ”¯æŒmariadb10.0.2ä»¥ä¸Šçš„GTIDå—ï¼Ÿ å¦‚é¢˜ï¼Œç°åœ¨mariadbçš„ç¨³å®šç‰ˆæœ¬æ˜¯10.2.10ï¼Œå¯ä»¥ä½¿ç”¨GTIDå’Œcanalåšbinlogè§£æå—ï¼Ÿ ä¸æ”¯æŒGTID é‚£è¯·é—®æ”¯æŒmysql5.7çš„GTIDå— gtidåœ¨26ç‰ˆæœ¬é‡Œå·²æ”¯æŒï¼Œå¯ä»¥æµ‹è¯•ä¸€ä¸‹
444,canal server å¼‚å¸¸ 'show binlog events limit 1â€™ ä¸Šåˆbinlogæ—¥å¿—è¢«åˆ ï¼Œä¸‹åˆé‡å¯ä»»åŠ¡ï¼Œcanal client æ—¥å¿—æ²¡æœ‰å¼‚å¸¸ï¼Œcanal serverå¼‚å¸¸ï¼š 2017-12-11 19:35:30.882 [destination = fengdai_mqnotify   address = /10.20.21.11:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /10.20.21.11:3306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: command : 'show binlog events limit 1' has an error! Caused by: java.io.IOException: Unexpected End Stream 	at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.readBytesAsBuffer(PacketManager.java:22) ~[canal.parse.driver-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.readHeader(PacketManager.java:13) ~[canal.parse.driver-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.readNextPacket(MysqlQueryExecutor.java:104) ~[canal.parse.driver-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.query(MysqlQueryExecutor.java:77) ~[canal.parse.driver-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:73) ~[canal.parse-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPosition(MysqlEventParser.java:610) ~[canal.parse-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findByStartTimeStamp(MysqlEventParser.java:514) ~[canal.parse-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPositionInternal(MysqlEventParser.java:358) ~[canal.parse-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPosition(MysqlEventParser.java:315) ~[canal.parse-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:161) ~[canal.parse-1.0.24.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_66] æƒ³ç¡®è®¤ä¸‹ä¸ºä½•ä¸ºä½•ä¸Šåˆæ—¥å¿—è¿˜æ˜¯èƒ½æ­£å¸¸å†™å…¥ï¼Œè€Œé‡å¯ä¼šå‡ºç°è¿™ç§æƒ…å†µ @agapple  com.alibaba.otter.canal.parse.exception.CanalParseException: command : 'show binlog events limit 1' has an error! Caused by: java.io.IOException: Unexpected End Stream é‡å¯ä¸‹mysqlæˆ–é‡æ–°å¼€å¯binlogå°±å¥½äº†å˜›ï¼Ÿ
443,canalè®¾ç½®ZooKeeperMetaManager 1.canalåœ¨zookeeperåœ¨åˆ‡æ¢HAæ—¶ï¼Œä¼šå­˜åœ¨é‡å¤æ¶ˆè´¹é—®é¢˜ 2.canalä¸èƒ½å¾ˆå¥½çš„ä¿®æ”¹å»position åŸºäºä»¥ä¸Šä¸¤ç‚¹ï¼Œæƒ³è¦åˆ‡æ¢è‡³ZooKeeperMetaManagerï¼Œæ•…ç›®å‰é€šè¿‡ä¿®æ”¹XXX-instance.xmlæ¥è¿›è¡Œï¼Œä½†ä¼šæŠ¥é”™ï¼šorg.I0Itec.zkclient.exception.ZkNoNodeException: org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /otter/canal/destinations/example/1001/markï¼Œå³ä½¿æ‰‹åŠ¨æ·»ä¸ŠèŠ‚ç‚¹åï¼Œå…ƒæ•°æ®ä¾æ—§æ²¡æœ‰åªå­˜åœ¨zokeeperä¸­ï¼Œè¿˜æ˜¯å…ˆå­˜åœ¨å†…å­˜ç„¶åå®šæ—¶åˆ·åˆ°zkä¸­çš„ @agapple  è¯·é—®ï¼Œè§£å†³ä¸Šè¿°ä¸¤ä¸ªé—®é¢˜æœ‰æ›´å¥½çš„æ–¹å¼å—ï¼Ÿå¦‚ä½•å¯ä»¥æ›´ä¼˜é›…çš„æŒ‡å®špositionçš„ä½ç½®æ¥è¿›è¡Œæ¶ˆè´¹ å®Œæ•´çš„é”™è¯¯ï¼š exception=org.I0Itec.zkclient.exception.ZkNoNodeException: org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /otter/canal/destinations/example/1001/mark 	at org.I0Itec.zkclient.exception.ZkException.create(ZkException.java:47) 	at org.I0Itec.zkclient.ZkClient.retryUntilConnected(ZkClient.java:685) 	at org.I0Itec.zkclient.ZkClient.getChildren(ZkClient.java:413) 	at org.I0Itec.zkclient.ZkClient.getChildren(ZkClient.java:409) 	at com.alibaba.otter.canal.meta.ZooKeeperMetaManager.clearAllBatchs(ZooKeeperMetaManager.java:231) 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.rollback(CanalServerWithEmbedded.java:406) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:182) 	at org.jboss.netty.channel.SimpleChannelHandler.handleUpstream(SimpleChannelHandler.java:100) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564) 	at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:783) 	at org.jboss.netty.channel.SimpleChannelHandler.messageReceived(SimpleChannelHandler.java:154) 	at org.jboss.netty.channel.SimpleChannelHandler.handleUpstream(SimpleChannelHandler.java:100) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564) 	at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:783) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:275) 	at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:80) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564) 	at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:783) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndFireMessageReceived(ReplayingDecoder.java:525) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:506) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:443) 	at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:80) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:559) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:349) 	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:280) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:200) 	at org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108) 	at org.jboss.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:44) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) 	at java.lang.Thread.run(Thread.java:748) Caused by: org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /otter/canal/destinations/example/1001/mark 	at org.apache.zookeeper.KeeperException.create(KeeperException.java:111) 	at org.apache.zookeeper.KeeperException.create(KeeperException.java:51) 	at org.apache.zookeeper.ZooKeeper.getChildren(ZooKeeper.java:1468) 	at org.apache.zookeeper.ZooKeeper.getChildren(ZooKeeper.java:1496) 	at com.alibaba.otter.canal.common.zookeeper.ZooKeeperx.getChildren(ZooKeeperx.java:107) 	at org.I0Itec.zkclient.ZkClient$2.call(ZkClient.java:416) 	at org.I0Itec.zkclient.ZkClient$2.call(ZkClient.java:413) 	at org.I0Itec.zkclient.ZkClient.retryUntilConnected(ZkClient.java:675) 	... 34 more ç†è®ºè®¾è®¡ä¸Šå°±æ²¡æ³•ä¿è¯ä¸é‡å¤ @agapple   å¦‚æœå…ƒæ•°æ®åªå­˜åœ¨zkä¸­ï¼Œåœ¨é‡å¤çš„è¿™ä¸ªé—®é¢˜ä¸Šä¼šç¨å¾®å¥½ä¸€äº›ï¼Œä½†ç¨‹åºæ•´ä½“çš„æ•ˆç‡ä¼šå‡ä½ï¼Œè¿™æ˜¯å–èˆçš„é—®é¢˜ï¼Œè¿™ä¸ªç†è§£ã€‚ å¦å¤–æƒ³è¯·é—®ä¸€ä¸‹ï¼Œ canal 1.0.24 æƒ³è¦åˆ‡æ¢è‡³ZooKeeperMetaManagerï¼Œæ˜¯å¦å¯ä»¥é€šè¿‡ä¿®æ”¹XXX-instance.xmlæ¥è¿›è¡Œï¼Œè™½ç„¶è¿™æ ·ä¼šåœ¨ä¸€å®šçš„ç¨‹åº¦ä¸Šé™ä½ç¨‹åºçš„æ•ˆç‡(å°è¯•è¿‡ä½†å¤±è´¥äº†)ï¼Ÿ å¦å¤–æ˜¯å¦å¯ä»¥æœ‰åŠæ³•ä¼˜é›…çš„æŒ‡å®šä½ç½®æ¥è¿›è¡Œæ¶ˆè´¹ï¼Œä¸é€šè¿‡é‡å¯ï¼Œæ¯”å¦‚åªæ˜¯ä¿®æ”¹zkä¸­positionï¼Œå³å¯å®ç°ï¼Ÿ ç›®å‰æš‚æ—¶æ²¡æœ‰è¿™æ ·çš„APIå¯ä»¥ç›´æ¥æŒ‡å®šä½ç‚¹å¯åŠ¨
442,table metaç”Ÿæˆsnapshotæ¯”è¾ƒæ–¹æ³•æœ‰é—®é¢˜ DatabaseTableMeta.applySnapshotToDB()æ–¹æ³•ä¸­ï¼Œå…ˆè·å–ä¸€ä¸ªmemoryTableMetaçš„å‰¯æœ¬tmpMemoryTableMetaï¼Œç„¶åå†å»masteråº“ä¸­å»å¯¹æ¯”ï¼Œç„¶åå¦‚æœä¸€åˆ‡æ­£å¸¸åˆ™æŒä¹…åŒ–snapshot. ä½†åœ¨å’Œmasteråº“ä¸­ddlåšå¯¹æ¯”æ—¶ï¼Œå´metaä¿¡æ¯æ˜¯ä»memoryTableMetaè€Œä¸æ˜¯tmpMemoryTableMetaï¼Œè§compareTableMetaDbAndMemory()æ–¹æ³•ã€‚ è¿™æ ·åœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼Œä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´æƒ…å†µã€‚ fix issueï¼šå¯¹æ¯”æ—¶ä»tmpMemoryTableMetaä¸­å–metaä¿¡æ¯ã€‚ >>>>>> private boolean compareTableMetaDbAndMemory(MysqlConnection connection  final String schema  final String table) {         TableMeta tableMetaFromMem = memoryTableMeta.find(schema  table); <<<<<< private boolean compareTableMetaDbAndMemory(MysqlConnection connection  final String schema  final String tableï¼ŒMemoryTableMeta            tmpMemoryTableMeta) {         TableMeta tableMetaFromMem = tmpMemoryTableMeta.find(schema  table); ...... çœ‹çš„éå¸¸ä»”ç»†ï¼Œå¯¹è¿™å—TSDBæ¯”è¾ƒç†è§£ï¼Œä¼šæœ‰ä¸€ä¸ªå¹¶å‘é—®é¢˜
441,canalå®¢æˆ·ç«¯æœªæç¤ºé”™è¯¯ï¼Œserverç«¯å¼‚å¸¸ï¼šbatchId:414 is not the firstly:404ï¼Œè¯·é—®è¿™ä¸ªæ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´ @agapple  æƒ³é—®ä¸‹ä»¥ä¸‹æ˜¯ä»€ä¹ˆæƒ…å†µå¯¼è‡´ï¼Œæ±‚åŠ© 2017-12-07 12:11:57.887 [New I/O server worker #1-4] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - subscribe filter change to bank_supervised_account_10.account_item_detail_rel_user bank_supervised_account_10.account_itemized_err_user bank_supervised_account_10.account_detail_err_user bank_supervised_account_10.account_detail_user bank_supervised_account_10.account_frozen_user bank_supervised_account_10.account_itemized_user bank_supervised_account_10.account_user bank_supervised_account_10.bank_user bank_supervised_account_10.company_user_info 2017-12-07 12:12:04.964 [New I/O server worker #1-4] ERROR com.alibaba.otter.canal.server.netty.NettyUtils - ErrotCode:400   Caused by :  something goes wrong with channel:[id: 0x1fe5e36c  /10.203.151.61:38324 => /10.203.151.17:11111]  exception=com.alibaba.otter.canal.meta.exception.CanalMetaManagerException: batchId:414 is not the firstly:404 2017-12-07 12:12:04.965 [New I/O server worker #1-4] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x1fe5e36c  /10.203.151.61:38324 :> /10.203.151.17:11111]  exception=java.nio.channels.ClosedChannelException 	at org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:643) 	at org.jboss.netty.channel.socket.nio.NioWorker.writeFromUserCode(NioWorker.java:370) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:137) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76) 	at org.jboss.netty.channel.Channels.write(Channels.java:611) 	at org.jboss.netty.channel.Channels.write(Channels.java:578) 	at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:28) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:144) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:275) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndFireMessageReceived(ReplayingDecoder.java:525) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:506) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.cleanup(ReplayingDecoder.java:541) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.channelDisconnected(ReplayingDecoder.java:449) 	at org.jboss.netty.channel.Channels.fireChannelDisconnected(Channels.java:360) 	at org.jboss.netty.channel.socket.nio.NioWorker.close(NioWorker.java:593) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:119) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76) 	at org.jboss.netty.channel.Channels.close(Channels.java:720) 	at org.jboss.netty.channel.AbstractChannel.close(AbstractChannel.java:200) 	at org.jboss.netty.channel.ChannelFutureListener$1.operationComplete(ChannelFutureListener.java:46) 	at org.jboss.netty.channel.DefaultChannelFuture.notifyListener(DefaultChannelFuture.java:381) 	at org.jboss.netty.channel.DefaultChannelFuture.addListener(DefaultChannelFuture.java:148) 	at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:30) 	at com.alibaba.otter.canal.server.netty.NettyUtils.error(NettyUtils.java:51) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:200) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:275) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndFireMessageReceived(ReplayingDecoder.java:525) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:506) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:443) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:349) 	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:280) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:200) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) 	at java.lang.Thread.run(Thread.java:745) batchId:414 is not the firstly:404ï¼Œæœ‰ä¹±åºæ¶ˆè´¹å—ï¼Ÿ è¿™ç§æƒ…å†µæ€ä¹ˆå¤„ç†  è·Ÿä¹‹å‰ä»£ç ä¸Šæ²¡ä»€ä¹ˆå¤ªå¤§æ”¹å˜  é‡æ–°åœæ‰ä½œä¸šå¼€å¯å°±å‡ºç°è¿™ä¸ªé—®é¢˜ å·²ç»æ‰¾åˆ°é—®é¢˜äº†  è°¢è°¢äº†  è‡ªå·±sqlè§£æä»£ç ä¸Šä¼ ç©ºé—®é¢˜å¯¼è‡´
440,é»˜è®¤å¼€å¯tsdb ç³»ç»Ÿå¯åŠ¨æœ‰å¼‚å¸¸ ä½¿ç”¨çš„1.0.25ç‰ˆæœ¬ å…¶ä¸­é»˜è®¤å¼€å¯äº†tsdb å¯åŠ¨åä¼šæŠ¥é”™ ``` 2017-12-07 17:16:23.254 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /127.0.0.1:3306 has an error  retrying. caused by java.lang.NullPointerException: null         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPositionInternal(MysqlEventParser.java:428) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPosition(MysqlEventParser.java:348) ~[canal.parse-1.0.25.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:164) ~[canal.parse-1.0.25.jar:na]         at java.lang.Thread.run(Unknown Source) [na:1.8.0_144] 2017-12-07 17:16:23.256 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.lang.NullPointerException         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPositionInternal(MysqlEventParser.java:428)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPosition(MysqlEventParser.java:348)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:164)         at java.lang.Thread.run(Unknown Source) ``` å°† canal.instance.tsdb.spring.xml=classpath:spring/tsdb/h2-tsdb.xml æ³¨é‡Šå°±å¥½äº† canal.instance.tsdb.enableè®¾ä¸ºfalseä¸èµ·ä½œç”¨ å¦å¤–å¸Œæœ›æœ‰è¿™äº›å‚æ•°çš„è¯¦ç»†è¯´æ˜ ä½ åˆå§‹å¯åŠ¨çš„binlogä½ç‚¹æŒ‡å®šäº†å•¥ï¼Œç…§ç†ä¸åº”è¯¥æ˜¯æœ‰NPEå•Šï¼Œä¸ä¼šæ˜¯æŒ‡å®šäº†offest=4å§ï¼Ÿ é…ç½®å¦‚ä¸‹: ```    canal.instance.master.journal.name= mysql-bin.000001    canal.instance.master.position= 154    canal.instance.master.timestamp= ``` çœ‹åˆ°ä¸Šé¢æœ‰ä»£ç ä¿®æ”¹ ä½†æ˜¯åªä¸‹canalç¼–è¯‘ä¸é€šè¿‡ å¾—æœ‰druidçš„previewç‰ˆæœ¬ æ˜¯ä¸æ˜¯è¦ä¿®æ”¹ä¸€ä¸‹ ä¸æ–¹ä¾¿æµ‹è¯• https://github.com/alibaba/druidï¼Œå¯ä»¥ä¸´æ—¶ä¸‹è½½druidåŒ…ï¼Œæ‰§è¡Œmvn clean install -Dmaven.test.skipå³å¯ç”Ÿæˆpreviewç‰ˆæœ¬ åŸºäºtable tsdbçš„é…ç½®ï¼Œå¦‚æœåœ¨æ²¡æœ‰å¯¹åº”ä½ç‚¹çš„timestampæ—¶ï¼Œä¼šå°è¯•é€šè¿‡binlogæŸ¥æ‰¾æ¥ç¡®å®šæ—¶é—´æˆ³ï¼Œå¦‚æœæ‰¾ä¸åˆ°å°±æ˜¯è¿™é‡Œçš„NPE.    table metaçš„å†å²å¤šç‰ˆæœ¬è®¾è®¡ï¼Œä¸»è¦æ˜¯åŸºäºæ—¶é—´æˆ³æ¥å®šä½ï¼Œæ‰€ä»¥å¯åŠ¨æ—¶ä»»ä½•ä¸€ä¸ªæ—¶é—´ç‚¹éƒ½å¿…é¡»è¦æœ‰ä¸€ä¸ªæ—¶é—´æˆ³ é‡åˆ°åŒæ ·çš„é—®é¢˜ï¼Œåˆ‡åˆ° v1.0.26 çš„ç‰ˆæœ¬ä¸Š OK
439,parse faield : CREATE TABLE `columns_priv` Exampleçš„æ—¥å¿—å‘ç°è¿™ä¸ªé”™è¯¯ åº”è¯¥æ˜¯ç¾¤é‡Œåé¦ˆçš„setç±»å‹ä¸æ”¯æŒçš„é—®é¢˜ï¼Œå·²ç»åé¦ˆç»™druidè¿›è¡Œä¿®å¤ https://github.com/alibaba/druid/commit/f8731f9182f01353e53331cf8ad590c6ca3db416  Okayï¼Œæˆ‘ä»¬æš‚æ—¶æŠŠè¿™ä¸ªåŠŸèƒ½ç»™ç¦ç”¨æ‰äº†ã€‚
437,åœ¨LogEventConvert.parseOneRowæ–¹æ³•ä¸­ï¼Œæ·»åŠ æ‰©å±•å­—æ®µï¼Œclientç«¯ï¼Œå‡ºç°é‡å¤æ•°æ® åœ¨LogEventConvert.parseOneRowæ–¹æ³•ä¸­ï¼Œ æ·»åŠ æ‰©å±•å­—æ®µï¼šrowDataBuilder.addProps(createSpecialPair("testName" "testValue")); client ç«¯ï¼š CanalEntry.RowDataæ¥æ”¶åˆ°é‡å¤keyï¼ˆtestNameï¼‰ çš„ Pair  è¿™ç§æ–¹å¼æ‰å¯ä»¥ï¼Œä¸ä¼šé‡å¤ï¼ŒPair.Builder builder = rowDataBuilder.addPropsBuilder(); æ²¡çœ‹æ‡‚å…·ä½“é—®é¢˜
436,1.0.24ç‰ˆæœ¬HAæ¨¡å¼éƒ¨ç½²ï¼Œæ–°å¢instanceåserverç«¯å¼‚å¸¸ï¼Œå®¢æˆ·ç«¯æœªæç¤ºé”™è¯¯ 2017-12-05 19:07:43.385 [New I/O server worker #1-10] ERROR com.alibaba.otter.canal.server.netty.NettyUtils - ErrotCode:400   Caused by :  something goes wrong with channel:[id: 0x4926cac6  /192.168.182.17:2025 => /192.168.182.13:11111]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: ack error   clientId:1001 batchId:1 is not exist   please check 2017-12-05 19:07:43.390 [New I/O server worker #1-10] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x4926cac6  /192.168.182.17:2025 :> /192.168.182.13:11111]  exception=java.nio.channels.ClosedChannelException 	at org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:643) 	at org.jboss.netty.channel.socket.nio.NioWorker.writeFromUserCode(NioWorker.java:370) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:137) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76) 	at org.jboss.netty.channel.Channels.write(Channels.java:611) 	at org.jboss.netty.channel.Channels.write(Channels.java:578) 	at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:28) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:144) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:275) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndFireMessageReceived(ReplayingDecoder.java:525) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:506) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.cleanup(ReplayingDecoder.java:541) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.channelDisconnected(ReplayingDecoder.java:449) 	at org.jboss.netty.channel.Channels.fireChannelDisconnected(Channels.java:360) 	at org.jboss.netty.channel.socket.nio.NioWorker.close(NioWorker.java:593) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:119) 	at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76) 	at org.jboss.netty.channel.Channels.close(Channels.java:720) 	at org.jboss.netty.channel.AbstractChannel.close(AbstractChannel.java:200) 	at org.jboss.netty.channel.ChannelFutureListener$1.operationComplete(ChannelFutureListener.java:46) 	at org.jboss.netty.channel.DefaultChannelFuture.notifyListener(DefaultChannelFuture.java:381) 	at org.jboss.netty.channel.DefaultChannelFuture.addListener(DefaultChannelFuture.java:148) 	at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:30) 	at com.alibaba.otter.canal.server.netty.NettyUtils.error(NettyUtils.java:51) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:200) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:275) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndFireMessageReceived(ReplayingDecoder.java:525) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:506) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:443) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:349) 	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:280) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:200) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615) 	at java.lang.Thread.run(Thread.java:745) clientId:1001 batchId:1 is not exist   please check ä¼°è®¡è§¦å‘instance reloadäº†ï¼Œå®¢æˆ·ç«¯é‡è¯•ä¸€ä¸‹å³å¯ é‡å¯å®¢æˆ·ç«¯è§£å†³äº†ï¼Œå¤šè°¢
435,å¯åŠ¨canal-clientåå¦‚ä½•å…³é—­zookeeperDebugæ¨¡å¼ã€‚ å¦‚é¢˜ï¼Œåœ¨å“ªé‡Œé…ç½®å…³é—­zookeeperDebugæ¨¡å¼ã€‚ googleæœç´¢
434,org.jboss.netty.channel.ChannelException: Failed to bind to: 0.0.0.0/0.0.0.0:11111 canalå¯åŠ¨ä¹‹åï¼Œcanal.logä¸­æŠ¥é”™ï¼Œä¸çŸ¥å¦‚ä½•è§£å†³ï¼Œæ±‚å¤§ç¥èµæ•™~ OpenJDK 64-Bit Server VM warning: ignoring option PermSize=96m; support was removed in 8.0 OpenJDK 64-Bit Server VM warning: ignoring option MaxPermSize=256m; support was removed in 8.0 org.jboss.netty.channel.ChannelException: Failed to bind to: 0.0.0.0/0.0.0.0:11111         at org.jboss.netty.bootstrap.ServerBootstrap.bind(ServerBootstrap.java:303)         at sun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:223)         at sun.nio.ch.ServerSocketAdaptor.bind(ServerSocketAdaptor.java:74) OpenJDK 64-Bit Server VM warning: ignoring option PermSize=96m; support was removed in 8.0 OpenJDK 64-Bit Server VM warning: ignoring option MaxPermSize=256m; support was removed in 8.0 OpenJDK 64-Bit Server VM warning: UseCMSCompactAtFullCollection is deprecated and will likely be removed in a future release. 2017-12-04 19:36:38.282 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## start the canal server. 2017-12-04 19:36:38.340 [main] INFO  com.alibaba.otter.canal.deployer.CanalController - ## start the canal server[10.108.211.136:11111] 2017-12-04 19:36:38.736 [main] ERROR com.alibaba.otter.canal.deployer.CanalLauncher - ## Something goes wrong when starting up the canal Server: org.jboss.netty.channel.ChannelException: Failed to bind to: 0.0.0.0/0.0.0.0:11111         at org.jboss.netty.bootstrap.ServerBootstrap.bind(ServerBootstrap.java:303)         at com.alibaba.otter.canal.server.netty.CanalServerWithNetty.start(CanalServerWithNetty.java:79)         at com.alibaba.otter.canal.deployer.CanalController.start(CanalController.java:418)         at com.alibaba.otter.canal.deployer.CanalLauncher.main(CanalLauncher.java:35) Caused by: java.net.BindException: Address already in use         at sun.nio.ch.Net.bind0(Native Method)         at sun.nio.ch.Net.bind(Net.java:433)         at sun.nio.ch.Net.bind(Net.java:425)         at sun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:223)         at sun.nio.ch.ServerSocketAdaptor.bind(ServerSocketAdaptor.java:74)         at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.bind(NioServerSocketPipelineSink.java:148)         at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleServerSocket(NioServerSocketPipelineSink.java:100)         at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:74)         at org.jboss.netty.channel.Channels.bind(Channels.java:468)         at org.jboss.netty.channel.AbstractChannel.bind(AbstractChannel.java:192)         at org.jboss.netty.bootstrap.ServerBootstrap$Binder.channelOpen(ServerBootstrap.java:348)         at org.jboss.netty.channel.Channels.fireChannelOpen(Channels.java:176)         at org.jboss.netty.channel.socket.nio.NioServerSocketChannel.<init>(NioServerSocketChannel.java:85)         at org.jboss.netty.channel.socket.nio.NioServerSocketChannelFactory.newChannel(NioServerSocketChannelFactory.java:142)         at org.jboss.netty.channel.socket.nio.NioServerSocketChannelFactory.newChannel(NioServerSocketChannelFactory.java:90)         at org.jboss.netty.bootstrap.ServerBootstrap.bind(ServerBootstrap.java:282)         ... 3 more Caused by: java.net.BindException: Address already in use ç«¯å£å†²çª
433,canal client æ‹¿åˆ°çš„æ•°æ®é‡å¤ cannal å®¢æˆ·ç«¯ æ‹¿æ•°æ® ç¬¬ä¸€æ¬¡æ‹¿æ˜¯ batchId=1 size=1 msg=Message[id=1 exit åç¬¬äºŒæ¬¡æ‹¿æ•°æ®å˜æˆ batchId=2 size=2 msg=Message[id=2 è€Œä¸”ç¬¬äºŒæ¬¡æ‹¿åˆ°çš„æ˜¯ ä¸¤æ¡é‡å¤çš„æ•°æ®  æœ‰ä¸€æ ·çš„ logfileName: "mysql-bin.000012"   logfileOffset: 3207300 é‡å¯canal serveråï¼Œå¯åŠ¨ canalå®¢æˆ·ç«¯ åˆå˜æˆç¬¬ä¸€æ¬¡æ‹¿æ•°æ®ï¼Œä¹‹åå†æ‹¿æ•°æ®éƒ½ä¼šé‡å¤ï¼Œè¯·é—®è¿™ä¸ªæ€ä¹ˆè§£å†³ï¼Œæ€»ä¸èƒ½æ¯æ¬¡è°ƒè¯•éƒ½ é‡å¯canal serverå§ ``` CanalConnector connector = CanalConnectors.newSingleConnector(new InetSocketAddress("192.168.157.130"  11111)  "example"  ""  "");         int batchSize = 10;         int emptyCount = 0;         try {             connector.connect();             connector.subscribe(".*\\..*");             connector.rollback();             int totalEmtryCount = 120;             while (emptyCount < totalEmtryCount) {                 Message message = connector.getWithoutAck(batchSize); // è·å–æŒ‡å®šæ•°é‡çš„æ•°æ®                 long batchId = message.getId();                 int size = message.getEntries().size();                 if (batchId == -1 || size == 0) {                     emptyCount++;                     System.out.println("empty count : " + emptyCount);                     try {                         Thread.sleep(1000);                     } catch (InterruptedException e) {                     }                 } else {                     emptyCount = 0;                      System.out.printf("message[batchId=%s size=%s msg=%s] \n"  batchId  size  message.toString());                      System.exit(0);                      printEntry(message.getEntries());                 }                 connector.ack(batchId); // æäº¤ç¡®è®¤                 // connector.rollback(batchId); // å¤„ç†å¤±è´¥  å›æ»šæ•°æ®             }             System.out.println("empty too many times  exit");         } finally {             connector.disconnect();         } ``` é‡å¤æ•°æ®æ— æ³•é¿å…
432,ç›´æ¥åŠ å…¥æŠŠdb event pushåˆ°kafkaï¼Œæœ€æ–¹ä¾¿çš„åšæ³•æ”¹åŠ¨å“ªå—æ¯”è¾ƒå¥½ï¼Ÿ æŠŠcanalå½“databusç”¨ã€‚ç›®å‰æ˜¯å†™ä¸ªç®€æ˜“çš„canalClientï¼Œè¿æ¥canal serveræŒ‡å®šçš„Destination  ä½†æ˜¯è¿™æ ·clientå­˜åœ¨å•ç‚¹é£é™©ã€‚   æƒ³ç›´æ¥æŠŠå‘é€kafkaæ¶ˆæ¯é›†ä¸­åˆ°canalå†…ï¼Œåˆ©ç”¨å·²æœ‰çš„zk çƒ­å¤‡çš„æ¨¡å¼ï¼Œé¿å…å•ç‚¹.    cannalæºç ä»å“ªå—åšæ”¹åŠ¨ï¼Œæ’å…¥è¿™ä¸ªåŠŸèƒ½æ¯”è¾ƒå¥½ï¼Ÿ canal çš„clientä¹Ÿå¯ä»¥æ˜¯HAçš„ @wingerx è°¢è°¢ï¼Œé‚£æˆ‘å»çœ‹ä¸‹clientä»£ç å»äº†ã€‚è¿™æ ·æœ€å¥½äº†ã€‚
431,connector.getWithoutAckæ–¹æ³•çš„batchSizeä¸èµ·ä½œç”¨ ä½¿ç”¨è¿‡ç¨‹ä¸­å‘ç°ï¼Œæ— è®ºbatchSizeä¼ å¤šå°‘ï¼Œèµ·ä½œç”¨çš„æ˜¯canal.propertiesé‡Œé…ç½®çš„buffer sizeè€Œéæ–¹æ³•å…¥å‚batchSizeã€‚ bufferSizeæ˜¯ä¸€ä¸ªå½“å‰å†…å­˜é‡Œçš„æœ€å¤§è®°å½•å€¼ï¼Œä½ æ˜¯ä¸æ˜¯è®¾ç½®å¤ªå°äº†ï¼ŸbatchSize > bufferSize @agapple æ„Ÿè°¢å›å¤ï¼ æˆ‘è¯•äº†å‘ç°ï¼ŒbatchSizeæ˜¯ä½œç”¨çš„ï¼Œå®é™…èµ·ä½œç”¨çš„getWithoutAck batchSize * memunitã€‚ æ¯”å¦‚ canal.instance.memory.buffer.size=16384 canal.instance.memory.buffer.memunit = 1024 canal.instance.memory.batch.mode = MEMSIZE æ­¤æ—¶å†…å­˜ä¸­çš„ring bufferå¤§å°åº”ä¸º16384 * 1024 B å¦‚æœå®¢æˆ·ç«¯ä»£ç ä¸­getWithoutAckä¼ 2ï¼Œé‚£ä¹ˆæ¯æ¬¡æ‰¹é‡è·å–çš„binlogæ•°æ®é‡æ˜¯ä¸è¶…è¿‡æˆ–ç•¥å¾®è¶…è¿‡2 * 1024 Bï¼Œå—serveré…ç½®ä¸­çš„canal.instance.memory.buffer.memunitå’Œcanal.instance.memory.batch.modeé…ç½®å½±å“ã€‚ æˆ‘ç†è§£çš„å¯¹ä¸å¯¹ï¼Ÿ æ˜¯çš„ï¼Œç†è§£æ­£ç¡®
430,cannalå®¢æˆ·ç«¯é˜»å¡ å®¢æˆ·ç«¯åœ¨è·å–Messageæ—¶é˜»å¡ï¼Œé˜»å¡ä»¥åæ— æ³•è·å–æ•°æ®ï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ä¹Ÿä¸ç®¡ç”¨ï¼Œåœ¨é‡å¯ä»¥åæ‰å¯ä»¥è·å–æ•°æ®ã€‚ Message message = connector.getWithoutAck(batchSize) å¯èƒ½æ˜¯é‡åˆ°å¤§äº‹åŠ¡ï¼Œcanalçš„buffer sizeä¸å¤Ÿ è¿™ä¹ˆè§£å†³çš„ï¼Ÿ ä¼°è®¡è¿˜æ˜¯tcpé“¾æ¥è¢«mysqlä¸»åŠ¨æ–­å¼€ï¼Œcanal serveræœªæ„ŸçŸ¥çš„é—®é¢˜ã€‚å°è¯•å‡çº§ä¸€ä¸‹ç‰ˆæœ¬åˆ°26 è®¾ç½®è¶…æ—¶å°±å¯ä»¥äº†ã€‚
429,èƒ½ä»canalèƒ½ç›´æ¥å¾—åˆ°binlogçš„sqlå—ï¼Ÿ exampleä¸­çš„ä¾‹å­ï¼Œæ‰“å°çš„æ˜¯ç±»ä¼¼ä»¥ä¸‹çš„å½¢ä¼¼ï¼Œcanalèƒ½ç»™å‡ºæ‰§è¡Œinsertï¼Œupdateï¼Œdeleteï¼Œcreate tableç­‰å‘½ä»¤çš„å…·ä½“sqlè¯­å¥å—ï¼Ÿdelete from sharddb. tab_shard where id =5;  BEGIN ----> Thread id: 18 ----------------> binlog[mysql-bin.000005:1200]   name[sharddb tab_shard]   eventType : DELETE   executeTime : 1512015314000   delay : 709ms id : 5    type=int(10) unsigned randomstr : 14504    type=varchar(100) create_time : 2017-11-28 05:00:35    type=timestamp ----------------  END ----> transaction id: 20565 ================> binlog[mysql-bin.000005:1251]   executeTime : 1512015314000   delay : 709ms binlogæ ¼å¼å¯ä»¥ç½‘ä¸Šå…ˆäº†è§£ä¸€ä¸‹
428,cannel service  can't find start position for XX æƒ³é—®ä¸‹è¿™æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´ 2017-11-29 16:17:36.772 [canal-instance-scan-0] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start CannalInstance for 1-crm_underline_prod  2017-11-29 16:17:36.775 [canal-instance-scan-0] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - start successful.... 2017-11-29 16:17:41.864 [destination = crm_underline_prod   address = /10.203.8.48:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position ::1502794800000 2017-11-29 16:17:42.170 [destination = crm_underline_prod   address = /10.203.8.48:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - Didn't find the corresponding binlog files from binlog.000002 to binlog.000020 2017-11-29 16:17:42.171 [destination = crm_underline_prod   address = /10.203.8.48:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /10.203.8.48:3306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: can't find start position for crm_underline_prod 2017-11-29 16:17:42.171 [destination = crm_underline_prod   address = /10.203.8.48:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:crm_underline_prod[com.alibaba.otter.canal.parse.exception.CanalParseException: can't find start position for crm_underline_prod ] ä½ æŒ‡å®šçš„ä½ç‚¹æ—¶é—´æˆ³ï¼Œæ‰¾ä¸åˆ°åˆé€‚çš„binlogï¼Œåˆæ­¥æ€€ç–‘ä½ç‚¹å¤ªä¹…äº† @agepple ä½ç‚¹å¤ªæ—§ æ˜¯instance.propertiesä¸‹çš„timestamp è¿˜æ˜¯zookeeper get /otter/canal/destinations/xxxx/1001/cursorçš„timestamp çœ‹ä½ ä½¿ç”¨file-instance.xmlè¿˜æ˜¯default-instance.xmlï¼Œå‰è€…æ˜¯æ–‡ä»¶åè€…æ˜¯zk @agapple  æˆ‘ä½¿ç”¨çš„æ˜¯ default-instance.xml å¤„ç†è¿™ç§zkä½ç‚¹è¿‡æ—§çš„æƒ…å†µï¼Œæ€ä¹ˆå¤„ç†ï¼Œæ˜¯åªè¦æ›´æ”¹get /otter/canal/destinations/xxxx/1001/cursorçš„timestampå—ï¼Ÿ è¿˜æœ‰ä¸ªé—®é¢˜æƒ³å’¨è¯¢ä¸‹ï¼Œä½ç‚¹æ—¶é—´æˆ³å¿…é¡»åœ¨binlogå¼€å¯ä¹‹åå—ï¼Ÿ ç›®å‰å­˜åœ¨ä¸€ä¸ªé—®é¢˜å°±æ˜¯æ—¶é—´æˆ³æ—¶é—´åœ¨binlogå¼€å¯ä¹‹å‰çš„æ—¶é—´ä¹Ÿä¼šæç¤ºä»¥ä¸Šé—®é¢˜å¼‚å¸¸ æ˜¯çš„ï¼Œç»™å®šçš„æ—¶é—´æˆ³å¿…é¡»æ˜¯ä¸€ä¸ªbinlogæœ‰çš„ä¹‹åæ—¶é—´
427,é¦–é¡µreadme.mdé‡Œé¢çš„ canalçš„å·¥ä½œåŸç† å›¾ç‰‡æ²¡æœ‰æ˜¾ç¤ºå®Œæ•´ ä¼°è®¡ä½ éœ€è¦ç¿»å¢™çœ‹å§ like this ï¼š ![å›¾ç‰‡](http://ww4.sinaimg.cn/large/0060lm7Tly1fm5mvsvfizj31kw0xt459.jpg) @agapple  http://dl.iteye.com/upload/attachment/0080/3107/c87b67ba-394c-3086-9577-9db05be04c95.jpgï¼Œå›¾ç‰‡æºåœ°å€
426,é˜¿é‡Œäº‘RDSæ•°æ®åº“åˆ‡æ¢æ—¶ä¼šæŠ¥é”™ï¼ˆConnection timed outï¼‰ åŒæ­¥æ•°æ®æºæ—¶ï¼Œ å¦‚æœä½¿ç”¨çš„æ˜¯MHAçš„æ•°æ®åº“ï¼Œåœ¨é«˜å¯ç”¨åˆ‡æ¢æ—¶ï¼Œ æ•°æ®åº“ä¸»åº“å‘ç”Ÿäº†å˜åŒ–  è¿™æ—¶ canalåŒæ­¥æ—¥å¿— å‘ç”Ÿäº†æ”¹å˜ï¼Œ ä¼šæŠ¥é”™ . æŠ¥é”™å¦‚ä¸‹ï¼š Caused by: java.io.IOException: connect rm-2zed22tz2539.mysql.rds.aliyuncs.com/100.114.42.154:3306 failure:java.net.ConnectException: Connection timed out         at sun.nio.ch.Net.connect0(Native Method)         at sun.nio.ch.Net.connect(Net.java:454)         at sun.nio.ch.Net.connect(Net.java:446)         at sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:648)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:70)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:56)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:86)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:157)         at java.lang.Thread.run(Thread.java:745)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:74)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:56)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:86)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:157)         at java.lang.Thread.run(Thread.java:745) è¿ä¸ä¸Šæ•°æ®åº“ Connection timed out
425,canal binlog ä¸¢å¤± ç°ç½‘æ•°æ®å˜æ›´è¾ƒå¤§ï¼Œå‘ç°æ•°æ®å­˜åœ¨é—æ¼çš„æƒ…å†µï¼Œå®šä½åœ¨binlogæœªæ¥æ”¶åˆ°äº‹ä»¶ä¿¡æ¯ã€‚ å¯¹æ¯”å‘ç°binlog 29827255 æœªçŸ¥çš„ä¿¡æ¯ä¸¢å¤± dump binlog ![image](https://user-images.githubusercontent.com/8357717/33230017-72c7cf0e-d1a0-11e7-94e6-981ab2367e25.png) canal log ![image](https://user-images.githubusercontent.com/8357717/33230032-0865fa2c-d1a1-11e7-90ae-a62fc76fbbe5.png) ![image](https://user-images.githubusercontent.com/8357717/33230062-a4101d04-d1a1-11e7-83d1-c151ca6b771f.png) æ—¥å¿—ä¸¢å¤±çš„é—®é¢˜çœ‹æºç æ‰¾åˆ°åŸå› äº†ï¼Œä½†æ˜¯binlogæ¥æ”¶å¤„ç¡®å®æœªæ¥æ”¶åˆ°ï¼Œlogæ¯æ¬¡ä¼šå°†æ¥æ”¶åˆ°çš„binlogæ‰“å°å‡ºæ¥ï¼Œ29827255æœªè¢«æ¥æ”¶ï¼Œå¤„ç†ä»£ç å¦‚ä¸‹ ``` void execute() {         long batchId;         LOGGER.debug("execute destination : " + destination);         while (true) {             try {                 connector.connect();                 connector.subscribe(filter);                 while (true) {                     Message message = connector.getWithoutAck(BATCH_SIZE);                     batchId = message.getId();                     int size = message.getEntries().size();                     if (batchId == -1 || size == 0) {                         try {                             Thread.sleep(SLEEP_TIME);                         } catch (InterruptedException ignored) {                             // ignored                         }                     } else {                         process(message.getEntries());                     }                     connector.ack(batchId);                 }             } catch (Exception e) {                 LOGGER.error("canal connect error  destination : " + destination  e);                 AlarmUtil.dcAlarm(App.DC_ID  "canal_connect_error"                         "canal connect error  destination : " + destination);             } finally {                 connector.disconnect();             }             try {                 Thread.sleep(1000 * 60);             } catch (InterruptedException e) {                 // ignored             }         }     }     private void process(List<CanalEntry.Entry> entryList) {         for (CanalEntry.Entry entry : entryList) {             if (entry.getEntryType() == CanalEntry.EntryType.TRANSACTIONBEGIN                     || entry.getEntryType() == CanalEntry.EntryType.TRANSACTIONEND) {                 continue;             }             if (entry.getEntryType() != CanalEntry.EntryType.ROWDATA) {                 continue;             }             CanalEntry.RowChange rowChange;             try {                 rowChange = CanalEntry.RowChange.parseFrom(entry.getStoreValue());             } catch (Exception e) {                 throw new RuntimeException("parse event has an error   data:" + entry.toString()  e);             }             CanalEntry.EventType eventType = rowChange.getEventType();             if (eventType == CanalEntry.EventType.DELETE) {                 return;             }             if (eventType != CanalEntry.EventType.INSERT && eventType != CanalEntry.EventType.UPDATE) {                 return;             }             List<CanalEntry.RowData> rowDataList = rowChange.getRowDatasList();             if (rowDataList == null || rowDataList.size() == 0) {                 continue;             }             List<BinlogColumnDTO> columns = new ArrayList<>();             try {                 for (CanalEntry.RowData rowData : rowDataList) {                     columns = convertColumnList(rowData.getAfterColumnsList());                     long updatedCount = columns.stream().filter(BinlogColumnDTO::getUpdated).count();                     if (updatedCount < 1) {                         return;                     }                     String binlogFileOffset = entry.getHeader().getLogfileName() + ":"                             + entry.getHeader().getLogfileOffset() + ":"                             + DateUtil.timestamp2DateTime(entry.getHeader().getExecuteTime());                     LOGGER.log(ACCESS  binlogFileOffset + "  eventType : {}  data : {}"                             eventType  toJsonString(columns));                     if (eventType == CanalEntry.EventType.INSERT) {                         syncService.insert(columns  binlogFileOffset);                     }                     else if (eventType == CanalEntry.EventType.UPDATE){                         syncService.update(columns  binlogFileOffset);                     }                 }             }             catch (Exception e) {                 LOGGER.error("binlog handle error  data : " + JSONArray.toJSONString(columns)  e);                 AlarmUtil.dcAlarm(App.DC_ID  "binlog_handle_error"  e.toString());             }         }     } ``` è·Ÿè¸ªæºç ï¼Œcanal serveræ‰“å°debugæ—¥å¿—ï¼Œå‘ç°clientå‘è¯·æ±‚è¿‡æ¥çš„æ—¶å€™æ˜¯æœ‰è¯»å–åˆ°å¯¹åº”postionçš„ï¼Œä½†å°±æ˜¯æ²¡æœ‰è¿”å›äº‹ä»¶å†…å®¹è¿‡å»ã€‚ å¦ä¸€ä¸ªæ¡ˆä¾‹çš„æˆªå›¾  binlog file ![image](https://user-images.githubusercontent.com/8357717/33230711-53efdf28-d1ae-11e7-87ac-229d440857f0.png) canal server log ![image](https://user-images.githubusercontent.com/8357717/33230713-6129ee18-d1ae-11e7-899c-58cdc8d1e51c.png) 1.  ä½ è¿™æœ€åçš„æ—¥å¿—æ˜¯åœ¨ä½ç‚¹å®šä½çš„æ—¶å€™å¾—ï¼Œä¸æ˜¯æ•°æ®è¯»å–çš„æ—¥å¿— 2.  canal logé‡Œè®°å½•çš„ä½ç‚¹æ˜¯ä»¥æ‰¹æ¬¡ä¸ºå•ä½ï¼Œå¹¶æ²¡æœ‰ç²¾ç¡®åˆ°ä¸€æ¡è®°å½•.   ç¡®è®¤è¿‡æ»¤æ¡ä»¶æ²¡é—®é¢˜å§ï¼Ÿ åªè¿‡æ»¤äº†ä¸€ä¸ªè¡¨ï¼Œå¦‚æœæ˜¯è¿‡æ»¤æ¡ä»¶çš„é—®é¢˜ï¼Œé‚£åº”è¯¥ä¸€æ¡è®°å½•éƒ½è·å–ä¸åˆ°å•Šï¼Œç›®å‰çš„æƒ…å†µæ—¶éƒ¨åˆ†binlogä¸¢å¤± instance.properties # table regex canal.instance.filter.regex = p2p.t_loan # table black regex canal.instance.filter.black.regex = ä¼ é€’çš„filterï¼šp2p.t_loan æœ‰ç»“è®ºå—ï¼Ÿæˆ‘è¿™è¾¹æœ€æ–°ç‰ˆ26ä¹Ÿå‘ç°æ›´æ–°è®°å½•æœ‰ä¸¢å¤±çš„é—®é¢˜ã€‚ @JasonHuangHuster è¯·é—®è§£å†³äº†ä¹ˆï¼Œæˆ‘1.1.0ä¹Ÿå‡ºç°1000æ¡æ•°æ®ä¸¢ä¸€ä¸¤æ¡çš„é—®é¢˜ å»ºè®®ä½ ä»¬å…ˆç”¨æ ‡å‡†çš„exampleå·¥ç¨‹æ‰“å°æ¥æ”¶åˆ°çš„æ•°æ®ï¼Œå¦‚æœæœ‰èƒ½å¤ç°çš„æ–¹å¼æœ€å¥½èƒ½æä¾›ä¸€ä¸‹ æœ‰è§£å†³å—ï¼Ÿæˆ‘è¿™è¾¹ä¹Ÿé‡åˆ°binlogä¸¢å¤±çš„æƒ…å†µ æˆ‘ç”¨çš„æ˜¯canal-1.0.24ï¼Œæ•°æ®åº“ç”¨çš„æ˜¯MariaDB 10.1.19  @agapple æˆ‘å‘ç°å½“æ•°æ®ä¸¢å¤±çš„æ—¶å€™ï¼Œcanalæ—¥å¿—ä¼šæŠ¥è§£æå¼‚å¸¸ æˆ‘çš„éƒ¨ç½²æƒ…å†µï¼š 1. 2å°canal HAæ¨¡å¼ 2.  2ä¸ªå®ä¾‹ç›‘æ§ä¸¤ä¸ªmysql master 3. ä½¿ç”¨mycatåˆ†ç‰‡ï¼Œæ¯ä¸ªmasterä¸Šæœ‰8ä¸ªç‰‡ 4. mysqlä½¿ç”¨GTID ROW è¿™æ˜¯é”™è¯¯æ—¥å¿—ï¼š 2018-09-12 17:08:12.989 [New I/O server worker #1-7] INFO  c.a.otter.canal.instance.core.AbstractCan alInstance - subscribe filter change to immig([1-8]|1[0-8])\.immig_enc_text 2018-09-12 17:09:37.077 [destination = IMMIG_200   address = /172.16.40.200:3306   EventParser] ERRO R c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - dump address 172.16.40.200/172.16.40.200:3 306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception .CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: java.util.ConcurrentModificationException: null 	at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:909) ~[na:1.8.0_171] 	at java.util.ArrayList$Itr.next(ArrayList.java:859) ~[na:1.8.0_171] 	at com.alibaba.otter.canal.parse.driver.mysql.packets.UUIDSet.toString(UUIDSet.java:125) ~[c anal.parse.driver-1.1.0.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.packets.MysqlGTIDSet.toString(MysqlGTIDSet.jav a:111) ~[canal.parse.driver-1.1.0.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.createHeader(LogEventC onvert.java:849) ~[canal.parse-1.1.0.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEven tConvert.java:561) ~[canal.parse-1.1.0.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor$DmlParserStage.onE vent(MysqlMultiStageCoprocessor.java:302) ~[canal.parse-1.1.0.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor$DmlParserStage.onE vent(MysqlMultiStageCoprocessor.java:288) ~[canal.parse-1.1.0.jar:na] 	at com.lmax.disruptor.WorkProcessor.run(WorkProcessor.java:143) ~[disruptor-3.4.2.jar:na] 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[na:1.8. 0_171] 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[na:1.8. 0_171] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_171] 2018-09-12 17:09:37.078 [destination = IMMIG_200   address = /172.16.40.200:3306   EventParser] ERRO R com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:IMMIG_200[com.alibaba.otter.can al.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException:  parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: java.util.ConcurrentModificationException 	at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:909) 	at java.util.ArrayList$Itr.next(ArrayList.java:859) 	at com.alibaba.otter.canal.parse.driver.mysql.packets.UUIDSet.toString(UUIDSet.java:125) 	at com.alibaba.otter.canal.parse.driver.mysql.packets.MysqlGTIDSet.toString(MysqlGTIDSet.jav a:111) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.createHeader(LogEventC onvert.java:849) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEven tConvert.java:561) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor$DmlParserStage.onE vent(MysqlMultiStageCoprocessor.java:302) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor$DmlParserStage.onE vent(MysqlMultiStageCoprocessor.java:288) 	at com.lmax.disruptor.WorkProcessor.run(WorkProcessor.java:143) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) 	at java.lang.Thread.run(Thread.java:748) ] 2018-09-12 17:09:51.781 [destination = IMMIG_200   address = /172.16.40.200:3306   EventParser] WARN   c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - find start position : EntryPosition[includ ed=false journalName=mysql-bin.000012 position=46893782 serverId=200 gtid=85506e6a-a0f8-11e8-96b3-00 5056b70bff:1-85344 timestamp=1536743377000] 2018-09-12 17:09:53.682 [New I/O server worker #1-9] INFO  c.a.otter.canal.instance.core.AbstractCan alInstance - subscribe filter change to immig([1-8]|1[0-8])\.immig_enc_text è¿™æ˜¯æˆ‘çš„binlogï¼šï¼ˆ4757é‚£æ¡æ˜¯ä¸¢å¤±çš„ï¼‰ ### INSERT INTO `immig2`.`immig_enc_text` ### SET ###   @1='4756' ###   @2='Name-20180912171327-3073F1CC4D611dd0b13565e94969af0b4fe0972d58bf' ###   @3='DETAIL-20180912171327-73F1CC4D611dd0b13565e94969af0b4fe0972d58bf' ###   @4='BIRTHDATE-20180912171327-1CC4D611dd0b13565e94969af0b4fe0972d58bf' ###   @5='1dd0b13565e94969af0b4fe0972d58bf' ###   @6='1' ###   @7='00' ###   @8='1' ###   @9='1' ###   @10='20180912171327' ###   @11='CHN' ###   @12=1536743376 # at 46871947 #180912 17:09:36 server id 200  end_log_pos 46872041 CRC32 0xf43de30e 	Table_map: `immig2`.`immig_enc_text` mapped to number 111 # at 46872041 #180912 17:09:36 server id 200  end_log_pos 46872344 CRC32 0x32dac44c 	Write_rows: table id 111 flags: STMT_END_F ### INSERT INTO `immig2`.`immig_enc_text` ### SET ###   @1='4757' ###   @2='Name-20180912171327-3073F1CC4D615b1e326471284984b522636e96b55fc3' ###   @3='DETAIL-20180912171327-73F1CC4D615b1e326471284984b522636e96b55fc3' ###   @4='BIRTHDATE-20180912171327-1CC4D615b1e326471284984b522636e96b55fc3' ###   @5='5b1e326471284984b522636e96b55fc3' ###   @6='1' ###   @7='00' ###   @8='1' ###   @9='1' ###   @10='20180912171327' ###   @11='CHN' ###   @12=1536743376 # at 46872344 #180912 17:09:36 server id 200  end_log_pos 46872438 CRC32 0x4dd666d7 	Table_map: `immig2`.`immig_enc_text` mapped to number 111 # at 46872438 #180912 17:09:36 server id 200  end_log_pos 46872741 CRC32 0x86092308 	Write_rows: table id 111 flags: STMT_END_F ### INSERT INTO `immig2`.`immig_enc_text` ### SET ###   @1='4758' ###   @2='Name-20180912171327-3073F1CC4D618b85988e6a054822800bf861691f6e13' ###   @3='DETAIL-20180912171327-73F1CC4D618b85988e6a054822800bf861691f6e13' ###   @4='BIRTHDATE-20180912171327-1CC4D618b85988e6a054822800bf861691f6e13' ###   @5='8b85988e6a054822800bf861691f6e13' ###   @6='1' ###   @7='00' ###   @8='1' ###   @9='1' ###   @10='20180912171327' ###   @11='CHN' ###   @12=1536743376 # at 46872741 #180912 17:09:36 server id 200  end_log_pos 46872835 CRC32 0xeb520dc4 	Table_map: `immig2`.`immig_enc_text` mapped to number 111 # at 46872835 #180912 17:09:36 server id 200  end_log_pos 46873138 CRC32 0x31e40985 	Write_rows: table id 111 flags: STMT_END_F @xesygao ConcurrentModificationExceptionçš„é—®é¢˜: https://github.com/alibaba/canal/pull/902 @lcybo ç”±äºä¸²è¡Œçš„æ€§èƒ½å¯¹æˆ‘æ¥è¯´å·²ç»å¤Ÿç”¨äº†ï¼Œæˆ‘æš‚æ—¶å…ˆç”¨ä¸²è¡Œè§£æï¼Œæµ‹è¯•äº†åå‡ æ¬¡æ²¡å‡ºç°ä¸¢æ•°æ®çš„é—®é¢˜äº†ã€‚tks å¯ä»¥å…ˆå°è¯•ç”¨ä¸€ä¸‹1.1.1çš„alphaç‰ˆæœ¬
424,1.0.23é‡Œé¢ä¿®å¤çš„KILL DUMP exceptioné—®é¢˜åœ¨(#334)é‡Œé¢è¢«è¦†ç›–å›å»äº† å¦‚é¢˜ï¼Œ(#334)é‡Œçš„æ”¹åŠ¨è¾ƒå¤šï¼Œå¾ˆå¯èƒ½æ˜¯ä¸€ä¸ªè¯¯æ“ä½œã€‚ tks
423,æ”¯æŒMariadb 10.0.17å— æ”¯æŒMariadb 10.0.17å— ç†è®ºä¸Šæ”¯æŒmariadb 10.xç³»åˆ—ï¼Œå¯ä»¥è·‘ä¸€ä¸‹æµ‹è¯•ç»™ä¸ªåé¦ˆ
422,canal åœ¨é˜¿é‡Œäº‘ RDS-Mysql ç¯å¢ƒä¸­è¿è¡Œ ç”±äºé˜¿é‡Œäº‘çš„mysqlå­˜åœ¨è‡ªåŠ¨æ¸…ç†binlogæœºåˆ¶   å½“è¯¥æœºåˆ¶å¯åŠ¨æ—¶   å½“å‰æœ‰æ­£åœ¨å¤„ç†çš„ä»»åŠ¡ACKä¼šäº§ç”Ÿå¼‚å¸¸(å› ä¸ºlogæ–‡ä»¶å·²ç»ä¸å­˜åœ¨) ;æˆ–è€…å‰©ä½™è¿˜æœªå¤„ç†çš„ä»»åŠ¡ä¹Ÿä¼šè¢«ä¸¢å¼ƒ .  é’ˆå¯¹è¿™ä¸ªåœºæ™¯ æ˜¯å¦æœ‰ä¼˜åŒ–? java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file
421,ä¸€ä¸ªcanalä¸‹destinationså¤šä¸ªinstanceç›‘å¬åŒä¸€ä¸ªåº“çš„é—®é¢˜ ä¸€ä¸ªcanalä¸‹destinationså†™äº†2ä¸ªinstanceï¼Œç›‘å¬çš„åº“ä¸€æ ·ã€‚æˆ‘å‘ç°åº“é‡Œé¢çš„æ•°æ®å˜æ›´åï¼Œæˆ‘çš„clientä¼šæ¥æ”¶åˆ°ä¸¤æ¡ä¸€æ¨¡ä¸€æ ·çš„å˜æ›´ï¼Œè¿™æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿæœ‰äººé‡åˆ°è¿‡å—ï¼Ÿ ä¸€ä¸ªinstanceä¸€ä»½æ•°æ® ä½ è¯´çš„ ä¸€ä»½æ•°æ®ï¼Œæ˜¯æŒ‡ä¸€ä¸ªæ•°æ®åº“å—ï¼Œä¸€ä¸ªinstanceå¯¹åº”ä¸€ä¸ªæ•°æ®åº“ï¼Ÿ @loveluckystar æˆ‘ä¹Ÿæ˜¯å†™äº†ä¸‰ä¸ªinstanceå¯¹åº”ä¸€ä¸ªåº“ï¼Œç„¶åé€šè¿‡filterè¿‡æ»¤å°±ä¸ä¼šæœ‰é‡å¤çš„æ•°æ®ï¼Œä¸è¿‡æ€»æ˜¯ä¼šæœ‰ä¸€ä¸ªinstance çš„client å–ä¸åˆ°å˜æ›´æ•°æ®ã€‚batchIdä¸º-1ï¼Œsizeä¸º0
420,mysql5.7.20 ä½¿ç”¨canal 1.0.24 å¯¹mysql 5.7.20ç›‘æ§æ—¶ å‡ºç°è¡¨åã€åº“åä¸ºç©ºçš„æƒ…å†µï¼Œæœ‰æ²¡æœ‰å®˜æ–¹çš„canalå¯¹mysql 5.7.20ç‰ˆæœ¬ç›‘æ§çš„ canal å’Œmysqlé…ç½® æ³¨æ„ä¸€ä¸‹binlogæ ¼å¼
419,canal1.0.24ï¼Œä»¥å‰å¥½å¥½çš„ï¼Œæœ€è¿‘æ–°åŠ äº†ä¸€ä¸ªå®ä¾‹ä¹‹åï¼Œå°±ä¸€ç›´æŠ¥è¿™ä¸ªé”™ï¼Œclientèƒ½æ¶ˆè´¹åˆ°ï¼ˆä¸çŸ¥é“æ•°æ®æ˜¯å¦ä¸¢å¤±ä¸€éƒ¨åˆ†ï¼‰ 2017-11-21 11:40:16.215 [destination = example31   address = /localhost:30701   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position  {"identity":{"slaveId":-1 "sourceAddress":{"address":"localhost" "port":30701}} "postion":{"included":false "journalName":"mysql-bin.000220" "position":3614315 "serverId":1 "timestamp":1511235396000}} 2017-11-21 11:40:46.230 [destination = example31   address = /localhost:30701   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Unexpected End Stream 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156) ~[canal.parse-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70) ~[canal.parse-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:122) [canal.parse-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) [canal.parse-1.0.24.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_111] 2017-11-21 11:40:46.230 [destination = example31   address = /localhost:30701   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address localhost/localhost:30701 has an error  retrying. caused by java.io.IOException: Unexpected End Stream 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156) ~[canal.parse-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70) ~[canal.parse-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:122) ~[canal.parse-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) ~[canal.parse-1.0.24.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_111] 2017-11-21 11:40:46.230 [destination = example31   address = /localhost:30701   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example31[java.io.IOException: Unexpected End Stream 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:122) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) 	at java.lang.Thread.run(Thread.java:745) ] æ˜¯å¦æ˜¯slaveIdå‡ºç°é‡å¤ï¼Œè¢«mysqlç«¯killäº†é“¾æ¥ï¼Œå¯ä»¥å°è¯•ä¸€ä¸‹æœ€æ–°çš„ç‰ˆæœ¬ï¼Œå¢åŠ äº†éšæœºslaveIdçš„èƒ½åŠ›
418,ç¼–è¯‘æŠ¥é”™ï¼ŒisHeartBeatè¿™ä¸ªå˜é‡æ‰¾ä¸åˆ° [ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.2:compile (default-compile) on project canal.parse: Compilation failure: Compilation failure: [ERROR] /Users/yes/Documents/workspace/idea/canal/parse/src/main/java/com/alibaba/otter/canal/parse/inbound/mysql/dbsync/LogEventConvert.java:[390 24] æ‰¾ä¸åˆ°ç¬¦å· [ERROR] ç¬¦å·:   å˜é‡ isHeartBeat [ERROR] ä½ç½®: ç±» com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert [ERROR] /Users/yes/Documents/workspace/idea/canal/parse/src/main/java/com/alibaba/otter/canal/parse/inbound/mysql/dbsync/LogEventConvert.java:[390 23] éæ³•çš„ç±»å‹å¼€å§‹ [ERROR] -> [Help 1] åŒä¸Š   ``` [INFO] ------------------------------------------------------------- [ERROR] /root/canal/parse/src/main/java/com/alibaba/otter/canal/parse/inbound/mysql/dbsync/LogEventConvert.java:[390 24] cannot find symbol   symbol:   variable isHeartBeat   location: class com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert [ERROR] /root/canal/parse/src/main/java/com/alibaba/otter/canal/parse/inbound/mysql/dbsync/LogEventConvert.java:[390 23] illegal start of type [INFO] 2 errors  ``` ç¯å¢ƒ ``` ~/canal# mvn -version Apache Maven 3.3.9 Maven home: /usr/share/maven Java version: 1.8.0_151  vendor: Oracle Corporation Java home: /usr/lib/jvm/java-8-oracle/jre Default locale: en_US  platform encoding: UTF-8 OS name: "linux"  version: "4.4.0-62-generic"  arch: "amd64"  family: "unix" ~/canal# java -version java version "1.8.0_151" Java(TM) SE Runtime Environment (build 1.8.0_151-b12) Java HotSpot(TM) 64-Bit Server VM (build 25.151-b12  mixed mode) ~/canal# lsb_release -a LSB Version:	core-9.20160110ubuntu0.2-amd64:core-9.20160110ubuntu0.2-noarch:security-9.20160110ubuntu0.2-amd64:security-9.20160110ubuntu0.2-noarch Distributor ID:	Ubuntu Description:	Ubuntu 16.04.2 LTS Release:	16.04 Codename:	xenial ``` æŠŠæœ€æ–°é‚£æ¬¡çš„æäº¤revertæ‰å§ åº”è¯¥æ˜¯æäº¤æ—¶æ¼æ‰äº†ä»£ç  ä¸‹é¢çš„å‘½ä»¤å¯ä»¥è§£å†³ç¼–è¯‘çš„é—®é¢˜. ``` git reset --hard a3b9f6f1ebb21dd528effcceba2ac207f40b15e8 mvn clean install -Dmaven.test.skip -Denv=release ``` a9284b1b3967917ee6cef0e85787575e9b121e1eï¼Œå·²ç»ä¿®å¤
417,canalè§£æåº“Aï¼Œä½†å½“åŒå®ä¾‹ä¸‹å¦ä¸€ä¸ªåº“Båˆ é™¤äº†å¤§é‡æ•°æ®æ—¶ï¼Œå¯¼è‡´canalå¡æ­» ä¸€ä¸ªcanal-serverï¼Œä¸€ä¸ªinstanceï¼Œè§£æåº“Açš„å˜åŒ–ï¼Œä½†æ˜¯åŒå®ä¾‹ä¸‹åº“Båšäº†å¤§é‡åˆ é™¤æ“ä½œï¼Œå¯¼è‡´canalè§£æåº“Aå¡æ­»ï¼ˆå¯èƒ½ä¸æ˜¯å¡æ­»ï¼Œæ—¥å¿—ä¸€ç›´æ˜¾ç¤ºæ­£å¸¸ï¼Œä½†æ˜¯åº“Açš„å˜åŒ–ä¸€ç›´è§£æä¸åˆ°ï¼Œä¸”æ—¥å¿—ä¸­ä½ç‚¹ä¿¡æ¯ä¸å†å‘ç”Ÿå˜åŒ–ï¼‰ mysqlç‰ˆæœ¬ï¼š5.6 canalç‰ˆæœ¬ï¼š1.0.16 psï¼šotteré‡åˆ°è¿‡åŒæ ·çš„é—®é¢˜ï¼Œæ—¥å¿—æ— å¼‚å¸¸ï¼Œä½†æ˜¯è§£æä¸åˆ°æºåº“çš„æ•°æ® æœ‰æ²¡æœ‰äººé‡åˆ°è¿‡è¿™ä¸ªé—®é¢˜ï¼Œè¯¥å¦‚ä½•è§£å†³ï¼Ÿ å»ºè®®å‡çº§ä¸€ä¸‹canalç‰ˆæœ¬
416,cannal  mysql to hive cannalæ˜¯å¦å¯ä»¥ç›´æ¥æŠŠmysqlæ•°æ®åŒæ­¥åˆ°hive éœ€è¦è‡ªå·±æ¥æ”¶åˆ°binlogå˜æ›´æ¶ˆæ¯ä¹‹åï¼Œå†™ä»£ç åŒæ­¥åˆ°hive
415,æ±‚åŠ©ï¼Œå¯åŠ¨canal serveråæŠ¥é”™ 2017-11-13 10:41:41.588 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : flush privileges com.alibaba.druid.sql.parser.ParserException: syntax error  expect TABLES  actual IDENTIFIER  pos 16  line 1  column 6  token IDENTIFIER privileges 	at com.alibaba.druid.sql.parser.SQLParser.acceptIdentifier(SQLParser.java:60) ~[druid-1.1.5.jar:1.1.5] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseFlush(MySqlStatementParser.java:915) ~[druid-1.1.5.jar:1.1.5] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseStatementListDialect(MySqlStatementParser.java:762) ~[druid-1.1.5.jar:1.1.5] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:388) ~[druid-1.1.5.jar:1.1.5] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.5.jar:1.1.5] 	at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:461) ~[druid-1.1.5.jar:1.1.5] 	at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:295) ~[druid-1.1.5.jar:1.1.5] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:67) ~[canal.parse-1.0.25-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.applyHistoryOnMemory(DatabaseTableMeta.java:387) [canal.parse-1.0.25-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:121) [canal.parse-1.0.25-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.25-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.25-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_121] 2017-11-13 10:41:41.590 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta - parse faield : flush privileges com.alibaba.druid.sql.parser.ParserException: syntax error  expect TABLES  actual IDENTIFIER  pos 16  line 1  column 6  token IDENTIFIER privileges 	at com.alibaba.druid.sql.parser.SQLParser.acceptIdentifier(SQLParser.java:60) ~[druid-1.1.5.jar:1.1.5] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseFlush(MySqlStatementParser.java:915) ~[druid-1.1.5.jar:1.1.5] 	at com.alibaba.druid.sql.dialect.mysql.parser.MySqlStatementParser.parseStatementListDialect(MySqlStatementParser.java:762) ~[druid-1.1.5.jar:1.1.5] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:388) ~[druid-1.1.5.jar:1.1.5] 	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:70) ~[druid-1.1.5.jar:1.1.5] 	at com.alibaba.druid.sql.SQLUtils.parseStatements(SQLUtils.java:461) ~[druid-1.1.5.jar:1.1.5] 	at com.alibaba.druid.sql.repository.SchemaRepository.console(SchemaRepository.java:295) ~[druid-1.1.5.jar:1.1.5] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.MemoryTableMeta.apply(MemoryTableMeta.java:67) ~[canal.parse-1.0.25-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.applyHistoryOnMemory(DatabaseTableMeta.java:387) [canal.parse-1.0.25-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.tsdb.DatabaseTableMeta.rollback(DatabaseTableMeta.java:121) [canal.parse-1.0.25-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.AbstractMysqlEventParser.processTableMeta(AbstractMysqlEventParser.java:72) [canal.parse-1.0.25-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:170) [canal.parse-1.0.25-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_121] çœ‹æ ·å­åƒæ˜¯æƒé™çš„é—®é¢˜ã€‚ æˆ‘æ˜¯å…ˆå¯åŠ¨äº†canal serverï¼Œç„¶åæˆ‘é‡æ–°æ‰§è¡Œäº†ä¸€æ¬¡flush privilegesç»™canalç”¨æˆ·èµ‹æƒï¼Œå°±ä¸€ç›´å‡ºç°è¿™ä¸ªæŠ¥é”™ã€‚ æ¥¼å…„ è¿™ä¸ªé¡¹ç›®æ´»è·ƒåº¦è¿˜æ˜¯æŒºé«˜çš„ï¼Œ æˆ‘å‡†å¤‡è¯¦ç»†çœ‹ä¸‹æºç å®ç° ä¸´æ—¶è§£å†³æ–¹æ¡ˆï¼Œcom.alibaba.otter.canal.parse.inbound.mysql.tsdb.apply()ä¸­å°†ddlä¸­çš„alter user ã€flush privilegesçš„è¯­å¥è¿‡æ»¤æ‰å³å¯ã€‚ è¿™å—åªä¼šè®°å½•å¼‚å¸¸æ—¥å¿—ï¼Œæœ¬èº«æ˜¯try catchä¸å½±å“åŠŸèƒ½ druid 1.1.6æš‚æ—¶ä¸æ”¯æŒflush privilegesçš„è§£æï¼Œä¸´æ—¶å…ˆç»•è¿‡ï¼Œå·²ç»åé¦ˆç»™druidçš„ä½œè€…
414,å…³äºheartbeatæœºåˆ¶çš„ä¼˜åŒ– ç°åœ¨canalä¸mySQL æ•°æ®åº“ä¹‹é—´çš„heartbeatæœºåˆ¶  åœ¨æ‰“å¼€detectingæœºåˆ¶çš„æ—¶å€™(å³é€šè¿‡å‘é€sqlè¯­å¥æŸ¥è¯¢çš„æ–¹å¼æ¥æ¢æµ‹è¿œç«¯æ˜¯å¦æ´»ç€) æ˜¯ä¸€ç›´åœ¨ä»¥å›ºå®šçš„é—´éš”å¾ªç¯å‘é€  è€Œæ²¡æœ‰æ ¹æ®ç°åœ¨æ˜¯å¦æœ‰trafficçš„æƒ…å†µæ¥å†³å®šå‘é€  å³å’Œbinlogçš„heartbeatæœºåˆ¶ä¸€æ ·  åªæœ‰åœ¨æ²¡æœ‰trafficä¸€æ®µæ—¶é—´åæ‰å‘é€heartbeatæ¶ˆæ¯ ä¼šä»¥å›ºå®šçš„é¢‘ç‡å‘é€heartbeatæ¶ˆæ¯ 
413,ErrorPacket é”™è¯¯æ˜¯ä»€ä¹ˆæƒ…å†µ INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - KILL DUMP 151432475 failure:java.io.IOException: ErrorPacket [errorNumber=1094  fieldCount=-1  message=Unknown thread id: 151432475  sqlState=HY000  sqlStateMarker=#]  with command: KILL CONNECTION 151432475         at com.alibaba.otter.canal.parse.driver.mysql.MysqlUpdateExecutor.update(MysqlUpdateExecutor.java:49)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.disconnect(MysqlConnector.java:104)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.disconnect(MysqlConnection.java:64)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:241)         at java.lang.Thread.run(Thread.java:748) å‡çº§canalç‰ˆæœ¬å³å¯
412,å‘ç”Ÿä¸»å¤‡æ•°æ®åº“åˆ‡æ¢ä¹‹å  åœ¨disconnect()é‡Œä¼šå‘ç”Ÿexception å‘ç”Ÿä¸»å¤‡æ•°æ®åº“åˆ‡æ¢ä¹‹å  å› ä¸ºåœ°å€å‘ç”Ÿäº†å˜åŒ–  æ‰€ä»¥åœ¨æ‰¾start positionçš„æ—¶å€™ä¼šç”¨timestamp  ä»æ‹¿åˆ°çš„binlogæ–‡ä»¶é‡Œæ ¹æ®timestampæ‰¾å¯¹åº”çš„position  è¿™æ—¶å€™ä¼šæŠŠconnectionçš„dumpingæ ‡è‡´è®¾ä¸ºtrue  åœ¨åé¢reconnect()  disconnect()é‡Œé¢ä¼šå› ä¸ºç°åœ¨æ˜¯dumpingçŠ¶æ€  æ‰€ä»¥åœ¨å…³æ‰channelä¹‹åä¼šæ‰§è¡Œä¸€æ¬¡"KILL CONNECTION"  è€Œè¿™æ—¶å€™ç”¨çš„connection idæ˜¯ä¹‹å‰çš„å·²ç»å…³é—­çš„  æ‰€ä»¥ä¼šæŠ›å¼‚å¸¸. å»ºè®®å…ˆæ‰§è¡Œ"KILL CONNECTION"å†close channel     public void disconnect() throws IOException {         if (connected.compareAndSet(true  false)) {             try {                 if (channel != null) {                     channel.close();                 }                 logger.info("disConnect MysqlConnection to {}..."  address);             } catch (Exception e) {                 throw new IOException("disconnect " + this.address + " failure:" + ExceptionUtils.getStackTrace(e));             }             // æ‰§è¡Œä¸€æ¬¡quit             if (dumping && connectionId >= 0) {                 MysqlConnector connector = null;                 try {                     connector = this.fork();                     connector.connect();                     MysqlUpdateExecutor executor = new MysqlUpdateExecutor(connector);                     executor.update("KILL CONNECTION " + connectionId);                 } catch (Exception e) {                     throw new IOException("KILL DUMP " + connectionId + " failure:" + ExceptionUtils.getStackTrace(e));                 } finally {                     if (connector != null) {                         connector.disconnect();                     }                 }                 dumping = false;             }         } else {             logger.info("the channel {} is not connected"  this.address);         }     } åœ¨æ–°ç‰ˆæœ¬é‡Œå·²ç»ä¿®äº†  è¯·å…³é—­  è°¢è°¢
411,canalå’Œmysqlè¿æ¥ï¼Œå¦‚ä½•è·å–å½“å‰æ“ä½œmysqlç”¨æˆ· binlogé‡Œæ²¡æœ‰è®°å½•
410,canalæ€ä¹ˆç›‘æ§å…¶è¿è¡ŒçŠ¶æ€ æœ‰æ—¶å€™canalæŒ‚äº†ï¼Œå¼€å‘éƒ½ä¸æ¸…æ¥šï¼Œå¼•èµ·ä¸šåŠ¡æ•°æ®é”™è¯¯ï¼Œæˆ‘å°±æƒ³æ€ä¹ˆæŠŠcanalçš„ç›‘æ§ä½“ç³»æ­å»ºèµ·æ¥ï¼Œæœ‰å¥½çš„å»ºè®®ä¹ˆï¼Ÿ ç›‘æ§canalçš„è¿›ç¨‹æˆ–è€…zookeeperçš„ä¸šåŠ¡æ¶ˆè´¹ä½ç‚¹
409,JsonUtilsä¸­InetAddressåºåˆ—åŒ–é—®é¢˜ JsonUtilsä¸­çš„InetAddressSerializerï¼Œåºåˆ—åŒ–InetAddresså¯¹è±¡æ˜¯ ``` java InetAddress address = (InetAddress)object; serializer.write(address.getHostName()) ``` æ˜¯è·å–getHostNameæ¥è·å–çš„ï¼Œå¦‚æœhostsä¸­é…ç½®äº†ä¸»æœºåï¼Œé‚£ä¹ˆè¿™ä¸ªå€¼è§£æåˆ°çš„ä¸»æœºå å»ºè®®ä¿®æ”¹ä¸º `address.getHostAddress()`ç›´æ¥è·å–IP PS:JsonUtilsä¸­ ``` java  static {         SerializeConfig.getGlobalInstance().put(InetAddress.class  JsonUtils.InetAddressSerializer.instance);         SerializeConfig.getGlobalInstance().put(Inet4Address.class  JsonUtils.InetAddressSerializer.instance);         SerializeConfig.getGlobalInstance().put(Inet6Address.class  JsonUtils.InetAddressSerializer.instance);     } ``` è¿™ç§æ–¹å¼æ˜¯å¦å¤ªé»‘é­”æ³•ï¼Œè¿™æ ·çš„è¯æ•´ä¸ªfastJsonæ¡†æ¶ï¼Œåœ¨è§£æInetAddresså¯¹è±¡çš„æ—¶å€™ï¼Œå…¨éƒ¨æ˜¯æŒ‰ç…§è¿™ç§æ–¹å¼åºåˆ—åŒ–çš„ï¼Œè€Œå½±å“åµŒå…¥canalçš„åº”ç”¨ç¨‹åºï¼Ÿ å¸Œæœ›ä¿ç•™hostnameï¼Œè€Œä¸æ˜¯ipï¼Œç‰¹åˆ«é’ˆå¯¹æ˜¯åŸŸå+vipæ¨¡å¼çš„æ—¶å€™ï¼ŒåŸŸåä¼šä¿æŒä¸å˜
408,canalç›‘æ§mysqlä¸»å¤‡æœåŠ¡ canalç›‘æ§mysqlä¸»å¤‡æœåŠ¡è¦æ€ä¹ˆé…ç½®ï¼Œå¦‚æœåªé…ç½®ä¸»æ•°æ®åº“åœ°å€ï¼Œåœ¨ä¸»æ•°æ®åº“æœåŠ¡å™¨æŒ‚æ‰çš„æƒ…å†µä¸‹å¯ä»¥ç»§ç»­é‡‡é›†binlogå— éœ€è¦é…ç½®ä¸»å¤‡åº“çš„ä¿¡æ¯
407,åœ¨managerç®¡ç†ç•Œé¢çœ‹ä¸åˆ°Zookeeperä¸‹é¢æŒ‚çš„nodeèŠ‚ç‚¹ï¼Œä½†æ˜¯è¿è¡Œæ­£å¸¸ å¦‚é¢˜ï¼Œè¿™ä¸ªé—®é¢˜æ€ä¹ˆè§£å†³ï¼Œæˆ‘çœ‹æ•™ç¨‹æˆªå›¾ä¸Šæ˜¯å¯ä»¥çœ‹åˆ°Zookeeperä¸‹é¢æŒ‚çš„èŠ‚ç‚¹ä¸ªæ•°çš„ æé—®åˆ°otterå§
406,binlog-format åœ¨ MIXED ä¸‹å¦‚ä½•è·å– tableName å¦‚é¢˜ï¼Œå› ä¸ºå…¬å¸å·²ç»è¿è¥å¾ˆé•¿æ—¶é—´äº†ï¼Œä¿®æ”¹çš„è¯ä¸çŸ¥é“ä¼šå‡ºå¤šå°‘é—®é¢˜ï¼ˆæœåŠ¡é‡å¯ï¼Œä»æ•°æ®åº“æ›´æ–°ï¼‰ã€‚ MIXED ä¸‹çš„ä¿¡æ¯å®åœ¨æ˜¯å¤ªå°‘äº†ï¼Œæˆ‘åªèƒ½æ‹¿åˆ°åŸå£°çš„SQLè¯­å¥ï¼Œæ˜¯ä¸æ˜¯æ„å‘³ç€åªæœ‰å¯¹åŸå£°çš„SQLè¯­å¥ä½œè¯­æ³•åˆ†ææ‹¿å‡º tableNameï¼Ÿ å¯ä»¥çš„ï¼Œéœ€è¦ä¾èµ–ä¸€ä¸ªsql parserå³å¯ æœ€æ–°çš„26ç‰ˆæœ¬ï¼Œå·²ç»é€šè¿‡å®Œæ•´SQLè§£æå¯¹åº”çš„è¡¨ï¼Œå¯ä»¥å®Œæ•´è·å– thanks  æ„Ÿè°¢å›ç­”
405,ClusterCanalClient  é’ˆå¯¹ä¸€ä¸ªcanal server é›†ç¾¤  éƒ¨ç½²å¤šä¸ªcanal client  client ç›‘å¬æ•°æ®ä¼šä¸¤å°ä¸Šç›‘å¬åˆ°ä¸€æ ·çš„æ›´æ–°æ•°æ®å˜›ï¼Œæ€ä¹ˆåšåˆ°é›†ç¾¤æ¶ˆè´¹å‘¢ é›†ç¾¤æ¶ˆè´¹å»ºè®®æŠ•é€’åˆ°MQç³»ç»Ÿä¸­è¿›è¡Œå¤„ç†
404,canal HA zookeeperä¸æ›´æ–°positionè¯·å¤§ç¥æŒ‡æ•™ å¦‚é¢˜ï¼Œè¯•äº†å¾ˆå¤šæ–¹å¼ï¼Œè™½ç„¶ä¸æ›´æ–°zookeeperä½†æ˜¯æˆ‘ä¸åˆ‡æ¢HAçš„æ—¶å€™ï¼Œé‡å¯clientç«¯èƒ½å¤ŸæŒ‰ç…§é¡ºåºæ‰§è¡Œï¼Œä½†æ˜¯å½“æˆ‘åœæ‰ä¸€ä¸ªåˆ‡æ¢serverçš„æ—¶å€™ï¼Œclientåˆè‡ªåŠ¨ä»ä¹‹å‰çš„positionè¿è¡Œã€‚ä¸æ˜ç™½æ˜¯æ€ä¹ˆå›äº‹ï¼Œæ±‚å¤§ç¥æŒ‡æ•™ã€‚ ä¸ä¼šï¼Œçœ‹ä¸‹zkä¸Šçš„offsetå˜åŒ–ã€‚ ä¸å˜åŒ–é…ç½®å°±ä¸å¯¹ server éƒ½é‡å¯ä¸‹ï¼Œæˆ‘åˆšå¼€å§‹ä¹Ÿæœ‰è¿™ä¸ªé—®é¢˜ï¼Œåæ¥æ²¡æœ‰äº†
403,é¢„è®¡ä»€ä¹ˆæ—¶å€™å‘å¸ƒä¸‹ä¸ªç‰ˆæœ¬å‘¢ï¼Ÿ 
402,otter nodeè¿›ç¨‹fullgcï¼Œå¯¼è‡´åŒæ­¥ç‚¹ä½ä¸æ›´æ–°ï¼Œä¸€ç›´æ­»å¾ªç¯     æˆ‘ä»¬ç°åœ¨ä½¿ç”¨otterï¼Œé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æŠŠotter éƒ¨ç½²åˆ°é˜¿é‡Œäº‘ECSæœºå™¨ä¸Šï¼ŒåŒæ­¥RDSï¼Œå‘ç°ä¸€ä¸ªå¥‡æ€ªçš„é—®é¢˜ï¼Œå½“è¡¨ï¼ˆæœ‰å‡ ç™¾ä¸‡æ•°æ®ï¼‰æ·»åŠ ä¸€ä¸ªå­—æ®µåï¼Œå¹¶æ›´æ–°è¿™ä¸ªå­—æ®µçš„é»˜è®¤å€¼ï¼ˆ1æ¡updateè¯­å¥ï¼Œæ›´æ–°å‡ ç™¾ä¸‡æ•°æ®ï¼‰ï¼Œå‘ç°otterä¸€ç›´åœ¨æ­»å¾ªç¯çš„æ›´æ–°è¿™å‡ ç™¾ä¸‡æ•°æ®ï¼ŒæŸ¥çœ‹select ï¼Œloadè¯¦ç»†æ—¥å¿—ä¹Ÿçœ‹åˆ°ä¸€ç›´æ›´æ–°ï¼Œå¹¶ä¸”æ˜¯æ­»å¾ªç¯ï¼Œç•Œé¢åŒæ­¥è¿›åº¦çš„ç‚¹ä½ä¸€ç›´å›ºå®šåœ¨ä¸€ä¸ªç‚¹ï¼Œä¸å‰è¿›ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å‡ºç°äº†å¾ˆå¤šæ¬¡fullgcï¼Œä¸çŸ¥é“æ˜¯å¦æœ‰å½±å“ã€‚ çœ‹ä¸€ä¸‹FAQ
401,è·å–ä¸åˆ°ROWDATAè®°å½• @agapple  canal server: 1.0.24 ä½¿ç”¨çš„æ˜¯é˜¿é‡Œäº‘RDSï¼Œéƒ¨ç½²ç»“æ„ï¼š ``` master --> slave --> canal server --> æ¶ˆè´¹ç¨‹åº ``` ``` MySQL [zz]> show variables like '%binlog_format%'; +---------------+-------+ | Variable_name | Value | +---------------+-------+ | binlog_format | ROW   | +---------------+-------+ 1 row in set (0.00 sec) ``` æ¶ˆè´¹ç¨‹åºæ—¥å¿—åŸºæœ¬éƒ½æ˜¯è¿™æ ·çš„ï¼š ``` [2017-10-18 11:51:18 398] (CanalMessageHandlerONSImpl.java:35) DEBUG  - handleMessage batchId[46] entrys[2] [2017-10-18 11:51:18 398] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[TRANSACTIONBEGIN] schema[] tablename[] [2017-10-18 11:51:18 399] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[TRANSACTIONEND] schema[] tablename[] ``` æ¶ˆè´¹ç¨‹åº: ``` connector.connect(); connector.subscribe(null); ``` instance.properties ``` ## mysql serverId canal.instance.mysql.slaveId = 42341 # position info canal.instance.master.address = xxxxx canal.instance.master.journal.name =  canal.instance.master.position =  canal.instance.master.timestamp =  #canal.instance.standby.address =  #canal.instance.standby.journal.name = #canal.instance.standby.position =  #canal.instance.standby.timestamp =  # username/password canal.instance.dbUsername = xx canal.instance.dbPassword = xx canal.instance.defaultDatabaseName = zz canal.instance.connectionCharset = UTF-8 # table regex canal.instance.filter.regex = .*\\..* #canal.instance.filter.regex = .*order_info.* # table black regex canal.instance.filter.black.regex =   ``` canal.properties ``` ################################################# ######### 		common argument		#############  ################################################# canal.id= 101 canal.ip= canal.port= 11111 canal.zkServers= 127.0.0.1:2181 # flush data to zk canal.zookeeper.flush.period = 1000 # flush meta cursor/parse position to file canal.file.data.dir = ${canal.conf.dir} canal.file.flush.period = 1000 ## memory store RingBuffer size  should be Math.pow(2 n) canal.instance.memory.buffer.size = 16384 ## memory store RingBuffer used memory unit size   default 1kb canal.instance.memory.buffer.memunit = 1024  ## meory store gets mode used MEMSIZE or ITEMSIZE canal.instance.memory.batch.mode = MEMSIZE ## detecing config canal.instance.detecting.enable = false #canal.instance.detecting.sql = insert into retl.xdual values(1 now()) on duplicate key update x=now() canal.instance.detecting.sql = select 1 canal.instance.detecting.interval.time = 3 canal.instance.detecting.retry.threshold = 3 canal.instance.detecting.heartbeatHaEnable = false # support maximum transaction size  more than the size of the transaction will be cut into multiple transactions delivery canal.instance.transaction.size =  1024 # mysql fallback connected to new master should fallback times canal.instance.fallbackIntervalInSeconds = 60 # network config canal.instance.network.receiveBufferSize = 16384 canal.instance.network.sendBufferSize = 16384 canal.instance.network.soTimeout = 30 # binlog filter config canal.instance.filter.query.dcl = false canal.instance.filter.query.dml = false canal.instance.filter.query.ddl = false canal.instance.filter.table.error = false canal.instance.filter.rows = false # binlog format/image check canal.instance.binlog.format = ROW STATEMENT MIXED  canal.instance.binlog.image = FULL MINIMAL NOBLOB # binlog ddl isolation canal.instance.get.ddl.isolation = false ################################################# ######### 		destinations		#############  ################################################# canal.destinations= zz # conf root dir canal.conf.dir = ../conf # auto scan instance dir add/remove and start/stop instance canal.auto.scan = true canal.auto.scan.interval = 5 canal.instance.global.mode = spring  canal.instance.global.lazy = false #canal.instance.global.manager.address = 127.0.0.1:1099 #canal.instance.global.spring.xml = classpath:spring/memory-instance.xml #canal.instance.global.spring.xml = classpath:spring/file-instance.xml canal.instance.global.spring.xml = classpath:spring/default-instance.xml ``` å…³æ³¨æ˜¯å¦æœ‰æ‰“å¼€log slaveå‚æ•° @agapple  æ˜¯å¦æ˜¯å‚æ•°ï¼š`log_slave_updates` ``` MySQL [zaozuo]> show variables like '%slave%'; +---------------------------------------+-----------------------+ | Variable_name                         | Value                 | +---------------------------------------+-----------------------+ | init_slave                            |                       | | log_slave_updates                     | ON                    | | log_slow_slave_statements             | OFF                   | | pseudo_slave_mode                     | OFF                   | | rpl_semi_sync_master_wait_no_slave    | ON                    | | rpl_semi_sync_slave_delay_master      | OFF                   | | rpl_semi_sync_slave_enabled           | ON                    | | rpl_semi_sync_slave_kill_conn_timeout | 5                     | | rpl_semi_sync_slave_trace_level       | 1                     | | rpl_stop_slave_timeout                | 31536000              | | slave_allow_batching                  | OFF                   | | slave_checkpoint_group                | 512                   | | slave_checkpoint_period               | 300                   | | slave_compressed_protocol             | OFF                   | | slave_exec_mode                       | STRICT                | | slave_load_tmpdir                     |                       | | slave_max_allowed_packet              | 1073741824            | | slave_net_timeout                     | 60                    | | slave_parallel_workers                | 16                    | | slave_pending_jobs_size_max           | 167772160             | | slave_pr_mode                         | TABLE                 | | slave_rows_search_algorithms          | TABLE_SCAN INDEX_SCAN | | slave_skip_errors                     | OFF                   | | slave_sql_verify_checksum             | ON                    | | slave_transaction_retries             | 10                    | | slave_type_conversions                |                       | | sql_slave_skip_counter                | 0                     | +---------------------------------------+-----------------------+ 27 rows in set (0.00 sec) ``` ``` MySQL [zaozuo]> show variables like '%log%'; +-----------------------------------------+----------------------+ | Variable_name                           | Value                | +-----------------------------------------+----------------------+ | back_log                                | 3000                 | | binlog_cache_size                       | 131072               | | binlog_checksum                         | CRC32                | | binlog_direct_non_transactional_updates | OFF                  | | binlog_format                           | ROW                  | | binlog_order_commits                    | OFF                  | | binlog_row_image                        | FULL                 | | binlog_rows_query_log_events            | OFF                  | | binlog_stmt_cache_size                  | 32768                | | expire_logs_days                        | 0                    | | failover_log_verbose                    |                      | | general_log                             | OFF                  | | general_log_file                        |                      | | innodb_api_enable_binlog                | OFF                  | | innodb_flush_log_at_timeout             | 1                    | | innodb_flush_log_at_trx_commit          | 2                    | | innodb_locks_unsafe_for_binlog          | OFF                  | | innodb_log_buffer_size                  | 8388608              | | innodb_log_compressed_pages             | OFF                  | | innodb_log_file_size                    | 1048576000           | | innodb_log_files_in_group               | 2                    | | innodb_log_group_home_dir               |                      | | innodb_mirrored_log_groups              | 1                    | | innodb_online_alter_log_max_size        | 134217728            | | innodb_undo_logs                        | 128                  | | log_bin                                 | ON                   | | log_bin_basename                        |                      | | log_bin_index                           |                      | | log_bin_trust_function_creators         | ON                   | | log_bin_use_v1_row_events               | ON                   | | log_error                               |                      | | log_output                              | TABLE                | | log_queries_not_using_indexes           | OFF                  | | log_slave_updates                       | ON                   | | log_slow_admin_statements               | ON                   | | log_slow_slave_statements               | OFF                  | | log_throttle_queries_not_using_indexes  | 0                    | | log_warnings                            | 2                    | | max_binlog_cache_size                   | 18446744073709547520 | | max_binlog_size                         | 524288000            | | max_binlog_stmt_cache_size              | 18446744073709547520 | | max_relay_log_size                      | 0                    | | relay_log                               |                      | | relay_log_basename                      |                      | | relay_log_index                         |                      | | relay_log_info_file                     |                      | | relay_log_info_repository               | TABLE                | | relay_log_purge                         | ON                   | | relay_log_recovery                      | OFF                  | | relay_log_space_limit                   | 0                    | | slow_query_log                          | ON                   | | slow_query_log_file                     |                      | | sql_log_bin                             | ON                   | | sql_log_off                             | OFF                  | | sync_binlog                             | 1000                 | | sync_relay_log                          | 10000                | | sync_relay_log_info                     | 10000                | | tokudb_checkpoint_on_flush_logs         | OFF                  | | tokudb_fsync_log_period                 | 0                    | | tokudb_log_buffer_size                  | 16777216             | | tokudb_log_dir                          |                      | | tokudb_log_file_size                    | 104857600            | +-----------------------------------------+----------------------+ 62 rows in set (0.00 sec) ``` @agapple  æ¯”è¾ƒè¯¡å¼‚çš„æ˜¯mysqlçš„æ…¢æ—¥å¿—è¯­å¥å±…ç„¶èƒ½è¿›æ¥ ``` [2017-10-19 01:47:52 343] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 02:05:15 708] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 02:19:55 133] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 02:37:49 861] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 02:48:20 351] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 03:07:13 337] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 03:17:14 421] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 03:35:21 371] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 03:45:55 885] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 04:04:42 615] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 04:23:22 967] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 05:07:06 185] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 05:17:21 915] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 05:36:32 541] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 05:46:33 606] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 06:04:54 056] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 06:17:09 120] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 06:37:21 586] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 06:45:09 582] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 06:49:18 785] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 07:04:10 957] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 07:13:34 243] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 07:35:16 863] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 07:43:58 415] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 08:05:37 009] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 08:23:29 424] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 09:06:56 832] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 09:18:18 433] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 09:36:09 787] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 09:48:05 170] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 10:07:39 216] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 10:19:40 631] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] [2017-10-19 10:37:33 833] (CanalMessageHandlerONSImpl.java:42) DEBUG  - entryType[ROWDATA] schema[mysql] tablename[slow_log] ``` ç›´æ¥è¿ä¸»åº“ï¼Œé—®é¢˜è§£å†³äº†ã€‚ æé˜¿é‡Œäº‘å·¥å•ï¼Œä»–ä»¬è¯´å®˜æ–¹ä¸æ”¯æŒè‡ªä¸»æ­å»ºå¤åˆ¶ç³»ç»Ÿå»åŒæ­¥RDSï¼Œæ¨èå»ç”¨DTSã€‚ã€‚ã€‚ æ¨æµ‹å¯èƒ½æ˜¯é˜¿é‡Œäº‘å¤‡åº“åšäº†ä»€ä¹ˆé™åˆ¶ å—¯ï¼Œç›´è¿ä¸»åº“è¿›è¡Œé“¾æ¥å§ï¼ŒDTSåŸç†ä¹Ÿæ˜¯è¿ä¸»åº“ï¼ŒåŸç†éƒ½ä¸€æ · x > å—¯ï¼Œç›´è¿ä¸»åº“è¿›è¡Œé“¾æ¥å§ï¼ŒDTSåŸç†ä¹Ÿæ˜¯è¿ä¸»åº“ï¼ŒåŸç†éƒ½ä¸€æ · ç°åœ¨æˆ‘é‡åˆ°çš„é—®é¢˜ï¼Œcanal [v.1.1.0] è¿æ¥é˜¿é‡Œçš„rds   logs/**-instance/meta.log ä¸€ç›´åœ¨æœ‰æ–°æ—¥å¿—ï¼Œä½†æ˜¯åº“æˆ·ç«¯ä¸€ç›´æ¥æ”¶ä¸åˆ°æ•°æ®ï¼Œæ¥æ”¶çš„æ•°æ®éƒ½æ˜¯è¿™ä¸ªæ ·å­æ»´ï¼š ` Message[id=444 entries=[header {   version: 1   logfileName: "*****"   logfileOffset: *****   serverId: *****   serverenCode: "UTF-8"   executeTime: 1539572438000   sourceType: MYSQL   schemaName: ""   tableName: ""   eventLength: 76 } entryType: TRANSACTIONBEGIN storeValue: " \242\206\356\001"  header {   version: 1   logfileName: "*****"   logfileOffset: *****   serverId: *****   serverenCode: "UTF-8"   executeTime: 1539572438000   sourceType: MYSQL   schemaName: ""   tableName: ""   eventLength: 31 } entryType: TRANSACTIONEND storeValue: "\022\n7768450739" ]] ` æ•°æ®çš„ç±»å‹ä¸ºå•¥éƒ½æ˜¯ï¼šentryType.TRANSACTIONå‘¢ å¤§å®¶ä¸æ˜¯ç”¨çš„RDSåªè¯»å®ä¾‹å§ï¼ŸRDSåªè¯»å®ä¾‹æ˜¯æ²¡å¼€log_update_slaveï¼Œä¸ä¼šæœ‰ä¸»åº“çš„binlogï¼Œæ‰€ä»¥æ²¡æ³•å¼€çº§è”åŒæ­¥ï¼Œç›´æ¥æ“ä½œRDSä¸»å®ä¾‹å³å¯
400,canalå¯ä»¥æ”¯æŒgrpcå—ï¼Ÿ canalå¯ä»¥æ”¯æŒgrpcå—ï¼Ÿè¿™æ ·å°±å¯ä»¥ç”¨ä»»ä½•è¯­è¨€å†™å®¢æˆ·ç«¯å’Œcanaläº¤äº’äº† å¯ä»¥æäº¤ä¸€ä¸ªPRç»™æˆ‘
399,æ±‚åŠ©ï¼Œï¼Œ 2017-10-16 10:44:47.424 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just show master status 2017-10-16 10:44:47.427 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /127.0.0.1:3306 has an error  retrying. caused by  java.lang.NullPointerException: null 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.loadBinlogChecksum(MysqlConnection.java:284) ~[canal.parse-1.0.23.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) ~[canal.parse-1.0.23.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) ~[canal.parse-1.0.23.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_111] 2017-10-16 10:44:47.427 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.lang.NullPointerException 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.loadBinlogChecksum(MysqlConnection.java:284) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) 	at java.lang.Thread.run(Thread.java:745) ] è¿™ä¸ªé”™è¯¯æ˜¯ä»€ä¹ˆåŸå› é€ æˆçš„ï¼Œï¼Œï¼Œ å‡çº§åˆ°1.0.24ç‰ˆæœ¬ï¼Œå·²ä¿®å¤
398,LOST_EVENTS æ”¯æŒ æˆ‘ç”¨çš„Canalç‰ˆæœ¬æ˜¯ 1.0.22ã€‚ æˆ‘ä»¬åœ¨åˆ†æMySQL replicationæ—¶å¯èƒ½å‡ºç°çš„LOST_EVENTSã€‚æˆ‘æŸ¥çœ‹äº†ä¸€ä¸‹æºç ï¼Œæ„Ÿè§‰Canalä¸æ”¯æŒLOST_EVENTSçš„å¤„ç†ï¼Œè€Œæ˜¯åœ¨è¯»å–åˆ°è¿™ä¸ªeventåï¼Œåœ¨å°†å…¶è½¬æ¢æˆEntryæ—¶ç»™ä¸¢æ‰äº†ã€‚è¯·é—®Canalæ˜¯ç‰¹æ„è®¾è®¡æˆè¿™æ ·çš„è¡Œä¸ºçš„å—ï¼Œæˆ–æ˜¯æˆ‘ä»¬ç†è§£æœ‰è¯¯ï¼Ÿ æˆ‘ä»¬åˆ†æçš„å¦‚ä¸‹ä»£ç ï¼š åœ¨LogDecoder.javaä¸­ï¼Œ INCIDENT_EVENT æ˜¯ä¼šè¢«è¯»å–åˆ°çš„ã€‚ case LogEvent.INCIDENT_EVENT: {                 IncidentLogEvent event = new IncidentLogEvent(header  buffer  descriptionEvent);                 /* updating position in context */                 logPosition.position = header.getLogPos();                 return event;             } ä½†æ˜¯åœ¨ LogEventConvert.java ä¸­çš„ parse æ–¹æ³•ï¼Œå¹¶æ²¡æœ‰å¤„ç†è¿™ä¸ªINCIDENT_EVENTã€‚ public Entry parse(LogEvent logEvent) throws CanalParseException {         if (logEvent == null || logEvent instanceof UnknownLogEvent) {                 return null;         }                  int eventType = logEvent.getHeader().getType();         switch (eventType) {             ...... ( è¿™é‡Œæ²¡æœ‰ case LogEvent.INCIDENT_EVENT)         } } æ˜¯ä¸æ˜¯ Canal è®¤ä¸ºï¼Œå³ä½¿è¯»å–åˆ°è¿™ä¸ªäº‹ä»¶ï¼Œconsumeræ‹¿åˆ°ä¹Ÿæ— èƒ½ä¸ºåŠ›ï¼Œæ‰€ä»¥å°±ä¸»åŠ¨ä¸¢å¼ƒäº†ï¼Ÿ å¦‚æœèƒ½ä¸»åŠ¨æŠ¥ä¸€ä¸ªå‘Šè­¦ä¼šä¸ä¼šæœ‰å¸®åŠ©ï¼Ÿ è°¢è°¢ï¼ Best Regards Stone å½“æ—¶åˆ»æ„æ²¡åŠ ï¼Œcanalçš„è®¾è®¡æ˜¯å°½å¯èƒ½æŠ½å–DML/DDL/DCLçš„éƒ¨åˆ†å†…å®¹ï¼Œå¹¶æ²¡æœ‰å…¨å¤„ç†æ‰€æœ‰mysqläº‹ä»¶  @agapple è°¢è°¢ä½ çš„å³æ—¶å›å¤ï¼ ç›®å‰æœ‰è€ƒè™‘æ‰©å±•Canalï¼Œä»¥æ¶µç›–è¿™ç±»ï¼ˆæˆ–è€…å°½é‡å¤šçš„ï¼‰äº‹ä»¶å—ï¼Ÿ Best Regards Stone æ¥å£åè®®è®¾è®¡é‡Œä¸æ”¯æŒï¼Œæ‰€ä»¥æš‚æ—¶ä¸ä¼šè€ƒè™‘ è°¢è°¢ä½ ï¼ æˆ‘å…ˆcloseè¿™ä¸ªé—®é¢˜äº†ã€‚å¦‚æœæœ‰æ–°çš„é—®é¢˜ï¼Œæˆ‘å†å¼€ä¸€ä¸ªæ–°çš„ticketã€‚ è°¢è°¢ï¼ Best Regards Stone
397,RowChangeä¸­isDdlå­—æ®µå€¼çš„é—®é¢˜ ä½¿ç”¨å®˜æ–¹æä¾›çš„clent exampleï¼ŒRowChange.parseFrom(entry.getStoreValue()); updateã€insertã€deleteè¯­å¥è½¬æ¢ç»“æœ isDdlçš„å€¼ä¸ºtrueï¼Œä¸”rowChage.getRowDatasList()çš„listé•¿åº¦ä¸º0.å½“å‰ä½¿ç”¨canalç‰ˆæœ¬æ˜¯1.0.24 mysqlç‰ˆæœ¬æ˜¯5.6.26-logã€‚è¯·é—®æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„è§£æé—®é¢˜ã€‚ ç¡®è®¤ä½¿ç”¨ä¸ºROWæ¨¡å¼ï¼Œè¿˜æœ‰ä¸€ç‚¹mysql 5.6ä¼šæœ‰rows queryå¯¹è±¡ï¼Œå¯ä»¥canal.instance.filter.query.dmlæ”¹ä¸ºtrue
396,group-instance.xml å¦‚ä½•é…ç½® æƒ³ä½¿ç”¨groupæ¨¡å¼å¤„ç†å¤šåº“åˆå¹¶çš„é—®é¢˜ï¼Œä½†æ˜¯wikiæ‰¾ä¸åˆ°é…ç½®çš„æ–¹æ³•ï¼Ÿ canal.properties  åªæ›´æ”¹äº† canal.destinations= food mdm ``` ################################################# ######### 		common argument		#############  ################################################# canal.id= 1 canal.ip= canal.port= 11111 canal.zkServers= # flush data to zk canal.zookeeper.flush.period = 1000 # flush meta cursor/parse position to file canal.file.data.dir = ${canal.conf.dir} canal.file.flush.period = 1000 ## memory store RingBuffer size  should be Math.pow(2 n) canal.instance.memory.buffer.size = 16384 ## memory store RingBuffer used memory unit size   default 1kb canal.instance.memory.buffer.memunit = 1024  ## meory store gets mode used MEMSIZE or ITEMSIZE canal.instance.memory.batch.mode = MEMSIZE ## detecing config canal.instance.detecting.enable = false #canal.instance.detecting.sql = insert into retl.xdual values(1 now()) on duplicate key update x=now() canal.instance.detecting.sql = select 1 canal.instance.detecting.interval.time = 3 canal.instance.detecting.retry.threshold = 3 canal.instance.detecting.heartbeatHaEnable = false # support maximum transaction size  more than the size of the transaction will be cut into multiple transactions delivery canal.instance.transaction.size =  1024 # mysql fallback connected to new master should fallback times canal.instance.fallbackIntervalInSeconds = 60 # network config canal.instance.network.receiveBufferSize = 16384 canal.instance.network.sendBufferSize = 16384 canal.instance.network.soTimeout = 30 # binlog filter config canal.instance.filter.query.dcl = false canal.instance.filter.query.dml = false canal.instance.filter.query.ddl = false canal.instance.filter.table.error = false canal.instance.filter.rows = false # binlog format/image check canal.instance.binlog.format = ROW STATEMENT MIXED  canal.instance.binlog.image = FULL MINIMAL NOBLOB # binlog ddl isolation canal.instance.get.ddl.isolation = false ################################################# ######### 		destinations		#############  ################################################# canal.destinations= food mdm # conf root dir canal.conf.dir = ../conf # auto scan instance dir add/remove and start/stop instance canal.auto.scan = true canal.auto.scan.interval = 5 canal.instance.global.mode = spring  canal.instance.global.lazy = false #canal.instance.global.manager.address = 127.0.0.1:1099 #canal.instance.global.spring.xml = classpath:spring/memory-instance.xml canal.instance.global.spring.xml = classpath:spring/file-instance.xml #canal.instance.global.spring.xml = classpath:spring/default-instance.xml ``` group-instance.xml ä½¿ç”¨é»˜è®¤çš„å†…å®¹ï¼Œæœªåšä¿®æ”¹ ``` <?xml version="1.0" encoding="UTF-8"?> <beans xmlns="http://www.springframework.org/schema/beans" 	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tx="http://www.springframework.org/schema/tx" 	xmlns:aop="http://www.springframework.org/schema/aop" xmlns:lang="http://www.springframework.org/schema/lang" 	xmlns:context="http://www.springframework.org/schema/context" 	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd            http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.0.xsd            http://www.springframework.org/schema/lang http://www.springframework.org/schema/lang/spring-lang-2.0.xsd            http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.0.xsd            http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd" 	default-autowire="byName"> 	 	<!-- properties --> 	<bean class="com.alibaba.otter.canal.instance.spring.support.PropertyPlaceholderConfigurer" lazy-init="false"> 		<property name="ignoreResourceNotFound" value="true" /> 		<property name="systemPropertiesModeName" value="SYSTEM_PROPERTIES_MODE_OVERRIDE"/><!-- å…è®¸systemè¦†ç›– --> 		<property name="locationNames"> 			<list> 				<value>classpath:canal.properties</value> 				<value>classpath:${canal.instance.destination:}/instance.properties</value> 			</list> 		</property> 	</bean> 	 	<bean id="socketAddressEditor" class="com.alibaba.otter.canal.instance.spring.support.SocketAddressEditor" /> 	<bean class="org.springframework.beans.factory.config.CustomEditorConfigurer">  		<property name="propertyEditorRegistrars"> 			<list> 				<ref bean="socketAddressEditor" /> 			</list> 		</property> 	</bean> 	<bean id="instance" class="com.alibaba.otter.canal.instance.spring.CanalInstanceWithSpring"> 		<property name="destination" value="${canal.instance.destination}" /> 		<property name="eventParser"> 			<ref local="eventParser" /> 		</property> 		<property name="eventSink"> 			<ref local="eventSink" /> 		</property> 		<property name="eventStore"> 			<ref local="eventStore" /> 		</property> 		<property name="metaManager"> 			<ref local="metaManager" /> 		</property> 		<property name="alarmHandler"> 			<ref local="alarmHandler" /> 		</property> 	</bean> 	 	<!-- æŠ¥è­¦å¤„ç†ç±» --> 	<bean id="alarmHandler" class="com.alibaba.otter.canal.common.alarm.LogAlarmHandler" /> 	 	<bean id="metaManager" class="com.alibaba.otter.canal.meta.MemoryMetaManager" /> 	 	<bean id="eventStore" class="com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer"> 		<property name="bufferSize" value="${canal.instance.memory.buffer.size:16384}" /> 		<property name="bufferMemUnit" value="${canal.instance.memory.buffer.memunit:1024}" /> 		<property name="batchMode" value="${canal.instance.memory.batch.mode:MEMSIZE}" /> 		<property name="ddlIsolation" value="${canal.instance.get.ddl.isolation:false}" /> 	</bean> 	 	<bean id="eventSink" class="com.alibaba.otter.canal.sink.entry.EntryEventSink"> 		<property name="eventStore" ref="eventStore" /> 	</bean> 	 	<bean id="eventParser" class="com.alibaba.otter.canal.parse.inbound.group.GroupEventParser"> 		<property name="eventParsers"> 			<list> 				<ref bean="eventParser1" /> 				<ref bean="eventParser2" /> 			</list> 		</property> 	</bean> 	<bean id="eventParser1" class="com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser"> 		<property name="destination" value="${canal.instance.destination}" /> 		<property name="slaveId" value="${canal.instance.mysql.slaveId:1234}" /> 		<!-- å¿ƒè·³é…ç½® --> 		<property name="detectingEnable" value="${canal.instance.detecting.enable:false}" /> 		<property name="detectingSQL" value="${canal.instance.detecting.sql}" /> 		<property name="detectingIntervalInSeconds" value="${canal.instance.detecting.interval.time:5}" /> 		<property name="haController"> 			<bean class="com.alibaba.otter.canal.parse.ha.HeartBeatHAController"> 				<property name="detectingRetryTimes" value="${canal.instance.detecting.retry.threshold:3}" /> 				<property name="switchEnable" value="${canal.instance.detecting.heartbeatHaEnable:false}" /> 			</bean> 		</property> 		 		<property name="alarmHandler" ref="alarmHandler" /> 		 		<!-- è§£æè¿‡æ»¤å¤„ç† --> 		<property name="eventFilter"> 			<bean class="com.alibaba.otter.canal.filter.aviater.AviaterRegexFilter" > 				<constructor-arg index="0" value="${canal.instance.filter.regex:.*\..*}" /> 			</bean> 		</property> 		 		<property name="eventBlackFilter"> 			<bean class="com.alibaba.otter.canal.filter.aviater.AviaterRegexFilter" > 				<constructor-arg index="0" value="${canal.instance.filter.black.regex:}" /> 				<constructor-arg index="1" value="false" /> 			</bean> 		</property> 		<!-- æœ€å¤§äº‹åŠ¡è§£æå¤§å°ï¼Œè¶…è¿‡è¯¥å¤§å°åäº‹åŠ¡å°†è¢«åˆ‡åˆ†ä¸ºå¤šä¸ªäº‹åŠ¡æŠ•é€’ --> 		<property name="transactionSize" value="${canal.instance.transaction.size:1024}" /> 		 		<!-- ç½‘ç»œé“¾æ¥å‚æ•° --> 		<property name="receiveBufferSize" value="${canal.instance.network.receiveBufferSize:16384}" /> 		<property name="sendBufferSize" value="${canal.instance.network.sendBufferSize:16384}" /> 		<property name="defaultConnectionTimeoutInSeconds" value="${canal.instance.network.soTimeout:30}" /> 		 		<!-- è§£æç¼–ç  --> 		<!-- property name="connectionCharsetNumber" value="${canal.instance.connectionCharsetNumber:33}" /--> 		<property name="connectionCharset" value="${canal.instance.connectionCharset:UTF-8}" /> 	 		<!-- è§£æä½ç‚¹è®°å½• --> 		<property name="logPositionManager"> 			<bean class="com.alibaba.otter.canal.parse.index.MemoryLogPositionManager" /> 		</property> 		 		<!-- failoveråˆ‡æ¢æ—¶å›é€€çš„æ—¶é—´ --> 		<property name="fallbackIntervalInSeconds" value="${canal.instance.fallbackIntervalInSeconds:60}" /> 		 		<!-- è§£ææ•°æ®åº“ä¿¡æ¯ --> 		<property name="masterInfo"> 			<bean class="com.alibaba.otter.canal.parse.support.AuthenticationInfo"> 				<property name="address" value="${canal.instance.master1.address}" /> 				<property name="username" value="${canal.instance.dbUsername:retl}" /> 				<property name="password" value="${canal.instance.dbPassword:retl}" /> 				<property name="defaultDatabaseName" value="${canal.instance.defaultDatabaseName:retl}" /> 			</bean> 		</property> 		<property name="standbyInfo"> 			<bean class="com.alibaba.otter.canal.parse.support.AuthenticationInfo"> 				<property name="address" value="${canal.instance.standby1.address}" /> 				<property name="username" value="${canal.instance.dbUsername:retl}" /> 				<property name="password" value="${canal.instance.dbPassword:retl}" /> 				<property name="defaultDatabaseName" value="${canal.instance.defaultDatabaseName:retl}" /> 			</bean> 		</property> 		 		<!-- è§£æèµ·å§‹ä½ç‚¹ --> 		<property name="masterPosition"> 			<bean class="com.alibaba.otter.canal.protocol.position.EntryPosition"> 				<property name="journalName" value="${canal.instance.master1.journal.name}" /> 				<property name="position" value="${canal.instance.master1.position}" /> 				<property name="timestamp" value="${canal.instance.master1.timestamp}" /> 			</bean> 		</property> 		<property name="standbyPosition"> 			<bean class="com.alibaba.otter.canal.protocol.position.EntryPosition"> 				<property name="journalName" value="${canal.instance.standby1.journal.name}" /> 				<property name="position" value="${canal.instance.standby1.position}" /> 				<property name="timestamp" value="${canal.instance.standby1.timestamp}" /> 			</bean> 		</property> 		<property name="filterQueryDml" value="${canal.instance.filter.query.dml:false}" /> 		<property name="filterQueryDcl" value="${canal.instance.filter.query.dcl:false}" /> 		<property name="filterQueryDdl" value="${canal.instance.filter.query.ddl:false}" /> 		<property name="filterTableError" value="${canal.instance.filter.table.error:false}" /> 		<property name="supportBinlogFormats" value="${canal.instance.binlog.format}" /> 		<property name="supportBinlogImages" value="${canal.instance.binlog.image}" /> 	</bean> 	 	<bean id="eventParser2" class="com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser"> 		<property name="destination" value="${canal.instance.destination}" /> 		<property name="slaveId" value="${canal.instance.mysql.slaveId:1234}" /> 		<!-- å¿ƒè·³é…ç½® --> 		<property name="detectingEnable" value="${canal.instance.detecting.enable:false}" /> 		<property name="detectingSQL" value="${canal.instance.detecting.sql}" /> 		<property name="detectingIntervalInSeconds" value="${canal.instance.detecting.interval.time:5}" /> 		<property name="haController"> 			<bean class="com.alibaba.otter.canal.parse.ha.HeartBeatHAController"> 				<property name="detectingRetryTimes" value="${canal.instance.detecting.retry.threshold:3}" /> 				<property name="switchEnable" value="${canal.instance.detecting.heartbeatHaEnable:false}" /> 			</bean> 		</property> 		 		<property name="alarmHandler" ref="alarmHandler" /> 		 		<!-- è§£æè¿‡æ»¤å¤„ç† --> 		<property name="eventFilter"> 			<bean class="com.alibaba.otter.canal.filter.aviater.AviaterRegexFilter" > 				<constructor-arg index="0" value="${canal.instance.filter.regex:.*\..*}" /> 			</bean> 		</property> 		 		<property name="eventBlackFilter"> 			<bean class="com.alibaba.otter.canal.filter.aviater.AviaterRegexFilter" > 				<constructor-arg index="0" value="${canal.instance.filter.black.regex:}" /> 				<constructor-arg index="1" value="false" /> 			</bean> 		</property> 		<!-- æœ€å¤§äº‹åŠ¡è§£æå¤§å°ï¼Œè¶…è¿‡è¯¥å¤§å°åäº‹åŠ¡å°†è¢«åˆ‡åˆ†ä¸ºå¤šä¸ªäº‹åŠ¡æŠ•é€’ --> 		<property name="transactionSize" value="${canal.instance.transaction.size:1024}" /> 		 		<!-- ç½‘ç»œé“¾æ¥å‚æ•° --> 		<property name="receiveBufferSize" value="${canal.instance.network.receiveBufferSize:16384}" /> 		<property name="sendBufferSize" value="${canal.instance.network.sendBufferSize:16384}" /> 		<property name="defaultConnectionTimeoutInSeconds" value="${canal.instance.network.soTimeout:30}" /> 		 		<!-- è§£æç¼–ç  --> 		<!-- property name="connectionCharsetNumber" value="${canal.instance.connectionCharsetNumber:33}" /--> 		<property name="connectionCharset" value="${canal.instance.connectionCharset:UTF-8}" /> 	 		<!-- è§£æä½ç‚¹è®°å½• --> 		<property name="logPositionManager"> 			<bean class="com.alibaba.otter.canal.parse.index.MemoryLogPositionManager" /> 		</property> 		 		<!-- failoveråˆ‡æ¢æ—¶å›é€€çš„æ—¶é—´ --> 		<property name="fallbackIntervalInSeconds" value="${canal.instance.fallbackIntervalInSeconds:60}" /> 		 		<!-- è§£ææ•°æ®åº“ä¿¡æ¯ --> 		<property name="masterInfo"> 			<bean class="com.alibaba.otter.canal.parse.support.AuthenticationInfo"> 				<property name="address" value="${canal.instance.master2.address}" /> 				<property name="username" value="${canal.instance.dbUsername:retl}" /> 				<property name="password" value="${canal.instance.dbPassword:retl}" /> 				<property name="defaultDatabaseName" value="${canal.instance.defaultDatabaseName:retl}" /> 			</bean> 		</property> 		<property name="standbyInfo"> 			<bean class="com.alibaba.otter.canal.parse.support.AuthenticationInfo"> 				<property name="address" value="${canal.instance.standby2.address}" /> 				<property name="username" value="${canal.instance.dbUsername:retl}" /> 				<property name="password" value="${canal.instance.dbPassword:retl}" /> 				<property name="defaultDatabaseName" value="${canal.instance.defaultDatabaseName:retl}" /> 			</bean> 		</property> 		 		<!-- è§£æèµ·å§‹ä½ç‚¹ --> 		<property name="masterPosition"> 			<bean class="com.alibaba.otter.canal.protocol.position.EntryPosition"> 				<property name="journalName" value="${canal.instance.master2.journal.name}" /> 				<property name="position" value="${canal.instance.master2.position}" /> 				<property name="timestamp" value="${canal.instance.master2.timestamp}" /> 			</bean> 		</property> 		<property name="standbyPosition"> 			<bean class="com.alibaba.otter.canal.protocol.position.EntryPosition"> 				<property name="journalName" value="${canal.instance.standby2.journal.name}" /> 				<property name="position" value="${canal.instance.standby2.position}" /> 				<property name="timestamp" value="${canal.instance.standby2.timestamp}" /> 			</bean> 		</property> 		<property name="filterQueryDml" value="${canal.instance.filter.query.dml:false}" /> 		<property name="filterQueryDcl" value="${canal.instance.filter.query.dcl:false}" /> 		<property name="filterQueryDdl" value="${canal.instance.filter.query.ddl:false}" /> 		<property name="filterRows" value="${canal.instance.filter.rows:false}" /> 		<property name="filterTableError" value="${canal.instance.filter.table.error:false}" /> 		<property name="supportBinlogFormats" value="${canal.instance.binlog.format}" /> 		<property name="supportBinlogImages" value="${canal.instance.binlog.image}" /> 	</bean> </beans> ``` clientæ¥å…¥çš„æ—¶å€™æ€ä¹ˆé…ç½®destinationå‘¢ï¼Ÿä½¿ç”¨é€—å·åˆ†éš”æ˜¯ä¸è¡Œçš„ï¼Œä¼šå½“åšä¸€ä¸ªæ¥å¤„ç†ï¼Œæ— æ³•æ‰¾åˆ° ``` String destination = "food";         String ip = "127.0.0.1";         CanalConnector connector = CanalConnectors.newSingleConnector(new InetSocketAddress(ip  11111)             destination             ""             ""); ``` # å¦å¤–QQç¾¤æ˜¯å¦å¯ä»¥å¤„ç†ä¸€ä¸‹ï¼Ÿ161559791  ï¼Ÿ @xiaopan0513 æˆ‘ä¹Ÿæƒ³çŸ¥é“è¿™ä¸ªï¼Œè¯·é—®ç›¸åº”çš„ä»£ç æ€ä¹ˆå†™ï¼Ÿ @xiaopan0513 æˆ‘ä¹Ÿé¢ä¸´åŒæ ·çš„é—®é¢˜ï¼Œæƒ³è¯·æ•™ä¸‹è¿™å—æ€ä¹ˆé…ç½®å‘¢ï¼Ÿ
395,ä½¿ç”¨GroupEventSinkæ—¶ï¼Œæ•°æ®å˜æ›´ä¸é¢‘ç¹åŒæ­¥å¡ä½çš„è§£å†³æ–¹æ¡ˆ hiï¼Œagappleï¼š å½“ä½¿ç”¨GroupEventSinkæ—¶ï¼Œå¦‚æœæœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªåˆ†åº“ä¸€ç›´æ²¡æœ‰binlogï¼Œé‚£ä¹ˆæ‰€æœ‰paserçº¿ç¨‹éƒ½ä¼šå¡åœ¨doSinkæ–¹æ³•ä¸Šï¼Œå¯¼è‡´æœ‰binlogäº§ç”Ÿçš„åˆ†åº“æ•°æ®ä¹Ÿæ— æ³•æ¶ˆè´¹ã€‚ä»ä»£ç æ³¨é‡Šä¸Šçœ‹ï¼Œè¿™ä¹ˆè®¾è®¡çš„åŸå› ï¼Œæ˜¯ä¸ºäº†ç›¸äº’ååŒï¼Œé˜²æ­¢æŸä¸ªåˆ†åº“å‡ºç°é—®é¢˜æ—¶ï¼Œè¢«è½ä¸‹ï¼Œè¿™æ ·å¯ä»¥é¿å…instanceé‡å¯æ—¶ä¸¢æ•°æ®ã€‚ä½†åŒæ—¶ä¹Ÿå¢å¤§äº†Groupæ¨¡å¼çš„å±€é™æ€§ï¼Œæˆ‘ä»¬ç°åœ¨å°±æœ‰ç±»ä¼¼çš„åœºæ™¯ï¼Œé¡¹ç›®é¢„æœŸä¼šæœ‰å¾ˆå¤§çš„æ•°æ®é‡ï¼Œæå‰è¿›è¡Œäº†åˆ†åº“ï¼ˆ8ä¸ªåº“ï¼‰ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰å¤§æ‰¹é‡æ¨å¹¿ï¼Œæ¯å¤©çš„æ•°æ®é‡åªæœ‰å‡ åƒæ¡ï¼ŒæŸäº›åˆ†åº“ä¼šé•¿æ—¶é—´æ²¡æœ‰æ•°æ®ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘æƒ³åˆ°çš„æ–¹æ¡ˆæœ‰ä¸¤ä¸ªï¼š 1ã€ä¸€ä¸ªæ˜¯åˆ©ç”¨å¿ƒè·³Sqlï¼Œç±»ä¼¼â€œinsert into retl.xdual values(1 now()) on duplicate key update x=now()â€œï¼Œä¿è¯åˆ†åº“æºæºä¸æ–­çš„æœ‰binlogäº§ç”Ÿï¼Œè¿™æ ·å°±ä¸ä¼šå¡ä½äº†ã€‚ç¼ºç‚¹æ˜¯å¯¹ä¸šåŠ¡ç³»ç»Ÿæœ‰ä¾µå…¥ï¼Œå¿…é¡»åœ¨ä¸šåŠ¡åº“ä¸Šåˆ›å»ºä¸€ä¸ªè¾…åŠ©è¡¨ 2ã€å¦å¤–æƒ³åˆ°çš„ä¸€ä¸ªæ–¹æ¡ˆæ˜¯ï¼Œæ”¹é€ MysqlEventParserï¼Œåœ¨å†…éƒ¨ç±»MysqlDetectingTimeTaskçš„runæ–¹æ³•ä¸­ï¼Œå½“æ²¡æœ‰å‡ºç°å¼‚å¸¸æ—¶ï¼Œæ„é€ ä¸€ä¸ªHeartbeatç±»å‹çš„Eventï¼Œç„¶åè°ƒç”¨consumeTheEventAndProfilingIfNecessaryæ–¹æ³•ï¼Œç±»ä¼¼AbstractEventParserçš„buildHeartBeatTimeTaskæ–¹æ³• ä½ çœ‹è¿˜æœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹æ¡ˆï¼Ÿ ä»¥å‰groupæ¨¡å¼çš„è®¾è®¡ä¸å¤ªå¥½ï¼ŒåŸºäºé”çš„æ–¹å¼æ€§èƒ½å¤ªå·® ä½ ä»¬å†…éƒ¨æ²¡æ€ä¹ˆä½¿ç”¨è¿™ç§æ–¹æ¡ˆå—ï¼Ÿæ€§èƒ½å·®ä¹Ÿæ˜¯ç›¸å¯¹çš„ï¼Œè¿™ç§æ–¹å¼è¿˜æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œä¹‹å‰8ä¸ªåˆ†åº“éœ€è¦åˆ›å»º8ä¸ªå®ä¾‹ï¼Œç„¶åæ¯ä¸ªå®ä¾‹ä¸€å †æ˜ å°„é…ç½®ï¼Œè¿ç»´èµ·æ¥è¿˜æ˜¯æŒºéº»çƒ¦çš„ã€‚æœ‰æ—¶é—´çš„è¯ï¼Œæ‚¨é‚£è¾¹å¯ä»¥æƒ³ä¸€æƒ³ï¼Œçœ‹èƒ½ä¸èƒ½æœ‰ä¸€ä¸ªæ›´å¥½çš„æ–¹æ¡ˆï¼Œè§£å†³è¿™ç§ååŒå¡ä½çš„é—®é¢˜ @agapple å¯¹äºgroupè¿™ç§æ¨¡å¼æœ‰ä»€ä¹ˆå¥½çš„æ€è·¯å—ï¼Ÿå¯¹äºMySQL åˆ†åº“åˆ†è¡¨çš„åœºæ™¯è¿˜æ˜¯ç›¸å½“å¤šçš„ï¼Œä½†å¯¹äºåº”ç”¨ç«¯å…¶å®ä¸å…³å¿ƒåº•å±‚åˆ°åº•åˆ†äº†å¤šå°‘ä¸ªåº“ï¼Œä¸çŸ¥é“è¿™å—æœ‰ä»€ä¹ˆå¥½çš„å»ºè®®ï¼Ÿ å‚è€ƒï¼šhttps://github.com/alibaba/canal/pull/522 å‡çº§ä¸€ä¸‹canal 26ç‰ˆæœ¬è¯•è¯• æ„Ÿè°¢ã€‚æ¯”è¾ƒå…³å¿ƒ26æ­£å¼ç‰ˆä»€ä¹ˆæ—¶å€™å‘å¸ƒã€‚ ç›®å‰æˆ‘ä»¬åœ¨1.0.24ä¸Šï¼Œé€šè¿‡patchè§£å†³æ­»é”é—®é¢˜ã€‚ ps å…ˆå‰1.0.25æ€»æ˜¯ä¼šå‡ºç°çº¿ç¨‹å¡æ­»åœ¨connectäºreconnectä¸Šã€‚è²Œä¼¼åœ¨26ç‰ˆæœ¬é‡Œä¹Ÿè§£å†³äº†ã€‚
394,TimelineTransactionBarrierå­˜åœ¨æ­»é”bug TimelineTransactionBarrierçš„isPermitæ–¹æ³•ä¸­æœ‰å¦‚ä¸‹ä»£ç               `if (isTransactionBegin(event)) {                     if (txState.compareAndSet(0  1)) {                         inTransaction.set(true);                         return true; // äº‹åŠ¡å…è®¸é€šè¿‡                     }                 } else if (txState.compareAndSet(0  2)) { // éäº‹åŠ¡ä¿æŠ¤ä¸­                     return true; // DDL/DCLå…è®¸é€šè¿‡                 }` å¯¹äºæœ€åä¸€ä¸ªelse ifåˆ†æ”¯ï¼Œä¸ä»…ddlå’Œdclçš„åœºæ™¯ä¼šè¿›å…¥ï¼ŒTransactionEndæ—¶ä¹Ÿå¯èƒ½ä¼šè¿›å…¥ï¼ˆå½“åŸºäºä¸Šæ¬¡Positionå¯åŠ¨EventParseræ—¶ï¼Œæ‹¿åˆ°çš„ç¬¬ä¸€ä¸ªäº‹ä»¶ç±»å‹æ˜¯TransactionEndï¼‰ å†çœ‹TimelineTransactionBarrierçš„clearæ–¹æ³• `public void clear(Event event) {         super.clear(event);         if (isTransactionEnd(event)) {             inTransaction.set(false); // äº‹åŠ¡ç»“æŸå¹¶ä¸”å·²ç»æˆåŠŸå†™å…¥storeï¼Œæ¸…ç†æ ‡è®°ï¼Œè¿›å…¥é‡æ–°æ’é˜Ÿåˆ¤æ–­ï¼Œå…è®¸æ–°çš„äº‹åŠ¡è¿›å…¥             txState.compareAndSet(1  0);             // if (txState.compareAndSet(1  0) == false) {             // throw new             // CanalSinkException("state is not correct in transaction");             // }         } else if (txState.intValue() == 2) {// éäº‹åŠ¡ä¸­             txState.compareAndSet(2  0);             // if (txState.compareAndSet(2  0) == false) {             // throw new             // CanalSinkException("state is not correct in non-transaction");             // }         }     }` ç¬¬ä¸€ä¸ªifåˆ¤æ–­ï¼Œåº”è¯¥å¤šåŠ ä¸€ä¸ªæ¡ä»¶â€œ&& txState.intValue() != 2â€ï¼Œä»¥åº”å¯¹ä¸Šé¢è¯´çš„TransactionEndé—®é¢˜ï¼Œå¦åˆ™txStateçš„çŠ¶æ€å°†ä¸€ç›´ä¸º2ï¼ŒisPermitæ–¹æ³•å§‹ç»ˆè¿”å›falseï¼Œç³»ç»Ÿå‡ºç°æ­»é” æˆ–è€…æ˜¯æŠŠclearæ–¹æ³•ä¸­çš„ä¸¤ä¸ªifçš„é¡ºåºè°ƒæ¢ä¸€ä¸‹ æ–¹ä¾¿æäº¤ä¸€ä¸ªpull requestç»™æˆ‘ï¼Ÿ å¥½çš„ï¼Œè¿™ä¸¤å¤©å¿™å®Œï¼Œå°±æ
393,Table meta support [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=393) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you all sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=393) before we can accept your contribution.<br/>**0** out of **2** committers have signed the CLA.<br/><br/>:x: KaimingWan<br/>:x: wanshao<br/><hr/>**wanshao** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=393) it.</sub>
392,table meta support support table meta  [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=392) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you all sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=392) before we can accept your contribution.<br/>**0** out of **2** committers have signed the CLA.<br/><br/>:x: KaimingWan<br/>:x: wanshao<br/><hr/>**wanshao** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=392) it.</sub>
391,ä¸»åº“æ˜¯mysql 5.7ï¼Œä¸»åº“ç¼–ç UTF8MB4 ç”¨canal-1.0.24è¿™ä¸ªç‰ˆæœ¬ï¼Œä½ç‚¹åˆå§‹å€¼ä¸º123 æ‰§è¡Œæ—¶é—´1506482123ï¼Œå¯åŠ¨æŠ¥é”™ ä¸»åº“æ˜¯mysql 5.7ï¼Œä¸»åº“ç¼–ç UTF8MB4 ç”¨canal-1.0.24è¿™ä¸ªç‰ˆæœ¬ï¼Œä½ç‚¹åˆå§‹å€¼ä¸º123 æ‰§è¡Œæ—¶é—´1506482123ï¼Œcanalé…ç½®äº†timestamp æ²¡æœ‰é…ç½®ä½ç‚¹ï¼Œæç¤ºä»¥ä¸‹å¼‚å¸¸ 2017-09-29 14:20:32.614 [main] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - start successful.... 2017-09-29 14:20:32.892 [destination = example_wxprober   address = /XXXXXXX:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position mysql-bin.000013::1506482123000 2017-09-29 14:20:32.934 [destination = example_wxprober   address = /XXXXXXX:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file Could not find first log file name in binary log index fileï¼Œä½ç‚¹ä¸å¯¹
390,ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:xxx[java.io.IOException: Unexpected End Stream åœ¨canalå®ä¾‹æ—¥å¿—ä¸­å¶å°”ä¼šæŠ¥è¿™ä¸ªé”™è¯¯ï¼Œè¯·é—®æ€ä¹ˆè§£å†³ mysqlæ–­é“¾é—®é¢˜ï¼Œç›®å‰æ˜¯ä¸€äº›å·²çŸ¥é—®é¢˜ï¼Œä¸»å¹²ç‰ˆæœ¬æœ‰äººæäº¤äº†ä¿®å¤ @agapple  ``` 2017-11-06 15:00:03.937 [destination = action_log   address = /127.0.0.2:2020   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address 127.0.0.2/127.0.0.2:2020 has an error  retrying. caused by  java.io.IOException: Unexpected End Stream         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:122) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) ~[canal.parse-1.0.24.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.7.0_80] 2017-11-06 15:00:03.938 [destination = action_log   address = /127.0.0.2:2020   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:action_log[java.io.IOException: Unexpected End Stream         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:122)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209)         at java.lang.Thread.run(Thread.java:745) ] 2017-11-06 15:00:22.587 [destination = action_log   address = /127.0.0.2:2020   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position  {"identity":{"slaveId":-1 "sourceAddress":{"address":"127.0.0.2" "port":2020}} "postion":{"included":false "journalName":"mysql-bin.001213" "position":638501339 "serverId":1037 "timestamp":1509951603000}} 2017-11-06 17:00:22.588 [destination = action_log   address = /127.0.0.2:2020   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Unexpected End Stream         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:122) [canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) [canal.parse-1.0.24.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.7.0_80] 2017-11-06 17:00:22.588 [destination = action_log   address = /127.0.0.2:2020   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address 127.0.0.2/127.0.0.2:2020 has an error  retrying. caused by  java.io.IOException: Unexpected End Stream         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:122) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) ~[canal.parse-1.0.24.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.7.0_80] 2017-11-06 17:00:22.588 [destination = action_log   address = /127.0.0.2:2020   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:action_log[java.io.IOException: Unexpected End Stream         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:122)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209)         at java.lang.Thread.run(Thread.java:745) ] 2017-11-06 17:00:34.936 [destination = action_log   address = /127.0.0.2:2020   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position  {"identity":{"slaveId":-1 "sourceAddress":{"address":"127.0.0.2" "port":2020}} "postion":{"included":false "journalName":"mysql-bin.001214" "position":269841413 "serverId":1037 "timestamp":1509958822000}} (END)  ``` å¤§çº¦æ¯ä¸¤å°æ—¶å°±æŠ¥ä¸€æ¬¡ï¼Œä½†æ˜¯è²Œä¼¼å¹¶æ²¡æœ‰ä¸¢æ•°æ®ï¼Œè¯·é—®å¯¹çº¿ä¸Šä¸šåŠ¡æœ‰å½±å“å—ï¼Ÿæ–°ç‰ˆcanalä¿®å¤è¯¥é—®é¢˜äº†å—ï¼Ÿ äº²ï¼Œè¿™ä¸ªé—®é¢˜ä½ ä»¬è§£å†³äº†å˜›ï¼Ÿ @tdytaylor  è‡³ä»Šæ²¡æœ‰è§£å†³ï¼Œå¦‚æœä½ è§£å†³äº†ï¼Œå¼ä¸€å¼ mysql serveræœåŠ¡ç«¯ä¸»åŠ¨æ–­é“¾æ¥ï¼Œå°è¯•ç”¨æœ€æ–°ç‰ˆæœ¬è¯•è¯• è¿™ä¸ªé—®é¢˜ä¼šé€ æˆä¸¢å¤±æ•°æ®å—...é‡å¯äº†åé‡åˆ°çš„   å‡çº§ç‰ˆæœ¬æœ‰ä»€ä¹ˆç®€ä¾¿æ–¹æ³•å—
389,canal is not run any in node  failed to connect to:/1.0.0.1:7536 after retry 1 times 2017-09-27/14:33:30.751||||^_^|uid:|clientIp:|deviceId:|^_^|[binlog main] ERROR c.a.o.c.client.impl.running.ClientRunningMonitor 137 - There is an error when execute initRunning method  with destination [es1]. 434654-com.alibaba.otter.canal.protocol.exception.CanalClientException: java.net.ConnectException: Connection refused 434655-	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.doConnect(SimpleCanalConnector.java:171) 434656-	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.access$000(SimpleCanalConnector.java:48) 434657-	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector$1.processActiveEnter(SimpleCanalConnector.java:396) 434658-	at com.alibaba.otter.canal.client.impl.running.ClientRunningMonitor.processActiveEnter(ClientRunningMonitor.java:207) 434659-	at com.alibaba.otter.canal.client.impl.running.ClientRunningMonitor.initRunning(ClientRunningMonitor.java:118) 434660-	at com.alibaba.otter.canal.client.impl.running.ClientRunningMonitor.start(ClientRunningMonitor.java:92) 434661-	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.connect(SimpleCanalConnector.java:93) 434662-	at com.alibaba.otter.canal.client.impl.ClusterCanalConnector.connect(ClusterCanalConnector.java:63) 434663-	at com.alibaba.otter.canal.client.impl.ClusterCanalConnector.restart(ClusterCanalConnector.java:275) 434664-	at com.alibaba.otter.canal.client.impl.ClusterCanalConnector.getWithoutAck(ClusterCanalConnector.java:187) 434665-	at com.domain.es.canal.Consumer$HandlerThread.run(BinLogConsumer.java:194) 434666-Caused by: java.net.ConnectException: Connection refused 434667-	at sun.nio.ch.Net.connect0(Native Method) 434668-	at sun.nio.ch.Net.connect(Net.java:454) 434669-	at sun.nio.ch.Net.connect(Net.java:446) 434670-	at sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:648) 434671-	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.doConnect(SimpleCanalConnector.java:132) 434672-	... 10 common frames omitted 434673-2017-09-27/14:33:30.759||||^_^|uid:|clientIp:|deviceId:|^_^|[binlog main] WARN  c.a.otter.canal.client.impl.ClusterCanalConnector 66 - failed to connect to:/1.0.0.1:7536 after retry 1 times 434674-2017-09-27/14:33:30.761||||^_^|uid:|clientIp:|deviceId:|^_^|[binlog main] WARN  c.a.o.c.client.impl.running.ClientRunningMonitor 174 - canal is not run any in node Caused by: java.net.ConnectException: Connection refused
388,Canalä¼šä¸å®šæœŸçš„æŠ¥no dataçš„æƒ…å†µ æˆ‘ä»¬åƒotteré‚£æ ·ä½¿ç”¨canalæ¥è·å–binlogæ•°æ®ï¼Œä½†æ˜¯è¿è¡Œäº†ä¸€æ®µæ—¶å€™ä¹‹åæœ‰ä¸ªåˆ«channelä»»åŠ¡çš„canalä¼šä¸å®šæ—¶æŠ¥é•¿æ—¶é—´no dataçš„æƒ…å†µï¼Œå‘Šè­¦å†…å®¹å¦‚ï¼špid:24 nid:4 exception:mainstem:pid:24 canal elapsed 5000 seconds no data ï¼Œåˆ‡æ¢mainstemä¹Ÿä¸èƒ½è§£å†³é—®é¢˜ï¼Œé‡å¯æ•´ä¸ªæœåŠ¡ä¼šæ¢å¤ä¸€æ®µæ—¶é—´ï¼Œä¸çŸ¥é“å¤§ç¥ä»¬æœ‰æ²¡æœ‰é‡åˆ°ç±»ä¼¼é—®é¢˜ï¼Œæˆ–è€…æœ‰å•¥è§£å†³æ–¹æ¡ˆï¼Ÿ æˆ‘ä»¬ä¹Ÿæœ‰ä¸€æ ·çš„é—®é¢˜ï¼Œä¸è¿‡å¥½åƒä¸å½±å“åŒæ­¥ åº”è¯¥æ˜¯canalæ—©æœŸç‰ˆæœ¬çš„æºç«¯åº“æ— æ•°æ®çš„é—®é¢˜ï¼Œå°è¯•å‡çº§ä¸€ä¸‹otterå’Œcanalç‰ˆæœ¬å§
387,canal serveré‡å¯ï¼Œä¼šä»ä¸Šæ¬¡ä½ç‚¹è§£æå— å¼€å¯äº†HAçš„è¯ï¼Œä¸Šæ¬¡è§£æçš„ä½ç‚¹åº”è¯¥ä¼šå­˜åœ¨zkä¸­ï¼Œæ˜¯ä¼šä»ä¸Šæ¬¡ä½ç‚¹è§£æçš„ã€‚ æˆ‘æ˜¯ç”¨fileæŒä¹…åŒ–çš„ï¼Œä¸æ”¯æŒHAï¼Œè¿™æ ·æ˜¯å¦é‡å¯çš„æ—¶å€™ä¹Ÿèƒ½ä»ä¸Šæ¬¡ä½ç‚¹è§£æï¼Œå¦å¤–ï¼Œæˆ‘ç»“åˆotterä½¿ç”¨ï¼Œç›®å‰otterå¥½åƒåªæ”¯æŒå†…å­˜æ¨¡å¼ï¼Œè¿™æ ·æˆ‘é‡å¯åï¼Œæ˜¯å¦ä¼šä¸¢å¤±æœåŠ¡æ–­å¼€æœŸé—´çš„æ•°æ®å‘¢ ä¸ä¼šä¸¢ï¼Œå¤šçœ‹çœ‹WIKIå’ŒFAQ @zhumt fileæ¨¡å¼ä¼šçš„åœ¨instanceçš„é…ç½®ä¸‹ï¼Œä¼šç”Ÿäº§ä¸€ä¸ªmeta.datæ–‡ä»¶è®°å½•ä¸Šä¸€æ¬¡è§£æç‚¹
386,å‹åŠ›å¤§çš„æƒ…å†µä¸‹binlogè§£æå˜æ…¢ åœ¨æµ‹è¯•çš„æ—¶å€™å‘ç°ï¼Œå½“äº§ç”Ÿbinlogå¤§æ¦‚è¶…è¿‡3ä¸‡qpsçš„æ—¶å€™ï¼Œcanalè§£æäº§ç”Ÿçš„eventå˜çš„ç‰¹åˆ«æ…¢ï¼ŒæœåŠ¡å™¨æœ‰ä¸ªcpuè·‘åˆ°100%ï¼Œè¿™æ˜¯ä»€ä¹ˆæƒ…å†µï¼Œå¦‚ä½•è§£å†³å‘¢ï¼Ÿ å‚è€ƒï¼šhttps://github.com/alibaba/canal/wiki/FAQ
384,windowsä¸­startup.batå¯åŠ¨æŠ¥é”™ Error: missing `server' JVM at `C:\Program Files (x86)\Java\jre1.8.0_111\bin\server\jvm.dll'. Please install or use the JRE or JDK that contains these missing components. æ£€æŸ¥ä¸‹è‡ªå·±çš„jvmï¼Œä½¿ç”¨1.6ã€1.7ç‰ˆæœ¬è¯•è¯•
383,canal postioné‡ç½®é—®é¢˜ @agapple  @lulu2panpan è¯·ä¸¤ä½æœ‰ç©ºçœ‹ä¸‹ï¼Œè°¢è°¢å•¦ï¼ - ä¸Šä¸€æ¬¡æˆåŠŸçš„ackæ—¥å¿—ï¼š [     batchId: 906915     position: PositionRange[         start=LogPosition[             identity=LogIdentity[                 sourceAddress=192.168.10.180/192.168.10.180: 3306                 slaveId=-1             ]             postion=EntryPosition[                 included=false                 journalName=mysql-bin.000940                 position=150869837                 serverId=180                 timestamp=1505671087000             ]         ]         ack=<null>         end=LogPosition[             identity=LogIdentity[                 sourceAddress=192.168.10.180/192.168.10.180: 3306                 slaveId=-1             ]             postion=EntryPosition[                 included=false                 journalName=mysql-bin.000940                 position=151977852                 serverId=180                 timestamp=1505671093000             ]         ]     ] ] - rollbackå¤±è´¥çš„ackæ—¥å¿—ï¼š e[     start=LogPosition[         identity=LogIdentity[             sourceAddress=192.168.10.180/192.168.10.180: 3306             slaveId=-1         ]         postion=EntryPosition[             included=false             journalName=mysql-bin.000940             position=151979096             serverId=180             timestamp=1505671093000         ]     ]     ack=LogPosition[         identity=LogIdentity[             sourceAddress=192.168.10.180/192.168.10.180: 3306             slaveId=-1         ]         postion=EntryPosition[             included=false             journalName=mysql-bin.000940             position=138659218             serverId=180             timestamp=1505670995000         ]     ]     end=LogPosition[         identity=LogIdentity[             sourceAddress=192.168.10.180/192.168.10.180: 3306             slaveId=-1         ]         postion=EntryPosition[             included=false             journalName=mysql-bin.000940             position=138740531             serverId=180             timestamp=1505670996000         ]     ] ] æˆ‘ä»¬å¯¹æ¯”ä¸¤æ¬¡çš„æ—¥å¿—ï¼Œå‘ç°ackèŠ‚ç‚¹çš„å†…å®¹å‘ç”Ÿäº†å˜åŒ–ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œackçš„å€¼æ˜¯nullã€‚ä½†æ˜¯å¼‚å¸¸æƒ…å†µä¸‹ï¼Œé™„å¸¦äº†ä¿¡æ¯ï¼Œä¸”positionçš„ä½ç½®æ¯”start å’Œ endèŠ‚ç‚¹çš„éƒ½è¦é å‰ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆå‡ºç°è¿™ç§æƒ…å†µã€‚çº¿ä¸Šç¯å¢ƒå·²ç»é‡åˆ°å¾ˆå¤šæ¬¡äº†ã€‚å› ä¸ºpositionå˜æ›´ï¼Œæ•°æ®å°±ä¼šé‡å¤ï¼Œä¸»é”®å†²çªæ— æ³•insertæ“ä½œï¼Œéƒ½æ˜¯æ‰‹åŠ¨ä¿®æ”¹çš„ã€‚ ç›®å‰æˆ‘ä»¬çš„è§£å†³åŠæ³•æ˜¯ï¼š 1. æ¯”å¯¹zkçš„positionæ˜¯å¦æ˜¯æœ€æ–°çš„ï¼Œå¦‚æœæ˜¯çš„è¯å°±é‡å¯serverï¼Œä¹‹åå¯ä»¥æ­£å¸¸è¯»å– 2. å¦‚æœzkçš„positionä¹Ÿæ˜¯ä¹‹å‰çš„ä½ç‚¹ï¼Œåªèƒ½æ‰‹åŠ¨ä¿®æ”¹zkçš„postionä¸ºæœ€æ–°çš„ä½ç‚¹æ¥è§£å†³ã€‚ åˆ°ç›®å‰ä¸ºæ­¢éƒ½æ²¡æœ‰æ‰¾åˆ°å…·ä½“çš„åŸå› ï¼Œä¹Ÿä¸çŸ¥é“ä»€ä¹ˆä»€ä¹ˆå¼•èµ·çš„ã€‚ æˆ‘ä»¬æ˜¯å¤šä¸ªinstanceçš„æ–¹å¼éƒ¨ç½²ã€‚jdk 1.7 canal parseråœ¨ä¸»å¤‡åˆ‡æ¢æˆ–è€…é“¾æ¥æ–­å¼€æ—¶å°±ä¼šæœ‰é‡å¤æ¶ˆè´¹ï¼Œå¯¼è‡´ä½ç‚¹å›æº¯ï¼Œé‡å¤æ˜¯éš¾å…çš„
382,canal æŒ‡å®štimestamp 1ï¼‰è¯·é—®ä¸ºä»€ä¹ˆåªæŒ‡å®štimestampï¼Œå¯åŠ¨çš„æ—¶å€™æ‰¾ä¸åˆ°binlogä½ç½®ï¼Ÿå¿…é¡»å¾—è¦binlog filenameä¸€èµ·æŒ‡å®šæ‰èƒ½æ‰¾åˆ°ä½ç½®å‘¢ï¼Ÿ æˆ‘çœ‹æ–‡æ¡£é‡Œé¢æ˜¯è¿™æ ·å†™ç€ï¼š canal.instance.master.timestamp : æŒ‡å®šä¸€ä¸ªæ—¶é—´æˆ³ï¼Œcanalä¼šè‡ªåŠ¨éå†mysql binlogï¼Œæ‰¾åˆ°å¯¹åº”æ—¶é—´æˆ³çš„binlogä½ç‚¹åï¼Œè¿›è¡Œå¯åŠ¨ 2ï¼‰è¿˜æœ‰æˆ‘ç”¨binlog filename+ positionæŒ‡å®šæ—¶ï¼Œä»–åªä¼šéå†è¿™ä¸ªbinlogï¼Œä¸ä¼šæ‰§è¡Œä¸‹ä¸€ä¸ªbinlogæ˜¯å—ï¼Ÿ è¯·å¤§ç¥å¸®å¿™è§£ç­”ä¸€ä¸‹ï¼Œè°¢è°¢ timestamp æ²¡ç”¨è¿‡ï¼Œ binlog filename+ positionä¹Ÿæ˜¯ä¼šè‡ªåŠ¨å–ä¸‹ä¸€ä¸ªbinlogçš„ LSæ­£è§£ å•çº¯ä½¿ç”¨timestamp æ—¶æˆ‘è¯•äº†ä¹Ÿä¸è¡Œã€‚ä½†ä½¿ç”¨binlog filename+ positionæ²¡é—®é¢˜ã€‚
381,å¯åŠ¨æŸä¸ªchannelå°±ä¸€ç›´æŠ¥é”™ pid:9 nid:1 exception:canal:tdesk_test_canal:java.lang.NoClassDefFoundError: Could not initialize class com.alibaba.otter.canal.common.utils.JsonUtils      at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPositionInternal(MysqlEventParser.java:415)      at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPosition(MysqlEventParser.java:315)      at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:161)      at java.lang.Thread.run(Thread.java:748)  è¯·é—®æ˜¯ä»€ä¹ˆåŸå› å•Šï¼Ÿæ˜¯æ²¡æœ‰ä½ç‚¹çš„åŸå› çš„å—ï¼Ÿ å¯åŠ¨äº†å¤šä¸€æ®µæ—¶é—´ä¹Ÿå¯èƒ½æœ‰è¿™ä¸ªé”™ã€‚ è¯·ä½¿ç”¨æœ€æ–°ç‰ˆæµ‹è¯•
380,å»¶è¿Ÿæƒ…å†µä¸‹å¤šæ¡ddlè¯­å¥å¼•å‘schemaä¸åŒ¹é…çš„bug åœ¨æœ‰å¤šæ¡ddlè¯­å¥æ—¶ å¦‚æœbinlogè§£æå­˜åœ¨å»¶æ—¶ ä¼šå¼•å‘å¦‚ä¸‹é”™è¯¯ï¼š com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: column size is not match for table:`xxdb`.`xxxtable` 39 vs 37ã€‚ åŸå› å¦‚ä¸‹ï¼š binlogä¸­æœ‰å‰åä¸¤æ¡ddlè¯­å¥aå’Œbï¼Œç”±äºè§£æè½åï¼Œcanalæ‰è§£æåˆ°aï¼Œä»dbä¸­è·å–æœ€æ–°çš„schemaï¼Œå¾—åˆ°äº†bæ“ä½œåçš„schemaã€‚aå’Œbä¹‹é—´çš„æ¶ˆæ¯çš„è¡¨ç»“æ„è·Ÿæœ€æ–°çš„schemaä¸åŒ¹é…ã€‚ æˆ‘ä¹Ÿé‡åˆ°äº†åŒæ ·çš„é—®é¢˜ã€‚ã€‚ã€‚æ±‚å¤§ç¥è§£ç­”ã€‚ã€‚ ä¸‹ä¸€ä¸ªç‰ˆæœ¬ä¼šè§£å†³ æ ¹æ®æºä»£ç ã€‚canalå–è¡¨ç»“æ„çš„å…ƒä¿¡æ¯ä¸æ˜¯ä»binlogä¸­è§£æçš„ï¼Œè€Œæ˜¯ä»mysqlæ•°æ®åº“ä¸­ä½¿ç”¨desc db1.table1å»è·å–çš„ï¼Œè¿™æ ·å¿…ç„¶å­˜åœ¨éšæ‚£ã€‚ ä½¿ç”¨ä¸‹é¢çš„caseå³å¯é‡ç°é—®é¢˜ã€‚ å…ˆåœæ­¢canalã€‚ å†åœ¨mysqlä¸»åº“ä¸Šè¿è¡Œä¸‹åˆ—sqlè¯­å¥ use dbt1; CREATE TABLE Usert1 (   `userId` BIGINT NOT NULL AUTO_INCREMENT   `userNickName` varchar(20) NOT NULL DEFAULT ''   `isSystem` TINYINT NOT NULL DEFAULT 0   `updateTime` INT NOT NULL DEFAULT 0   PRIMARY KEY (`userId`) ) ENGINE=InnoDB AUTO_INCREMENT=100000; CREATE INDEX IDX_Usert1_mobile on `Usert1` (`mobile`);  INSERT INTO Usert1(`userId` `userNickName` `isSystem`  `updateTime`)     VALUES (101 'u101' 1  UNIX_TIMESTAMP()); INSERT INTO Usert1(`userId` `userNickName` `isSystem`  `updateTime`)     VALUES (201 'u201' 1  UNIX_TIMESTAMP()); UPDATE Usert1 SET isSystem=0 WHERE userId=201; DELETE FROM Usert1 WHERE userId=101; SELECT * FROM Usert1; ALTER TABLE Usert1 ADD COLUMN age INT DEFAULT 0; ALTER TABLE Usert1 DROP COLUMN updateTime; ALTER TABLE Usert1 change userNickName nickName varchar(20); INSERT INTO Usert1(`userId` `nickName` `isSystem`  `age`)     VALUES (301 'u301' 1  301); INSERT INTO Usert1(`userId` `nickName` `isSystem`  `age`)     VALUES (302 'u302' 1  302); UPDATE Usert1 SET isSystem=3 WHERE userId=301; DELETE FROM Usert1 WHERE userId=302; SELECT * FROM Usert1; å†å¯åŠ¨ canal.deployer-1.0.24 å’Œ canal.example-1.0.24 ã€‚ç„¶åå¯ä»¥ä»canal.example-1.0.24çš„logè¾“å‡ºçœ‹åˆ°å¦‚ä¸‹è¾“å‡ºã€‚ä¸‹é¢çš„è¾“å‡ºä¸­ï¼ŒnickNameå·²ç»æ˜¯æ–°åˆ—åï¼Œè€Œä¸”æœ¬æ˜¯updateTimeåˆ—çš„å€¼å˜æˆäº†ageåˆ—çš„å€¼ã€‚ ================> binlog[log-bin.000007:5281]   executeTime : 1507805075000   delay : -17643ms  BEGIN ----> Thread id: 17 ----------------> binlog[log-bin.000007:5407]   name[dbt1 Usert2]   eventType : INSERT   executeTime : 1507805075000   delay : -17638ms userId : 101    type=bigint(20)    update=true nickName : u101    type=varchar(20)    update=true isSystem : 1    type=tinyint(4)    update=true age : 1507805075    type=int(11)    update=true ----------------  END ----> transaction id: 105 æ–°ç‰ˆæœ¬ä¼šæ”¯æŒddlç‰ˆæœ¬å˜æ›´ï¼Œå¯ä»¥éšæ„å›åˆ‡åˆ°ä»»æ„ä½ç‚¹ï¼ŒDDLè¡¨ç»“æ„ä¹Ÿä¼šåŒæ­¥å›æ»š æ–°ç‰ˆæœ¬ä»£ç å·²ç»æäº¤åˆ°master @agapple masteråˆ†æ”¯ç¼–è¯‘æœ‰ç‚¹é—®é¢˜ï¼Œå•¥æ—¶å€™å‡ºæ–°ç‰ˆæœ¬1.0.25ï¼Ÿ ``` [ERROR] Failed to execute goal on project canal.parse: Could not resolve dependencies for project com.alibaba.otter:canal.parse:jar:1.0.25-SNAPSHOT: Failed to collect dependencies at com.alibaba:druid:jar:1.1.5-preview_14: Failed to read artifact descriptor for com.alibaba:druid:jar:1.1.5-preview_14: Could not transfer artifact com.alibaba:druid:pom:1.1.5-preview_14 from/to alibaba (http://code.alibabatech.com/mvn/releases/): Connect to code.alibabatech.com:80 [code.alibabatech.com/119.38.217.15] failed: æ‹’ç»è¿æ¥ (Connection refused) -> [Help 1] [ERROR]  [ERROR] To see the full stack trace of the errors  re-run Maven with the -e switch. [ERROR] Re-run Maven using the -X switch to enable full debug logging. [ERROR]  [ERROR] For more information about the errors and possible solutions  please read the following articles: [ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/DependencyResolutionException ``` åˆ‡æ¢åˆ°druid 1.1.5æ­£å¼ç‰ˆäº† master ç¼–è¯‘æ— æ³•æˆåŠŸ             } else if (isHeartBeat) {                 // å¤„ç†alisqlæ¨¡å¼çš„test.heartbeatå¿ƒè·³æ•°æ® å·²ç»ä¿®å¤ è¯·é—®è€ç‰ˆæœ¬æ€ä¹ˆè·³è¿‡è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ è€ç‰ˆæœ¬åªèƒ½è·³è¿‡æ•°æ®äº† å°è¯•26æœ€æ–°ç‰ˆæœ¬
379,canalæœ‰è€ƒè™‘äº‹åŠ¡å›æ»šçš„Eventå— mysqlçš„binlogæ–‡æ¡£åœ¨ä»‹ç»XID_EVENTæ—¶æœ‰è¿™ä¹ˆä¸€æ®µ > XID_EVENT > Generated for a commit of a transaction that modifies one or more tables of an XA-capable storage engine. Normal transactions are implemented by sending a QUERY_EVENT containing a BEGIN statement and a QUERY_EVENT containing a COMMIT statement (or a ROLLBACK statement if the transaction is rolled back). ä½†æ˜¯æˆ‘çœ‹canal1.24ä»£ç ä¸­è§£æQUERY_EVENTæ—¶ï¼Œåªè€ƒè™‘äº†BEGINå’ŒCOMMITï¼Œå¹¶æ²¡æœ‰è€ƒè™‘ROLLBACKï¼Œè¯·é—®è¿™æ ·åšçš„åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ https://dev.mysql.com/doc/refman/5.7/en/innodb-and-mysql-replication.html è¿™é‡Œåˆæœ‰è¿™ä¹ˆä¸€æ®µå™è¿°ï¼š Transactions that fail on the master do not affect replication at all. MySQL replication is based on the binary log where MySQL writes SQL statements that modify data. A transaction that fails (for example  because of a foreign key violation  or because it is rolled back) is not written to the binary log   è²Œä¼¼å¹¶ä¸ä¼šè®°å½•å›æ»šçš„binlog...æœ‰æ²¡æœ‰ç‰¹åˆ«æ¸…æ¥šçš„äººå‘¢ rollbackä¸ä¼šè®°å½•binlogï¼Œåªæœ‰æäº¤çš„äº‹åŠ¡ä¼šè®°å½•
378,å¯é…ç½®mysql sslè¿æ¥ä¹ˆï¼Ÿ  see title æš‚æ—¶ä¸æ”¯æŒ
377,BINARYç±»å‹è§£æ å¦‚æœæ•°æ®åº“ä¸­æœ‰ä¸€åˆ—ä½¿ç”¨çš„æ˜¯BINARYç±»å‹ï¼Œcolumn.getValue()è·å¾—çš„æ˜¯ä¹±ç ï¼Œè¯·é—®æ€ä¹ˆå¤„ç†ï¼Ÿæ•°æ®åº“é‡Œçš„BINARYæ˜¯ç”¨hexå¤„ç†è¿‡çš„ column.getValue().getBytes("ISO-8859-1")
376,æŒ‡å®šbinlogèµ·å§‹ä½ç½® ä½ ä»¬å¥½ã€‚ æˆ‘ç°åœ¨æƒ³è¦å¯åŠ¨canalåï¼ŒæŠŠç°æœ‰çš„binlogå…¨éƒ¨è¯»å–ï¼Œæ‰€ä»¥æˆ‘éœ€è¦æŒ‡å®šbinlogçš„ä½ç½®ï¼Œä½†æ˜¯å› ä¸ºæƒé™é—®é¢˜ï¼Œæˆ‘æ— æ³•ä½¿ç”¨show binary logsè¯­å¥ï¼Œè¯·é—®æœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•ï¼Œæ¥ä½¿canalè‡ªåŠ¨ä»ç¬¬ä¸€ä¸ªbinlogæ–‡ä»¶å¼€å§‹dumpå‘¢ï¼Ÿ @agapple @luyee  @agapple  å¯èƒ½æ¯”è¾ƒå¿™ è¯´ä¸‹ä½¿ç”¨è¿‡çš„å§¿åŠ¿ ä»ç¬¬ä¸€ä¸ªå¼€å§‹éœ€è¦ä¿ç•™æ‰€æœ‰çš„binlogæ–‡ä»¶ è¿™ä¸ªä¸ç°å®å§ã€‚ã€‚ã€‚ ç”¨è¿‡çš„æ–¹æ¡ˆï¼š 1ï¼Œæ— æ›´æ–°çš„æ—¶æ®µï¼ˆæ¯”å¦‚å‡Œæ™¨3-4ç‚¹ï¼‰ç›´æ¥å…¨é‡å¯¼å…¥+è‡ªåŠ¨è·å–ä½ç‚¹å°±å¥½äº†ã€‚ 2ï¼Œæœ‰æ•°æ®æ›´æ–°çš„æ—¶æ®µï¼š 2.1  ç°åœ¨ä¸€èˆ¬æ˜¯å°è¡¨ç›´æ¥mysqldumpï¼ˆmydumper+myloaderï¼‰ + æŒ‡å®šä½ç‚¹å¢é‡ 2.2 xbackup +æŒ‡å®šä½ç‚¹å¢é‡ï¼Œå¯ä»¥æŒ‡å®šè¡¨æˆ–è€…dbè¿›è¡Œéƒ¨ä»½æ¢å¤ï¼Œä¸è¿‡è¿™ç©æ„æœ‰ç‚¹å‘æ˜¯ï¼ŒæŒ‡å®šæŸäº›è¡¨æ¢å¤ä¹Ÿä¸ç®€å•ï¼Œè²Œä¼¼dbçº§åˆ«æ¢å¤æ˜¯éœ€è¦db serverçš„datadirå¿…é¡»ä¸ºç©º 2.3  3-4ç‚¹ç›´æ¥etlå·¥å…·æŠ½å…¨é‡+è‡ªåŠ¨è·å–ä½ç‚¹ 3ï¼Œæœ€è¿‘å‘ç°äº†[debezium](https://github.com/debezium/debezium) è¿™ä¸ªæ”¯æŒå…¨é‡å¢é‡ç›´æ¥å¯¼å…¥kafkaï¼Œæ­£åœ¨ç ”ç©¶ å…³äºæƒé™ï¼Œæƒé™è¿™ç©æ„æ‰¾dba è¿ç»´å¼€å§ã€‚ã€‚å¤§ä¸äº†å®Œäº†åœ¨æ”¶å›å»å‘—ã€‚ã€‚æˆ–è€…è¦ä»€ä¹ˆ(ä¸€èˆ¬æ˜¯ä½ç‚¹ï¼Œå…¨é‡å¯¼å‡ºå¯¼å…¥) è®©dbaæ“ä½œï¼Œæä¾› æ‹‰å–binlog  éƒ½æ˜¯è¦å¼€å¯æƒé™çš„ï¼Œè¿™ä¸ªæ˜¯å¿…é¡»çš„ï¼Œå‚è€ƒæ–‡æ¡£ï¼š ``` GRANT SELECT  REPLICATION SLAVE  REPLICATION CLIENT ON *.* TO 'canal'@'%'; ``` å—¯ï¼Œç¡®å®ä¸ç°å®ï¼Œå†³å®šé‡‡ç”¨ç›´æ¥å…¨é‡å¯¼å…¥+è‡ªåŠ¨è·å–ä½ç‚¹çš„æ–¹æ¡ˆäº† æ„Ÿè°¢å›ç­”
375,masteråˆ†æ”¯æºç ç¼–è¯‘æŠ¥é”™ çœ‹äº†ä¸‹ï¼Œmasteråˆ†æ”¯æŠŠnetty ç‰ˆæœ¬ä»3.xå‡åˆ°äº†4.xï¼Œnettyçš„åŒ…åå‘ç”Ÿäº†æ”¹å˜ï¼Œä»org.jboss.netty-->io.nettyã€‚ä½†æ˜¯canalä¸­ä½¿ç”¨åˆ°netty apiçš„åœ°æ–¹åŒ…åå¹¶æ²¡æ”¹è¿‡æ¥ï¼Œå¯¼è‡´æŠ¥é”™ã€‚ 1.023 ç‰ˆæœ¬ç”¨çš„netty4.  è¿™ä¸ªç‰ˆæœ¬ä¸ç¨³å®šï¼Œ    1.0.24ç‰ˆæœ¬åˆå›é€€äº†ã€‚ã€‚ã€‚ ç›®å‰æ˜¯ netty3å’Œnetty4éƒ½ä¾èµ–äº†
374,try to avoid use multiline exception directly æƒ³è¦æŠŠcanalæ”¾åˆ°dockeré‡Œé¢ï¼Œç°åœ¨canalæ‰“å°å¼‚å¸¸çš„æ–¹æ³•ä½¿å¾—ä¸å¤ªåˆ©äºdockerçš„fluentdæ”¶é›†ï¼Œå¾ˆå¤šå¼‚å¸¸logçš„æ‰“å°ç›´æ¥ä½¿ç”¨logbackè‡ªå¸¦çš„åŠŸèƒ½å°±å¯ä»¥äº†ï¼Œæ²¡æœ‰å¿…è¦è‡ªå·±æ˜¾å¼è½¬æ¢ï¼Œè¿™ä¹Ÿä½¿å¾—canalä¸dockerçš„ç»“åˆæ›´å®¹æ˜“ä¸€ç‚¹ã€‚ @agapple  [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=374) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=374) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=374) it.</sub> tks
373,meta.bat çš„ä½ç½® meta.bat å­˜å‚¨ä½ç½®åœ¨å“ªé‡Œï¼Ÿ canal serviceè¿æ¥zookeeperï¼Œä½¿ç”¨spring.xml  classpath:spring/default-instance.xml å¦‚æœä½¿ç”¨defaultï¼Œæ•°æ®æ˜¯å­˜å‚¨åœ¨zookeeperçš„
372,canal è®¢é˜…æ¨¡å¼æ•°æ®é‡å¤ªå¤§ï¼ŒæŠŠå†…å­˜æ’‘çˆ†äº†ï¼Œæœ‰canalçš„æœ€ä½³å®è·µä¹ˆï¼Ÿ canal è®¢é˜…æ¨¡å¼æ•°æ®é‡å¤ªå¤§ï¼ŒæŠŠå†…å­˜æ’‘çˆ†äº†ï¼Œæœ‰canalçš„æœ€ä½³å®è·µä¹ˆï¼Ÿ batchsize å¤ªå¤§? è°ƒæ•´æœåŠ¡ç«¯çš„ringbufferå¤§å°
371,springç‰ˆæœ¬2.5.6å’Œåº”ç”¨çš„ç‰ˆæœ¬å†²çªäº†ï¼Œæœ‰ä»€ä¹ˆåŠæ³•å…¼å®¹ä¸‹å—ï¼Ÿ åº”ç”¨ç”¨canal-clientçš„æ–¹å¼ï¼Œåº”ç”¨ç”¨çš„æ˜¯4.xçš„spring  è€Œcanalåœ¨ç”¨çš„æ˜¯2.5.6 spring bootä¼šæŠ¥ï¼š   ``` java.lang.NoSuchMethodError: org.springframework.core.annotation.AnnotationAwareOrderComparator.sort   ```   æœ‰åŠæ³•ç»•è¿‡å— è‡ªé—®è‡ªç­”ã€‚ç”¨ exclusions åº”è¯¥å¯ä»¥è§£å†³ã€‚ @liutaihua è¯·é—®å»æ‰ä¾èµ–åï¼Œç”¨åˆ«çš„ç‰ˆæœ¬çš„springï¼Œcanalä¸ä¼šå‡ºè«åå¥‡å¦™çš„bugå—ï¼Ÿ @agapple è¯·é—®å»æ‰ä¾èµ–åï¼Œç”¨åˆ«çš„ç‰ˆæœ¬çš„springï¼Œcanalä¸ä¼šå‡ºè«åå¥‡å¦™çš„bugå—ï¼Ÿ ä¸ä¼šçš„ï¼Œcanalç”¨çš„springåŠŸèƒ½éå¸¸å°‘
370,è¯·é—®ï¼Œcanalæ”¯æŒå®šæ—¶æ¶ˆè´¹å—ï¼Ÿ è¯·é—®ï¼Œcanalæ”¯æŒå®šæ—¶æ¶ˆè´¹å—ï¼Ÿ æ²¡æœ‰å§ å®šæ—¶rocketmqå¯ä»¥
369,canalæ¶ˆè´¹ç«¯åˆ°æŸä¸ªæ—¶é—´ç‚¹ä¸æ¶ˆè´¹ ç”¨çš„canal/canal-deployer-1.0.24  æœ€æ–°ç‰ˆæœ¬   è®¢é˜…çš„mysqlç‰ˆæœ¬æ˜¯mariadbçš„10.0.22 å‘ç°æ¶ˆè´¹ç«¯è¿è¡Œåˆ°æŸä¸€æ—¶åˆ» zkçš„ä½ç‚¹å’Œæ—¶é—´æˆ³å°±ä¸åœ¨å˜åŒ– è€Œä¸”æ¶ˆè´¹ç«¯çš„è¿›ç¨‹å¹¶æ²¡æœ‰æŒ‚æ‰ ä¹Ÿæ²¡æœ‰å‘ç°é”™è¯¯æ—¥å¿— é‡æ–°å¯åŠ¨è¿›ç¨‹ä¸å¥½ä½¿ å¿…é¡»é‡æ–°ç½®æˆinstance.propertiesçš„æ—¶é—´æˆ³ åˆ æ‰zké‡Œä½ç‚¹ é‡æ–°æ¶ˆè´¹æ‰å¥½ä½¿ ç›¼å›å¤ è°¢è°¢!  æ²¡æ—¥å¿—[å…æ‚²] æ˜¯ä¸æ˜¯é˜»å¡äº†ï¼Ÿ è¿™ä¹ˆè§£å†³çš„ï¼Ÿé‡åˆ°åŒæ ·é—®é¢˜ï¼Œ æ²¡æœ‰æ—¥å¿—å¾ˆæ¼ç«ã€‚å¯ä»¥ç¡®å®šçš„æ˜¯ clientå’Œserverç›´æ¥çš„é—®é¢˜ +1
367,å…³äºè§£æä½ç‚¹å’Œæ¶ˆè´¹ä½ç‚¹çš„zkå­˜å‚¨æœªåˆ°flushæ—¶é—´æ•°æ®ä¸¢å¤±ï¼Ÿ åœ¨default-instance.xml  ä¸­é…ç½®ä¸ºå‘¨æœŸæ€§çš„è¾“å…¥zkï¼Œå¦‚æœåœ¨æœªåˆ°flushæ—¶é—´ï¼ŒserveræŒ‚æ‰ï¼Œå¦å¤–çš„å¤‡æœºå¯åŠ¨ï¼Œè¯»å–çš„ä½ç‚¹è½åäºæœ€æ–°çš„ä½ç‚¹ï¼ˆå› ä¸ºä¸»serveræœªflushåˆ°zkï¼‰ï¼Œè¿™æ ·ä¼šé€ æˆé‡å¤è¯»å–æ•°æ®ï¼Ÿï¼Ÿæ€ä¹ˆåŠï¼Ÿï¼Ÿ åˆ†å¸ƒå¼é«˜å¯ç”¨ç³»ç»Ÿï¼Œä¸å¯èƒ½è®¾è®¡åšåˆ°æ•°æ®ä¸é‡å¤
366,è¿™æ˜¯BUGå—ï¼šcanalè§£æé”™è¯¯fetch failed by table meta:`schemeName`.`tableName` è¿™ä¸ªé—®é¢˜å’Œ#358ç±»ä¼¼ å¦‚æœcanalä»ä¸€ä¸ªæ•°æ®åº“binglogçš„ç¬¬ä¸€æ¡è®°å½•å¼€å§‹è¯»å–ï¼Œé‚£ä¹ˆcanalåœ¨è§£æè¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šå› ä¸ºåœ¨è§£æåˆ°æŸæ¡binlogè®°å½•æ—¶ï¼Œè¯¥è®°å½•å¯¹åº”çš„è¡¨è¢«åˆ æ‰äº†ï¼Œè€Œåœ¨binlogè§£æè¿‡ç¨‹ä¸­canalä¼šå‘é€ä¸€æ¡desc "schemeName.tableName"çš„sqlï¼š private TableMeta getTableMeta0(String fullname) throws IOException {     ResultSetPacket packet = connection.query("desc " + fullname);     return new TableMeta(fullname  parserTableMeta(packet)); } è€Œå¯¹åº”çš„è¡¨å·²ç»è¢«åˆ æ‰ï¼Œè¿™æ—¶å€™å°±ä¼šæŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ï¼Œå¯¼è‡´binlogè¯»å–æ— æ³•ç»§ç»­ä¸‹å» ä¸çŸ¥é“è¿™æ˜¯ä¸æ˜¯ä¸ªbugï¼Ÿæˆ–è€…æ˜¯é€šè¿‡é…ç½®çš„æ–¹æ³•è§£å†³ï¼Ÿæœ‰æ²¡æœ‰é˜¿é‡Œçš„å¤§ä½¬å‡ºæ¥è§£ç­”ä¸€ä¸‹ï¼Ÿ å…·ä½“æ—¥å¿—æ˜¯è¿™æ ·çš„ï¼š 2017-08-10 14:26:56.593 [destination = 10.160.246.137-1379   address = /10.160.246.137:1379   EventParser]369 WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - ERROR ## parse this event has an error   last position : [EntryPosition[included=false journalName= mysql-bin.000003 position=46788142 serverId=1092 timestamp=1493132987000]] com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.collect.ComputationException: com.alibaba.otter.canal.parse.exception.CanalParseException: fetch failed by table meta:`expert`.`bak_TB_ZXJ_ADVICE_COLLECT_ACTIVITY` Caused by: com.google.common.collect.ComputationException: com.alibaba.otter.canal.parse.exception.CanalParseException: fetch failed by table meta:`expert`.`bak_TB_ZXJ_ADVICE_COLLECT_ACTIVITY`         at com.google.common.collect.MapMaker$ComputingMapAdapter.get(MapMaker.java:889)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:78)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:677)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:362)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:108)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:62)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:326)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:176)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:130)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209)         at java.lang.Thread.run(Thread.java:745) Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: fetch failed by table meta:`expert`.`bak_TB_ZXJ_ADVICE_COLLECT_ACTIVITY` Caused by: java.io.IOException: ErrorPacket [errorNumber=1146  fieldCount=-1  message=Table 'expert.bak_TB_ZXJ_ADVICE_COLLECT_ACTIVITY' doesn't exist  sqlState=42S02  sqlStateMarker=#]  with command: desc `expert`.`bak_TB_ZXJ_ADVICE_COLLECT_ACTIVITY`         at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.query(MysqlQueryExecutor.java:60)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:73)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta0(TableMetaCache.java:105)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.access$000(TableMetaCache.java:26)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.apply(TableMetaCache.java:51)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.apply(TableMetaCache.java:42)         at com.google.common.collect.ComputingConcurrentHashMap$ComputingValueReference.compute(ComputingConcurrentHashMap.java:356)         at com.google.common.collect.ComputingConcurrentHashMap$ComputingSegment.compute(ComputingConcurrentHashMap.java:182)         at com.google.common.collect.ComputingConcurrentHashMap$ComputingSegment.getOrCompute(ComputingConcurrentHashMap.java:151)         at com.google.common.collect.ComputingConcurrentHashMap.getOrCompute(ComputingConcurrentHashMap.java:67)         at com.google.common.collect.MapMaker$ComputingMapAdapter.get(MapMaker.java:885)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:78)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:677)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:362)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:108)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:62)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:326)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:176)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:130)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209)         at java.lang.Thread.run(Thread.java:745) ä»€ä¹ˆé—®é¢˜ è¿™æ˜¯ è§£å†³äº†å—ï¼Ÿ ç°åœ¨è§£å†³äº†ï¼Œå¯ä»¥é€šè¿‡é…ç½®filterTableError=trueæ¥å¿½ç•¥æ‰è¿™ä¸ªå¼‚å¸¸ï¼Œè¿™æ ·instanceçš„çº¿ç¨‹å°±å¯ä»¥ç»§ç»­è¿è¡Œä¸‹å» æˆ‘ä¹Ÿé‡åˆ°è¿™ä¸ªé—®é¢˜äº† è¯·é—®è¿™ä¸ªfilterTableError=true åœ¨å“ªä¸ªåœ°æ–¹åŠ çš„ ç›´æ¥æ·»åŠ filterTableError=true? @liutizhong æˆ‘ä½¿ç”¨çš„æ˜¯CanalInstanceWithManagerï¼Œåªè¦åœ¨å®ƒçš„é…ç½®CanalParameterä¸­è®¾ç½®å°±è¡Œäº† ä»£ç å¤§ä½“ä¸Šæ˜¯è¿™æ ·ï¼š CanalParameter parameter = new CanalParameter; parameter.setFilterTableError(true); Canal canal = new Canal(); canal.setCanalParameter(parameter); æœ€ååœ¨new CanalInstanceæ—¶ï¼š new CanalInstanceWithManager(canal  filter); @liutizhong å¯ä»¥ç›´æ¥åœ¨é…ç½®æ–‡ä»¶é…ç½® canal.instance.filter.table.error =true 6666666666ğŸ˜ 2017-11-22 11:41 GMT+08:00 yuxie <notifications@github.com>: > @liutizhong <https://github.com/liutizhong> å¯ä»¥ç›´æ¥åœ¨é…ç½®æ–‡ä»¶é…ç½® > canal.instance.filter.table.error =true > > â€” > You are receiving this because you commented. > Reply to this email directly  view it on GitHub > <https://github.com/alibaba/canal/issues/366#issuecomment-346234373>  or mute > the thread > <https://github.com/notifications/unsubscribe-auth/AWRZFY2hQZ-z-4GZKhxsDL64GgwgKF5Dks5s45fSgaJpZM4OzTks> > . > ç‰›é€¼ æˆ‘ä¹Ÿé‡åˆ°è¿™ä¸ªé—®é¢˜äº†ï¼Œotteré…ç½®æ–‡ä»¶é‡Œé¢è¯¥åŠ åœ¨å“ªï¼Ÿ canal.instance.filter.table.error =trueå»å¿½ç•¥è¡¨é”™è¯¯ è°¢è°¢åˆ†äº«ï¼Œç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶canal.instance.filter.table.error =true å¿½ç•¥äº†å¼‚å¸¸
365,heartbeatHaEnableè®¾ç½®æˆtrueï¼Œä½†æ˜¯æ²¡æœ‰standbyçš„mysqlé…ç½®çš„æ—¶å€™ï¼ŒæˆåŠŸå¯åŠ¨ heartbeatHaEnableè®¾ç½®æˆtrueï¼Œä½†æ˜¯æ²¡æœ‰standbyçš„mysqlé…ç½®çš„æ—¶å€™ï¼ŒæˆåŠŸå¯åŠ¨ã€‚ä½†æ˜¯åšmysql stop & startåŠ¨ä½œçš„æ—¶å€™ï¼Œç”±äºparserä¼šåšswitchæ“ä½œï¼Œè¿™ä¸ªæ“ä½œä¼šé€ æˆç©ºæŒ‡é’ˆé€€å‡ºã€‚ç”±äºè¿™ä¸ªç©ºæŒ‡é’ˆæ˜¯åœæ­¢äº†å¿ƒè·³çº¿ç¨‹å’Œè§£æçº¿ç¨‹ä¹‹åï¼Œå¯åŠ¨æ–°çš„å¿ƒè·³å’Œè§£æçº¿ç¨‹ä¹‹å‰ï¼Œæ‰€ä»¥canalæ²¡æ³•ç»§ç»­dumpæ¶ˆæ¯ã€‚ ç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Ÿ
364,maven update Missing artifact com.alibaba.otter:canal.instance.core:jar:1.0.25-SNAPSHOT è¯·é—®è¿™ä¸ªå¦‚ä½•è§£å†³ï¼Œæˆ‘ä»masteræŠ“äº†æœ€æ–°çš„ä»£ç ï¼Œè¿›è¡Œmavençš„updateçš„æ—¶å€™ï¼Œæç¤º Missing artifact com.alibaba.otter:canal.instance.core:jar:1.0.25-SNAPSHOT Missing artifact com.alibaba.otter:canal.instance.manager:jar:1.0.25-SNAPSHOT Missing artifact com.alibaba.otter:canal.instance.spring:jar:1.0.25-SNAPSHOT æœ¬æ¥å°±æ˜¯1.0.25-SNAPSHOT ä½•æ¥Missï¼Ÿ å…ˆåœ¨ canal  æ ¹ç›®å½• run ``` mvn clean mvn install ```
363,canalæœ‰è®¡åˆ’æ”¯æŒç±»ä¼¼mysql5.7ä¸­ç»„æäº¤ç±»ä¼¼çš„åŠŸèƒ½ä¹ˆï¼Ÿ mysqlå‡çº§5.7åï¼Œç”±äºä¸»ä»åŒæ­¥æ€§èƒ½æé«˜ï¼Œ ä¸»åº“å†™å…¥qpsçš„é™åˆ¶ä¹Ÿéšä¹‹é™ä½ï¼Œè¿™æ ·å¸¦æ¥ä¸€ä¸ªé—®é¢˜å°±æ˜¯ä¸šåŠ¡å†™å…¥é€Ÿåº¦åŠ å¿«ï¼Œå¯èƒ½ä¼šå¿«äºæˆ‘ä»¬æ”¶é›†çš„é€Ÿåº¦ï¼Œè¿™æ ·å¯èƒ½æ— æ³•ä½œåˆ°å®æ—¶æ”¶é›†äº†ã€‚canalæœ‰è®¡åˆ’æ”¯æŒmysql5.7æåˆ°çš„ç»„æäº¤å—ï¼Ÿ canalæ˜¯ä»¥binlogå†™å…¥ä¹‹åä¸ºå‡†ï¼Œä¸å…³å¿ƒmysqlçš„ç»„æäº¤çš„
362,mavenæŸ¥çœ‹æºç ä¹±ç  æ‰€æœ‰jaråŒ…é€šè¿‡mavenæŸ¥çœ‹æºç æ—¶å…¶ä¸­æ–‡æ³¨é‡Šå…¨éƒ¨ä¹±ç ï¼Œèƒ½è§£å†³æ­¤ä¹±ç é—®é¢˜å—ï¼Ÿ utf8ç¼–ç 
361,å³ä½¿è®¾å®šäº†defaultDatabaseNameä¾ç„¶ä»å®¢æˆ·ç«¯è·å–å…¶ä»–æ•°æ®åº“çš„å¢é‡ï¼Ÿ defaultDatabaseNameä¸æ˜¯ç”¨æ¥è¿‡æ»¤æ•°æ®ç”¨çš„ï¼Œç›®å‰æ˜¯æ— æ„ä¹‰çš„å‚æ•°
360,SocketChannelPool bug è¿è¡Œæ—¥å¿—ï¼Œè¯·å…³æ³¨æœ€åä¸€è¡Œ ```` 2017-08-08 09:59:07.224 [destination = example   address = /127.0.0.1:3306   EventParser] DEBUG io.netty.util.NetUtil - -Djava.net.preferIPv4Stack: false 2017-08-08 09:59:07.224 [destination = example   address = /127.0.0.1:3306   EventParser] DEBUG io.netty.util.NetUtil - -Djava.net.preferIPv6Addresses: false 2017-08-08 09:59:07.313 [destination = example   address = /127.0.0.1:3306   EventParser] DEBUG io.netty.util.NetUtil - Loopback interface: lo (Software Loopback Interface 1  127.0.0.1) 2017-08-08 09:59:07.317 [destination = example   address = /127.0.0.1:3306   EventParser] DEBUG io.netty.util.NetUtil - \proc\sys\net\core\somaxconn: 200 (non-existent) 2017-08-08 09:59:07.403 [destination = example   address = /127.0.0.1:3306   EventParser] DEBUG io.netty.channel.DefaultChannelId - -Dio.netty.machineId: 00:00:00:00:00:00:00:e0 (auto-detected) 2017-08-08 09:59:07.404 [destination = example   address = /127.0.0.1:3306   EventParser] DEBUG io.netty.util.internal.ThreadLocalRandom - -Dio.netty.initialSeedUniquifier: 0xfe50d10b389fdd4b 2017-08-08 09:59:07.482 [destination = example   address = /127.0.0.1:3306   EventParser] DEBUG io.netty.buffer.ByteBufUtil - -Dio.netty.allocator.type: pooled 2017-08-08 09:59:07.483 [destination = example   address = /127.0.0.1:3306   EventParser] DEBUG io.netty.buffer.ByteBufUtil - -Dio.netty.threadLocalDirectBufferSize: 65536 2017-08-08 09:59:07.483 [destination = example   address = /127.0.0.1:3306   EventParser] DEBUG io.netty.buffer.ByteBufUtil - -Dio.netty.maxThreadLocalCharBufferSize: 16384 2017-08-08 09:59:17.547 [destination = example   address = /127.0.0.1:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - connect MysqlConnection to /127.0.0.1:3306... ```` ````java public static SocketChannel open(SocketAddress address) throws Exception {         final SocketChannel socket = new SocketChannel();         boot.connect(address).addListener(new ChannelFutureListener() {             @Override             public void operationComplete(ChannelFuture arg0) throws Exception {                 if (arg0.isSuccess()) socket.setChannel(arg0.channel());                 synchronized (socket) {                     socket.notify();    // <--------------------                 }             }         });         synchronized (socket) {             socket.wait();  // <--------------------         }         if (null == socket.getChannel()) {             throw new IOException("can't create socket!");         }         chManager.put(socket.getChannel()  socket);         return socket;     } ```` notifyæ˜¯æœ‰å¯èƒ½ä¼šæ¯”waitæå‰æ‰§è¡Œçš„ï¼Œå»ºè®®ä¼˜åŒ–ä¸‹ 
359,å…³äºmysqlåˆ‡ä¸»çš„é—®é¢˜ æˆ‘ä»¬è¿™è¾¹æœ‰ä¸€ç§åœºæ™¯ï¼Œmysqlæ˜¯ä¸€ä¸»ä¸¤ä»ï¼Œcanalä»ä¸»dump binlogï¼Œä½†æ˜¯åˆ‡ä¸»çš„è¯æˆ‘ä»¬æ˜¯åˆ‡åŸŸåï¼ŒåŸŸåä¸å˜ï¼ŒæŠŠåŸŸåæŒ‚çš„ipæ”¹å˜ï¼Œè¿™ç§æƒ…å†µä¸‹canal  æ˜¯è¦é‡å¯ï¼Ÿï¼Ÿ éœ€è¦ã€‚mysql ä¸»ä»  ä½ç‚¹ ï¼Œæ–‡ä»¶å éƒ½ä¸ä¸€æ ·ï¼Œéœ€è¦äººè‚‰ä¿®æ”¹åˆ° ä»åº“çš„ æ–‡ä»¶å ï¼Œä½ç‚¹ã€‚æ³¨æ„è¦ä¿è¯ canal è¿æ¥åˆ° æ–°ip ä¸Šï¼Œç¡®ä¿ä¸»åº“ æ— å†™å…¥ è€Œä¸”åŒæ­¥åˆ° ä»åº“å æ‰èƒ½ åˆ‡æ¢ã€‚å¾ˆå¤šç»†èŠ‚è¦æ³¨æ„ã€‚ æ–°ç‰ˆæœ¬å·²ç»æ”¯æŒå•vipçš„æ¨¡å¼ï¼Œä¼šè®°å½•ä¸Šä¸€æ¬¡çš„serverIdï¼Œæ•°æ®åº“ä¸»å¤‡åˆ‡æ¢æ—¶ä¼šåˆ¤æ–­serverIdæ˜¯å¦ç›¸åŒï¼Œä¸åŒåˆ™ä¼šè‡ªåŠ¨è¿›è¡Œä½ç‚¹åˆ‡æ¢ @agapple è¯·é—®égtidçš„æƒ…å†µä¸‹ï¼Œcanalæ€ä¹ˆè¿›è¡Œè‡ªåŠ¨æ‰¾åˆ°æ­£ç¡®çš„binlog file&posï¼Ÿ åŸºäºæ—¶é—´æˆ³ å…·ä½“æ˜¯ä»€ä¹ˆåŸç†å‘¢ï¼ŸåŒä¸€ä¸ªeventï¼Œåœ¨æ–°masterä¸Šçš„timestampï¼Œå·²ç»å’Œæ—§masterä¸Šçš„å·²ç»ä¸åŒçš„å§ï¼Œåªæœ‰evnetçš„serveridè¿˜æ˜¯ä¿æŒä¸å˜ã€‚ åŒé—®ï¼Œåœ¨æ–°masterä¸Šçš„timestampï¼Œå·²ç»å’Œæ—§masterä¸Šçš„å·²ç»ä¸åŒçš„å§ï¼Ÿæ€ä¹ˆèƒ½ç¡®å®šlog positionï¼Ÿ ä¼šé€šè¿‡timestmapåœ¨å¤‡åº“ä¸ŠäºŒåˆ†æŸ¥æ‰¾åˆ°å¯¹åº”çš„binlogï¼Œæœ€æ¥è¿‘è¯¥timestampçš„binlogäº‹ä»¶ï¼Œä»¥å®ƒä¸ºèµ·å§‹ä½ç‚¹è¿›è¡Œå¤‡åº“æ¶ˆè´¹ã€‚ è¿™é‡Œçš„ä¸€ä¸ªå‡å®šä¸»å¤‡åº“çš„æ—¶é—´æ˜¯æœ‰NTPåŒæ­¥ä¿è¯çš„ï¼Œä¸ä¼šç›¸å·®è¶…è¿‡60ç§’(é»˜è®¤å€¼) æˆ‘çœ‹ä»£ç ä¸»å¤‡åº“åˆ‡æ¢ï¼Œæ ¹æ®timestmapå‰æ¨äº†60sï¼Œè¿™æ ·å¯èƒ½ä¼šé‡å¤æ¶ˆè´¹å§ï¼Ÿ æ˜¯å¦å¯ä»¥æ¶ˆè´¹çš„æ—¶å€™è®°å½•æœ€æ–°çš„entryï¼Œåœ¨ä¸»å¤‡åº“åˆ‡æ¢çš„æ—¶å€™ï¼Œå‰æ¨60sï¼Œå†é€šè¿‡MD5æˆ–è€…hashï¼ˆentry)æ‰¾åˆ°å¤‡åº“æœ€æ–°æ¶ˆè´¹çš„entryï¼Œç¡®å®šç‚¹ä½ï¼Œç„¶åå†æ¶ˆè´¹ï¼Œè¿™æ ·æ˜¯ä¸æ˜¯å°±ä¸ä¼šé‡å¤æ¶ˆè´¹äº†ï¼Ÿ
358,canalè§£æé”™è¯¯fetch failed by table meta:`test`.`test` è¯·é—®è¿™ç§é”™è¯¯æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥è§£å†³å‘¢ï¼Ÿè°¢è°¢ï¼ com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.collect.ComputationException: com.alibaba.otter.canal.parse.exception.CanalParseException: fetch failed by table meta:`test`.`test` Caused by: com.google.common.collect.ComputationException: com.alibaba.otter.canal.parse.exception.CanalParseException: fetch failed by table meta:`test`.`test` 	at com.google.common.collect.MapMaker$ComputingMapAdapter.get(MapMaker.java:889) ~[guava-18.0.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:78) ~[canal.parse-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:677) ~[canal.parse-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:362) ~[canal.parse-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:108) ~[canal.parse-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:62) ~[canal.parse-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:326) ~[canal.parse-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:176) ~[canal.parse-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:130) [canal.parse-1.0.24.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) [canal.parse-1.0.24.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_91] æˆ‘ä¹Ÿç¢°åˆ°è¿™ä¸ªé”™è¯¯äº† æˆ‘æ‰¾åˆ°äº†åŸå› ï¼Œè¿™æ˜¯å› ä¸ºåœ¨è§£ææŸæ¡binlogè®°å½•æ—¶ï¼Œè¯¥è®°å½•å¯¹åº”çš„è¡¨è¢«åˆ æ‰äº†ï¼Œè€Œåœ¨binlogè§£æè¿‡ç¨‹ä¸­canalä¼šå‘é€ä¸€æ¡desc `schemeName`.`tableName`çš„sqlè¯­:     private TableMeta getTableMeta0(String fullname) throws IOException {         ResultSetPacket packet = connection.query("desc " + fullname);         return new TableMeta(fullname  parserTableMeta(packet));     } è€Œå¯¹åº”çš„è¡¨å·²ç»è¢«åˆ æ‰ï¼Œè¿™æ—¶å€™å°±ä¼šæŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ ä½†æ˜¯æ²¡æ‰¾åˆ°å¦‚ä½•è§£å†³è¿™ä¸ªæ–¹æ³•ï¼Œä¸çŸ¥é“è¿™æ˜¯ä¸æ˜¯ä¸ªbugï¼Ÿæœ‰æ²¡æœ‰é˜¿é‡Œçš„å¤§ä½¬å‡ºæ¥è§£ç­”ä¸€ä¸‹ï¼Ÿ è¯•è¯• canal/conf ä¸‹çš„ canal.instance.filter.black.regex = test.* å°è¯•ä¸€ä¸‹æœ€æ–°ç‰ˆçš„ï¼Œå¯ç”¨TSDBå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜
357,å¤šå®¢æˆ·ç«¯è®¢é˜…é—®é¢˜è¯·æ•™ å¤šä¸ªcanalå®¢æˆ·ç«¯è®¢é˜…ä¸€ä¸ªcanalæœåŠ¡ï¼Œå…¶ä¸­ä¸€ä¸ªå®¢æˆ·ç«¯è¿›è¡Œå–æ¶ˆè®¢é˜…æ“ä½œï¼Œå…¶ä»–canalå®¢æˆ·ç«¯æŠ›å¼‚å¸¸ï¼Œä¼šä¸ä¼šå½±å“å…¶ä»–å®¢æˆ·ç«¯çš„è®¢é˜…ã€æ¶ˆæ¯æ¥æ”¶ã€‚ @agapple  å»ºè®®åªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯è¿›è¡Œæ¶ˆè´¹ï¼Œå¦åˆ™æ•°æ®é¡ºåºæ²¡æ³•ä¿è¯ @agapple å¦‚æœå®¢æˆ·ç«¯èƒ½è‡ªå·±ä¿è¯é¡ºåºæ¶ˆè´¹ï¼Œå¯¹äºå¤šå®¢æˆ·ç«¯è®¢é˜…åŒä¸€ä¸ªæœåŠ¡ï¼Œå…¶ä¸­ä¸€ä¸ªå®¢æˆ·ç«¯è°ƒç”¨unsubscribe() å¯¼è‡´å…¶ä»–å®¢æˆ·ç«¯æŠ›å¼‚å¸¸äº†ï¼Œæ­¤æ—¶ä¼šå½±å“å…¶ä»–å®¢æˆ·ç«¯çš„è®¢é˜…åŠæ¶ˆæ¯è·å–å—ï¼Ÿ ç›®å‰æ˜¯ä¼šå½±å“å…¶ä»–å®¢æˆ·ç«¯çš„ @agapple  å®æµ‹è¿‡ï¼Œç¡®å®å½±å“ï¼Œæ„Ÿè°¢ã€‚ @agapple canalèƒ½ä»RDSä¸­è·å–æ•°æ®å— å¯ä»¥è®¢é˜…RDS @agapple æ„Ÿè°¢ã€‚161559791è¿™ä¸ªç¾¤ä¸èƒ½åŠ å…¥äº†ï¼Œæˆ‘çš„QQï¼š295826395ï¼Œèƒ½å¦æŠŠæˆ‘æ‹‰è¿›å»å‘¢ï¼Œè°¢å•¦ã€‚ @NPCSun ç¾¤å·²ç»å¯ä»¥åŠ äº† æˆ‘ç°åœ¨ä½¿ç”¨æ–¹å¼æ˜¯å…ˆå†™å…¥ Redis å†è¿›è¡Œæ¶ˆè´¹è®¢é˜…ã€‚
356,canalå¼‚å¸¸æ±‚è§£ com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.collect.ComputationException: com.alibaba.otter.canal.parse.exception.CanalParseException: fetch failed by table meta:`mysql`.`ha_health_check` Caused by: com.google.common.collect.ComputationException: com.alibaba.otter.canal.parse.exception.CanalParseException: fetch failed by table meta:`mysql`.`ha_health_check` 	at com.google.common.collect.MapMaker$ComputingMapAdapter.get(MapMaker.java:889) ~[guava-18.0.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:70) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:645) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:357) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:111) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:62) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:327) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:177) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:121) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) ~[canal.parse-1.0.22.jar:na] 	at java.lang.Thread.run(Thread.java:722) [na:1.7.0_10] canalç‰ˆæœ¬æ˜¯1.0.22ï¼Œä¸çŸ¥é“è¿™ä¸ªå¼‚å¸¸æ˜¯ä»€ä¹ˆæ„æ€ï¼Œæ±‚å¤§ç¥å¸®å¿™è§£ç­”ä¸‹ æ±‚è§£ï¼Œæˆ‘ä¹Ÿæ˜¯é‡åˆ°è¿™ç§é—®é¢˜ å‡çº§ç‰ˆæœ¬å§ï¼Œä¿®å¤è¿‡ æˆ‘ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ä¹Ÿæ˜¯æŠ¥è¿™æ ·çš„é”™è¯¯ï¼Œè¯·é—®æœ‰ä»€ä¹ˆè§£å†³åŠæ³•å—
355,å½“æ•°æ®åº“æœ‰å¤§é‡çš„åˆ é™¤æ—¶ï¼Œcanalè§£æå˜æ…¢ å½“æ•°æ®åº“æœ‰å¤§é‡çš„åˆ é™¤æ—¶ï¼Œcanalè§£æå˜æ…¢ï¼Œä¹‹å‰æ¯ä¸ªå°æ—¶å¯ä»¥è§£æ5ä¸‡ï¼Œæœ‰å¤§é‡åˆ é™¤åæ¯ä¸ªå°æ—¶æ‰100æ¡ï¼Œè¯·é—®æœ‰ä»€ä¹ˆå¯ä»¥è§£å†³æ–¹æ³•å—ï¼Ÿè°¢è°¢ è¿™ä¸ªå’Œ#267 æ˜¯åŒä¸€ç±»é—®é¢˜ mysqlé…ç½®å¦‚ä¸‹å‚æ•°ï¼šinnodb_flush_log_at_trx_commit åœ¨æäº¤äº‹åŠ¡çš„æ—¶å€™æ˜¯å¦æäº¤ç¼“å†²? æœ‰3ä¸ªå€¼ï¼š 0ï¼šä¸ä¼šä¸»åŠ¨è§¦å‘æ—¥å¿—ç¼“å†²å†™å…¥ç£ç›˜ 1ï¼ˆé»˜è®¤ï¼‰ï¼šæ¯æ¬¡æäº¤äº‹åŠ¡çš„æ—¶å€™ï¼ŒåŒæ—¶ä¼šæŠŠæ—¥å¿—ç¼“å†²åˆ·æ–°åˆ°ç£ç›˜ 2ï¼šæ¯æ¬¡æäº¤äº‹åŠ¡çš„æ—¶å€™ï¼Œä¼šæŠŠæ—¥å¿—ç¼“å†²åˆ·æ–°åˆ°ç£ç›˜ï¼Œä½†æ˜¯ä»–ä¸æ˜¯åŒæ—¶è¿›è¡Œçš„ è€Œæ˜¯æ¯ç§’é’Ÿåˆ·æ–°ä¸€æ¬¡ å»ºè®®é…ç½®æˆ2 ï¼Œå¯¹æ€§èƒ½å½±å“è¾ƒå¤§ã€‚ å¯ä»¥è¯•è¯•è¿™ä¸ª
354,å¯åŠ¨canclï¼Œè¿æ¥æ•°æ®åº“è¿æ¥ä¸ä¸Š 2017-08-01 09:27:36.766 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [canal.properties] 2017-08-01 09:27:36.770 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [example/instance.properties] 2017-08-01 09:27:36.850 [main] WARN  org.springframework.beans.TypeConverterDelegate - PropertyEditor [com.sun.beans.editors.EnumEditor] found through deprecated global PropertyEditorManager fallback - consider using a more isolated form of registration  e.g. on the BeanWrapper/BeanFactory! 2017-08-01 09:27:36.971 [main] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start CannalInstance for 1-example  2017-08-01 09:27:36.987 [main] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - start successful.... 2017-08-01 09:27:44.004 [destination = example   address = /192.168.**.**:****   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /192.168.30.46:3306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: connect /192.168.**.**:**** failure:java.net.ConnectException: Connection timed out 	at sun.nio.ch.Net.connect0(Native Method) 	at sun.nio.ch.Net.connect(Net.java:364) 	at sun.nio.ch.Net.connect(Net.java:356) 	at sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:623) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:70) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:56) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:86) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:157) 	at java.lang.Thread.run(Thread.java:722) æŠ¥é”™ä¿¡æ¯å¦‚ä¸Šï¼Œæˆ‘ä¸çŸ¥é“æ˜¯ä¸æ˜¯è¿™ä¸ª/çš„é—®é¢˜ï¼Œä½†æ˜¯æˆ‘åœ¨é…ç½®æ–‡ä»¶å¹¶æ²¡æœ‰/çš„ï¼Œçœ‹äº†æºç ä¹Ÿæ²¡æœ‰ï¼Œä¸çŸ¥é“æ˜¯ä»€ä¹ˆåŸå› ï¼Œæ±‚åŠ©ï¼ï¼ï¼ï¼ä¸‡åˆ†æ„Ÿè°¢ è¿™ä¸ªè‚¯å®šæ˜¯è‡ªå·±è¿æ¥æœ‰é—®é¢˜ï¼Œå¦å¤–ï¼Œ1.0.24 è¿˜æ˜¯åˆ«ç”¨çš„å¥½ã€‚ã€‚ã€‚
353,canalå¦‚ä½•é…ç½®å¤šä¸ªæ•°æ®åº“ä¸‹çš„è¡¨ è¯·é—®ä¸‹ï¼Œcanalå¦‚ä½•æŒ‡å®šè®¢é˜…å‡ ä¸ªæ•°æ®åº“çš„è‹¥å¹²è¡¨ï¼Œæ¯”å¦‚æˆ‘åªè®¢é˜… oschinaåº“ä¸‹çš„orderè¡¨å’Œoschina_userä¸‹çš„userè¡¨ ç¿»ç¿»ä¹‹å‰çš„issue æ­£ç¡®çš„å§¿åŠ¿åº”è¯¥æ˜¯clientå†™å…¥filter see https://github.com/alibaba/canal/issues/311  å¤šä¸ªåº“ï¼Ÿ é‚£æ˜¯canal server é…ç½® å¤šä¸ªinstanceå§
352,canal  æŠ¥é”™ï¼š  Read Q_FLAGS2_CODE error: limit excceed: 63 å¤§æ•°æ®é‡çš„æ‰¹é‡æ’å…¥ ç±»ä¼¼select into çš„sql ï¼ˆ10wæ¡è®°å½•ï¼‰ï¼Œcanal æŠ¥é”™ï¼š pid:1 nid:2 exception:canal:canal_master:java.io.IOException: Read Q_FLAGS2_CODE error: limit excceed: 63 at com.taobao.tddl.dbsync.binlog.event.QueryLogEvent.unpackVariables(QueryLogEvent.java:650) at com.taobao.tddl.dbsync.binlog.event.QueryLogEvent.(QueryLogEvent.java:477) at com.taobao.tddl.dbsync.binlog.LogDecoder.decode(LogDecoder.java:154) at com.taobao.tddl.dbsync.binlog.LogDecoder.decode(LogDecoder.java:106) at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:123) at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) at java.lang.Thread.run(Thread.java:745) Caused by: java.lang.IllegalArgumentException: limit excceed: 63 at com.taobao.tddl.dbsync.binlog.LogBuffer.getUint32(LogBuffer.java:561) at com.taobao.tddl.dbsync.binlog.event.QueryLogEvent.unpackVariables(QueryLogEvent.java:563) ... 6 more æŠ¥å‘Šä¸€ä¸‹mysqlå’Œcanalç‰ˆæœ¬ æˆ‘è¿™è¾¹ä¹Ÿæœ‰è¿™ä¸ªé—®é¢˜ canalæ˜¯1.0.22ï¼ŒMysqlæ˜¯5.7.12-5-log  @jwcjlu å…ˆæµ‹è¯•ä¸€ä¸‹1.0.26ç‰ˆæœ¬è¯•è¯• æµ‹è¯•è¿‡äº†1.0.25å°±æ²¡æœ‰é—®é¢˜äº†
351,batchSizeæŒ‡ä»€ä¹ˆ æ‚¨å¥½ï¼Œè¯•äº†ä¸‹ æœ‰é˜»å¡çš„getWithoutAckï¼Œå‘ç°åœ¨æ›´æ–°åˆ°å¾ˆå¤šæ¬¡çš„æ—¶å€™æ‰ä¼šæ‰“å°(example)ï¼Œä½†æ˜¯batchSizeè®¾ç½®çš„æ˜¯1. æœ‰ç‚¹ä¸å¤ªæ˜ç™½ï¼ŒbatchSizeåˆ°åº•æŒ‡çš„æ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¥ä¸ºæ˜¯ä¸€æ¬¡ä¿®æ”¹ï¼Œç›®å‰çœ‹åº”è¯¥ä¸æ˜¯çš„ã€‚ Batch Id: [3]  count : [33]   memsize : [1050]   Time : 2017-07-29 23:52:08 * Start : [mysql-bin.000003:17576:1501343167000(2017-07-29 23:46:07)]  * End : [mysql-bin.000003:19943:1501343529000(2017-07-29 23:52:09)]  è¿™æ˜¯æ‰“å°çš„æ—¥å¿—ã€‚  éº»çƒ¦~ batchSize æ˜¯åœ¨clientç«¯è®¾ç½®çš„ï¼Œè¿™ä¸ªå‚æ•°ä½œç”¨æ˜¯æ§åˆ¶ æ¯æ¬¡ä»serverç«¯çš„storeä¸­getæ•°æ®çš„size é‚£è¿™ä¸ªå¹¶ä¸ç­‰äº   æ•°æ®åº“çš„ä¸€æ¬¡ä¿®æ”¹æ˜¯æŠŠï¼Ÿå› ä¸ºä¸Šé¢çœ‹çš„ï¼Œä¸€æ¬¡æœ‰33ä¸ªentriesã€‚  è¿™ä¸ªæ˜¯åœ¨ä»€ä¹ˆæƒ…å†µä¸‹serveræ‰ä¼šæœ‰ä¸€æ¡æ•°æ®å•Š æ˜¯å•Šï¼Œæˆ‘ä¹Ÿä¸æ˜¯å¾ˆæ˜ç™½batchSizeå…·ä½“çš„ä½œç”¨ã€‚å½“æˆ‘è®¾ç½®batchSize=1çš„æ—¶å€™ï¼Œæ¯æ¬¡æ‹‰å–åˆ°çš„Messageé‡Œé¢ï¼Œæ˜¯æœ‰å¤šä¸ªentryçš„ã€‚ batchSizeæ˜¯åˆšå¥½è¶…è¿‡è¿™ä¸ªå¤§å°çš„ï¼Œæœ€åˆé€‚çš„è®°å½•æ•°.  æœ€å°æ˜¯1ä¸ªMessage @agapple å—¯å—¯ï½è°¢è°¢å•¦
350,canalè§£æjsonç±»å‹å‡ºé”™ å’Œ#330ä¸­æåˆ°çš„é—®é¢˜ä¸€è‡´ï¼Œmysqlç‰ˆæœ¬æ˜¯5.7 sqlå¦‚ä¸‹ï¼š a='"a"'+' "a"'*30000 sql="insert into canal_json_test(j_json) values('[%s]')" % (a) å³ä¸€ä¸ªjsonå­—æ®µçš„å€¼ä¸º'["a" "a" "a"â€¦â€¦]' å…±30001ä¸ªaï¼Œå¯ä»¥æ­£å¸¸æ’å…¥mysqlï¼Œä½†æ˜¯canalè§£æè¿™ä¸ªå‡ºé”™äº† å’Œ#330ä¸­æåˆ°çš„é—®é¢˜ä¸€è‡´ï¼Œ sqlå¦‚ä¸‹ï¼š a='"a"'+' "a"'*30000 sql="insert into canal_json_test(j_json) values('[%s]')" % (a) å³ä¸€ä¸ªjsonå­—æ®µçš„å€¼ä¸º'["a" "a" "a"â€¦â€¦]' å…±30001ä¸ªaï¼Œå¯ä»¥æ­£å¸¸æ’å…¥mysqlï¼Œä½†æ˜¯canalè§£æè¿™ä¸ªå‡ºé”™äº† æˆ‘å°½å¿«ä¿®å¤ä¸€ä¸‹ï¼Œåº”è¯¥ä¸éš¾ æˆ‘å·²ç»è¯•ç€ä¿®å¤äº†ï¼Œåº”è¯¥æ˜¯è·å–jsonå€¼é•¿åº¦çš„æ—¶å€™ç”¨äº†getUnit16å¯¼è‡´çš„ï¼Œåº”è¯¥æ˜¯ç”¨getUnit32å§
349,å…³äºè§£æMysql5.7ä¸­jsonç±»å‹çš„ä¸€äº›ç–‘é—® case LogEvent.MYSQL_TYPE_JSON: {                 len = buffer.getUint16();                 buffer.forward(meta - 2);                 int position = buffer.position();                 JsonConversion.Json_Value jsonValue = JsonConversion.parse_value(buffer.getUint8()  buffer  len - 1  charsetName);                 StringBuilder builder = new StringBuilder();                 jsonValue.toJsonString(builder  charsetName);                 value = builder.toString();                 buffer.position(position + len);                 // byte[] binary = new byte[len];                 // buffer.fillBytes(binary  0  len);                 // value = binary;                 javaType = Types.VARCHAR;                 length = len;                 break;             } è¿™éƒ¨åˆ†æ˜¯è§£æjsonç±»å‹çš„ä»£ç ï¼Œå…¶ä¸­ä¸ç†è§£ï¼š 1.buffer.forward(meta - 2);è¿™é‡Œä¸ºä»€ä¹ˆè¦å›é€€ 2.JsonConversion.Json_Value jsonValue = JsonConversion.parse_value(buffer.getUint8()  buffer  len - 1  charsetName);  è¿™é‡Œä¸ºä»€ä¹ˆæ˜¯len-1ã€‚ æœ›å¤§ç¥è§£ç­”å•Š @agapple
348,canal serveråœç”¨ä¸€ä¸ªæœˆåï¼Œé‡æ–°å¯ç”¨æŠ¥é”™    canal serveråœç”¨ä¸€ä¸ªæœˆåï¼Œé‡æ–°å¯ç”¨æŠ¥é”™ï¼Œæ‰¾ä¸åˆ°ä¹‹å‰è§£ææ–‡ä»¶ä½ç½®ï¼Œè¯·é—®canalå½“æ‰¾ä¸åˆ°åŸæ¥å·²è§£æè¿‡çš„æ–‡ä»¶ä½ç½®æ—¶ï¼Œä¸èƒ½ä»æœ€æ–°ä½ç½®å¼€å§‹è§£æå—ï¼Ÿè°¢è°¢ï¼ [destination = xxx   address = /1.1.1.1:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:xxx [java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:122)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209)         at java.lang.Thread.run(Thread.java:745) æŒ‡å®šäº†ä½ç‚¹ä¸èƒ½å§ï¼Œè¦ä»æœ€æ–°å¼€å§‹æ¶ˆè´¹ï¼Œç›´æ¥åˆ é™¤ä½ç‚¹è¯•è¯• æˆ–è€…ä¸æŒ‡å®šä½ç‚¹å°±æ˜¯ä»æœ€æ–°å¼€å§‹ æ²¡æœ‰æŒ‡å®šä½ç‚¹ï¼Œè¯·é—®å¦‚ä½•åˆ é™¤ä½ç‚¹ï¼Œè°¢è°¢ï¼ æˆ‘é‚£ä¸ªé—®é¢˜åº”è¯¥æ˜¯binlogæ¸…ç†æ‰ä¹‹å‰çš„æ–‡ä»¶ï¼Œç„¶åå¯¼è‡´æ‰¾ä¸åˆ°ä»ä½ç‚¹è§£æbinlogçš„é—®é¢˜å§ æ˜¯çš„ æŒ‡å®šä½ç‚¹äº†å°±ä¼šï¼Œä¸æŒ‡å®šåº”è¯¥æ˜¯ä»æœ€æ–°å¼€å§‹æ¶ˆè´¹çš„ å—¯å—¯ï¼Œè°¢è°¢ï¼ä¿®æ”¹ä½ç‚¹æ˜¯ä¸æ˜¯åªèƒ½ä¿®æ”¹zookeeperé‡Œå­˜æ”¾offsetçš„æ•°æ®å‘€ï¼
347,mysqlä½¿ç”¨utf8mb4å‡ºç°ä¸­æ–‡ä¹±ç  ![image](https://user-images.githubusercontent.com/5357638/28571083-c7fade36-7173-11e7-8cef-2484de5b1b04.png) å…·ä½“ä¹±ç çš„éƒ¨åˆ†æ˜¯è¿™æ ·çš„ã€‚å› ä¸ºæœ‰ä¸€äº›ä¸šåŠ¡æ•æ„Ÿå­—æ®µï¼Œæ‰€ä»¥æ‰“äº†ç ï¼Œè§è°…ã€‚ æ‰¾åˆ°é—®é¢˜äº†ã€‚ä¸æ˜¯canalçš„é—®é¢˜ã€ã€‚ åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Œæˆ‘ä¹Ÿé‡åˆ°ç±»ä¼¼çš„é—®é¢˜ è®°ä¸å¤ªæ¸…æ¥šäº†ã€‚å¥½åƒæ˜¯æˆ‘ä»¬ç”¨çš„druidç‰ˆæœ¬å¤ªä½è¿˜æ˜¯ä»€ä¹ˆã€‚æˆ‘å†æƒ³æƒ³â€¦â€¦
346,AbstractEventParserè®¾ç½®parseThread.setNameçš„æ—¶å€™æŠ¥ç©º   parseThread.setName(String.format("destination = %s   address = %s   EventParser"             destination             runningInfo == null ? null : runningInfo.getAddress().toString())); åº”è¯¥å»æ‰toString()æ–¹æ³• å·²æäº¤
345,canalä¸ºä»€ä¹ˆè·å–tableNameå’ŒschemaNameä¸ºç©º  header {   version: 1   logfileName: "mysql-bin.000068"   logfileOffset: 719945754   serverId: 125   serverenCode: "UTF-8"   executeTime: 1500862055000   sourceType: MYSQL   schemaName: ""   tableName: ""   eventLength: 217   eventType: QUERY } entryType: ROWDATA storeValue: "\020\aZ\301\001insert into productinfotemp(SysId Price RealityPrice SkuCount Name Code SaleDate Status) values (\'eab6d30a-2436-4c3b-b493-3c997fd8d8fb\' 10.00 10.00 1.00 \'\' \'E0205004\' \'2017-07-24 00:00:00 \' 99)" QUERYè¯­å¥ï¼Œä¸æ˜¯ROWæ¨¡å¼çš„è¡Œè®°å½•å§ æˆ‘ä¹Ÿæœ‰å¾ˆå¤šè¿™æ ·çš„æ•°æ® insertï¼Œupdateéƒ½æœ‰ 2017-09-12 14:09:57 417[INFO]yike.canal.AbstractCanalClientTest.printEntry(AbstractCanalClientTest.java:206) ----------------> binlog[mysql-bin.002059:3086158]   name[xmall ]   eventType : UPDATE   executeTime : 1505196597000   delay : 417ms 2017-09-12 14:09:57 417[INFO]yike.canal.AbstractCanalClientTest.printEntry(AbstractCanalClientTest.java:206) ----------------> binlog[mysql-bin.002059:3086397]   name[xmall ]   eventType : INSERT   executeTime : 1505196597000   delay : 417ms 2017-09-12 14:09:57 606[INFO]yike.canal.AbstractCanalClientTest.printSummary(AbstractCanalClientTest.java:155) canalæ–°ç‰ˆæœ¬å·²ç»é€šè¿‡SQLè§£æå·¥å…·ï¼Œå®Œæ•´æå–tableNameï¼ŒschemaNameåœ¨binlogé‡Œæ— è®°å½•
344,canalå¦‚ä½•åªæ³¨å†Œinsertçš„äº‹ä»¶ï¼Ÿupdateï¼Œdeleteï¼Œselectéƒ½ä¸å…³å¿ƒï¼Œä¸éœ€è¦å‘é€åˆ°å®¢æˆ·ç«¯ canalå¦‚ä½•åªæ³¨å†Œinsertçš„äº‹ä»¶ï¼Ÿupdateï¼Œdeleteï¼Œselectéƒ½ä¸å…³å¿ƒï¼Œä¸éœ€è¦å‘é€åˆ°å®¢æˆ·ç«¯ ``` if (!(eventType == EventType.DELETE|EventType.SELECT|EventType.UPDATE)) {} ```
343,Bugfix when filterqueryddl å¦‚æœddlè¢«è¿‡æ»¤æ‰äº†ã€‚meta cacheå°±ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚ è¡¥å……çš„å­—æ®µåå°±ä¼šå‘ç”Ÿé”™ä¹±ã€‚ [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=343) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you all sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=343) before we can accept your contribution.<br/>**1** out of **2** committers have signed the CLA.<br/><br/>:white_check_mark: toruneko<br/>:x: jianhao.dai<br/><hr/>**jianhao.dai** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=343) it.</sub> tks. å…ˆåˆå¹¶ ps. è¿‘æœŸä¼šå¯¹meta cacheåšä¸€ä¸ªæ¯”è¾ƒå¤§çš„è°ƒæ•´ï¼Œæ”¯æŒä¸€ä¸‹è¡¨ç»“æ„ç‰ˆæœ¬çš„å½’æ¡£å­˜å‚¨ï¼Œè§£å†³åˆ åˆ—ã€åˆ è¡¨çš„é—®é¢˜
342,æ€æ ·æ‰èƒ½æŠŠæ•°æ®åŒæ­¥åˆ°ä»åº“ æœ¬äººæ–°æ‰‹ä¸€ä¸ªï¼Œæœ‰é—®é¢˜æƒ³è¯·æ•™å„ä½  ç¯å¢ƒï¼šv1.0.24  mysqlï¼š5.6  é—®é¢˜ï¼šå®¢æˆ·ç«¯å·²ç»è¿è¡ŒæˆåŠŸï¼Œèƒ½æ•è·åˆ°ä¸»æ•°æ®çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä½†æ˜¯æ€æ ·æŠŠäºŒè¿›åˆ¶æ–‡ä»¶è¿˜åŸæˆä»åº“çš„æ•°æ®ï¼Ÿ æˆ‘ç†è§£æ˜¯ä½ éœ€è¦è‡ªå·±è§£æè¯»åˆ°çš„entryï¼Œç„¶åæŠŠå®ƒè½¬æˆSQLåœ¨ä»åº“ä¸­æ‰§è¡Œã€‚ Canal å¹¶æ²¡æœ‰æä¾›æ•°æ®å­˜å‚¨çš„ã€‚ ç°æˆçš„æ˜¯otter   db-->db
341,zookeeperæŒ‚äº†é‡å¯åï¼Œcanal serverçš„åŒæ­¥åœæ­¢äº†      canalè¿è¡Œä¸­ï¼Œzookeeperä¸çŸ¥ä»€ä¹ˆåŸå› æŒ‚äº†ï¼Œç„¶åcanal serverå¼€å§‹æŠ¥è¿ä¸ä¸Šzookeeperçš„é”™è¯¯ï¼Œ äºæ˜¯stopäº†canal serverï¼Œç„¶åé‡å¯zookeeperã€canal serverå’Œcanal_clientã€‚      é‡å¯åå‘ç°canal_clientåœ¨getWithoutAck()è¿™ä¸ªåœ°æ–¹å¡ä½äº†ï¼Œä¸€ç›´è·å–ä¸åˆ°Messageï¼Œæ‰€ä»¥åŒæ­¥ ä¹Ÿå°±å¡ä½äº†ï¼Œç»æ£€æŸ¥ä¸»åº“çš„æ—¥å¿—ï¼Œå‘ç‘å·²ç»åˆ°äº†binlog.000446ï¼Œè€Œcanal_serverä»zookeeperä¸­ è·å–åˆ°çš„æ—¥å¿—ä¸ºbinlog.000440ï¼Œå·²ç»å·®äº†6ä¸ªæ—¥å¿—æ²¡æœ‰åŒæ­¥äº†ã€‚     åæ¥å‘ç°ï¼Œcannalæ¯åŒæ­¥ä¸€æ®µæ—¶é—´ï¼Œå°±ä¼šåœä½ï¼Œè¿‡ä¸€æ®µæ—¶é—´åï¼Œä¼šç»§ç»­åŒæ­¥ï¼Œç„¶åå‘¨è€Œå¤å§‹çš„ å¡ä¸»çš„å¼‚å¸¸åŸå› è¦çœ‹çœ‹ï¼Œæ˜¯å¦æ˜¯è¡¨ç»“æ„åˆ é™¤æ€§è´¨å¯¼è‡´
339,the max size of buffer must not more than 1G!!! if buffer = bufferSize * bufferMemUnit = 2G than  (bufferSize * bufferMemUnit) = 2097152*1024 > max length of int;  cause endless loop in MemoryEventStoreWithBuffer.tryPut & checkFreeSlotAt so that  the max size of buffer = 1G!!! why not use long type? bufferSize = 2097152 ?  è¿‡å¤§çš„bufferSizeï¼Œå¹¶ä¸ä¼šå¯¹æ€§èƒ½æœ‰å¾ˆå¤§çš„å¸®åŠ©å“¦ï¼Œå»ºè®®bufferSizeæ§åˆ¶åœ¨32768ï¼ŒåŸºæœ¬å°±æœ‰å‡ ä¸‡çš„TPS
338,rowChage.getRowDatasList()æ•°æ®ä¸ºç©º mysqlç‰ˆæœ¬5.6.19 å¼€å¯binlog  ROW ç±»å‹ è§£ææ–‡ä»¶äº‹ä»¶ç±»å‹éƒ½æ˜¯eventType: QUERYï¼Œæ— update insertäº‹ä»¶ç±»å‹ ï¼Œè¯·é—®æ˜¯ä»€ä¹ˆåŸå›  canal.zkServers=192.168.0.14:2181 canal.instance.global.spring.xml  é…ç½®  file-instance.xml å†…å­˜+æ–‡ä»¶å°±æœ‰æ•°æ® canal.instance.global.spring.xml   ä½¿ç”¨default-instance.xml HA æ–¹å¼æ— æ•°æ®
337,mixedæ¨¡å¼ä¸‹ï¼Œå¦‚ä½•è·å–sqlè¯­å¥    è¯·é—®ä¸€ä¸‹ï¼Œåœ¨mixedæ¨¡å¼ä¸‹ï¼Œæ€ä¹ˆè·å–sqlè¯­å¥
336,å¼‚æ­¥ackçš„æ—¶å€™ï¼Œackçº¿ç¨‹å‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œgetçº¿ç¨‹é˜»å¡åœ¨BooleanMutexï¼Œæ˜¯å¦ä¸è®¾ç½®ring buffer sizeæœ‰å…³ï¼Ÿ clientç«¯ackçº¿ç¨‹å‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œgetçº¿ç¨‹é˜»å¡åœ¨BooleanMutex `"SyncThread5" #27 prio=5 os_prio=0 tid=0x00007fc880f62800 nid=0x549 waiting on condition [0x00007fc854302000]    java.lang.Thread.State: WAITING (parking)         at sun.misc.Unsafe.park(Native Method)         - parking to wait for  <0x0000000735ee1df0> (a com.alibaba.otter.canal.common.utils.BooleanMutex$Sync)         at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)         at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:836)         at java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:997)         at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1304)         at com.alibaba.otter.canal.common.utils.BooleanMutex$Sync.innerGet(BooleanMutex.java:123)         at com.alibaba.otter.canal.common.utils.BooleanMutex.get(BooleanMutex.java:53)         at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.waitClientRunning(SimpleCanalConnector.java:425)         at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:256)         at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:252)         at com.alibaba.otter.canal.client.impl.ClusterCanalConnector.getWithoutAck(ClusterCanalConnector.java:180)         at com.dfire.obd.core.Launcher$SyncThread.run(Launcher.java:105)` serverç«¯å‡ºç°ï¼š2017-07-04 14:28:15.068 ERROR com.alibaba.otter.canal.server.netty.NettyUtils [New I/O server worker #1-4]ï¼›ErrotCode:400   Caused by :  something goes wrong with channel:[id: 0x2ce9c057  /10.26.0.247:41053 :> /10.26.0.9:11111]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: ack error   clientId:1001 batchId:14800952 is not exist   please check å°è¯•ä¸€ä¸‹canalæ–°ç‰ˆæœ¬
335,ä¸€ä¸ªcanal severä¸Šinstanceå¤ªå¤šå½±å“æ€§èƒ½æ€ä¹ˆåŠ? å› ä¸ºinstanceå¯èƒ½å¾ˆå¤š  canalèƒ½å®ç°éƒ¨ç½²å¤šå¥—ä¸»å¤‡å—? å¯ä»¥çš„ï¼Œå°†instanceåˆ†æ•£åˆ°å¤šå°serverä¸­
334,é’ˆå¯¹ä½¿ç”¨nettyå–ä»£JDKçš„socketchannelå®ç°çš„ä¼˜åŒ– 1ï¼ŒSocketChannelç”±wait(time)å–ä»£wait-notify 2ï¼Œè¯»å†™ç›´æ¥é‡‡ç”¨byte[]ï¼Œå–ä»£ä¹‹å‰çš„ByteBuffè½¬byte[] 3ï¼Œä¿®æ”¹PacketManagerçš„æ–¹æ³•ï¼Œå¹¶è°ƒæ•´ç›¸å…³çš„å¼•ç”¨ 4ï¼Œè‡³äºä½¿ç”¨äº†Jboss.nettyï¼Œå¯ä»¥è¿›è¡Œexcludeï¼Œè¿™é‡Œæ²¡æœ‰æäº¤ï¼ˆä¸å½±å“ï¼‰ [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=334) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you all sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=334) before we can accept your contribution.<br/>**1** out of **2** committers have signed the CLA.<br/><br/>:white_check_mark: agapple<br/>:x: luoyaogui<br/><hr/>**luoyaogui** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=334) it.</sub> tksï¼Œæˆ‘éªŒè¯ä¸€ä¸‹
333,fix bugï¼šå¼‚å¸¸ç½‘ç»œè¿æ¥å¯¼è‡´canal server æ— æ³•å…³é—­ ç°å®è¿ç”¨ä¸­å‡ºç°ï¼šclientå·²ç»ä¸å­˜åœ¨ä½†serverç«¯çš„è¿æ¥ä»ç„¶æ˜¯å­˜æ´»çŠ¶æ€ã€‚ åœ¨æ­¤ç§ç½‘ç»œå¼‚å¸¸çŠ¶æ€æ—¶ï¼Œstop canal serverä¼šä¸€ç›´hangä½ã€‚ åŸå› ï¼šå¼‚å¸¸ç½‘ç»œè¿æ¥ç”±äºæ— æ•°æ®ä¼ è¾“ï¼Œå¯¼è‡´ io workerçº¿ç¨‹ä¸€ç›´loop selectorè€Œæ— æ³•é€€å‡ºã€‚ è§£å†³æ–¹æ¡ˆï¼š1. è®¾ç½®keepalive ç”±os ç›‘æ§ã€‚         2. è®¾ç½®netty idle æœºåˆ¶ï¼Œå®šæ—¶æ£€æµ‹å¹¶ä¸»åŠ¨close socketã€‚(fix æ—¶é—´å•ä½bug)         3. æ¯æ¬¡æ–°åˆ›å»ºsocket channelæ—¶å­˜å‚¨åœ¨ä¸€ä¸ªå®¹å™¨å†…ï¼Œåœ¨stop canal serveræ—¶ï¼Œä»å®¹å™¨å†…ä¸»åŠ¨é‡Šæ”¾æ‰€æœ‰socket channelã€‚ [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=333) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=333) before we can accept your contribution.<br/><hr/>**Jason Huang** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=333) it.</sub> tks
332,HAæ–¹å¼ï¼Œkillæ‰è¿›ç¨‹ä¸èƒ½åˆ‡æ¢ hiï¼ŒHAæ–¹å¼æ—¶ï¼Œæˆ‘æ‰‹å·¥kiilæ‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼Œå®¢æˆ·ç«¯ç¨‹åºä¸èƒ½åˆ‡æ¢ï¼Œåœ¨zookeeperæŸ¥çœ‹å·²ç»æœåŠ¡å·²ç»åˆ‡æ¢ï¼Œè¯·é—®æ˜¯ä»€ä¹ˆå›äº‹å‘¢ï¼Ÿè°¢è°¢ï¼ å¦ï¼šæ­£å¸¸å…³é—­æœåŠ¡æ—¶ï¼Œç¨‹åºå¯ä»¥åˆ‡æ¢æœåŠ¡ DEBUG org.apache.zookeeper.ClientCnxn - Got ping response for sessionid: 0x35ca6b0127d780e after 0ms ä¸€ç›´éƒ½åœ¨æ‰“å°è¿™æ ·çš„è¯­å¥ è¿™ä¸ªæ˜¯DEBUGè¾“å‡ºï¼Œå¿½ç•¥å§
331,update zkclient to 0.10 æ²¡æœ‰åšè¿‡å¤šçš„æ”¹åŠ¨ï¼Œå‘ç°zkclientåŸåŒ…é‡Œæä¾›çš„ZkConnectionè·Ÿcanalè‡ªå·±å®ç°çš„ZooKeeperxæœ‰å¾ˆå¤šä»£ç ä¸Šçš„é‡å ï¼Œç”±äºä¸æ˜¯å¤ªæ¸…æ¥šè¿™éƒ¨åˆ†çš„ä»£ç çš„å†å²ï¼Œæ‰€ä»¥ç®€å•çš„ç»§æ‰¿äº†ZkConnectionï¼Œ è¿˜æ˜¯ç•™ç»™canalç»´æŠ¤è€…è‡ªå·±å†³å®šä¸‹ï¼Œè¿™é‡Œä»£ç çš„å»ç•™å§ã€‚ @agapple  ## Update: ç¬¬ä¸€ä¸ªcommitè¿˜æ˜¯æœ‰bugçš„ï¼Œ ä¿®æ”¹äº†ä¹‹åæäº†ç¬¬äºŒä¸ªcommitã€‚ ç›®å‰çš„æµ‹è¯•æ²¡æœ‰é—®é¢˜ã€‚ [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=331) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=331) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=331) it.</sub> tks @agapple   ä¸‹æ¬¡å‘ç‰ˆä»€ä¹ˆæ—¶å€™ï¼Ÿ
330,MySQL5.7 JSONè§£æé—®é¢˜ canal ç‰ˆæœ¬1.0.24 å†™å…¥MySQLçš„JSONæ•°æ®ï¼ŒCanalè§£æå¤±è´¥ 2017-06-22 11:39:25.104 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: java.lang.IllegalArgumentException: illegal json data         at com.taobao.tddl.dbsync.binlog.JsonConversion.parse_array_or_object(JsonConversion.java:81)         at com.taobao.tddl.dbsync.binlog.JsonConversion.parse_value(JsonConversion.java:61)         at com.taobao.tddl.dbsync.binlog.event.RowsLogBuffer.fetchValue(RowsLogBuffer.java:955)         at com.taobao.tddl.dbsync.binlog.event.RowsLogBuffer.nextValue(RowsLogBuffer.java:99)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseOneRow(LogEventConvert.java:495)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:376)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:108)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:62)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:326)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:176)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:130)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209)         at java.lang.Thread.run(Thread.java:745) å¦å¤–å¦‚æœjsonä¸­åŒ…å«åŒå¼•å·ï¼Œcanalè§£æä¹‹åä¸¢å¤±äº†è½¬ä¹‰ç¬¦å·ã€‚ ![image](https://user-images.githubusercontent.com/5357638/27416733-e8f73ba8-5741-11e7-96c0-2a0de5ddc8af.png) æä¾›ä¸€ä¸‹æµ‹è¯•SQL ä¸¤ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€ä¸ªé—®é¢˜è¿˜æ²¡æ‰¾åˆ°å‡ºé—®é¢˜çš„SQLï¼Œ ç¬¬äºŒä¸ªæ˜¯canalå·²ç»è§£æäº†ï¼Œå¹¶ä¸”canal clientå¯ä»¥æ‹¿åˆ°æ•°æ®ã€‚ +-------+-------------+------+-----+-------------------+-------+ | Field | Type        | Null | Key | Default           | Extra | +-------+-------------+------+-----+-------------------+-------+ | id    | int(11)     | NO   | PRI | NULL              |       | | dt    | timestamp   | NO   |     | CURRENT_TIMESTAMP |       | | json1 | json        | YES  |     | NULL              |       | | aa    | varchar(50) | YES  |     | NULL              |       | +-------+-------------+------+-----+-------------------+-------+ `insert into t1(id  json1  aa) values(3 "{\"test\":\"aa\\\"aa\"}"  "a");` æŸ¥å›æ¥æ˜¯è¿™æ ·çš„ +----+---------------------+--------------------+------+ | id | dt                  | json1              | aa   | +----+---------------------+--------------------+------+ |  3 | 2017-06-22 14:34:19 | {"test": "aa\\\"aa"} | a    | +----+---------------------+--------------------+------+ canal clientå–å‡ºçš„jsonå¦‚å›¾ã€‚ å˜æˆäº†`{"test":"aa"aa"}`ã€‚ æ‰¾åˆ°å¯¼è‡´illegal json data çš„SQLäº†ã€‚ jsonå¤§æ¦‚æœ‰25000ä¸ªå­—èŠ‚ï¼Œå°±è¡¥è´´å‡ºæ¥äº†ã€‚ ä¼šä¸ä¼šæ˜¯å› ä¸ºjsonå¤ªå¤§ï¼Œå¯¼è‡´byteså’Œlené•¿åº¦è®¡ç®—é”™è¯¯ã€‚ æ‰¾åˆ°å¯¼è‡´illegal json data çš„SQLäº†ã€‚ jsonå¤§æ¦‚æœ‰25000ä¸ªå­—èŠ‚ï¼Œå°±è¡¥è´´å‡ºæ¥äº†ã€‚ ä¼šä¸ä¼šæ˜¯å› ä¸ºjsonå¤ªå¤§ï¼Œå¯¼è‡´byteså’Œlené•¿åº¦è®¡ç®—é”™è¯¯ã€‚ ---------------------------------------------------------------- @toruneko   ä½ è¿™ä¸ªé—®é¢˜æ€ä¹ˆè§£å†³çš„ï¼Ÿ @lan1994 æœ€åæˆ‘ä»¬æ²¡æœ‰ç”¨jsonäº†ã€‚æ”¹äº†æ–¹æ¡ˆã€‚ã€‚ é‡åˆ°åŒæ ·é—®é¢˜ï¼Œæ±‚è§£ã€‚ æˆ‘å°½å¿«ä¿®å¤ä¸€ä¸‹ï¼Œåº”è¯¥ä¸éš¾ @agapple   æŠ€æœ¯ä¸“å®¶ï¼Œæ‚¨å¥½ï¼Œæœ‰ä¸ªé—®é¢˜è¯·æ•™ä¸€ä¸‹ï¼š æœ€è¿‘æˆ‘ä»¬é¡¹ç›®æ”¹é€ ï¼Œæ•°æ®åº“postgresqlåˆ‡æ¢åˆ°mysqlç”¨åˆ°äº†jsonç±»å‹çš„å­—æ®µï¼Œmysqlç‰ˆæœ¬å‡çº§åˆ°5.7æ‰èƒ½æ”¯æŒï¼Œæƒ³é—®ä¸€ä¸‹canalå‡çº§åˆ°v1.1.0ï¼Œæ˜¯å¦æ”¯æŒjsonç±»å‹çš„å­—æ®µï¼Ÿ canalæ˜¯å‘å‰å…¼å®¹çš„ï¼Œæ”¯æŒjsonè§£æ @agapple  æ²¡æƒ³åˆ°è¿™ä¹ˆå¿«å°±å›å¤äº†ï¼Œè°¢è°¢å¤§å’–ï¼
329,canalåœ¨åŒæ­¥æŠ¥é”™çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥è·³è¿‡è¿™ä¸ªé”™è¯¯ä¹ˆï¼Ÿ æ®æµ‹è¯•ï¼Œcanalåœ¨åŒæ­¥sqlæŠ¥é”™çš„æ—¶å€™ï¼Œä¼šä¸€ç›´é‡å¤çš„å»æ‰§è¡Œè¿™ä¸ªsqlï¼Œå¯¼è‡´positionä½ç½®åœæ­¢ï¼Œå‡å¦‚ç”±äºæ‰‹è¯¯å¯¼è‡´æœ‰ä¸€æ¡binlogçš„sqlï¼Œæ¯”å¦‚è¡¨ä¸å­˜åœ¨è¿™ç§ï¼Œå°±ä¼šå¯¼è‡´canalåœæ»ï¼Œè¯·é—®å¤§ç¥æœ‰è·³è¿‡åŒæ­¥é”™è¯¯çš„æ–¹æ³•ä¹ˆï¼Ÿ ç›®å‰åªèƒ½é‡ç½®ä¸€ä¸‹ä½ç‚¹ï¼Œåç»­å¯ä»¥è€ƒè™‘å¢åŠ DDLå˜æ›´èƒ½åŠ›çš„æ”¯æŒ
328,canalå¯¹MySQL5.7æœ‰æ”¯æŒå—ï¼Ÿ canalå¯¹MySQL5.7æœ‰æ”¯æŒå—ï¼Ÿè°¢è°¢ å¯ä»¥çš„ï¼Œé™¤äº†jsonå¯¹è±¡æ”¯æŒä¼šæœ‰éƒ¨åˆ†ç¼ºé™· å½“å‰ä¸»å¹²å·²ä¿®å¤jsonå¯¹è±¡è¿‡å¤§çš„è§£æé—®é¢˜
327,canal-serveræœ€è¿‘ä¼šè«åæŒ‚æ‰ï¼Œæ²¡æœ‰ä»»ä½•æ—¥å¿—çš„é‚£ç§ã€‚ æˆ‘çš„canal-serveré…ç½®äº†å››ä¸ªdestinationï¼Œè«åæŒ‚æ‰ä¹‹åï¼Œæ‰€æœ‰çš„canal-clientå°±å¼€å§‹ç–¯ç‹‚åˆ·è¿™æ ·çš„é”™è¯¯ï¼š 2017-06-17 00:21:19.110 [Thread-1] ERROR com.alibaba.otter.canal.example.AbstractCanalClientTest - process error! com.alibaba.otter.canal.protocol.exception.CanalClientException: failed to subscribe with reason: something goes wrong with channel:[id: 0x1e023246  /**.**.**.**:39396 => /**.**.**.**:1 1111]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: destination:*** should start first ç„¶åæœºå™¨çš„è´Ÿè½½å°±é£™åˆ°ç‰¹åˆ«é«˜ã€‚ è¯·é—®æœ‰å¤§ç¥é‡åˆ°è¿‡ç±»ä¼¼çš„é—®é¢˜ä¹ˆï¼Ÿ
326,å¦‚æœæˆ‘è¦åŒæ­¥å¥½å‡ ä¸ªä¸åŒåœ°å€ä¸‹çš„æ•°æ®åº“çš„æ•°æ®ï¼Œæ˜¯ä¸æ˜¯è¦ä¸€ä¸ªcanal-serverï¼Œå’Œå¤šä¸ªcanal-clientï¼Ÿ canal server æ²¡å…³ç³»å§ï¼Œcanalclient è·Ÿdestinationæ˜¯ä¸€å¯¹ä¸€çš„ otter+canal LSæ­£è§£
325,canal-serverèƒ½å¦ç›´æ¥æ¥å…¥MQç›´æ¥å‘é€æ¶ˆæ¯ï¼Œè€Œä¸é€šè¿‡canal-client å¸Œæœ›é€šè¿‡ç›´æ¥æ”¹é€ canal-serverç›´æ¥æ¥å…¥å…¬å¸çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œbinlogç›´æ¥é€šè¿‡æ¶ˆæ¯è´Ÿè½½åˆ°é›†ç¾¤èŠ‚ç‚¹ã€‚canalä»…éœ€è¦æœåŠ¡ç«¯å°±è¡Œï¼Ÿè¿™ç§åº”è¯¥å¦‚ä½•åšå‘¢ï¼Ÿ   [maxwell](https://github.com/zendesk/maxwell)      [debezium](https://github.com/debezium/debezium)å¯ä»¥æ”¯æŒå…¨é‡+å¢é‡
324,å‡çº§zkclientåˆ°0.10 @agapple   å¸Œæœ›æŠŠzkclientå‡çº§åˆ°0.10 # ä¼˜ç‚¹ï¼š 1. åœ¨0.10ç‰ˆæœ¬é‡Œï¼Œ Switch from Log4j to Slf4jï¼Œè¿™æ–¹ä¾¿æˆ‘ä»¬æŠŠdebug logæ‰“å¼€è°ƒè¯• 1. ä¸€äº›bug fix # ç¼ºç‚¹ 1.  0.10 å¯¹ä¸€äº›æ¥å£å¢åŠ ä¸€äº›æ–¹æ³•ï¼Œcanalè¦é€‚å½“çš„åšäº›è°ƒæ•´ å¦‚æœæ–¹ä¾¿ï¼Œç»™æˆ‘æäº¤ä¸€ä¸ªPRå§ #142 ï¼Œ ä¸å‡çº§çš„è¯ï¼Œè¿˜ä¼šé‡åˆ°142çš„é—®é¢˜ #331 ï¼Œ æäº¤äº†ä¸€ä¸ªPRï¼Œè¿˜è¯·reviewä¸€ä¸‹ï¼Œ @agapple 
323,ClusterCanalConnectorâ€”â€”zookeeperæ¨¡å¼ä¸‹è¿æ¥canalè¿‡æ…¢ å‰æï¼šé›†ç¾¤æ­å»ºæ²¡æœ‰é—®é¢˜ï¼Œjavaç›´æ¥è¿æ¥zké€Ÿåº¦ä¹Ÿå¾ˆå¿«ï¼Œç”¨Simpleæ¨¡å¼ä¹Ÿå¾ˆå¿«ï¼Œä½†æ˜¯ï¼Œ CanalConnector connector = CanalConnectors.newClusterConnector("200.200.200.64:2181"  "es"  ""  "");         int batchSize = 1000;         int emptyCount = 0;         try {             System.out.println("start connect");             connector.connect();             System.out.println("connect successed!");             connector.subscribe("\\..*");             System.out.println("subscribeed !!"); ... åœ¨connector.subscribe("\\..*"); éå¸¸æ…¢ï¼Œæœ‰æ—¶å€™è¿˜éœ€è¦é‡å¯ä¸¤æ¬¡æ‰èƒ½æ­£å¸¸è¿æ¥ï¼ï¼ debugæŸ¥çœ‹æ˜¯ public void subscribe(String filter) throws CanalClientException {         this.waitClientRunning(); å‘ç”Ÿé—®é¢˜ï¼Œæœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥è§£å†³ï¼Ÿ ä½ è¿™æ˜¯åŸºäºzookeeperçš„é›†ç¾¤æ¨¡å¼å¯åŠ¨ï¼Œä¸Šä¸€æ¬¡å¼‚å¸¸é€€å‡ºæ—¶å°½é‡ä½¿ç”¨å¹³æ»‘é€€å‡ºï¼Œä¸è¦kill -9ï¼Œæ­£ç¡®è°ƒç”¨disconnect
322,æ€ä¹ˆåœ¨dockerå®¹å™¨é‡Œé¢å¯åŠ¨canalçš„æœåŠ¡ç«¯ æ€ä¹ˆåœ¨dockerå®¹å™¨é‡Œé¢å¯åŠ¨canalçš„æœåŠ¡ç«¯ï¼Œæ±‚æŒ‡å¯¼æ–¹ä¾¿ç®€å•çš„æ–¹å¼ï¼›
321,æŒ‡å®šä½ç‚¹å¯åŠ¨å‡ºé”™ ç‰ˆæœ¬ï¼š1.0.24 é—®é¢˜ï¼š ä½ å¥½ï¼Œcanalæœ¬èº«æ˜¯æ”¯æŒæŒ‡å®šä½ç‚¹å¼€å§‹è§£æçš„ï¼Œä½†æ˜¯è§£ææ—¶ä¼šæŠ¥TableIdNotFoundExceptionï¼Œæˆ‘çœ‹æºç æœ‰å¯¹è¿™ä¸ªå¼‚å¸¸è¿›è¡Œå¤„ç†ï¼Œä½†æ˜¯å®é™…ä¸ŠæŠ›å‡ºçš„å¼‚å¸¸æ˜¯CanalParseExceptionï¼Œå¯¼è‡´æ•æ‰å¹¶ä¸æˆåŠŸã€‚ å¦‚æˆªå›¾ï¼š ![rtx](https://user-images.githubusercontent.com/29394152/27125044-9910f768-5125-11e7-9971-9309d016f512.jpg) æŠ›å‡ºexceptionçš„ç±»å‹æ˜¯**CanalParseException**ï¼Œ å…¶causeæ‰æ˜¯**TableIdNotFoundException** 
320,å…³äºè§£æä½ç‚¹ä¸æ¶ˆè´¹ä½ç‚¹ canalçœŸå¥½ç”¨ï¼Œè°¢è°¢ä½ ä»¬çš„ä»˜å‡ºã€‚ä½†æ˜¯æˆ‘å‘ç°ä¸€ä¸ªé—®é¢˜ï¼ˆä¸çŸ¥é“æ˜¯ä¸æ˜¯çœŸçš„é—®é¢˜ï¼‰ åœºæ™¯ï¼š canal serverå’Œclientéƒ½åœ¨è¿è¡Œä¸­ï¼Œæ­¤æ—¶å¾€æ•°æ®åº“å˜æ›´å¾ˆå¤šæ•°æ®ï¼ˆå‡è®¾åä¸‡ï¼‰ ç°åœ¨å‡è®¾parserå·²ç»è§£æå®Œï¼Œä½ç‚¹å¤„äºbinlogæœ€æ–°çš„ä½ç½®ï¼Œä½†clientæ¶ˆè´¹å¾ˆæ…¢ï¼Œåªæ¶ˆè´¹äº†ä¸€ä¸‡æ¡æ•°æ®ã€‚æ­¤æ—¶å¦‚æœserveræŒ‚äº†ï¼Œç„¶åé‡æ–°å¯åŠ¨ï¼Œè¯»å–zkä¸Šçš„è§£æä½ç‚¹ï¼ˆbinlogæœ€æ–°ä½ç½®ï¼‰ï¼Œæ­¤æ—¶serverä¸Šçš„binlogæ•°æ®åªæœ‰æœ€æ–°çš„ï¼Œè€Œclientè¿˜æ²¡æ¶ˆè´¹å®Œï¼Œæ­¤æ—¶clientå†è·å–æ•°æ®ï¼Œæ˜¯ä¸æ˜¯å°±è·å–ä¸åˆ°é‚£ä¹ä¸‡æ¡æ²¡æ¶ˆè´¹çš„æ•°æ®ï¼Ÿ https://github.com/alibaba/canal/blob/master/parse/src/main/java/com/alibaba/otter/canal/parse/inbound/mysql/MysqlEventParser.java#L314 https://github.com/alibaba/canal/blob/master/parse/src/main/java/com/alibaba/otter/canal/parse/inbound/mysql/MysqlEventParser.java#L330 @luyee ä½ å¥½ï¼Œä½ è´´è¿™ä¸ªä¸æ˜¯å–è§£æä½ç‚¹å—ï¼Œç„¶åå‘¢ã€‚ã€‚ @xzhhh canalé‡å¯åæ˜¯ä»ä¸Šä¸€æ¬¡çš„è¯»å–ä½ç‚¹å¼€å§‹ï¼Œè¯¥binlogä½ç½®ä¿¡æ¯å­˜æ”¾äºconf/\<instance\>/meta.datæ–‡ä»¶ä¸­ã€‚æ–‡ä»¶å†…å®¹ç±»ä¼¼ï¼š `{"clientDatas":[{"clientIdentity":{"clientId":1001 "destination":"example_db" "filter":""} "cursor":{"identity":{"slaveId":-1 "sourceAddress":{"address":"127.0.0.1" "port":3306}} "postion":{"included":false "journalName":"mysql-bin.000032" "position":18169170 "serverId":1 "timestamp":1497426548000}}}] "destination":"trc_account_db"}` å…¶ä¸­binlogä½ç½®å­—æ®µ ä¸ºposition ä½†å¯èƒ½ä¼šå­˜åœ¨è¿™æ ·çš„é—®é¢˜ï¼Œserveré•¿æ—¶é—´æ²¡æœ‰æ›´æ–°binlogä½ç½®åï¼ˆå¦‚åœæœº/æˆ–é•¿æœŸæ— æ¶ˆè´¹ï¼‰ï¼ŒmysqlæœåŠ¡å™¨ç”±äºæŸç§åŸå› æ¸…é™¤äº†ä¹‹å‰çš„binlogæ–‡ä»¶ï¼Œåˆ™ä¼šå¯¼è‡´è¯»å–å¼‚å¸¸ï¼Œéœ€è¦é‡æ–°å®šä½binlogä½ç½®ä»æŒ‡å®šä½ç½®è¯»å– @mfkugergvh æˆ‘çŸ¥é“canalé‡å¯ä¼šä»ä¸Šä¸€æ¬¡ä½ç‚¹å¼€å§‹è¯»å–ï¼Œä½†æˆ‘é—®é¢˜æ˜¯ï¼Œå¦‚æœè§£æçš„ä½ç‚¹åœ¨æ¶ˆè´¹ä½ç‚¹åé¢å¾ˆå¤šçš„æ—¶å€™canalæŒ‚äº†ï¼Œé‡å¯ä¹‹åé‚£äº›æœªæ¶ˆè´¹çš„æ•°æ®ä¸æ˜¯å·²ç»ä¸åœ¨canalé‡Œäº†å—ï¼Ÿå› ä¸ºç›®å‰eventStoreåªæœ‰åŸºäºå†…å­˜ç‰ˆçš„å®ç°ï¼Œé‡å¯ä¹‹åé‚£äº›åŸæ¥å­˜åœ¨å†…å­˜é‡Œçš„æœªæ¶ˆè´¹çš„eventä¹Ÿå·²ç»æ²¡äº†å§ã€‚ æ¯æ¬¡ä»mysqlè·å–binlogä¸æ˜¯ï¼Œéƒ½è¦ä»æŒ‡å®šèµ·å§‹ä½ç½®å¼€å§‹å˜›ï¼Œ æ‰€ä»¥æˆ‘è´´çš„æ˜¯è§£æèµ·å§‹ä½ç‚¹ä»£ç ï¼Œå¤§æ¦‚æ˜¯æ¯æ¬¡canal server å¯åŠ¨éƒ½ä¼šå»æ‹¿ä¸Šæ¬¡å®¢æˆ·ç«¯æ¶ˆè´¹åï¼ˆackï¼‰çš„positonï¼ˆå¦‚æœæœ‰ï¼‰å»mysqlè·å–binlog  æ‰€ä»¥å³ä½¿canal server è·å–äº†10w æ¡è®°å½•ï¼Œcanal client åªæ¶ˆè´¹äº†1000æ¡åcanal serveræŒ‚äº†ï¼Œ å¦‚æœackæˆåŠŸæ›´æ–°äº†è¿™1000æ¡è®°å½•ï¼Œä¸‹æ¬¡ä»1000å¼€å§‹æ¶ˆè´¹ï¼Œå¦‚æœæ²¡æœ‰ackæˆåŠŸï¼Œåº”è¯¥ä»å¤´å¼€å§‹æ¶ˆè´¹ï¼Œå°±ä¼šæœ‰é‡å¤ï¼è‡³äºä½ è¯´çš„æ¶ˆè´¹ä¸åˆ°ï¼Œé™¤éjournalnameï¼Œpostion  timestamp éƒ½æ²¡é…ç½®ï¼Œå°±æ˜¯ä»mysql binlog(show master status)æœ€è¿‘çš„å¼€å§‹æ¶ˆè´¹ LSç†è§£æ­£ç¡® 
319,fixbug: soTimeout doesn't work. æè¿°ï¼š å½“ç½‘ç»œä¸å¥½æˆ–å…¶ä»–æƒ…å†µï¼ŒServerå…³é—­è¿æ¥ï¼Œä½†Clientæœªæ”¶åˆ°FinåŒ…ï¼Œè¿æ¥å°†é•¿æ—¶é—´å¤„äºåŠè¿æ¥çŠ¶æ€ã€‚ åŸå› ï¼š SocketChanal ä¸­è®¾ç½®timeoutæ˜¯ä¸ç”Ÿæ•ˆï¼Œæ”¹ç”¨socketè¯»å–å³å¯ã€‚è§ï¼šhttp://bugs.java.com/bugdatabase/view_bug.do?bug_id=4614802 [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=319) <br/>All committers have signed the CLA. ä½ çš„soTimeoutå‚æ•°ï¼Œæ²¡çœ‹åˆ°æœ‰åœ¨clientå±‚é¢è¿›è¡Œè®¾ç½®å§ï¼Ÿ @agapple è®¾ç½®äº†ï¼Œä½†æ˜¯æ²¡æœ‰æ•ˆæœï¼Œéœ€è¦æ”¹ç”¨socketå¤„ç†ã€‚ ä½ ç¡®è®¤éƒ½æäº¤å…¨äº†ä¹ˆï¼Ÿæˆ‘æ„Ÿè§‰åªæ”¹åŠ¨äº†clientçš„ä»£ç ï¼Œserverå’Œmysqlä¹‹é—´çš„soTimeoutçš„socketæ›¿æ¢è²Œä¼¼æ²¡æäº¤ä¹ˆï¼Ÿ tks  Hi Thanks for the commit. I have met the same issue but it happens between canal server instance and mysql replication master. Any plan to fix it? Thanks mailzyok
318,canal exampleæŠ¥é”™ï¼šsomething goes wrong when getWithoutAck data from server:null canal example å¯åŠ¨äº†ä¸¤å° ç›¸å½“äºä¸»ä»æŠŠ ä¸€å°æŒ‚äº†ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°å¦ä¸€å° è¿è¡Œä¸­å‡ºç°å¦‚ä¸‹å¼‚å¸¸ 2017-06-08 02:39:42.964 [Thread-3] WARN  c.alibaba.otter.canal.client.impl.ClusterCanalConnector - something goes wrong when getWithoutAck data from server:null com.alibaba.otter.canal.protocol.exception.CanalClientException: java.nio.channels.AsynchronousCloseException 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:281) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:252) 	at com.alibaba.otter.canal.client.impl.ClusterCanalConnector.getWithoutAck(ClusterCanalConnector.java:180) 	at com.alibaba.otter.canal.example.AbstractCanalClientTest.process(AbstractCanalClientTest.java:131) 	at com.alibaba.otter.canal.example.AbstractCanalClientTest$2.run(AbstractCanalClientTest.java:98) 	at java.lang.Thread.run(Thread.java:748) Caused by: java.nio.channels.AsynchronousCloseException 	at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:205) 	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:407) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.read(SimpleCanalConnector.java:376) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.readNextPacket(SimpleCanalConnector.java:366) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.receiveMessages(SimpleCanalConnector.java:286) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:279) 	... 5 more 2017-06-08 02:39:43.088 [ZkClient-EventThread-17-10.1.102.181:3001] ERROR c.a.otter.canal.client.impl.running.ClientRunningMonitor - There is an error when execute initRunning method  with destination [example]. com.alibaba.otter.canal.protocol.exception.CanalClientException: java.nio.channels.ClosedChannelException 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.doConnect(SimpleCanalConnector.java:171) ~[canal.client-1.0.24.jar:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.access$000(SimpleCanalConnector.java:48) ~[canal.client-1.0.24.jar:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector$1.processActiveEnter(SimpleCanalConnector.java:396) ~[canal.client-1.0.24.jar:na] 	at com.alibaba.otter.canal.client.impl.running.ClientRunningMonitor.processActiveEnter(ClientRunningMonitor.java:207) ~[canal.client-1.0.24.jar:na] 	at com.alibaba.otter.canal.client.impl.running.ClientRunningMonitor.initRunning(ClientRunningMonitor.java:118) ~[canal.client-1.0.24.jar:na] 	at com.alibaba.otter.canal.client.impl.running.ClientRunningMonitor$1.handleDataDeleted(ClientRunningMonitor.java:71) [canal.client-1.0.24.jar:na] 	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549) [zkclient-0.1.jar:na] 	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71) [zkclient-0.1.jar:na] Caused by: java.nio.channels.ClosedChannelException: null 	at sun.nio.ch.SocketChannelImpl.ensureReadOpen(SocketChannelImpl.java:257) ~[na:1.8.0_131] 	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:300) ~[na:1.8.0_131] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.read(SimpleCanalConnector.java:376) ~[canal.client-1.0.24.jar:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.readNextPacket(SimpleCanalConnector.java:369) ~[canal.client-1.0.24.jar:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.doConnect(SimpleCanalConnector.java:133) ~[canal.client-1.0.24.jar:na] 	... 7 common frames omitted 2017-06-08 02:39:43.114 [ZkClient-EventThread-17-10.1.102.181:3001] WARN  c.a.otter.canal.client.impl.running.ClientRunningMonitor - canal is not run any in node 2017-06-08 02:39:48.103 [Thread-3] INFO  c.alibaba.otter.canal.client.impl.ClusterCanalConnector - restart the connector for next round retry. 2017-06-08 11:34:56.529 [main-SendThread(10.1.102.181:3001)] INFO  org.apache.zookeeper.ClientCnxn - Unable to read additional data from server sessionid 0x15c83dad6dc0000  likely server has closed socket  closing socket connection and attempting reconnect 2017-06-08 11:34:59.029 [main-SendThread(10.1.102.181:3001)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server 10.1.102.181/10.1.102.181:3001. Will not attempt to authenticate using SASL (unknown error) 2017-06-08 11:34:59.310 [main-SendThread(10.1.102.181:3001)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established to 10.1.102.181/10.1.102.181:3001  initiating session 2017-06-08 11:35:00.488 [main-SendThread(10.1.102.181:3001)] WARN  org.apache.zookeeper.ClientCnxn - Session 0x15c83dad6dc0000 for server 10.1.102.181/10.1.102.181:3001  unexpected error  closing socket connection and attempting reconnect java.io.IOException: Broken pipe 	at sun.nio.ch.FileDispatcherImpl.write0(Native Method) ~[na:1.8.0_131] 	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47) ~[na:1.8.0_131] 	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93) ~[na:1.8.0_131] 	at sun.nio.ch.IOUtil.write(IOUtil.java:65) ~[na:1.8.0_131] 	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471) ~[na:1.8.0_131] 	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:117) ~[zookeeper-3.4.5.jar:3.4.5-1392090] 	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:355) ~[zookeeper-3.4.5.jar:3.4.5-1392090] 	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1068) ~[zookeeper-3.4.5.jar:3.4.5-1392090] è¿™ä¸ªæˆ‘ä¹Ÿåœ¨1.0.24ä¸­å‘ç°äº†ã€‚åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒæŠŠcanal serveråœæ‰ï¼Œç„¶åcanal clientå°±ä¸€ç›´ä¼šæœ‰è¿™ä¸ªé—®é¢˜ï¼ŒæŠŠcanal serveré‡å¯å¯åŠ¨ï¼Œcanal clientè¿˜æ˜¯åœ¨é‚£é‡Œä¸€ç›´æŠ¥é”™ï¼Œä¸ä¼šé€‰æ‹©æ–°çš„serveré‡è¿ï¼Œå…·ä½“çš„é—®é¢˜æˆ‘ä¹Ÿè¿˜åœ¨è°ƒè¯•ä¸­ã€‚ @agapple  è°ƒè¯•äº†ä¸€ä¸‹ï¼Œæ˜¯å› ä¸ºè‡ªå·±çš„ç”¨æ³•å¯¼è‡´çš„ï¼Œæˆ‘æŠŠæˆ‘åˆ›å»ºçš„cluster clientæ”¾åˆ°äº†ä¸€ä¸ªpoolé‡Œé¢ï¼Œæ³¨æ„ä¸‹é¢çš„code ```                    CanalConnector connector = CanalConnectors.newClusterConnector(connectionPath  destination  ""  "");             connector.connect();             connector.subscribe(); ``` è¿™é‡Œä¼šæŠ›å‡ºCanalClientExceptionï¼Œ è¿™æ˜¯ä¸ªruntime exception æ‰€ä»¥å½“`connect`æŠ›å‡ºå¼‚å¸¸çš„æ—¶å€™ï¼Œè®°å¾—è¦æ•è·ä¸€ä¸‹ï¼Œç„¶å`disconnect`æ‰ã€‚ ```         try {             connector.connect();             connector.subscribe();         } catch (Throwable t) {             logger.error("failed to connect to canal server"  t);             connector.disconnect();             throw t;         } ``` @xuliangyong ï¼Œ ä¸çŸ¥é“ä½ çš„æ˜¯ä¸æ˜¯è·Ÿæˆ‘ä¸€æ ·çš„é—®é¢˜ï¼Œå¸Œæœ›å¯¹ä½ æœ‰å¸®åŠ©ã€‚ @alexandnpu  æˆ‘ä¹Ÿç¢°åˆ°è¿‡è¿™ç§æƒ…å†µï¼Œè€Œä¸”æ£€æŸ¥TCPè¿æ¥æ—¶ï¼Œå‘ç°å¾ˆå¤šäº‹CLOSE_WAITçŠ¶æ€çš„ã€‚ æœ€åä¹Ÿæ˜¯é€šè¿‡catchå¼‚å¸¸ç„¶ådisconnectè§£å†³çš„ã€‚
317,æŠŠé…ç½®æ–‡ä»¶ç§»åŠ¨åˆ°å¦ä¸€ä¸ªç›®å½•ï¼Œéœ€è¦ä¿®æ”¹å“ªäº›å†…å®¹ï¼Ÿ   ä½ å¥½ï¼è¯·é—®æˆ‘æ˜¯æƒ³æŠŠconfç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶ç§»åŠ¨åˆ°å…¶å®ƒç›®å½•ï¼Œéœ€è¦ä¿®æ”¹å“ªäº›å†…å®¹å‘¢ï¼Ÿè°¢è°¢ å…³æ³¨instance.properties
316,MySQL5.6.10è¿æ¥å¤±è´¥ Exception in thread "main" com.alibaba.otter.canal.protocol.exception.CanalClientException: something goes wrong with reason: something goes wrong with channel:[id: 0x6ac75c6a  /127.0.0.1:51803 => /127.0.0.1:11111]  exception=java.lang.NullPointerException 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.calculateSize(MemoryEventStoreWithBuffer.java:535) 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.doGet(MemoryEventStoreWithBuffer.java:312) 	at com.alibaba.otter.canal.store.memory.MemoryEventStoreWithBuffer.tryGet(MemoryEventStoreWithBuffer.java:251) 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getEvents(CanalServerWithEmbedded.java:460) 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:296) 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.getWithoutAck(CanalServerWithEmbedded.java:259) 	at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:123) 	at org.jboss.netty.channel.SimpleChannelHandler.handleUpstream(SimpleChannelHandler.java:100) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564) 	at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:783) 	at org.jboss.netty.channel.SimpleChannelHandler.messageReceived(SimpleChannelHandler.java:154) 	at org.jboss.netty.channel.SimpleChannelHandler.handleUpstream(SimpleChannelHandler.java:100) 	at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564) 	at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:783) 	at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:275) 	at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:80) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564) 	at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:783) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndFireMessageReceived(ReplayingDecoder.java:525) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:506) 	at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:443) 	at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:80) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564) 	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:559) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274) 	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261) 	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:349) 	at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:280) 	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:200) 	at org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108) 	at org.jboss.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:44) 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) 	at java.lang.Thread.run(Thread.java:748) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.receiveMessages(SimpleCanalConnector.java:302) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:279) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:252) å…·ä½“ç‰ˆæœ¬æ˜¯ï¼Ÿ 
315,canal clientå¯ä»¥åšé›†ç¾¤è´Ÿè½½å‡è¡¡æ–¹å¼å—ï¼Ÿ ä½ å¥½ï¼è¯·é—®canal clientå¯ä»¥åšé›†ç¾¤è´Ÿè½½å‡è¡¡æ–¹å¼å—ï¼Ÿæ˜¯å¦èƒ½æœ‰ä¸ªä¾‹å­ç®€å•è¯´æ˜ä¸€ä¸‹ï¼Œè°¢è°¢ï¼ ClientRunningMonitor / ServerRunningMonitors  maybe useful ä½ è¯´çš„åº”è¯¥æ˜¯HAæ–¹å¼å§ï¼Œä½†æ˜¯æˆ‘æƒ³å®ç°ï¼Œæ¯”å¦‚å½“ä¸€ä¸ªèŠ‚ç‚¹è´Ÿè½½å¤ªå¤šï¼Œç„¶åå°±ä¼šè‡ªåŠ¨åˆ†é…åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹æ¥è¿è¡Œï¼Œè¿™å¯ä»¥å—ï¼Ÿè°¢è°¢  ä¸æ”¯æŒLBå§ï¼Œå…¶å®æ˜¯standbyæ¨¡å¼å§ see  å…³äºcanalé«˜å¯ç”¨çš„é—®é¢˜https://github.com/alibaba/canal/issues/147 è°¢è°¢
314,ClientRunningMonitor    ConnectException åœ¨CentOS7.2çš„æœåŠ¡å™¨ä¸Šï¼Œè¿è¡Œç€è¿è¡Œç€å°±å‘ç°æŠ›å‡ºäº†ConnectExceptionï¼Œæç¤ºè¿æ¥å¼‚å¸¸ã€‚è¯·é—®è¿™ä¸ªæ˜¯å“ªéƒ¨åˆ†å‡ºäº†é—®é¢˜ï¼Ÿ ``` [2017-06-02 17:01:03.295] [ERROR] [ZkClient-EventThread-20-10.10.10.81:2181 10.10.10.82:2181 10.10.10.33:2181] [c.a.o.c.client.impl.running.ClientRunningMonitor] >>> There is an error when execute initRunning method  with destination [db10101067002]. com.alibaba.otter.canal.protocol.exception.CanalClientException: java.net.ConnectException: Connection timed out         at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.doConnect(SimpleCanalConnector.java:171) ~[canal.client-1.0.23.jar:na]         at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.access$000(SimpleCanalConnector.java:48) ~[canal.client-1.0.23.jar:na]         at com.alibaba.otter.canal.client.impl.SimpleCanalConnector$1.processActiveEnter(SimpleCanalConnector.java:396) ~[canal.client-1.0.23.jar:na]         at com.alibaba.otter.canal.client.impl.running.ClientRunningMonitor.processActiveEnter(ClientRunningMonitor.java:207) ~[canal.client-1.0.23.jar:na]         at com.alibaba.otter.canal.client.impl.running.ClientRunningMonitor.initRunning(ClientRunningMonitor.java:118) ~[canal.client-1.0.23.jar:na] ``` ç¯å¢ƒé—®é¢˜ï¼Œè‡ªè¡Œæ’æŸ¥
313,å¯ä»¥instanceåˆ—è¡¨è¿›è¡Œè¿æ¥å—ï¼Ÿ canal.destinations=exampleï¼Œexample2ï¼Œ...... æœåŠ¡å™¨å¯ä»¥é…ç½®å¤šä¸ªå®ä¾‹åˆ—è¡¨ è€Œè¿æ¥æ—¶åªæ”¯æŒå•ä¸ªå®ä¾‹ï¼Œä¸ºä»€ä¹ˆä¸æ”¯æŒå¤šä¸ªï¼Ÿ String destination=example; connector = CanalConnectors.newClusterConnector(addresses  destination  username  password); connector = CanalConnectors.newSingleConnector(new InetSocketAddress(ip  port)  destination username  password);   destinationå‚æ•°ä¸ºä»€ä¹ˆä¸èƒ½å’Œé…ç½®å‚æ•°ä¸€æ ·æ”¯æŒå¤šä¸ªï¼Œæ¯”å¦‚: destination=exampleï¼Œexample2ï¼Œ...... å¥½åƒæ–‡æ¡£æœ‰è¯´å§ ä¸€ä¸ªclientåªæ”¯æŒå•ä¸ªinstance @liyong2008   è¿™æ ·çš„è¯  å‡è®¾20ä¸ªinstance  éœ€è¦éƒ¨ç½²è‡³å°‘20 ä¸ªclientï¼Ÿ group-instance.xmlä»‹ç»ï¼š ä¸»è¦é’ˆå¯¹éœ€è¦è¿›è¡Œå¤šåº“åˆå¹¶æ—¶ï¼Œå¯ä»¥å°†å¤šä¸ªç‰©ç†instanceåˆå¹¶ä¸ºä¸€ä¸ªé€»è¾‘instanceï¼Œæä¾›å®¢æˆ·ç«¯è®¿é—®ã€‚ åœºæ™¯ï¼šåˆ†åº“ä¸šåŠ¡ã€‚ æ¯”å¦‚äº§å“æ•°æ®æ‹†åˆ†äº†4ä¸ªåº“ï¼Œæ¯ä¸ªåº“ä¼šæœ‰ä¸€ä¸ªinstanceï¼Œå¦‚æœä¸ç”¨groupï¼Œä¸šåŠ¡ä¸Šè¦æ¶ˆè´¹æ•°æ®æ—¶ï¼Œéœ€è¦å¯åŠ¨4ä¸ªå®¢æˆ·ç«¯ï¼Œåˆ†åˆ«é“¾æ¥4ä¸ªinstanceå®ä¾‹ã€‚ä½¿ç”¨groupåï¼Œå¯ä»¥åœ¨canal serverä¸Šåˆå¹¶ä¸ºä¸€ä¸ªé€»è¾‘instanceï¼Œåªéœ€è¦å¯åŠ¨1ä¸ªå®¢æˆ·ç«¯ï¼Œé“¾æ¥è¿™ä¸ªé€»è¾‘instanceå³å¯.
312,canalå¯¹MySQL5.7æœ‰æ”¯æŒå—ï¼Ÿ canalç‰ˆæœ¬ï¼š1.0.24 MySQLç‰ˆæœ¬ï¼š5.7.18 å¯¹ä»¥ä¸Šç‰ˆæœ¬ä¸æ”¯æŒ ç›®å‰å·²çŸ¥å¯¹mysql 5.7jsonç±»å‹åœ¨è½¬ä¹‰å­—ç¬¦ä¸Šæœ‰ä¸€äº›bugï¼Œå…¶ä½™çš„æš‚æ²¡äººåé¦ˆæœ‰é—®é¢˜ æˆ‘è¿™è¾¹çš„ç‰ˆæœ¬æ˜¯ ` mysql  Ver 14.14 Distrib 5.7.17  for osx10.12 (x86_64) using  EditLine wrapper ` ä»logé‡Œé¢çœ‹æ˜¯ `subscribe successfully  ClientIdentity[destination=task-4 clientId=1001 filter=] with first position:null` ä½†æ˜¯å¯¹mysqlçš„æ•°æ®è¡¨åšæ›´æ–°ï¼Œcanalä¸€ç›´æ”¶ä¸åˆ°æ•°æ® @alexandnpu  æ£€æŸ¥Canalé…ç½®æ˜¯å¦æ­£ç¡®ï¼Œæ£€æŸ¥MySQLæ˜¯å¦å¼€å¯binlong å¦‚æœéƒ½æ²¡æœ‰é—®é¢˜è€Œæ— æ³•ç›‘æ§åˆ°æ•°æ®è¡¨çš„å˜åŒ–ï¼Œæˆ‘é‡åˆ°è¿‡è¿™æ ·æƒ…å†µï¼Œä¸‹è½½ä¸€ä¸ªå¹²å‡€çš„canalç‰ˆæœ¬ç„¶åè¿›è¡Œé…ç½®(é…ç½®MySQLåœ°å€ç«¯å£ï¼Œä»¥åŠdestination[ä¸è¦ä½¿ç”¨example])ï¼Œå°±å¯ä»¥å•¦ @kervin521   è°¢è°¢ä½ çš„å›å¤ã€‚ æˆ‘ç°åœ¨çš„é—®é¢˜æ˜¯åœ¨macä¸Šé¢åšæµ‹è¯•ï¼Œå¯åŠ¨äº†vagrantç”¨ä½œæµ‹è¯•ç¯å¢ƒï¼Œæˆ‘æ‹…å¿ƒçš„æ˜¯canalåœ¨å¾€mysqlåšslaveæ³¨å†Œæ—¶å€™ä½¿ç”¨äº†è™šæ‹Ÿæœºçš„ipï¼Œè€Œmysqlå¾€è¿™ä¸ªipå‘é€binglogæ˜¯æ‰¾ä¸åˆ°çš„ @alexandnpu  è¿™ä¸ªä½ ä¸ç”¨æ‹…å¿ƒï¼Œå› ä¸ºcanalæœåŠ¡ç«¯å£æ˜¯ä¸€å®šçš„ï¼Œå³ä½¿å€Ÿç”¨è™šæ‹ŸæœºIP åŒæ ·çš„é—®é¢˜ï¼Œæˆ‘ç”¨çš„ canalç‰ˆæœ¬ï¼š1.0.24 MySQLç‰ˆæœ¬ï¼š5.7.16 è¯·é—®Canalæ”¯æŒå—ï¼Ÿï¼Ÿï¼Ÿ @shijiebei2009 å¯ä»¥çš„ï¼Œå¦‚æœä¸è¡Œï¼Œé…ç½®è‡ªå·±çš„destinationä¸è¦ç”¨æ ·æœ¬ï¼Œå¹¶åˆ é™¤æ—¥å¿—å’Œæ•°æ®è®°å½•åœ¨Canalå®‰è£…ç›®å½•ä¸‹ 
311,canalæ€ä¹ˆåªç›‘å¬ä¸€ä¸ªæ•°æ®åº“ 1.å‡å¦‚mysqlä¸­æœ‰å¤šä¸ªæ•°æ®åº“ï¼Œåªç›‘å¬testæ•°æ®åº“æ€ä¹ˆé…ç½®ï¼Ÿ 2.å‡å¦‚å¯ä»¥çš„è¯ï¼Œæ€ä¹ˆæ­¤åº“ä¸‹çš„é…ç½®æŸä¸€å¼ è¡¨ï¼Ÿ 3.canal.instance.defaultDatabaseName = æ€ä¹ˆä½¿ç”¨ åœ¨é…ç½®æ–‡ä»¶é‡Œè®¾ç½® å¦‚conf\example\instance.propertiesé‡Œæœ‰2ä¸ªé…ç½®é€‰é¡¹ canal.instance.filter.regex = .*\\..* è¿™ä¸ªæ˜¯ç™½åå• å¦‚test\\..*åªç›‘å¬testæ•°æ®åº“ test\\.testç›‘æ§teståº“é‡Œçš„testè¡¨ å¤šä¸ªçš„è¯ç”¨é€—å·éš”å¼€ ä½†æ˜¯æ³¨æ„è¿™ä¸ªé…ç½®æ˜¯æ— æ•ˆçš„ å¿…é¡»åœ¨å®¢æˆ·ç«¯subscribeæ–¹æ³•é‡Œé…ç½® å› ä¸ºä¼šè¦†ç›– canal.instance.filter.black.regex =  è¿™ä¸ªæ˜¯é»‘åå• æ’é™¤åº“è¡¨ é…ç½®åŒä¸Š è¿™ä¸ªé…ç½®æœ‰æ•ˆ å…·ä½“é…ç½®ç¤ºä¾‹å‚ç…§æºç ç›®å½•é‡Œfilteréƒ¨åˆ† canal.instance.defaultDatabaseName = è¿™ä¸ªé…ç½®é¡¹ä¹Ÿæ˜¯æ— æ•ˆçš„ é…ä¸é…æ²¡æœ‰å…³ç³» 
310,canalåŒæ­¥çš„æ—¶å€™ï¼Œæœ‰äº›binlogæ²¡æœ‰åŒæ­¥è¿‡æ¥ æˆ‘ä½¿ç”¨çš„é›†ç¾¤æ¨¡å¼ï¼ŒåŒæ­¥ä¸€ä¸ªæ•°æ®åº“çš„æ•°æ®ï¼Œæœ‰æ›´æ–°çš„binlogåŒå¿—åŒæ­¥è¿‡æ¥ï¼Œä½†æ˜¯æˆ‘è‡ªå·±ä¿®æ”¹æ•°æ®åº“çš„æ•°æ®ï¼Œç¡®æ²¡æœ‰åŒæ­¥è¿‡æ¥ï¼Œä¸çŸ¥é“å•¥æƒ…å†µ~ å…³æ³¨ä¸€ä¸‹ä½ çš„æ“ä½œbinlogæ˜¯å¦æœ‰ç”Ÿæˆ å—¯ï¼Œæ˜¯æˆ‘çš„é—®é¢˜ï¼ŒåŒæ­¥çš„ä½ç‚¹å¤ªå‰äº†ï¼Œä¸€ç›´ä»¥ä¸ºæ²¡æœ‰åŒæ­¥è¿‡æ¥ï¼Œéå¸¸æ„Ÿè°¢ï¼
309,ERROR ## parse this event has an error   last position : [mysql-bin.000001 1199597] java.lang.NullPointerException: null ``` 2017-05-27 16:53:34.167 [destination = example   address = /127.0.0.1:3306   EventParser] INFO  c.a.otter.canal.parse.inbound.mysql.MysqlConnection - COM_BINLOG_DUMP with position:BinlogDumpCommandPacket[binlogPosition=1199597 slaveServerId=1234 binlogFileName=mysql-bin.000001 command=18] 2017-05-27 16:53:34.168 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - ERROR ## parse this event has an error   last position : [mysql-bin.000001 1199597] java.lang.NullPointerException: null 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:178) ~[canal.parse-1.0.25-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:130) [canal.parse-1.0.25-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) [canal.parse-1.0.25-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77] 2017-05-27 16:53:34.168 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /127.0.0.1:3306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: java.lang.NullPointerException Caused by: java.lang.NullPointerException: null 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:178) ~[canal.parse-1.0.25-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:130) ~[canal.parse-1.0.25-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) ~[canal.parse-1.0.25-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_77] 2017-05-27 16:53:34.169 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: java.lang.NullPointerException Caused by: java.lang.NullPointerException 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:178) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:130) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) 	at java.lang.Thread.run(Thread.java:745) ] 2017-05-27 16:53:34.169 [destination = example   address = /127.0.0.1:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - disConnect MysqlConnection to /127.0.0.1:3306... 2017-05-27 16:53:34.169 [destination = example   address = /127.0.0.1:3306   EventParser] INFO  c.alibaba.otter.canal.pars ``` show binlog events; ``` | mysql-bin.000001 | 1199597 | Xid            |         1 |     1199628 | COMMIT /* xid=5909 */  ``` 
308,é…ç½®æ–‡ä»¶ä¸­æ€ä¹ˆæ²¡æœ‰canal.properties é…ç½®æ–‡ä»¶ä¸­æ€ä¹ˆæ²¡æœ‰canal.properties
307,clientçš„ä¾‹å­ä¸­ï¼Œå–åˆ°çš„ddlè¯­å¥sqlä¸ºä»€ä¹ˆæ˜¯ä¹±ç  çœ‹äº†ä¸‹åº•å±‚çš„å®ç°æ˜¯å…ˆå›è½¬æˆutf-8ç¼–ç çš„ï¼Œä½†æ˜¯å–å‡ºæ¥çš„è¿˜æ˜¯ä¹±ç  é‚£æ˜¯ä½ mysqlå®¢æˆ·ç«¯ ç¼–ç ä¸æ˜¯utf8é€ æˆçš„ã€‚  ä½ è¿™ä¸ªé—®é¢˜è§£å†³äº†å—ï¼Ÿæ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ æˆ‘ç°åœ¨ä¹Ÿé‡åˆ°ç±»ä¼¼çš„é—®é¢˜ https://github.com/alibaba/canal/issues/610 
306,æ€ä¹ˆè§£ædateç±»å‹ æ€ä¹ˆè§£ædateç±»å‹ client éƒ½æ˜¯stringäº†ï¼Œåªèƒ½è‡ªå·±è½¬java  typeï¼Ÿ æ˜¯çš„ï¼Œmysqlçš„æ—¶é—´ç±»å‹èŒƒå›´ä¼šæ¯”java Dateå¯¹è±¡å®šä¹‰çš„è¦å¤§ï¼Œæ‰€ä»¥ç”¨äº†stringçš„æ³›ç±»å‹ Canal æœ‰æä¾› JDBC å¤šç§ç±»å‹é€šç”¨çš„è½¬æ¢å‡½æ•°ä¹ˆï¼Ÿ æ²¡æœ‰å§ï¼Œ jdbcçš„åŒ–ï¼Œ å¯ä»¥çœ‹çœ‹otteré¡¹ç›®é‡Œçš„  com.alibaba.otter.node.etl.common.db.utils.SqlUtils.java
305,canal+mysql5.5.35æŠ¥é”™ï¼šcan't find start position pid:1 nid:2 exception:canal:CTSDB-CANAL-master:com.alibaba.otter.canal.parse.exception.CanalParseException: can't find start position for CTSDB-CANAL-master ç›®æ ‡æ•°æ®åº“æ˜¯mysql-community-server-5.7.18-1 æ­£å¼ä¸šåŠ¡ç¯å¢ƒçš„æ•°æ®åº“æ˜¯mysql-5.5.35 ä¹‹å‰åœ¨æµ‹è¯•ç¯å¢ƒæºå’Œç›®çš„éƒ½æ˜¯mysql-community-server-5.7.18-1æ—¶ï¼ŒæˆåŠŸï¼Œæ¢åˆ°æ­£å¼ä¸šåŠ¡ç¯å¢ƒçš„mysql5.5æ—¶æŠ¥é”™ã€‚ canal.deployer-1.0.24 node.deployer-4.2.14 manager.deployer-4.2.14 zookeeper-3.4.10 aria2-1.19.0 +1 can't find start position for CTSDB-CANAL-masterï¼Œæ¸…ç©ºä¸€ä¸‹ä½ç‚¹æˆ–è€…è®¾ç½®ä¸€ä¸ªå­˜åœ¨çš„ä½ç‚¹
304,canal.destinationsæ”¯æŒä¸¤ä¸ªï¼ŒCanalConnectors.newClusterConnectoré‡Œçš„destinationsåªæ”¯æŒä¸€ä¸ªæ˜¯å— RT CanalConnectors.newClusterConnector è°ƒç”¨ä¸¤æ¬¡ï¼Œå°±æ”¯æŒä¸¤ä¸ªäº†ã€‚
303,ä¸€æ®µæ—¶é—´æ²¡æœ‰å»æ‹‰binlogï¼Œç›´è‡³æŠ¥é”™çš„ç–‘é—® 18:23:55.605æ”¶åˆ°æœ€åä¸€ä¸ªbinlogè¯·æ±‚ï¼Œä¸‹ä¸€ä¸ªæ—¥å¿—å°±æ˜¯2017-05-18 20:35:27.539çš„æ—¥å¿—ï¼Œ ä¸¤ä¸ªç–‘é—®ï¼š 1ã€ä¸­é—´ä¸¤ä¸ªå°æ—¶çš„binlogä¸ºä»€ä¹ˆæ²¡æœ‰å»æ‹‰ 2ã€2017-05-18 20:35:27.539  çš„æŠ¥é”™ä¸åƒæ˜¯æ‰¾ä¸åˆ°binlogæ–‡ä»¶ï¼Œè¿™ä¸ªé”™è¯¯æœ‰ä»€ä¹ˆç»éªŒèƒ½åˆ†äº«ä¸‹å—ï¼Ÿ ä¸‹é¢çš„æ˜¯æ˜¨æ™šçš„æ—¥å¿—ï¼š 2017-05-18 18:23:55.605 [New I/O server worker #1-6] INFO  c.a.otter.canal.server.embedded.CanalServerWithEmbedded - ack successfully  clientId:1001 batchId:7193361 position:PositionRange[start=LogPosition[identity=LogIdentity[sourceAddress=x/y:3306 slaveId=-1] postion=EntryPosition[included=false journalName=mysql-bin.006011 position=409700943 serverId=262651658 timestamp=1495103035000]] ack=LogPosition[identity=LogIdentity[sourceAddress=x:3306 slaveId=-1] postion=EntryPosition[included=false journalName=mysql-bin.006011 position=409702008 serverId=262651658 timestamp=1495103035000]] end=LogPosition[identity=LogIdentity[sourceAddress=x/10.157.81.57:3306 slaveId=-1] postion=EntryPosition[included=false journalName=mysql-bin.006011 position=409702008 serverId=262651658 timestamp=1495103035000]]] 2017-05-18 20:35:27.539 [destination = db50-59   address = x/y:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Connection timed out         at sun.nio.ch.FileDispatcherImpl.read0(Native Method) ~[na:1.7.0_45]         at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39) ~[na:1.7.0_45]         at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223) ~[na:1.7.0_45]         at sun.nio.ch.IOUtil.read(IOUtil.java:197) ~[na:1.7.0_45]         at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379) ~[na:1.7.0_45]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:154) ~[canal.parse-1.0.22.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70) ~[canal.parse-1.0.22.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) [canal.parse-1.0.22.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) [canal.parse-1.0.22.jar:na]         at java.lang.Thread.run(Thread.java:744) [na:1.7.0_45] 2017-05-18 20:35:27.599 [destination = db50-59   address = x/y:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address x/y:3306 has an error  retrying. caused by java.io.IOException: Connection timed out         at sun.nio.ch.FileDispatcherImpl.read0(Native Method) ~[na:1.7.0_45]         at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39) ~[na:1.7.0_45]         at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223) ~[na:1.7.0_45]         at sun.nio.ch.IOUtil.read(IOUtil.java:197) ~[na:1.7.0_45]         at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379) ~[na:1.7.0_45]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:154) ~[canal.parse-1.0.22.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70) ~[canal.parse-1.0.22.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) ~[canal.parse-1.0.22.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) ~[canal.parse-1.0.22.jar:na] 2017-05-18 20:35:27.599 [destination = db50-59   address = mangoerpdb1.mysql.rds.aliyuncs.com/10.157.81.57:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address mangoerpdb1.mysql.rds.aliyuncs.com/10.157.81.57:3306 has an error  retrying. caused by java.io.IOException: Connection timed out ä¼šä¸ä¼šæ˜¯è¿™æ®µæ—¶é—´æ•°æ®åº“è¿æ¥å¼‚å¸¸ï¼Ÿ ä¸­é—´æ²¡æœ‰æ—¥å¿—ä¸æ˜¯ä»£è¡¨æ²¡æœ‰æ‹‰å–binlogå•Š
302,ä»mysqlçš„ä»åº“ä¸­åŒæ­¥æ•°æ®è¯¥æ€ä¹ˆè§£æï¼Ÿ æ‰‹ä¸Šæœ‰ä¸¤å°mysqlï¼Œä¸€å°ä½œä¸ºmasterï¼Œä¸€å°ä½œä¸ºslaveã€‚æƒ³æŠŠcanalæ¥åˆ°slaveä¸Šã€‚ä½†æ˜¯slaveæœºå™¨ä¸ºäº†å’Œmasteræœºå™¨åŒæ­¥ï¼Œäº§ç”Ÿçš„æ˜¯[hostname]-relay-binå‘½åçš„logã€‚è¿™ç§æƒ…å†µcanalè¯¥å¦‚ä½•å’Œslaveæœºå™¨å¯¹æ¥å‘¢ã€‚å®˜æ–¹æ–‡æ¡£ä¸­åªæœ‰å¯¹æ¥mysql-binè¿™ç§å‘½åçš„æ–¹å¼ã€‚æœ‰é…ç½®çš„åœ°æ–¹å¯ä»¥è‡ªå·±è°ƒæ•´ä¹ˆï¼Ÿ çœ‹çœ‹ä¸‹é¢è¿™æ®µè¯å¯¹ä½ æœ‰æ²¡æœ‰å¸®åŠ©ã€‚ Slaveçš„é…ç½®ä¸masterç±»ä¼¼ï¼Œä½ åŒæ ·éœ€è¦é‡å¯slaveçš„MySQLã€‚å¦‚ä¸‹ï¼š log_bin           = mysql-bin server_id         = 2 relay_log         = mysql-relay-bin log_slave_updates = 1 read_only         = 1 server_idæ˜¯å¿…é¡»çš„ï¼Œè€Œä¸”å”¯ä¸€ã€‚slaveæ²¡æœ‰å¿…è¦å¼€å¯äºŒè¿›åˆ¶æ—¥å¿—ï¼Œä½†æ˜¯åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œå¿…é¡»è®¾ç½®ï¼Œä¾‹å¦‚ï¼Œå¦‚æœslaveä¸ºå…¶å®ƒslaveçš„masterï¼Œå¿…é¡»è®¾ç½®bin_logã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¼€å¯äº†äºŒè¿›åˆ¶æ—¥å¿—ï¼Œè€Œä¸”æ˜¾ç¤ºçš„å‘½å(é»˜è®¤åç§°ä¸ºhostnameï¼Œä½†æ˜¯ï¼Œå¦‚æœhostnameæ”¹å˜åˆ™ä¼šå‡ºç°é—®é¢˜)ã€‚ relay_logé…ç½®ä¸­ç»§æ—¥å¿—ï¼Œlog_slave_updatesè¡¨ç¤ºslaveå°†å¤åˆ¶äº‹ä»¶å†™è¿›è‡ªå·±çš„äºŒè¿›åˆ¶æ—¥å¿—(åé¢ä¼šçœ‹åˆ°å®ƒçš„ç”¨å¤„)ã€‚ æœ‰äº›äººå¼€å¯äº†slaveçš„äºŒè¿›åˆ¶æ—¥å¿—ï¼Œå´æ²¡æœ‰è®¾ç½®log_slave_updatesï¼Œç„¶åæŸ¥çœ‹slaveçš„æ•°æ®æ˜¯å¦æ”¹å˜ï¼Œè¿™æ˜¯ä¸€ç§é”™è¯¯çš„é…ç½®ã€‚æ‰€ä»¥ï¼Œå°½é‡ä½¿ç”¨read_onlyï¼Œå®ƒé˜²æ­¢æ”¹å˜æ•°æ®(é™¤äº†ç‰¹æ®Šçš„çº¿ç¨‹)ã€‚ä½†æ˜¯ï¼Œread_onlyå¹¶æ˜¯å¾ˆå®ç”¨ï¼Œç‰¹åˆ«æ˜¯é‚£äº›éœ€è¦åœ¨slaveä¸Šåˆ›å»ºè¡¨çš„åº”ç”¨ã€‚ canal æ˜¯æ¨¡æ‹ŸMySQLçš„ä¸»ä»  ä½ ä»slave ä¸­åŒæ­¥  ï¼Œslave ç›¸å¯¹äºcanal æ¥è¯´å°±æ˜¯master è§£æslaveä¸­çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ å¤šè°¢å¤§å®¶ï¼Œå·²æå®šï¼ è¯·é—®æ˜¯æ€ä¹ˆæå®šçš„ï¼Ÿ
301,æ— æ³•ä½¿ç”¨stop.sh ``` Distributor ID:	Ubuntu Description:	Ubuntu 16.04.2 LTS Release:	16.04 Codename:	xenial ``` ``` stop.sh: 47: [: 2211: unexpected operator -e xiaojie-VirtualBox: stopping canal 2211 ...  stop.sh: 58: [: unexpected operator stop.sh: 63: stop.sh: let: not found stop.sh: 58: [: unexpected operator stop.sh: 63: stop.sh: let: not found stop.sh: 58: [: unexpected operator stop.sh: 63: stop.sh: let: not found ``` æ˜¯æˆ‘çš„é—®é¢˜å—?  å‚è€ƒï¼š https://github.com/alibaba/canal/issues/228 åº”è¯¥ç±»ä¼¼
299,æ—¥å¿—å¼‚å¸¸dataType=DB_BATCHï¼Œæ±‚è§£å†³åŠæ³• æ—¥å¿—é”™è¯¯ä¿¡æ¯ï¼š pid:5 nid:1 exception:setl:load miss data with keys:[MemoryPipeKey[identity=Identity[channelId=2 pipelineId=5 processId=702747] time=1493745579135 dataType=DB_BATCH]] pid:5 nid:1 exception:canal:canal_é¢˜åº“:java.io.IOException: Connection reset by peer     at sun.nio.ch.FileDispatcherImpl.read0(Native Method)     at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)     at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)     at sun.nio.ch.IOUtil.read(IOUtil.java:197)     at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379)     at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:154)     at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70)     at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:121)     at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209)     at java.lang.Thread.run(Thread.java:744) Connection reset by peerï¼Œç½‘ç»œè¢«mysqlç»™æ–­å¼€äº†å§ï¼Œé‡è¯•ä¸€ä¸‹å°±å¥½
298,startup.shè„šæœ¬æœ‰é”™è¯¯ åœ¨linuxç¯å¢ƒä¸­æ‰§è¡Œå¯åŠ¨å‘½ä»¤æ—¶æŠ¥ä¸‹é¢é”™è¯¯ï¼Œå¯ä»¥æ¨æµ‹startup.shè„šæœ¬æœ‰é”™è¯¯ã€‚ [root@localhost bin]# sh startup.sh : command not found  'tartup.sh: line 4: syntax error near unexpected token `in 'tartup.sh: line 4: `case "`uname`" in [root@localhost bin]#  æ¯äººçš„ç¯å¢ƒä¸åŒï¼Œå°è¯•è°ƒæ•´ä¸€ä¸‹shellè„šæœ¬ï¼Œå¯ä»¥æäº¤ä¸€ä¸ªPRç»™æˆ‘ :set ff=unix
297,å‘ç”Ÿç½‘ç»œæŠ–åŠ¨åï¼Œcanalserverä¼šå¡ä½ï¼Œä¸èƒ½è‡ªåŠ¨æ¢å¤ é—®é¢˜æè¿°ï¼š å½“å‘ç”Ÿç½‘ç»œæŠ–åŠ¨æ—¶ï¼Œcanalserverä¼šè¢«å¡ä½ï¼Œç½‘ç»œæ¢å¤æ­£å¸¸åcanalserverä¸èƒ½è‡ªåŠ¨æ¢å¤æ­£å¸¸ï¼Œéœ€è¦æ‰‹åŠ¨é‡å¯instanceæ‰èƒ½æ¢å¤ã€‚ å¿ƒè·³æ£€æŸ¥æ˜¯å¼€å¯çš„ï¼Œå¼‚å¸¸æ ˆå¦‚ä¸‹ï¼š 2017-04-21 00:29:16.425 [destination = xxxx  address = xxxx   HeartBeatTimeTask] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - connect failed by java.io.IOException: Connection reset by peer         at sun.nio.ch.FileDispatcherImpl.read0(Native Method)         at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)         at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)         at sun.nio.ch.IOUtil.read(IOUtil.java:197)         at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379)         at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.readBytesAsBuffer(PacketManager.java:20)         at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.readHeader(PacketManager.java:13)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.readNextPacket(MysqlQueryExecutor.java:104)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.query(MysqlQueryExecutor.java:55)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:68)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser$MysqlDetectingTimeTask.run(MysqlEventParser.java:191)         at java.util.TimerThread.mainLoop(Timer.java:555)         at java.util.TimerThread.run(Timer.java:505) é™¤æ­¤ä¹‹å¤–æ²¡æœ‰å…¶å®ƒçš„å¼‚å¸¸ä¿¡æ¯ï¼Œæœ‰äººé‡åˆ°è¿™ç§æƒ…å†µä¹ˆ @agapple è¦ä¹ˆæ˜¯mysql binlogdumpçš„tcpé“¾æ¥è¢«å¼‚å¸¸æ–­å¼€äº†ï¼Œcanalæ²¡æœ‰æ„ŸçŸ¥åˆ° ä»£ç ä¸­ï¼Œæœ‰å¼‚å¸¸åº”è¯¥æ˜¯èƒ½æ•æ‰åˆ°çš„ï¼Œæ•æ‰åˆ°å¼‚å¸¸ä¼šé‡è¿é‡è¯•çš„ï¼Œä½†æ˜¯æˆ‘è¿™é‡Œæ²¡æœ‰é‡è¯•ã€‚ä½ è¯´canalæ²¡æœ‰æ„ŸçŸ¥åˆ°æ˜¯æŒ‡å¼‚å¸¸æ²¡æœ‰æ•æ‰åˆ°å— åº”è¯¥æ˜¯socketä¸€ç›´é˜»å¡åœ¨è¯»æ“ä½œä¸Šï¼Œæ²¡æœ‰æ„ŸçŸ¥åˆ°å¼‚å¸¸ @lan1994   ä»Šå¤©ä¹Ÿé‡åˆ°äº†è¿™ç§æƒ…å†µï¼Œè€Œä¸”sotimeouté»˜è®¤æ˜¯30ç§’ï¼Œå½“ç½‘ç»œä¸ç¨³å®šçš„æƒ…å†µä¸‹ï¼Œæ›´æ‹–æ…¢äº†binlogçš„æ¶ˆè´¹ã€‚  @agapple ï¼Œä¸çŸ¥é“è¿™é‡Œçš„30ç§’æœ‰ä»€ä¹ˆè®²ç©¶ æˆ‘çš„æ ˆå¥½åƒä¸å¤ªä¸€æ ·  canal 1.0.24 ``` 2017-06-27 19:50:47.285 [destination = xxxxx   address = xxxxx   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Connection reset by peer         at sun.nio.ch.FileDispatcherImpl.read0(Native Method) ~[na:1.8.0_131]         at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39) ~[na:1.8.0_131]         at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223) ~[na:1.8.0_131]         at sun.nio.ch.IOUtil.read(IOUtil.java:197) ~[na:1.8.0_131]         at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380) ~[na:1.8.0_131]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:154) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:122) [canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) [canal.parse-1.0.24.jar:na]         at java.lang.Thread.run(Thread.java:748) [na:1.8.0_131] ``` ä½ çš„è¿™ä¸ªæ ˆæˆ‘ä¹Ÿé‡åˆ°è¿‡ï¼Œé‚£ä¸ªsotimeout 30sæ²¡ä»€ä¹ˆç”¨ï¼Œå› ä¸ºè¿™ä¸ªè®¾ç½®å¯¹äºnioæ²¡æœ‰ä½œç”¨ï¼Œäº§ç”Ÿè¿™ä¸ªé—®é¢˜åº”è¯¥æ˜¯ç½‘ç»œå‡ºç°æ•…éšœåï¼Œcanal çš„è§£æçº¿ç¨‹ä¸€ç›´åœ¨readï¼Œæ²¡æœ‰æ„ŸçŸ¥åˆ°æ•…éšœ    æˆ‘ä»¬å¯èƒ½éœ€è¦ä¸€ä¸ªç±»ä¼¼sotimeout è¶…æ—¶é‡è¿çš„åŠŸèƒ½ @alexandnpu  å½“å‰masterç‰ˆæœ¬å·²ç»æä¾›ï¼Œå¯ä»¥å…³æ³¨ @agapple ï¼Œ æœ‰ç›¸å…³çš„PRå—ï¼Ÿ åˆ«äººæäº¤çš„ä¸€ä¸ªMRï¼Œä¸»è¦æ˜¯åŸºäºnettyæ”¹é€ äº†ï¼Œå¢åŠ äº†è¶…æ—¶è¯»å–ï¼Œå¯ä»¥å…³æ³¨ä¸€ä¸‹ä»£ç é‡Œçš„SocketChannel å¥½çš„ï¼Œå›å¤´æ‰¾æ‰¾ï¼Œåªæ˜¯è§‰å¾—ï¼Œä½ èƒ½æä¾›ä¸€ä¸ªprå·ï¼Œæˆ–è€…ä¸€ä¸ªcommit idï¼Œä¼šæ›´å®¹æ˜“ä¸€äº› https://github.com/alibaba/canal/pull/334 Thanks
296,å•Serveræƒ…å†µä¸‹ClusterCanalConnectoråœ¨ä¸serveræ–­å¼€é‡è¿æ—¶NullPointExceptionå¯¼è‡´restartæ— æ³•æ‰§è¡Œé—®é¢˜ ä»¥getWithoutAckæ–¹æ³•ä¸¾ä¾‹ï¼š ```java while (times < retryTimes) {     try {         Message msg = currentConnector.getWithoutAck(batchSize);         return msg;     } catch (Throwable t) {         logger.warn("something goes wrong when getWithoutAck data from server:{}\n{}"             currentConnector.getAddress()             ExceptionUtils.getFullStackTrace(t));         times++;         restart();         logger.info("restart the connector for next round retry.");     } } ``` å½“ä¸serverè¿æ¥æ–­å¼€ï¼ˆç½‘ç»œåŸå› æˆ–serverè¢«åœæ­¢ï¼‰æ—¶currentConnector.getWithoutAckæŠ›å‡ºå¼‚å¸¸ï¼Œè¿›å…¥restartæ–¹æ³•ï¼Œåœ¨è°ƒç”¨connectæ–¹æ³•ä¾ç„¶è¿æ¥å¤±è´¥æ—¶ï¼Œä¼šå°†currentConnectorç½®ä¸ºnullï¼Œè¶…è¿‡é‡è¯•æ¬¡æ•°åæŠ›å‡ºExceptionã€‚æ­¤æ—¶å†æ¬¡å°è¯•è°ƒç”¨getWithoutAckæ–¹æ³•æ—¶ï¼Œå› currentConnectorä¸ºnullï¼ŒcurrentConnector.getWithoutAckæŠ›å‡ºNullPotionExceptionï¼Œç„¶åè¢«catchä½ï¼Œåœ¨ logger.warnæ‰“å°æ—¥å¿—çš„æ—¶å€™ä½¿ç”¨äº†currentConnectorï¼Œåˆä¼šæŠ›å‡ºNullPotionExceptionï¼Œä»è€Œå¯¼è‡´restartæ–¹æ³•æ— æ³•è¢«æ‰§è¡Œã€‚åœ¨serveræ¢å¤åï¼Œç”±äºç›¸åŒåŸå› ï¼Œå®¢æˆ·ç«¯ä¾ç„¶æ— æ³•è¿æ¥ä¸Šserverã€‚ 1.0.26-SNAPSHOT ç‰ˆæœ¬ä¸Šï¼ŒgetWithoutAckå¹¶æ²¡æœ‰å¯¹è¿™ä¸ªé—®é¢˜åšä¿®æ”¹ï¼Œè¯·é—®æ˜¯å‡ºäºä»€ä¹ˆè€ƒè™‘ï¼Ÿ ä¼°è®¡é—æ¼äº†
295,canalå®¢æˆ·ç«¯æˆ–æœåŠ¡ç«¯åŸºäºzookeeperè·‘ä¸€æ®µæ—¶é—´æŒ‚äº† ç›´æ¥é‡å¯æ— æ•ˆï¼Œå¿…é¡»è¦æŠŠzookeeperé‡Œcanalç›¸å…³çš„èŠ‚ç‚¹éƒ½åˆ é™¤ï¼Œå†é‡å¯canalæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ï¼Œæ‰å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œè¿˜æœ‰æˆ‘å¼€å¯äº†HAæ¨¡å¼ï¼Œä½†ä¸ºäº†æµ‹è¯•åªè¿è¡Œäº†ä¸€ä¸ªcanalæœåŠ¡ç«¯ çœ‹ä¸‹ï¼ªï¼¶ï¼­å†…å­˜å’Œï¼§ï¼£æƒ…å†µ
294,Exception in thread "main" java.lang.UnsupportedOperationException: This is supposed to be overridden by subclasses. è¿è¡ŒClientSampleï¼Œæç¤ºThis is supposed to be overridden by subclasses. ç¯å¢ƒï¼š canal serveråœ¨linuxæœºå™¨ä¾ ç›‘å¬è¿œç¨‹linuxæœºå™¨mysqlçš„binlog åœ¨win7æœºå™¨ä½¿ç”¨ClientSampleæŠ¥é”™ protobufç‰ˆæœ¬å†²çªå§
293,fix bug of repeat log manager [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=293) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=293) before we can accept your contribution.<br/><hr/>**yinxiu** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=293) it.</sub>
292,æ€ä¹ˆåœ¨dockerä¸­å¯åŠ¨canal server æ€ä¹ˆåœ¨dockerä¸­å¯åŠ¨canal server é—®é¢˜è§£å†³äº†
291,é‡æ„LogPositionManagerå¹¶é€‚é…XMLé…ç½® ä¿®æ”¹å†…å®¹ä¸»è¦æ˜¯ä½¿ç”¨ç»„åˆçš„æ–¹å¼æ¥ä»£æ›¿åŸå…ˆMixedLogPositionManagerç»§æ‰¿MemoryLogPositionManagerçš„æ–¹å¼ã€‚æ ¸å¿ƒé€»è¾‘ä¿æŒä¸å˜ï¼ˆä¿®æ”¹åªæ˜¯ä½¿ç”¨ç»„åˆæ¥ä»£æ›¿ç»§æ‰¿è®©é€»è¾‘æ›´åŠ æ¸…æ™°ï¼‰ã€‚ [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=291) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=291) before we can accept your contribution.<br/><hr/>**yinxiu** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=291) it.</sub>
290,ç”Ÿäº§é…ç½®å’¨è¯¢ çº¿ä¸Šç¯å¢ƒï¼Œé€šè¿‡canalåµŒå…¥å¼æ–¹å¼ä½¿ç”¨ï¼Œç°åœ¨æƒ³å°†CanalLogPositionManageré…ç½®ä¸ºFailbackLogPositionManageræ¨¡å¼ï¼ŒCanalMetaManageré…ç½®ä¸ºPeriodMixedMetaManagerï¼Œæ˜¯å¦å­˜åœ¨é‡å¤æ¶ˆè´¹é—®é¢˜ï¼Ÿæ¯”å¦‚ï¼šPeriodMixedMetaManagerå®¢æˆ·ç«¯æ¶ˆè´¹æŸæ¡æ•°æ®åï¼Œè¿˜æœªæ›´æ–°cursorå¦‚zookeeperä¸­ï¼Œä»»åŠ¡è¿›è¡Œé‡å¯ï¼Œå®¢æˆ·ç«¯å°†æŒ‰ç…§zookeeperä¸­cursorè¿›è¡Œé‡å¤æ¶ˆè´¹ã€‚ ä¸ºäº†è¿½æ±‚ä¸€è‡´æ€§ï¼Œæ˜¯å¦å°†CanalMetaManageré…ç½®ä¸ºZooKeeperMetaManageræ›´ä¸ºåˆé€‚ï¼Ÿ é‡å¤æ¶ˆè´¹è¿™å—æ— æ³•é¿å…ï¼Œä½ç‚¹é‡å¤åªæ˜¯ä¸€æ–¹é¢ï¼Œè¿˜æœ‰å°±æ˜¯batchä¸€æ‰¹æ•°æ®çš„å¤„ç†ï¼Œå¦‚æœè¿›ç¨‹æŒ‚äº†ï¼Œä¸‹æ¬¡è¿˜æ˜¯ä¼šæ•´ä¸ªbatchè¿›è¡Œå¤„ç†ã€‚so.  è¿™æ ·çš„æ”¹é€ æ²¡æœ‰å¤ªå¤šçš„æ„ä¹‰
289,something goes wrong with channel ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x68949ed6  /10.253.0.5:59418 => /10.124.134.173:11111]  exception=java.io.IOException: Connection reset by peer ç½‘ç»œé‡ç½®ï¼Œå®¢æˆ·ç«¯å¢åŠ ä¸€ä¸‹é‡è¿æœºåˆ¶å§ è¿™æ˜¯æœåŠ¡ç«¯çš„å‡ºé”™å¼‚å¸¸ï¼Œå®¢æˆ·ç«¯æ²¡æœ‰å¼‚å¸¸ï¼Œæ²¡æœ‰æ–­è¿ï¼ŒæœåŠ¡ç«¯å¼€å¯HAï¼ˆdefault-instance.xmlï¼‰åå°±å‡ºç°äº†è¿™ç§æƒ…å†µ æˆ‘è¿™é‡Œæ˜¯å¤šä¸ªå®¢æˆ·ç«¯è¿æ¥äº†æœåŠ¡å™¨æŠ¥çš„é”™ï¼Œå¤šåœ°ç›‘å¬ä¼šæœ‰è¿™ä¸ªé—®é¢˜ï¼Œåªå¯ä¸€ä¸ªå°±å¥½äº†ã€‚ è°¢è°¢å¤§ç‰›ä»¬ï¼Œé—®é¢˜è§£å†³äº†ï¼Œæ˜¯zookeeperçš„é—®é¢˜ï¼Œé‡å®‰äº†ä¸€ä¸ªå¥½äº†ï¼Œæ–°æ‰‹å­¦ä¹ ï¼Œå¤šå¤šåŒ…æ¶µ @agapple æˆ‘ä¹Ÿå‡ºç°äº†è¿™ç§æƒ…å†µï¼Œå®¢æˆ·ç«¯æ€ä¹ˆå¢åŠ é‡è¿æœºåˆ¶å‘¢ï¼Ÿ çœ‹ä¸€ä¸‹exampleçš„clientä»£ç 
288,ä¸guava 20æœ‰å…¼å®¹é—®é¢˜ï¼Œguava 18 MapMaker.makeComputingMapæ–¹æ³•å·²è¿‡æ—¶ Exception in thread "main" java.lang.NoSuchMethodError: com.google.common.collect.MapMaker.makeComputingMap(Lcom/google/common/base/Function;)Ljava/util/concurrent/ConcurrentMap; 	at com.google.common.collect.MigrateMap.makeComputingMap(MigrateMap.java:17) 	at com.alibaba.otter.canal.common.zookeeper.ZkClientx.<clinit>(ZkClientx.java:26) 	at com.alibaba.otter.canal.client.CanalConnectors.newClusterConnector(CanalConnectors.java:66) è€ƒè™‘æäº¤ä¸€ä¸ªPRç»™æˆ‘æŠŠï¼Œguava 20ç›®å‰å†…éƒ¨è¿˜æ²¡äººç”¨ä¸Š è‡ªå·±å®ç°äº†CanalNodeAccessStrategyè§£å†³äº† @Luckywb æ€ä¹ˆå®ç°çš„ï¼Ÿ @Luckywb èƒ½æŠŠå®ç°çš„åŸç†å‘å¸ƒä¸€ä¸‹å—ï¼Ÿé‡åˆ°åŒæ ·çš„é—®é¢˜äº†
287,jsonç±»å‹å­—æ®µbug æœ‰ä¸ªbugåœ¨1.0.23ä¸‹ com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: java.lang.IllegalArgumentException: illegal json data at com.taobao.tddl.dbsync.binlog.JsonConversion.parse_scalar(JsonConversion.java:150) at com.taobao.tddl.dbsync.binlog.JsonConversion.parse_value(JsonConversion.java:67) æ•°æ®åº“ç‰ˆæœ¬ mysql-5.7.11-winx64 æ•°æ®åº“ç»“æ„ CREATE TABLE customer_data ( id bigint(19) unsigned NOT NULL AUTO_INCREMENT supplier_id bigint(19) unsigned NOT NULL COMMENT 'å•†æˆ·id' customer_id bigint(19) unsigned NOT NULL customer_data json DEFAULT NULL COMMENT 'é¡¾å®¢æ ‡å‡†å±æ€§' customer_ext_data json DEFAULT NULL COMMENT 'é¡¾å®¢æ‰©å±•å±æ€§' PRIMARY KEY (id) UNIQUE KEY uk_cust (customer_id) ) ENGINE=InnoDB AUTO_INCREMENT=26036 DEFAULT CHARSET=utf8mb4; debugåå°±æ˜¯149è¡Œstr_len==0 @agapple  ç»™å‡ºä½ æœ‰é—®é¢˜çš„jsonå­—ç¬¦ä¸² `{"æ€§åˆ«": "ç”·"  "æ‰‹æœºå·": "1860652"  "cardNumber": ""  "å¾®ä¿¡æ˜µç§°": "Peter"}` 
286,refactoring log position manager module é‡æ„log positionæ¨¡å—ï¼Œæ²¡æœ‰æ”¹å˜æ ¸å¿ƒé€»è¾‘ï¼Œé‡‡ç”¨ç»„åˆçš„æ¨¡å¼ä½¿ä»£ç é€»è¾‘æ›´åŠ æ¸…æ™° [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=286) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=286) before we can accept your contribution.<br/><hr/>**yinxiu** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=286) it.</sub>
285,CanalæŠ¥æ‰¾ä¸åˆ°binlog file 2017-03-17 15:17:27.000 [destination = qbo   address = /10.0.0.68:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - **Didn't find the corresponding binlog files from mysql-bin.000001 to mysql-bin.000004** 2017-03-17 15:17:27.005 [destination = qbo   address = /10.0.0.68:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /10.0.0.68:3306 has an error  retrying. caused by com.alibaba.otter.canal.parse.exception.CanalParseException: can't find start position for qbo 2017-03-17 15:17:27.008 [destination = qbo   address = /10.0.0.68:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:qbo[com.alibaba.otter.canal.parse.exception.CanalParseException: can't find start position for qbo ] canal ç‰ˆæœ¬ 1.0.24 mysqlç‰ˆæœ¬ 5.6.33 ä¸»åº“çŠ¶æ€ mysql> show master status; +------------------+----------+--------------+------------------+-------------------+ | File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set | +------------------+----------+--------------+------------------+-------------------+ | mysql-bin.000004 |     1507 |              |                  |                   | +------------------+----------+--------------+------------------+-------------------+ 1 row in set (0.00 sec) å®Œæ•´æ—¥å¿—åœ¨é™„ä»¶ä¸­ [qbo.log.txt](https://github.com/alibaba/canal/files/849900/qbo.log.txt) è¿™å¼‚å¸¸æ˜¯ä½ æŒ‡å®šçš„æ—¶é—´æˆ³ï¼Œæ¯”ç°åœ¨çš„ä»»ä½•binlogæ–‡ä»¶éƒ½æ—©ï¼Œè°ƒæ•´ä¸€ä¸‹ä½ç‚¹
284,here comes an MySQL bug between MySQL 5.6.20 & MySQL5.6.34 for MySQL5.6.20 have not compatible with MySQL5.5  so it will no kill zombie thread without the slave uuid ![mysql5 6 20](https://cloud.githubusercontent.com/assets/22068461/24030521/6586639a-0b18-11e7-8014-068073ee5408.png) ![mysql5 6 34](https://cloud.githubusercontent.com/assets/22068461/24030527/6efc0060-0b18-11e7-8484-037403014128.png) fix this bug for using set @slave_uuid="${uuid}" command before dump æˆ‘çœ‹ä¸€ä¸‹ï¼Œå¯èƒ½ä¹Ÿæ˜¯å› ä¸ºè¿™ä¸ªå¾ˆå¤šç”¨æˆ·åé¦ˆé“¾æ¥å¼‚å¸¸æ–­å¼€çš„ä¸€ä¸ªé—®é¢˜ å¯ä»¥å‚è€ƒä¸‹MySQLæºç çš„å®ç° åœ¨å»ºç«‹IOçº¿ç¨‹åˆ°Masterçš„æ—¶å€™ ä¼šè®¾ç½®ä¸€ä¸‹uuid > /** >   Set user variables after connecting to the master. >  >   @param  mysql MYSQL to request uuid from master. >   @param  mi    Master_info to set master_uuid >  >   @return 0: Success  1: Fatal error  2: Network error. > */ > int io_thread_init_commands(MYSQL *mysql  Master_info *mi) > { >   char query[256]; >   int ret= 0; >  >   sprintf(query  "SET @slave_uuid= '%s'"  server_uuid); >   if (mysql_real_query(mysql  query  strlen(query)) >       && !check_io_slave_killed(mi->info_thd  mi  NULL)) >     goto err; çœ‹äº†mysql5.6çš„æºç ï¼Œå®ƒåº”è¯¥æ˜¯å…¼å®¹äº†mysql5.5 clientçš„serverIdçš„dumpï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®slave_uuidé»˜è®¤ä¹Ÿä¼šæ˜¯åŸºäºserverIdè¿›è¡Œåˆ¤æ–­.  å¢åŠ slave_uuidä¹‹åå¯ä»¥é¿å…å¯¹äºslaveIdä¸åŒçš„å¼ºä¾èµ–
283,upgrade fastjson for security [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=283) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=283) before we can accept your contribution.<br/><hr/>**fengyong** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=283) it.</sub> tks
282,Update JsonUtils.java ä¿®å¤å‡çº§fastjsonåˆ°1.2.28åJSONUtilsæŠ¥é”™çš„é—®é¢˜ [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=282) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=282) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=282) it.</sub> pomé‡Œé¢çš„ç‰ˆæœ¬å·ä¹Ÿè¦æ”¹ä¸€ä¸‹å§ï¼Ÿ tks 
281,fastjsoné«˜å±æ¼æ´ ä¸çŸ¥é“æœ‰æ²¡æœ‰å½±å“ https://github.com/alibaba/fastjson/wiki/security_update_20170315 see #283 æˆ‘å…³æ³¨ä¸€ä¸‹
280,[bug]TableMetaCache åœ¨è¿æ¥æ–­äº†åçš„reconnectåŠŸèƒ½æ— æ•ˆ masterä¸Šçš„æºä»£ç ï¼š ``` public TableMetaCache(MysqlConnection con){         this.connection = con;         tableMetaCache = MigrateMap.makeComputingMap(new Function<String  TableMeta>() {             public TableMeta apply(String name) {                 try {                     return getTableMeta0(name);                 } catch (IOException e) {                     // å°è¯•åšä¸€æ¬¡retryæ“ä½œ                     try {                         connection.reconnect();                         System.out.println("cclehui é‡æ–° connect master");                         return getTableMeta0(name);                     } catch (IOException e1) {                         throw new CanalParseException("fetch failed by table meta:" + name  e1);                     }                 }             }         }); ``` å¯ä»¥çœ‹åˆ°åœ¨æ•è·åˆ°IOException åä¼šè‡ªåŠ¨é‡è¿ä¸€æ¬¡ï¼Œç„¶ååœ¨è·å–è¡¨ç»“æ„ã€‚ä½†é—®é¢˜åœ¨äºå¦‚æœmysql masterä¸»åŠ¨å…³é—­äº†è¿æ¥ï¼Œæ ¹æœ¬ä¸ä¼šæŠ›å‡ºè¿™ä¸ªIOException  ç›¸åæŠ›å‡ºçš„æ˜¯ä¸€ä¸ª RuntimeExceptionï¼Œç›¸åº”çš„å¼‚å¸¸æŠ›å‡ºä»£ç åœ¨ MysqlQueryExecutor  29è¡Œï¼š ``` public MysqlQueryExecutor(MysqlConnector connector) throws IOException {         if (!connector.isConnected()) {//æœåŠ¡å™¨å…³é—­è¿æ¥åä¼šèµ°è¿™ä¸ªé€»è¾‘æŠ›å‡ºå¼‚å¸¸             throw new RuntimeException("should execute connector.connect() first");         }         this.channel = connector.getChannel();     } ``` å¦‚ä¸Šæ‰€è¿°ï¼Œé‡è¿é€»è¾‘æ²¡æœ‰ç”Ÿæ•ˆã€‚ bugå¤ç°æ–¹æ³•ï¼š æŠŠ master mysql çš„ wait_timeout è®¾ç½®æˆ20ç§’ï¼Œ å¯åŠ¨canalåç­‰20ç§’ï¼Œ å»masteråšä¸€äº›insertæˆ–updateæ“ä½œï¼Œ canal slaveå¾—åˆ°è¿™ä¸ªbinlogåï¼Œè§£æï¼Œå¦‚æœæœ¬åœ°æ²¡æœ‰æ ‡ç»“æ„ä¿¡æ¯ï¼Œå°±ä¼šé€šè¿‡ä¸€ä¸ªéslaveè¿æ¥å»masterè·å–è¡¨ç»“æ„ä¿¡æ¯ï¼Œ ä½†20ç§’åmasterå·²å…³é—­è¯¥è¿æ¥ï¼Œè¿™æ—¶å€™å°±æŠ›å‡ºäº†RuntimeException ï¼Œ ç„¶åè¿™ä¸ªbinlogäº‹ä»¶å°±è§£æå¤±è´¥äº†ã€‚ æˆ‘çš„è§£å†³æ–¹æ³•:æŠŠRuntimeException æ”¹æˆ IOException æŠ›å‡ºï¼Œä½†ä¸çŸ¥é“ä¼šä¸ä¼šæœ‰ä»€ä¹ˆåˆ«çš„é—®é¢˜ å½“ç„¶æˆ‘è‡ªå·±æµ‹è¯•OK ``` public MysqlQueryExecutor(MysqlConnector connector) throws IOException {         if (!connector.isConnected()) { //            throw new RuntimeException("should execute connector.connect() first");             throw new IOException("should execute connector.connect() first");         }         this.channel = connector.getChannel();     } ``` æˆ‘ä¹Ÿé‡åˆ°äº†åŒæ ·çš„é—®é¢˜ï¼Œæ ¹æ®æ¥¼ä¸»çš„æ–¹æ³•ä¹Ÿå¯ä»¥é‡ç° è¿˜æœ‰å¦å¤–ä¸€ä¸ªä¿¡æ¯ï¼Œç†è®ºä¸Šcanal serveråœ¨é‡åˆ°å¼‚å¸¸ä¹‹åæ˜¯ä¼šé‡è¯•çš„ï¼Œå¦‚ä¸‹ï¼š ![retry](https://cloud.githubusercontent.com/assets/3198806/23950250/4cf424ba-09c5-11e7-8439-a683e064a3ee.png) ä»æ—¥å¿—ä¸Šæ¥çœ‹ä¹Ÿç¡®å®é‡è¯•äº†ï¼Œå¹¶ä¸”æ¢å¤äº†æ­£å¸¸ï¼š ![retry_log_1](https://cloud.githubusercontent.com/assets/3198806/23950630/937491f8-09c6-11e7-83c6-bd15f16b34a7.png) ä½†æ˜¯åé¢è¿‡æ®µæ—¶é—´DBé“¾æ¥å†æ¬¡æ–­æ‰ä¹‹åå´æ²¡æœ‰é‡è¯•æˆåŠŸæ—¥å¿—ï¼š ![retry_log_2](https://cloud.githubusercontent.com/assets/3198806/23950657/b04fb302-09c6-11e7-919a-61e1f6b488cf.png) ç„¶åæ‰‹åŠ¨åœæ­¢canal serverï¼Œä¼šæŠ¥ä»¥ä¸‹é”™è¯¯ï¼š ![retry_log_3](https://cloud.githubusercontent.com/assets/3198806/23950700/d4f989a8-09c6-11e7-9e19-ed071a0caf11.png) æœŸå¾…å®Œç¾è§£å†³æ–¹æ¡ˆ..................
279,è¿è¡Œå®¢æˆ·ç«¯  batchIdå¶å°”å‡ºç°å†²çªé—®é¢˜  batchId:2176966 is not the firstly:2176965         at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.receiveMessages(SimpleCanalConnector.java:302)     at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:279)         at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:252)         at com.yagou.yggx.provider.datasync.start.AbstractCanalStart.process(AbstractCanalStart.java:115) ä¸‹é¢æ˜¯ä»£ç ï¼š int batchSize = 5 * 1024; 		while (running) { 			try { 				MDC.put("destination"  destination); 				connector.connect(); 				connector.subscribe(); 				while (running) {				 					// è·å–æŒ‡å®šæ•°é‡çš„æ•°æ® 					Message message = connector.getWithoutAck(batchSize); 					long batchId = message.getId(); 					int size = message.getEntries().size(); 					List<Entry> entrys = message.getEntries(); 					if (batchId == -1 || size == 0) { 						// try {Thread.sleep(1000); 						// } catch (InterruptedException e) { } 					} else { 						DataSourceListenerInformation.comeOutEntry(entrys); 					} 					connector.ack(batchId); // æäº¤ç¡®è®¤ åŒæ ·ç¢°åˆ°è¿™ä¸ªé—®é¢˜ï¼Œè¯·é—®ä½ è¿™ä¸ªæœ€åæ˜¯æ€ä¹ˆè§£å†³çš„ ä¸€ä¸ªdestination å¯¹åº”ä¸€ä¸ªæ¶ˆè´¹ç«¯ã€‚å¤šä¸ªæ¶ˆè´¹ç«¯åŒæ—¶æ¶ˆè´¹åŒä¸€ä¸ªdestinationï¼Œå°±ä¼šæŠ¥batchIdä¸å­˜åœ¨æˆ–ä¸æ˜¯ä½ç‚¹
278,canal server cpu 100% @agapple  ç‰ˆæœ¬æ˜¯æœ€æ–°çš„masterï¼Œæˆ‘æ˜¯ä»4å¤©å‰çš„ä¸€ä¸ªbinlog posç‚¹å¼€å§‹åŒæ­¥çš„ï¼Œå‘ç°åŒæ­¥é€Ÿåº¦è·Ÿä¹‹å‰ç›¸æ¯”æ…¢å¾ˆå¤šï¼Œtopå‘ç°canal server cpuä¸€ç›´100%ï¼Œç»è¿‡å®šä½æ‰¾åˆ°å¦‚ä¸‹æ ˆï¼š ![cpu](https://cloud.githubusercontent.com/assets/3198806/23615030/0adf5ef2-02c0-11e7-9334-fc3c3e399d6e.png) å†…å­˜å½“æ—¶æ˜¯ï¼š              total       used       free     shared    buffers     cached Mem:         32047      24349       7698          0        274      13740 -/+ buffers/cache:      10333      21713 Swap:          511        189        322 è¿™å—æ˜¯æœ‰æ–°åŒå­¦æäº¤çš„netty4çš„å®ç°ï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›é—®é¢˜ å¯ä»¥å°è¯•ç”¨æœ€æ–°çš„1.1.1ç‰ˆæœ¬ï¼Œå·²ä¼˜åŒ–
277,é…ç½®è‡ªåŠ¨æ›´æ–°åŠŸèƒ½ä¸ç¨³å®š ``` scan reload found[local] but reload failed ``` é‡å¯å°±å¯ä»¥ æŠŠå®Œæ•´çš„å¼‚å¸¸è´´æ¸…æ¥š
276,canal æœåŠ¡ç«¯æ˜¾ç¤ºæŸä¸ªé…ç½®æˆåŠŸï¼Œä½†clientç«¯å¼‚å¸¸ ``` 2017-03-06 15:19:16.800 [canal-instance-scan-0] INFO  c.a.o.canal.deployer.monitor.SpringInstanceConfigMonitor - auto notify reload local successful. ``` æ—¥å¿—æ˜¾ç¤º local è¿™ä¸ªinstanceæˆåŠŸï¼Œä½†clientæŠ¥å¼‚å¸¸ï¼š ``` com.alibaba.otter.canal.protocol.exception.CanalClientException: something goes wrong with reason: something goes wrong with channel:[id: 0x3f655fa5  /127.0.0.1:65443 => /127.0.0.1:11111]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: destination:local should start first 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.receiveMessages(SimpleCanalConnector.java:302) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:279) 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:252) 	at com.alibaba.otter.canal.example.RockyDemo.main(RockyDemo.java:38) 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) 	at java.lang.reflect.Method.invoke(Method.java:498) 	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147) ``` æœåŠ¡ç«¯å¯èƒ½å‘ç”Ÿäº†é‡å¯ï¼Œclientå¤šé‡è¯•
275,canal.instance.filter.regex å‚æ•°ä¸èµ·ä½œç”¨ canal.instance.filter.regex = demodbname\\\\.user è¿™æ ·è®¾ç½®åï¼Œclientç«¯è¿˜æ˜¯ä¼šæ¥å—åˆ°æ¥æ”¶åˆ°éuserè¡¨çš„binlogæ—¥å¿—ä¿¡æ¯ã€‚ ä½¿ç”¨ç‰ˆæœ¬ï¼š 1.0.23 [zk: localhost:2181(CONNECTED) 44] get /otter/canal/destinations/example/1001/filter .*\..* cZxid = 0x1000013e8 ctime = Fri Mar 03 11:26:12 CST 2017 ..................... .................... [zk: localhost:2181(CONNECTED) 48] set /otter/canal/destinations/example/1001/filter demodbname\\.user   è¯•è¯•ï¼Œzk ä¸­è²Œä¼¼è®°å½•äº†åˆå§‹å€¼ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶åï¼Œé‡å¯æœåŠ¡ï¼Œè²Œä¼¼zkä¸­çš„å€¼æ²¡æœ‰ä¿®æ”¹è¿‡æ¥ï¼Œå¯¼è‡´çš„ å‚æ•°ä¸èµ·ä½œç”¨ï¼Œä¸ªäººçŒœæµ‹çš„  
274,è§£æbinlogæ—¥å¿—å¤±è´¥            canalè¿è¡Œåè§£æbinlogæ—¥å¿—çš„æ—¶å€™å‡ºç°é”™è¯¯ï¼Œæç¤ºRead Q_SQL_MODE_CODE error: limit excceed: 67 æˆ‘çœ‹äº†canalçš„éƒ¨åˆ†æºç ï¼Œè²Œä¼¼æ˜¯sql_modeè®¾ç½®çš„ä¸å¯¹ï¼ŸSQL_modeåœ¨canalé‡Œå®šä¹‰æ˜¯64ä½çš„æ‰€ä»¥ç”¨getLong64ï¼Œä½†æ˜¯å®é™…æ˜¯67å¯¼è‡´è¶Šç•Œäº†ï¼Ÿæ²¡çœ‹å‡ºæ•°æ®åº“çš„æ•°æ®æœ‰å•¥é—®é¢˜ PS: mysqlç‰ˆæœ¬æ˜¯5.7.14 mysqlbinlogçš„æ—¥å¿—ï¼š ------------------------------------------------------------------- è§é™„ä»¶ ![binlog](https://cloud.githubusercontent.com/assets/2059502/23546331/104ef6f0-003a-11e7-8f0c-40f50a85356c.png) [binlog.txt](https://github.com/alibaba/canal/files/816403/binlog.txt) canalå®ä¾‹æ—¥å¿—ï¼š ----------------------------------------------------------------- 2017-03-03 17:17:19.952 [destination = gene_cachenotice_play3   address = /172.16.10.213:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position  {"identity":{"slaveId":-1 "sourceAddress":{"address":"172.16.10.213" "port":3306}} "postion":{"included":false "journalName":"mysql-bin.000016" "position":24856433 "serverId":213 "timestamp":1488484784000}} 2017-03-03 17:17:19.959 [destination = gene_cachenotice_play3   address = /172.16.10.213:3306   EventParser] WARN  com.taobao.tddl.dbsync.binlog.LogDecoder - Decoding Query failed from: mysql-bin.000016:24858343 java.io.IOException: Read Q_SQL_MODE_CODE error: limit excceed: 67 	at com.taobao.tddl.dbsync.binlog.event.QueryLogEvent.unpackVariables(QueryLogEvent.java:650) ~[canal.parse.dbsync-1.0.23.jar:na] 	at com.taobao.tddl.dbsync.binlog.event.QueryLogEvent.<init>(QueryLogEvent.java:477) ~[canal.parse.dbsync-1.0.23.jar:na] 	at com.taobao.tddl.dbsync.binlog.LogDecoder.decode(LogDecoder.java:154) ~[canal.parse.dbsync-1.0.23.jar:na] 	at com.taobao.tddl.dbsync.binlog.LogDecoder.decode(LogDecoder.java:106) ~[canal.parse.dbsync-1.0.23.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:123) [canal.parse-1.0.23.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) [canal.parse-1.0.23.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_25] Caused by: java.lang.IllegalArgumentException: limit excceed: 67 	at com.taobao.tddl.dbsync.binlog.LogBuffer.getLong64(LogBuffer.java:873) ~[canal.parse.dbsync-1.0.23.jar:na] 	at com.taobao.tddl.dbsync.binlog.event.QueryLogEvent.unpackVariables(QueryLogEvent.java:566) ~[canal.parse.dbsync-1.0.23.jar:na] 	... 6 common frames omitted 2017-03-03 17:17:19.960 [destination = gene_cachenotice_play3   address = /172.16.10.213:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address 172.16.10.213/172.16.10.213:3306 has an error  retrying. caused by  java.io.IOException: Read Q_SQL_MODE_CODE error: limit excceed: 67 	at com.taobao.tddl.dbsync.binlog.event.QueryLogEvent.unpackVariables(QueryLogEvent.java:650) ~[canal.parse.dbsync-1.0.23.jar:na] 	at com.taobao.tddl.dbsync.binlog.event.QueryLogEvent.<init>(QueryLogEvent.java:477) ~[canal.parse.dbsync-1.0.23.jar:na] 	at com.taobao.tddl.dbsync.binlog.LogDecoder.decode(LogDecoder.java:154) ~[canal.parse.dbsync-1.0.23.jar:na] 	at com.taobao.tddl.dbsync.binlog.LogDecoder.decode(LogDecoder.java:106) ~[canal.parse.dbsync-1.0.23.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:123) ~[canal.parse-1.0.23.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) ~[canal.parse-1.0.23.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_25] Caused by: java.lang.IllegalArgumentException: limit excceed: 67 	at com.taobao.tddl.dbsync.binlog.LogBuffer.getLong64(LogBuffer.java:873) ~[canal.parse.dbsync-1.0.23.jar:na] 	at com.taobao.tddl.dbsync.binlog.event.QueryLogEvent.unpackVariables(QueryLogEvent.java:566) ~[canal.parse.dbsync-1.0.23.jar:na] 	... 6 common frames omitted 2017-03-03 17:17:19.960 [destination = gene_cachenotice_play3   address = /172.16.10.213:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:gene_cachenotice_play3[java.io.IOException: Read Q_SQL_MODE_CODE error: limit excceed: 67 	at com.taobao.tddl.dbsync.binlog.event.QueryLogEvent.unpackVariables(QueryLogEvent.java:650) 	at com.taobao.tddl.dbsync.binlog.event.QueryLogEvent.<init>(QueryLogEvent.java:477) 	at com.taobao.tddl.dbsync.binlog.LogDecoder.decode(LogDecoder.java:154) 	at com.taobao.tddl.dbsync.binlog.LogDecoder.decode(LogDecoder.java:106) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:123) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) 	at java.lang.Thread.run(Thread.java:745) Caused by: java.lang.IllegalArgumentException: limit excceed: 67 	at com.taobao.tddl.dbsync.binlog.LogBuffer.getLong64(LogBuffer.java:873) 	at com.taobao.tddl.dbsync.binlog.event.QueryLogEvent.unpackVariables(QueryLogEvent.java:566) 	... 6 more ] mysql 5.7.14ç‰ˆæœ¬è¿˜æ²¡æµ‹è¯•è¿‡ï¼Œå¯èƒ½æ˜¯æœ‰åè®®å˜æ›´ æ”¹äº†ä¸€ä¸ªä»£ç ï¼Œå¸®æˆ‘éªŒè¯ä¸€ä¸‹mysql 5.7.14ç¯å¢ƒæ˜¯å¦å¯ä»¥æ­£å¸¸è§£æï¼Œè°¢è°¢ã€‚éªŒè¯okä¹‹åå›å¤ä¸€ä¸‹ä¿¡æ¯
273,æŠ¥é”™ï¼Œè½¬æ¢å¼‚å¸¸ java.lang.ClassCastException: com.alibaba.otter.canal.parse.inbound.AbstractEventParser$4 cannot be cast to com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser$MysqlDetectingTimeTask 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.stopHeartBeat(MysqlEventParser.java:186) ~[canal.parse-1.0.23.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.stop(AbstractEventParser.java:282) ~[canal.parse-1.0.23.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.stop(MysqlEventParser.java:165) ~[canal.parse-1.0.23.jar:na] 	at com.alibaba.otter.canal.instance.core.AbstractCanalInstance.stop(AbstractCanalInstance.java:104) ~[canal.instance.core-1.0.23.jar:na] 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.stop(CanalServerWithEmbedded.java:85) ~[canal.server-1.0.23.jar:na] 	at com.alibaba.otter.canal.server.netty.CanalServerWithNetty.stop(CanalServerWithNetty.java:95) [canal.server-1.0.23.jar:na] 	at com.alibaba.otter.canal.deployer.CanalController.stop(CanalController.java:422) [canal.deployer-1.0.23.jar:na] 	at com.alibaba.otter.canal.deployer.CanalLauncher$1.run(CanalLauncher.java:42) [canal.deployer-1.0.23.jar:na] æ–°çš„masterä»£ç å·²ç»ä¿®å¤
272,serverå¯åŠ¨å example instance å’Œmaster ä¸€ä¼šå°±è«åçš„æ–­å¼€è¿æ¥ ï¼Œ æ²¡æœ‰ä»»ä½•Log æˆ‘æ˜¯2017-02-27ä»masterä¸Šæ‹‰å–çš„åˆ†æ”¯ç¼–è¯‘çš„ï¼Œ Mysqlç‰ˆæœ¬ï¼š5.5.32 å¯åŠ¨æœåŠ¡ï¼šæ­£å¸¸ ``` 2017-03-02 17:27:58.627 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## start the canal server. 2017-03-02 17:27:58.924 [main] INFO  com.alibaba.otter.canal.deployer.CanalController - ## start the canal server[my ip :11111] 2017-03-02 17:28:00.401 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## the canal server is running now ...... ``` example instance å¯åŠ¨å¤±è´¥ï¼Œ è¯¥instanceå¯åŠ¨è¿æ¥ä¸Šäº†mysqlï¼Œ ç„¶åè«åå¥‡å¦™çš„åšäº†ä¸€ä¸ª disConnect  æ–­å¼€äº†é“¾æ¥ ï¼Œ æ²¡æœ‰ç„¶åå°±æ²¡æœ‰ä»»ä½•logäº† ï¼Œ æœåŠ¡è¿˜æ˜¯åœ¨è¿è¡Œï¼Œä½†è¯¥instanceæ²¡æœ‰èµ·æ¥ ï¼Œ å’Œmysqlçš„é“¾æ¥ä¹Ÿæ²¡æœ‰å»ºç«‹èµ·æ¥ ã€‚è€Œä¸”å¾ˆå¥‡æ€ªçš„æ˜¯è¿æ¥äº†ä¸¤æ¬¡mysql ã€‚ instanceçš„å¯åŠ¨logå¦‚ä¸‹  ``` 2017-03-02 17:27:59.019 [main] INFO  o.s.context.support.ClassPathXmlApplicationContext - Refreshing org.springframework.context.support.ClassPathXmlApplicationContext@68bbe345: display name [org.springframework.context.support.ClassPathXmlApplicationContext@68bbe345]; startup date [Thu Mar 02 17:27:59 CST 2017]; root of context hierarchy 2017-03-02 17:27:59.133 [main] INFO  o.s.beans.factory.xml.XmlBeanDefinitionReader - Loading XML bean definitions from class path resource [spring/file-instance.xml] 2017-03-02 17:27:59.516 [main] INFO  o.s.context.support.ClassPathXmlApplicationContext - Bean factory for application context [org.springframework.context.support.ClassPathXmlApplicationContext@68bbe345]: org.springframework.beans.factory.support.DefaultListableBeanFactory@78186a70 2017-03-02 17:27:59.642 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [canal.properties] 2017-03-02 17:27:59.643 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [example/instance.properties] 2017-03-02 17:27:59.697 [main] INFO  o.s.beans.factory.support.DefaultListableBeanFactory - Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@78186a70: defining beans [com.alibaba.otter.canal.instance.spring.support.PropertyPlaceholderConfigurer#0 socketAddressEditor org.springframework.beans.factory.config.CustomEditorConfigurer#0 instance alarmHandler metaManager eventStore eventSink eventParser]; root of factory hierarchy 2017-03-02 17:27:59.851 [main] WARN  org.springframework.beans.TypeConverterDelegate - PropertyEditor [com.sun.beans.editors.EnumEditor] found through deprecated global PropertyEditorManager fallback - consider using a more isolated form of registration  e.g. on the BeanWrapper/BeanFactory! 2017-03-02 17:28:00.131 [main] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start CannalInstance for 1-example  2017-03-02 17:28:00.158 [main] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - start successful.... 2017-03-02 17:28:00.158 [main] INFO  c.a.otter.canal.server.embedded.CanalServerWithEmbedded - start CanalInstances[example] successfully 2017-03-02 17:28:00.177 [destination = example   address = /127.0.0.1:3306   EventParser] INFO  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - start heart beat....  2017-03-02 17:28:00.936 [destination = example   address = /127.0.0.1:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - connect MysqlConnection to /127.0.0.1:3306... 2017-03-02 17:28:00.944 [destination = example   address = /127.0.0.1:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - handshake initialization packet received  prepare the client authentication packet to send 2017-03-02 17:28:00.973 [destination = example   address = /127.0.0.1:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - client authentication packet is sent out. 2017-03-02 17:28:00.989 [destination = example   address = /127.0.0.1:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - connect MysqlConnection to /127.0.0.1:3306... 2017-03-02 17:28:00.991 [destination = example   address = /127.0.0.1:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - handshake initialization packet received  prepare the client authentication packet to send 2017-03-02 17:28:00.991 [destination = example   address = /127.0.0.1:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - client authentication packet is sent out. 2017-03-02 17:28:00.993 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just show master status 2017-03-02 17:28:01.013 [destination = example   address = /127.0.0.1:3306   EventParser] INFO  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - find start position : EntryPosition[included=false journalName=mysql-bin.000004 position=121250 serverId=<null> timestamp=<null>] 2017-03-02 17:28:01.023 [destination = example   address = /127.0.0.1:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - disConnect MysqlConnection to /127.0.0.1:3306... ``` mysql çš„ tcpè¿æ¥æƒ…å†µï¼š åˆšå¯åŠ¨çš„æ—¶å€™ï¼š ``` tcp        0      0 127.0.0.1:3306          127.0.0.1:60383         ESTABLISHED 18565/mysqld               tcp        0      0 127.0.0.1:60383         127.0.0.1:3306          ESTABLISHED 1273/java        tcp        0      0 127.0.0.1:3306          127.0.0.1:60381         ESTABLISHED 18565/mysqld     tcp        0      0 127.0.0.1:60381         127.0.0.1:3306          ESTABLISHED 1273/java ``` è¿‡ä¸€ä¼šè¿™ä¸¤ä¸ªè¿æ¥éƒ½æ–­äº† è¿™ä¸ªé—®é¢˜å·²ç»æ‰¾åˆ°åŸå› äº†ï¼Œæˆ‘è‡ªå·±çš„æµ‹è¯•mysqlæœåŠ¡å™¨é…ç½®çš„ interactive_timeout å’Œ wait_timeout åˆ†åˆ«ä¸º30ã€20 ï¼Œ è¿‡äº†20ç§’åmysql ä¸»åŠ¨å…³é—­ä¸æ´»è·ƒçš„è¿æ¥
271,fetch failed by table meta:`mysql`.`user` æ˜¨æ™šä¸Š11ï¼š50ä¹‹å‰éƒ½æ­£å¸¸ï¼Œä¹‹åçªç„¶å‡ºç°äº†é—®é¢˜ï¼Œçœ‹èµ·æ¥å’Œæƒé™ç›¸å…³ çº¿ä¸Šç”¨çš„æ˜¯RDSï¼Œ æµ‹è¯•çº¿è‡ªå·±çš„æœºå™¨canalæ²¡æœ‰å¼‚å¸¸ 2017-02-28 23:49:51.829 [destination = example   address = /XXX.178.61.230:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEvent Parser - ERROR ## parse this event has an error   last position : [EntryPosition[included=false journalName=mysql-bin.000302 position=5492156 serve rId=3071795599 timestamp=1488296991000]] com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.collect.ComputationException: com.alibaba.otter.canal.parse.exception.CanalParseException: fetch failed by table meta:`mysql`.`user` Caused by: com.google.common.collect.ComputationException: com.alibaba.otter.canal.parse.exception.CanalParseException: fetch failed by table meta: `mysql`.`user`         at com.google.common.collect.MapMaker$ComputingMapAdapter.get(MapMaker.java:889) ~[guava-18.0.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:78) ~[canal.parse-1.0.23-SNAPSHOT.jar :na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:677) ~[canal.parse-1.0.23-SNAPSHOT. jar:na]         ...........                 at java.lang.Thread.run(Thread.java:745) [na:1.8.0_102] Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: fetch failed by table meta:`mysql`.`user` Caused by: java.io.IOException: connect XXX.178.61.230/118.178.61.230:3306 failure:java.io.IOException: Error When doing Client Authentication:ErrorPacket [errorNumber=2811  fieldCount=-1  message=Authentication Failed For RDS backend  sqlState=RDS00  sqlStateMarker=#]         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.negotiate(MysqlConnector.java:208)         ........... Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: fetch failed by table meta:`mysql`.`user` Caused by: java.io.IOException: ErrorPacket [errorNumber=1142  fieldCount=-1  message=SELECT command denied to user 'app_prod_crawler'@'116.62.43.4 1' for table 'user'  sqlState=42000  sqlStateMarker=#]  with command: desc `mysql`.`user`         at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.query(MysqlQueryExecutor.java:60) ~[canal.parse.driver-1.0.23-SNAPSHOT.jar:na] æˆ‘åœ¨ä½¿ç”¨canalç›‘å¬åº“çš„æ—¶å€™åˆ é™¤äº†ä¸€ä¸ªè¡¨ä¹‹åä¹ŸåŒ…ç±»ä¼¼çš„é”™è¯¯  è¿™ä¸ªé—®é¢˜è§£å†³äº†å—?  ä¹‹å‰ç›‘å¬äº†æ‰€æœ‰çš„åº“ï¼Œçœ‹æ–‡æ¡£å¯ä»¥ç”¨é…ç½®åªç›‘å¬æŒ‡å®šåº“ï¼Œcanal.instance.filter.regex è¿‡æ»¤ä¸€ä¸‹mysql.userè¡¨ æœ€æ–°ç‰ˆæœ¬24å·²ç»æ”¯æŒ
270,æ¥æ”¶ä¸åˆ°å…¨éƒ¨çš„insertäº‹ä»¶ æˆ‘æ‰€åœ¨çš„å…¬å¸ä¼šä¸å®šæ—¶å‘æ”¾ä¼˜æƒ åˆ¸ï¼Œæ¯æ¬¡ä»å‡ ç™¾å¼ åˆ°å‡ ä¸‡å¼ ä¸ç­‰ï¼Œéƒ½æ˜¯æ‰¹é‡æŠŠä¼˜æƒ åˆ¸æ•°æ®æ’å…¥åˆ°æ•°æ®åº“ä¸­ï¼Œä½†æ˜¯clientåªèƒ½æ¥æ”¶åˆ°éƒ¨åˆ†insertäº‹ä»¶ï¼Œä¸¾ä¾‹å¦‚ä¸‹ï¼š 2017-02-28 11:08:47å¾€æ•°æ®åº“ä¸­æ’å…¥äº†400æ¡è®°å½•ï¼Œä½†æ˜¯clientåªæ¥æ”¶åˆ°4æ¡insertäº‹ä»¶ï¼Œä¸çŸ¥é“ä»€ä¹ˆåŸå› ï¼Œä»¥å‰æˆ‘ä»¥ä¸ºæ˜¯å†…å­˜çš„åŸå› ï¼ŒæŠŠå„ä¸ªæŒ‡æ ‡éƒ½è°ƒå¤§äº†ï¼Œè¿˜æ˜¯ä¸è¡Œã€‚ mysqlç‰ˆæœ¬ï¼š5.6 canalç‰ˆæœ¬ï¼š1.0.20 canalé…ç½®ï¼š ################################################# ######### 		common argument		#############  ################################################# canal.id= 1 canal.ip= ******** canal.port= 11111 canal.zkServers= # flush data to zk canal.zookeeper.flush.period = 1000 # flush meta cursor/parse position to file canal.file.data.dir = ${canal.conf.dir} canal.file.flush.period = 1000 ## memory store RingBuffer size  should be Math.pow(2 n) canal.instance.memory.buffer.size = 1048576 ## memory store RingBuffer used memory unit size   default 1kb canal.instance.memory.buffer.memunit = 1024 (è¿™é‡Œå¼€å§‹æ”¹ä¸ºäº†4096ï¼ŒæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯éƒ½å¯åŠ¨æ­£å¸¸ï¼Œä¹Ÿå¯ä»¥æ­£å¸¸è¿æ¥ï¼Œä½†å°±æ˜¯æ²¡æœ‰ä»»ä½•äº‹ä»¶äº§ç”Ÿï¼Œä¹Ÿä¸æŠ¥é”™ï¼Œæ¢å¤ä¸º1024åæ­£å¸¸)  ## meory store gets mode used MEMSIZE or ITEMSIZE canal.instance.memory.batch.mode = MEMSIZE ## detecing config canal.instance.detecting.enable = false #canal.instance.detecting.sql = insert into retl.xdual values(1 now()) on duplicate key update x=now() canal.instance.detecting.sql = select 1 canal.instance.detecting.interval.time = 3 canal.instance.detecting.retry.threshold = 3 canal.instance.detecting.heartbeatHaEnable = false # support maximum transaction size  more than the size of the transaction will be cut into multiple transactions delivery canal.instance.transaction.size =  16384 # mysql fallback connected to new master should fallback times canal.instance.fallbackIntervalInSeconds = 60 # network config canal.instance.network.receiveBufferSize = 104857600 canal.instance.network.sendBufferSize = 104857600 canal.instance.network.soTimeout = 30 # binlog filter config canal.instance.filter.query.dcl = false canal.instance.filter.query.dml = false canal.instance.filter.query.ddl = false canal.instance.filter.table.error = false # binlog format/image check canal.instance.binlog.format = ROW STATEMENT MIXED  canal.instance.binlog.image = FULL MINIMAL NOBLOB # binlog ddl isolation canal.instance.get.ddl.isolation = false ################################################# ######### 		destinations		#############  ################################################# canal.destinations= ******** # conf root dir canal.conf.dir = ../conf # auto scan instance dir add/remove and start/stop instance canal.auto.scan = true canal.auto.scan.interval = 5 canal.instance.global.mode = spring  canal.instance.global.lazy = false #canal.instance.global.manager.address = 127.0.0.1:1099 #canal.instance.global.spring.xml = classpath:spring/memory-instance.xml canal.instance.global.spring.xml = classpath:spring/file-instance.xml #canal.instance.global.spring.xml = classpath:spring/default-instance.xml åŒæ­¥åˆ«çš„è¡¨çš„æ—¶å€™æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œé‚£äº›è¡¨æ²¡æœ‰åŒæ—¶æ‰¹é‡æ’å…¥å¾ˆå¤šæ•°æ®çš„æƒ…å†µã€‚ ä¸€ä¸ªeventäº‹ä»¶å¯èƒ½åŒ…å«å¤šæ¡å˜æ›´è®°å½• æœ€è¿‘ä¸“é—¨è·Ÿè¸ªäº†è¿™ä¸ªé—®é¢˜ï¼ŒåŸå› æ˜¯RowChangeè¿”å›çš„æ˜¯ä¸ªListï¼ŒåŒ…å«å¤šæ¡è®°å½•ï¼Œä½†åªå¤„ç†äº†æœ€åä¸€æ¡è®°å½•ã€‚ä¸¥é‡é„™è§†è¿™æ ·å†™çš„é‚£ä¸ªäººï¼Œ^_^
269,canal æœåŠ¡ç«¯è¿è¡Œä¸€æ®µæ—¶é—´å°±æŠ¥å¦‚ä¸‹é”™è¯¯ 2017-02-28 17:12:37.470 [destination = example   address = /10.10.10.193:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.collect.ComputationException: java.lang.RuntimeException: should execute connector.connect() first Caused by: com.google.common.collect.ComputationException: java.lang.RuntimeException: should execute connector.connect() first         at com.google.common.collect.MapMaker$ComputingMapAdapter.get(MapMaker.java:889)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta(TableMetaCache.java:78)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.getTableMeta(LogEventConvert.java:677)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:362)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:108)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:62)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:326)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:176)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:129)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209)         at java.lang.Thread.run(Thread.java:724) Caused by: java.lang.RuntimeException: should execute connector.connect() first         at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.<init>(MysqlQueryExecutor.java:29)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:71)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta0(TableMetaCache.java:105)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.access$000(TableMetaCache.java:26)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.apply(TableMetaCache.java:46)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.apply(TableMetaCache.java:42)         at com.google.common.collect.ComputingConcurrentHashMap$ComputingValueReference.compute(ComputingConcurrentHashMap.java:356)         at com.google.common.collect.ComputingConcurrentHashMap$ComputingSegment.compute(ComputingConcurrentHashMap.java:182)         at com.google.common.collect.ComputingConcurrentHashMap$ComputingSegment.getOrCompute(ComputingConcurrentHashMap.java:151)         at com.google.common.collect.ComputingConcurrentHashMap.getOrCompute(ComputingConcurrentHashMap.java:67)         at com.google.common.collect.MapMaker$ComputingMapAdapter.get(MapMaker.java:885)         ... 10 more ] canal serveråœ¨é‡å¯ä¼°è®¡ï¼Œclientå¤šåšä¸€ä¸‹é‡è¯•å³å¯
268,å¯ä»¥åªåŒæ­¥ç‰¹å®šç±»å‹çš„æ—¥å¿—å—ï¼Ÿæ¯”å¦‚æ–°å¢æ•°æ® RTï¼ŒåªåŒæ­¥æ–°å¢æ•°æ®ï¼Œå…¶å®ƒä¸è¦ï¼Œå¯ä»¥åšåˆ°å—ï¼Ÿ ä½ å…ˆäº†è§£ä¸€ä¸‹mysql binlogçš„åŸºæœ¬æ¦‚å¿µ
267,canalæ”¶é›† ç”±ä¸€æ¡updateè¯­å¥æ›´æ–°å¤šè¡Œ äº§ç”Ÿçš„binlogçš„é€Ÿåº¦å¾ˆæ…¢ ä»€ä¹ˆåŸå› å‘¢ï¼Ÿ æˆ‘ä»¬æœ‰ä¸€ä¸ªåœºæ™¯ï¼Œä¸€æ¡updateè¯­å¥æ›´æ–°3000è¡Œï¼ˆupdate tablename set x='xxx' where id>0 and id <3001ï¼‰ï¼Œç„¶åæäº¤ã€‚å‘ç°canalæ”¶é›†é€Ÿåº¦æ˜æ˜¾æ…¢äºæ­£å¸¸æƒ…å†µã€‚ ä»mysqlä¸­æŸ¥çœ‹binlogï¼Œå‘ç°ä¸€ä¸ªäº‹åŠ¡é‡Œï¼Œåˆ†æˆäº†47ä¸ªupdate_row eventï¼ˆå› æ­¤ä¸€ä¸ªupdate_row eventåŒ…å«64ä¸ªè¡Œå˜åŒ–ï¼‰ï¼Œ åœ¨æˆ‘ä»¬çš„æ¶ˆè´¹åœºæ™¯ä¸­æ¶ˆè´¹æ—¶å‘ç°ä¸€ä¸ªentryï¼ˆrowDatasï¼‰ä¸­æœ‰64ä¸ªBinlogRowã€‚47*64æ­£å¥½å¯¹åº”3000è¡Œå˜åŒ–ã€‚ åšäº†ä¸€äº›æµ‹è¯•ï¼Œå‘ç°å½“æ‰€æ›´æ–°çš„mysqlè¡Œçš„å¤§å°æ¯”è¾ƒå°çš„æ—¶å€™ï¼Œä¸€æ¡è¯­å¥æ›´æ–°å¤šè¡Œæ—¶ï¼Œä¼šæœ‰è¿™ç§æƒ…å†µï¼Œæ”¶é›†é€Ÿåº¦ä¹Ÿå¾ˆæ…¢ã€‚ ä½†æ˜¯mysqlè¡Œæ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œï¼ˆæ›´æ–°3000è¡Œï¼ŒbinlogåŸå§‹æ–‡ä»¶ä¸­æœ‰3000ä¸ªupdate_row eventï¼‰ï¼Œè¿™ä¸ªæ—¶å€™æ”¶é›†é€Ÿåº¦å°±æ­£å¸¸äº†ã€‚ ç°åœ¨æƒ³äº†è§£ï¼š 1.æ˜¯å¦æ˜¯å› ä¸ºæ›´æ–°å¤šè¡Œäº§ç”Ÿçš„binlogå†…å®¹ï¼ˆä¸€ä¸ªentryåŒ…å«å¤šä¸ªè¡Œå˜åŒ–ä¿¡æ¯ï¼‰å¯¼è‡´ åç»­è§£æé€Ÿåº¦æ…¢ï¼Œä»è€Œæ”¶é›†é€Ÿåº¦å˜æ…¢ 2.å…·ä½“ä»€ä¹ˆæƒ…å†µä¸‹ï¼Œä¸€ä¸ªupdate_row eventä¼šåŒ…å«å¤šä¸ªè¡Œå˜åŒ– 3.é’ˆå¯¹ä¸€æ¡sqlè¯­å¥æ›´æ–°å¤šè¡Œçš„åœºæ™¯ï¼Œæœ‰æ²¡æœ‰åŠæ³•æé«˜å¤„ç†æ€§èƒ½ è¿™ä¸ªä¹‹å‰æ²¡æœ‰åˆ»æ„å…³æ³¨è¿‡ï¼Œä½ å…³æ³¨åˆ°æ…¢æœ‰ä¸€äº›å…·ä½“çš„æ•°æ®ä¹ˆï¼Ÿæ¯”å¦‚è¯„ä¼°tpså¤§æ¦‚æ˜¯å¤šå°‘ï¼Ÿ ç›¸åŒé…ç½®çš„æƒ…å†µä¸‹ï¼Œä¸€æ¡sqlè¯­å¥åªå½±å“ä¸€è¡Œçš„æƒ…å†µä¸‹ï¼Œå¤§æ¦‚æ¯ç§’èƒ½æ”¶é›†7MBåŸå§‹binlogæ–‡ä»¶ï¼Œè¿™ç§ä¸€æ¡sqlè¯­å¥å½±å“å¤šè¡Œçš„ä¼šç‰¹åˆ«æ…¢ï¼Œæˆ‘å½“æ—¶æµ‹ä¸€æ¡sqlè¯­å¥æ›´æ–°3000è¡Œï¼Œå¤§æ¦‚æ¯ç§’åªèƒ½æ”¶é›†0.5MBbinlogæ–‡ä»¶ã€‚ã€‚ æˆ‘æµ‹è¯•çš„æ—¶å€™å‘ç°ï¼Œåªæœ‰åŸå…ˆmysqlå•æ¡è®°å½•æ¯”è¾ƒå°çš„æ—¶å€™ï¼Œè¿™æ ·æ‰¹é‡æ›´æ–°ä¼šå‡ºç°è¿™ç§æƒ…å†µã€‚å¯¹äºæ‰¹é‡æ›´æ–°å•æ¡mysqlè®°å½•æ¯”è¾ƒå¤§çš„æ“ä½œï¼ˆæˆ‘å°è¯•çš„æ˜¯å„ä¸ªå­—æ®µåŠ èµ·æ¥è¶…è¿‡1KBï¼‰ï¼Œæ”¶é›†é€Ÿåº¦å’Œæ­£å¸¸æƒ…å†µå·®ä¸å¤šã€‚ @lan1994 ä½ é‚£ä¸ªé—®é¢˜è§£å†³äº†å—ï¼Ÿæˆ‘ä»¬ä¹Ÿé‡åˆ°ç±»ä¼¼çš„é—®é¢˜ @pan289091315 æ²¡è§£å†³ mysqlé…ç½®å¦‚ä¸‹å‚æ•°ï¼šinnodb_flush_log_at_trx_commit åœ¨æäº¤äº‹åŠ¡çš„æ—¶å€™æ˜¯å¦æäº¤ç¼“å†²? æœ‰3ä¸ªå€¼ï¼š 	0ï¼šä¸ä¼šä¸»åŠ¨è§¦å‘æ—¥å¿—ç¼“å†²å†™å…¥ç£ç›˜ 	1ï¼ˆé»˜è®¤ï¼‰ï¼šæ¯æ¬¡æäº¤äº‹åŠ¡çš„æ—¶å€™ï¼ŒåŒæ—¶ä¼šæŠŠæ—¥å¿—ç¼“å†²åˆ·æ–°åˆ°ç£ç›˜ 	2ï¼šæ¯æ¬¡æäº¤äº‹åŠ¡çš„æ—¶å€™ï¼Œä¼šæŠŠæ—¥å¿—ç¼“å†²åˆ·æ–°åˆ°ç£ç›˜ï¼Œä½†æ˜¯ä»–ä¸æ˜¯åŒæ—¶è¿›è¡Œçš„ 	   è€Œæ˜¯æ¯ç§’é’Ÿåˆ·æ–°ä¸€æ¬¡ å»ºè®®é…ç½®æˆ2 ï¼Œå¯¹æ€§èƒ½å½±å“è¾ƒå¤§ã€‚ å¯ä»¥è¯•è¯•è¿™ä¸ª @wufengbin ä½ æçš„è¿™ä¸ªå‚æ•°æ˜¯è§£å†³mysqlæ‰¹é‡å†™å…¥æ…¢çš„é—®é¢˜ï¼Œä½†æ˜¯è¿™é‡Œæåˆ°çš„æ˜¯canalè§£ææ…¢çš„é—®é¢˜ã€‚åœ¨é¢„å†™å…¥mysqlå®Œæ¯•åï¼Œæ‰æµ‹è¯•è§£ææ€§èƒ½çš„ã€‚ @lan1994 è¯·é—®è§£å†³äº†å—ï¼Ÿ å€’æ˜¯å¯ä»¥å…ˆæ‰§è¡Œä¸€ä¸ªå¤§äº‹åŠ¡ï¼Œç„¶åcanalå›æº¯åˆ°äº‹åŠ¡æ‰§è¡Œä¹‹å‰è¿›è¡ŒéªŒè¯ï¼Œä»æˆ‘è¿™è¾¹çš„æµ‹è¯•æ¥çœ‹ï¼ŒåŸºæœ¬éƒ½æ˜¯å¯ä»¥æ»¡è¶³åŸºæœ¬æ€§èƒ½ @lan1994 é—®é¢˜åŸå› æ‰¾åˆ°äº†æ²¡ï¼Ÿå…„å¼Ÿ å‚è€ƒæ–‡æ¡£ï¼šhttps://github.com/alibaba/canal/wiki/Performance
266,canal 1.0.16 åœ¨æ‰¹é‡åˆ·æ•°æ®åº“æ•°æ®å‡ºç°é”™è¯¯    canal 1.0.16 åœ¨æ‰¹é‡åˆ·æ•°æ®åº“æ•°æ®å‡ºç°é”™è¯¯ï¼Œè¯·é—®ä¸‹è¿™ä¸ªç‰ˆæœ¬æœ‰ä»€ä¹ˆBUGã€‚ éœ€è¦æŠŠå…·ä½“é”™è¯¯å†…å®¹æè¿°æ¸…æ¥šï¼Œç‰ˆæœ¬å˜æ›´ä½ å…³æ³¨ä¸€ä¸‹release note
265,ErrotCode:400   Caused by : packet type=CLIENTAUTHENTICATION is NOT supported! å¯åŠ¨canalï¼ŒæŠ¥è¿™æ ·çš„å¼‚å¸¸ï¼Œä½†æ˜¯æ•°æ®åº“æˆ‘ç”¨msyqlå®¢æˆ·ç«¯ï¼Œè´¦å·å¯†ç å¯ä»¥æ­£å¸¸ç™»å½•ï¼Œmysqlä»åº“å’Œcanalæ˜¯éƒ¨ç½²åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šçš„ï¼Œè¯·é—®æ˜¯ä»€ä¹ˆåŸå› ï¼Œæœ‰ç¢°åˆ°ç›¸ä¼¼é—®é¢˜çš„å—ï¼Ÿ 2017-02-22 10:53:15.093 [New I/O server worker #1-2] ERROR com.alibaba.otter.canal.server.netty.NettyUtils - ErrotCode:400   Caused by : packet type=CLIENTAUTHENTICATION is NOT supported! 2017-02-22 10:53:45.014 [Thread-3] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## stop the canal server 2017-02-22 10:53:45.315 [Thread-3] INFO  com.alibaba.otter.canal.deployer.CanalController - ## stop the canal server[192.168.1.20:11111] 2017-02-22 10:53:45.315 [Thread-3] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## canal server is down. OpenJDK 64-Bit Server VM warning: ignoring option PermSize=96m; support was removed in 8.0 OpenJDK 64-Bit Server VM warning: ignoring option MaxPermSize=256m; support was removed in 8.0 OpenJDK 64-Bit Server VM warning: UseCMSCompactAtFullCollection is deprecated and will likely be removed in a future release. 2017-02-22 10:53:59.987 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## start the canal server. 2017-02-22 10:54:00.151 [main] INFO  com.alibaba.otter.canal.deployer.CanalController - ## start the canal server[192.168.1.20:11111] 2017-02-22 10:54:01.278 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## the canal server is running now ...... çœ‹æ—¥å¿—æœ€åä¸€è¡Œå’Œä½¿ç”¨psæŸ¥è¯¢ï¼Œcanalæ˜¯å¯åŠ¨èµ·æ¥äº†ï¼Œä½†æ˜¯æ²¡æœ‰äº‹ä»¶å‘ç”Ÿï¼Œä½†binlogæ—¥å¿—æ˜¯ä¸€ç›´å¢åŠ çš„ã€‚ è¯·é—®è¿™ä¸ªä½ æ€ä¹ˆè§£å†³çš„å•Š... 2462962670
264,binlogè§£æé—®é¢˜ canal è§£æbinlogæ—¥å¿— ï¼Œæœ‰æ—¶å€™è·å–ä¸åˆ°ä¸»é”®æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ mysql ç‰ˆæœ¬mysql-5.7.14 æ²¡é‡åˆ°è¿‡ç”¨æˆ·åé¦ˆï¼Œæœ€å¥½èƒ½æ˜ç¡®ä¸€ä¸‹å¤ç°çš„åœºæ™¯ï¼Œæ¯”å¦‚mysqlè¡¨ï¼Œcanalç‰ˆæœ¬ç­‰ä¸€äº›ä¿¡æ¯
263,[updated]binlogè§£æç–‘é—® canalèƒ½å¤Ÿè§£æç°åœ¨mysqlä¸­çš„Perconaåˆ†æ”¯å— å¦‚æœä¸èƒ½ æœ‰æ”¯æŒçš„è®¡åˆ’å— æ”¯æŒçš„ ä¸è¿‡è¿™ç§é—®é¢˜ä½ è¯•ä¸€ä¸‹ä¸å°±çŸ¥é“äº†ï¼Œæ¥é—®ä¸€ä¸‹è‡³å°‘ç­‰1å¤©æ‰ä¼šæœ‰ç­”å¤ï¼Œä½•å¿…å‘¢ æˆ‘è¡¨è¿°ä¸å¤Ÿæ¸…æ¥š æ˜¯è¿™æ ·çš„ ç”±perconaçš„æºåº“ åŒæ­¥è‡³mysqlä¸»åˆ†æ”¯çš„ç›®çš„åº“ éœ€åŒæ­¥çš„æºè¡¨æ—¢æœ‰innodb ä¹Ÿæœ‰tokudb åŒæ­¥è‡³çš„ç›®çš„è¡¨å‡ä¸ºinnodb æºè¡¨ä¸­å‡æ— blobç­‰å¤§å­—æ®µç±»å‹ åŒæ­¥æ—¶å‘ç”Ÿäº†è§£æé”™è¯¯(æ›´è¯¦ç»†çš„é”™è¯¯å †æ ˆæ²¡æœ‰æ‰“å°) pid:17 nid:8 exception:canal:test_canal:com.alibaba.otter.canal.parse.exception.CanalParseException: Unsupported BinlogImage NOBLOB é…ç½®ä¸Šå¹¶æ²¡æœ‰ä¿®æ”¹ä½¿ç”¨é»˜è®¤é…ç½® å³æ”¯æŒçš„BinlogImageä¸º[FULL MINIMAL NOBLOB] @agapple æ±‚è§£ç­” otterä¸æ”¯æŒimageæ¨¡å¼ä¸ºNOBLOB
262,å…³äº SlaveId ç¢°æ’é—®é¢˜ Mysql ä¼šè®¤ä¸ºæ‹¥æœ‰åŒä¸€ä¸ª SlaveId çš„ connection éƒ½æ¥è‡ªåŒä¸€ä¸ªä»åº“ï¼Œå› è€Œåœ¨ä¸¤ä¸ªå…·æœ‰ç›¸åŒ SlaveId çš„ canal instance å¯¹åŒä¸€ä¸ª Mysql Master å‘èµ· dump è¯·æ±‚æ—¶ï¼Œå¿…å®šä¼šæœ‰ä¸€ä¸ª instance ä¼šå¤±è´¥ && åå¤é‡è¯•ã€‚ è¿™ä¸ªé”™è¯¯åœ¨ Mysql ä¸­æŠ¥å‡ºæ¥çš„æ˜¯ 1236ï¼Œä½†æ˜¯å¹¶ä¸èƒ½é€šè¿‡æŸ¥æ‰¾ binlog å¼‚å¸¸æ¥è§£å†³ã€‚ è¿™ç§æƒ…å†µä¸‹ï¼Œåªèƒ½é‡æ–°ç”Ÿæˆæ–°çš„ SlaveIdã€‚ä¾‹å¦‚è¿™æ ·ï¼š canal.parse: MysqlEventParser.java ```     @Override     protected void processDumpError(Throwable e) {         if (e instanceof IOException) {             String message = e.getMessage();             if (StringUtils.contains(message  "errno = 1236")) {                 // 1236 errorCode ä»£è¡¨ ER_MASTER_FATAL_ERROR_READING_BINLOG                 // ä½†ä¹Ÿæœ‰å¯èƒ½æ˜¯ slaveId å†²çª  åœ¨è¿™é‡Œä½œé¢„å…ˆè¡¥æ•‘                 if (StringUtils.contains(message  "errmsg = A slave with the same server_uuid/server_id as this slave has connected to the master")) {                     // é‡æ–°ç”Ÿæˆ slaveId                     long new_slave_id = new Random().nextLong();                     logger.warn("SlaveId Conflict is detected: Old slave id = [{}]  new slave id = [{}]"  this.slaveId  new_slave_id);                     this.slaveId = new_slave_id;                     return;                 }                 dumpErrorCount++;             }         }         super.processDumpError(e);     } ``` å¯èƒ½èƒ½å¤Ÿå‡å°‘ä¸€ç‚¹æ‰‹å·¥æ”¹é…ç½®çš„å·¥ä½œï¼Ÿ ä½ èƒ½æäº¤ä¸€ä¸ªpull requestç»™æˆ‘ä¸ï¼Ÿ æœ€æ–°çš„ç‰ˆæœ¬å·²ç»è®¾ç½®äº†slave_uuid
261,javaå®¢æˆ·ç«¯CanalConnector.subscribe()ä½¿ç”¨ä»¥ä¸‹ç¬¬äºŒç§æ­£åˆ™è¿‡æ»¤æ— æ•ˆ ä½¿ç”¨canalçš„java apiï¼Œ ä¸ºä»€ä¹ˆç”¨ç¬¬ä¸‰ å››ç§æœ‰æ•ˆï¼›ç¬¬äºŒç§æ­£åˆ™æ— æ•ˆï¼Œè¿‡æ»¤å…¨éƒ¨å‘¢ ps:canal serverçš„conf/example/instance.propertiesçš„canal.instance.filter.regexæ²¡æœ‰é…ç½® 1.  æ‰€æœ‰è¡¨ï¼š.*   or  .*\\..* 2.  canal schemaä¸‹æ‰€æœ‰è¡¨ï¼š canal\\..* 3.  canalä¸‹çš„ä»¥canalæ‰“å¤´çš„è¡¨ï¼šcanal\\.canal.* 4.  canal schemaä¸‹çš„ä¸€å¼ è¡¨ï¼šcanal.test1 5.  å¤šä¸ªè§„åˆ™ç»„åˆä½¿ç”¨ï¼šcanal\\..* mysql.test1 mysql.test2 (é€—å·åˆ†éš”) æœ‹å‹ï¼Œä½ è¿™ä¸ª Issue åæ¥æœ‰ä»€ä¹ˆç»“è®ºä¹ˆï¼Ÿ
260,ç”Ÿäº§ç¯å¢ƒç‰ˆæœ¬è€ƒé‡ æˆ‘ä»¬å‡†å¤‡åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨`canal`ï¼Œä¹‹å‰åœ¨æµ‹è¯•ç¯å¢ƒåŒäº‹æ­å»ºçš„æ˜¯`1.0.22`ç‰ˆæœ¬ï¼Œæµ‹è¯•ä½¿ç”¨è¿‡ç¨‹ä¸­å‘ç°äº†ä¸€äº›bugï¼ˆå¦‚kill connectionçš„é—®é¢˜ï¼‰ï¼Œç›®å‰çœ‹åŸºæœ¬ä¸Šéƒ½åœ¨`1.0.23`ä¿®å¤äº†ã€‚åæ¥æ³¨æ„åˆ°å®˜æ–¹wikiæ¨èçš„æ˜¯`1.0.19`ç‰ˆæœ¬ï¼Œè¯·é—®@agappleåŸºäºç¨³å®šæ€§è€Œè¨€æ˜¯æ¨èä½¿ç”¨`1.0.19`ç‰ˆæœ¬å—ï¼Ÿ ä¼°è®¡æ˜¯è¿˜æ²¡æœ‰åŠæ—¶æ›´æ–°æ–‡æ¡£ï¼Œå¯ä»¥ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ å¤šè°¢å¤šè°¢~ æˆ‘ä»¬ä¹Ÿé€‰äº†æœ€æ–°ç‰ˆæœ¬ï¼Œè¿™å‡ å¤©æ­£åœ¨æµ‹è¯• æ–‡æ¡£æ›´æ–°åŠæ—¶ä¸€äº›å°±æ›´å¥½å•¦~
259,fix bug for #202ï¼ˆcanal.instance.filter.regex ä¿®æ”¹åæœªç”Ÿæ•ˆï¼‰ è¿™ä¸ªä¸èƒ½åŠ metaé…ç½®ä¿®æ”¹ç”Ÿæ•ˆï¼Œå› ä¸ºè¿™æ–‡ä»¶ä½ç‚¹ä¼šä¸åœçš„æ›´æ–°ï¼Œä¼šå¯¼è‡´é¢‘ç¹çš„reload æ²¡æœ‰metaå‘€ï¼Œåªæ¯”è¾ƒå¯¹åº”ç›®å½•ä¸‹çš„instance.propertiesæ–‡ä»¶ï½ subscribeè‡ªåŠ¨ç”Ÿæˆmetaæ–‡ä»¶ï¼Ÿ
258,fix bug for: #202 canal.instance.filter.regex ä¿®æ”¹åæœªç”Ÿæ•ˆ ä¹‹å‰æçš„issueï¼ˆ#202 canal.instance.filter.regex ä¿®æ”¹åæœªç”Ÿæ•ˆï¼‰ï¼Œè¿™æ˜¯æˆ‘æ‰“çš„patchï½ ä¸å¥½æ„æ€ï¼Œæ‰çœ‹åˆ°å›å¤ï½ [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=258) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=258) before we can accept your contribution.<br/><hr/>**ç‰éº’éºŸ** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).
257,MysqlEventParseré‡Œå‘ç°ä¸€ä¸ªbug 1.0.23ç‰ˆé‡ŒMysqlEventParserçš„stopHeartBeatæ–¹æ³•é‡Œæ²¡æœ‰åˆ¤æ–­heartBeatTimerTaskçš„ç±»å‹å°±ç›´æ¥åšå¼ºåˆ¶è½¬æ¢ï¼Œå¯¼è‡´ä¸‹é¢ java.lang.ClassCastException: com.alibaba.otter.canal.parse.inbound.AbstractEventParser$4 cannot be cast to com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser$MysqlDetectingTimeTask 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.stopHeartBeat(MysqlEventParser.java:186) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.stop(AbstractEventParser.java:282) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.stop(MysqlEventParser.java:165) 	at com.alibaba.otter.canal.instance.core.AbstractCanalInstance.stop(AbstractCanalInstance.java:104) 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.stop(CanalServerWithEmbedded.java:85) @agapple  å¤§ç¥ï¼Œè¿™ä¸ªbugä¼šå¯¼è‡´eventparserçº¿ç¨‹é‡Šæ”¾ä¸äº†ï¼Œæ˜¯ä¸æ˜¯æ„å‘³ç€ canalserver stop å…¶å®å¥½å¤šstopçš„äº‹æƒ…éƒ½æ²¡èƒ½åšåˆ°ï¼Œå•¥æ—¶å€™èƒ½ä¸Š 1.0.24ç‰ˆæœ¬åˆ°mvnä»“åº“å‘¢ï¼Œåç­‰è°¢è°¢å¤§ç¥
256,ä½¿ç”¨nettyé‡æ„socketChannelï¼ˆjdkå†…ç½®ï¼‰ï¼Œä¿®æ”¹äº†PacketManagerå®ç°ï¼Œä»¥åŠå…¶ä»–ç›¸å…³å¼•ç”¨çš„ç±»ã€‚ [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=256) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you all sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=256) before we can accept your contribution.<br/>**1** out of **2** committers have signed the CLA.<br/><br/>:white_check_mark: agapple<br/>:x: luoyaogui<hr/>**luoyaogui** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user). tks @luoyaogui ç”¨æˆ·åé¦ˆæ¯”è¾ƒå¤šçš„ç½‘ç»œé—®é¢˜ï¼Œæˆ‘æš‚æ—¶å…ˆå›æ»šå»æ‰ä»£ç ï¼Œåé¢ä¼˜åŒ–éªŒè¯ç¨³å®šæ€§ä¹‹åå†æ›´æ–° 
255,BUGï¼Œåœ¨Mysql 5.5.28ç‰ˆæœ¬ä¸‹æŠ¥é”™ æ—¥å¿—ï¼š 2017-01-12 12:06:16.107 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /127.0.0.1:3306 has an error  retrying. caused by  java.lang.NullPointerException: null 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.loadBinlogChecksum(MysqlConnection.java:309) ~[canal.parse-1.0.24-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:120) ~[canal.parse-1.0.24-SNAPSHOT.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) ~[canal.parse-1.0.24-SNAPSHOT.jar:na] 	at java.lang.Thread.run(Unknown Source) [na:1.7.0_80] åŸå› ï¼šç¨‹åºBUGï¼Œç¼ºå°‘nullåˆ¤æ–­ if (columnValues != null && columnValues.size() >= 1 				&& columnValues.get(0).toUpperCase().equals("CRC32")) æ”¹ä¸ºï¼š if (columnValues != null && columnValues.size() >= 1 				&& columnValues.get(0) != null   //ç¼ºå°‘çš„åˆ¤æ–­ 				&& columnValues.get(0).toUpperCase().equals("CRC32")) ç—‡çŠ¶æ¶ˆé™¤ï¼ è¯·æ›´æ–°å½“å‰masterç‰ˆæœ¬ æ„Ÿè§‰è¿™ä¸ªé—®é¢˜æ¯”è¾ƒä¸¥é‡å•Šï¼Œå»ºè®®å‘ä¸€ä¸ªreleaseæ¯”è¾ƒå¥½ï¼Œå¯¹äºä½ç‰ˆæœ¬mysqlï¼Œcanalç›´æ¥æ— æ³•æ­£å¸¸å¯åŠ¨äº†
254,ll 
253,prepare to find start position just last position éƒ¨ç½²äº†ä¸¤å°æœºå™¨ Aï¼Œæœºå™¨ å’ŒB æœºå™¨ï¼ŒA æœºå™¨å…ˆå¯åŠ¨æˆåŠŸï¼Œç„¶åçœ‹æ—¥å¿— ä¸€ç›´å¤„äº prepare to find start position just last positionï¼Œä¹‹åæˆ‘æŠŠ A æœºå™¨å…³é—­äº†ï¼Œç„¶åå»è§‚å¯ŸB æœºå™¨ï¼Œç„¶åè¿…é€Ÿ è·å–åˆ°postion ï¼Œè¿™æ˜¯é—®é¢˜éš¾é“æ¯æ¬¡éƒ½è¦å…³é—­ä¸€å°æœºå™¨å—ï¼Ÿ æˆ‘é‡åˆ°äº†ç±»ä¼¼çš„é—®é¢˜ï¼Œæˆ‘åªéƒ¨ç½²äº†ä¸€ä¸ªcanalèŠ‚ç‚¹ ï¼Œä¸€ç›´å¡åœ¨å®šä½è¿™ä¸€æ­¥ @boboChina  å•æœºçš„è¯ä½ å°±ä¸ç”¨ç”¨zk äº†ï¼Œå°±å¯ä»¥ç”¨äº†ï¼Œæˆ‘æ€€ç–‘æ˜¯zk  æœ‰é—®é¢˜æ—¥å¿—ä¸Šé¢æ˜¾ç¤ºä¸€ç›´ping  zk  æˆ‘æ€€ç–‘è¿‡ï¼Œæˆ‘åå°åšè¿‡å‡ æ¬¡é‡è¯•ï¼š 1å…ˆæŠŠcanalåœäº†ï¼ŒæŠŠzkä¸Šé¢æ•°æ®åˆ äº† è¿™ç§ä¸è¡Œ 2 è®¾ç½®binlogæ–‡ä»¶ã€ä½ç‚¹ã€æ—¶é—´æˆ³ ä¹Ÿä¸è¡Œ æ ¹æ®æ‰“å°çš„æ—¥å¿—ï¼Œå»å¯¹ç…§é…ç½®é¡¹ï¼Œå’Œæºç é‡Œé¢èµ°åˆ°çš„if elseåˆ†æ”¯å¯¹ä¸ä¸Š ä¸ç”¨zkä¹Ÿè¯•äº†ä¸‹ï¼Œæ²¡æ•ˆæœï¼Œæ€€ç–‘å’Œmysqlè®¾ç½®æœ‰å…³ï¼Œæ¢äº†å…¶ä»–çš„mysqlæœ‰çš„å¾ˆå¿«æ¨å¾—å®šä½å°±å¡æ­»äº†ï¼Œä½†æ˜¯å…·ä½“ä¸çŸ¥é“æ˜¯å“ªäº›é…ç½®é¡¹ä¼šæœ‰å½±å“ æŒ‰ç…§ä½ è¿™æ ·çš„é€»è¾‘åº”è¯¥æ˜¯æ•°æ®åº“çš„é—®é¢˜å’¯ï¼Œä½†æ˜¯æˆ‘æŠŠZkå…³é—­äº†ï¼Œç„¶åå•æœºæ¨¡å¼å°±å¯ä»¥ï¼Œæ•°æ®åº“æ²¡æœ‰å˜åŒ–å•Š prepare to find start position just last position   è¿™ä¸ªæ˜¯ä»£è¡¨ç”¨æœ€åçš„ä½ç‚¹å·²ç»å¯åŠ¨æˆåŠŸçš„æ„æ€ å¯æ˜¯å¯åŠ¨æˆåŠŸè¿‡åï¼Œä¸€ç›´å°±åœåœ¨é‚£é‡Œäº†ï¼Œç„¶åå®¢æˆ·ç«¯å»æ¶ˆè´¹çš„æ—¶å€™ï¼Œä¹Ÿä¼šä¸€ç›´å¡åœ¨å“ªé‡Œçš„
252,com.alibaba.otter.canal.common.utils.JsonUtils ç›¸å…³ å®¢æˆ·ç«¯å¯åŠ¨æŠ›å‡ºå¼‚å¸¸ æ¨æµ‹æ˜¯FastJSONç‰ˆæœ¬é—®é¢˜ <img width="1051" alt="2017-01-06 14 32 56" src="https://cloud.githubusercontent.com/assets/22702893/21709589/0e616c68-d41d-11e6-9af3-88e79a5af79b.png"> 
251,è¯·é—®æ”¯æŒ10.0.10ç‰ˆæœ¬çš„MariaDBå— > ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.  alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: java.lang.IllegalArgumentException: bad format  x exceed: 1207926783  999999999 mysqlä½¿ç”¨10.0.10ç‰ˆæœ¬çš„MariaDBï¼Œcanalå¯åŠ¨åè§£æbinlogå°±ä¼šæŠ¥ä»¥ä¸Šé”™è¯¯ã€‚è¯•äº†1.0.22ï¼Œ1.0.23ç‰ˆæœ¬çš„canaléƒ½ä¸è¡Œ è¿™ä¸ªä¼°è®¡è¦çœ‹çœ‹mariadbåœ¨10.0.10ä¸Šæ”¹åŠ¨äº†å“ªäº› @minotaursu å¯ä»¥è¯•è¯•maxscaleçš„binlogserverç»„ä»¶ã€‚ @zhongjimax binlog serverç»„ä»¶åªæ˜¯è§£å†³binlogè¿œç¨‹ä¸‹è½½å§ï¼Œå…·ä½“è§£æå·¥ä½œè¿˜å¾—è‡ªå·±åš è¯•è¿‡äº†ï¼Œæ— æ³•è§£æmariadbçš„10.0.10ç‰ˆæœ¬ã€‚
250,[BUGFIX] åœ¨MySQL5.6åšä¸»å¤‡åº“åˆ‡æ¢æ—¶å‡ºç°çš„filenameä¹±ç ä¿®å¤ å¤šæ¬¡æµ‹è¯•å‘ç°é—®é¢˜å‡ºç°åœ¨seekæ–¹æ³•ä¸Šï¼Œç›¸è¾ƒäºdumpï¼Œç¼ºå°‘äº†checksumï¼Œå¯¼è‡´æœç´¢binlogä½ç‚¹æ—¶ï¼Œæ‹¿åˆ°çš„filenameå¤šäº†å››å­—èŠ‚ã€‚ [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=250) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=250) before we can accept your contribution.<br/><hr/>**jianhao.dai** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user). tks
249,ä¸»å¤‡åˆ‡æ¢çš„é—®é¢˜ ä¸»å¤‡åˆ‡æ¢çš„è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯ï¼Œlogå¦‚ä¸‹ï¼ˆæ³¨æ„mysql-bin.000029=7Â¾Âä»¥åŠCould not find first log file name in binary log indexï¼‰ 2017-01-03 22:09:16.930 [destination = xiaopang3   address = /192.168.6.123:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - client authentication packet is sent out. 2017-01-03 22:09:16.934 [destination = xiaopang3   address = /192.168.6.123:3306   EventParser] INFO  c.a.otter.canal.parse.inbound.mysql.MysqlConnection - COM_BINLOG_DUMP with position:BinlogDumpCommandPacket[binlogPosition=21725485 slaveServerId=1237 binlogFileName=mysql-bin.000029=7Â¾Â command=18] 2017-01-03 22:09:16.935 [destination = xiaopang3   address = /192.168.6.123:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) ~[canal.parse-1.0.23.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:121) [canal.parse-1.0.23.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) [canal.parse-1.0.23.jar:na] 	at java.lang.Thread.run(Thread.java:744) [na:1.7.0_45] 2017-01-03 22:09:16.935 [destination = xiaopang3   address = /192.168.6.123:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /192.168.6.123:3306 has an error  retrying. caused by  java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) ~[canal.parse-1.0.23.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:121) ~[canal.parse-1.0.23.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) ~[canal.parse-1.0.23.jar:na] 	at java.lang.Thread.run(Thread.java:744) [na:1.7.0_45] 2017-01-03 22:09:16.935 [destination = xiaopang3   address = /192.168.6.123:3306   EventParser] ERROR com.alibaba.otter.canal.common. æ„Ÿè§‰æ˜¯binlogåå­—å‡ºç°äº†ä¹±ç ï¼Œè¯•è¯•å½“å‰ä¸»å¹² @agapple è¿™ä¸ªé—®é¢˜åœ¨1.0.26ç‰ˆæœ¬ä¸Šè¿˜æ˜¯å­˜åœ¨ï¼ŒçŸ¥é“ä»€ä¹ˆåŸå› å—ï¼Ÿ æˆ‘ä¹Ÿé‡åˆ°åŒæ ·çš„é—®é¢˜ï¼Œcanal  ç‰ˆæœ¬ v1.0.26 alpha 1ï¼Œ mariadb ç‰ˆæœ¬ç”¨çš„ 10.2.11ï¼Œåˆ‡æ¢çš„æ—¶å€™ å‘ç°binlogæ–‡ä»¶åå­—ä¹±ç ã€‚ @lijie1992066 æä¾›ä¸€ä¸‹å¯¹åº”çš„binlogæ–‡ä»¶ç»™æˆ‘ æˆ‘ä¹Ÿé‡åˆ°äº†åŒæ ·çš„é—®é¢˜ï¼Œä¸»å¤‡åˆ‡æ¢æ—¶è€æ˜¯æŠ¥binlogæ‰¾ä¸åˆ°ï¼ˆmysqlä¸­binlogæ—¥å¿—æ˜¯å­˜åœ¨çš„ï¼‰ï¼Œæ–­ç‚¹è°ƒè¯•å¦‚ä¸‹ï¼š ![image](https://user-images.githubusercontent.com/20380664/38121113-d6675676-33ff-11e8-9341-6703fa332bd6.png) æ„Ÿè§‰åç¼€ä¸Šæœ‰ä¹±ç  èƒ½debugçœ‹çœ‹ï¼Œè¿™ä¸ªä¹±ç çš„ä½ç‚¹æ˜¯ä»å“ªé‡Œè·å–åˆ°çš„ï¼Ÿ@ZhiXingHeYiApple 
248,ä¿®å¤mysql5.6ä»¥ä¸‹æŠ¥java.lang.NullPointerException ä¿®å¤mysql5.6ä»¥ä¸‹æŠ¥java.lang.NullPointerException [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=248) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=248) before we can accept your contribution.<br/> tks
247,exampleæ— æ³•é“¾æ¥åˆ°mysqlï¼ŒæŠ¥java.lang.NullPointerException 2017-01-03 16:58:21.099 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /127.0.0.1:3306 has an error  retrying. caused by  java.lang.NullPointerException: null 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.loadBinlogChecksum(MysqlConnection.java:284) ~[canal.parse-1.0.23.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) ~[canal.parse-1.0.23.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) ~[canal.parse-1.0.23.jar:na] 	at java.lang.Thread.run(Unknown Source) [na:1.8.0_111] 2017-01-03 16:58:21.100 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.lang.NullPointerException 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.loadBinlogChecksum(MysqlConnection.java:284) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) 	at java.lang.Thread.run(Unknown Source) ] å®šä½åˆ°MysqlConnection.java:284ä»£ç ä¸º if (columnValues != null && columnValues.size() >= 1 && columnValues.get(0).toUpperCase().equals("CRC32")) MySQLç‰ˆæœ¬5.5.14 ï¼Œå‰é¢æŸ¥è¯¢ select @master_binlog_checksum ä¸ºnull å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œä»£ç å‰é¢åŠ äº†åˆ¤æ–­ å½“å‰ä¸»å¹²å·²ç»æœ‰äººæäº†PRä¿®å¤äº† ä½ å¥½ï¼Œä½ è§£å†³äº†å—ï¼Œæˆ‘ä¹Ÿç¢°åˆ°äº†åŒæ ·çš„é—®é¢˜ï¼Œç”¨äº†1.0.23ï¼Œä¸æ˜¯å·²ç»æ˜¯æœ€æ–°ç‰ˆæœ¬äº†å—ï¼Ÿ @CONANLMN è¿™ä¸ªé—®é¢˜æˆ‘å·²ç»ä¿®å¤æäº¤äº†ï¼ŒReleaseé‡Œé¢åº”è¯¥æ˜¯æ²¡æœ‰é‡æ–°æ‰“åŒ…ï¼Œä½ å»æŠŠæœ€æ–°çš„æºç ä¸‹ä¸‹æ¥ç¼–è¯‘äº†ï¼Œæ›¿æ¢æ‰MysqlConnection.classå°±è¡Œ
246,UPDATE äº‹ä»¶å¦‚ä½•ç›´æ¥è·å–SQL UPDATE äº‹ä»¶å¦‚ä½•ç›´æ¥è·å–SQLã€‚ å½“å‰éƒ½æ˜¯è·å–æ›´æ–°çš„å­—æ®µå€¼ã€‚ åªèƒ½è‡ªå·±æ‹¼sql
245,issues#244 [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=245) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=245) before we can accept your contribution.<br/> tks
244,ä¸èƒ½æ­£å¸¸å…³é—­Mysqlå¿ƒè·³è¿æ¥ ## MysqlEventParser.stopHeartBeat ![screenshot_20161230_112811](https://cloud.githubusercontent.com/assets/1852661/21559222/32776da4-ce83-11e6-9cdb-e0671014de96.png) ## AbstractEventParser.stopHeartBeat ![screenshot_20161230_112756](https://cloud.githubusercontent.com/assets/1852661/21559229/5bae9b34-ce83-11e6-8de1-258aac961da3.png) tks
243,åŸæ¥çš„exampleå†…çš„startup.batè„šæœ¬ç›´æ¥è¿è¡Œæ—¶æŠ¥è¯­æ³•é”™è¯¯ [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=243) <br/>All committers have signed the CLA. tks
242,Client requested master to start replication from impossible position å®Œæ•´çš„æŠ¥é”™ä¿¡æ¯ï¼š 2016-12-22 00:00:54.195 [destination = ixtrade   address = /172.30.10.109:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position 2016-12-22 00:00:54.199 [destination = ixtrade   address = /172.30.10.109:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Client requested master to start replication from impossible position; the first event 'mysql-bin.000024' at 533920026  the last event read from 'mysql-bin.000024' at 4  the last byte read from 'mysql-bin.000024' at 4. 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) [canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) [canal.parse-1.0.22.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_25] 2016-12-22 00:00:54.199 [destination = ixtrade   address = /172.30.10.109:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /172.30.10.109:3306 has an error  retrying. caused by  java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Client requested master to start replication from impossible position; the first event 'mysql-bin.000024' at 533920026  the last event read from 'mysql-bin.000024' at 4  the last byte read from 'mysql-bin.000024' at 4. 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) ~[canal.parse-1.0.22.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_25] 2016-12-22 00:00:54.200 [destination = ixtrade   address = /172.30.10.109:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:ixtrade[java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Client requested master to start replication from impossible position; the first event 'mysql-bin.000024' at 533920026  the last event read from 'mysql-bin.000024' at 4  the last byte read from 'mysql-bin.000024' at 4. 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) 	at java.lang.Thread.run(Thread.java:745) ] 2016-12-22 00:00:54.202 [destination = ixtrade   address = /172.30.10.109:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - disconnect address /172.30.10.109:3306 has an error  retrying.  caused by  java.io.IOException: KILL DUMP 7726 failure:java.io.IOException: ErrorPacket [errorNumber=1094  fieldCount=-1  message=Unknown thread id: 7726  sqlState=HY000  sqlStateMarker=#]  with command: KILL CONNECTION 7726 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlUpdateExecutor.update(MysqlUpdateExecutor.java:49) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.disconnect(MysqlConnector.java:104) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.disconnect(MysqlConnection.java:60) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:242) 	at java.lang.Thread.run(Thread.java:745) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.disconnect(MysqlConnector.java:106) ~[canal.parse.driver-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.disconnect(MysqlConnection.java:60) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:242) ~[canal.parse-1.0.22.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_25] è¿™ä¸ªå¼‚å¸¸åº”è¯¥æ˜¯mysqléæ­£å¸¸å…³é—­åäº§ç”Ÿçš„ï¼Œè¯·é—®è¯¥æ€ä¹ˆå¤„ç†ï¼Ÿ sqlstate = HY000 errmsg = Client requested master to start replication from impossible position; the first event 'mysql-bin.000024' at 533920026  the last event read from 'mysql-bin.000024' at 4  the last byte read from 'mysql-bin.000024' at 4. ä¼°è®¡ä½ç‚¹é”™è¯¯ æ¸…é™¤meta.datä¸­å†…å®¹ æˆ–è€…æ¸…æ¥šzk ä¸­æŠ¥é”™çš„postion ä¿¡æ¯ é‡å¯server ç«¯å°±å¯ä»¥äº†
241,ClusterCanalClientTestè¿è¡Œåserverç«¯é¢‘ç¹åˆ·æ—¥å¿—ï¼š [New I/O server worker #1-2] INFO  c.a.otter.canal.server.netty.handler.SessionHandler - message receives in session handler cloneçš„æœ€æ–°çš„canalé¡¹ç›®ï¼Œç”¨ClusterCanalClientTestèƒ½æ­£å¸¸è·å–DBçš„binlogã€‚ä½†æ˜¯serverç«¯ç–¯ç‹‚åˆ·æ—¥å¿—ã€‚è™½ç„¶æ˜¯INFOï¼Œä½†æ˜¯æ„Ÿè§‰ä¸æ˜¯å¾ˆæ­£å¸¸ã€‚æˆ‘logbacké‚£è¾¹å¼€å¯äº†<appender-ref ref="STDOUT"/>è¿™ä¸ªappender 2016-12-22 18:07:31.810 [New I/O server worker #1-2] INFO  c.a.otter.canal.server.netty.handler.SessionHandler - message receives in session handler... 2016-12-22 18:07:31.810 [New I/O server worker #1-2] INFO  c.a.otter.canal.server.netty.handler.SessionHandler - message receives in session handler... 2016-12-22 18:07:31.810 [New I/O server worker #1-2] INFO  c.a.otter.canal.server.netty.handler.SessionHandler - message receives in session handler... 2016-12-22 18:07:31.810 [New I/O server worker #1-2] INFO  c.a.otter.canal.server.netty.handler.SessionHandler - message receives in session handler... 2016-12-22 18:07:31.810 [New I/O server worker #1-2] INFO  c.a.otter.canal.server.netty.handler.SessionHandler - message receives in session handler... 2016-12-22 18:07:31.810 [New I/O server worker #1-2] INFO  c.a.otter.canal.server.netty.handler.SessionHandler - message receives in session handler... 2016-12-22 18:07:31.810 [New I/O server worker #1-2] INFO  c.a.otter.canal.server.netty.handler.SessionHandler - message receives in session handler... 2016-12-22 18:07:31.810 [New I/O server worker #1-2] INFO  c.a.otter.canal.server.netty.handler.SessionHandler - message receives in session handler... 2016-12-22 18:07:31.810 [New I/O server worker #1-2] INFO  c.a.otter.canal.server.netty.handler.SessionHandler - message receives in session handler... 2016-12-22 18:07:31.810 [New I/O server worker #1-2] INFO  c.a.otter.canal.server.netty.handler.SessionHandler - message receives in session handler... å¼€å¯äº†è¿™ä¸ªSTDOUTçš„appender INFOæ—¥å¿—ï¼Ÿåªæ˜¯æ‰“å°äº†ä¸€ä¸‹æ—¥å¿— å“¦å“¦ï¼ŒçŸ¥é“äº†ã€‚nettyé‡Œé¢çš„é•¿è¿æ¥ï¼Œserverç«¯ä¸€ç›´é•¿è½®è¯¢åœ¨æ‹‰æ¶ˆæ¯ï¼Œæ‰€ä»¥sessionHandlerè¢«é¢‘ç¹è°ƒç”¨äº†~
240,åˆ‡æ¢æˆgroup-instance.xml æ—¶ï¼Œæ¶ˆè´¹ä¸åˆ°æ•°æ® 2016-12-19 17:28:58.734 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## start the canal server. log4j:WARN No appenders could be found for logger (org.I0Itec.zkclient.ZkEventThread). log4j:WARN Please initialize the log4j system properly. 2016-12-19 17:28:58.991 [main] INFO  com.alibaba.otter.canal.deployer.CanalController - ## start the canal server[10.97.14.145:11111] 2016-12-19 17:28:59.527 [main] ERROR c.a.o.c.common.zookeeper.running.ServerRunningMonitor - processActiveEnter failed java.lang.NullPointerException: null 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.start(AbstractEventParser.java:274) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.start(MysqlEventParser.java:145) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.group.GroupEventParser.start(GroupEventParser.java:24) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.instance.core.AbstractCanalInstance.start(AbstractCanalInstance.java:91) ~[canal.instance.core-1.0.22.jar:na] 	at com.alibaba.otter.canal.instance.spring.CanalInstanceWithSpring.start(CanalInstanceWithSpring.java:30) ~[canal.instance.spring-1.0.22.jar:na] 	at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.start(CanalServerWithEmbedded.java:102) ~[canal.server-1.0.22.jar:na] 	at com.alibaba.otter.canal.deployer.CanalController$2$1.processActiveEnter(CanalController.java:121) ~[canal.deployer-1.0.22.jar:na] 	at com.alibaba.otter.canal.common.zookeeper.running.ServerRunningMonitor.processActiveEnter(ServerRunningMonitor.java:234) [canal.common-1.0.22.jar:na] 	at com.alibaba.otter.canal.common.zookeeper.running.ServerRunningMonitor.initRunning(ServerRunningMonitor.java:138) [canal.common-1.0.22.jar:na] 	at com.alibaba.otter.canal.common.zookeeper.running.ServerRunningMonitor.start(ServerRunningMonitor.java:98) [canal.common-1.0.22.jar:na] 	at com.alibaba.otter.canal.deployer.CanalController.start(CanalController.java:396) [canal.deployer-1.0.22.jar:na] 	at com.alibaba.otter.canal.deployer.CanalLauncher.main(CanalLauncher.java:35) [canal.deployer-1.0.22.jar:na] java.lang.NullPointerException: null at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.start(AbstractEventParser.java:274) ~ è¦å­¦ä¼šçœ‹æ—¥å¿— å…³æ³¨ä¸‹æœ€æ–°ç‰ˆ1.0.23 å…³æ³¨ä¸‹æœ€æ–°ç‰ˆ1.0.23
239,ä½¿ç”¨CanalConnectors.newClusterConnectoræŠ¥é”™ã€‚ ä½¿ç”¨zkè·å–canalè¿æ¥æŠ¥é”™ è¯­å¥ï¼š  CanalConnector simpleCanalConnector= CanalConnectors.newClusterConnector("10.100.103.19:2181" "example" "" ""); æŠ¥é”™ä¿¡æ¯ Exception in thread "main" java.lang.IllegalAccessError: tried to access method com.google.common.collect.MapMaker.makeComputingMap(Lcom/google/common/base/Function;)Ljava/util/concurrent/ConcurrentMap; from class com.alibaba.otter.canal.common.zookeeper.ZkClientx 	at com.alibaba.otter.canal.common.zookeeper.ZkClientx.<clinit>(ZkClientx.java:26) 	at com.alibaba.otter.canal.client.CanalConnectors.newClusterConnector(CanalConnectors.java:60) 	at com.foundation.test.canal.ClientCluster.main(ClientCluster.java:25) è§£å†³äº†ã€‚ä¾èµ–æ›´æ–°åˆ°æœ€æ–°çš„1.0.22å°±okäº†ã€‚è€ç‰ˆæœ¬çš„å‚æ•°ä¸ä¸€è‡´ï¼ <dependency>   <groupId>com.alibaba.otter</groupId>   <artifactId>canal.client</artifactId>   <version>1.0.22</version> </dependency>
238,java.io.IOException: end of stream when reading header å¼‚å¸¸ å‰ä¸¤å¤©è¿˜æ­£å¸¸ï¼Œä»Šå¤©çªç„¶æŠ¥äº†è¿™ä¸ªå¼‚å¸¸ 18:08:13.923 [im_message-****] ERROR  ***.mysql.binlog.CanalClient - process error! com.alibaba.otter.canal.protocol.exception.CanalClientException: java.io.IOException: end of stream when reading header 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:281) ~[canal.client.jar:na] 	at cn.ishow.db.mysql.binlog.CanalClient.process(CanalClient.java:160) [Subscriber.jar:na] 	at cn.ishow.db.mysql.binlog.CanalClient.access$100(CanalClient.java:27) [Subscriber.jar:na] 	at cn.ishow.db.mysql.binlog.CanalClient$2.run(CanalClient.java:101) [Subscriber.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_74] Caused by: java.io.IOException: end of stream when reading header 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.read(SimpleCanalConnector.java:378) ~[canal.client.jar:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.readNextPacket(SimpleCanalConnector.java:369) ~[canal.client.jar:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.receiveMessages(SimpleCanalConnector.java:286) ~[canal.client.jar:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:279) ~[canal.client.jar:na] 	... 4 common frames omitted 18:08:13.923 [im_message-****] INFO  ***.mysql.binlog.CanalClient - disconnect éšåcanalå°±è¿ä¸ä¸Šäº†ï¼Œä¸€ç›´æŠ¥é”™ com.alibaba.otter.canal.protocol.exception.CanalClientException: java.net.ConnectException: Connection refused: connect 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.doConnect(SimpleCanalConnector.java:171) ~[canal.client.jar:na] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.connect(SimpleCanalConnector.java:97) ~[canal.client.jar:na] 	at cn.ishow.db.mysql.binlog.CanalClient.process(CanalClient.java:151) [Subscriber.jar:na] 	at cn.ishow.db.mysql.binlog.CanalClient.access$100(CanalClient.java:27) [Subscriber.jar:na] 	at cn.ishow.db.mysql.binlog.CanalClient$2.run(CanalClient.java:101) [Subscriber.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_74] Caused by: java.net.ConnectException: Connection refused: connect 	at sun.nio.ch.Net.connect0(Native Method) ~[na:1.8.0_74] 	at sun.nio.ch.Net.connect(Net.java:454) ~[na:1.8.0_74] 	at sun.nio.ch.Net.connect(Net.java:446) ~[na:1.8.0_74] 	at sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:648) ~[na:1.8.0_74] 	at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.doConnect(SimpleCanalConnector.java:132) ~[canal.client.jar:na] 	... 5 common frames omitted sorry è‡ªå·±çš„é—®é¢˜ ä»€ä¹ˆåŸå› ï¼Œæˆ‘ä¹Ÿé‡åˆ°äº† ä»€ä¹ˆé—®é¢˜ï¼Œæˆ‘ä¹Ÿé‡åˆ°äº†ï¼Œçªç„¶å°±æœ‰è¿™ä¸ªé—®é¢˜ @AnakinSkyW 
237,å…³äºcanalåµŒå…¥å¼æ¨¡å¼é‡å¯åæ•°æ®ä¸¢å¤±é—®é¢˜ å¤§ç¥å¥½ï¼š  æœ¬äººä½¿ç”¨çš„canal-1.0.22ç‰ˆæœ¬ï¼Œå‚ç…§otterå†™äº†ä¸€ä¸ªæ•°æ®è®¢é˜…å¹³å°ï¼Œç”±äºç›®å‰canalçš„event storeåªæœ‰memoryæ¨¡å¼ï¼Œå½“eventstoreä¸­çš„æ•°æ®è¿˜æ²¡æœ‰æ¥å¾—åŠæ¶ˆè´¹æ—¶ï¼Œè¿›è¡Œé‡å¯åï¼Œcanalä¼šä»ä¸Šæ¬¡è§£æçš„ä½ç½®è¿›è¡Œæ•°æ®é‡æ–°è£…è½½æ¶ˆè´¹ï¼Œäºæ˜¯å¯¼è‡´äº†é‡å¯å‰æœªæ¶ˆè´¹eventstoreçš„æ•°æ®ä¸¢å¤±ã€‚è¯·é—®é’ˆå¯¹è¿™ä¸ªé—®é¢˜ç›®å‰æœ‰æ²¡æœ‰å¥½çš„å¤„ç†æ€è·¯ï¼Œæˆ–è€…æ–°çš„ç‰ˆæœ¬è§„åˆ’? ä¸ä¼šä¸¢å¤±æ•°æ®çš„ï¼Œä¸‹æ¬¡é‡å¯å‰ä¼šä»¥ä½ æœ€åæ¶ˆè´¹ackçš„ä½ç‚¹è¿›è¡Œé‡æ‹‰binlogï¼ŒåŒ…æ‹¬ä¹‹å‰å†…å­˜é‡Œæ²¡æ¶ˆè´¹çš„æ•°æ® çœ‹äº†ä¸€ä¸‹ä»£ç ï¼Œackåªæ˜¯æ¸…ç©ºäº†storeä¸­æ•°æ®ï¼Œæ²¡æœ‰çœ‹åˆ°å†™zookeeperï¼Œä¸‹æ¬¡é‡å¯åï¼Œè¯»å–åˆ°äº†zookeeper parseèŠ‚ç‚¹çš„binlogä½ç½®ï¼Œå¯¼è‡´æ•°æ®ä¸¢å¤±çš„ ä½ è¦é€‰æ‹©default-instance.xmlæ¨¡å¼ï¼Œå°±å¯ä»¥ä¿è¯åˆ·åˆ°zookeeperï¼Œå¯ä»¥å…ˆçœ‹ä¸‹adminGuide wiki å¤§æ¦‚å‘ç°é—®é¢˜äº†ï¼Œæˆ‘åœ¨åˆå§‹åŒ–CanalLogPositionManageræ—¶ä½¿ç”¨çš„ZOOKEEPERæ¨¡å¼ï¼Œå¯¼è‡´å¹¶ä¸ä¼šè§£æMetaLogPositionï¼Œå¦å¤–æˆ‘çš„MetaManageråˆšå¥½ä¹Ÿæ˜¯MEMORYæ¨¡å¼ï¼Œä¹Ÿå¹¶ä¸å†™MetaLogPositionï¼Œå¤šè°¢ï¼
236,ä¸ºä»€ä¹ˆè¿è¡Œå¥½å¥½çš„ï¼Œçªç„¶æŠ¥é”™Could not find first log file name in binary log index file åŒå‘åŒæ­¥ä¸­ï¼Œå‡ºç°çš„ã€‚è€Œä¸”è¿˜å½±å“äº†å•å‘åŒæ­¥ã€‚ æŒ‡å®šäº†ä½ç‚¹ï¼ŒåŒæ­¥çœ‹èµ·æ¥æ­£å¸¸ï¼Œä½†æ˜¯å§‹ç»ˆå¤„äºå®šä½ä¸­ï¼Œæ•°æ®ä¸åŒæ­¥ã€‚ æˆ‘è¿™è¾¹ä¹Ÿæ˜¯ï¼Œè¿è¡Œç€ çªç„¶æŠ¥è¿™ä¸ª  canal 1.0.22    rds  æˆ‘è®°å¾—canal1.0.22å·²ç»æ”¯æŒäº†rds(myql)çš„ä¸»å¤‡åˆ‡æ¢æ—¶çš„binlogè‡ªåŠ¨åˆ‡æ¢çš„é—®é¢˜ã€‚ä½†æ˜¯è¿˜æ˜¯ä¼šæœ‰è¿™ä¸ªé—®é¢˜ ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) ~[canal.parse-1.0.22.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) [canal.parse-1.0.22.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) [canal.parse-1.0.22.jar:na]         at java.lang.Thread.run(Thread.java:744) [na:1.7.0_45] rdsä¼šæœ‰åˆ é™¤binlogçš„æ“ä½œï¼Œå¦‚æœæ¶ˆè´¹æœ‰å»¶è¿Ÿå°±å®¹æ˜“å‡ºç°ä½ç‚¹ä¸åœ¨çš„æƒ…å†µ è¯·é—®è¿™ä¸ªè¦æ€ä¹ˆå¤„ç†
235,å¤šè¡¨è¿›è¡Œæ•°æ®èšåˆ å‡ºç°æºåº“è¡¨çš„id ä¼šè¦†ç›– ç›®çš„è¡¨åº“çš„id å¯¼è‡´å¤šæ¡åªæœ‰ä¸€æ¡è®°å½• æœ‰ä»€ä¹ˆè§£å†³æ–¹æ¡ˆ~? æºå’Œç›®æ ‡è®¾ç½®ä¸åŒçš„idæ®µ è¿™æ ·å°±å¾ˆä¸åˆç†äº† è®¾ç½®ä¸åŒçš„idæ®µ æ˜¯æº1-100ç›®æ ‡æ˜¯100-200å—? æˆ‘æœ‰è®¾ç½®è¿‡æŠŠidæ˜ å°„åˆ°mid ç„¶åå°±ä¼šå¤šå‡ºè®°å½•æ¥ è€Œä¸æ˜¯åœ¨å€¼ç›¸åŒçš„åœ°æ–¹è¿›è¡Œè¦†ç›–~ èšåˆæ–¹é¢çš„ä¸èƒ½æ•´åˆå—? 2016-12-20 22:45 GMT+08:00 agapple <notifications@github.com>: > æºå’Œç›®æ ‡è®¾ç½®ä¸åŒçš„idæ®µ > > â€” > You are receiving this because you authored the thread. > Reply to this email directly  view it on GitHub > <https://github.com/alibaba/canal/issues/235#issuecomment-268260730>  or mute > the thread > <https://github.com/notifications/unsubscribe-auth/AILd__h0spaA-5aLl4sX14smS1DpcYa6ks5rJ-obgaJpZM4LGToY> > . > åˆ†å¸ƒå¼åœºæ™¯ä¸‹ï¼Œä¸åŒåˆ†åŒºçš„idéƒ½è¦æ±‚å”¯ä¸€ï¼Œå¦åˆ™è½åˆ°ä¸€ä¸ªåº“ä¸Šæ€ä¹ˆåˆ¤æ–­æ˜¯å¦æ˜¯ä¸€æ¡è®°å½•
234,Merge pull request #1 from alibaba/master full pull [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=234) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=234) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/alibaba/canal?pullRequest=234) it.</sub> ä¸»è¦å˜æ›´äº†å•¥ï¼Ÿæ²¡çœ‹æ‡‚æäº¤çš„å†…å®¹  @agapple è¿™æ˜¯åœ¨è€ç‰ˆæœ¬ä¸Šä»ä¸Šæ¸¸åšäº†ä¸€æ¬¡åˆå¹¶ï¼Œç”Ÿæˆäº† git no-ff çš„ä¸€ä¸ªèŠ‚ç‚¹ã€‚å…¶å®é‡Œé¢å•¥å†…å®¹éƒ½æ²¡æœ‰ï¼Œå…³æ‰å§ã€‚
233,canalåŸºäºtimestampä½ç‚¹å›æŠ½æŠ¥é”™ canalç‰ˆæœ¬ï¼š1.0.22 æµ‹è¯•æ—¶åŸºäºtimestampä½ç‚¹ä¿¡æ¯é…ç½®æ•°æ®é‡æŠ½ï¼Œå‘ç°æ—¥å¿—é‡Œä¸æ–­æŠ¥é”™ï¼Œè¯·é—®æ˜¯ä»€ä¹ˆåŸå› ï¼Œè¯¥å¦‚ä½•è§£å†³ï¼ŸæŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ï¼š 2016-12-05 19:24:29.049 [destination = oms_orders   address = /172.172.230.36:3307   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position ::1480780800000 2016-12-05 19:24:49.062 [destination = oms_orders   address = /172.172.230.36:3307   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - ERROR ## findAsPerTimestampInSpecificLogFile has an error java.io.IOException: KILL DUMP 19915370 failure:java.io.IOException: ErrorPacket [errorNumber=1094  fieldCount=-1  message=Unknown thread id: 19915370  sqlState=HY000  sqlStateMarker=#]  with command: KILL CONNECTION 19915370         at com.alibaba.otter.canal.parse.driver.mysql.MysqlUpdateExecutor.update(MysqlUpdateExecutor.java:49)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.disconnect(MysqlConnector.java:104)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.reconnect(MysqlConnector.java:82)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.reconnect(MysqlConnection.java:56)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findAsPerTimestampInSpecificLogFile(MysqlEventParser.java:674)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findByStartTimeStamp(MysqlEventParser.java:519)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPositionInternal(MysqlEventParser.java:356)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPosition(MysqlEventParser.java:313)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:162)         at java.lang.Thread.run(Thread.java:745)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.disconnect(MysqlConnector.java:106) ~[canal.parse.driver-1.0.22.jar:na]         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.reconnect(MysqlConnector.java:82) ~[canal.parse.driver-1.0.22.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.reconnect(MysqlConnection.java:56) ~[canal.parse-1.0.22.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findAsPerTimestampInSpecificLogFile(MysqlEventParser.java:674) [canal.parse-1.0.22.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findByStartTimeStamp(MysqlEventParser.java:519) [canal.parse-1.0.22.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPositionInternal(MysqlEventParser.java:356) [canal.parse-1.0.22.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPosition(MysqlEventParser.java:313) [canal.parse-1.0.22.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:162) [canal.parse-1.0.22.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.8.0_101] ![image](https://cloud.githubusercontent.com/assets/7370509/20909493/1b10a274-bb97-11e6-8098-6fa85a4ab56e.png) æˆ‘ç”¨çš„1.0.22ç‰ˆæœ¬é‡Œçš„ä»£ç ï¼Œå‘ç°å¼‚å¸¸ä¸æ˜¯è®°å½•æ—¥å¿— å·²ä¿®æ”¹ï¼Œä½¿ç”¨å½“å‰masteræ‰“ä¸ªåŒ…è¯•è¯• é‡æ–°åŸºäºmasteråšäº†ç¼–è¯‘ï¼Œæ›¿æ¢äº†driverä¸‹çš„mysqlconnectorç±»ï¼Œä¸å½±å“æŠ½å–æµç¨‹äº†
232,ErrorPacket [errorNumber=1094  fieldCount=-1  message=Unknown thread id: 335944433  sqlState=HY000  sqlStateMarker=#] canalç‰ˆæœ¬:1.0.22 mysqlç‰ˆæœ¬ï¼šé˜¿é‡Œäº‘rds mysql5.6.16-log æŠ¥å¦‚ä¸‹å¼‚å¸¸: 2016-12-05 10:05:19.828 [destination = example   address = xxx.mysql.rds.aliyuncs.com/xxx:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Unexpected End Stream 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) [canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) [canal.parse-1.0.22.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_111] 2016-12-05 10:05:19.837 [destination = example   address = xxx.mysql.rds.aliyuncs.com/xxx:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address xxx.mysql.rds.aliyuncs.com/xxx:3306 has an error  retrying. caused by  java.io.IOException: Unexpected End Stream 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) ~[canal.parse-1.0.22.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_111] 2016-12-05 10:05:19.841 [destination = example   address = xxx.mysql.rds.aliyuncs.com/xxx:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.io.IOException: Unexpected End Stream 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) 	at java.lang.Thread.run(Thread.java:745) ] 2016-12-05 10:05:19.858 [destination = example   address = xxx.mysql.rds.aliyuncs.com/xxx:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - disconnect address xxx.mysql.rds.aliyuncs.com/xxx:3306 has an error  retrying.  caused by  java.io.IOException: KILL DUMP 335944433 failure:java.io.IOException:   with command: KILL CONNECTION 335944433 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlUpdateExecutor.update(MysqlUpdateExecutor.java:49)ErrorPacket [errorNumber=1094  fieldCount=-1  message=Unknown thread id: 335944433  sqlState=HY000  sqlStateMarker=#] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.disconnect(MysqlConnector.java:104) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.disconnect(MysqlConnection.java:60) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:242) 	at java.lang.Thread.run(Thread.java:745) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.disconnect(MysqlConnector.java:106) ~[canal.parse.driver-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.disconnect(MysqlConnection.java:60) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:242) ~[canal.parse-1.0.22.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_111] 2016-12-05 10:05:33.210 [destination = example   address = xxx.mysql.rds.aliyuncs.com/xxx:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position 2016-12-05 10:05:33.249 [destination = example   address = xxx.mysql.rds.aliyuncs.com/xxx:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) [canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) [canal.parse-1.0.22.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_111] 2016-12-05 10:05:33.250 [destination = example   address = xxx.mysql.rds.aliyuncs.com/xxx:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address xxx.mysql.rds.aliyuncs.com/xxx:3306 has an error  retrying. caused by  java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) ~[canal.parse-1.0.22.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_111] 2016-12-05 10:05:33.250 [destination = example   address = xxx.mysql.rds.aliyuncs.com/xxx:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) 	at java.lang.Thread.run(Thread.java:745) ] destination:example[java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file æ˜¯å‡ºç°java.io.IOException: Unexpected End Streamä¹‹åå‘é€KILL DUMP 335944433 ä¹‹å ï¼Œç„¶åæ¥æ”¶åˆ°äº† [errorNumber=1094  fieldCount=-1  message=Unknown thread id: 335944433  sqlState=HY000  sqlStateMarker=#]ï¼Œå†é‡è¿å°±å‡ºç°Could not find first log file name in binary log index fileäº†ï¼Œæƒ³é—®ä¸€ä¸‹æ˜¯ä¸æ˜¯é‚£ä¸ªjava.io.IOException: Unexpected End Streamé€ æˆçš„ Could not find first log file name in binary log index fileï¼Œè¿™ä¸ªæ˜¯ä¸»å› 
231,fixed issue #227   fixed Mysql5.1.73 throw NullPointerException `select @master_binlog_checksum` åœ¨mysql5.1ç‰ˆæœ¬ä¸­è¿”å›null ä¼šè§¦å‘NullPointerException [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=231) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=231) before we can accept your contribution.<br/> tks
230,canalç›‘å¬é—®é¢˜ canalæœåŠ¡ï¼Œæˆ‘è®¾ç½®ç›‘å¬äº†ä¸€ä¸ªæ•°æ®åº“çš„**tjxt-busi-cs**è¡¨ï¼Œä½†æ˜¯ç¨‹åºè¿æ¥åˆ°æ­¤canalä¸Šï¼Œå´èƒ½æ‰“å°å‡ºåˆ«çš„æ•°æ®åº“**tjxt-busi-ln**çš„è¡¨æ•°æ®å˜åŒ–ã€‚ä¸¤ä¸ªæ•°æ®åº“åœ¨åŒä¸€ä¸ªæœºå™¨çš„mysqlä¸­ã€‚ è¿™æ˜¯æˆ‘canal instanceçš„é…ç½®ä¿¡æ¯ ``` canal.instance.mysql.slaveId = 2283306 canal.instance.master.address = 192.168.10.100:3306 canal.instance.master.journal.name =  canal.instance.master.position =  canal.instance.master.timestamp =  #canal.instance.standby.address =  #canal.instance.standby.journal.name = #canal.instance.standby.position =  #canal.instance.standby.timestamp =  canal.instance.dbUsername = canal canal.instance.dbPassword = canal canal.instance.defaultDatabaseName = tjxt-busi-cs canal.instance.connectionCharset = UTF-8 canal.instance.filter.regex = .*\\..* canal.instance.filter.black.regex =   ``` æˆ‘ç¨‹åºé‡Œè¿æ¥è¿™ä¸ªcaanlï¼Œæ‰“å°binlogä¿¡æ¯ï¼Œå±…ç„¶ç›‘å¬åˆ°äº†åˆ«çš„æ•°æ®åº“çš„binlogæ—¥å¿— c.f.s.c.listener.BusiAnscWatcherThread - ================> binlog[mysqld-bin.000015:687343087]   name[**tjxt-busi-ln** busi_wife_b_value]   eventType : INSERT ä¸æ¸…æ¥šä¸ºä»€ä¹ˆè¿™æ ·ã€‚ canal.instance.defaultDatabaseName = tjxt-busi-cs è¿™ä¸ªå±æ€§ä¸æ˜¯ç”¨æ¥æŒ‡å®šcanalåªç›‘å¬è¿™ä¸€ä¸ªæ•°æ®åº“çš„ã€‚ä½ æƒ³ä¸€ä¸‹binlogæ˜¯é’ˆå¯¹ä¸€ä¸ªDBå®ä¾‹çš„ã€‚ä¸æ˜¯é’ˆå¯¹ä¸€ä¸ªæ•°æ®åº“çš„ã€‚ @AllenRay å—¯å—¯ã€‚çŸ¥é“åŸç†äº†ã€‚è°¢è°¢ã€‚ã€‚æˆ‘æƒ³æƒ³é€šè¿‡åˆ«çš„æ–¹å¼è¿›è¡Œè§£å†³ä¸€ä¸‹
229,java.io.IOException: Unexpected End Streamå¼‚å¸¸ canalç‰ˆæœ¬ 1.0.16 å¶å‘æ€§çš„æŠ¥å¦‚ä¸‹å¼‚å¸¸ï¼š 2016-11-30 12:56:17.588 [destination = example   address = /xxx:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Unexpected End Stream 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156) ~[canal.parse-1.0.16.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:78) ~[canal.parse-1.0.16.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:116) [canal.parse-1.0.16.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:208) [canal.parse-1.0.16.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.7.0_67] 2016-11-30 12:56:17.588 [destination = example   address = /xxx:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /172.16.81.97:23306 has an error  retrying. caused by  java.io.IOException: Unexpected End Stream 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156) ~[canal.parse-1.0.16.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:78) ~[canal.parse-1.0.16.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:116) ~[canal.parse-1.0.16.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:208) ~[canal.parse-1.0.16.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.7.0_67] 2016-11-30 12:56:17.588 [destination = example   address = /xxx:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.io.IOException: Unexpected End Stream 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156) 	at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:78) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:116) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:208) 	at java.lang.Thread.run(Thread.java:745) ] ä¸”ä¼´éšç€ä¸¢å¤±binlogï¼Œå¶å‘çš„æ—¶é—´æ²¡æœ‰è§„å¾‹æ€§ï¼Œæœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™ä¸ªé—®é¢˜ï¼Ÿ å‡ ä¸ªå»ºè®®ï¼š 1. å‡çº§ä¸‹canalç‰ˆæœ¬åˆ°æœ€æ–°ç‰ˆ 2. å¼€å¯å¿ƒè·³SQL å®šæ—¶äº§ç”Ÿå¿ƒè·³äº‹ä»¶ ä¿è¯TCPé“¾æ¥ä¸€è‡´æœ‰åŒ…ä¼ é€’ æˆ‘ä¹Ÿé‡åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œå…·ä½“åœºæ™¯æ˜¯ï¼Œä¸€å¼ 60å¤šä¸‡è®°å½•çš„è¡¨ï¼Œæœ‰æ‰¹é‡æ›´æ–°æ“ä½œï¼ˆupdateè¯­å¥æ²¡æœ‰whereæ¡ä»¶ï¼‰ï¼Œè¿™æ ·åŸºäºrowæ¨¡å¼çš„binlogå°±ç‰¹åˆ«å¤šï¼Œæ¯æ¬¡æ‰§è¡Œåˆ°30wæ•°æ®æ—¶ï¼Œå°±æŠ¥è¿™ä¸ªé”™è¯¯äº†ã€‚æˆ‘ç°åœ¨ä½¿ç”¨çš„æœ€æ–°ç‰ˆæœ¬ï¼Œå¹¶ä¸”åŠ ä¸Šäº†å¿ƒè·³sqlï¼Œè¿˜æ˜¯å‡ºç°åŒæ ·çš„é—®é¢˜ï¼Œæœ‰æ²¡æœ‰å…¶ä»–è§£å†³æ–¹æ¡ˆäº†ï¼Ÿ é™„å¼‚å¸¸æ—¥å¿—ï¼š 2017-03-03 09:14:29.255 [destination = shuangshi   address = /10.3.250.93:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Unexpected End Stream         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156) ~[canal.parse-1.0.23.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:78) ~[canal.parse-1.0.23.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:121) [canal.parse-1.0.23.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) [canal.parse-1.0.23.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.8.0_111] 2017-03-03 09:14:29.255 [destination = shuangshi   address = /10.3.250.93:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address 10.3.250.93/10.3.250.93:3306 has an error  retrying. caused by java.io.IOException: Unexpected End Stream         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156) ~[canal.parse-1.0.23.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:78) ~[canal.parse-1.0.23.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:121) ~[canal.parse-1.0.23.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) ~[canal.parse-1.0.23.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.8.0_111] 2017-03-03 09:14:29.256 [destination = shuangshi   address = /10.3.250.93:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:shuangshi[java.io.IOException: Unexpected End Stream         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:78)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:121)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209)         at java.lang.Thread.run(Thread.java:745) ] æµ‹è¯•äº†ä¸€ä¸‹ï¼Œè²Œä¼¼æ˜¯å®¢æˆ·ç«¯å¤„ç†æ—¶é—´è¿‡é•¿å¯¼è‡´çš„ï¼Œå¦‚æœå®¢æˆ·ç«¯å¤„ç†å¾ˆå¿«ï¼Œå°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚æ‰€ä»¥æˆ‘ç›®å‰çš„è§£å†³æ–¹æ¡ˆæ˜¯åœ¨å®¢æˆ·ç«¯ä¸­å°†æ¥æ”¶messageå’Œå¤„ç†é€šè¿‡æ–‡ä»¶é˜Ÿåˆ—å¼‚æ­¥å¤„ç†ã€‚ä½†è¿™æ ·å¸¦æ¥ä¸€ä¸ªéº»çƒ¦ï¼Œå°±æ˜¯å¤±è´¥çš„é€»è¾‘ï¼Œå¾—åœ¨å®¢æˆ·ç«¯åœ¨å®ç°ä¸€æ¬¡ã€‚ å„ä½å‰è¾ˆï¼Œè¿™ä¸ªé—®é¢˜æˆ‘ä¹Ÿæ˜¯æ—¶ä¸æ—¶çš„å‡ºç°ï¼Œæœ‰å®ç”¨çš„è§£å†³æ–¹æ¡ˆå—ï¼Œè°¢è°¢å•¦ ä¸çŸ¥é“ä½ è§£å†³äº†å—ï¼Ÿæˆ‘ä¸€æ ·çš„é—®é¢˜ï¼Œæ•°æ®å †ç§¯åœ¨masterå°±æŠ¥é”™ @tutulvlv 
228,å¯åŠ¨startup.shæŠ¥é”™ ä¸‹è½½çš„masterç‰ˆæœ¬1.0.23-SNAPSHOTã€‚ æ ¹æ®QuickStartä¸­å¯åŠ¨ï¼šsh bin/startup.sh æŠ¥é”™å¦‚ä¸‹ï¼š : not found 2: startup.sh:  startup.sh: 4: startup.sh: Syntax error: word unexpected (expecting "in") ä¼°è®¡æ˜¯å’Œä½ ç¯å¢ƒæ‰€æœ‰çš„shellç¯å¢ƒä¸å…¼å®¹å¯¼è‡´ï¼Œä½ å¯ä»¥æœ¬åœ°æµ‹è¯•ä¿®å¤ä¸€ä¸‹ï¼Œæäº¤ä¸€ä¸ªPRå§ æˆ‘ä¹Ÿé‡åˆ°åŒæ ·çš„é—®é¢˜ï¼Œä¸è¿‡æœ€åæ’æŸ¥ä¸‹æ¥æ˜¯æ¢è¡Œç¬¦å¯¼è‡´çš„ ä¸‹è½½ä¸€ä¸ªdos2unixè½¬æ¢ä¸€ä¸‹å°±æå®šäº† @keyganker  æˆ‘çš„ä¸æ˜¯è¿™ä¸ªåŸå› ï¼Œæ˜¯shellç¯å¢ƒä¸å…¼å®¹å¯¼è‡´çš„ã€‚ æˆ‘çš„linuxç‰ˆæœ¬æ˜¯ubuntu 4.4.0-36-genericï¼Œè¿™ä¸ªç‰ˆæœ¬è‡ªå¸¦çš„shä¼°è®¡å’Œå®˜æ–¹çš„ä¸ä¸€æ ·ã€‚ å‘½ä»¤æ”¹ä¸ºç”¨bash stop.shå°±æ²¡æœ‰é—®é¢˜äº†ã€‚ :set ff=unix
227,canalä»“åº“ä»£ç ç¼–è¯‘ä¹‹å ä¸æ”¯æŒmysql5.1çš„é—®é¢˜ hi canalå¼€å‘å›¢é˜Ÿ æˆ‘ä½¿ç”¨canalä»“åº“ä¸­masteråˆ†æ”¯çš„ä»£ç ç¼–è¯‘. Mysql Server version: 5.1.73 é”™è¯¯ä¿¡æ¯: > ERROR: [destination = example   address = test/192.168.10.16:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlConnection - java.io.IOException: ErrorPacket [errorNumber=1193  fieldCount=-1  message=Unknown system variable 'binlog_checksum'  sqlState=HY000  sqlStateMarker=#]  with command: set @master_binlog_checksum= @@global.binlog_checksum changed file:https://github.com/alibaba/canal/commit/0c9eecd758a8cba0f218a121f83d3e8f01c4dee8 ![image](https://cloud.githubusercontent.com/assets/9983697/20620006/5bffa586-b332-11e6-80b6-3dd104c87c00.png) è¿™ç¯‡ç­”æ¡ˆè¯´`binlog_checksum`å˜é‡æ˜¯ä»mysql5.6æ‰å¼€å§‹æ”¯æŒ.[å‚è€ƒ](http://dba.stackexchange.com/questions/66226/mysql-slave-database-wont-start) å¦‚æœæ˜¯è¿™æ ·çš„è¯ æ—¶å€™æ„å‘³ç€canalä»¥åä¸ä¼šæ”¯æŒmysql5.6ä»¥ä¸‹ç‰ˆæœ¬? thx å¯ä»¥å¢åŠ try lockæœºåˆ¶å¿½ç•¥å¼‚å¸¸è®¾ç½®çš„æƒ…å†µ.  Mysql Server version: 5.1.73 [MysqlConnection.java#L282](https://github.com/alibaba/canal/blob/3f38ad6f4927e1d3bcf43faca8501df1e706405c/parse/src/main/java/com/alibaba/otter/canal/parse/inbound/mysql/MysqlConnection.java#L282 )   æŠ›å‡º NullPointerException é‡åˆ°äº†åŒæ ·çš„é—®é¢˜ï¼Œè€ç‰ˆæœ¬çš„5.1.73 ï¼Œæ¥¼ä¸Šæœ€ç»ˆçš„è§£å†³æ–¹æ¡ˆï¼Ÿ ä½¿ç”¨å½“å‰ä¸»å¹²è¯•è¯•
226,æ¸…ç†äº†ä¸€ä¸‹ ä¸»mysqlä¸»çš„binlogæ—¥å¿—ï¼Œç„¶åé‡å¯äº†canalï¼Œcanal æœåŠ¡ç«¯å¯åŠ¨æŠ¥é”™ æˆ‘æ¸…ç†äº†ä¸€ä¸‹ ä¸»mysqlä¸»çš„binlogæ—¥å¿—ï¼Œç„¶åé‡å¯äº†canal  canal æœåŠ¡ç«¯å¯åŠ¨æŠ¥é”™ã€‚ ``` 2016-11-22 15:41:55.513 [destination = tj-172.18.100.97   address = /172.18.100.97:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - disconnect address /172.18.100.97:3306 has an error  retrying.  caused by  java.io.IOException: KILL DUMP 1299 failure:java.io.IOException: ErrorPacket [errorNumber=1094  fieldCount=-1  message=Unknown thread id: 1299  sqlState=HY000  sqlStateMarker=#]  with command: KILL CONNECTION 1299 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlUpdateExecutor.update(MysqlUpdateExecutor.java:49) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.disconnect(MysqlConnector.java:104) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.disconnect(MysqlConnection.java:60) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:242) 	at java.lang.Thread.run(Thread.java:745) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.disconnect(MysqlConnector.java:106) ~[canal.parse.driver-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.disconnect(MysqlConnection.java:60) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:242) ~[canal.parse-1.0.22.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.7.0_79] ``` è¿™å¤§æ¦‚æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„å‘¢ï¼Ÿ æˆ‘ä¸»è¦æ˜¯æŠŠä¸»mysqlçš„binlogæ—¥å¿—æ¸…ç†äº†ï¼Œbinlogä»å¤´å¼€å§‹äº†ã€‚ä½†meta.daté‡Œé¢è®°å½•çš„å´ä¸æ˜¯ã€‚æ‰€ä»¥å¯åŠ¨canalæŠ¥é”™äº†ï¼Œæ¸…ç†äº†ä¸€ä¸‹ instanceçš„meta.dat æ–‡ä»¶ï¼Œå°±å¯ä»¥äº† 
225,canal æœåŠ¡ç«¯è¿è¡Œä¸€æ®µæ—¶é—´ä¼šæŠ¥å¦‚ä¸‹é”™ã€‚ä¸çŸ¥é“å¦‚ä½•è§£å†³ã€‚ æˆ‘ç¨‹åºå¯åŠ¨è¿æ¥canal æŠ¥é”™ï¼š something goes wrong with reason: something goes wrong with channel  com.alibaba.otter.canal.server.exception.CanalServerException: ack error   clientId:1001 batchId:47 is not exist   please check æ€ä¹ˆè§£å†³ï¼ŸcanalæœåŠ¡ç«¯æˆ‘ä¹Ÿé‡å¯äº†ã€‚è¿è¡Œäº†ä¸€ä¸‹ï¼Œè¿‡ä¸€é˜µç¨‹åºå¯åŠ¨è¿˜æ˜¯ç»§ç»­ä¼šæŠ¥é”™ ä¸‹é¢æ˜¯æˆ‘çš„ä»£ç  ``` while (true) {                 Message message = connector.getWithoutAck(1000); // è·å–æŒ‡å®šæ•°é‡çš„æ•°æ®                 long batchId = message.getId();                 int size = message.getEntries().size();                 if (batchId == -1 || size == 0) {                     try {                         Thread.sleep(1000);                     } catch (InterruptedException e) {}                 } else {                     long beginTime = DateUtils.nowDateToTimestamp();                     //é€»è¾‘:1å…ˆåˆ¤æ–­æ’å…¥ä¸æ›´æ–°2å¦‚æœæ˜¯çŠ¶æ€å·²å®Œæˆ4ï¼Œåˆ™è·å–æ•°æ®ã€‚è¿›è¡Œä¿å­˜ï¼Œå­˜mongdb                     try {                         switchHandle(message.getEntries());                         connector.ack(batchId); // æäº¤ç¡®è®¤                     } catch (Exception e) {                         //System.out.println("åŒæ­¥é”™è¯¯ï¼Œéœ€è¦å›æ»š" + e.getMessage());                         logger.error("åŒæ­¥é”™è¯¯ï¼Œéœ€è¦å›æ»š"  e);                         connector.rollback(batchId);                         continue;                     }                     long endTime = DateUtils.nowDateToTimestamp();                     logger.info("æ­¤æ¬¡åŒæ­¥æ—¶é—´æ˜¯:" + (endTime - beginTime) + " ms");                 } } ``` å‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œæ€€ç–‘æ˜¯serverç«¯å‘ç”Ÿäº†instanceé‡å¯ï¼Œå¯¼è‡´å†…å­˜é‡Œçš„batchIdä¸¢å¤±.  æ£€æŸ¥ä¸€ä¸‹æœåŠ¡ç«¯çš„æ—¥å¿— @agapple è¿˜çœŸæ˜¯è¿™ä¸ªé—®é¢˜ã€‚ serverç«¯å¼€å¯äº†scan=trueæ‰«æï¼Ÿ æˆ‘ä¹Ÿé‡åˆ°è¿™ä¸ªé—®é¢˜ï¼Œè¯·é—®æ˜¯æ€ä¹ˆè§£å†³çš„å•Šï¼Ÿ å®¢æˆ·ç«¯å¢åŠ é‡è¯•ï¼Œæˆ–è€…æœåŠ¡ç«¯å…³é—­scan=false @SHUlibee ä¸¤ç§æ€è·¯ã€‚ä¸€ä¸ªæ˜¯ç¡®è®¤ä¸€ä¸‹æ˜¯å¦æ˜¯canal serverè¿›è¡Œäº†é‡å¯ï¼Œå†å°±æ˜¯ç¡®è®¤mysqlçš„binlogæ˜¯å¦è¿›è¡Œäº†æ¸…ç†ï¼Œcanalçš„meta.dataæ˜¯å¦è¿›è¡Œäº†æ¸…ç†ã€‚ã€‚ åŒæ—¶å¦‚æœè¿›è¡Œä¼˜åŒ–çš„è¯ï¼Œå¯ä»¥è·Ÿageppleè¯´çš„é‚£æ ·clientç«¯å¢åŠ é‡è¯•æœºåˆ¶ï¼Œå¹¶ä¸”å…³é—­æŠŠcanal Serverçš„scanè®¾ç½®æˆfalse ä¸€æ ·çš„é”™ï¼Œæ±‚è§£ æˆ‘è¿™è¾¹æ˜¯åˆ‡æ¢äº†kakfaçš„ç‰ˆæœ¬ ä¿®æ”¹äº†kafkaå’Œzookeeperçš„åœ°å€ ä¹‹åå°±ä¸€ç›´æŠ¥è¿™ä¸ªé”™è¯¯ è¯·æ•™ä¸‹æ€ä¹ˆå¤„ç†? ``` 2018-05-29 11:00:08.799 [Thread-4] WARN  c.alibaba.otter.canal.client.impl.ClusterCanalConnector - something goes wrong when rollbacking data from server:null com.alibaba.otter.canal.protocol.exception.CanalClientException: java.io.IOException: Broken pipe         at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.rollback(SimpleCanalConnector.java:342)         at com.alibaba.otter.canal.client.impl.ClusterCanalConnector.rollback(ClusterCanalConnector.java:216)         at com.xiaomatech.dbevent.canal.dbkafka.AbstractCanalClient.process(AbstractCanalClient.java:203)         at com.xiaomatech.dbevent.canal.dbkafka.AbstractCanalClient$2.run(AbstractCanalClient.java:99)         at java.lang.Thread.run(Thread.java:745) Caused by: java.io.IOException: Broken pipe         at sun.nio.ch.FileDispatcherImpl.write0(Native Method)         at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)         at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)         at sun.nio.ch.IOUtil.write(IOUtil.java:65)         at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:470)         at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.writeWithHeader(SimpleCanalConnector.java:359)         at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.rollback(SimpleCanalConnector.java:336)         ... 4 more 2018-05-29 11:00:13.869 [Thread-4] INFO  c.alibaba.otter.canal.client.impl.ClusterCanalConnector - restart the connector for next round retry. 2018-05-29 11:00:13.902 [Thread-4] WARN  c.alibaba.otter.canal.client.impl.ClusterCanalConnector - something goes wrong when getWithoutAck data from server:null com.alibaba.otter.canal.protocol.exception.CanalClientException: something goes wrong with reason: something goes wrong with channel:[id: 0x513ca1d3  /10.20.105.201:39029 => /10.20.105.201:11112]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: rollback error  clientId:1001 batchId:3 is not exist   please check         at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.receiveMessages(SimpleCanalConnector.java:302)         at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:279)         at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:252)         at com.alibaba.otter.canal.client.impl.ClusterCanalConnector.getWithoutAck(ClusterCanalConnector.java:180)         at com.xiaomatech.dbevent.canal.dbkafka.AbstractCanalClient.process(AbstractCanalClient.java:186)         at com.xiaomatech.dbevent.canal.dbkafka.AbstractCanalClient$2.run(AbstractCanalClient.java:99)         at java.lang.Thread.run(Thread.java:745) ``` @agapple  ä¸€æ ·çš„é”™ï¼Œå…³é—­scan=falseä¹Ÿä¸è¡Œã€‚
224,clientè·å–ä¸åˆ°æ›´æ–°äº‹ä»¶ updateæ“ä½œï¼Œå¯¹åº”çš„binlogå¦‚ä¸‹ï¼š ![image](https://cloud.githubusercontent.com/assets/3926181/20453252/ab62af26-ae58-11e6-8c27-2c14ea9a441b.png) connector.getWithoutAck(batchSize)åªèƒ½è·å–åˆ°TRANSACTIONBEGINå’ŒTRANSACTIONENDï¼Œå¦‚å›¾ ![image](https://cloud.githubusercontent.com/assets/3926181/20453255/c911f216-ae58-11e6-90a4-e77bfee52348.png) dbçš„é…ç½®å¦‚ä¸‹ï¼š ``` [mysqld] pid-file	= /var/run/mysqld/mysqld.pid socket		= /var/run/mysqld/mysqld.sock datadir		= /data/mysql log-error	= /var/log/mysql/error.log # By default we only accept connections from localhost #bind-address	= 127.0.0.1 # Disabling symbolic-links is recommended to prevent assorted security risks symbolic-links=0 #è‡ªå®šä¹‰å‚æ•° explicit_defaults_for_timestamp lower_case_table_names=1 max_connections = 2000 # Recommended in standard MySQL setup sql_mode=NO_ENGINE_SUBSTITUTION STRICT_TRANS_TABLES innodb_open_files=65535 max_connect_errors=3500 max_connections=3100 max_user_connections=3000 open_files_limit=65535 #connect_timeout=30 #interactive_timeout=200 #wait_timeout=200 log-bin=mysql-bin #æ·»åŠ è¿™ä¸€è¡Œå°±ok binlog-format=ROW #é€‰æ‹©rowæ¨¡å¼ server_id=1 #é…ç½®mysql replactionéœ€è¦å®šä¹‰ï¼Œä¸èƒ½å’Œcanalçš„slaveIdé‡å¤ #skip-name-resolve innodb_log_file_size=1000M innodb_buffer_pool_size=2g innodb_log_buffer_size=10M innodb_sync_array_size=16 thread_cache_size=256 max_binlog_size=500M binlog_cache_size=1M key_buffer_size=8M #å¼€å¯æ…¢æŸ¥è¯¢ slow_query_logå€¼ä¸º1æˆ–onè¡¨ç¤ºå¼€å¯ï¼Œä¸º0æˆ–offä¸ºå…³é—­ slow_query_log=on #è®¾ç½®æ…¢æŸ¥è¯¢æ—¥å¿—æ”¾åœ¨å“ªé‡Œ slow_query_log_file=mysql-slow #è®¾ç½®sqlæ‰§è¡Œæ—¶é—´å¤šé•¿ä¸ºæ…¢æŸ¥è¯¢ long_query_time=2 #è¡¨ç¤ºæ²¡æœ‰ä½¿ç”¨ç´¢å¼•çš„sqlæŸ¥è¯¢ä¹Ÿä¼šè®°å½•ä¸‹æ¥ #log-queries-not-using-indexes #æ”¯æŒemoji character-set-server=utf8mb4 collation-server=utf8mb4_unicode_ci ``` ç»è¿‡éªŒè¯ï¼Œå½“canaléƒ¨ç½²åˆ°mysqlåŒä¸€å°æœºå™¨æ—¶å¯ä»¥è·å–åˆ° ROWDATAäº‹ä»¶ï¼ˆcanal.instance.master.address = ä½¿ç”¨ 127.0.0.1:3306æˆ–è€… æœºå™¨çœŸå®åœ°å€:3306éƒ½å¯ä»¥ï¼‰ å¦‚æœä½¿ç”¨é˜¿é‡Œäº‘rdsï¼Œè¿™è¯¥æ€ä¹ˆåŠ- - æ²¡è¿™å›äº‹ï¼Œä¸éœ€è¦éƒ¨ç½²åˆ°åŒä¸€å°mysqlä¸Š.  æ£€æŸ¥ä¸‹è¿‡æ»¤æ¡ä»¶ï¼Œä¼šä»¥clientæäº¤çš„ä¸ºå‡† æˆªå›¾çº¢è‰²æ¡†ä½çš„çŠ¶å†µå¾ˆå¥‡æ€ªï¼Œ æ£€æŸ¥è¿‡ä¸¤ä¸ªcanalçš„ç¯å¢ƒï¼Œé…ç½®æ˜¯ä¸€æ ·ã€‚ clientæ˜¯åŒä¸€ä¸ªï¼Œæµ‹è¯•çš„æ–¹å¼å°±æ˜¯é€šè¿‡åŒä¸€ä¸ªclientåˆ‡æ¢canalåœ°å€ debugçœ‹çœ‹serverç«¯çš„è¿‡æ»¤æ¡ä»¶ï¼Œå¯ä»¥è¯•è¯•ä½¿ç”¨RDSçš„æƒ…å†µ è¿‡æ»¤æ¡ä»¶ä¸¤ä¸ªç¯å¢ƒæ˜¯ä¸€æ ·çš„  ``` #canal.instance.filter.regex = test\\..*   //è¿™ä¸ªæ˜¯ä¹‹å‰çš„ canal.instance.filter.regex =     //æ¢æˆè¿™ä¸ªè¿œç¨‹canalå¯ä»¥å·¥ä½œï¼Œä½†æœ¬æœºéƒ¨ç½²çš„canalå¹¶ä¼šå—åˆ°å½±å“ # table black regex canal.instance.filter.black.regex = ``` è¿™æ ·çš„æ ¼å¼ã€‚ æŠŠè¿‡æ»¤æ¡ä»¶åˆ é™¤ï¼ˆç©ºç™½ï¼‰ï¼Œè¿œç¨‹éƒ¨ç½²çš„canalå°±å¯ä»¥è·å–åˆ°æ­£å¸¸çš„Eventäº†ã€‚ä½†å’ŒmysqlåŒæœºçš„canalï¼Œä¸å—è¿™ä¸ªå½±å“ è¿›ä¸€æ­¥å¯¹æ¯”æµ‹è¯•ï¼Œå‘ç°æ˜¯canal.instance.filter.regexçš„é—®é¢˜ï¼Œæ€»ç»“å¦‚ä¸‹ï¼š > 1ã€æ²¡æœ‰å‘½ä¸­canal.instance.filter.regexçš„SQLæ“ä½œï¼Œä¸ç®¡canaléƒ¨ç½²åœ¨å“ªï¼Œclientåªèƒ½è·å–åˆ°TRANSACTIONBEGINå’ŒTRANSACTIONEND (ä¸ºä»€ä¹ˆæ²¡æœ‰å‘½ä¸­ä¹Ÿä¼šè·å–åˆ°è¿™ä¸¤ä¸ªäº‹ä»¶ ä¹Ÿæ˜¯å¾ˆä¸è§£) > 2ã€éƒ¨ç½²åœ¨DBæœ¬æœºå’Œè¿œç¨‹çš„canalï¼Œå¯¹äºregexçš„è§£æä¸åŒ > > 2.1ã€å’ŒDBåŒæœºéƒ¨ç½²canalçš„regx=test\\\\..*å’Œ test.*éƒ½èƒ½è·å–åˆ°row event > >  2.2ã€å’ŒDBè¿œç¨‹éƒ¨ç½²çš„cancal  regx=test\\\\..*è¿™ç§æ–¹å¼è·å–ä¸åˆ°row event ä½†  regx=test.*å¯ä»¥æ­£å¸¸å·¥ä½œ ä»¥ä¸Šç°è±¡ï¼Œåœ¨rdså’Œmysqléƒ½ä¸€æ ·ã€‚ otteråœ¨é…ç½®canalæ—¶æœ‰ä¸ªã€è¿‡æ»¤è¡¨è¾¾å¼ã€‘ï¼Œä½†é‚£é‡Œæˆ‘å¡«çš„æ˜¯ test\\\\..* è¿™ç§æ ¼å¼ï¼Œ åŒæ­¥æ•°æ®å¥½åƒæ²¡é—®é¢˜ã€‚otter nodeèŠ‚ç‚¹å’ŒDBéƒ½ä¸æ˜¯åŒä¸€å°æœºå™¨ã€‚ è¿™ä¸ªè¡¨è¾¾å¼ï¼Œè¿˜è¦çœ‹ä¸€ä¸‹ä½ clientè°ƒç”¨subscribeé‡ŒæŒ‡å®šçš„å‚æ•°
223,canal.instance.masteré…ç½®æœªç”Ÿæ•ˆ æ‚¨å¥½ï¼Œè¯·é—®ä¸€ä¸‹ æˆ‘é…ç½®ä¸€ä¸‹å‚æ•°ï¼ˆ~/conf/example/instance.propertiesé‡Œï¼‰ canal.instance.master.journal.name canal.instance.master.position canal.instance.master.timestamp æ“ä½œ ./bin/stop.sh  ./bin/start.sh æ²¡æœ‰ç”Ÿæ•ˆå•Šã€‚ ä¾‹å¦‚ï¼Œæˆ‘é…ç½® timestamp=1479370130ï¼Œåœ¨è¿™ä¸ªæ—¶é—´æˆ³ä¹‹å‰çš„updateï¼Œä¹Ÿåœ¨è¿™ä¹‹åçš„updateéƒ½ä¼šå¾—åˆ°messageä¸çŸ¥é“ä»€ä¹ˆåŸå› å•Šï¼Ÿ æ—¶é—´æˆ³å®šä½é»˜è®¤ä¼šå›æº¯60ç§’ 
222,RDS mysql.mysql ha_health_checkè¡¨æ‰¾ä¸åˆ° - åœ¨canalå¯åŠ¨æ—¶æŠ¥mysql.mysql ha_health_checkè¡¨æ‰¾ä¸åˆ°è¿™ä¸ªé”™ - å»binlogæŸ¥çœ‹äº†eventsï¼Œç¡®å®æœ‰ha_health_checkè¿™å¼ è¡¨çš„è®°å½• - ç„¶è€Œï¼Œé€šè¿‡show tablesç­‰sqlè¯­å¥å´æŸ¥ä¸åˆ°è¿™å¼ è¡¨ ä¼°è®¡æ˜¯è¡¨æƒé™çš„é—®é¢˜ 2016-11-14 10:07 GMT+08:00 iadmirezhe notifications@github.com: >    - >  >    åœ¨canalå¯åŠ¨æ—¶æŠ¥mysql.mysql ha_health_checkè¡¨æ‰¾ä¸åˆ°è¿™ä¸ªé”™ >    - >  >    å»binlogæŸ¥çœ‹äº†eventsï¼Œç¡®å®æœ‰ha_health_checkè¿™å¼ è¡¨çš„è®°å½• >    - >  >    ç„¶è€Œï¼Œé€šè¿‡show tablesç­‰sqlè¯­å¥å´æŸ¥ä¸åˆ°è¿™å¼ è¡¨ >  > â€” > You are receiving this because you are subscribed to this thread. > Reply to this email directly  view it on GitHub > https://github.com/alibaba/canal/issues/222  or mute the thread > https://github.com/notifications/unsubscribe-auth/AAy8txbjG_zt6LSby8EsUa3SQeXKXCOmks5q98JugaJpZM4Kw46d > . https://github.com/alibaba/canal/commit/96dca0b9e6b6dcc12fc439d2f17d85a4656485df   ç‰¹åˆ«æ”¯æŒäº†ä¸‹é˜¿é‡Œäº‘çš„RDS è¿™ä¸ªä¸æ˜¯â•ä¸ªè¿‡æ»¤å°±å¯ä»¥äº†å— æ˜¯çš„ï¼Œç°åœ¨é»˜è®¤è¯†åˆ«ä¸ºRDSå¢åŠ äº†è¿‡æ»¤æœºåˆ¶ å—¯ï¼ŒåŠ äº†è¿‡æ»¤ï¼ŒæŠŠmysqlè¿‡æ»¤æ‰ 
221,canal clientè·å–å­—æ®µå€¼ä¸ºç©ºå­—ç¬¦ä¸²ï¼ˆæœ¬èº«åº”ä¸ºnullï¼‰ åœ¨ä½¿ç”¨canalçš„è¿‡ç¨‹ä¸­å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘åœ¨masteræœºå™¨ä¸Šæ’å…¥ä¸€æ¡æ•°æ® æ¯”å¦‚è¯´insert into test1 values(17 NULL);  åœ¨è·å–canalè§£æç»“æœ columnçš„å€¼ä¸º''ç©ºå­—ç¬¦ä¸²  é‡‡ç”¨çš„æ–¹æ³•æ˜¯ String columnValue=column.getValue();   è¿™ä¸ªæ˜¯canalæ¡†æ¶çš„é—®é¢˜ è¿˜æ˜¯æˆ‘æœ¬èº«è·å–å­—æ®µå€¼çš„æ–¹æ³•ä¸å¯¹ã€‚ column.getValue()ä¸­columnå¯¹è±¡æ˜¯import com.alibaba.otter.canal.protocol.CanalEntry.Columnå¯¹è±¡ column.isNull()ä½¿ç”¨è¿™ä¸ªè¿›è¡Œåˆ¤æ–­æ˜¯å¦null 
220,canal clientä¸­EntryæœªåŒ…æ‹¬æ“ä½œç”¨æˆ· ä¸€ä¸ªé—®é¢˜æƒ³è¯·æ•™ä¸€ä¸‹ã€‚ canal clientä¸­EntryæœªåŒ…æ‹¬æ“ä½œç”¨æˆ·ï¼Œè¿™ä¸ªåŸå› æ˜¯å› ä¸ºbinlogé‡Œé¢æœ¬èº«å°±æ²¡æœ‰operator userï¼Œè¿˜æ˜¯canalæ²¡qeå»å°è£…è§£æï¼Ÿmysql binlogåŒ…å«çš„å…·ä½“å†…å®¹ï¼Œæœ‰ç›¸å…³çš„èµ„æ–™å—ï¼Ÿåœ¨ç½‘ä¸Šéƒ½è¯´çš„ä¸å…¨ã€‚å¦‚æœæœ‰ï¼Œæˆ‘æƒ³å°è¯•ç€å¢åŠ ã€‚ ä¸ªäººè§‰å¾—ï¼Œè¿™éƒ¨åˆ†ä¿¡æ¯ä¸åº”è¯¥æ”¾åœ¨binlogé‡Œï¼Œå¯¹äºå¤‡ä»½å®Œå…¨å¤šä½™ï¼Œmysqlåº”è¯¥æœ‰æƒé™ç®¡ç†ç›¸å…³çš„å¤„ç†ï¼Œæ“ä½œæ—¥å¿—ç­‰ç­‰ã€‚ æ²¡æœ‰åœ¨binlogé‡Œ 
219,Canalå¦‚ä½•æ”¯æŒé˜¿é‡Œäº‘RDSçš„è®¢é˜…ï¼Ÿ ç›®å‰ä½¿ç”¨canalå»è®¢é˜…é˜¿é‡ŒRDSçš„å¢é‡å˜åŒ–æ•°æ®ï¼Œå‡ºç°å¦‚ä¸‹æŠ¥é”™ï¼š com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: com.google.common.collect.ComputationException: com.alibaba.otter.canal.parse.exception.CanalParseException: fetch failed by table meta:`mysql`.`ha_health_check` Caused by: com.google.common.collect.ComputationException: com.alibaba.otter.canal.parse.exception.CanalParseException: fetch failed by table meta:`mysql`.`ha_health_check` å·²ç»è§£å†³ï¼šé˜¿é‡Œäº‘RDSçš„è´¦å·ç¼ºå°‘è¯»å–mysql.ha_health_checkçš„æƒé™ è¿™åº”è¯¥æ˜¯ä¸€ä¸ªé˜¿é‡Œç”¨æ¥ç›‘æ§çš„å¿ƒè·³è¡¨ï¼Œå°†è´¦å·å‡çº§ä¸ºé«˜æƒé™è´¦å·ï¼Œå¹¶èµ‹äºˆcanalè´¦å·SELECT mysql.ha_health_checkæƒé™åï¼Œä¸å†æŠ¥é”™ï¼Œé—®é¢˜è§£å†³ã€‚ ç”±æ­¤è¡ç”Ÿçš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼šä¼¼ä¹å½“è§£æä¸€è¡Œå¤±è´¥å¹¶æŠ›å‡ºå¼‚å¸¸åï¼Œä¼šå½±å“åç»­çš„å…¶ä»–æ­£å¸¸è¡Œè§£æï¼Œå¯¼è‡´canalå®¢æˆ·ç«¯æ— æ³•æ¥æ”¶åˆ°æ•°æ®ã€‚è¿™ä¸€ç‚¹æ˜¯æˆ‘çš„çŒœæµ‹ï¼Œå¹¶æ²¡æœ‰å»ç»†è¯»æºç ï¼Œå¦‚æœä½œè€…çœ‹è§äº†è¿™æ¡issueå¯ä»¥é€‚å½“å…³æ³¨ä¸€ä¸‹ã€‚ ä½ çš„çŒœæµ‹æ˜¯å¯¹çš„ï¼Œä¸è¿‡ä¸ç”¨è·å–é‚£ä¹ˆå¤šæƒé™ï¼Œä½ æŠŠé‚£ä¸ªè¡¨è¿‡æ»¤æ‰å°±å¯ä»¥äº† æ˜¯çš„ï¼Œä½ å¯ä»¥è®¾ç½®ç™½åå•è¡¨ï¼Œé’ˆå¯¹é»‘åå•è¡¨binlogåè®®åªçœ‹ä¸€ä¸ªheaderå¤´ï¼Œåˆ¤æ–­ä¸å‘½ä¸­ç›´æ¥ä¸¢å¼ƒ https://github.com/alibaba/canal/commit/96dca0b9e6b6dcc12fc439d2f17d85a4656485df  ç‰¹åˆ«æ”¯æŒäº†ä¸‹é˜¿é‡Œäº‘çš„RDS 
218,ä¸€æ¬¡æ›´æ–°ï¼Œä¸¤æ¬¡æ¶ˆè´¹ï¼Ÿ ä½ å¥½ï¼Œé—®é¢˜å¦‚ä¸‹ï¼š å¤ç°æ­¥éª¤ï¼š  + ç°æœ‰ä¸¤ä¸ªåº“USERS_01ï¼ŒUSERS_02ï¼Œéœ€è¦è®¢é˜…è¿™ä¸¤ä¸ªåº“ä¸­çš„è¡¨usersçš„DMLï¼›  + canal.propertiesé…ç½®æ–‡ä»¶ï¼š              canal.id= 1         canal.ip=127.0.0.1         canal.port= 11111         canal.zkServers=localhost:2181         canal.destinations= users_building         canal.instance.global.spring.xml = classpath:spring/group-instance.xml         # å…¶ä»–é…ç½®é»˜è®¤...  + group-instance.xmlï¼š                  <!-- å…¶ä»–é…ç½®ä¿æŒä¸å˜ -->         <bean id="eventParser1" class="com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser">             <property name="eventFilter"> 			<bean class="com.alibaba.otter.canal.filter.aviater.AviaterRegexFilter" > 				<constructor-arg index="0" value="${canal.instance.master1.filter.regex:.*\..*}" /> 			</bean> 		</property>         <!-- å…¶ä»–é…ç½®ä¿æŒä¸å˜ -->         </bean>         <bean id="eventParser2" class="com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser">             <property name="eventFilter"> 			<bean class="com.alibaba.otter.canal.filter.aviater.AviaterRegexFilter" > 				<constructor-arg index="0" value="${canal.instance.master2.filter.regex:.*\..*}" /> 			</bean> 		</property>         <!-- å…¶ä»–é…ç½®ä¿æŒä¸å˜ -->         </bean> + users_building/instance.propertiesé…ç½®ï¼š         canal.instance.mysql.slaveId = 1000         canal.instance.master1.address = 127.0.0.1:3306         canal.instance.master1.journal.name =          canal.instance.master1.position =          canal.instance.master1.timestamp =          canal.instance.master2.address = 127.0.0.1:3306         canal.instance.master2.journal.name =          canal.instance.master2.position =          canal.instance.master2.timestamp =          canal.instance.master1.filter.regex = USERS_01.users  # å¯¹åº”äºgroup-instance.xmlçš„eventParser1çš„canal.instance.master1.filter.regex         canal.instance.master2.filter.regex = USERS_02.users # å¯¹åº”äºgroup-instance.xmlçš„eventParser2çš„canal.instance.master2.filter.regex         # å…¶ä»–é…ç½®é»˜è®¤... + æµ‹è¯•ä»£ç ï¼š         connector = CanalConnectors.newClusterConnector("127.0.0.1:2181"  "users_building"  ""  "");         // å…¶ä»–ä»£ç ä¸ºClusterCanalClientTest + å½“åœ¨mysql terminalé‡Œæ‰§è¡Œä¸€æ¬¡æ›´æ–°æ“ä½œ`update users set sex = 1 where id = 1;`ï¼Œconsoleé‡Œä¼šæœ‰ä¸¤æ¬¡è¿ç»­ä¸€æ ·çš„è®¢é˜…æ¶ˆæ¯å¦‚ï¼š          ![users_update](https://cloud.githubusercontent.com/assets/8662695/19843667/b9e8fc24-9f5f-11e6-910f-c2755de0461d.png) è¯·é—®ï¼Œè¿™æ˜¯æœ‰ä»€ä¹ˆé…ç½®é—®é¢˜å—ï¼Ÿè¿˜æ˜¯å…¶ä»–é—®é¢˜ï¼Ÿè°¢è°¢ã€‚          æµ‹è¯•å‘ç°åªæœ‰å®¢æˆ·ç«¯è®¾ç½®filterè¡¨è¾¾å¼æ‰èƒ½è¿‡æ»¤ï¼Œdeployerè®¾ç½®ä¸èƒ½ç”Ÿæ•ˆï¼Ÿï¼Ÿ æ˜ç™½äº† ï¼Œdemoé‡Œclient.subcribeæ—¶è®¾ç½®äº†filter 
217,canal å®¢æˆ·ç«¯æ¥æ”¶blobå­—æ®µè§£ææˆ Google Protocol Bufferåè®®å¤±è´¥ æ•°æ®åº“çš„è¡¨ä¸­å­˜çš„æ˜¯Google Protocol Bufferåè®®ï¼Œç„¶è€Œåœ¨canalæ¥æ”¶åï¼Œè§£ææŠ¥é”™ã€‚ æƒ³é—®ä¸€ä¸‹ï¼Œcanalæ”¯ä¸æ”¯æŒéåŸºæœ¬ç±»å‹è§£æ blobç±»å‹ä¸ºnew String("ISO-8859-1")å¤„ç†åçš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥é€šè¿‡string.getBytes("ISO-8859-1")è¿˜åŸå‡ºæ¥ è°¢è°¢ï¼Œå·²ç»è§£å†³ 
216,canalå¦‚ä½•æ”¯æŒsql server ç›®å‰ï¼Œæˆ‘ä»¬æœ‰ä¸ªé¡¹ç›®ï¼Œé€šè¿‡ç›‘å¬binlogå˜åŒ–æ¥æ›´æ–°ç´¢å¼•ï¼Œä¸Šçº¿å‰å‘ç°æœ‰çš„å®¢æˆ·çš„æ•°æ®åº“ç”¨çš„æ˜¯sql serverçš„ï¼Œcanalç›®å‰ä¸æ”¯æŒsql serverï¼Œä¸çŸ¥é“ä½œè€…æœ‰æ²¡æœ‰æ€è·¯æ¥æ”¯æŒsql serverï¼Ÿ ç½‘ä¸Šæ‰¾äº†ä¸‹ï¼Œsql serveræœ‰ä¸ªcdcæ¨¡å¼ï¼ˆhttps://msdn.microsoft.com/en-us/library/cc645937.aspxï¼‰ï¼Œå¼€å¯è¿™ä¸ªæ¨¡å¼å°±èƒ½trackå˜æ›´è®°å½• å¯¹äºsql serveræ²¡å•¥ç ”ç©¶ï¼ŒæŠ±æ­‰ 
215,canal-server1.0.22åŸºäºmariadb10.1.14æµ‹è¯•HAåŠŸèƒ½çš„BUG æµ‹è¯•æè¿°ï¼šcanalserver1.0.22åŸºäºmariadb10.1.14çš„HAåŠŸèƒ½ä¸å¥½ç”¨ï¼Œéƒ¨ç½²ä¸¤å°canaserverå½“å…¶ä¸­ä¸€å°serveræŒ‚æ‰åï¼Œzookeeperå·²ç»åˆ‡æ¢åˆ°æ–°çš„canalserverï¼Œä½†æ–°çš„canalserverè·å–çš„binlognameä¸æ­£ç¡®å¯¼è‡´è¯»å–mariadbçš„binlogé”™è¯¯ã€‚ mariadbä¸­binlogåå­—ï¼š (canal@127.0.0.1) [canal_test]> show binary logs; +------------------+-----------+ | Log_name         | File_size | +------------------+-----------+ | mysql-bin.000001 |     25487 | | mysql-bin.000002 |       358 | | mysql-bin.000003 |      1518 | | mysql-bin.000004 |  29137967 | +------------------+-----------+ canalserverè·å–çš„binlogname:ã€binlog[mysql-bin.000004$^Nk<U+0081>:29138083]ã€‘ä¸­ååŠæ®µæœ‰ä¹±ç  è§£å†³æ–¹æ³•ï¼š ä¿®æ”¹canalserver1.0.22æºç com.alibaba.otter.canal.protocol.CanalEntryä¸­å¯¹è·å–åˆ°çš„binlognameè¿›è¡Œè¿‡æ»¤ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š ã€public String filterLogFileName(String logfileName) {       System.out.println("å¼€å§‹è¿‡æ»¤logfileName:"+logfileName);       Pattern p = Pattern.compile("(mysql-bin\.[0-9]_)._");       Matcher m = p.matcher(logfileName);       while(m.find()){         if(m.groupCount() >= 1) {           System.out.println("è¿‡æ»¤logfileNameä¸º:"+m.group(1));           return m.group(1);         }       }       return logfileName;     } ã€‘ ä¿®æ”¹ä»£ç ï¼š ã€public String getLogfileName() {       java.lang.Object ref = logfileName_;       if (ref instanceof String) {         return filterLogFileName((String) ref);       } else {         com.google.protobuf.ByteString bs =              (com.google.protobuf.ByteString) ref;         String s = bs.toStringUtf8();         if (com.google.protobuf.Internal.isValidUtf8(bs)) {           logfileName_ = s;         }         return filterLogFileName(s);       }     } ã€‘ é‡æ–°æ‰“åŒ…æµ‹è¯•éªŒè¯HAåŠŸèƒ½å¯ä»¥è‡ªåŠ¨åˆ‡æ¢ï¼Œä½†æ˜¯å­˜åœ¨canalserveråˆ‡æ¢æ—¶clientæ¶ˆè´¹ç«¯é‡å¤æ¶ˆè´¹çš„é—®é¢˜ã€‚ ä½†æ˜¯åœ¨mysql5.6ä¸­æµ‹è¯•æœªå‡ºç°æ­¤é—®é¢˜ ç°åœ¨æœ‰æµ‹è¯•mariadb10.1.14çš„éªŒè¯ç‰ˆæœ¬å—ï¼Œçœ‹æºç å¥½åƒæ˜¯ä»protocolbufferè¯»å–çš„æ—¶å€™binglognameå°±å­˜åœ¨é—®é¢˜äº†ï¼Œå¯¹binlogåè®®æ ¼å¼ä¸æ˜¯å¾ˆäº†è§£ï¼Œè¿™ä¸ªæ˜¯protocolbufferå®šä¹‰çš„åè®®æ ¼å¼é—®é¢˜å— å®é™…ä»£ç åˆ†æï¼šå‡ºç°åœ¨ã€com.alibaba.otter.canal.parse.inbound.mysql.dbsyncã€‘ä¸­ï¼Œint netlen = getUint24(PACKET_LEN_OFFSET);ä»£ç è·å–çš„åŒ…é•¿åº¦ä¸ä¸€è‡´é€ æˆçš„ï¼Œmaraidbå’Œmysqlè·å–çš„é•¿åº¦ä¸ºï¼š47å’Œ43ï¼Œmariadbå¤šè·å–4å­—èŠ‚å¯¼è‡´åç»­å¤„ç†logfilenameè¯»å–å¤š4ä¸ªå­—èŠ‚ï¼›æ‚¨å¥½é—®ä¸‹ä½œè€…ä»€ä¹ˆæƒ…å†µå¯¼è‡´netlenè·å–çš„ä¸ä¸€è‡´? æœ€å4ä½å¯èƒ½æ˜¯checksumï¼Œä½ è¯•ç€æ‰¾ä¸€ä¸‹mariadbå…³é—­ä¸€ä¸‹mariadbçš„binlog checksumæœºåˆ¶çœ‹çœ‹.   ps. ä¹‹å‰æœ‰æ”¯æŒè¿‡mysql5.6çš„checksumï¼Œå¯èƒ½mariadbåè®®ä¸Šæœ‰ç‚¹ä¸ä¸€æ ·ï¼Œæ²¡å®Œå…¨å…¼å®¹ï¼Œå…ˆå¸®å¿™éªŒè¯ä¸€ä¸‹æ˜¯å¦ä¸ºchecksumé—®é¢˜ if (FormatDescriptionLogEvent.versionProduct(versionSplit) >= FormatDescriptionLogEvent.checksumVersionProduct) { ä¹‹å‰canalä»£ç æ˜¯é™åˆ¶äº†>=5.6.1ç‰ˆæœ¬å·æ‰ä¼šå¼€å¯checksumæ£€æŸ¥ï¼Œè¿™æ˜¯ä»¥å‰mysql5.6çš„æœºåˆ¶ï¼Œmariadbä¼°è®¡æœ‰ä¸ä¸€æ ·çš„è¡Œä¸º å·²ç»ç¡®å®šæ˜¯checksumçš„é—®é¢˜ï¼Œä½†æ˜¯æµ‹è¯•çš„1.0.22ç¨³å®šç‰ˆï¼Œå»æŸ¥æºç ä¹Ÿæ˜¯çœ‹çš„1.0.22çš„ç¨³å®šç‰ˆä»£ç ï¼Œåæ¥çœ‹åˆ°canal1.0.23å¿«ç…§ç‰ˆä»£ç å·²ç»ä¿®å¤è¿™ä¸ªé—®é¢˜äº†ï¼Œåœ¨mariadb10.1.14éªŒè¯é€šè¿‡ï¼Œå¤šè°¢æŒ‡æ•™ã€‚ ps: xiaolinziemail@163.com å‘ä»¶äººï¼š agapple å‘é€æ—¶é—´ï¼š 2016-11-03 13:49 æ”¶ä»¶äººï¼š alibaba/canal æŠ„é€ï¼š linwenxue; Author ä¸»é¢˜ï¼š Re: [alibaba/canal] canal-server1.0.22åŸºäºmariadb10.1.14æµ‹è¯•HAåŠŸèƒ½çš„BUG (#215) æœ€å4ä½å¯èƒ½æ˜¯checksumï¼Œä½ è¯•ç€æ‰¾ä¸€ä¸‹mariadbå…³é—­ä¸€ä¸‹mariadbçš„binlog checksumæœºåˆ¶çœ‹çœ‹. ps. ä¹‹å‰æœ‰æ”¯æŒè¿‡mysql5.6çš„checksumï¼Œå¯èƒ½mariadbåè®®ä¸Šæœ‰ç‚¹ä¸ä¸€æ ·ï¼Œæ²¡å®Œå…¨å…¼å®¹ï¼Œå…ˆå¸®å¿™éªŒè¯ä¸€ä¸‹æ˜¯å¦ä¸ºchecksumé—®é¢˜ â€” You are receiving this because you authored the thread. Reply to this email directly  view it on GitHub  or mute the thread. 
214,canal ä¸€ä¸ªserveræ€ä¹ˆèƒ½ç›‘å¬ä¸€ä¸ªæ•°æ®åº“çš„ä¸åŒè¡¨ï¼Ÿ canal ä¸€ä¸ªserveræ€ä¹ˆèƒ½ç›‘å¬ä¸€ä¸ªæ•°æ®åº“çš„ä¸åŒè¡¨ï¼Ÿå¤åˆ¶å¤šä»½exampleæ–‡ä»¶å¤¹ï¼Œç„¶åé…ç½®æ–‡ä»¶é‡Œé¢åˆ†åˆ«é…ç½®ä¸åŒçš„è¿æ¥è¡¨ä¿¡æ¯ï¼Ÿéº»çƒ¦ä½œè€…çœ‹çœ‹æœ‰æ²¡æœ‰å¥½çš„è§£å†³æ–¹æ¡ˆï¼Ÿ ä¸€ä¸ªé…ç½®é‡Œå†™å¤šå¼ è¡¨çš„åŒ¹é…æ­£åˆ™ 
213,ä¿®å¤issue #212 1ã€BinLogFileQueueçš„listBinlogFilesæ–¹æ³•ä¸­å¯¹binlogæ–‡ä»¶åè¿›è¡Œæ›´ä¸¥æ ¼çš„éªŒè¯ï¼Œå¿…é¡»ä»¥æ•°å­—ç»“å°¾ 2ã€LocalBinLogConnectionç±»ä¸­è§£å†³å¦‚ä¸‹bug     2.1ç¬¬äºŒä¸ªdumpæ–¹æ³•ä¸­å¢åŠ ä»£ç "decoder.handle(LogEvent.FORMAT_DESCRIPTION_EVENT);" è§£å†³"((QueryLogEvent)event).getQuery()"è¯­å¥å‡ºç°ä¹±ç çš„é—®é¢˜(BEGINåé¢å¤šäº†4ä¸ªå­—èŠ‚) å‡ºç°ä¹±ç ä¸ä¼šè¿›å…¥ifè¯­å¥ï¼Œå¯¼è‡´æ‰¾åˆ°çš„binlogä½ç‚¹ä¸å‡†ç¡®     2.2ç¬¬ä¸€ä¸ªdumpæ–¹æ³•ä¸­ï¼Œè¢«æ³¨é‡Šçš„decodeä»£ç æ‰æ˜¯æ­£ç¡®çš„ï¼Œå’ŒDirectLogFetcherä¸åŒï¼Œæ­¤å¤„éœ€è¦æ„é€ å­å¾ªç¯è¿›è¡Œéå†     2.3ç¬¬ä¸€ä¸ªdumpæ–¹æ³•ä¸­ï¼Œå°†æ¯ä¸ªbinlog-fileçš„é¦–ä¸ªeventè®¾ç½®ä¸ºRotateLogEventï¼Œå¦åˆ™ä¼šå¯¼è‡´æ‰€æœ‰eventçš„binlogFileNameéƒ½æ˜¯é»˜è®¤çš„mysql-bin.000001ã€‚è¿™ä¹ˆæ”¹å®Œä¹‹åï¼Œå’ŒDirectLogFetcherçš„è¡Œä¸ºç›¸å¥‘åˆï¼Œåè€…åœ¨æ¯ä¸ªbinlogfileçš„é¦–ä¸ªeventå°±æ˜¯RotateLogEvent 3ã€LocalBinlogEventParserä¸­å¢åŠ å…ƒæ•°æ®å¤„ç†çš„ç›¸å…³ä»£ç ï¼Œä¸åŠ çš„è¯ï¼Œæ‰€æœ‰çš„eventéƒ½ä¸å¸¦åˆ—åï¼ŒåŸºæœ¬ä¸Šæ²¡æ³•å„¿ä½¿ç”¨ [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=213) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=213) before we can accept your contribution.<br/><hr/>**lubiao** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user). è¡¥å……ï¼šä¿®å¤#206 å¯¹åº”ç±»æ–‡ä»¶ï¼šSessionHandlerã€CanalServerWithEmbeddedã€MysqlEventParser å…³äº206ï¼Œåæ¥æ²¡æœ‰è§åˆ°ä½ çš„å›å¤ï¼Œä½†è‚¯å®šæ˜¯æœ‰é—®é¢˜çš„ï¼Œæˆ‘ä»¬åœ¨çº¿ä¸Šå·²ç»å¤ç°æœ‰ä¸¤ä¸‰æ¬¡äº†ã€‚ å¯¼è‡´è¯¥é—®é¢˜çš„æœ€ä¸»è¦åŸå› åœ¨äºï¼šåœ¨æŸä¸ªæ—¶é—´ç‚¹æ²¡æœ‰runningèŠ‚ç‚¹çš„æ—¶å€™ï¼Œå®¢æˆ·ç«¯é€šè¿‡ClusterNodeAccessStrategyçš„nextNodeæ–¹æ³•æ‹¿åˆ°çš„å¯èƒ½æ˜¯æœªæ¥standbyçš„ipï¼Œå¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œå¯èƒ½ä¼šå‡ºç°åœ¨å¤‡æœºä¸ŠsubscribeæˆåŠŸè€ŒgetWithoutAckå¤±è´¥çš„åœºæ™¯ï¼Œç„¶åå®¢æˆ·ç«¯æœ€ç»ˆåˆ‡æ¢åˆ°äº†ä¸»æœºã€‚ä½†æ˜¯å¦‚æœæŸä¸ªæ—¶åˆ»ï¼Œinstanceåˆ‡æ¢åˆ°å¤‡æœºäº†ï¼Œé‚£å°±æœ‰é—®é¢˜äº†ï¼Œå› ä¸ºå¤‡æœºçš„metaMangerå·²ç»åˆå§‹åŒ–è¿‡äº†ï¼Œå¹¶ä¸”ç¼“å­˜äº†ä»¥å‰çš„positionã€‚ #205æ²¡æœ‰ä¿®å¤ï¼Œæˆ‘ä»¬å†…éƒ¨ç›´æ¥æŠŠlazyçš„åŠŸèƒ½å…¨éƒ¨ç¦ç”¨äº†ï¼Œæ‰€ä»¥ä»£ç æ²¡æœ‰æäº¤ tks 
212,å…³äºbinlogç¦»çº¿æ¶ˆè´¹çš„bug è®¾è®¡binlogç¦»çº¿æ¶ˆè´¹(LocalBinlogEventParser)çš„åˆè¡·æ˜¯ä»€ä¹ˆï¼Ÿåœ¨é˜¿é‡Œå†…éƒ¨æœ‰æ²¡æœ‰å¤§æ‰¹é‡ä½¿ç”¨è¿‡è¿™ä¸ªåŠŸèƒ½ï¼Ÿ æˆ‘ä»¬åœ¨å°è¯•ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°æœ‰å¾ˆå¤šé—®é¢˜ï¼Œå¦‚ï¼š 1ã€ç¦»çº¿æ¶ˆè´¹æ—¶tableMetaCacheä¸ºnullï¼Œæ„é€ å‡ºæ¥çš„eventä¸å¸¦å…ƒæ•°æ®ï¼Œè¿™æ ·çš„eventåº”è¯¥æ˜¯æ²¡æ³•å„¿ç”¨ 2ã€äº‹ä»¶è§£æä¹Ÿå­˜åœ¨bug       \* æ¯”å¦‚LocalBinLogConnectionä¸­çš„dumpæ–¹æ³•ï¼Œè¢«æ³¨é‡Šçš„ä»£ç æ‰æ˜¯æ­£ç¡®çš„ä»£ç        \* LocalBinLogConnectionä¸­ç¬¬äºŒä¸ªdumpæ–¹æ³•ï¼Œåº”è¯¥å¢åŠ decoder.handle(LogEvent.FORMAT_DESCRIPTION_EVENT);è¯­å¥ï¼Œå¦åˆ™((QueryLogEvent) event).getQuery()è¿”å›çš„å­—ç¬¦ä¸²å¸¦ä¹±ç        \* localæ¨¡å¼ä¸‹è·å–ä¸åˆ°ROTATE_EVENTç±»å‹çš„äº‹ä»¶ï¼Œå¯¼è‡´æ„é€ çš„eventçš„binlogFileNameå§‹ç»ˆéƒ½æ˜¯mysql-bin.000001 LocalBinlogEventParserä¸»è¦ç”¨æ¥åšæ—¥å¿—é‡å‘è§£æç”¨çš„ï¼Œå†…éƒ¨ç”¨çš„å°‘.  å·²æœ‰äººæäº¤PRè§£å†³ 
211,canalå®¢æˆ·ç«¯è®¤ä¸ºinsert\update\deleteæ˜¯DDLè¯­å¥äº† å¦‚é¢˜ï¼Œä»Šå¤©åšäº†ä¸ªæµ‹è¯•ï¼Œè¿æ¥æœ¬æœºmysqlï¼Œæµ‹è¯•insertç­‰è¯­å¥ï¼Œå®¢æˆ·ç«¯exampleæ‰§è¡Œåï¼Œå°†insertã€updateã€deleteç­‰è¯­å¥çœ‹æˆäº†DDLè¯­å¥ï¼Œä½†æ˜¯ï¼Œè¿æ¥å¼€å‘æœåŠ¡å™¨ä¸Šçš„mysqlå°±æ­£å¸¸ï¼Œè¯·é—®è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ ä¼°è®¡æ˜¯mysql5.6çš„rows query logï¼Œcanalä¸ä¼šè½¬æ¢ä¸ºsql æœ‰å…·ä½“ä¿¡æ¯å†reopen 
210,ä¸å¥½çš„è®¾è®¡ MysqlEventParser æ˜¯ AbstractEventParser æŠ½è±¡ç±»çš„å®ç°ï¼Œæ€ä¹ˆå¯ä»¥åœ¨çˆ¶ç±»ä¸­æ˜¾ç¤ºçš„ä¾èµ–è‡ªç±»å‘¢ï¼Ÿå¯ä»¥ä½¿ç”¨Object é”  å¦å¤–ï¼Œä¸å¤ªæ¸…æ¥šæŠ½è±¡ç±»çš„ç±»é”æ˜¯å¦å¯ä»¥ï¼Ÿ [![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/alibaba/canal?pullRequest=210) <br/>All committers have signed the CLA. tks 
209,Fix a minor fault: Canal instance reload again after startup. è¯´ä¸€ä¸‹å¤§è‡´çš„åœºæ™¯ï¼š ç”¨æˆ·åœ¨ä½¿ç”¨å¢é‡åŒæ­¥ä¹‹å‰ä¼šå…ˆè¿›è¡Œå…¨é‡åˆå§‹åŒ–ã€‚åœ¨åˆå§‹åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥éšæ—¶ä¸­æ–­å¹¶é‡æ–°åˆå§‹åŒ–ã€‚æˆ‘ä»¬ä¼šå°†åŸæ¥instanceçš„configæ–‡ä»¶å¤¹åˆ é™¤é‡æ–°ç”Ÿæˆinstanceæ–‡ä»¶å¤¹å’Œé…ç½®æ–‡ä»¶ï¼ˆå†…å®¹ä¸€è‡´ï¼‰ã€‚è¿™æ—¶å€™ï¼Œå¯åŠ¨æˆåŠŸåçš„ä¸‹ä¸€æ¬¡æ‰«æé—´éš”ï¼ˆ5sï¼‰ä¼šåˆreloadä¸€æ¬¡ï¼Œå› ä¸ºåˆå§‹åŒ–transactionæ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥ä¼šåŒæ­¥ç»™clientä¸€äº›duplicateçš„binlogã€‚æ—¥å¿—å¦‚ä¸‹ï¼š 2016-10-02 13:28:35.103 [canal-instance-scan-0] INFO  c.a.o.canal.deployer.monitor.SpringInstanceConfigMonitor - auto notify start example successful. 2016-10-02 13:28:40.138 [canal-instance-scan-0] INFO  c.a.o.canal.deployer.monitor.SpringInstanceConfigMonitor - auto notify reload example successful. æ‰€ä»¥ï¼ŒstopæˆåŠŸä»¥åæ˜¯ä¸æ˜¯åº”è¯¥æŠŠlastFilesé‡Œçš„removeæ‰ï¼Ÿ è‹¥æœ‰ä¸å¯¹çš„åœ°æ–¹è¯·æŒ‡æ•™ï¼Œè°¢è°¢ï¼ ä½ ä»¬é‡å¤åˆ é™¤å’Œå¢åŠ æ–‡ä»¶çš„ç¡®æ˜¯ä¼šæœ‰é—®é¢˜ï¼Œtks 
208,mysql5.6.29'@@global.binlog_checksum'å¸¦å•å¼•å·å¯¼è‡´masteré€€å‡º ä¼˜åŒ–binlogFormatåˆ¤æ–­ mysql5.6.29'@@global.binlog_checksum'å¸¦å•å¼•å·å¯¼è‡´masteré€€å‡º ä¼˜åŒ–binlogFormatåˆ¤æ–­ Assertion failed: (ret <= BINLOG_CHECKSUM_ALG_CRC32)  function get_binlog_checksum_value_at_connect [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=208) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=208) before we can accept your contribution.<br/> tks 
207,ä¸€ä¸ªæ—¥å¿—ç–‘é—® é¦–å…ˆçœ‹æ—¥å¿—ï¼š `2016-09-27 11:01:06:com.alibaba.otter.canal.client.impl.ClusterCanalConnector.subscribe(ClusterCanalConnector.java:110) - something goes wrong when subscribing from server:null com.alibaba.otter.canal.protocol.exception.CanalClientException: failed to subscribe with reason: something goes wrong with channel:[id: 0x111fe04e  /10.204.12.79:47450 => /10.204.246.102:11111]  exceptio n=com.alibaba.otter.canal.server.exception.CanalServerException: destination:ucarobd should start first ```     at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.subscribe(SimpleCanalConnector.java:203)     at com.alibaba.otter.canal.client.impl.ClusterCanalConnector.subscribe(ClusterCanalConnector.java:106)     at com.alibaba.otter.canal.client.impl.ClusterCanalConnector.subscribe(ClusterCanalConnector.java:99)     at com.ucar.dep.exchange.binlog.AbstractCanalClient$ProcessThread.process(AbstractCanalClient.java:142)     at com.ucar.dep.exchange.binlog.AbstractCanalClient$ProcessThread.run(AbstractCanalClient.java:134)` ``` é€šè¿‡åˆ†æä»£ç ï¼Œâ€œshould start firstâ€è¿™æ ·çš„å¼‚å¸¸ä¿¡æ¯åœ¨subscribingçš„æ—¶å€™æ˜¯ä¸ä¼šè§¦å‘çš„ï¼Œå¯æ˜¯æˆ‘çš„æ—¥å¿—æ–‡ä»¶é‡Œå‡ºç°äº†è¿™æ ·çš„æ—¥å¿—ï¼Œåˆ†æäº†ä¸€å¤©ä»£ç äº†ï¼Œè®©æˆ‘ç™¾æ€ä¸å¾—å…¶è§£ï¼Œè¯·é—®ä½œè€…èƒ½æä¾›ç‚¹å„¿ä»€ä¹ˆæ€è·¯å—ï¼Ÿ è¿™å¼‚å¸¸ä¸€èˆ¬æ˜¯serverç«¯å‡ºç°äº†é‡å¯å¯¼è‡´ï¼Œæ¯”å¦‚å¼€å¯äº†scan=trueï¼Œæ‰«æåˆ°äº†æ–‡ä»¶å˜åŒ–ï¼Œè‡ªåŠ¨é‡è½½ï¼Œå®¢æˆ·ç«¯å¢åŠ é‡è¯•æœºåˆ¶å°±å¥½äº† è¿™ä¸ªå¼‚å¸¸äº§ç”Ÿçš„åŸå› æˆ‘æ¸…æ¥š æˆ‘æ„Ÿåˆ°å¥‡æ€ªçš„æ˜¯ï¼šé€šè¿‡æŸ¥çœ‹å †æ ˆä¿¡æ¯ï¼Œæ˜¯åœ¨subscribeæ–¹æ³•ä¸­è§¦å‘çš„è¿™ä¸ªå¼‚å¸¸ï¼Œæˆ‘æŸ¥çœ‹äº†å®¢æˆ·ç«¯å’Œserverç«¯çš„ä»£ç ï¼Œåœ¨subscribeçš„æ—¶å€™æ²¡æœ‰checkStartçš„åˆ¤æ–­ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªâ€œshould start firstâ€å¼‚å¸¸ä¸åº”è¯¥åœ¨æ­¤å‡ºç° å®¢æˆ·ç«¯çš„ç¬¬ä¸€æ¬¡subscribeä¼šè§¦å‘æœåŠ¡ç«¯è¿›è¡Œstartæ“ä½œ 
206,SUBSCRIPTIONå­˜åœ¨bug ç›´æ¥ä¸ŠSessionHandlerçš„ä»£ç æ®µ `case SUBSCRIPTION:                     Sub sub = Sub.parseFrom(packet.getBody());                     if (StringUtils.isNotEmpty(sub.getDestination()) && StringUtils.isNotEmpty(sub.getClientId())) {                         clientIdentity = new ClientIdentity(sub.getDestination()                             Short.valueOf(sub.getClientId())                             sub.getFilter());                         MDC.put("destination"  clientIdentity.getDestination());                         embeddedServer.subscribe(clientIdentity); ```                     // å°è¯•å¯åŠ¨ï¼Œå¦‚æœå·²ç»å¯åŠ¨ï¼Œå¿½ç•¥                     if (!embeddedServer.isStart(clientIdentity.getDestination())) {                         ServerRunningMonitor runningMonitor = ServerRunningMonitors.getRunningMonitor(clientIdentity.getDestination());                         if (!runningMonitor.isStart()) {                             runningMonitor.start();                         }                     }                     ctx.setAttachment(clientIdentity);// è®¾ç½®çŠ¶æ€æ•°æ®                     NettyUtils.ack(ctx.getChannel()  null);                 } else {                     NettyUtils.error(401                         MessageFormatter.format("destination or clientId is null"  sub.toString()).getMessage()                         ctx.getChannel()                         null);                 }                 break; ``` ` é—®é¢˜ä»£ç ä¸ºï¼šembeddedServer.subscribe(clientIdentity); instanceè¿˜æ²¡æœ‰å¯åŠ¨å°±å¯ä»¥æ‰§è¡Œsubscribeï¼Ÿï¼Ÿï¼Ÿ ä¸ªäººè®¤ä¸ºæ­£ç¡®çš„é€»è¾‘åº”è¯¥æ˜¯ï¼šå…ˆå¯åŠ¨runningMonitorï¼Œå†åˆ¤æ–­instanceæ˜¯å¦å¯åŠ¨ï¼Œæœ€åå†æ‰§è¡Œsubscribeã€‚ æŒ‰ç›®å‰çš„ä»£ç é€»è¾‘ï¼Œä¼šäº§ç”Ÿå¦‚ä¸‹çš„é—®é¢˜ï¼š 1.ä¸¤å°canalserverå’Œä¸¤å°canalclientæ­£åœ¨è¿è¡Œï¼Œå…¶ä¸­æœ‰ä¸ªinstanceåç§°ä¸ºxxx 2.å°†xxxçš„Activeç½®ä¸ºfalseï¼Œxxxä¼šè¢«releaseæ‰ï¼Œç„¶åè§¦å‘é‡æ–°æŠ¢å  3.åœ¨æŠ¢å çš„è¿‡ç¨‹ä¸­ï¼Œzkä¸Šxxx/clusterèŠ‚ç‚¹å’Œxxx/runningèŠ‚ç‚¹çš„æ³¨å†Œæ˜¯æœ‰æ—¶é—´é—´éš”çš„ 4.å› ä¸ºæœ‰æ—¶é—´é—´éš”ï¼Œæ‰€ä»¥ï¼ŒæŒ‰ç…§ClusterNodeAccessStrategyçš„é€»è¾‘ï¼Œcanalclientåœ¨è¿›è¡Œconnectæ—¶æ‹¿åˆ°çš„ipä¸ä¸€å®šæ˜¯ä»¥åæŠ¢å åˆ°runningèŠ‚ç‚¹çš„é‚£ä¸ªcanalserverçš„ip 5.å³ä½¿ipæœ‰é—®é¢˜ï¼Œä»ç„¶å¯ä»¥è¿›è¡Œconnectå’Œsubscribeæ“ä½œï¼Œä½†åœ¨getçš„æ—¶å€™ä¼šæŠ¥é”™ï¼Œç„¶åé‡è¿ 6.è™½ç„¶é‡è¿äº†ï¼Œä½†æ˜¯subscribeæ—¶äº§ç”Ÿäº†è„æ•°æ®ï¼Œpositionä¿¡æ¯è¢«ç¼“å­˜åˆ°metaManageräº† 7.è¿‡äº†å‡ å¤©xxxå¤„äºrunningçŠ¶æ€çš„é‚£å°canalå…³äº†ï¼Œæ­¤æ—¶slave-canalæ¥ç®¡ï¼Œä¼šå¯åŠ¨instanceï¼Œä½†æ˜¯metaManagerå·²ç»å¯åŠ¨è¿‡äº†ï¼Œpostionå®šä½åˆ°äº†å‡ å¤©å‰ 8.æ‚²å‰§äº† å¤‡æ³¨ï¼š 1.æ­¤å¤„åˆ¤æ–­runningMonitorçš„ç›®çš„æ˜¯æƒ³è§¦å‘lazy-startï¼Œä½†æ˜¯lazy-startåœ¨HAæ¨¡å¼ä¸‹ä¸æˆç«‹ï¼Œè¯·å‚è§ https://github.com/alibaba/canal/issues/205 2.å¼ºçƒˆå»ºè®®æ”¹é€ ä¸€ä¸‹ClusterNodeAccessStrategyï¼ŒHAæ¨¡å¼ä¸‹å–Addressçš„æ—¶å€™åªè®¤runningèŠ‚ç‚¹ï¼Œå°±ç”­æ”¯æŒlazyäº†ï¼ŒæŒ‰ç°åœ¨çš„è®¾è®¡ä¸ºäº†æ”¯æŒlazyå¾’å¢äº†å¤æ‚åº¦ï¼Œå¯¼è‡´å®¢æˆ·ç«¯çš„é«˜å¯ç”¨åˆ‡æ¢çš„æ—¶é—´æœ‰æ—¶éå¸¸é•¿ æˆ‘çœ‹äº†ä¸‹ä»£ç ï¼ŒembeddedServer.subscribe(clientIdentity);è®¢é˜…æ—¶ä¼šæå‰å¯åŠ¨metaManageræ¥è®°å½•è®¢é˜…çš„ä¿¡æ¯ï¼Œåå¯åŠ¨CanalInstanceï¼Œåœ¨æ‹¿æ•°æ®çš„æ—¶å€™æ‰ä¼šå»æ ¡éªŒæ˜¯å¦æ‹¿åˆ°äº†é”å¯åŠ¨äº†æœåŠ¡ æ©ï¼Œå³ä½¿ä¸æ˜¯lazyæ¨¡å¼ï¼Œå½“ 1ï¼ŒActiveç½®ä¸ºfalseçš„æ—¶å€™ 2ï¼Œæˆ–è€…ï¼Œinstanceé‡å¯çš„æ—¶å€™(autoscan) ä¼šå‡ºç°åªæœ‰clusterèŠ‚ç‚¹ï¼Œæ²¡æœ‰runningèŠ‚ç‚¹çš„æƒ…å†µï¼Œæ­¤æ—¶å®¢æˆ·ç«¯ä¼šéšæœºå–clusterèŠ‚ç‚¹ä¸‹çš„ä¸€ä¸ªipè¿›è¡Œé‡è¿ï¼Œè€Œè¿™ä¸ªipå¾ˆå¯èƒ½æ˜¯æœ¬æ¬¡æŠ¢å çš„slaveï¼Œé‚£ä¹ˆå°±ä¼šè§¦å‘subscribeçš„bug éœ€è¦æ”¹ä¸¤å¤„ä»£ç ï¼š 1ã€SessionHanderä¸­å˜æ›´ã€å¯åŠ¨runningmonitorã€‘å’Œã€è°ƒç”¨subscribeã€‘çš„é¡ºåº 2ã€CanalServerWithEmbeddedä¸­çš„subscribeæ–¹æ³•ä¸­ç¬¬ä¸€è¡Œå¢åŠ checkStartæ–¹æ³• checkStartæ–¹æ³•å¢åŠ ä¼šæœ‰é£é™©æ˜¯å¤±è´¥çš„ï¼Œå³ä½¿ä½ SessionHanderè°ƒç”¨äº†startæ–¹æ³•ï¼Œèµ°åˆ°subscribeæ–¹æ³•æ—¶å¯èƒ½è¿˜æ²¡åˆå§‹åŒ–å®Œæˆ æˆ‘è®°å¾—ä»¥å‰æˆ‘æ˜¯ç‰¹æ„å»æ‰çš„ï¼Œä¸çŸ¥é“è¿™ä¸ªæ²¡æœ‰checkstartæ ¡éªŒï¼Œå¯¹äºä½ ä»¬çš„å½±å“æ˜¯ï¼Ÿ 
205,instanceçš„lazyå¯åŠ¨åœ¨HAæ¨¡å¼ä¸‹ä¸æˆç«‹ åœ¨HAæ¨¡å¼ä¸‹ï¼Œinstanceçš„lazyå¯åŠ¨ä¸æˆç«‹ã€‚ **é¦–å…ˆçœ‹CanalControllerçš„ä»£ç ** for (Map.Entry<String  InstanceConfig> entry : instanceConfigs.entrySet()) {             final String destination = entry.getKey();             InstanceConfig config = entry.getValue();             // åˆ›å»ºdestinationçš„å·¥ä½œèŠ‚ç‚¹             if (!config.getLazy() && !embededCanalServer.isStart(destination)) {                 // HAæœºåˆ¶å¯åŠ¨                 ServerRunningMonitor runningMonitor = ServerRunningMonitors.getRunningMonitor(destination);                 if (!runningMonitor.isStart()) {                     runningMonitor.start();                 }             } ```         if (autoScan) {             instanceConfigMonitors.get(config.getMode()).register(destination  defaultAction);         }     } ``` lazyæ¨¡å¼ä¸‹ï¼ŒServerRunningMonitorä¸ä¼šå¯åŠ¨ï¼Œé‚£ä¹ˆåœ¨zookeeperçš„/otter/canal/destinations/destination/clusterèŠ‚ç‚¹ä¸‹ä¸ä¼šæœ‰æ•°æ®ï¼ŒrunningèŠ‚ç‚¹ä¹Ÿä¸ä¼šæœ‰æ•°æ® **å†çœ‹ClusterNodeAccessStrategyçš„ä»£ç **     public SocketAddress nextNode() {         if (runningAddress != null) {// å¦‚æœæœåŠ¡å·²ç»å¯åŠ¨ï¼Œç›´æ¥é€‰æ‹©å½“å‰æ­£åœ¨å·¥ä½œçš„èŠ‚ç‚¹             return runningAddress;         } else if (!currentAddress.isEmpty()) { // å¦‚æœä¸å­˜åœ¨å·²ç»å¯åŠ¨çš„æœåŠ¡ï¼Œå¯èƒ½æœåŠ¡æ˜¯ä¸€ç§lazyå¯åŠ¨ï¼Œéšæœºé€‰æ‹©ä¸€å°è§¦å‘æœåŠ¡å™¨è¿›è¡Œå¯åŠ¨             return currentAddress.get(0);// é»˜è®¤è¿”å›ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¹‹å‰å·²ç»åšè¿‡shuffle         } else {             throw new CanalClientException("no alive canal server");         }     } ç”±äºclusterå’ŒrunningèŠ‚ç‚¹éƒ½ä¸å­˜åœ¨ï¼Œæ­¤å¤„ä¼šè¿›å…¥elseåˆ†æ”¯ï¼Œå®¢æˆ·ç«¯ä¼šä¸€ç›´æŠ¥é”™ï¼Œæ²¡åŠæ³•è§¦å‘lazeå¯åŠ¨ã€‚ ä¸ªäººè®¤ä¸ºlazyå¯åŠ¨æ˜¯ä¸ªæ¯”è¾ƒé¸¡è‚‹çš„åŠŸèƒ½ï¼Œå¢åŠ äº†ä»£ç çš„å¤æ‚åº¦ï¼Œæ€§ä»·æ¯”ä¸é«˜ã€‚ æˆ‘ä»¬å†…éƒ¨ä½¿ç”¨æ—¶ï¼Œå®Œå…¨å±è”½äº†è¿™ç§æ¨¡å¼ï¼ŒæŠŠClusterNodeAccessStrategyç±»ä¸­çš„è¿™æ®µä»£ç ç›´æ¥æ³¨é‡Šæ‰äº† `else if (!currentAddress.isEmpty()) { // å¦‚æœä¸å­˜åœ¨å·²ç»å¯åŠ¨çš„æœåŠ¡ï¼Œå¯èƒ½æœåŠ¡æ˜¯ä¸€ç§lazyå¯åŠ¨ï¼Œéšæœºé€‰æ‹©ä¸€å°è§¦å‘æœåŠ¡å™¨è¿›è¡Œå¯åŠ¨ return currentAddress.get(0);// é»˜è®¤è¿”å›ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¹‹å‰å·²ç»åšè¿‡shuffle }` æ‰¾ä¸åˆ°runningèŠ‚ç‚¹å°±ç›´æ¥æŠ›é”™ï¼Œå…å»äº†æ— è°“çš„ç½‘ç»œäº¤äº’ï¼Œä½¿é«˜å¯ç”¨åœºæ™¯ä¸‹çš„åˆ‡æ¢æ—¶é—´å°½å¯èƒ½çš„å° serverç«¯æ”¹é€ çš„è¯ï¼Œæƒ³åˆ°çš„ä¸€ä¸ªæ€è·¯æ˜¯ ä¸ºServerRunningMonitorçš„startæ–¹æ³•å¢åŠ ä¸€ä¸ª boolean lazy å‚æ•° ServerRunningMonitoråªæ˜¯æ£€æµ‹runningèŠ‚ç‚¹çš„å˜åŒ–ï¼Œä¸ç®¡æ˜¯å¦lazyæ¨¡å¼ï¼Œéƒ½ä¼šä¸ºæ¯ä¸ªinstanceåˆ›å»ºä¸€ä¸ªcidèŠ‚ç‚¹ï¼Œè¿™é‡Œçš„currentAddressæ‹¿çš„åº”è¯¥æ˜¯è¿™ä¸ªlist. çœ‹äº†ä¸‹ä»£ç ï¼Œç›®å‰cidèŠ‚ç‚¹çš„æ³¨å†Œæ˜¯ä¾èµ–äº†ServerRunningMonitor.start()æ–¹æ³•ï¼Œé€»è¾‘ä¸Šè¿™é‡Œçš„ç¡®ä¼šæœ‰ä¸€ç‚¹é—®é¢˜ã€‚   æ”¹è¿›åŠæ³•ï¼šServerRunningMonitorå¯ä»¥å¢åŠ initæ–¹æ³•ï¼Œinitæ–¹æ³•è°ƒç”¨åˆ›å»ºcidï¼Œinitæ–¹æ³•ä¸å—lazyæ¨¡å¼æ§åˆ¶ æ©   è¿™ä¸ªå¯è¡Œ   monitorçš„ç”Ÿå‘½å‘¨æœŸå’Œinstanceå¹¶ä¸åœ¨ä¸€æ¡çº¿ä¸Š initä¸­åªè´Ÿè´£å¯åŠ¨monitor è¿™ä¸ªé—®é¢˜å€’æ˜¯æ²¡é‚£ä¹ˆä¸¥é‡ï¼Œä¼°è®¡lazyä¹Ÿæå°‘æœ‰äººç”¨ subscribeé‚£ä¸ªé—®é¢˜å»ºè®®è¿˜æ˜¯åŠæ—¶å¤„ç†ä¸‹ï¼Œæˆ‘ä»¬åœ¨ç”Ÿäº§ç¯å¢ƒå·²ç»é‡è§è¿‡ä¸¤æ¬¡é—®é¢˜äº†ï¼šç»´æŠ¤çš„æ—¶å€™ï¼Œåœæ‰ä¸€å°canal-serverï¼Œå¦å¤–ä¸€å°æ¥ç®¡instanceï¼Œç„¶åpositioné‡ç½®ä¸ºå‡ å¤©å‰çš„äº† positionä¸ºå•¥ä¼šæ˜¯å‡ å¤©å‰ï¼Ÿç¬¬ä¸€æ¬¡subscriteæ‹¿åˆ°äº†å†å²storeçš„æ•°æ®æ›´æ–°æ‰äº†ï¼Ÿ å¦‚æœ‰æ–°ä¿¡æ¯ï¼Œå†reopenè¯¥issue 
204,replace into æ“ä½œçš„è¯­å¥filteræ— æ•ˆ replace into table ä¸è®¢é˜…è¿™ä¸ªè¡¨ï¼Œå®¢æˆ·ç«¯ä¹Ÿèƒ½æ”¶åˆ°æ¶ˆæ¯ queryè¯­å¥æ²¡æœ‰ä¸¥æ ¼æŒ‰è¡¨è¿›è¡Œè¿‡æ»¤ 
203,fixed issue # 201 [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=203) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=203) before we can accept your contribution.<br/><hr/>**zikaifeng** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user). tks 
202,canal.instance.filter.regex ä¿®æ”¹åæœªç”Ÿæ•ˆ æˆ‘ä»¬è¿™è¾¹é€šè¿‡ç¨‹åºå®ç°è‡ªåŠ¨æ·»åŠ æ–°çš„åŒæ­¥è¡¨ï¼ˆä¿®æ”¹instance.propertiesä¸‹çš„canal.instance.filter.regexé…ç½®é¡¹ï¼‰ï¼Œå‘ç°æœ‰æ—¶canal.instance.filter.regexä¿®æ”¹åå¹¶æœªç”Ÿæ•ˆï¼Œå¯¹åº”çš„destinationå¹¶ä¸ºreloadã€‚ æŸ¥çœ‹com.alibaba.otter.canal.deployer.monitor.SpringInstanceConfigMonitorï¼Œå‘ç°reloadé€»è¾‘å­˜åœ¨æ¼æ´ã€‚ > å› ç¬¬ä¸€æ¬¡å¯åŠ¨æ—¶å¹¶æœªè®°å½•é…ç½®æ–‡ä»¶çš„ä¿¡æ¯ï¼Œæ‰€ä»¥åœ¨ä¸‹æ¬¡æ‰«æå‰ï¼ˆé»˜è®¤5ç§’åï¼‰é…ç½®æ–‡ä»¶å‘ç”Ÿå˜æ›´å°†æ— æ³•è¢«è¯†åˆ«åˆ°ï¼Œè‡ªç„¶ä¹Ÿæ— æ³•è¿›è¡Œreloadæ“ä½œã€‚ ä¸‹é¢æ˜¯æˆ‘æ‰“çš„patchï½ ``` Index: deployer/src/main/java/com/alibaba/otter/canal/deployer/monitor/SpringInstanceConfigMonitor.java IDEA additional info: Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP <+>UTF-8 =================================================================== --- deployer/src/main/java/com/alibaba/otter/canal/deployer/monitor/SpringInstanceConfigMonitor.java    (revision f6cf88a6bd887afc56203bf9c4fa2aaccfd76e85) +++ deployer/src/main/java/com/alibaba/otter/canal/deployer/monitor/SpringInstanceConfigMonitor.java    (revision ) @@ -49 6 +49 8 @@      private ScheduledExecutorService         executor             = Executors.newScheduledThreadPool(1                                                                        new NamedThreadFactory("canal-instance-scan")); +    private volatile boolean isFirst = true; +      public void start() {          super.start();          Assert.notNull(rootConf  "root conf dir is null!"); @@ -58 6 +60 7 @@              public void run() {                  try {                      scan(); +                    if (isFirst) isFirst = false;                  } catch (Throwable e) {                      logger.error("scan failed"  e);                  } @@ -122 13 +125 18 @@              if (!actions.containsKey(destination) && instanceConfigs.length > 0) {                  // å­˜åœ¨åˆæ³•çš„instance.propertiesï¼Œå¹¶ä¸”ç¬¬ä¸€æ¬¡æ·»åŠ æ—¶ï¼Œè¿›è¡Œå¯åŠ¨æ“ä½œ -                notifyStart(instanceDir  destination); +                notifyStart(instanceDir  destination  instanceConfigs);              } else if (actions.containsKey(destination)) {                  // å†å²å·²ç»å¯åŠ¨è¿‡                  if (instanceConfigs.length == 0) { // å¦‚æœä¸å­˜åœ¨åˆæ³•çš„instance.properties                      notifyStop(destination);                  } else {                      InstanceConfigFiles lastFile = lastFiles.get(destination); +                    // TODO å†å²å¯åŠ¨è¿‡ æ‰€ä»¥é…ç½®æ–‡ä»¶ä¿¡æ¯å¿…ç„¶å­˜åœ¨ +                    if (!isFirst && CollectionUtils.isEmpty(lastFile.getInstanceFiles())) { +                        logger.error("### [{}] is started  but not found instance file info."  destination); +                    } +                      boolean hasChanged = judgeFileChanged(instanceConfigs  lastFile.getInstanceFiles());                      // é€šçŸ¥å˜åŒ–                      if (hasChanged) { @@ -161 10 +169 19 @@          }      } -    private void notifyStart(File instanceDir  String destination) { +    private void notifyStart(File instanceDir  String destination  File[] instanceConfigs) {          try {              defaultAction.start(destination);              actions.put(destination  defaultAction); + +            // TODO å¯åŠ¨æˆåŠŸåè®°å½•é…ç½®æ–‡ä»¶ä¿¡æ¯ +            InstanceConfigFiles lastFile = lastFiles.get(destination); +            List<FileInfo> newFileInfo = new ArrayList<FileInfo>(); +            for (File instanceConfig : instanceConfigs) { +                newFileInfo.add(new FileInfo(instanceConfig.getName()  instanceConfig.lastModified())); +            } +            lastFile.setInstanceFiles(newFileInfo); +              logger.info("auto notify start {} successful."  destination);          } catch (Throwable e) {              logger.error("scan add found[{}] but start failed"  destination  ExceptionUtils.getFullStackTrace(e)); ``` ä½ æ‰“çš„patchèƒ½æäº¤ä¸€ä¸ªPRç»™æˆ‘ï¼Ÿæˆ‘å¥½åˆå¹¶åˆ°master æ€ä¹ˆæ„Ÿè§‰é…ç½®äº†canal.instance.filter.regexæ²¡æœ‰ç”Ÿæ•ˆå‘¢ï¼Œæ‰€æœ‰åº“ä»»ä½•è¡¨æ›´æ–°éƒ½ä¼šè¢«æ¶ˆè´¹å‘¢ï¼Ÿ è¡¨æ•°æ®è¿‡æ»¤ï¼Œåªé’ˆå¯¹rowæ¨¡å¼ä¼šæœ‰æ•ˆ ä½ å¥½ï¼Œé’ˆå¯¹CanalServerWithEmbedded_StandaloneTestï¼ŒCanalServerWithEmbedded_StandbyTestæœ‰ä»¥ä¸‹é—®é¢˜ï¼š - ä¿®æ”¹**MetaMode**ä¸º**MetaMode.ZOOKEEPER**ï¼Œå‘ç°åŒæ—¶å¯åŠ¨ä¸¤ä¸ªï¼Œæ•°æ®ä¿®æ”¹åä¼šä¸¤ä¸ªå®ä¾‹éƒ½ä¼šå¾—åˆ°æ›´æ–°é€šçŸ¥ï¼Œæˆ–è€…è¯´**åµŒå…¥å¼**ä¸æ”¯æŒ**Server**æ¨¡å¼é‚£æ ·ï¼Œä¸€ä¸ªinstanceåªä¼šä¸€ä¸ªServerå®ä¾‹åœ¨ç›‘å¬å‘¢ï¼Ÿ - ä½¿ç”¨**åµŒå…¥å¼**å¯¹äºé…ç½®å¤šåº“é…ç½®ï¼Œè®¾ç½®Groupæ—¶æ¯”è¾ƒéº»çƒ¦(ç›¸å¯¹äºxml)ï¼› - ç”Ÿäº§ç¯å¢ƒçš„Serveræ¨¡å¼æœ‰å…·ä½“çš„ä¸€äº›æ¡ˆä¾‹æµ‹è¯•ï¼Œå’Œå‚è€ƒçš„benchmarkå—ï¼Ÿ 1.  HAçš„æœºåˆ¶æ˜¯åœ¨deployerå®ç°ï¼Œè¿å…¥å¼æ—¶éœ€è¦è‡ªè¡Œè§£å†³HA 2. Groupæ¨¡å¼å¯ä»¥é€‰æ‹©APIåˆ›å»ºçš„æ–¹å¼ï¼Œå¯ä»¥çœ‹ä¸‹otterå’Œcanalç»“åˆçš„éƒ¨åˆ† 3. canalå¤§æ¦‚çš„æ€§èƒ½TPSåœ¨2.5w+å·¦å³ï¼Œå’Œä¸åŒç”¨æˆ·çš„æœºå™¨ç¯å¢ƒå’Œç½‘ç»œéƒ½æœ‰ä¸€äº›ç•¥å¾®å˜åŒ– @ihaolin `æ£€æŸ¥ä¸‹CanalConnectoræ˜¯å¦è°ƒç”¨subscribe(filter)æ–¹æ³•ï¼›æœ‰çš„è¯ï¼Œfilteréœ€è¦å’Œinstance.propertiesçš„canal.instance.filter.regexä¸€è‡´ï¼Œå¦åˆ™subscribeçš„filterä¼šè¦†ç›–instanceçš„é…ç½®ï¼Œå¦‚æœsubscribeçš„filteræ˜¯.*\\..*ï¼Œé‚£ä¹ˆç›¸å½“äºä½ æ¶ˆè´¹äº†æ‰€æœ‰çš„æ›´æ–°æ•°æ®ã€‚`
201,MysqlConnectionçš„seekæ–¹æ³•å’Œdumpæ–¹æ³•ä¼šæŠ¥NullPointerException seekæ–¹æ³•å’Œdumpæ–¹æ³•éƒ½æœ‰åˆå§‹åŒ–LogContext ``` java LogContext context = new LogContext(); ``` ä½†æ˜¯åœ¨decodeçš„æ—¶å€™ä¼šæŠ¥NullPointerException å»ºè®®åˆ†åˆ«æ·»åŠ  ``` java context.setLogPosition(new LogPosition(binlogfilename)); ``` èƒ½ç»™æ›´è¯¦ç»†çš„å¼‚å¸¸å †æ ˆä¸ï¼Ÿ æˆ‘è¿è¡Œçš„æ˜¯MysqlEventParserTestçš„test_timestampæ–¹æ³• ``` java 16:06:16.145 [destination = null   address = /10.4.0.20:3306   EventParser] INFO  c.a.o.c.p.i.mysql.MysqlConnection - COM_BINLOG_DUMP with position:BinlogDumpCommandPacket[binlogPosition=4 slaveServerId=3344 binlogFileName=mysql-bin.000047 command=18] 16:06:16.146 [destination = null   address = /10.4.0.20:3306   EventParser] WARN  c.a.o.c.p.i.mysql.MysqlEventParser - the binlogfile:mysql-bin.000047 doesn't exist  to continue to search the next binlogfile   caused by java.lang.NullPointerException     at com.taobao.tddl.dbsync.binlog.LogDecoder.decode(LogDecoder.java:162)     at com.taobao.tddl.dbsync.binlog.LogDecoder.decode(LogDecoder.java:106)     at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.seek(MysqlConnection.java:96)     at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findAsPerTimestampInSpecificLogFile(MysqlEventParser.java:1101)     at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findByStartTimeStamp(MysqlEventParser.java:539)     at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPositionInternal(MysqlEventParser.java:375)     at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPosition(MysqlEventParser.java:310)     at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:162)     at java.lang.Thread.run(Thread.java:745) ``` https://github.com/alibaba/canal/pull/203 
200,é¡¹ç›®ä½¿ç”¨log4j2ä¸canalçš„logbackå‘ç”Ÿå†²çª `SLF4J: Class path contains multiple SLF4J bindings. SLF4J: Found binding in [jar:file:/Users/raoshaoquan/.m2/repository/org/slf4j/slf4j-log4j12/1.6.1/slf4j-log4j12-1.6.1.jar!/org/slf4j/impl/StaticLoggerBinder.class] SLF4J: Found binding in [jar:file:/Users/raoshaoquan/.m2/repository/ch/qos/logback/logback-classic/1.1.3/logback-classic-1.1.3.jar!/org/slf4j/impl/StaticLoggerBinder.class] SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation. SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory] log4j:WARN No appenders could be found for logger (cn.mwee.search.job.misc.MyApplicationContext). log4j:WARN Please initialize the log4j system properly. log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.` canalé»˜è®¤ä¾èµ–çš„æ˜¯slf4jï¼Œä½ å¯ä»¥æ’é™¤logbackæ¥å¯ç”¨ä½ è‡ªå·±çš„loggeré€‰æ‹© è°¢è°¢ å·²è§£å†³ 
199,upgrade protobuf version ç‰ˆæœ¬å¤ªè€äº†ï¼Œåœ¨ä¾èµ–canalåšäºŒæ¬¡å¼€å‘çš„æ—¶å€™å’Œå…¶ä»–å¼€æºé¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬å†²çªï¼Œæå‡canalçš„protobufçš„ç‰ˆæœ¬ [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=199) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=199) before we can accept your contribution.<br/><hr/>**yinxiu** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user). tks 
198,mysql 5.5.52ä¸‹canalè§£æbin-logé—®é¢˜ mysql 5.5 my.cnfé…ç½®å¦‚ä¸‹ï¼š     [mysqld]       log-bin=mysql-bin #æ·»åŠ è¿™ä¸€è¡Œå°±ok       binlog-format=ROW #é€‰æ‹©rowæ¨¡å¼       server_id=1 #é…ç½®mysql replactionéœ€è¦å®šä¹‰ï¼Œä¸èƒ½å’Œcanalçš„slaveIdé‡å¤   canalæ—¥å¿—ï¼š    2016-09-12 16:22:04.994 [destination = example   address = localhost/127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - Didn't find the corresponding binlog files from mysql-bin.000001 to mysql-bin.000009 2016-09-12 16:22:04.994 [destination = example   address = localhost/127.0.0.1:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address localhost/127.0.0.1:3306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: can't find start position for example 2016-09-12 16:22:04.995 [destination = example   address = localhost/127.0.0.1:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: can't find start position for example    mysql 5.6æ˜¯æ­£å¸¸çš„ï¼Œèƒ½å¸®çœ‹ä¸‹æ˜¯å•¥é—®é¢˜å—ï¼Ÿ can't find start position for example æ‰¾ä¸åˆ°æ¯”æŒ‡å®šæ—¶é—´æˆ³æ›´æ—©ä¹‹å‰çš„æ—¶é—´ è¯·æ•™å…·ä½“å¦‚ä½•è§£å†³ï¼Œæˆ‘ä¹Ÿæœ‰è¿™ä¸ªé—®é¢˜ï¼Œæ„Ÿè°¢ï¼ updated: å‘ç°åˆ æ‰canal.deployer-1.0.22\conf\example\meta.datå°±å¯ä»¥äº†ï¼ CanalParseException: can't find start position for example å‘ç”Ÿä¸Šé¢çš„é”™è¯¯åŸå› æ˜¯æ—¶é—´æˆ³çš„é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´çš„åŸå› æœ‰å‡ ä¸ªï¼š - conf/${instance}/meta.dat æ–‡ä»¶è®°å½•äº†æ—¶é—´æˆ³ï¼Œåˆ æ‰å®ƒå°è¯•ä¸‹ã€‚ - æ­¤å¤–å¯èƒ½æ˜¯ä¹‹å‰çš„instanceååœ¨Zookeeperä¸­å·²ç»æœ‰binlogæ—¶é—´æˆ³è®°å½•ï¼Œä½†ä½ ä¹‹åçš„instanceä¿®æ”¹äº†æ•°æ®åº“è¿æ¥ï¼Œä½†æ˜¯instanceåè¿˜æ˜¯ç›¸åŒï¼Œå› æ­¤ä¼šå¯¼è‡´è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä¿®æ”¹instanceåä¹‹åå°±å¯ä»¥äº†ã€‚
197,Unexpected End Stream Exception æ•°æ®åº“ç”¨çš„é˜¿é‡Œäº‘rdsï¼Œ canalç‰ˆæœ¬1.0.22 æœ€è¿‘éš”å‡ å¤©å°±ä¼šæŠ¥ä¸‹é¢çš„é”™è¯¯ï¼Œå¯¼è‡´æ¥æ”¶ä¸åˆ°binlogã€‚ èƒ½çœ‹å‡ºæ˜¯å•¥é—®é¢˜å—ï¼Ÿ 2016-08-30 11:00:27.364 [destination = prodb2   address = x/y:3306   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Unexpected End Stream         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156) ~[canal.parse-1.0.22.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70) ~[canal.parse-1.0.22.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) [canal.parse-1.0.22.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) [canal.parse-1.0.22.jar:na]         at java.lang.Thread.run(Thread.java:744) [na:1.7.0_45] 2016-08-30 11:00:27.370 [destination = prodb2   address = x/y:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address x/y:3306 has an error  retrying. caused by java.io.IOException: Unexpected End Stream         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156) ~[canal.parse-1.0.22.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70) ~[canal.parse-1.0.22.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) ~[canal.parse-1.0.22.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210) ~[canal.parse-1.0.22.jar:na]         at java.lang.Thread.run(Thread.java:744) [na:1.7.0_45] 2016-08-30 11:00:27.371 [destination = prodb2   address = x/y:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:prodb2[java.io.IOException: Unexpected End Stream         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:210)         at java.lang.Thread.run(Thread.java:744) ] 2016-08-30 11:00:28.554 [destination = prodb2   address = x/y:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - disconnect address x/y:3306 has an error  retrying.  caused by java.io.IOException: KILL DUMP 369615002 failure:java.io.IOException: ErrorPacket [errorNumber=1094  fieldCount=-1  message=Unknown thread id: 369615002  sqlState=HY000  sqlStateMarker=#]  with command: KILL CONNECTION 369615002         at com.alibaba.otter.canal.parse.driver.mysql.MysqlUpdateExecutor.update(MysqlUpdateExecutor.java:49)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.disconnect(MysqlConnector.java:104)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.disconnect(MysqlConnection.java:60)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:242)         at java.lang.Thread.run(Thread.java:744) KILL CONNECTION å»ºè®®ä½¿ç”¨ä¸»å¹²æ‰“åŒ…è¯•è¯• @agapple æ‚¨å¥½ï¼Œæˆ‘æœ€è¿‘ä¹Ÿå‘ç°äº†è¿™ä¸ªé—®é¢˜ï¼Œæ‚¨è¯´å¾—ä¸»å¹²æ‰“åŒ…æ˜¯ä»€ä¹ˆæ„æ€ï¼Œæ²¡æ˜ç™½ï¼Œè¿™ä¸ªé—®é¢˜æ‚¨åœ¨å¦ä¸€ä¸ªç›¸åŒissueé‡Œæå‡ºçš„è§£å†³æ–¹æ¡ˆæ˜¯æ‰“å¼€å¿ƒè·³sqlï¼Œæœ‰å…·ä½“å¯è¡Œçš„æ–¹æ¡ˆå—ï¼Œåˆšæ¥è§¦ä¸ä¹…ï¼Œè°¢è°¢å•¦ @tutulvlv ä½¿ç”¨1.0.24æ–°ç‰ˆè¯•è¯• ç”¨çš„1.0.24ä¹Ÿæ˜¯å¶å°”æŠ¥è¿™ä¸ªé”™è¯¯ã€‚ `2017-09-15 16:33:17.786 [destination = action_log   address = /127.0.0.2:2020   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address 127.0.0.2/127.0.0.2:2020 has an error  retrying. caused by  java.io.IOException: Unexpected End Stream         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:122) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) ~[canal.parse-1.0.24.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.7.0_80] 2017-09-15 16:33:17.786 [destination = action_log   address = /127.0.0.2:2020   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:action_log[java.io.IOException: Unexpected End Stream         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:122)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209)         at java.lang.Thread.run(Thread.java:745) ] 2017-09-15 16:33:34.137 [destination = action_log   address = /127.0.0.2:2020   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position  {"identity":{"slaveId":-1 "sourceAddress":{"address":"127.0.0.2" "port":2020}} "postion":{"included":false "journalName":"mysql-bin.000876" "position":1064558972 "serverId":1037 "timestamp":1505464397000}} 2017-09-15 18:33:34.137 [destination = action_log   address = /127.0.0.2:2020   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Unexpected End Stream         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:122) [canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) [canal.parse-1.0.24.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.7.0_80] 2017-09-15 18:33:34.137 [destination = action_log   address = /127.0.0.2:2020   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address 127.0.0.2/127.0.0.2:2020 has an error  retrying. caused by  java.io.IOException: Unexpected End Stream         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:122) ~[canal.parse-1.0.24.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) ~[canal.parse-1.0.24.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.7.0_80] 2017-09-15 18:33:34.137 [destination = action_log   address = /127.0.0.2:2020   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:action_log[java.io.IOException: Unexpected End Stream         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:156)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:122)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209)         at java.lang.Thread.run(Thread.java:745) ] 2017-09-15 18:33:46.970 [destination = action_log   address = /127.0.0.2:2020   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position  {"identity":{"slaveId":-1 "sourceAddress":{"address":"127.0.0.2" "port":2020}} "postion":{"included":false "journalName":"mysql-bin.000877" "position":459898074 "serverId":1037 "timestamp":1505471614000}}` å¤§æ¦‚å‡ ä¸ªå°æ—¶å°±ä¼šé‡ç°ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯å®¢æˆ·ç«¯å¼•èµ·çš„ï¼Ÿå®¢æˆ·ç«¯æ˜¯æ‹‰ä¸€æ¬¡->æ¶ˆè´¹->ç¡®è®¤ï¼Œå†å¾ªç¯ï¼Œå¦‚æœæ•°æ®åœ¨masterå †ç§¯ä¼šæœ‰é—®é¢˜å—ï¼Ÿ @agapple 
196,eclipseå¯¼å…¥é¡¹ç›®ç¼–è¯‘æŠ¥é”™ é—®é¢˜æè¿°ï¼š ä»£ç ç‰ˆæœ¬: 1.0.22 maven ç‰ˆæœ¬: 3.3.3 jdkç‰ˆæœ¬: 1.7.0_80 åœ¨æ ¹ç›®å½•ä¸‹æ‰§è¡Œmvn eclipse:eclipse å‘½ä»¤åï¼Œå°†é¡¹ç›®å¯¼å…¥eclipseï¼Œå¤§é¢ç§¯æŠ¥é”™ï¼Œå¤§æ¦‚åŸå› æ˜¯ï¼šdriveré¡¹ç›®ä¾èµ–canal.common  ä½†æ˜¯eclipseä¸­å¯¼å…¥çš„commoné¡¹ç›®çš„é¡¹ç›®åæ˜¯"common"  é¡¹ç›®åä¸åŒ¹é…ã€‚å¤§å®¶æœ‰ç¢°åˆ°ç±»ä¼¼é—®é¢˜å—ï¼Ÿ ![qq20160828-1](https://cloud.githubusercontent.com/assets/13866684/18031262/31068e26-6d0a-11e6-8257-f8b21a2e4681.png) æˆ‘å·¥ç¨‹ä¾èµ–æ ‘å®šä¹‰éƒ½æ˜¯canal.xxxï¼Œå…¨åçš„ï¼Œä½ çœ‹ä¸‹å…¶ä»–å·¥ç¨‹çš„pom.xmlå®šä¹‰ @agapple  æˆ‘çœ‹äº†ä¸‹å…¶ä»–å·¥ç¨‹çš„pom.xmlå®šä¹‰ï¼Œä¾èµ–ä¹Ÿéƒ½æ˜¯å…¨åä¾èµ–ï¼Œä½†æ˜¯è¢«ä¾èµ–çš„é¡¹ç›®å¯¼å…¥eclipseåå°±ä¸æ˜¯å…¨åäº†ï¼Œå¯ä»¥è§é—®é¢˜ä¸­çš„æˆªå›¾â€œcommonâ€ã€‚ æ˜¯ä¸æ˜¯è¯¥é¡¹ç›®å¯¹mavenç‰ˆæœ¬æœ‰è¦æ±‚è¿˜æ˜¯æˆ‘æ‰§è¡Œçš„mvn eclipse:eclipseå‘½ä»¤ç¼ºå°‘å‚æ•°ã€‚ æˆ‘è‡ªå·±åœ¨eclipseä¸­å°†é¡¹ç›®åæ‰‹å·¥æ”¹äº†ï¼Œç°åœ¨ç¼–è¯‘å·²ç»æ²¡é—®é¢˜äº†ã€‚ 
195,å¯¹positionå†…å­˜çš„ç«äº‰å¯¼è‡´çš„å®šä½é”™è¯¯é—®é¢˜ å‰æï¼šä½¿ç”¨PeriodMixedMetaManager.javaä½œä¸ºmetaManager é—®é¢˜æè¿°ï¼š åœ¨CanalServerWithEmbedded.javaçš„subscribe()æ–¹æ³•ä¸­å­˜åœ¨è¿™æ ·ä¸€æ®µä»£ç ï¼š ```         Position position = canalInstance.getMetaManager().getCursor(clientIdentity);         if (position == null) {             position = canalInstance.getEventStore().getFirstPosition();// è·å–ä¸€ä¸‹storeä¸­çš„ç¬¬ä¸€æ¡             if (position != null) {                 canalInstance.getMetaManager().updateCursor(clientIdentity  position); // æ›´æ–°ä¸€ä¸‹cursor             }             logger.info("subscribe successfully  {} with first position:{} "  clientIdentity  position); ``` æ ¹æ®ä¸Šä¸‹æ–‡ï¼Œå½“å†…å­˜ä¸­çš„positionä¸ºnullæ—¶ï¼Œè¿™æ®µä»£ç ä¼šå…ˆå–å‡ºeventStoreä¸­çš„positionï¼Œå†æ ¹æ®æ­¤positionæ›´æ–°zkä¸­çš„cursorä½ç½®ã€‚ä½†æ˜¯åœ¨PeriodMixedMetaManagerä¸­æ›´æ–°æ–¹æ³•çš„ä»£ç å¦‚ä¸‹ï¼š ```     public void updateCursor(ClientIdentity clientIdentity  Position position) throws CanalMetaManagerException {         updateCursorTasks.add(clientIdentity);// æ·»åŠ åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­è¿›è¡Œè§¦å‘         super.updateCursor(clientIdentity  position);     } ``` æ­¤æ–¹æ³•ä¼šå…ˆå°†è°ƒåº¦ä»»åŠ¡åŠ å…¥ä»»åŠ¡é˜Ÿåˆ—ï¼Œç„¶åå†æ›´æ–°å†…å­˜ä¸­çš„positionã€‚è€Œè°ƒåº¦çº¿ç¨‹åˆ™ä¼šå…ˆå»å–å†…å­˜ä¸­çš„positionï¼Œå†æ›´æ–°zookeeperä¸­çš„cursorã€‚ä¸¤ä¸ªçº¿ç¨‹å¤„äºå¹¶å‘ç«äº‰æ€ï¼Œå¯èƒ½ä¼šå‘ç”Ÿè¯»åå†™æƒ…å†µã€‚ é—®é¢˜è§£å†³åŠæ³•ï¼ˆå»ºè®®ï¼‰ï¼š å¦‚æœæ‚¨è®¤å¯è¿™é‡Œçš„ç¡®å¯èƒ½æœ‰é£é™©ï¼ŒæŠŠupdateCursoré‡Œçš„ä¸¤å¥è¯è°ƒæ¢ä¸€ä¸‹ä½ç½® é—®é¢˜èƒŒæ™¯ï¼š åœ¨åˆ‡æ¢canalæ—¶å‘ç”Ÿäº†cursorå®šä½é”™è¯¯ï¼ˆä»0å¼€å§‹ï¼‰çš„æƒ…å†µã€‚æˆ‘æŠ±ç€â€œæœ‰é—®é¢˜â€çš„å¿ƒæ€æ¥æ‰¾é—®é¢˜ï¼Œåˆæ­¥å°†é—®é¢˜å®šä½åœ¨è¿™é‡Œã€‚å¦‚æœå­˜åœ¨é£é™©æ›´å¤§çš„åœ°æ–¹ï¼Œè¯·ä½œè€…æŒ‡ç‚¹ä¸€äºŒ updateCursorTasks.add(clientIdentity);// æ·»åŠ åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­è¿›è¡Œè§¦å‘ è¿™ä¸ªåªæ˜¯ä¸€ä¸ªæ ‡è‡´ä½è€Œå·²ï¼Œå…·ä½“æ›´æ–°çš„æ—¶å€™è¿˜æ˜¯è·å–ä»¥ä¸‹å½“å‰å†…å­˜ä¸­çš„å€¼è¿›è¡Œå†™å‡ºï¼Œä¸ä¼šå‡ºç°è¯»åˆ°æ—§ç‰ˆæœ¬æ•°æ®çš„é—®é¢˜ï¼Œä¸€èˆ¬ä¹Ÿå»ºè®®subscribeæ˜¯å•å®¢æˆ·ç«¯è°ƒç”¨ï¼Œé¿å…å¹¶å‘ æˆ‘è¯´çš„å¹¶ä¸æ˜¯å¤šå®¢æˆ·ç«¯è°ƒç”¨subscribe()çš„é—®é¢˜ï¼Œè€Œæ˜¯å•æ¬¡subscribe()æ‰§è¡Œæ—¶å¯èƒ½ä¼šå‘ç”Ÿçš„é—®é¢˜ã€‚<å®šæ—¶å°†å†…å­˜ä½ç‚¹æ¨åˆ°zk>å’Œ<æ›´æ–°ä½ç‚¹åˆ°å†…å­˜>æ˜¯ä¸¤ä¸ªå¹¶è¡Œçš„è¿‡ç¨‹ï¼Œè€Œå®šæ—¶æ¨é€ä»»åŠ¡çš„å¯åŠ¨å¯èƒ½æ—©äºæ›´æ–°ä½ç‚¹åˆ°å†…å­˜çš„æ“ä½œå®Œæˆï¼Œå› æ­¤æ˜¯æœ‰å¯èƒ½è¯»åˆ°æ—§æ•°æ®çš„ï¼Œè°å…ˆè°åå®Œå…¨å–å†³äºè°ƒåº¦æƒ…å†µ å¯¹äºä»£ç çš„ç»†è‡´è¦æ±‚ï¼Œä¿®æ”¹é£é™©å¯æ§ 
194,serverä¸clientéƒ¨ç½²åœ¨åŒæœºä¸Šçš„é«˜å¯ç”¨æ€§é—®é¢˜ é—®é¢˜æƒ…æ™¯ï¼š serverä¸clientéƒ¨ç½²åœ¨åŒæœºä¸Šçš„é«˜å¯ç”¨æ€§é—®é¢˜ canal serverç‰ˆæœ¬ä¸º1.0.21ï¼Œclientç‰ˆæœ¬ä¸º1.0.22 é—®é¢˜æè¿°ï¼š ç°æœ‰ä¸¤å°æœºå™¨pc1  pc2  åˆ†åˆ«éƒ¨æœ‰serverä¸clientå„1ä¸ªï¼Œåä¸ºs1  c1  s2  c2ã€‚s1å’Œc1åœ¨pc1ä¸Šæ­£å¸¸è¿è¡Œï¼Œs2å’Œc2åœ¨pc2ä¸Šä½œä¸ºå¤‡ä»½hangingã€‚ ç°å°†pc1è¿›è¡Œrebootï¼Œpc2ä¸Šçš„s2å¯ä»¥åˆ‡æ¢åˆ°æ­£å¸¸è¿è¡Œæ€ï¼Œä½†c2ä¼šå¡åœ¨connector.subscribe()æ–¹æ³•ä¸Šã€‚ é—®é¢˜åˆ†æï¼š subscribe()åœ¨å†…éƒ¨(SimpleCanalConnector.java)å®ç°æ—¶ï¼Œä¼šä¸€ç›´ç­‰å¾…è·å–é”(mutex.get())ï¼Œè€Œæœªé‡‡ç”¨è¶…æ—¶è¿”å›TimeoutExceptionçš„æ–¹æ³•(mutex.get(long timeout  TimeUnit unit))ã€‚ åœ¨åªæœ‰serverå‘ç”Ÿåˆ‡æ¢çš„æ—¶å€™ï¼ŒåŸæœ‰çš„clientä¼šåœ¨serveræ›´æ–°ä½ç‚¹æ—¶æŠ›å‡ºå¼‚å¸¸ï¼Œä»è€Œè·³å‡ºæ”¶å‘binlogçš„å¾ªç¯ï¼Œé‡æ–°è®¢é˜…serverèŠ‚ç‚¹ã€‚è€Œå½“serverä¸clientåŒæ—¶å‘ç”Ÿåˆ‡æ¢æ—¶ï¼Œç”±äºå¤‡ä»½clientä¸€ç›´å¤„äºç­‰å¾…é”çŠ¶æ€ä¸­ï¼Œæ‰€ä»¥æœªèƒ½æ›´æ–°è·å–nodeçš„å‚æ•°æˆ–è€…é‡æ–°è°ƒç”¨subscribe()æ–¹æ³•ã€‚ é—®é¢˜hackï¼š ä¿®æ”¹äº†ä¸€äº›æºç ï¼Œä½¿å…¶æš´éœ²äº†å¸¦æœ‰TimeoutExceptionçš„subscribe()æ–¹æ³•ï¼Œä»è€Œç”¨é‡è¯•çš„æ–¹æ³•hackæ­¤bugã€‚å°šæœ‰ä»¥ä¸‹å‡ ç‚¹é—®é¢˜ï¼š 1ã€ ç”±äºåœ¨åº•å±‚åŠ å…¥äº†è¶…æ—¶æœºåˆ¶ï¼Œconnect()ä¸disconnect()æ–¹æ³•ä¹Ÿä¼šæŠ›å‡ºè¶…æ—¶å¼‚å¸¸ï¼Œä»è€Œä¸èƒ½ä¿è¯æ­£ç¡®å¼€å¯/å…³é—­è¿æ¥ã€‚ï¼ˆæœªéªŒè¯ï¼Œåªæ˜¯è§‰å¾—æœ‰é£é™©ï¼‰ 2ã€ å…¶å®ƒæ½œåœ¨é£é™©ï¼ˆæˆ‘æ‰åˆšåˆšæ¥æ‰‹è¿™ä¸€å—ï¼Œæºç è¯»çš„ä¸å¤Ÿæ·±ï¼‰ æœ›å¾—åˆ°ä½œè€…æŒ‡ç‚¹ä¸€äºŒï¼Œæ•¬è°¢ çœ‹ä¸‹ https://github.com/alibaba/canal/issues/171ï¼Œ å¦‚æœæ˜¯å¡åœ¨subscribeæ–¹æ³•ï¼Œå¾—æ£€æŸ¥ä¸‹initRunningæ–¹æ³•æ˜¯å¦æœ‰æ‰§è¡ŒæˆåŠŸï¼ŒæˆåŠŸä¹‹åä¼šè§¦å‘ä¸€ä¸ªå›è°ƒæ›´æ–°mutex initRunning()æ–¹æ³•å¦‚æœè°ƒç”¨æˆåŠŸï¼Œä¼šä¿®æ”¹mutexï¼Œsubscribeæ–¹æ³•ä¼šè¿”å›é‡è¯•ã€‚ä½†æ˜¯æ ¹æ®æ—¥å¿—çš„æƒ…å†µï¼ŒinitRunning()åªåœ¨reboot15åˆ†é’Ÿå‰æœ‰è¿‡æ—¥å¿—è®°å½•ã€‚å¯èƒ½æ˜¯å› ä¸ºrebootæœºå™¨æ—¶ï¼Œclientç«¯ä»ä¿æœ‰åŸserverçš„é»‘æ´çŠ¶æ€çš„è¿æ¥ï¼Œå’Œå®¢æˆ·ç«¯å•åˆ‡é€ æˆå µå¡çš„æƒ…å†µä¸å¤ªä¸€æ ·ã€‚ã€‚å»ºè®®ä½œè€…å°è¯•ä¸€ä¸‹ï¼ŒåŸºæœ¬éƒ½å¯ä»¥é‡ç°ï¼Œæˆ‘è¿™è¾¹è¯´ä¸ç”šæ¸…æ¥š 
193,canal KILL DUMP  # position info canal.instance.master.address = xx.xx.xx.xx:3306 canal.instance.master.journal.name =  canal.instance.master.position =  canal.instance.master.timestamp = 1471076485000 2016-08-13 16:23:09.821 [main] WARN  org.springframework.beans.TypeConverterDelegate - PropertyEditor [com.sun.beans.editors.EnumEditor] found through deprecated global PropertyEditorManager fallback - consider using a more isolated form of registration  e.g. on the BeanWrapper/BeanFactory! 2016-08-13 16:23:09.978 [main] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start CannalInstance for 1-example  2016-08-13 16:23:10.000 [main] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - start successful.... 2016-08-13 16:23:10.030 [destination = example   address = /xxxxxxxxx:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position ::1471076485000 2016-08-13 16:23:34.010 [destination = example   address = /xxxxxxxxxxx:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /xxxxxxxxxx:3306 has an error  retrying. caused by  java.io.IOException: KILL DUMP 459561 failure:java.io.IOException: ErrorPacket [errorNumber=1094  fieldCount=-1  message=Unknown thread id: 459561  sqlState=HY000  sqlStateMarker=#]  with command: KILL CONNECTION 459561         at com.alibaba.otter.canal.parse.driver.mysql.MysqlUpdateExecutor.update(MysqlUpdateExecutor.java:49)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.disconnect(MysqlConnector.java:104)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.reconnect(MysqlConnector.java:82)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.reconnect(MysqlConnection.java:56)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:169)         at java.lang.Thread.run(Thread.java:745) ```     at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.disconnect(MysqlConnector.java:106) ~[canal.parse.driver-1.0.22.jar:na]     at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.reconnect(MysqlConnector.java:82) ~[canal.parse.driver-1.0.22.jar:na]     at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.reconnect(MysqlConnection.java:56) ~[canal.parse-1.0.22.jar:na]     at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:169) ~[canal.parse-1.0.22.jar:na]     at java.lang.Thread.run(Thread.java:745) [na:1.7.0_80] ``` 2016-08-13 16:23:34.010 [destination = example   address = /xxxxxxxx:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.io.IOException: KILL DUMP 459561 failure:java.io.IOException: ErrorPacket [errorNumber=1094  fieldCount=-1  message=Unknown thread id: 459561  sqlState=HY000  sqlStateMarker=#]  with command: KILL CONNECTION 459561         at com.alibaba.otter.canal.parse.driver.mysql.MysqlUpdateExecutor.update(MysqlUpdateExecutor.java:49)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.disconnect(MysqlConnector.java:104)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.reconnect(MysqlConnector.java:82)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.reconnect(MysqlConnection.java:56)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:169)         at java.lang.Thread.run(Thread.java:745) ```     at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.disconnect(MysqlConnector.java:106)     at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.reconnect(MysqlConnector.java:82)     at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.reconnect(MysqlConnection.java:56)     at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:169)     at java.lang.Thread.run(Thread.java:745) ``` ] 2016-08-13 16:23:46.004 [destination = example   address = /xxxxxxxx:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position ::1471076485000 1.0.22 ç‰ˆæœ¬  é…ç½®èµ·å§‹æ—¶é—´ä¿¡æ¯ï¼Œclientå¯åŠ¨åï¼Œ/logs/example/example.log  ä¸­è®°å½• kill dump é…ç½®èµ·å§‹ä½ç½®ï¼Œä¹ŸæŠ¥ç›¸åŒçš„é”™è¯¯ è°¢è°¢ å¤§ç¥ä»¬ å¸®å¿™ æˆ‘ä¹Ÿé‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼Œåæ¥æŠŠconf/example/meta.datåˆ æ‰ï¼Œå†é‡å¯å°±å¥½äº†ã€‚ @whlgh   è¿™ä¸ªæ–¹æ³•æˆ‘è¯•äº†ï¼Œæ²¡ç”¨ï¼Œä¸çŸ¥é“æˆ‘æ˜¯ä¸æ˜¯è¿˜æœ‰å…¶ä»–åœ°æ–¹æ²¡è®¾ç½®å¯¹ï¼Ÿ æˆ‘ç”¨windows è·‘ï¼Œé…ç½®äº†canal.instance.master.timestamp æ²¡é—®é¢˜ï¼Œé…ç½® canal.instance.master.journal.name å’Œ canal.instance.master.position  å°±æŠ¥ä¸Šé¢çš„é”™ï¼Œ  Linuxä¸‹è·‘ 2ä¸­é…ç½®æ–¹å¼ éƒ½æŠ¥é”™  ################################################# ## mysql serverId canal.instance.mysql.slaveId = 1234 # position info canal.instance.master.address = 127.0.0.1:3306 canal.instance.master.journal.name = canal.instance.master.position = canal.instance.master.timestamp = #canal.instance.standby.address =  #canal.instance.standby.journal.name = #canal.instance.standby.position =  #canal.instance.standby.timestamp =  # username/password canal.instance.dbUsername =root canal.instance.dbPassword =root canal.instance.defaultDatabaseName =test canal.instance.connectionCharset = UTF-8 # table regex canal.instance.filter.regex = ._\.._ # table black regex canal.instance.filter.black.regex = ################################################# è¿™æ˜¯æˆ‘é…ç½®æ–‡ä»¶ï¼Œ canal.instance.master.journal.nameã€canal.instance.master.positionã€canal.instance.master.timestampä¸‰ä¸ªå‚æ•°éƒ½ä¸ºç©ºä¹Ÿæ²¡é—®é¢˜ã€‚é…ä¸Šå‰ä¸¤ä¸ªä¹Ÿæ²¡é—®é¢˜ï¼Œæˆ‘æ˜¯åœ¨Linuxä¸‹è·‘çš„ã€‚ @whlgh   ä½ ç”¨çš„ä»€ä¹ˆç‰ˆæœ¬ï¼Ÿæˆ‘ç”¨çš„1.0.22  ä¹Ÿæ˜¯1.0.22 1ã€ä½ ç”¨rootç”¨æˆ·æ‰§è¡Œ 2ã€show variables like '%log_bin%'; çœ‹çœ‹mysqlçš„binlogæœ‰æ²¡æœ‰å¼€å¯ KILL CONNECTIONå¼‚å¸¸å·²ç»å¤„ç† è¯·é—®ä¸‹ï¼Œè¿™ä¸ªé—®é¢˜æ˜¯æ€ä¹ˆè§£å†³çš„ï¼Œæˆ‘æ€ä¹ˆæ²¡æœ‰æ‰¾åˆ°meta.datæ–‡ä»¶ è¿™ä¸ªæ˜¯æˆ‘çš„å¼‚å¸¸æ—¥å¿—ä¿¡æ¯ 2016-11-29 11:17:23.465 [destination = inventory   address = /172.172.230.55:3307   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position ::1480262400000 2016-11-29 11:17:57.401 [destination = inventory   address = /172.172.230.55:3307   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /172.172.230.55:3307 has an error  retrying. caused by  java.io.IOException: KILL DUMP 6155706 failure:java.io.IOException: ErrorPacket [errorNumber=1094  fieldCount=-1  message=Unknown thread id: 6155706  sqlState=HY000  sqlStateMarker=#]  with command: KILL CONNECTION 6155706 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlUpdateExecutor.update(MysqlUpdateExecutor.java:49) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.disconnect(MysqlConnector.java:104) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.reconnect(MysqlConnector.java:82) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.reconnect(MysqlConnection.java:56) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:169) 	at java.lang.Thread.run(Thread.java:745) 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.disconnect(MysqlConnector.java:106) ~[canal.parse.driver-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.reconnect(MysqlConnector.java:82) ~[canal.parse.driver-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.reconnect(MysqlConnection.java:56) ~[canal.parse-1.0.22.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:169) ~[canal.parse-1.0.22.jar:na] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_101] ä½ çš„é—®é¢˜æ€ä¹ˆè§£å†³çš„ï¼Ÿèƒ½åˆ†äº«ä¸‹ä¹ˆï¼Ÿ æˆ‘å¥½åƒç”¨æ—¶é—´äº†ï¼Œä¸å’Œä½ç½®è¾ƒåŠ²äº†
191,ä¸»å¤‡åŒæ­¥é—®é¢˜ ç°åœ¨æœ‰ä¸¤å°MySQLæ•°æ®åº“ ï¼šM1ï¼ˆä¸»ï¼‰-ã€‹M2ï¼ˆå¤‡ï¼‰ æˆ‘ç°åœ¨çš„æƒ…å†µæ˜¯otteréƒ¨ç½²åœ¨M2ä¸Šï¼Œä¸¤ä¸ªæœ‰ç›¸åŒçš„æ•°æ®åº“ä¸ä¸€å¼ è¡¨ æ¡ä»¶ï¼šM1ï¼ŒM2å‡æ­£å¸¸è¿è¡Œï¼Œotteræœªå¯åŠ¨åŒæ­¥ 1.åœ¨M1ä¸­insertä¸€æ¡æ•°æ®ï¼Œæ­¤æ—¶ç”±äºæœªå¯åŠ¨åŒæ­¥ï¼ŒM2ä¸ä¼šå‡ºç°è¿™æ¡æ•°æ® 2.å¯åŠ¨otteråŒæ­¥ 3.ä¿®æ”¹M1ä¸­åˆšæ‰æ’å…¥çš„æ•°æ®ï¼ŒM2ä¸­ä¸ä¼šå‡ºç°æ•°æ® è¿™ç§æƒ…å†µåº”è¯¥å¦‚ä½•è§£å†³ï¼Ÿ è°¢è°¢å„ä½äº† updateè½¬insertï¼Œå¯ä»¥å¼€å¯otterçš„è¡ŒåŒæ­¥æ¨¡å¼ æˆ‘åœ¨æµ‹è¯•çš„æ—¶å€™ç”¨çš„åŸºäºæ•°æ®åº“åæŸ¥å°±ä¸èƒ½å°±ä¼šå‡ºç°ä¸åŒæ­¥ï¼Œä»Šå¤©æˆ‘ä½¿ç”¨åŸºäºå½“å‰æ—¥å¿—å˜æ›´çš„æ—¶å€™èƒ½å¤ŸæˆåŠŸåŒæ­¥è¿‡æ¥ å°±æƒ³é—®ä¸‹æ•°æ®åº“åæŸ¥å’Œæ—¥å¿—å˜æ›´åœ¨ä½¿ç”¨ä¸Šåˆ†åˆ«çš„ç”¨é€”ï¼Ÿ 2016å¹´8æœˆ4æ—¥æ˜ŸæœŸå››ï¼Œagapple notifications@github.com å†™é“ï¼š > Closed #191 https://github.com/alibaba/canal/issues/191. >  > â€” > You are receiving this because you authored the thread. > Reply to this email directly  view it on GitHub > https://github.com/alibaba/canal/issues/191#event-744692264  or mute > the thread > https://github.com/notifications/unsubscribe-auth/ABGYwgeN6sXmAKefU3pKSRlCkO6zylPdks5qcUUXgaJpZM4JbtQ1 > . çœ‹åˆ°æ–‡æ¡£äº†ï¼Œå°±ä¸éº»çƒ¦ä½ äº†å“ˆï¼Œè°¢è°¢ 2016å¹´8æœˆ4æ—¥æ˜ŸæœŸå››ï¼Œåˆ˜æ¬¢ askingneil@gmail.com å†™é“ï¼š > æˆ‘åœ¨æµ‹è¯•çš„æ—¶å€™ç”¨çš„åŸºäºæ•°æ®åº“åæŸ¥å°±ä¸èƒ½å°±ä¼šå‡ºç°ä¸åŒæ­¥ï¼Œä»Šå¤©æˆ‘ä½¿ç”¨åŸºäºå½“å‰æ—¥å¿—å˜æ›´çš„æ—¶å€™èƒ½å¤ŸæˆåŠŸåŒæ­¥è¿‡æ¥ > å°±æƒ³é—®ä¸‹æ•°æ®åº“åæŸ¥å’Œæ—¥å¿—å˜æ›´åœ¨ä½¿ç”¨ä¸Šåˆ†åˆ«çš„ç”¨é€”ï¼Ÿ >  > 2016å¹´8æœˆ4æ—¥æ˜ŸæœŸå››ï¼Œagapple <notifications@github.com > <javascript:_e(%7B%7D 'cvml' 'notifications@github.com');>> å†™é“ï¼š >  > > Closed #191 https://github.com/alibaba/canal/issues/191. > >  > > â€” > > You are receiving this because you authored the thread. > > Reply to this email directly  view it on GitHub > > https://github.com/alibaba/canal/issues/191#event-744692264  or mute > > the thread > > https://github.com/notifications/unsubscribe-auth/ABGYwgeN6sXmAKefU3pKSRlCkO6zylPdks5qcUUXgaJpZM4JbtQ1 > > . 
190,qqç¾¤æ‹’ç»åŠ å…¥ï¼Œæ€ä¹ˆæ‰èƒ½åŠ å…¥qqç¾¤å‘¢ï¼Ÿ qqç¾¤è¿˜æœ‰ç©ºé—²åé¢ï¼Œé‡æ–°å°è¯•ä¸‹ qqç¾¤è¿˜å¯ä»¥åŠ äººå—ï¼Œæœ‰æ²¡æœ‰å…¶å®ƒçš„ç¾¤ qqç¾¤è¿˜æœ‰ç©ºé—²åé¢ï¼Œé‡æ–°å°è¯•ä¸‹ qqç¾¤å¯ä»¥åŠ å…¥å—ï¼Ÿ
189,canalçš„æ•°æ®åº“è¿æ¥ä¿¡æ¯ä¼šåœ¨otter-managerå†…è‡ªåŠ¨è§£æä¸ºipçš„é—®é¢˜ canalçš„æ•°æ®åº“è¿æ¥ä¿¡æ¯ä¼šåœ¨otter-managerå†…è‡ªåŠ¨è§£æä¸ºip ä½†æˆ‘ä»¬ç”¨çš„æœåŠ¡åŸŸåï¼Œä¼šä¸å®šæœŸæ›´æ–°ipï¼Œä¼šå¯¼è‡´canalè¿æ¥ä¸ä¸ŠmysqlæœåŠ¡ã€‚ è¯·é—®å¦‚ä½•è®©é…ç½®ä¸­ä¿æŒåŸŸåè€Œä¸æ˜¯è§£æä¸ºip. ç ”ç©¶ä¸€ä¸‹ï¼Œæäº¤ä¸€ä¸ªPRç»™æˆ‘å§ è¿™ä¸ªé—®é¢˜æˆ‘ä»¬ä¹Ÿé‡åˆ°äº†ï¼Œæˆ‘ä»¬é€šè¿‡é…ç½®vpnè§£å†³çš„ èƒ½è¯´ä¸‹é…ç½®vpnå¦‚ä½•è§£å†³otter-manageræŠŠåŸŸåè§£ææˆIPçš„é—®é¢˜å—ï¼Ÿ https://github.com/alibaba/otter/issues/172  fixäº† 
188,mysqlé•¿æ—¶é—´æ²¡æ•°æ®ï¼Œå¯èƒ½å¯¼è‡´canalä¸mysqlçš„è¿æ¥è¯»æ“ä½œæ°¸è¿œé˜»å¡ canalä»mysqlè¯»binlogäº‹ä»¶æ—¶ï¼Œå»ºçš„è¿æ¥è®¾ç½®äº†è¯»è¶…æ—¶æ—¶é—´ï¼š        channel.socket().setSoTimeout(this.soTimeout);  ï¼ŒsoTimeoutç”¨äº†30sã€‚ è¯»binlogäº‹ä»¶æ—¶ï¼Œç”¨äº†SocketChannel.read(buffer)æ–¹æ³•ï¼ŒsoTimeoutå¯¹è¿™ä¸ªSocketChannelçš„readæ–¹æ³•æ— æ•ˆï¼Œæ°¸è¿œä¸ä¼šè¶…æ—¶ï¼Œå‚è€ƒhttp://bugs.java.com/bugdatabase/view_bug.do?bug_id=4614802ã€‚ å¦‚æœmysqlæœ‰ä¸€æ®µæ—¶é—´æ²¡æ•°æ®ï¼ˆæ¯”å¦‚ä¸€ä¸ªå°æ—¶ï¼‰ï¼Œè¿™ä¸ªè¿æ¥å¤±æ•ˆäº†ï¼ˆå¯èƒ½å› ä¸ºé˜²ç«å¢™é—®é¢˜ï¼Œå‚è€ƒhttp://www.tldp.org/HOWTO/TCP-Keepalive-HOWTO/overview.htmlçš„2.4.  è™½ç„¶è®¾ç½®äº†channel.socket().setKeepAlive(true)ï¼Œä½†æ˜¯linuxç³»ç»Ÿé»˜è®¤çš„keepaliveé…ç½®æ—¶é—´å¤ªé•¿ã€ä¸èµ·ä½œç”¨ã€‚ï¼‰ï¼Œä½†canalè¿˜åœ¨æ°¸è¿œé˜»å¡readã€‚ æ‰€ä»¥æ˜¯ä¸æ˜¯ç”¨sock.socket().getInputStream()è¿™ä¸ªæ¥readæ¯”è¾ƒå¥½ï¼Œå¦‚æœåœ¨soTimeoutå†…æ²¡è¯»åˆ°æ•°æ®ï¼Œå°±è¶…æ—¶äº†ï¼Œå¼ºåˆ¶é‡æ–°å»ºç«‹è¿æ¥ã€‚ ç›®å‰è®¾è®¡æ—¶ä¾èµ–äºMySQLæ•°æ®åº“çš„ç©ºé—²é“¾æ¥è¶…æ—¶æœºåˆ¶ï¼Œé»˜è®¤æ˜¯8å°æ—¶ä¼šæ–­å¼€é“¾æ¥ï¼Œä½ çš„é“¾æ¥å¤±æ•ˆæ˜¯æŒ‡åŠå¼€é“¾æ¥ä¹ˆï¼Ÿè¿™ä¸ªå®¢æˆ·ç«¯èƒ½è·å–åˆ°EOFException è¿™ä¸ªé—®é¢˜åœ¨æˆ‘è‡ªå·±çš„æµ‹è¯•ç¯å¢ƒä¸­å¾ˆå®¹æ˜“é‡ç°ï¼Œmysqlç‰ˆæœ¬:5.5.14 wait_timeoutè®¾ä¸º8å°æ—¶ï¼Œcanalç‰ˆæœ¬1.0.22ï¼Œå¦‚æœmysqlåŠä¸ªå°æ—¶æ— æ•°æ®æ›´æ–°ï¼Œcanalå°±æ— æ³•è¯»å–æ–°çš„bin-logï¼Œé‡å¯canalServeråå°±æ­£å¸¸äº†ã€‚éš¾é“è·Ÿæ•°æ®åº“çš„é…ç½®æœ‰å…³ç³»ï¼Œè¿˜æ˜¯å…¶ä»–åŸå› ï¼ŸæœŸæœ›èƒ½å¾—åˆ°æŒ‡å¯¼ã€‚ PSï¼šCanalServeræ²¡æœ‰ä»»ä½•çš„é”™è¯¯æ—¥å¿—ï¼Œä¸å¥½åˆ†æé—®é¢˜ã€‚ã€‚ã€‚ æš‚æ—¶æ€§è§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥å¼€å¯ä¸‹å¿ƒè·³SQL. è¿™é—®é¢˜è¿˜çœŸæ²¡é‡åˆ°è¿‡ mysqlçš„slaveè¿æ¥masterè¯»æ•°æ®çš„é»˜è®¤è¶…æ—¶æ—¶é—´ï¼ˆslave_net_timeoutï¼‰æ˜¯3600sï¼ˆæ—¶é—´å¤ªé•¿ï¼‰ï¼Œè¶…æ—¶åé‡å»ºè¿æ¥ï¼Œå‚è€ƒhttp://dev.mysql.com/doc/refman/5.6/en/replication-options-slave.html#sysvar_slave_net_timeout mysql5.5åå¥½åƒå¼•å…¥äº†master/slaveä¹‹é—´çš„heartbeat binlog eventï¼Œmasteræ²¡binlog eventç©ºé—²ä¸€æ®µæ—¶é—´åï¼ˆè¶…è¿‡MASTER_HEARTBEAT_PERIODï¼‰å°±å‘é€ç»™slave heartbeatäº‹ä»¶ã€‚å‚è€ƒï¼š https://www.percona.com/blog/2011/12/29/actively-monitoring-replication-connectivity-with-mysqls-heartbeat/ http://dev.mysql.com/doc/refman/5.6/en/change-master-to.htmlé‡Œçš„MASTER_HEARTBEAT_PERIOD MASTER_HEARTBEAT_PERIODçš„é»˜è®¤é…ç½®æ˜¯slave_net_timeout/2ï¼Œé»˜è®¤æ˜¯1800sï¼Œæ—¶é—´éƒ½å¤ªé•¿äº†ã€‚ @tianshazzq å¯ä»¥æµ‹è¯•ä¸‹è¿™äº›å‚æ•°è¯•è¯•ã€‚ canalç¨‹åºæƒ³è¦æ”¯æŒé»˜è®¤é…ç½®ã€ä¸å‡ºé—®é¢˜ï¼Œæœ€å¥½è¿˜æ˜¯åƒå¼€å¤´è¯´çš„é‚£æ ·è‡ªå·±æ§åˆ¶è¶…æ—¶æ—¶é—´ã€è¿æ¥ç©ºé—²ä¸€æ®µæ—¶é—´ï¼ˆæ¯”å¦‚æœ€å¤š1minï¼Ÿï¼‰åé‡æ–°å»ºè¿æ¥ã€‚ mysqlä¸canl-serverçš„tcpè¿æ¥é—ªæ–­ï¼Œcanl-serverå¹¶ä¸çŸ¥æƒ…ï¼Œå¯¼è‡´åç»­çš„binlogæ— æ³•é€šçŸ¥åˆ°canal-serverï¼Œè¿™ä¸ªæ€ä¹ˆç ´ï¼Ÿ å»ºè®®å¼€å¯canalå¿ƒè·³è®¾ç½®ï¼Œä¼šå®šæ—¶æ›´æ–°æ•°æ®åº“æ¥äº§ç”Ÿå¿ƒè·³binlogï¼Œå¦‚æœæŒ‡å®šæ—¶é—´æ²¡æ”¶åˆ°å¿ƒè·³ä¿¡æ¯å¯ä»¥å°è¯•é‡å»ºé“¾æ¥ mysqlåˆ°canalçš„è¿æ¥å¼‚å¸¸äº†ï¼Œæ¯”å¦‚mysqlå®•æœºè¿™ç§æƒ…å†µï¼Œcanalæ˜¯è¢«åŠ¨æ¥æ”¶æ•°æ®çš„ï¼Œè‡ªç„¶æ˜¯ä¸ä¼šçŸ¥é“ä»»ä½•é“¾è·¯æ˜¯å¦æ­£å¸¸çš„çŠ¶æ€ï¼›å…³é”®æ˜¯canalæ˜¯å¦å®ç°äº†ç©ºé—²åæœ‰æ— é‡è¿çš„æœºåˆ¶æˆ–è€…mysqlå¼‚å¸¸é‡è¿ï¼Ÿå¦‚è‹¥å®ç°äº†é…ç½®å“ªä¸ªå‚æ•°ï¼Ÿ canalåŸºäºè¢«åŠ¨ç›‘å¬å¼çš„æ˜¯æ²¡æ³•æ„ŸçŸ¥socketè¢«serveræ–­å¼€çš„ï¼Œæœ€é‡è¦è¿˜æ˜¯å¼€å¯å¿ƒè·³binlogï¼Œæˆ–è€…å‡çº§mysql5.6(mysqlé’ˆå¯¹ç©ºé—²é“¾æ¥ä¼šå®šæ—¶å‘é€å¿ƒè·³binlogäº‹ä»¶æ¥ç»´æŒtcpé“¾æ¥) åœ¨Mysqlå®•æœºåé‡å¯è¿™ç§æƒ…å†µä¸‹é¢çš„ï¼Œå¼€å¯å¿ƒè·³æ²¡ä»€ä¹ˆç”¨å§ï¼Ÿæˆ‘ä»¬éœ€è¦åœ¨canalä¸­å®ç°mysqlè¿™ä¸ªå‚æ•°slave_net_timeoutæ‰€éœ€è¦å®ç°çš„åŠŸèƒ½ã€‚ @agapple  æŠŠæ•°æ®åº“æ–­å¼€æ—¶é—´æ”¹æˆäº†2åˆ†é’Ÿï¼Œå¹¶ä¸”å¼€å¯äº†å¿ƒè·³æ£€æŸ¥ã€‚é•¿æ—¶é—´ï¼ˆ2åˆ†é’Ÿä»¥ä¸Šï¼‰æ²¡æœ‰æ•°æ®åæ–°æ’å…¥æ•°æ®ï¼Œcanal serverä¼šè·å–ä¸åˆ° ï¼ˆè¿‡ä¸å®šæ—¶é—´åcanal serveråˆèƒ½è·å–åˆ°æ•°æ®10~30åˆ†é’Ÿä¸ç­‰ï¼‰ã€‚debugçœ‹å¿ƒè·³æ•°æ®éƒ½æ˜¯èƒ½æ­£å¸¸æ”¶å‘ã€‚æ—¥å¿—é‡Œæ²¡æœ‰ä»»ä½•å¼‚å¸¸è¾“å‡º ## detecing config canal.instance.detecting.enable = true #canal.instance.detecting.sql = insert into retl.xdual values(1 now()) on duplicate key update x=now() canal.instance.detecting.sql = select 1 canal.instance.detecting.interval.time = 3 canal.instance.detecting.retry.threshold = 3 canal.instance.detecting.heartbeatHaEnable = false mysqlä¸canl-serverçš„tcpè¿æ¥é—ªæ–­ï¼Œcanl-serverå¹¶ä¸çŸ¥æƒ…ï¼Œå¯¼è‡´åç»­çš„binlogæ— æ³•é€šçŸ¥åˆ°canal-serverï¼Œè¿™ä¸ªæ€ä¹ˆç ´ï¼Ÿ --------------------------------------------------------------------------------------------------- è¿™ä¸ªé—®é¢˜ä½ æ€ä¹ˆè§£å†³çš„ï¼Œæˆ‘ç°åœ¨ä¹Ÿé‡åˆ°äº†è¿™ä¸ªé—®é¢˜ @githubcjh  åˆšåˆšè¸©åˆ°ä¸€ä¸ªå‘ï¼Œcanal.instance.memory.buffer.sizeè®¾ç½®è¿‡å°ï¼Œå¯¼è‡´ä¸»åº“æ‰§è¡Œå¤§äº‹åŠ¡æ—¶ï¼Œcanalå µä½ buffer.sizeå»ºè®®è®¾ç½®>1024 ç¡®å®æœ‰è¿™ä¸ªé—®é¢˜ï¼Œä¸çŸ¥é“æ¥¼ä¸»è§£å†³äº†è¿™ä¸ªé—®é¢˜ä¹ˆï¼Ÿ æ”¹ä¸ºinputstreamæ˜¯å¯ä»¥çš„ï¼Œsotimeoutç”Ÿæ•ˆäº†ï¼Œä½†æ˜¯é•¿æ—¶é—´æ²¡æœ‰æ•°æ®ï¼Œinputstream é˜»å¡åœ¨readé‚£é‡Œæ—¶ä¸ä¼šå“åº”thread.interrupt()ï¼Œevent parseré‚£é‡Œéœ€è¦åšä¸€äº›æ”¹åŠ¨å…ˆclose socketå†è°ƒç”¨thread.interrupt() ä½†æ˜¯æ€»æ„Ÿè§‰è¿™ä¸ªæ–¹æ³•å’Œcanalçš„nioè®¾è®¡æœ‰äº›çŸ›ç›¾ã€‚ä½†æ˜¯é—®é¢˜æ˜¯ç°å®å­˜åœ¨çš„ã€‚è™½ç„¶æ˜¯nioä½†æ˜¯è¯»çš„æ—¶å€™ç”¨çš„æ˜¯é˜»å¡çš„æ¨¡å¼  buffer sizeèƒ½è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿï¼Ÿ è§£å†³æ–¹æ¡ˆå°±æ˜¯åœ¨è¯»å–mysql binlogå˜æ›´çš„åœ°æ–¹åŠ ä¸ªè¶…æ—¶å°±å¥½ï¼Œä¸ç„¶å°±åªèƒ½ä¾èµ–tcpçš„keepliveæœºåˆ¶ï¼›æˆ‘ä¸å¤ªæ‡‚javaï¼Œå·²ç»æ²¡ç”¨è¿™ä¸€å¥—äº†ï¼Œè‡ªå·±å¼€å‘äº†ä¸€å¥—ã€‚ SocketChannel.read(buffer)æ­¤æ–¹æ³•çš„ç¡®ä¸ä¼šæŠ¥è¶…æ—¶å¼‚å¸¸ï¼ˆ[https://stackoverflow.com/questions/2866557/timeout-for-socketchannel-doesnt-work#answer-9150513](https://stackoverflow.com/questions/2866557/timeout-for-socketchannel-doesnt-work#answer-9150513)ï¼‰ï¼Œç›®å‰æœ¬äººä½¿ç”¨1.0.24ç‰ˆæœ¬ï¼Œæš‚æ—¶å°†DirectLogFetcherä½¿ç”¨çš„SocketChannelè½¬ä¸ºReadableByteChannelï¼Œå¯ä½¿socket timeout ç”Ÿæ•ˆï¼ŒæŠ›å‡ºSocketTimeoutExceptionã€‚ @vamdt [BioSocketChannelPool.java](https://github.com/alibaba/canal/blob/master/driver/src/main/java/com/alibaba/otter/canal/parse/driver/mysql/socket/BioSocketChannelPool.java)ï¼ŒåŸºäºåŸç”ŸSocketæ“ä½œï¼ŒsoTimeoutå‚æ•°éªŒè¯ä¹Ÿå¯ä»¥ç”Ÿæ•ˆ @agapple OKï¼Œæš‚æ—¶ä½¿ç”¨ä½“éªŒä¸Šæ„Ÿè§‰1.0.24æ›´ç¨³ï¼Œç­‰1.0.26æ­£å¼å‘å¸ƒå†è¯•è¯•çœ‹BIOçš„ã€‚ æ¨èv1.1.1ç‰ˆæœ¬ï¼ŒåŸºäºåŸç”ŸSocketçš„bioæ“ä½œï¼Œå¢åŠ äº†è¶…æ—¶é‡è¿æœºåˆ¶
187,æ”¯æŒä¸‹mysql5.7 jsonç±»å‹è§£æ RT. æ”¯æŒä¸‹mysql5.7 æµ‹è¯•æ•°æ®æ ¼å¼: ``` +-----+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+ | uid | data                                                                                                                                                            | +-----+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+ |   1 | {"mail": "jiangchengyao@gmail.com"  "name": "David"  "address": "Shangahai"}                                                                                    | |   2 | {"mail": "test"}                                                                                                                                                | |   3 | {"int": 1  "bool": true  "long1": 4294967296  "long2": 1.8446744073709552e19  "double": 1.11012}                                                                | |   4 | {"mail": [1  true  1.11012  4294967296  1.8446744073709552e19]}                                                                                                 | |   5 | {"int": 1  "bool": true  "mail": [1  true  1.11012  4294967296  1.8446744073709552e19]  "long1": 4294967296  "long2": 1.8446744073709552e19  "double": 1.11012} | |   6 | {"time": "23:59:59"}                                                                                                                                            | |   7 | {"time": "2016-06-30 15:03:32.000000"}                                                                                                                          | |   8 | {"time": "2016-06-30 15:51:25.041000"}                                                                                                                          | |   9 | {"time": 123.123}                                                                                                                                               | |  10 | {"time": "23:23:23:19"}                                                                                                                                         | |  11 | {"time": "01:00:05.000000"}                                                                                                                                     | |  12 | {"time": "630:19:29.000000"}                                                                                                                                    | |  13 | {"time": "2016-06-30 16:08:58.000000"}                                                                                                                          | |  14 | {"n1": "v1"  "ne1": {"n2": "v2"  "ne2": {"n3": "v3"  "n32": ["v32"  "v33"  1]}}}                                                                                | +-----+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+ ``` æœ‰ä¸ªbugåœ¨1.0.23ä¸‹ `com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: java.lang.IllegalArgumentException: illegal json data 	at com.taobao.tddl.dbsync.binlog.JsonConversion.parse_scalar(JsonConversion.java:150) 	at com.taobao.tddl.dbsync.binlog.JsonConversion.parse_value(JsonConversion.java:67)` æ•°æ®åº“ç‰ˆæœ¬  mysql-5.7.11-winx64 æ•°æ®åº“ç»“æ„ CREATE TABLE `customer_data` (   `id` bigint(19) unsigned NOT NULL AUTO_INCREMENT   `supplier_id` bigint(19) unsigned NOT NULL COMMENT 'å•†æˆ·id'   `customer_id` bigint(19) unsigned NOT NULL   `customer_data` json DEFAULT NULL COMMENT 'é¡¾å®¢æ ‡å‡†å±æ€§'   `customer_ext_data` json DEFAULT NULL COMMENT 'é¡¾å®¢æ‰©å±•å±æ€§'   PRIMARY KEY (`id`)   UNIQUE KEY `uk_cust` (`customer_id`) ) ENGINE=InnoDB AUTO_INCREMENT=26036 DEFAULT CHARSET=utf8mb4; debugåå°±æ˜¯149è¡Œstr_len==0  @agapple  ç»™å‡ºä½ æµ‹è¯•çš„jsonå­—ç¬¦ä¸²
186,ack é”™è¯¯äº† 2016-06-06 19:07:07.416 [New I/O server worker #1-25] ERROR com.alibaba.otter.canal.server.netty.NettyUtils - ErrotCode:400   Caused by :  something goes wrong with channel:[id: 0x4d32397e  /10.252.158.196:53393 => /10.1.7.109:9930]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: ack error   clientId:1001 batchId:85 is not exist   please check 2016-06-06 19:07:07.418 [New I/O server worker #1-25] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x4d32397e  /10.252.158.196:53393 :> /10.1.7.109:9930]  exception=java.nio.channels.ClosedChannelException     at org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:643)     at org.jboss.netty.channel.socket.nio.NioWorker.writeFromUserCode(NioWorker.java:370)     at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:137)     at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76)     at org.jboss.netty.channel.Channels.write(Channels.java:611)     at org.jboss.netty.channel.Channels.write(Channels.java:578)     at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:28)     at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:144)     at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48)     at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:275)     at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302)     at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndFireMessageReceived(ReplayingDecoder.java:525)     at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:506)     at org.jboss.netty.handler.codec.replay.ReplayingDecoder.cleanup(ReplayingDecoder.java:541)     at org.jboss.netty.handler.codec.replay.ReplayingDecoder.channelDisconnected(ReplayingDecoder.java:449)     at org.jboss.netty.channel.Channels.fireChannelDisconnected(Channels.java:360)     at org.jboss.netty.channel.socket.nio.NioWorker.close(NioWorker.java:593)     at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:119)     at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76)     at org.jboss.netty.channel.Channels.close(Channels.java:720)     at org.jboss.netty.channel.AbstractChannel.close(AbstractChannel.java:200)     at org.jboss.netty.channel.ChannelFutureListener$1.operationComplete(ChannelFutureListener.java:46)     at org.jboss.netty.channel.DefaultChannelFuture.notifyListener(DefaultChannelFuture.java:381)     at org.jboss.netty.channel.DefaultChannelFuture.addListener(DefaultChannelFuture.java:148)     at com.alibaba.otter.canal.server.netty.NettyUtils.write(NettyUtils.java:30)     at com.alibaba.otter.canal.server.netty.NettyUtils.error(NettyUtils.java:51)     at com.alibaba.otter.canal.server.netty.handler.SessionHandler.messageReceived(SessionHandler.java:200)     at org.jboss.netty.handler.timeout.IdleStateAwareChannelHandler.handleUpstream(IdleStateAwareChannelHandler.java:48)     at org.jboss.netty.handler.timeout.IdleStateHandler.messageReceived(IdleStateHandler.java:275)     at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302)     at org.jboss.netty.handler.codec.replay.ReplayingDecoder.unfoldAndFireMessageReceived(ReplayingDecoder.java:525)     at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:506)     at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:443)     at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274)     at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261)     at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:349)     at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:280)     at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:200)     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)     at java.lang.Thread.run(Thread.java:744) æˆ‘ä¹Ÿé‡åˆ°è¿‡è¿™ä¸ªé—®é¢˜ï¼Œæ˜¯å¤šæ¶ˆè´¹éƒ½æ˜¯æ¶ˆè´¹canalæ—¶æŠ¥çš„é”™ï¼Œä½ é‚£è¾¹æ˜¯å•¥æƒ…å†µäº§ç”Ÿçš„ï¼Ÿ æ£€æŸ¥ä¸€ä¸‹serverç«¯ï¼Œæ˜¯å¦å‘ç”Ÿäº†instanceé‡å¯
185,canal.instance.filter.regexæ— æ³•è¿‡æ»¤db 
184,åˆ é™¤è¡¨çš„é—®é¢˜ åœ¨é‡åˆ°è¡¨åˆ é™¤åä¼šæœ‰è¿™ç§æƒ…å†µ Caused by: java.io.IOException: ErrorPacket [errorNumber=1146  fieldCount=-1  message=Table 'secooOrderWriter1DB.t_increment_sequence_bak' doesn't exist  sqlState=42S02  sqlStateMarker=#]  with command: desc `orderDB`.`t_increment_sequence_bak`     at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.query(MysqlQueryExecutor.java:60) ~[canal.parse.driver-1.0.21.jar:na]     at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:69) ~[canal.parse-1.0.21.jar:na]     at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.getTableMeta0(TableMetaCache.java:97) ~[canal.parse-1.0.21.jar:na]     at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache.access$000(TableMetaCache.java:26) ~[canal.parse-1.0.21.jar:na]     at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.apply(TableMetaCache.java:50) ~[canal.parse-1.0.21.jar:na]     at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.TableMetaCache$1.apply(TableMetaCache.java:41) ~[canal.parse-1.0.21.jar:na] ç¿»ä¸€ä¸‹å†å²çš„issueï¼Œä¸å»ºè®®åšæœ‰åˆ é™¤æ€§è´¨çš„DDLæ“ä½œï¼ŒåŒ…æ‹¬åˆ è¡¨ï¼Œåˆ å­—æ®µç­‰ å·²çŸ¥é—®é¢˜ï¼ŒFAQé‡Œæœ‰æ˜ç¡®å»ºè®® 
183,å…³äºcanalå¯¹äºstatement æ ¼å¼æ—¥å¿—çš„è§£æ è¯·é—®ä¸‹canal  æœ‰å¯ä»¥è§£æstatementæ ¼å¼æ—¥å¿—çš„æ–¹æ³•å’Œç±»å—ï¼Ÿç±»ä¼¼å¯¹rowæ—¥å¿—çš„è§£æï¼Œå¯ä»¥è§£æå‡ºæ•°æ®åº“åç§°ï¼Œè¡¨åï¼Œæ“ä½œç±»å‹â€¦â€¦è€Œä¸æ˜¯ä¸€æ¡å•çº¯çš„sql è¯­å¥ å¯ä»¥è‡ªè¡Œä¾èµ–sqlè§£æå™¨ï¼Œå¯¹äºè¾“å‡ºçš„å†…å®¹è¿›è¡Œè§£æï¼Œå¾—åˆ°ä½ æƒ³è¦çš„ç»“æœ 
182,å…³äºMIXEDæ—¥å¿—æ ¼å¼æ•°æ®è·å– 
181,Clientè¿æ¥é—®é¢˜ SimpleCanalConnector.java doConnect()æ–¹æ³•è°ƒç”¨çš„readNextPacket() int bodyLen = readHeader.getInt(0); bodyLen çš„å€¼1308622848 è¿™ä¸ªæ•°æ€ä¹ˆè¯»å‡ºè¿™ä¹ˆå¤§ã€‚ç„¶åå°±å†…å­˜æº¢å‡ºäº† è¿™åº”è¯¥æ˜¯å¼‚å¸¸æ•°æ®æµ å»ºè®®å…ˆå¢åŠ å®¢æˆ·ç«¯é‡è¯•æˆ–è€…HAæœºåˆ¶ä¿è¯ï¼Œå¦‚æœ‰æ–°çš„ä¿¡æ¯å†reopen issue 
180,CanalConnectors.newClusterConnector zk failoveré—®é¢˜ CanalConnectors.newClusterConnector ç”¨zkçš„æ—¶å€™æŠ¥è¿™ä¸ªé”™è¯¯ new ClusterNodeAccessStrategy() çš„æ—¶å€™clusterPathæ²¡æœ‰create zkClient.getChildrenè¿™ä¸ªæ–¹æ³•æŠ¥é”™ Exception in thread "main" org.I0Itec.zkclient.exception.ZkNoNodeException: org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /otter/canal/destinations/192.168.2.2:3306/cluster     at org.I0Itec.zkclient.exception.ZkException.create(ZkException.java:47)     at org.I0Itec.zkclient.ZkClient.retryUntilConnected(ZkClient.java:685)     at org.I0Itec.zkclient.ZkClient.getChildren(ZkClient.java:413)     at org.I0Itec.zkclient.ZkClient.getChildren(ZkClient.java:409)     at com.alibaba.otter.canal.client.impl.ClusterNodeAccessStrategy.<init>(ClusterNodeAccessStrategy.java:58)     at com.alibaba.otter.canal.client.CanalConnectors.newClusterConnector(CanalConnectors.java:69)     at com.alibaba.otter.canal.example.ClusterCanalClientTest.main(ClusterCanalClientTest.java:31) æœåŠ¡ç«¯æœ‰æ²¡å¯åŠ¨ï¼Ÿ 
179,è¯·é—®ç›®å‰çš„ç‰ˆæœ¬æ”¯æŒmysql5.7å—? è¯·é—®ç›®å‰çš„ç‰ˆæœ¬æ”¯æŒmysql5.7å—? æ²¡åšè¿‡æµ‹è¯•ï¼Œç¾¤é‡Œæœ‰äººåšè¿‡ç±»ä¼¼æµ‹è¯•ï¼Œå¯è¯¢é—® æˆ‘æµ‹è¯•äº†ä¸€ä¸‹ï¼Œæ²¡é‡åˆ°ä»€ä¹ˆç‰¹åˆ«çš„é—®é¢˜ã€‚ 
178,å…³äºæŒä¹…åŒ–åˆ°æ–‡ä»¶æˆ–ZKçš„æ—¶é—´é—´éš”é—®é¢˜ æˆ‘è¿™è¾¹æµ‹è¯•ï¼Œå‘ç°å¦‚æœå°†canal.zookeeper.flush.periodæˆ–è€…canal.file.flush.periodè¿™ä¸¤ä¸ªæ—¶é—´é—´éš”è®¾ä¹…ä¸€ç‚¹ï¼Œç”±äºClientçš„cursorä¿¡æ¯è¿˜åœ¨å†…å­˜ä¸­æ²¡æœ‰æŒä¹…åŒ–åˆ°æ–‡ä»¶æˆ–è€…ZKï¼Œé‚£ä¹ˆé‡å¯Canalæˆ–è€…HAåˆ‡æ¢è‡³å¦ä¸€ä¸ªèŠ‚ç‚¹ä¼šæ”¶åˆ°é‡å¤æ•°æ®ã€‚æˆ‘æƒ³é—®çš„æ˜¯ï¼Œç›´è¿Canalï¼Œæ˜¯å¦å®¢æˆ·ç«¯è¦è‡ªå·±åšæ¶ˆæ¯å»é‡çš„é€»è¾‘ï¼Ÿæˆ‘ç›®å‰æƒ³åˆ°çš„æ˜¯æ ¹æ®binlogçš„positionï¼Ÿ æ˜¯çš„ï¼Œä¼šæœ‰é‡å¤ï¼Œå»é‡çš„æ€è·¯åŸºæœ¬æ­£ç¡® 
177,RDSä¸»ä»åº“åˆ‡æ¢æ—¶å€™å¼‚å¸¸å¤„ç† ä¿®æ”¹æ–¹æ¡ˆï¼š 1ã€å½“å‡ºç°IOExceptionæ—¶retryæŒ‡å®šæ¬¡æ•°ã€‚è¶…è¿‡æ¬¡æ•°æ—¶è·å–å½“å‰æœ€æ–°çš„ä½ç‚¹ï¼Œé‡æ–°è¿æ¥ã€‚ 2ã€é”™è¯¯æ—¥å¿—è¾“å‡ºå’ŒæŠ¥è­¦è¾“å‡º(å»ºè®®ä»¥åå¯ä»¥å®ç°é‚®ä»¶é¢„è­¦) [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=177) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=177) before we can accept your contribution.<br/><hr/>**Yishun.Chen** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account  please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user). tks    å…ˆåˆå¹¶äº†PRï¼Œéœ€è¦åšä¸€äº›å¾®è°ƒï¼Œæ¯”å¦‚ç²¾ç¡®è¯†åˆ«binlogä½ç‚¹ä¸å­˜åœ¨çš„å¼‚å¸¸ 
176,å®¢æˆ·ç«¯é«˜å¯ç”¨ä¸»åŠ¨å¹²é¢„zookeeperçš„runningä¼šå¯¼è‡´é“¾æ¥æœªå…³é—­ æ‰‹å·¥ç™»é™†zookeeperï¼Œdeleteå½“å‰clientçš„runningèŠ‚ç‚¹ï¼Œä¼šè§¦å‘ä¸€æ¬¡å®¢æˆ·ç«¯çš„é«˜å¯ç”¨ï¼Œä¸Šä¸€æ¬¡è¿è¡Œçš„èŠ‚ç‚¹ä¼šæœ‰ä¼˜å…ˆé€‰æ‹©æƒ.  ä½†ä¸Šä¸€æ¬¡è¿è¡Œçš„èŠ‚ç‚¹ï¼Œæ²¡æœ‰åŠæ—¶å…³é—­ä¸Šä¸€æ¬¡æ‰“å¼€çš„socketé“¾æ¥.  è§¦å‘æ¡ä»¶ï¼šéæ­£å¸¸çš„runningèŠ‚ç‚¹å¹²é¢„ï¼Œå¦‚æœzookeeperå‡ºç°ç½‘ç»œæŠ–åŠ¨å¼•èµ·çš„runningèŠ‚ç‚¹æ¶ˆå¤±ï¼Œç†è®ºä¸Šclientçš„ç½‘ç»œåº”è¯¥æ•´ä½“éƒ½æœ‰é—®é¢˜ï¼Œä¼šå’Œcanal serverä¹Ÿæ–­å¼€é“¾æ¥.  è§£å†³ï¼šå‘ç°runningèŠ‚ç‚¹æ¶ˆå¤±ï¼Œå…ˆæ‰§è¡Œä»¥ä¸‹æœ¬åœ°å…³é—­socketé“¾æ¥çš„æ“ä½œï¼Œç½‘ç»œæŠ–åŠ¨æ—¶å¼•èµ·çš„é¿å…socketæ³„æ¼.  
175,file-instance.xmlé…ç½®æ¨¡å¼ä¸‹ï¼Œè®¾ç½®çš„tableè¿‡æ»¤ä¸èµ·ä½œç”¨ï¼Ÿ 1. åœ¨example instanceä¸­é…ç½®    `# table regex    canal.instance.filter.regex = canal\\.ad.*`  debugè°ƒè¯•å‘ç°å˜é‡ç¡®å®è¢«è®¾ç½®è¿›äº†instanceå®ä¾‹çš„eventParser.eventFilteré‡Œé¢äº† 2. åˆ›å»ºclientè¿›è¡Œæ•°æ®è¯·æ±‚ 3. ä¿®æ”¹æ•°æ®åº“canalä¸‹é¢çš„adviceè¡¨ï¼Œclientå¯ä»¥æ”¶åˆ°å¯¹åº”çš„message. 4. ä¿®æ”¹æ•°æ®åº“testä¸‹é¢çš„adviceè¡¨ï¼ŒclientåŒæ ·å¯ä»¥æ”¶åˆ°å¯¹åº”çš„message.    æ³¨: ä¸¤ä¸ªæ•°æ®åº“éƒ½æ˜¯åˆ›å»ºåœ¨æœ¬åœ°çš„ 1. ç¡®è®¤è®¾ç½®äº†rowæ¨¡å¼ 2. filteræ¡ä»¶åªé’ˆå¯¹rowæ•°æ®æœ‰æ•ˆï¼Œå…¶ä½™çš„queryæŸ¥è¯¢ä¸ä¼šè¿›è¡Œè¿‡æ»¤ æˆ‘åœ¨å¯¹é¡¹ç›®æœ¬èº«çš„ deployer.CanalLuncherè¿›è¡Œdebugçš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨å¯åŠ¨canal serveré™„å±çš„EventParseræœåŠ¡æ—¶ï¼Œå…³äºtableè¿‡æ»¤çš„è¡¨è¾¾å¼è¿˜æ˜¯æ­£ç¡®çš„ï¼Œä½†æ˜¯åœ¨å¤„ç†è¿‡æ»¤ä¸šåŠ¡çš„çº¿ç¨‹ä¸­ä¼šå‘ç°è¡¨è¾¾å¼patternè¢«æ”¹å˜äº†ï¼Œä¸‹é¢æ˜¯æˆ‘çš„è°ƒè¯•è¿‡ç¨‹ï¼Œéº»çƒ¦è¯·çœ‹ä¸€ä¸‹ 1. åˆå§‹EventParserå¹¶å¯åŠ¨    ![qq 20160509143520](https://cloud.githubusercontent.com/assets/5526657/15105668/0aa5d130-15f6-11e6-8007-b427efec5baf.png) 2. æ„é€ Erosaè¿æ¥ä¹‹å‰    ![qq 20160509143526](https://cloud.githubusercontent.com/assets/5526657/15105742/ce1a585c-15f6-11e6-8407-a71284ce097c.png) 3. æ„é€ Erosaè¿æ¥ä¹‹å    ![qq 20160509145114](https://cloud.githubusercontent.com/assets/5526657/15105758/dbd62980-15f6-11e6-8335-25b6dea0f4f2.png) clientçš„subscribeä¼ å…¥çš„è¿‡æ»¤æ¡ä»¶ä¼˜å…ˆçº§æœ€é«˜ï¼Œä¼šå¿½ç•¥æ‰æœåŠ¡ç«¯çš„è®¾ç½® @agapple ä½†æ˜¯æˆ‘æƒ³ç”¨æœåŠ¡å™¨ç«¯çš„è®¾ç½®ï¼Œå¦‚æœæˆ‘ä¸å†™subscribeåœ¨ç¨‹åºä¸­å°±æŠ¥é”™ï¼Œå†™äº†å°±æŠŠserverç«¯çš„regexè¦†ç›–ï¼Œè¿™å¯å¦‚ä½•æ˜¯å¥½å•Šï¼Œæˆ‘å°±æ˜¯æƒ³ç”¨instanceä¸­çš„å†…å®¹ é‚£ä½ clientçš„subscribeå°±ä¼ ä¸€ä¸ªç©ºå€¼å°±å¥½
174,Canal é€‰ç”¨group-instance æ¨¡å¼çš„è¯ï¼Œæ€ä¹ˆé…ç½®destination nameå‘¢ï¼Ÿ æ€ä¹ˆé…ç½®é€»è¾‘ä¸Šçš„æŠŠå¤šä¸ªinstanceèåˆåçš„æ€»å¾—destination nameå—ï¼Ÿ çœ‹ä¸€ä¸‹group-instance.xmlé…ç½®ç¤ºä¾‹ é¡¹ç›®ç»™çš„exampleä¸­æ˜¯é…ç½®file-instance.xmlåšçš„ç¤ºä¾‹ï¼Œéº»çƒ¦å¯ä»¥ç»™ä¸‹group-instance.xmlé…ç½®ç¤ºä¾‹çš„åœ°å€å—ï¼Ÿ https://raw.githubusercontent.com/alibaba/canal/master/deployer/src/main/resources/spring/group-instance.xml 
173,Canalå®¢æˆ·ç«¯é«˜å¯ç”¨bugä¿®å¤ RequeståŸå› è¯·å‚è§issue https://github.com/alibaba/canal/issues/171  [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=173) <br/>Thank you for your submission  we really appreciate it. Like many open source projects  we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/alibaba/canal?pullRequest=173) before we can accept your contribution.<br/> https://github.com/alibaba/canal/issues/171 tks   åé¢æˆ‘è°ƒæ•´äº†ä¸‹éƒ¨åˆ†ä»£ç ï¼Œä¸»è¦æ˜¯SimpleCanalConnector 
172,rdsé…ç½®äº†ä¸»ä»åº“ï¼Œä¸»ä»åº“åˆ‡æ¢æ—¶å€™å‡ºç°å¼‚å¸¸ã€‚ å¼‚å¸¸æŠ¥é”™å¦‚ä¸‹ï¼š 16-04-22 07:11:24.236 [destination = crm_csc_03   address = rdst58y130m2pdn0th48.mysql.rds.aliyuncs.com/10.248.4.8:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:crm_csc_03[java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file     at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95)     at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113)     at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209)     at java.lang.Thread.run(Thread.java:745) ] ä¸»ä»åº“åˆ‡æ¢ä»åº“ä¸Šæ²¡æœ‰æ‰¾åˆ°binlog fetchæ—¶æŠ¥é”™ã€‚ æˆ‘çœ‹canalç›‘å¬å¯ä»¥é…ç½®ä¸»ä»åº“åœ°å€ã€‚è¿™ä¸ªæ–¹æ³•å¯ä»¥è§£å†³è¯¥é—®é¢˜å—ï¼Ÿ åƒè¿™ç§é—®é¢˜æœ‰æ²¡æœ‰å¥½çš„è§£å†³æ–¹æ¡ˆï¼Ÿ é”™è¯¯çš„ä½ç‚¹ï¼Œéœ€è¦æŒ‰ç…§æ—¶é—´æˆ³è¿›è¡Œè®¢é˜… å¤§å“¥ï¼ŒCould not find first log file name in binary log index file ä¸æ˜¯é”™è¯¯çš„ä½ç‚¹å§ï¼ï¼ï¼è¿™æ˜¯fetchæ—¶å€™bingoæ–‡ä»¶ä¸¢å¤±äº†ã€‚é‡å¯é”™è¯¯ä¾æ—§ï¼Œåªèƒ½è·³è¿‡ã€‚è¿™bingoä¸¢å¤±åº”è¯¥æ˜¯ä¸»ä»åº“åˆ‡æ¢å¼•èµ·çš„ã€‚ä½ ä»¬æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™ç§é—®é¢˜ã€‚ é—®é¢˜æ˜¯é”™è¯¯çš„ä½ç‚¹æ²¡é”™ï¼Œä½†æ˜¯canalä¸€ç›´åœ¨è¿è¡Œã€‚è¿™æ˜¯è¿è¡Œä¸­çš„å¼‚å¸¸ã€‚è®¾ç½®æ—¶é—´æˆ³å¯ä»¥è·³è¿‡è¿™æ®µã€‚ä½†ä¼šå¼•èµ·æ•°æ®ä¸¢å¤±ã€‚æˆ‘æ˜¯æƒ³çŸ¥é“ã€‚è¿™ç§é”™è¯¯åº”è¯¥æ€ä¹ˆæ ·å»é¿å…ã€‚instance.propertiesé…ç½®standbyå¯ä»¥é¿å…è¿™ç§é—®é¢˜å‘ç”Ÿå—ï¼Ÿæˆ–è€…æœ‰ä»€ä¹ˆå¥½çš„è§£å†³æ–¹æ¡ˆã€‚ rdsçš„vipæ¨¡å¼ï¼Œcanalæ— æ³•æ„ŸçŸ¥ä¸»å¤‡åˆ‡æ¢çš„æ“ä½œï¼Œç”¨ä¹‹å‰ä¸»åº“çš„binlogä½ç‚¹å»å¤‡åº“(æ–°çš„ä¸»åº“)å»æ‰¾ï¼Œå½“ç„¶ä¼šæ‰¾ä¸åˆ° ç›®å‰åªèƒ½åšå¥½ç›‘æ§ å½“å‘ç°ä¸»å¤‡åˆ‡æ¢ åŠæ—¶åœ¨binlogè¢«åˆ é™¤å‰ åšåˆ°æŒ‰æ—¶é—´é‡ç½® æˆ‘åç»­ç‰ˆæœ¬ä¼šè€ƒè™‘ä¸‹ï¼Œå¯ä»¥æä¾›ä¸€ä¸ªæ€è·¯ï¼Œå¦‚æœåŒå­¦æœ‰å…´è¶£å¯ä»¥æŒ‰ç…§å®ç°ä¹‹.  1. è®¢é˜…binlogä¹‹åï¼Œè·å–ä¸€ä¸‹binlogäº‹ä»¶çš„mysql server idï¼Œä½œä¸ºpositionçš„ä¸€éƒ¨åˆ†è®°å½•åˆ°ä½ç‚¹ä¸­ 2. èŠ‚ç‚¹å‘ç”Ÿbinlogä½ç‚¹ä¸å¯ç”¨æ—¶ï¼Œé€šè¿‡æ–°å»ºé“¾æ¥åˆ¤æ–­ä¸€ä¸‹mysql server idæ˜¯å¦æœ‰æ‰€ä¸åŒï¼Œå¦‚æœä¸åŒåˆ™è‡ªåŠ¨æŒ‰ç…§æ—¶é—´æˆ³è¿›è¡Œè®¢é˜…  æŸ¥è¯¢mysqlçš„server_idçš„åŠæ³•: ``` show variables like 'server_id'; ``` è¿™ä¸ªä¿®æ”¹å»ºè®®éå¸¸å¥½ï¼Œä¸è¿‡æŒ‰æ­¤ä¿®æ”¹è¿˜æ˜¯ä¼šå‡ºç°ä¸€äº›é—®é¢˜ã€‚rdsåœ¨æœ‰äº›æ—¶å€™binlogä¹Ÿä¼šè¢«æ¸…é™¤ã€‚å¦‚rdsè§„æ ¼å‡çº§ç­‰ï¼Œæˆ‘æ€»ç»“äº†ä¸€äº›è§„å¾‹å½“å‡ºç°IOExceptionçš„æ—¶å€™é”™è¯¯åŸºæœ¬ä¸å¯æ¢å¤ã€‚ä¼ä¸šåº”ç”¨å¾ˆå¤šæƒ…å†µã€‚å¸Œæœ›è·³è¿‡é”™è¯¯ç»§ç»­åé¢çš„æ“ä½œï¼Œå¹¶ä¸”å‘ŠçŸ¥ç›¸å…³ç»´æŠ¤äººå‘˜ï¼Œæˆ‘ç°åœ¨ä¿®æ”¹çš„æ–¹æ¡ˆæ˜¯ï¼š 1ã€å½“å‡ºç°IOExceptionæ—¶retryæŒ‡å®šæ¬¡æ•°ã€‚è¶…è¿‡æ¬¡æ•°æ—¶è·å–å½“å‰æœ€æ–°çš„ä½ç‚¹ï¼Œé‡æ–°è¿æ¥ã€‚ 2ã€é”™è¯¯æ—¥å¿—è¾“å‡ºå’ŒæŠ¥è­¦è¾“å‡º(å»ºè®®ä»¥åå¯ä»¥å®ç°é‚®ä»¶é¢„è­¦) 3ã€ExceptionRetryCountå¯åœ¨é…ç½®æ–‡ä»¶é…ç½®ã€‚ä¸é…ç½®çš„è¯ã€‚æŒ‰ä»¥å‰çš„æ–¹å¼å¤„ç†ã€‚ ç›¸å…³ä»£ç æˆ‘å·²ç»ä¿®æ”¹å¹¶ä¸”å·²ç»æµ‹è¯•é€šè¿‡åº”ç”¨åˆ°äº†ç”Ÿäº§ç¯å¢ƒï¼Œå¦‚æœç‰ˆä¸»è§‰å¾—æˆ‘æ€è·¯æ­£ç¡®ï¼Œæˆ‘å¯ä»¥æäº¤ç›¸å…³ä»£ç ã€‚ å»ºè®®æäº¤ä¸‹ä»£ç ï¼Œä¸€èµ·çœ‹ä¸‹ä»£ç ï¼Œå¸Œæœ›canalæœªæ¥èƒ½æ›´å¥½çš„æ”¯æŒè¿™ä¸€ç±»vipæ¨¡å¼çš„ä¸»å¤‡é›†ç¾¤ï¼Œä½ å’Œæˆ‘çš„ä¸¤ä¸ªæ–¹æ³•å¯ä»¥ç»“åˆå¤„ç† æˆ‘ç°åœ¨ä¹Ÿé‡åˆ°è¿™ä¸ªé—®é¢˜äº†ï¼Œæˆ‘ä»¬ç”¨çš„äºšé©¬é€Šçš„RDSï¼Œå¯¹mysqlçš„flush logsçš„æƒé™åšäº†é™åˆ¶ æˆ‘å°è¯•äº†æ¸…ç©ºzookeeperé‡Œé¢çš„ä¿¡æ¯å¹¶é‡å¯canalï¼Œåˆå°è¯•äº†instance.propertiesé‡Œé¢è®¾ç½®å½“å‰æ—¶é—´æˆ³éƒ½ä¸è¡Œï¼Œè¯·é—®è¿˜æœ‰ä»€ä¹ˆæ–¹å¼æ‰‹åŠ¨ä¿®å¤å—ï¼Ÿ å“ çŸ¥é“äº†é—®é¢˜ RDSé»˜è®¤åªä¿ç•™10åˆ†é’Ÿçš„binlogï¼Œå¦‚æœcanalä¸­æ–­äº†10åˆ†é’Ÿä»¥ä¸Šå°±å†ä¹Ÿèµ·ä¸æ¥äº†ã€‚ã€‚ã€‚ å¸Œæœ›èƒ½æä¾›ä¸ªç®€å•çš„å‘½ä»¤æˆ–è€…é…ç½®æ–‡ä»¶é‡ç½®ä¸ºæœ€æ–°ä½ç‚¹ï¼Œæ¯æ¬¡æ‰‹å·¥æ“ä½œå¥½éº»çƒ¦ æˆ‘ä¿®æ”¹äº†ä¸€äº›ä»£ç ã€‚å½“å‡ºç°è¿™ç§é”™è¯¯ä¸€å®šçš„æ¬¡æ•°ã€‚è‡ªåŠ¨é‡ç½®æœ€æ–°çš„ä½ç‚¹ã€‚ä»£ç æäº¤äº†ã€‚çœ‹çœ‹é˜¿é‡Œçš„å“¥ä»¬ä¼šä¸ä¼šé‡‡ç”¨äº†ã€‚ PRä»£ç å·²åˆå¹¶ï¼Œä¼šé€‚å½“å†ç²¾ç¡®è¯†åˆ«ä¸€ä¸‹å¼‚å¸¸å†…å®¹ï¼Œåˆ¤æ–­éœ€è¦è¿›è¡Œä¸»å¤‡åˆ‡æ¢ï¼Œå°½å¯èƒ½ä¿è¯ä¸ä¸¢æ•°æ® è²Œä¼¼mysql GTID æœ‰è¿™ä¸ªåŠŸèƒ½ 
171,å®¢æˆ·ç«¯é«˜å¯ç”¨å­˜åœ¨bug é—®é¢˜åœºæ™¯ 1ï¼Œcanalæœ‰ä¸¤å°æœåŠ¡å™¨c1å’Œc2ï¼Œc1å¤„äºæ¿€æ´»çŠ¶æ€ 2ï¼Œå®¢æˆ·ç«¯ä½¿ç”¨ClusterCanalConnectorè¿›è¡Œæ¶ˆè´¹ï¼Œä¹Ÿæ˜¯ä¸¤å°æœåŠ¡å™¨d1å’Œd2ï¼Œd1å¤„äºæ¿€æ´»çŠ¶æ€ 3ï¼Œc1å‘ç”Ÿå®•æœºï¼Œæ­¤æ—¶d1ä¼šæ‰§è¡Œã€ClusterCanalConnectorã€‘çš„restart()æ–¹æ³•ã€‚restartä¸­æœ‰ä¸‰æ­¥ï¼š ç¬¬ä¸€æ­¥ï¼Œdisconnectï¼Œä¼šé‡Šæ”¾runningèŠ‚ç‚¹ï¼› ç¬¬äºŒæ­¥ï¼Œçº¿ç¨‹ä¼‘çœ 5ç§’é’Ÿï¼› ç¬¬ä¸‰æ­¥ï¼Œå°è¯•é‡è¿ï¼Œé‡è¿çš„æ—¶å€™ä¼šæ‰§è¡ŒinitRunning()æ–¹æ³•ã€‚ 4ï¼Œåœ¨d1é‡Šæ”¾runningèŠ‚ç‚¹åï¼Œd2ä¼šè¢«ç«‹å³è§¦å‘ï¼Œæ‰§è¡ŒinitRunning()æ–¹æ³•ï¼ŒinitRunningä¸­ä¹Ÿæœ‰ä¸¤å¤§æ­¥ï¼š ç¬¬ä¸€æ­¥ï¼ŒæŠ¢å runningèŠ‚ç‚¹ ç¬¬äºŒæ­¥ï¼Œæ‰§è¡ŒprocessActiveEnter()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è‚¯å®šä¼šæŠ¥é”™ï¼Œå› ä¸ºæ­¤æ—¶d2è¿æ¥çš„canalä¹Ÿæ˜¯c1ï¼Œæ‰§è¡ŒinitRunningçš„zkçº¿ç¨‹ä¼šå¼‚å¸¸é€€å‡ºï¼Œæ­¤æ—¶d2çš„mutexå˜é‡ä»ç„¶ä¸ºfalseï¼Œå¹¶ä¸”æ²¡æœ‰é‡Šæ”¾runningèŠ‚ç‚¹ 5ï¼Œd1åç»­çš„é‡è¿éƒ½æ²¡æ„ä¹‰äº†ï¼Œå› ä¸ºd2æ²¡æœ‰é‡Šæ”¾runningèŠ‚ç‚¹ï¼Œæ‰€ä»¥d1çš„mutextå˜æˆäº†false 6ï¼Œæœ€ç»ˆç»“æœæ˜¯d1å’Œd2éƒ½é˜»å¡äº† 7ï¼Œæ­¤æ—¶å…³é—­d2ï¼Œd1çš„initRunningæ–¹æ³•ä¼šè¢«è§¦å‘ï¼Œä½†d1çš„processActiveEnteræ–¹æ³•ä»ç„¶ä¼šæŠ¥é”™ï¼Œd1ä»ç„¶æ— æ³•æ¢å¤æ¶ˆè´¹ 1. ç¡®è®¤ä¸€ä¸‹canalçš„ç‰ˆæœ¬ 2. ä½ çš„ç¬¬4æ­¥ï¼Œd2å¯åŠ¨é“¾æ¥çš„canalæ˜¯c1æ˜¯å› ä¸ºæ—¶æ•ˆæ€§é—®é¢˜ä¹ˆï¼Ÿd2æœªèƒ½åŠæ—¶å‘ç°c2å·²ç»æ˜¯ä¸»ï¼Ÿ å¦‚æœå¯ä»¥æ˜ç¡®é‡ç°ï¼Œæ˜¯å¦æœ‰ä¿®å¤çš„ä»£ç ï¼Ÿ canalç‰ˆæœ¬æ˜¯1.0.20 å¾ˆå®¹æ˜“é‡ç°çš„ï¼Œå‡ºç°ä¸Šè¿°ç°è±¡çš„åŸå› åœ¨äºã€ClientRunningMonitorã€‘çš„ã€initRunningæ–¹æ³•ã€‘æ²¡æœ‰å¯¹ã€processActiveEnter()ã€‘æŠ›å‡ºçš„å¼‚å¸¸åšå¤„ç†ï¼ŒæŠŠZkä¸Šçš„runningèŠ‚ç‚¹å ä½äº†æ²¡æœ‰é‡Šæ”¾ï¼Œå¯¼è‡´ä¸¤ä¸ªå®¢æˆ·ç«¯çš„mutexéƒ½ä¸ºfalseï¼Œéƒ½æ²¡æœ‰æœºä¼šæ‰§è¡Œäº†ã€‚ ä¿®å¤ä»£ç æ­£åœ¨å†™ï¼Œæ¶‰åŠåˆ°é«˜å¯ç”¨çš„ä»£ç æ¯”è¾ƒç»•ï¼Œè¿˜æ²¡å†™å¥½ï¼Œæ‚¨å¯ä»¥çœ‹çœ‹æœ‰æ²¡æœ‰ç®€ä¾¿çš„ä¿®æ”¹æ–¹æ³•ã€‚ è¿˜æœ‰å°±æ˜¯SimpleCanalConnectorç±»ä¸­çš„doConnectæ–¹æ³• private InetSocketAddress doConnect() throws CanalClientException {         try {             channel = SocketChannel.open();             channel.socket().setSoTimeout(soTimeout);             channel.connect(address); channel.connect(address);//æ­¤å¤„çš„addressåº”è¯¥å³æ—¶å–ä¸€æ¬¡ï¼Œå¦åˆ™D2æ°¸è¿œæ²¡æœºä¼šæ‹¿åˆ°æœ€æ–°çš„canal-serverçš„ip ä½ çš„ç¬¬4æ­¥ï¼Œd2å¯åŠ¨é“¾æ¥çš„canalæ˜¯c1æ˜¯å› ä¸ºæ—¶æ•ˆæ€§é—®é¢˜ä¹ˆï¼Ÿd2æœªèƒ½åŠæ—¶å‘ç°c2å·²ç»æ˜¯ä¸»ï¼Ÿ æ˜¯çš„ï¼Œæ²¡èƒ½å‘ç°ï¼ŒåŸå› å°±åœ¨äºè¿™æ®µä»£ç  channel.connect(address);//æ­¤å¤„çš„addressåº”è¯¥å³æ—¶å–ä¸€æ¬¡ï¼Œå¦åˆ™D2æ°¸è¿œæ²¡æœºä¼šæ‹¿åˆ°æœ€æ–°çš„canal-serverçš„ip çœ‹äº†ä¸‹ä»£ç ï¼Œå¦‚æœç¬¬4æ­¥ï¼Œd2å¯åŠ¨é“¾æ¥æ—¶æ‹¿åˆ°çš„æ˜¯c1ï¼Œä¼šåœ¨initRunningæ‰§è¡ŒdoConnectæ—¶æ‰§è¡Œå¤±è´¥ï¼ŒåŸæœ¬æœŸæœ›æ˜¯é€šè¿‡å®¢æˆ·ç«¯å‘èµ·restartæ“ä½œæ¥å¤„ç†ï¼Œè€Œd2å› ä¸ºæ˜¯çƒ­å¤‡ï¼Œå¯èƒ½æ˜¯åœ¨å¼‚æ­¥initRunningå›è°ƒæ—¶æŠ¥é”™ï¼Œæ— æ³•è§¦å‘clientç«¯çš„restartè€Œå¯¼è‡´é•¿æ—¶é—´æŒ‚èµ· æƒ³äº†ä¸‹ä¸€ç§æ¯”è¾ƒç®€å•çš„æ”¹æ³• 1. initRunningé’ˆå¯¹æ‰§è¡Œå¼‚å¸¸æ—¶ï¼Œä¸»åŠ¨é‡Šæ”¾runningèŠ‚ç‚¹ï¼Œé€šè¿‡å¼‚æ­¥å›è°ƒæ¥è¿›è¡Œé‡è¯• 2. SimpleCanalConnectorçš„doConnectæ–¹æ³•åŠ¨æ€è·å–addressåœ°å€ æ˜¯çš„ï¼Œå°±æ˜¯è¿™ä¹ˆæ”¹çš„ã€‚ æœºå™¨ä¸Šæ²¡è£…gitå®¢æˆ·ç«¯ æ”¹é€ çš„ä»£ç å‘ä½ é‚®ç®±äº†ï¼Œjianghang115@gmail.com æŠ½æ—¶é—´çœ‹ä¸‹å§ 
170,canalæ€ä¹ˆå’ŒRocketMQé›†æˆï¼Ÿ å› ä¸ºè¦å®ç°å¤šå®¢æˆ·ç«¯è®¢é˜…çš„æ•ˆæœï¼Œè²Œä¼¼canalæœ¬èº«æ˜¯ä¸æ”¯æŒçš„ã€‚ æ‰€ä»¥è€ƒè™‘å’ŒRocketMQç»“åˆä½¿ç”¨ã€‚  èƒ½å¦ä¸éœ€è¦canal-clientï¼Œç›´æ¥canal-serverä¸­æ¶ˆæ¯ç›´æ¥æ¨åˆ°MQä¸­ï¼Ÿ æ˜¯ä¸æ˜¯è¦å®šåˆ¶canal-serveræ‰å¯ä»¥ï¼Ÿ å®šåˆ¶çš„å·¥ä½œé‡å¤§å—ï¼Ÿ ä½¿ç”¨canal clientè·å–åˆ°æ¶ˆæ¯åå†™å…¥Rocketmq æˆ‘ç°åœ¨å°±æ˜¯å†™äº†ä¸€ä¸ªä¸­é—´åº”ç”¨ï¼Œä½¿ç”¨ Redis è®¢é˜…ä¸€ä¸ª instanceï¼Œç„¶ååœ¨ Redis é‡Œé¢å¤šæ¬¡æ¶ˆè´¹ã€‚
169,canal-serverå’Œclientèƒ½å¦1å¯¹å¤šå…³ç³» å¯åŠ¨ä¸€ä¸ªcanal-serverå’Œä¸¤ä¸ªclientï¼Œç»“æœåªæœ‰ç¬¬ä¸€ä¸ªå¯åŠ¨çš„å¯ä»¥æ”¶åˆ°æ¶ˆæ¯ï¼Œæ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ clientåªèƒ½ä¸€ä¸ªå·¥ä½œï¼Œå¦ä¸€ä¸ªæ˜¯çƒ­å¤‡ 
168,reset masteråå‡ºç°çš„binlogå¯»æ‰¾ä¸åˆ°çš„é—®é¢˜ pid:2 nid:2 exception:canal:shanghai_canal:java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) at java.lang.Thread.run(Thread.java:745) é€šè¿‡mysqlæ—¥å¿—å‘ç°canalä¾ç„¶è¯·æ±‚åŸå§‹çš„binlogï¼Œè¯·é—®è¿™ä¸ªé—®é¢˜æ˜¯å¦æœ‰å¤„ç†æœºåˆ¶ï¼Ÿè°¢è°¢ @ch-lgs  è¯·é—®ä¸‹æ˜¯å¦‚ä½•å¤„ç†çš„å‘¢ RESET MASTER :åˆ é™¤æ‰€æœ‰çš„äºŒè¿›åˆ¶æ—¥å¿—ï¼Œå¹¶é‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„äºŒè¿›åˆ¶æ—¥å¿— åŸå§‹binlogè¢«åˆ é™¤äº†ï¼Œcanalä¹Ÿå°±æ— æ³•æ¶ˆè´¹äº† æ‰€ä»¥ä¼šæŠ¥é”™ã€‚è§£å†³åŠæ³•æ˜¯é‡è®¾ä¸€ä¸ªæ¶ˆè´¹ç‚¹ä½   è¯¥ç‚¹ä½ä¹‹å‰çš„æ•°æ®ä¸¢å¤±ã€‚
167,canal serverå¦‚ä½•è‡ªé€‚åº”æ•°æ®åº“HAï¼Ÿ å½“ä¸»dbæŒ‚äº†åˆ‡æ¢åˆ°å¤‡æœºï¼Œè¿™ä¸ªæ—¶å€™canal serverèƒ½è‡ªåŠ¨è¿æ¥å¤‡æœºè·å–binlogå—ï¼Ÿoffsetæ€ä¹ˆè®¾ç½®å‘¢ï¼Ÿ å¤šçœ‹ä¸‹wiki
166,å¯åŠ¨æœåŠ¡æˆåŠŸï¼Œç›‘æ§ä¸åˆ°æ•°æ®åº“çš„æ”¹å˜ 2016-04-15 15:45:39.563 [destination = image   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just show master status 2016-04-15 15:45:39.564 [destination = image   address = /127.0.0.1:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /127.0.0.1:3306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: command : 'show master status' has an error! Caused by: java.io.IOException: ErrorPacket [errorNumber=1227  fieldCount=-1  message=Access denied; you need (at least one of) the SUPER  REPLICATION CLIENT privilege(s) for this operation  sqlState=42000  sqlStateMarker=#]  with command: show master status         at com.alibaba.otter.canal.parse.driver.mysql.MysqlQueryExecutor.query(MysqlQueryExecutor.java:60) ~[canal.parse.driver-1.0.21.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.query(MysqlConnection.java:69) ~[canal.parse-1.0.21.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findEndPosition(MysqlEventParser.java:548) ~[canal.parse-1.0.21.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPositionInternal(MysqlEventParser.java:352) ~[canal.parse-1.0.21.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPosition(MysqlEventParser.java:312) ~[canal.parse-1.0.21.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:162) ~[canal.parse-1.0.21.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.7.0_79] æ‰§è¡Œshow master statusçš„æ—¶å€™æƒé™ä¸è¶³å§ ä½çº§é—®é¢˜ï¼Œè§1æ¥¼å›å¤ æŸ¥çœ‹è¿‡æƒé™éƒ½æ˜¯ç»™çš„777ä¸æ˜¯è¿™ä¸ªé—®é¢˜ è´¦å·æƒé™ï¼Œä¸æ˜¯æ–‡ä»¶æƒé™ éƒ½ç»™çš„æœ€å¤§æƒé™ æ˜¯zookeeperç¼“å­˜èŠ‚ç‚¹æ²¡æœ‰æ¸…ç©ºå¯¼è‡´çš„ 
165,canal + zookeeper ä¸èƒ½æ­£ç¡®æ‰¾åˆ°ç‚¹ä½ zookeeperå¯åŠ¨æ­£å¸¸ > canalé…ç½®` - canal.instance.global.spring.xml = classpath:spring/default-instance.xml > example/instance.properties canal.instance.master.address = 172.16.20.120:3306 canal.instance.master.journal.name = canal.instance.master.position = canal.instance.master.timestamp = > ä½¿ç”¨é™¤classpath:spring/default-instance.xmlä»¥å¤–éƒ½èƒ½æ­£å¸¸æ•æ‰æ•°æ®åº“æ”¹åŠ¨ï¼Œä¸€æ—¦æ¢æˆclasspath:spring/default-instance.xmlå°±ä¸èƒ½æ­£å¸¸è·å– 1.  2. \- 2016-04-14 15:41:06.202 [Thread-4] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - stop CannalInstance for 1-example  3. \- 2016-04-14 15:41:06.204 [Thread-4] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - stop successful.... 4. \- [root@Note_140_canal ~]# tailf -n 300 /usr/local/canal.deployer-1.0.21/logs/example/example.log  5. \- 2016-04-14 15:41:34.578 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [canal.properties] 6. \- 2016-04-14 15:41:34.588 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [example/instance.properties] 7. \- 2016-04-14 15:41:34.645 [main] WARN  org.springframework.beans.TypeConverterDelegate - PropertyEditor [com.sun.beans.editors.EnumEditor] found through deprecated global PropertyEditorManager fallback - consider using a more isolated form of registration  e.g. on the BeanWrapper/BeanFactory! 8. \- 2016-04-14 15:41:34.759 [main] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start CannalInstance for 1-example  9. \- 2016-04-14 15:41:34.788 [main] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - subscribe filter change to ._.._ 10. \- 2016-04-14 15:41:34.789 [main] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start successful.... 11. \- 2016-04-14 15:41:34.832 [destination = example   address = /172.16.20.120:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position by switch ::1460100169000 12. \- 2016-04-14 15:41:34.970 [destination = example   address = /172.16.20.120:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - Didn't find the corresponding binlog files from mysql-bin.000001 to mysql-bin.000004 13. \- 2016-04-14 15:41:34.979 [destination = example   address = /172.16.20.120:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /172.16.20.120:3306 has an error  retrying. caused by  14. \- com.alibaba.otter.canal.parse.exception.CanalParseException: can't find start position for example 15. \- 2016-04-14 15:41:34.983 [destination = example   address = /172.16.20.120:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: can't find start position for example 16. \- ] 17.  18. ``` é€šè¿‡ æ—¶é—´æˆ³ 1460100169000ã€‚æ‰¾ä¸åˆ° å¯¹åº”çš„ binlog æ—¥å¿—æ–‡ä»¶ ç°åœ¨å·²ç»è§£å†³äº†ï¼Œå‹ç¼©åŒ…ä¼ åˆ°linuxè¢«æŸåäº† 
164,ç›‘å¬å®ä¾‹æ­£åˆ™è¿‡æ»¤çš„é—®é¢˜ æœ‰è¿™æ ·ä¸€ä¸ªç‰¹æ®Šçš„æ•°æ®åº“ï¼ŒåŒæ ·çš„tableåˆ†å¸ƒåœ¨äº†å¤šä¸ªschemaé‡Œï¼ˆåˆ†åº“äº†ï¼‰ã€‚æˆ‘æƒ³ç›‘å¬æ‰€æœ‰ä»¥`order`å¼€å¤´ï¼Œä¸‹åˆ’çº¿åŠ æ•°å­—ç»“å°¾çš„åº“åï¼Œå¦‚`order_1` `order_2` `...` `order_11`ç­‰ç­‰ï¼Œ**å› ä¸ºè‡ªåŠ¨æ‰©å®¹è¿™ä¸ªæ•°å­—ç´¯åŠ ï¼Œ åŒæ—¶åˆå­˜åœ¨å¤šä¸ªæ— å…³çš„schemaï¼Œæ²¡æ³•ä¸€ä¸€åˆ—ä¸¾**ã€‚ è¯•ç€å†™äº†å¦‚ä¸‹çš„æ­£åˆ™è¿‡æ»¤é…ç½®ï¼Œå¯åŠ¨serveråå¹¶æœªç”Ÿæ•ˆï¼Œä¹Ÿæ²¡æœ‰æŠ›é”™ï¼Œåƒç±»ä¼¼çš„é…ç½®æ€ä¹ˆå†™ï¼Ÿ **`canal.instance.filter.regex=order_/(\d+)/\\..*`** ä¸çŸ¥é“è¿™æ ·çš„éœ€æ±‚æ­£åˆ™èƒ½å¦æ»¡è¶³ï¼Ÿæ„Ÿè°¢ï¼ï¼ é€šè¿‡åå¤è°ƒè¯•ï¼Œè¿™æ ·å°±å¯ä»¥äº†ã€‚ `order_\\d+\\..*`   
163,CanalServer æ˜¯å¦å­˜åœ¨æ€§èƒ½ç“¶é¢ˆ canalä¸Šéƒ¨ç½²äº†51ä¸ªå®ä¾‹ï¼Œclientï¼ˆæ¶ˆè´¹æ‰€æœ‰çš„å®ä¾‹ï¼‰ä¸canaléƒ¨ç½²åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå¹¶ä¸”æœåŠ¡å™¨ä¸Šæ— å…¶ä»–æœåŠ¡ã€‚ ### clientå®ç° - åˆå§‹åŒ–è¿æ¥ ```         // æ ¹æ®ipï¼Œç›´æ¥åˆ›å»ºé“¾æ¥ï¼Œæ— HAçš„åŠŸèƒ½         CanalConnector connector = CanalConnectors.newSingleConnector(                 new InetSocketAddress(hostIp  port)  destination.generateDestination()  ""  ""); ``` - è·å–æ•°æ® ```                     long t1 = System.currentTimeMillis();                     Message message = connector.getWithoutAck(10240  1000L  TimeUnit.MILLISECONDS);   //ä»¥æ¯«ç§’ä¸ºå•ä½                     long t2 = System.currentTimeMillis();                     long batchId = message.getId();                     logger.info("read batchId=[{}]  time=[{}]ms"  batchId  (t2 -t1)); ``` ### é—®é¢˜ å‘ç°éƒ¨åˆ†å®ä¾‹æ‰§è¡ŒgetWithoutAckæ–¹æ³•çš„è€—æ—¶å¤§äºè®¾ç½®å€¼ï¼ˆ1000msï¼‰ï¼Œå¤§æ¦‚åœ¨2000msï¼Œæ•°æ®é‡å¤§æ—¶è€—æ—¶ä¹Ÿéšä¹‹æ”¾å¤§ã€‚ ä¸‹é¢æ˜¯clientä¸€æ¬¡è¯·æ±‚çš„åˆ†æï¼š - clientå‘é€è¯·æ±‚ï¼ˆt1ï¼‰ - serveræ”¶åˆ°è¯·æ±‚ï¼ˆt2ï¼‰ - embeddedServer.getWithoutAck()å®Œæˆï¼Œå¹¶å‘clientè¿”å›æ•°æ®ï¼ˆt3=10:40:34ï¼‰ - clientæ”¶åˆ°æ•°æ®ï¼ˆt4=10:40:37ï¼‰ æ ¹æ®æ—¥å¿—å¯çŸ¥ï¼Œt4ï¼t1ï¼5000msï¼Œè€Œt4ï¼t3ï¼3000msï¼Œè€ŒgetWithoutAckè€—æ—¶ä¸º1000msï¼Œå› æ­¤å¯ä»¥æ¨æ–­å‡ºt2ï¼t1=5000ï¼3000ï¼1000=1000msã€‚ **å› æ­¤ï¼Œæ˜¯å¦å¯ä»¥è¯´æ˜clientä¸CanalServerä¹‹é—´çš„é€šä¿¡å­˜åœ¨è€—æ—¶ï¼Ÿä½†æ˜¯è¿™ä¸ªè€—æ—¶åœ¨ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯å¿½ç•¥ä¸è®¡çš„ï¼** å¦‚æœæ˜¯CanalServer çš„æ€§èƒ½ç“¶é¢ˆï¼Œèƒ½å¦ä¼˜åŒ–ï¼Ÿ æœåŠ¡å™¨24æ ¸ï¼Œå†…å­˜64g ä¼˜å…ˆçœ‹ä¸‹canal serverçš„jvmå†…å­˜å’ŒGCçŠ¶æ€.   a.  ä¸€æ¬¡æ€§å–10MBçš„æ•°æ®ä¸æ˜¯ä¸€ç§æ˜æ™ºçš„åšæ³• b. ä¸€ä¸ªserveréƒ¨ç½²è¿‡å¤šçš„binlogè§£æé˜Ÿåˆ—ï¼Œä¹Ÿä¸æ˜æ™ºï¼Œéœ€è¦å¹³è¡¡jvmå†…å­˜å’Œä¸šåŠ¡' ä¸€èˆ¬æˆ‘ä»¬å†…éƒ¨ä½¿ç”¨ï¼Œ8ä¸ªé˜Ÿåˆ—ï¼Œ4M+100msçš„è·å– ä¸€ä¸ªcanalä¸Šéƒ¨ç½²8ä¸ªå®ä¾‹ï¼Œæœ‰é›†ç¾¤ç‰ˆï¼Ÿ ä¸€ä¸ªserveræœ¬èº«å°±æ˜¯8ä¸ªæ¶ˆè´¹é˜Ÿåˆ—(instance) 
162,æ”¯æŒä¸‹IDEå¯åŠ¨CanalLauncher RT. ä¸»è¦è§£å†³ä¸‹confç›®å½•æ–‡ä»¶çš„æŸ¥æ‰¾  è§„é¿æ‰scanæ‰«æå¤±è´¥è§¦å‘äº†stopæœºåˆ¶ 
161,parse row data failed æŒ‰ç…§quick start çš„æ­¥éª¤ï¼Œä½¿ç”¨äº†ä¸€ä¸‹ï¼Œå¯åŠ¨ startup.shåï¼Œè§‚å¯Ÿ example.log ä¸åœåœ°ä¼šæœ‰å¦‚ä¸‹æŠ¥é”™ï¼š 2016-04-01 15:01:37.068 [destination = example   address = /10.0.2.40:3550   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: java.lang.IllegalArgumentException: bad format  x exceed: 1887436800  999999999     at com.taobao.tddl.dbsync.binlog.LogBuffer.getDecimal0(LogBuffer.java:1355)     at com.taobao.tddl.dbsync.binlog.LogBuffer.getDecimal(LogBuffer.java:1265)     at com.taobao.tddl.dbsync.binlog.event.RowsLogBuffer.fetchValue(RowsLogBuffer.java:339)     at com.taobao.tddl.dbsync.binlog.event.RowsLogBuffer.nextValue(RowsLogBuffer.java:96)     at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseOneRow(LogEventConvert.java:462) canalç‰ˆæœ¬å’Œmysqlç‰ˆæœ¬æŠ¥å‘Šä¸€ä¸‹ mysql ç‰ˆæœ¬ï¼š /home/rong/mysql/bin/mysql  Ver 14.14 Distrib 5.6.26  for Linux (x86_64) using  EditLine wrapper canal å°±æ˜¯æœ€æ–°çš„1.0.21 å¯ä»¥ä¸‹è½½mysql binlogåˆ°æœ¬åœ°ï¼Œç„¶åä½¿ç”¨FileLogFetcherTestè¿›è¡Œæœ¬åœ°è§£ææµ‹è¯• å¥½çš„ï¼Œæˆ‘è¯•è¯•çœ‹ï¼Œå¤šè°¢ ä¼°è®¡æ˜¯è¿™ä¸ªé—®é¢˜ï¼šhttps://github.com/alibaba/canal/issues/119 ä½¿ç”¨å½“å‰masteråˆ†æ”¯buildä¸€ä¸ªå†è¯•è¯• è¿™ä¸ªé—®é¢˜æ€ä¹ˆè§£å†³å‘€ï¼Ÿæˆ‘çš„MySQLç‰ˆæœ¬æ˜¯5.6.26 ç±»ä¼¼çš„é—®é¢˜ä¿®å¤è¿‡ä¸€æ¬¡ï¼Œä½¿ç”¨å½“å‰masteråˆ†æ”¯ï¼Œæœ¬åœ°æ‰“åŒ…ä¸€ä¸ªç‰ˆæœ¬æµ‹è¯•ä¸€ä¸‹ï¼Œå¦‚æœ‰é—®é¢˜è¯·å†åé¦ˆ 
160,å–ä¸åˆ°ROWDATAæ•°æ® ä»åº”ç”¨æ—¥å¿—ä¸Šçœ‹å–åˆ°äº†EntryTypeä¸º TRANSACTIONBEGINå’ŒTRANSACTIONEND æ•°æ® æ²¡æœ‰å–å¾—ROWDATAã€‚è¯·é—®ä¸€ä¸‹è¿™æ˜¯ä»€ä¹ˆåŸå›  Canalç‰ˆæœ¬ 1.0.21 mysq ç‰ˆæœ¬   PXCæ¶æ„ 5.6.20 è‡ªå·±å›ç­”ä¸€ä¸‹ï¼Œæ˜¯æ•°æ®åº“ç«¯å£é…ç½®çš„é—®é¢˜ æ•°æ®åº“æ˜¯pxcï¼Œèµ·äº†ä¸¤ä¸ªå®ä¾‹3306 3307. å¥‡æ€ªçš„æ˜¯è¿æ¥äº†é”™è¯¯çš„ç«¯å£ï¼Œæ²¡æœ‰ä»»ä½•æŠ¥é”™ ä½ ç¡®å®šä¸‹ä½ çš„mysqlé…ç½®ä¸­binlog-format=ROWå—ï¼Ÿ å‘è‡ªæˆ‘çš„ iPhone > åœ¨ 2016å¹´3æœˆ31æ—¥ï¼Œ17:22ï¼ŒSong Chang notifications@github.com å†™é“ï¼š >  > ä»åº”ç”¨æ—¥å¿—ä¸Šçœ‹å–åˆ°äº†EntryTypeä¸º TRANSACTIONBEGINå’ŒTRANSACTIONEND æ•°æ® > æ²¡æœ‰å–å¾—ROWDATAã€‚è¯·é—®ä¸€ä¸‹è¿™æ˜¯ä»€ä¹ˆåŸå›  > Canalç‰ˆæœ¬ 1.0.21 > mysq ç‰ˆæœ¬ PXCæ¶æ„ 5.6.20 >  > â€” > You are receiving this because you are subscribed to this thread. > Reply to this email directly or view it on GitHub canal.instance.binlog.format = ROW STATEMENT MIXED  é»˜è®¤çš„ï¼Œæ²¡æœ‰æ”¹è¿‡ã€‚ åŸå› å·²ç»æŸ¥å‡ºæ¥äº†ï¼Œè§ä¸Šé¢çš„å›ç­”ï¼Œä¸»è¦å¥‡æ€ªçš„æ˜¯canalæ²¡æœ‰ä»»ä½•æŠ¥é”™.å„ä¸ªæ—¥å¿—éƒ½æ­£å¸¸ canalä¼šé»˜è®¤è§£ææ‰€æœ‰çš„binlogï¼Œä½ è¿™é‡Œå¼€å¯äº†æ‰€æœ‰æ—¥å¿—æ ¼å¼ï¼Œå½“ç„¶ä¸ä¼šæŠ¥é”™äº† æˆ‘ç”¨çš„canal 1.0.25-SNAPSHOTå¯¹åº”MySQL 5.6ã€5.7ä¹Ÿä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ã€‚ ç«¯å£æ²¡æ”¹ï¼Œé…ç½®ä¹Ÿæ˜¯é‡‡ç”¨é»˜è®¤çš„æ”¯æŒæ‰€æœ‰æ ¼å¼ canal.instance.binlog.format = ROW STATEMENT MIXED é»˜è®¤è§£ææ‰€æœ‰binlogä¹Ÿä¸ä¼šå¯¼è‡´rowdataè§£æä¸äº†å§ï¼Ÿ æ•°æ®åº“é‡‡ç”¨çš„æ˜¯row ç»è¿‡éªŒè¯ï¼Œfilterè¿‡æ»¤æ‰çš„åº“ã€è¡¨ä¿¡æ¯ï¼Œrowdataä¿¡æ¯æ”¶ä¸åˆ°äº†ï¼Œä½†æ˜¯å¯¹åº”çš„Transaction Beginã€Transaction Endè¿˜æ˜¯æœ‰çš„ã€‚ åŒæ ·çš„é—®é¢˜ `connector.subscribe("actionlog\\d{8}");`æˆ‘æƒ³è®¢é˜…æ‰€æœ‰actionlogæ‰“å¤´æ¥æ•°å­—çš„è¡¨ï¼Œç»“æœæ²¡æœ‰ROWDATAäº†ï¼Œæ˜¯æ­£åˆ™é”™äº†ï¼Œè¿˜æ˜¯å“ªé‡Œé”™äº†ï¼Ÿï¼Ÿï¼Ÿ ä½ ç°åœ¨æœ¬åœ°ç”¨canalçš„PattenUtilsè·‘ä¸€ä¸‹testcase
159,ack èƒ½å®ç°å¯¹æŸä¸€ä¸ª Message ä¸­çš„æŸä¸ª Entry æäº¤å— `com.alibaba.otter.canal.client.CanalConnector.get` æ–¹æ³•ä¸­æœ‰ batchSize å‚æ•°ã€‚å½“æˆ‘è®¾ç½®æˆ 100 æ—¶ï¼Œå‡å¦‚æˆ‘åœ¨å¤„ç†æŸäº› `entry` å‡ºé”™ï¼Œç„¶åè°ƒç”¨ `connector.rollback(batchId)`ï¼Œè¿™å°±ä¼šå¯¼è‡´æ­¤æ¬¡çš„æ‰€æœ‰ `entry` å›æ»šå—ï¼Ÿé‚£æ˜¯å¦ä¼šå¯¼è‡´æ¥ä¸‹æ¥å‡ºç°é‡å¤å¤„ç†ç›¸åŒ `entry` çš„é—®é¢˜ ï¼Ÿ æˆ‘æƒ³é—®ä¸‹ canal æœ‰æä¾› "ack æäº¤æŸä¸ª Message Entry" çš„æ–¹æ¡ˆå—ï¼Ÿ æˆ‘ç°åœ¨çš„æ€è·¯æ˜¯åœ¨è®°å½• "åº“å+è¡¨å+ä¸»é”®" åšå”¯ä¸€åˆ¤æ–­ï¼Œé˜²æ­¢ rollback åé‡å¤å¤„ç† æ²¡æœ‰å•æ¡ackçš„åŠŸèƒ½ï¼Œgetçš„æ—¶å€™è®¾ç½®batchSizeå°ä¸€ç‚¹.   ps.  ä¸»è¦æ˜¯æ€§èƒ½è€ƒè™‘ é‚£æ€ä¹ˆå¤„ç†é‡å¤å‘¢ï¼ŸbatchSize=1ï¼Ÿ éœ€è¦ä¸šåŠ¡ä¸Šè®¾è®¡ä¸ºå¯å¹‚ç­‰æ‰§è¡Œï¼Œè½¯ä»¶å±‚é¢æ²¡æ³•é¿å…ä¸é‡å¤ 
158,ä¸ºä»€ä¹ˆåœ¨CanalLauncher ä¸­è¿è¡ŒæŠ¥é”™ java.io.IOException: connect /127.0.0.1:3306 failure:java.nio.channels.ClosedChannelException è€Œæ‰“åŒ…åè¿è¡Œstartup.shå´ä¸ä¼šå‘¢ï¼Ÿå¾ˆå¥‡æ€ª debugä»£ç ï¼Œå’Œä½ è‡ªå·±ç¯å¢ƒæœ‰å¤ªå¤šç›¸å…³æ€§ é‡åˆ°åŒæ ·é—®é¢˜ï¼Œä¸çŸ¥é“@shuhuiguo   ä½ æ˜¯æ€ä¹ˆè§£å†³çš„ æ²¡æœ‰ï¼Œåº”è¯¥æ˜¯çº¿ç¨‹æ¨¡å‹æœ‰é—®é¢˜ 
157,æšä¸¾ç±»å‹çš„å­—æ®µå€¼æ€ä¹ˆä»¥å­—ç¬¦ä¸²å½¢å¼è¯»å– å½“ mysql å­—æ®µç±»å‹ä¸º enum æ—¶ï¼Œ`column.getValue()` è¿”å›çš„æ˜¯ int å€¼ï¼Œæˆ‘æƒ³é—®ä¸‹èƒ½å¦æ–¹ä¾¿åœ°è·å–å’Œ mysql ä¸­ä¸€æ ·çš„ enum å­—ç¬¦ä¸²å€¼å‘¢ï¼Ÿ binlogåè®®é‡Œæ•°æ®åŒ…å°±æ˜¯intç±»å‹ï¼Œå¯ä»¥æ‹¿åˆ°æ•°æ®åº“è¡¨ç»“æ„å®šä¹‰ï¼Œå°†intè½¬ä¸ºå¯¹åº”çš„enumå€¼ @agapple canal æœ‰æä¾›è·å–æ•°æ®åº“è¡¨ç»“æ„å®šä¹‰çš„æ–¹æ³•å—ï¼Ÿæˆ‘æŸ¥äº†ä¸‹ wiki æ²¡æœ‰æ‰¾åˆ°ã€‚ entryåè®®é‡Œæœ‰ä¸ªmysql typeå±æ€§ 
156,Could not find first log file name in binary log index file  æŠ¥é”™ä¿¡æ¯ï¼š `2016-03-25 17:56:48.605 [destination = mysql_56688   address = /127.0.0.1:56688   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position /data/mysql_data/data/mysql-bin.000001:4: 2016-03-25 17:56:48.607 [destination = mysql_56688   address = /127.0.0.1:56688   EventParser] ERROR c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O error while reading from client socket java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) ~[canal.parse-1.0.21.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) [canal.parse-1.0.21.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) [canal.parse-1.0.21.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.7.0_79] 2016-03-25 17:56:48.607 [destination = mysql_56688   address = /127.0.0.1:56688   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /127.0.0.1:56688 has an error  retrying. caused by  java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95) ~[canal.parse-1.0.21.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) ~[canal.parse-1.0.21.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) ~[canal.parse-1.0.21.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.7.0_79] 2016-03-25 17:56:48.607 [destination = mysql_56688   address = /127.0.0.1:56688   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:mysql_56688[java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209)         at java.lang.Thread.run(Thread.java:745) ` MySQL:  5.6.25 canal:  1.0.21 instance.properties: canal.instance.mysql.slaveId = 3 canal.instance.master.address = 127.0.0.1:56688 canal.instance.master.journal.name = /data/mysql_data/data/mysql-bin.000001 canal.instance.master.position = 4 é¦–å…ˆMySQLé…ç½®å’Œæ–‡ä»¶æƒé™éƒ½æ£€æŸ¥è¿‡äº†ï¼Œæ²¡å•¥é—®é¢˜ï¼Œè¿™ä¸ªæ˜¯å› ä¸ºbin logç›®å½•ä¸åœ¨å¸¸è§„ç›®å½•å¼•èµ·çš„å—ï¼Ÿ Could not find first log file name in binary log index file at.  ä¼°è®¡æ‰‹å·¥æ¸…ç†è¿‡binlogæ—¥å¿—ï¼Œæ²¡é‡ç½®mysql binlog indexä¿¡æ¯ï¼Œgoogleä¸€å¤§æŠŠè¿™é—®é¢˜è§£å†³æ–¹æ¡ˆ reset masterä¹Ÿä¸è¡Œï¼Œå¦å¤–ï¼Œå¦‚æœæŠŠä¸æŒ‡å®šbinlogä½ç½®ï¼Œinstance threadä¼šä¸€ç›´å¡åœ¨'show master status' canalä¼šè‡ªè¡Œåšé‡è¯•ï¼Œæ¸…ç†ä¸‹canalè®°å½•çš„å†å²ä½ç‚¹ä¿¡æ¯ å¦‚ä½•æ¸…ç† ä¸‹canalè®°å½•çš„å†å²ä½ç‚¹ä¿¡æ¯ï¼Ÿ åˆ é™¤ä»€ä¹ˆæ–‡ä»¶è¿˜æ˜¯é‡å¯zookeeper? åˆ é™¤zkèŠ‚ç‚¹æˆ–è€…meta.datï¼Œç„¶åé‡å¯instance otter-manageré‡ŒnodeèŠ‚ç‚¹çš„åˆ é™¤é“¾æ¥æ˜¯æ–‡å­—ä¸å¯åˆ é™¤ï¼Œè¦æ€æ ·æ­¥éª¤æ‰èƒ½åˆ é™¤å‘¢ï¼Ÿ åœ¨åŒæ­¥è¿›åº¦é‡ŒæŠŠPosition çŠ¶æ€åˆ é™¤ï¼Œå³å¯æ¢å¤ canalæ¯æ¬¡å°†è§£æè¿‡journalnameå­˜å‚¨åˆ°zkä¸Šé¢ï¼Œç¬¬äºŒæ¬¡parseæ•°æ®çš„æ—¶å€™ä¼šä»zkå»æ‹¿ä¸€æ¬¡journalnameï¼Œå¦‚æœæ‰¾ä¸åˆ°åˆ™ä»masterå»æ‰¾first index fileã€‚å¦‚æœæ•°æ®åº“ç®¡ç†å‘˜æ‰‹åŠ¨æ¸…ç†è¿‡æ—¥å¿—æˆ–è€…ç£ç›˜è¿‡æ»¡è‡ªåŠ¨æ¸…ç†æ—¥å¿—éƒ½ä¼šå‡ºç°è¿™æ ·é—®é¢˜ï¼Œè§£å†³åŠæ³•å°±æ˜¯åˆ é™¤å¯¹åº”nameçš„èŠ‚ç‚¹ ä¸€èˆ¬æ˜¯å»ºè®®ä½¿ç”¨mysqlå‘½ä»¤è¡Œè¿›è¡Œåˆ é™¤ï¼Œå°±ä¼šåŒæ­¥ä¿®æ”¹indexæ–‡ä»¶ @agapple ä½ å¥½ æˆ‘åˆ é™¤äº†instanceçš„meta.dat é‡å¯canal è¿˜æ˜¯çˆ†è¿™ä¸ªé”™ è¯·é—®è¿˜æœ‰åˆ«çš„è§£å†³åŠæ³•å— 
155,Time Out æ˜¯ç‰ˆæœ¬ä¸å…¼å®¹çš„é—®é¢˜å— hiï¼Œ æˆ‘ä½¿ç”¨äº†serverï¼V1.0.22æœ€æ–°ç‰ˆã€clientï¼V1.0.21 ä»“åº“å–çš„ä¾èµ–jarå‡ºç°äº†è«åçš„è¶…æ—¶é—®é¢˜ï¼Œæˆ‘çš„zookeeperå…¶ä»–åº”ç”¨æ”¯æŒçš„å¾ˆå¥½`zkServer=cdh3:2181 cdh1:2181 cdh5:2181` ã€‚ **ä½¿ç”¨zookeeperè°ƒåº¦å‡ºç°è¶…æ—¶ç°è±¡ï¼Œclinetä¸€ç›´è”ä¸é€š**  ç”¨Simpleæ–¹å¼å°±æ²¡æœ‰é—®é¢˜ï¼Œè¶…æ—¶æŠ›çš„é”™è¯¯å¦‚ä¸‹ã€‚ `[2016-03-24 19:58:27] ERROR [ZkClient-EventThread-13-cdh3:2181 cdh1:2181 cdh5:2181] ZkEventThread - Error handling event ZkEvent[Data of /otter/canal/destinations/user/1001/running changed sent to com.alibaba.otter.canal.client.impl.running.ClientRunningMonitor$1@45681b65] com.alibaba.otter.canal.protocol.exception.CanalClientException: java.net.ConnectException: Operation timed out     at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.doConnect(SimpleCanalConnector.java:167)     at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.access$000(SimpleCanalConnector.java:48)     at com.alibaba.otter.canal.client.impl.SimpleCanalConnector$1.processActiveEnter(SimpleCanalConnector.java:392)     at com.alibaba.otter.canal.client.impl.running.ClientRunningMonitor.processActiveEnter(ClientRunningMonitor.java:188)     at com.alibaba.otter.canal.client.impl.running.ClientRunningMonitor.initRunning(ClientRunningMonitor.java:110)     at com.alibaba.otter.canal.client.impl.running.ClientRunningMonitor$1.handleDataDeleted(ClientRunningMonitor.java:67)     at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549)     at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71) Caused by: java.net.ConnectException: Operation timed out     at sun.nio.ch.Net.connect0(Native Method)     at sun.nio.ch.Net.connect(Net.java:458)     at sun.nio.ch.Net.connect(Net.java:450)     at sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:648)     at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.doConnect(SimpleCanalConnector.java:128)     ... 7 more`  debugåˆ°BooleanMutexè¿™ä¸ªç±» è¿™ä¸ªgetæ²¡æ³•åŒæ­¥å¯¼è‡´è¶…æ—¶çš„ï¼Œå…·ä½“åŸå› æ²¡æœ‰æ‰¾åˆ°ï¼š ` public void get() throws InterruptedException {         this.sync.innerGet();     } ` åæ¥æŠŠserveræ¢æˆV1.0.21è¿˜æ˜¯ä¸è¡Œã€‚ æ˜¯ä¸æ˜¯åœ¨zké‡Œä¿ç•™äº†ç‰ˆæœ¬ä¸å…¼å®¹çš„ä¿¡æ¯ã€‚ æ˜¯21clientä¸èƒ½é…åˆ22çš„serverå—ï¼Ÿ è°¢è°¢ã€‚ è¿™ä¸ªé”™è¯¯æ€ä¹ˆè§£è¯»ï¼Ÿ ERROR  ZkEventThread - Error handling event ZkEvent[Data of /otter/canal/destinations/user/1001/running changed sent to com.alibaba.otter.canal.client.impl.running.ClientRunningMonitor$1@5789b4d3] zk Node [/otter/canal/destinations/user/1001/running ] æ˜¯: {"active":true "address":"10.1.193.0" "clientId":1001} 1.  java.net.ConnectException: Operation timed out at ï¼Œæ˜¯è¿ä¸ä¸Šserveræˆ–è€…é“¾æ¥è¶…æ—¶ 2.  Error handling event å¼‚å¸¸æ˜¯å› ä¸ºtimeoutå¼•èµ·çš„ï¼Œå…ˆè§£å†³1çš„é—®é¢˜ è°¢è°¢ï¼Œå› ä¸ºserverç½‘ç»œç¯å¢ƒä¸‹æœ‰ä¸¤ä¸ªIPåœ°å€ ï¼Œ å¦‚æœä¸è®¾ç½®IPï¼Œé»˜è®¤çš„åœ¨clientæ˜¯æ— æ³•è¿æ¥å¯¼è‡´çš„ã€‚ ServeræŒ‡å®šäº†IPåï¼ŒClientç«¯è¿˜æ˜¯æŠ›äº†ç±»ä¼¼çš„é”™è¯¯ã€‚ ` ClientRunningMonitor - canal is running in [10.1.193.0]   but not in [192.168.56.1:64327] ` clientç«¯ä¹Ÿæ˜¯ä¸¤ä¸ªIPï¼Œæ²¡æœ‰æ‰¾åˆ°é…ç½®ï¼Œä¸çŸ¥é“æ˜¯å¦å¯ä»¥æŒ‡å®šclientç«¯çš„IPï¼ï¼ˆ10æ®µçš„IPä¸é€šï¼Œéƒ½é»˜è®¤äº†ï¼Œ192æ®µçš„IPæ˜¯ä¸€ä¸ªå±€åŸŸç½‘çš„ï¼‰ clientæ²¡æœ‰æŒ‡å®šipä¸€è¯´ï¼Œè¿™æ˜¯AddressUtils.getHostIp()è¿”å›çš„ä¿¡æ¯å’Œå»ºç«‹socketçš„ipä¸ä¸€è‡´ å…ˆç®€å•å¼„ä¸ªå•ipçš„å®¢æˆ·ç«¯æœºå™¨å§ 
154,canal binlogè§£ææŠ¥é”™ æŠ¥é”™æ—¥å¿—ï¼š Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: java.lang.IllegalArgumentException: limit excceed: 367     at com.taobao.tddl.dbsync.binlog.LogBuffer.getFullString(LogBuffer.java:1122) ~[canal.parse.dbsync-1.0.21.jar:na]     at com.taobao.tddl.dbsync.binlog.event.RowsLogBuffer.fetchValue(RowsLogBuffer.java:920) ~[canal.parse.dbsync-1.0.21.jar:na]     at com.taobao.tddl.dbsync.binlog.event.RowsLogBuffer.nextValue(RowsLogBuffer.java:96) ~[canal.parse.dbsync-1.0.21.jar:na]     at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseOneRow(LogEventConvert.java:462) ~[canal.parse-1.0.21.jar:na]     at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:378) ~[canal.parse-1.0.21.jar:na]     at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:109) ~[canal.parse-1.0.21.jar:na]     at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:62) ~[canal.parse-1.0.21.jar:na]     at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:323) ~[canal.parse-1.0.21.jar:na]     at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:176) ~[canal.parse-1.0.21.jar:na]     at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:121) ~[canal.parse-1.0.21.jar:na]     at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) ~[canal.parse-1.0.21.jar:na] mysql 5.6.27  1. æ˜¯å¦å¯ä»¥é‡ç°ï¼Ÿæ¯”å¦‚ä»€ä¹ˆæ ·çš„sqlå¯ä»¥é€ æˆè¿™æ ·çš„é—®é¢˜ï¼Ÿ 2. æ˜¯å¦å¯ä»¥æä¾›binlogæ–‡ä»¶ [root@69_114 mysql]# mysqlbinlog --no-defaults --base64-output=decode-rows -v --start-position=214215706  /data2/logs/mysql/mysql-bin.000105  |more /_!50530 SET @@SESSION.PSEUDO_SLAVE_MODE=1_/; /_!40019 SET @@session.max_insert_delayed_threads=0_/; /_!50003 SET @OLD_COMPLETION_TYPE=@@COMPLETION_TYPE COMPLETION_TYPE=0_/; DELIMITER /_!_/; # at 214215706 # at 214216435 #160324 14:16:33 server id 6915  end_log_pos 214216533  Table_map: `crm`.`t_product` mapped to number 78 # at 214216533 #160324 14:16:33 server id 6915  end_log_pos 214216647  Update_rows: table id 78 flags: STMT_END_F ### UPDATE `crm`.`t_product` ### WHERE ### @1=598342 ### SET ### @3='å…¨è½¦æŠ›å…‰' ### @4=30000 ### @5=30000 ### @6=38800 ### @7='æ´—è½¦+å»æ±¡+æŠ›å…‰' ### @11='1' ### @12='9' ### @15='5' ### @18='2016-03-24 14:16:33' ### @19='18699926655' # at 214216647 # at 214217458 #160324 14:16:33 server id 6915  end_log_pos 214217547  Table_map: `crm`.`t_sys_log` mapped to number 82 # at 214217547 #160324 14:16:33 server id 6915  end_log_pos 214218065  Write_rows: table id 82 flags: STMT_END_F ### INSERT INTO `crm`.`t_sys_log` ### SET ### @1=908095 ### @2='1458800193776' ### @3='DMLæ—¥å¿—' ### @4='1001' ### @5='ä¿®æ”¹' ### @6='modify' ### @7='å•†å“[å…¨è½¦æŠ›å…‰]' ### @8='598342' ### @9='' ### @10='{"clearAmt":30000 "dataFlag":"" "firstCategory":"1" "marketAmt":38800 "myself":false "pageNum":1 "pageSize":10 "product4SVo":{"carTypeName":""} "productDesc":"æ´—è½¦+å»æ±¡+æŠ›å…‰" "productId":"598342" "p roductName":"å…¨è½¦æŠ›å…‰" "productStatus":"5" "saleAmt":30000 "secondCategory":"9" "storeId":"33813" "sysLogList":[] "updateUser":"18699926655"}' ### @11='æ“ä½œæˆåŠŸ' ### @12=18 ### @13='2016-03-24 14:16:33' ### @14='18699926655' ### @15='2016-03-24 14:16:33' ### @16='18699926655' [EntryPosition[included=false journalName=mysql-bin.000105 position=214215706 timestamp=1458800193000]] com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: java.lang.IllegalArgumentException: limit excceed: 3332     at com.taobao.tddl.dbsync.binlog.LogBuffer.getFullString(LogBuffer.java:1122) ~[canal.parse.dbsync-1.0.20.jar:na]     at com.taobao.tddl.dbsync.binlog.event.RowsLogBuffer.fetchValue(RowsLogBuffer.java:917) ~[canal.parse.dbsync-1.0.20.jar:na]     at com.taobao.tddl.dbsync.binlog.event.RowsLogBuffer.nextValue(RowsLogBuffer.java:96) ~[canal.parse.dbsync-1.0.20.jar:na] canal 1.0.20 my.cnf   binlog-row-image=minimal æ”¹ä¸ºfull æ­£å¸¸äº†ï¼ å°è±¡ä¸­canal1.0.21æ‰æ”¯æŒminimalæ¨¡å¼ï¼Œæä¾›binlogçš„åŸå§‹äºŒè¿›åˆ¶æ–‡ä»¶è€Œä¸æ˜¯è§£æåçš„æ–‡æœ¬ canal1.0.21 canal1.0.22-sanpshot éƒ½ä¸è¯•è¿‡ ä¸è¡Œï¼ è‡ªå·±åšä¸‹ä»£ç debugï¼Œæˆ–è€…æä¾›å¤ç°çš„åŠæ³•ï¼Œæˆ–è€…æä¾›åŸå§‹çš„binlogäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸ç„¶æˆ‘ä¹Ÿå¸®ä¸äº† è‡ªå·±åšä¸‹ä»£ç debugï¼Œæˆ–è€…æä¾›å¤ç°çš„åŠæ³•ï¼Œæˆ–è€…æä¾›åŸå§‹çš„binlogäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸ç„¶æˆ‘ä¹Ÿå¸®ä¸äº† 2016-03-30 10:55:31.825 [destination = example   address = /127.0.0.1:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - ERROR ## parse this event has an error   last position : [EntryPosition[included=false journalName=mysql-bin.000052 position=35751033 timestamp=1459305662000]] com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: java.lang.IllegalArgumentException: limit excceed: 3332         at com.taobao.tddl.dbsync.binlog.LogBuffer.getFullString(LogBuffer.java:1122)  
153,canalæ— æ³•å…³é—­çš„é—®é¢˜ å½“å¼€å¯äº†canal.auto.scanåŠŸèƒ½ï¼Œå¹¶ä¸”å®é™…æ‰§è¡Œè¿‡åŠ¨æ€å¢å‡instanceçš„æ“ä½œåã€‚ æ‰§è¡Œsh stop.shï¼Œæ— æ³•å…³é—­canalæœåŠ¡å™¨ï¼Œä¸€ç›´å¤„äºå¡æ­»ç­‰å¾…çŠ¶æ€ï¼Œåªèƒ½é€šè¿‡killç»“æŸè¿›ç¨‹ æ‰§è¡Œstopä¹‹åï¼Œæ‰§è¡Œä¸€ä¸‹jstackè·å–ä¸€ä¸‹çº¿ç¨‹å †æ ˆ åŸºäºå½“å‰æœ€æ–°ç‰ˆæš‚æ— å‘ç°stopå¤±è´¥çš„é—®é¢˜ 
152,canalæ˜¯å¦å’ŒMQæ¶ˆæ¯ä¸€æ ·åªèƒ½ä¿è¯æœ€å°‘ä¸€æ¬¡ï¼Œä¸èƒ½ä¿è¯åªæœ‰ä¸€æ¬¡ã€‚ åœ¨æ•°æ®åº“ä¸»å¤‡åˆ‡æ¢ï¼Œcanalå´©æºƒé‡å¯ç­‰æƒ…å†µï¼Œcanalæ˜¯å¦ä¼šé‡å¤å‘é€æ¶ˆæ¯ï¼Ÿå‡ºç°ç›¸åŒçš„insertè¯­å¥ã€‚ æ¶‰åŠå¤ªå¤šç½‘ç»œå› ç´  æ²¡æ³•ä¿è¯. ç›®å‰æ‰€è°“çš„é«˜æ€§èƒ½MQä¹Ÿä¿è¯ä¸äº†ä¸é‡å¤ï¼Œé¡¶å¤šæ˜¯åŸºäºä¸€äº›å­˜å‚¨åšäº†ä¸€äº›å»é‡å¤„ç†ï¼Œè¦ç†è§£ç½‘ç»œçš„ä¸å¯ç¡®å®šæ€§ é™¤äº†ç½‘ç»œå› ç´ ï¼Œæ˜¯å¦æœ‰æƒ…å†µä¸€å®šä¼šå‡ºç°é‡å¤æ¶ˆæ¯ï¼Œä¾‹å¦‚kill -9 canal pid ç„¶åé‡å¯ã€‚å¦‚æœæœ‰å¿…ç„¶å‡ºç°é‡å¤çš„æƒ…å†µï¼Œå¯ä»¥æ–¹ä¾¿è¿›è¡Œä¸€äº›æµ‹è¯•ã€‚ kill -9å°±æ˜¯ä¸€ç§ç½‘ç»œä¸ç¡®å®šå› ç´ ï¼Œæˆ‘æ•°æ®å‘ç»™ä½ äº†ï¼Œä½ è¿˜æ²¡è¿”å›ackç»™æˆ‘ï¼Œæˆ‘åªèƒ½ä¸‹æ¬¡å†å‘ç»™ä½  
151,jdkç‰ˆæœ¬ jdkä½¿ç”¨ä»€ä¹ˆç‰ˆæœ¬å¥½ æˆ‘ä»¬ä¹‹å‰éƒ½æ˜¯ç”¨1.6.25 otteræ·»åŠ æ•°æ®è¡¨çš„æ—¶å€™å¦‚ä½•åŒ¹é…å…¨åº“æ‰€æœ‰çš„è¡¨ å…ˆæŠŠwikiå’Œè§†é¢‘éƒ½çœ‹ä¸€é 
150,Merge pull request #1 from alibaba/master Merge pull request [![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/alibaba/canal?pullRequest=150) <br/>You should sign our Contributor License Agreement in order to get your pull request merged.<br/> 
149,å…³äºBINLOG_SEND_ANNOTATE_ROWS_EVENT åœ¨mysqlå®˜æ–¹æ–‡æ¡£ä¸­ï¼ŒåŸºäºCOM_BINLOG_DUMPåè®®çš„dumpè¯·æ±‚ä¸­flagsåªçœ‹åˆ°BINLOG_DUMP_NON_BLOCKè¿™ä¸€ç§ï¼Œè¯·é—®BINLOG_SEND_ANNOTATE_ROWS_EVENTä»£è¡¨ä»€ä¹ˆæ„æ€ï¼Ÿåœ¨å®˜æ–¹æ–‡æ¡£çš„å“ªé‡Œå¯ä»¥æ‰¾åˆ°ç›¸å…³è¯´æ˜ï¼Ÿ æœç´¢ï¼š mysql binlog protocol 
148,canalç›®å‰æ”¯æŒoracleå—ï¼Ÿ canalç›®å‰æ”¯æŒoracleå—ï¼Ÿåˆšçœ‹äº†ä¸€ä¸‹ä»£ç ï¼Œè²Œä¼¼è¿˜ä¸æ”¯æŒå§ï¼Ÿ [https://github.com/alibaba/canal/blob/master/instance/manager/src/main/java/com/alibaba/otter/canal/instance/manager/CanalInstanceWithManager.java#L295](https://github.com/alibaba/canal/blob/master/instance/manager/src/main/java/com/alibaba/otter/canal/instance/manager/CanalInstanceWithManager.java#L295) æ˜¯ä¸æ˜¯æ„å‘³ç€otterä¹Ÿåªæ”¯æŒmysqlï¼Œè¯»å’Œå†™éƒ½æ˜¯ï¼Ÿ å¯ä»¥çœ‹ä¸‹wikiï¼Œéƒ½æœ‰æ˜ç¡®æè¿°ï¼Œç›®å‰ä¸æ”¯æŒoracleï¼Œå¯¹äºoracleæœ‰éœ€æ±‚å¯ä»¥å‚è€ƒæˆ‘çš„å¦ä¸€ä¸ªé¡¹ç›®ï¼šhttps://github.com/alibaba/yugong Yugong æ”¯æŒoracleåˆ°mysql ï¼Œåè¿‡æ¥ä»mysql åˆ°oracleä¹Ÿæ”¯æŒå— yugongå¼€æºä¸æ”¯æŒmysql->oracle è¯·é—®oracleç‰ˆçš„canalå°±æ˜¯yugongä¹ˆï¼Ÿè¿˜æ˜¯æœ‰å¦ä¸€ä¸ªåŸºäºoggå®ç°çš„ç‰ˆæœ¬ï¼Ÿ https://github.com/alibaba/yugongï¼Œyugongæ˜¯åŸºäºoracleç‰©åŒ–è§†å›¾æ¥åšçš„ 
146,Canalå¯åŠ¨æˆåŠŸï¼Œä½†æ˜¯æŸ¥çœ‹instanceå‘ç°é”™è¯¯ ç³»ç»Ÿ CentOS6.5 æˆ‘çš„ /etc/my.cnf é…ç½®ï¼š _[mysqld] datadir=/var/lib/mysql socket=/var/lib/mysql/mysql.sock log-bin=mysql-bin binlog-format=ROW server_id=1 # Disabling symbolic-links is recommended to prevent assorted security risks symbolic-links=0 [mysqld_safe] log-error=/var/log/mysqld.log pid-file=/var/run/mysqld/mysqld.pid_ instance.properties é…ç½®ï¼š ``` $ cat conf/example/instance.properties  ################################################# ## mysql serverId canal.instance.mysql.slaveId = 1234 # position info canal.instance.master.address = 127.0.0.1:3306 canal.instance.master.journal.name =  canal.instance.master.position =  canal.instance.master.timestamp =  #canal.instance.standby.address =  #canal.instance.standby.journal.name = #canal.instance.standby.position =  #canal.instance.standby.timestamp =  # username/password canal.instance.dbUsername = canal canal.instance.dbPassword = canal canal.instance.defaultDatabaseName = canal.instance.connectionCharset = UTF-8 # table regex canal.instance.filter.regex = .*\\..* # table black regex canal.instance.filter.black.regex =   ################################################# ``` canal.log ä¿¡æ¯ï¼š ``` Java HotSpot(TM) 64-Bit Server VM warning: ignoring option PermSize=96m; support was removed in 8.0 Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=256m; support was removed in 8.0 Java HotSpot(TM) 64-Bit Server VM warning: UseCMSCompactAtFullCollection is deprecated and will likely be removed in a future release. 2016-03-04 23:01:39.529 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## start the canal server. 2016-03-04 23:01:39.735 [main] WARN  com.alibaba.otter.canal.common.utils.AddressUtils - Failed to retriving local host ip address  try scan network card ip address. cause: scidb-work601: scidb-work601: unknown error 2016-03-04 23:01:39.743 [main] INFO  com.alibaba.otter.canal.deployer.CanalController - ## start the canal server[192.168.100.113:11111] 2016-03-04 23:01:41.046 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## the canal server is running now ...... ``` example.logä¿¡æ¯ï¼š ``` 2016-03-04 23:01:40.378 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [canal.properties] 2016-03-04 23:01:40.414 [main] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [example/instance.properties] 2016-03-04 23:01:40.588 [main] WARN  org.springframework.beans.TypeConverterDelegate - PropertyEditor [com.sun.beans.editors.EnumEditor] found through deprecated global PropertyEditorManager fallback - consider using a more isolated form of registration  e.g. on the BeanWrapper/BeanFactory! 2016-03-04 23:01:40.840 [main] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start CannalInstance for 1-example 2016-03-04 23:01:40.884 [main] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start successful.... 2016-03-04 23:01:41.147 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /127.0.0.1:3306 has an error  retrying. caused by com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: connect /127.0.0.1:3306 failure:java.io.IOException: Error When doing Client Authentication:ErrorPacket [errorNumber=1045  fieldCount=-1  message=Access denied for user 'canal'@'localhost' (using password: YES)  sqlState=28000  sqlStateMarker=#]         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.negotiate(MysqlConnector.java:174)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:68)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:52)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:84)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:158)         at java.lang.Thread.run(Thread.java:745) Caused by: java.io.IOException: connect /127.0.0.1:3306 failure:java.io.IOException: Error When doing Client Authentication:ErrorPacket [errorNumber=1045  fieldCount=-1  message=Access denied for user 'canal'@'localhost' (using password: YES)  sqlState=28000  sqlStateMarker=#]         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.negotiate(MysqlConnector.java:174)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:68)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:52)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:84)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:158)         at java.lang.Thread.run(Thread.java:745)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:71) ~[canal.parse.driver-1.0.21.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:52) ~[canal.parse-1.0.21.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:84) ~[canal.parse-1.0.21.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:158) ~[canal.parse-1.0.21.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.8.0_73] 2016-03-04 23:01:41.150 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: java.io.IOException: connect /127.0.0.1:3306 failure:java.io.IOException: Error When doing Client Authentication:ErrorPacket [errorNumber=1045  fieldCount=-1  message=Access denied for user 'canal'@'localhost' (using password: YES)  sqlState=28000  sqlStateMarker=#]         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.negotiate(MysqlConnector.java:174)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:68)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:52)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:84)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:158)         at java.lang.Thread.run(Thread.java:745) Caused by: java.io.IOException: connect /127.0.0.1:3306 failure:java.io.IOException: Error When doing Client Authentication:ErrorPacket [errorNumber=1045  fieldCount=-1  message=Access denied for user 'canal'@'localhost' (using password: YES)  sqlState=28000  sqlStateMarker=#]         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.negotiate(MysqlConnector.java:174)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:68)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:52)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:84)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:158)         at java.lang.Thread.run(Thread.java:745)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:71)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:52)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:84)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:158)         at java.lang.Thread.run(Thread.java:745) ``` MySQL çš„ç”¨æˆ·æƒé™æŸ¥çœ‹ï¼š ``` mysql> SELECT DISTINCT CONCAT('User: ''' user '''@''' host ''';') AS query FROM mysql.user; +-------------------------------+ | query                         | +-------------------------------+ | User: 'canal'@'%';            | | User: 'root'@'127.0.0.1';     | | User: 'root'@'::1';           | | User: ''@'localhost';         | | User: 'root'@'localhost';     | | User: ''@'scidb-work601';     | | User: 'root'@'scidb-work601'; | +-------------------------------+ 7 rows in set (0.01 sec) ``` è‡ªå·±ç”¨clienté“¾æ¥ä¸‹mysql è¿™ä¸ªé—®é¢˜ä»Šå¤©è§£å†³äº†ï¼Œæ˜¯è¿™æ ·çš„ï¼Œå› ä¸ºä¸åŒçš„ç‰ˆæœ¬é—®é¢˜ï¼Œå¯¼è‡´åˆ›å»ºç”¨æˆ·çš„èµ‹äºˆæƒé™ï¼Œå¯†ç å‡ºç°äº†ä¸åŒï¼Œè®¾ç½®æˆ'%'çš„æ—¶å€™ï¼Œä¼šå¯¼è‡´ 'localhost'æ— æ³•ç™»å½•ã€‚ã€‚ã€‚éœ€è¦ç”¨å‘½ä»¤å•ç‹¬å»ç”¨'localhost'åœ¨è¿è¡Œä¸€æ¬¡ã€‚æˆ‘ç”¨çš„æ˜¯mysql5.5ç‰ˆæœ¬çš„ã€‚ã€‚ æˆ‘ä¹Ÿé‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼Œæœç´¢èµ„æ–™åï¼Œé€šè¿‡å¦‚ä¸‹æ–¹å¼è§£å†³ ```` å¢åŠ æ™®é€šç”¨æˆ·åï¼Œæ‰§è¡Œï¼š  mysql> use mysql  mysql> delete from user where user='';  mysql> flush privileges;  ```` ä¸çŸ¥é“å“ªé‡Œæ¥çš„åŒ¿åç”¨æˆ·ï¼Œå¥½å›§ æ”¹superæƒé™ï¼Œé‡å¯ï¼Œå¿…é¡»é‡å¯å•Šï¼ æŒ‰ç…§ @maoyikun çš„æ–¹æ³•è§£å†³äº† ç»™mysqlç”¨æˆ·æ·»åŠ superæƒé™ ç„¶å flush privileges; 2018-10-12 19:27:59.970 [destination = example   address = localhost/127.0.0.1:3306   EventParser] ERROR c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - dump address localhost/127.0.0.1:3306 has an error  retrying. caused by  java.lang.IllegalArgumentException: null 	at java.util.concurrent.ThreadPoolExecutor.<init>(ThreadPoolExecutor.java:1314) ~[na:1.8.0_181] 	at java.util.concurrent.ThreadPoolExecutor.<init>(ThreadPoolExecutor.java:1237) ~[na:1.8.0_181] 	at java.util.concurrent.Executors.newFixedThreadPool(Executors.java:151) ~[na:1.8.0_181] 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor.start(MysqlMultiStageCoprocessor.java:84) ~[canal.parse-1.1.0.jar:na] 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:238) ~[canal.parse-1.1.0.jar:na] 	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_181] 2018-10-12 19:27:59.975 [destination = example   address = localhost/127.0.0.1:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.lang.IllegalArgumentException 	at java.util.concurrent.ThreadPoolExecutor.<init>(ThreadPoolExecutor.java:1314) 	at java.util.concurrent.ThreadPoolExecutor.<init>(ThreadPoolExecutor.java:1237) 	at java.util.concurrent.Executors.newFixedThreadPool(Executors.java:151) 	at com.alibaba.otter.canal.parse.inbound.mysql.MysqlMultiStageCoprocessor.start(MysqlMultiStageCoprocessor.java:84) 	at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:238) 	at java.lang.Thread.run(Thread.java:748) ] 2018-10-12 19:28:16.965 [destination = example   address = localhost/127.0.0.1:3306   EventParser] WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - prepare to find start position just show master status æœåŠ¡ç«¯æ•°æ®åº“ä¸€æœ‰å˜åŠ¨å°±æŠ¥è¿™ä¸ªé”™è¯¯ï¼Œè¯·åŒä»å¸®å¿™çœ‹ä¸€ä¸‹ @shiyuan2he ä¸‹è½½æœ€æ–°çš„1.1.1ç‰ˆæœ¬ï¼Œå·²è§£å†³
145,æ·»åŠ rowdataè¿‡æ»¤ ä¸ºparseRowsEventæ–¹æ³•æ·»åŠ rowdataè¿‡æ»¤ï¼Œå¯ä»¥è¿‡æ»¤æ‰rowdataæ•°æ®ï¼Œç”¨äºä»…è®¢é˜…é™¤rowdataä»¥å¤–çš„æ•°æ® éº»çƒ¦å†å®¡æ ¸ä¸€ä¸‹ï¼Œå¤šè°¢ tks 
144,æ³¨é”€çˆ¶ç±»å·²ç»æœ‰çš„å±æ€§ï¼Œé¿å…super.start()è°ƒç”¨äº†æ²¡æœ‰åœ¨å­ç±»åˆå§‹åŒ–çš„åŒåå±æ€§ fix issue:masteråˆ†æ”¯ä»£ç åœ¨ä½¿ç”¨OTTERæ—¶æŠ¥NullPointerException #143 tks 
143,masteråˆ†æ”¯ä»£ç åœ¨ä½¿ç”¨OTTERæ—¶æŠ¥NullPointerException ``` pid:1 nid:1 exception:setl:java.lang.NullPointerException at com.alibaba.otter.canal.instance.core.AbstractCanalInstance.start(AbstractCanalInstance.java:73) at com.alibaba.otter.canal.instance.manager.CanalInstanceWithManager.start(CanalInstanceWithManager.java:110) at com.alibaba.otter.canal.server.embedded.CanalServerWithEmbedded.start(CanalServerWithEmbedded.java:102) at com.alibaba.otter.node.etl.select.selector.canal.CanalEmbedSelector.start(CanalEmbedSelector.java:206) at com.alibaba.otter.node.etl.select.SelectTask.startup(SelectTask.java:170) at com.alibaba.otter.node.etl.select.SelectTask.run(SelectTask.java:126) ``` åŸå› æ˜¯ï¼šCanalInstanceWithManager ä¸ AbstractCanalInstanceå£°æ˜äº†ç›¸åŒåå­—çš„å±æ€§ï¼Œ CanalInstanceWithManager.java 110è¡Œè°ƒç”¨äº†super.start()ï¼Œè°ƒç”¨äº†çˆ¶ç±»æ²¡æœ‰åˆå§‹åŒ–çš„å±æ€§å¯¼è‡´çš„ã€‚ ``` public void start() {         // åˆå§‹åŒ–metaManager         logger.info("start CannalInstance for {}-{} with parameters:{}"  canalId  destination  parameters);         **super.start();//110è¡Œ**     } ``` 
142,canal1.0.21ç‰ˆæœ¬ä¸­zkclientå’Œkafka zkclientç‰ˆæœ¬å†²çªé—®é¢˜ canalå’Œkafkaä¸€å—ç”¨çš„æ—¶å€™ canal1.0.21ç‰ˆæœ¬ä¸­zkclient(com.github.sgroschupf )å’Œkafkaä¸­zkclientç‰ˆæœ¬(com.101tec:zkclient)å†²çª artifactIdä¸ä¸€æ · ä¸å¥½æ’é™¤åŒ…  è¿™ç§é—®é¢˜æœ‰ä»€ä¹ˆè§£å†³æ–¹æ¡ˆå— å¤šè°¢å•Š  ä¸ºä»€ä¹ˆå½“æ—¶ä¸ä½¿ç”¨com.101tecè¿™ä¸ªç¨å¾®å¤§ä¼—çš„zkclientç‰ˆæœ¬ è¿™ä¸ªissueä¸ºä»€ä¹ˆå…³æ‰äº†å‘€ï¼Œæˆ‘ä»Šå¤©åœ¨1.0.24ç‰ˆæœ¬ä¸Šä¹Ÿé‡åˆ°è¿™ä¸ªé—®é¢˜ è¿™ä¸ªåŒ…å†å²æœ‰ç‚¹æ‚ ä¹…ï¼Œå¦‚æœæ–¹ä¾¿å¯ä»¥æäº¤ä¸€ä¸ªPRç»™æˆ‘
141,è¯·æ•™å‡ ä¸ªCanalä½¿ç”¨çš„å‡ ä¸ªé—®é¢˜ï¼Œå¤šè°¢ 1ã€æ–‡æ¡£è¯´å¤šä¸ªcanalå®ä¾‹çš„serverIdä¸èƒ½é‡å¤ï¼Œè¯·é—®æœ‰å•¥å½±å“ï¼Ÿæˆ‘è¯•çš„å¥½åƒæ²¡ä»€ä¹ˆé—®é¢˜ 2ã€instance.propertiesé‡Œé¢çš„æ­£åˆ™ç›‘å¬ä¸€ä¸ªè¡¨å’Œå¤šä¸ªè¡¨å¯¹canalæœåŠ¡ç«¯æ€§èƒ½å½±å“å¤§å—ï¼Œå› ä¸ºæˆ‘ä»¬çš„è¡¨æ˜¯åŠ¨æ€ç”Ÿæˆçš„ï¼Œå¦‚æœå½±å“ä¸å¤§åœ¨å®¢æˆ·ç«¯åŠ¨æ€è®¢é˜…å°±å¥½äº† 3ã€å¤šä¸ªotterå®¢æˆ·ç«¯è¿æ¥åŒä¸€ä¸ªcanalæ—¶æˆ‘å‘ç°ä¸€æ¡æ¶ˆæ¯åªä¼šæ”¶åˆ°ä¸€æ¬¡ï¼Œè¯·é—®è¿™ä¸ªç‰¹æ€§é è°±å—ï¼Ÿ 1. åŒä¸€ä¸ªmysqlä¸»å¤‡é›†ç¾¤serverIdï¼Œå‡ºç°é‡å¤çš„æ—¶å€™ï¼Œmysqlä¼šéšæœºkillä¸€ä¸ªå®¢æˆ·ç«¯é“¾æ¥  2. æ­£åˆ™è¡¨è¾¾å¼ä¼šæœ‰é•¿åº¦é™åˆ¶ï¼Œç›¸æ¯”äºæ­£åˆ™è®¡ç®—ï¼Œç½‘ç»œI/Oä¼šå…ˆæˆä¸ºç“¶é¢ˆ 3. å»ºè®®ä¸€ä¸ªserveråªæœ‰ä¸€ä¸ªclientï¼Œserverå’Œclientéƒ½ä½¿ç”¨HAçš„æ¨¡å¼ï¼Œå¯ä»¥ä¿è¯åªæœ‰ä¸€ä¸ªclientå·¥ä½œï¼Œå¹¶ä¸”clientèƒ½æ”¶åˆ°å…¨éƒ¨æ•°æ® 
140,æ˜¯å¦æ”¯æŒpythonå®¢æˆ·ç«¯è¯»å–åŒæ­¥çš„binlog? æ˜¯å¦æ”¯æŒpythonå®¢æˆ·ç«¯è¯»å–åŒæ­¥çš„binlog? canalç›®å‰åªæä¾›äº†javaç‰ˆæœ¬ï¼Œserveré‡‡ç”¨äº†protobufåè®®è¿›è¡Œé€šè®¯ï¼Œå¯ä»¥æŒ‰ç…§åè®®éœ€æ±‚è‡ªè¡Œå®Œæˆä¸€ä¸ªpython clientç‰ˆæœ¬å¼€å‘ 
139,å…³é—­canalä¹‹åmysqlè¿æ¥æœªé‡Šæ”¾ **ä½¿ç”¨canalæ—¶ï¼Œå‘ç°å½“mysqlåº“æ²¡æœ‰ä»»ä½•binlogäº§ç”Ÿæ—¶ï¼Œå…³é—­canalåéƒ¨åˆ†mysqlè¿æ¥æœªé‡Šæ”¾ã€‚** mysqlç‰ˆæœ¬ï¼š5.6.24-72.2-log canalç‰ˆæœ¬ï¼š1.0.21 å…³é—­å‰çš„å †æ ˆä¿¡æ¯å¦‚ä¸‹ï¼š ``` "destination = 90   address = /192.168.12.110:3309   HeartBeatTimeTask" daemon prio=10 tid=0x00007f4b2c00d000 nid=0x395b in Object.wait() [0x00007f4b51d13000]    java.lang.Thread.State: TIMED_WAITING (on object monitor)         at java.lang.Object.wait(Native Method)         at java.util.TimerThread.mainLoop(Timer.java:552)         - locked <0x000000076052ffa8> (a java.util.TaskQueue)         at java.util.TimerThread.run(Timer.java:505) "destination = 90   address = /192.168.12.110:3309   EventParser" prio=10 tid=0x00007f4bd073e800 nid=0x395a runnable [0x00007f4b51d54000]    java.lang.Thread.State: RUNNABLE         at sun.nio.ch.FileDispatcherImpl.read0(Native Method)         at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)         at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)         at sun.nio.ch.IOUtil.read(IOUtil.java:197)         at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379)         - locked <0x0000000760a5efb0> (a java.lang.Object)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:154)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209)         at java.lang.Thread.run(Thread.java:745) ``` å…³é—­å‰çš„mysqlè¿æ¥ä¿¡æ¯å¦‚ä¸‹ï¼š ``` mysql> show processlist; | 442033 | xxx | 192.168.201.174:47598 | NULL | Sleep       |       4 |                                                                       | NULL             |         1 |             1 | | 442035 | xxx | 192.168.201.174:47600 | NULL | Binlog Dump |       4 | Master has sent all binlog to slave; waiting for binlog to be updated | NULL             |         0 |             0 | ``` **æ‰§è¡Œ./bin/stop.shåï¼Œå‘ç°442035è¿æ¥æœªé‡Šæ”¾ï¼ï¼ï¼** ./log/90/90.logå¦‚ä¸‹ï¼š ``` 2016-01-14 11:55:11.655 [Thread-5] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - stop CannalInstance for 1-90 2016-01-14 11:55:11.670 [Thread-5] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - disConnect MysqlConnection to /192.168.12.110:3309... 2016-01-14 11:55:11.675 [destination = 90   address = /192.168.12.110:3309   EventParser] INFO  c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - I/O interrupted while readi ng from client socket java.nio.channels.ClosedByInterruptException: null         at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:202) ~[na:1.7.0_55]         at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:412) ~[na:1.7.0_55]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch0(DirectLogFetcher.java:154) ~[canal.parse-1.0.21-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:70) ~[canal.parse-1.0.21-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:113) [canal.parse-1.0.21-SNAPSHOT.jar:na]         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) [canal.parse-1.0.21-SNAPSHOT.jar:na]         at java.lang.Thread.run(Thread.java:745) [na:1.7.0_55] 2016-01-14 11:55:11.676 [destination = 90   address = /192.168.12.110:3309   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - the channel /192.168.12.110 :3309 is not connected 2016-01-14 11:55:11.676 [destination = 90   address = /192.168.12.110:3309   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - disConnect MysqlConnection to /192.168.12.110:3309... 2016-01-14 11:55:11.677 [Thread-5] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - stop successful.... 2016-01-14 11:55:11.677 [Thread-5] INFO  c.a.otter.canal.server.embedded.CanalServerWithEmbedded - stop CanalInstances[90] successfully ``` å¦å¤–ï¼Œå¶å°”è¿˜ä¼šå‡ºç°ä»¥ä¸‹è«åmysqlè¿æ¥ï¼š ![image](https://cloud.githubusercontent.com/assets/7714843/12315487/4bcd3586-bab6-11e5-8a34-4c15758cab19.png) stopæ‰§è¡Œåï¼Œjvmæ˜¯å¦å·²ç»å®Œæ•´é€€å‡ºï¼Ÿ @agapple jvmè¿›ç¨‹å·²å®Œæ•´é€€å‡ºã€‚ JVMé€€å‡ºï¼ŒTCPç…§ç†åº”è¯¥å®Œå…¨é€€å‡ºï¼Œç¡®è®¤ä¸‹æ˜¯å¦æ˜¯canalå¯¹åº”è¿›ç¨‹ä¹‹å‰çš„TCPé“¾æ¥ ç¡®å®æ˜¯canalçš„è¿æ¥ ç»è¿‡debugæµ‹è¯•ï¼Œcanalå·²ç»æ­£ç¡®å…³é—­äº†socketï¼Œåªä¸è¿‡éƒ¨åˆ†æƒ…å†µä¸‹æ“ä½œç³»ç»Ÿçš„tcpé“¾æ¥ä¼šä¸€ç›´å¤„äºclose_waitçŠ¶æ€ï¼Œå¯ä»¥é€šè¿‡è°ƒæ•´æ“ä½œç³»ç»Ÿå‚æ•°ï¼ŒåŠ é€Ÿå›æ”¶è¿™ç±»çŠ¶æ€çš„é“¾æ¥.  mysql binlogdumpä¸ºæœåŠ¡ç«¯ä¸»åŠ¨æ¨é€æ•°æ®æ¨¡å¼ï¼Œåœ¨å®¢æˆ·ç«¯å‘èµ·socket.closeä¹‹åï¼ŒæœåŠ¡ç«¯ä¸€è‡´ä¸ºå‘é€ACKåŒ…å¯¼è‡´ä¸€è‡´å¤„äºCLOSE_WAITçŠ¶æ€.  é‡‡å–çš„ç­–ç•¥ï¼šé’ˆå¯¹binlog dumpé“¾æ¥ åœ¨socket.closeå®Œæˆä¹‹å å†æ–°å¼€ä¸€ä¸ªé“¾æ¥å‘èµ·ä¸€æ¬¡KILL CONNECTION   IDè¯·æ±‚å½»åº•å…³é—­binlogdumpé“¾æ¥.  MysqlConnector 106è¡Œ forkå‡ºä¸€ä¸ªè¿æ¥å»KILL CONNECTIONæ—¶å¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œä¸å»ºè®®æŠ›å‡ºå»ï¼Œè®°ä¸€ä¸‹logå°±å¥½äº†ï¼Œæ¯•ç«Ÿæ˜¯éä¸»è¦æµç¨‹ ä»Šå¤©æˆ‘çœ‹æ—¥å¿—ï¼Œä¸€ç›´åœ¨æ­»å¾ªç¯çš„æŠ¥è¿™ä¸ªï¼š ``` 2016-08-10 15:44:48.865 [destination = ucarorder_to_es   address = /10.101.23.101:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position by switch ::1470729600000 2016-08-10 15:44:49.366 [destination = ucarorder_to_es   address = /10.101.23.101:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - ERROR ## findAsPerTimestampInSpecificLogFile has an error java.io.IOException: KILL DUMP 7265038 failure:java.io.IOException: ErrorPacket [errorNumber=1094  fieldCount=-1  message=Unknown thread id: 7265038  sqlState=HY000  sqlStateMarker=#]  with command: KILL CONNECTION 7265038         at com.alibaba.otter.canal.parse.driver.mysql.MysqlUpdateExecutor.update(MysqlUpdateExecutor.java:49)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.disconnect(MysqlConnector.java:104)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.reconnect(MysqlConnector.java:82)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.reconnect(MysqlConnection.java:56)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findAsPerTimestampInSpecificLogFile(MysqlEventParser.java:674)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findByStartTimeStamp(MysqlEventParser.java:519)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPositionInternal(MysqlEventParser.java:420)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPosition(MysqlEventParser.java:313)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:162)         at java.lang.Thread.run(Thread.java:745) ``` ä½†æ˜¯æˆ‘é‡å¯åå°±æ— æ³•é‡ç°äº†ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæä¸€ä¸‹ï¼Œçœ‹æœ‰æ²¡æœ‰åˆ«äººé‡åˆ°è¿‡è¿™ä¸ªé—®é¢˜ã€‚ æœ€æ–°ä»£ç å·²ç»æäº¤ï¼Œåªè®°å½•äº†å¼‚å¸¸ï¼Œæ²¡æœ‰å¾€å¤–æŠ› 2016-08-10 18:59 GMT+08:00 hechaoyi notifications@github.com: > MysqlConnector 106è¡Œ > forkå‡ºä¸€ä¸ªè¿æ¥å»KILL CONNECTIONæ—¶å¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œä¸å»ºè®®æŠ›å‡ºå»ï¼Œè®°ä¸€ä¸‹logå°±å¥½äº†ï¼Œæ¯•ç«Ÿæ˜¯éä¸»æ”¯æµç¨‹ >  > ä»Šå¤©æˆ‘çœ‹æ—¥å¿—ï¼Œä¸€ç›´åœ¨æ­»å¾ªç¯çš„æŠ¥è¿™ä¸ªï¼š >  > 2016-08-10 15:44:48.865 [destination = ucarorder_to_es   address = /10.101.23.101:3306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position by switch ::1470729600000 > 2016-08-10 15:44:49.366 [destination = ucarorder_to_es   address = /10.101.23.101:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - ERROR ## findAsPerTimestampInSpecificLogFile has an error > java.io.IOException: KILL DUMP 7265038 failure:java.io.IOException: ErrorPacket [errorNumber=1094  fieldCount=-1  message=Unknown thread id: 7265038  sqlState=HY000  sqlStateMarker=#] >  with command: KILL CONNECTION 7265038 >         at com.alibaba.otter.canal.parse.driver.mysql.MysqlUpdateExecutor.update(MysqlUpdateExecutor.java:49) >         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.disconnect(MysqlConnector.java:104) >         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.reconnect(MysqlConnector.java:82) >         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.reconnect(MysqlConnection.java:56) >         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findAsPerTimestampInSpecificLogFile(MysqlEventParser.java:674) >         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findByStartTimeStamp(MysqlEventParser.java:519) >         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPositionInternal(MysqlEventParser.java:420) >         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.findStartPosition(MysqlEventParser.java:313) >         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:162) >         at java.lang.Thread.run(Thread.java:745) >  > ä½†æ˜¯æˆ‘é‡å¯åå°±æ— æ³•é‡ç°äº†ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæä¸€ä¸‹ï¼Œçœ‹æœ‰æ²¡æœ‰åˆ«äººé‡åˆ°è¿‡è¿™ä¸ªé—®é¢˜ã€‚ >  > â€” > You are receiving this because you were assigned. > Reply to this email directly  view it on GitHub > https://github.com/alibaba/canal/issues/139#issuecomment-238834028  or mute > the thread > https://github.com/notifications/unsubscribe-auth/AAy8t3RasGIBbgz1EEZps-j345g6Cc3uks5qea79gaJpZM4HElfj > . 
138,make canal server become a single instance ç†è®ºä¸Šä¸€ä¸ªJVMè¿›ç¨‹åªéœ€è¦ä¸€ä¸ªCanalServerå®ä¾‹ï¼Œç”±CanalServerç®¡ç†å¤šä¸ªCanalInstanceï¼› å…ˆå°†è¿™é‡Œæ”¹æˆå•ä¾‹ï¼Œåç»­å¥½ä¿®æ”¹otterä»£ç  å¢åŠ äº†AbstractCanalInstanceï¼Œç§»é™¤CanalInstanceå­ç±»çš„å¤§é‡é‡å¤ä»£ç  Canalä»£ç ä¸åº”ä»¥æ”¯æŒOtteræœªå‰æï¼Œå¦‚æœè¿™éƒ¨åˆ†ä»£ç æ²¡æœ‰é—®é¢˜ï¼Œæ‰“ç®—ç€æ‰‹ä¿®æ”¹Otterçš„CanalServerå®ç° èµèµå“’ğŸ‘ æäº¤PRçš„è¡Œä¸ºå€¼å¾—è‚¯å®šå’Œé¼“åŠ± 
137,java.lang.ArrayIndexOutOfBoundsException: 0 com.alibaba.otter.canal.parse.inbound.mysql.dbsync.SimpleDdlParser.parseTableName(SimpleDdlParser.java:163) ç‰ˆæœ¬1.0.19 é”™è¯¯å¦‚ä¸‹ï¼š ![qq 20151218092517](https://cloud.githubusercontent.com/assets/11752250/11886867/b88a512a-a569-11e5-9dba-1feaa8a6637c.png) binlogä½ç½®å¦‚ä¸‹ï¼š ![qq 20151218092527](https://cloud.githubusercontent.com/assets/11752250/11886874/c864b91e-a569-11e5-8677-c808ef22c33d.png)  ä½¿ç”¨pt-online-schema-changeå˜æ›´å­—æ®µåå‡ºç°è¿™ç§æƒ…å†µ https://github.com/alibaba/canal/pull/128ï¼Œå·²ç»æœ‰ç”¨æˆ·ä¿®å¤ï¼Œæ–°ç‰ˆæœ¬å‘å¸ƒåå³å¯ï¼Œæˆ–è€…å¯è‡ªè¡Œæ‰“åŒ…å½“å‰master 
136,Tableæ— ä¸»é”®æ—¶ï¼Œinsertæ•°æ®ä¼šå¯¼è‡´columnInfoå’ŒtableMetaçš„sizeä¸åŒ¹é…ï¼Œä»è€Œinstanceç›‘æ§hangæ‰ é—®é¢˜æè¿°å¦‚é¢˜ï¼Œä»¥ä¸‹ä¸ºerror log 2015-12-03 16:27:55.718 [destination =    address =    EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:crm[com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: column size is not match for table:`s1`.`t1` 6 vs 5 ] column size is not match for table:s1.t1 6 vs 5.  åº”è¯¥æ˜¯åšäº†å­—æ®µåˆ é™¤æ“ä½œï¼Œå’Œä¸»é”®æ— å…³ æœªåšè¿‡å­—æ®µåˆ é™¤ï¼Œè€Œä¸”æ·»åŠ ä¸»é”®åå°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜äº†ã€‚ ä¸ªäººçŒœæµ‹æ˜¯å› ä¸ºmysqlå¯¹æ— ä¸»é”®çš„è¡¨ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªéšè—ä¸»é”®ï¼Œbinlogä¸­å¸¦æœ‰è¿™ä¸ªéšè—ä¸»é”®çš„æ•°æ®ï¼Œè€ŒtableMetaä¸­åˆ™æ²¡æœ‰æ­¤å­—æ®µï¼Œä¸¤è¾¹æ— æ³•å¯¹åº”ï¼Œå› æ­¤ç¨‹åºæŠ¥é”™ã€‚å¯¹äºè¿™ç§æƒ…å†µå¯å¦ä½œé€‚å½“å¤„ç†ï¼Ÿ ä½ æµ‹è¯•çš„æ˜¯RDSå§ï¼ŸRDSçš„ç¡®é»˜è®¤ä¼šå¯¹æ— ä¸»é”®è¡¨æ·»åŠ éšè—å­—æ®µï¼Œéœ€è¦superæƒé™æ‰å¯è§ æ˜¯RDSï¼Œæœ‰ä»€ä¹ˆæ¨èçš„è§£å†³æ–¹æ¡ˆå—ï¼Ÿç›®å‰æˆ‘ä»¬éœ€ç›‘æµ‹RDSåº“ï¼Œè¿™æ ·çš„æƒ…å†µå¸¸å¸¸ä¼šä½¿canalå‡ºé—®é¢˜ ä½¿ç”¨æ–°RDSçš„è‡ªä¸»ç”¨æˆ·æƒé™ï¼Œå¯¹canalæˆæƒsuperæƒé™ @Librazk  rdsèƒ½ç”¨canalå—ï¼Ÿæ€ä¹ˆç© rdsä¸»å¤‡åˆ‡æ¢ç›®å‰æ²¡æœ‰å¾ˆå¥½çš„å¤„ç†ï¼Œä¼šå¯¼è‡´ä½ç‚¹æŠ¥é”™ é‚£éœ€è¦æ¸…ç©ºcanalä¸Šçš„meta.batæ–‡ä»¶ï¼Œè®©canalé‡æ–°è‡ªåŠ¨è·å–æœ€æ–°ç‚¹ä½ï¼Ÿ ç›®å‰æ˜¯çš„ï¼Œå¯¹äºvipæ¨¡å¼çš„RDSæ”¯æŒä¸å¥½ è¿™æ ·ä¼šæ¼æ•°æ®çš„ å› ä¸ºæ¸…ç©ºmetaæ–‡ä»¶ å»slavaä¸Šæ‹¿çš„æ˜¯æœ€æ–°çš„positionå§  åœ¨å‘ç°masterè¢«åˆ‡çš„è¿™ä¸€æ®µæ—¶é—´çš„æ•°æ®å°±æ²¡äº† è®°å½•ä¸Šä¸€æ¬¡metaæ–‡ä»¶é‡Œçš„æ—¶é—´æˆ³ï¼ŒåŸºäºæ—¶é—´æˆ³é‡æ–°å®šä½ RDSæ— ä¸»é”®è¡¨ä¼šæœ‰ä¸€ä¸ªéšè—åˆ—ï¼š**#alibaba_rds_row_id#**ï¼Œä¼šåœ¨æ¯å¼ è¡¨çš„æœ€åä¸€åˆ—ä¸”ä¸ºintç±»å‹ï¼Œå¯ä»¥å…¼å®¹ä¸€ä¸‹ meta.bat  æ–‡ä»¶ä½ç½®åœ¨å“ªé‡Œï¼Ÿä¸ºä»€ä¹ˆåœ¨canalç›®å½•ä¸‹æ²¡æœ‰æ‰¾åˆ° > meta.bat æ–‡ä»¶ä½ç½®åœ¨å“ªé‡Œï¼Ÿä¸ºä»€ä¹ˆåœ¨canalç›®å½•ä¸‹æ²¡æœ‰æ‰¾åˆ° zookeeper æ¨¡å¼ä½ éœ€è¦æ‰§è¡Œ zkCli åœ¨é‡Œé¢ delete æ‰é‚£ä¸ª canal çš„ path
135,å€¼ç”±Nullå˜ä¸ºç©ºå­—ç¬¦ä¸²æ—¶ï¼ŒisUpdatedå±æ€§ä¸ºfalse mysqlç‰ˆæœ¬æ˜¯5.5 å°†ä¸€ä¸ªvarcharç±»å‹çš„åˆ—çš„å€¼ç”±NULLï¼Œæ”¹ä¸º''æ—¶ï¼Œä»canalè·å–çš„entryçš„columné‡Œï¼Œisupdatedå±æ€§ä¸ºfalseã€‚çœ‹äº†ä¸‹LogEventConverterï¼Œæ„Ÿè§‰æ˜¯isUpdatedæ–¹æ³•æœ‰ä¸ªbugã€‚newValueä¸º""ï¼Œæ—§å€¼ä¸ºNULLæ—¶ï¼Œæ—§çš„column.getValue()ä¸º""ã€‚ column.isNull()æ–¹æ³•å¯ä»¥åˆ¤æ–­æ˜¯å¦ä¸ºnullå€¼ è¿™æ˜¯åœ¨otterä¸­å‘ç°çš„ï¼Œotterä½¿ç”¨äº†canalçš„column.isUpdatedæ–¹æ³•æ¥åˆ¤æ–­æ˜¯å¦å‘ç”Ÿäº†å˜æ›´ï¼Œç„¶åå°±æœ‰äº›åˆ—åŒæ­¥é”™è¯¯äº†ã€‚ å¤šè°¢åé¦ˆï¼Œé—®é¢˜ä»£ç å·²ç»ä¿®å¤ï¼Œä¸‹ä¸ªç‰ˆæœ¬å¯å‘å¸ƒ ä¸å®¢æ°”ã€‚æœŸå¾…canalä¸otteræ›´åŠ å®Œå–„ 
134,å…³äºmax memory sizeçš„é—®é¢˜ Hi jianghangï¼š åœ¨ç±»MemoryEventStoreWithBufferçš„checkFreeSlotAtæ–¹æ³•ä¸­ï¼Œ if (batchMode.isMemSize()) {                 final long memsize = putMemSize.get() - ackMemSize.get();                 if (memsize < bufferSize \* bufferMemUnit) {                     return true;                 } else {                     return false;                 }             } else {                 return true;             } åªåˆ¤æ–­memsize < bufferSize \* bufferMemUnitè¿˜ä¸å¤Ÿå§ï¼Œåº”è¯¥ç”¨ â€å½“å‰ç©ºé—²å†…å­˜é‡+æ–°åŠ å…¥äº‹ä»¶æ‰€å å†…å­˜é‡â€å’ŒbufferSize \* bufferMemUnitè¿›è¡Œæ¯”è¾ƒæ‰å¯¹å§ï¼Ÿï¼Ÿ æœ›æŒ‡æ•™ã€‚ putMemSize.get() - ackMemSize.get()ï¼Œ è¿™ä¸ªå¾—å‡ºæ¥çš„ç»“æœå°±æ˜¯å½“å‰åœ¨å†…å­˜ä¸­æœªè¢«getçš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨ä¸­çš„å†…å­˜å—ï¼Œå› ä¸ºRingbufferçš„ç‰¹æ€§æ˜¯lazy setæ¨¡å¼ï¼Œåœ¨å‡ ä¸ªä½ç‚¹ä¹‹é—´ä¼šæœ‰éƒ¨åˆ†å†…å­˜æ•°æ®æœªè¢«åŠæ—¶æ¸…ç†ï¼Œä¸è¿‡ä¸€èˆ¬åœ¨æ•°æ®é«˜é€Ÿget/putè¿‡ç¨‹ä¸­ï¼Œæ€»çš„å†…å­˜é‡æ˜¯å¯æ§çš„ï¼Œå¹¶ä¸æ˜¯éå¸¸ç²¾ç¡® æ© æ˜ç™½ tks 
133,å…³äºäº‹åŠ¡è¢«æˆªæ–­çš„ç–‘é—® ä¸‹é¢æ˜¯æˆ‘çš„å®éªŒæ­¥éª¤ï¼Œå‘ç°é™¤äº†canal.instance.transaction.sizeå‚æ•°å¯èƒ½å¯¼è‡´äº‹åŠ¡è¢«æˆªæ–­å¤–ï¼Œå®¢æˆ·ç«¯batchsizeçš„è®¾ç½®ä¹Ÿä¼šå¯¼è‡´äº‹åŠ¡è¢«æˆªæ–­ï¼Œè¯·é—®ä¸‹ï¼Œcanlaåœ¨è®¾è®¡çš„æ—¶å€™å¯¹äº‹åŠ¡å®Œæ•´æ€§æ˜¯ä¸€ä¸ªä»€ä¹ˆæ ·çš„è€ƒè™‘å‘¢ï¼Ÿåªè¦ä¿è¯èƒ½æŠŠæ•°æ®åŒæ­¥ç»™å®¢æˆ·ç«¯ï¼Œèƒ½è®°ä¸‹ackï¼Œä¿è¯æœ€ç»ˆä¸€è‡´ï¼Ÿ ä¸‹é¢æ˜¯æˆ‘çš„å®éªŒã€‚ 1. åˆ›å»ºä¸€ä¸ªæµ‹è¯•ç”¨å­˜å‚¨è¿‡ç¨‹ï¼Œè¿‡ç¨‹ä»£ç å¦‚ä¸‹ï¼š        DELIMITER //        CREATE PROCEDURE loop_insert(IN count int)        begin            declare lp int;            declare idvalue int;            set lp=0;            select max(id)+1 into idvalue from test;            set autocommit=0;            while lp<count do                insert into test(id name)values(idvalue 'test-'+idvalue);                set idvalue=idvalue+1;                  set lp=lp+1;              end while;            commit;        end;        //        DELIMITER;    1. æµ‹è¯•â€œcanal.instance.transaction.sizeâ€       > å°†canal-serverçš„â€œcanal.instance.transaction.sizeâ€å‚æ•°è®¾ç½®ä¸º1024(é»˜è®¤ä¹Ÿæ˜¯1024)ï¼Œcanal-client(SimpleCanalClientTest)çš„batchsizeè®¾ç½®ä¸º1024*5(è¦è¶³å¤Ÿå¤§)       > ä¾åºå¯åŠ¨mysqlã€canal-serverå’Œcanal-clientï¼ˆåœ¨mysqlæ‰§è¡Œæ“ä½œä¹‹å‰ï¼Œcanal-clientå¿…é¡»é¢„å…ˆå¯åŠ¨èµ·æ¥ï¼Œå¦åˆ™äº‹åŠ¡æˆªæ–­çš„ç°è±¡æ˜¾ç¤ºä¸å‡ºæ¥ï¼‰       > åœ¨mysqlç«¯æ‰§è¡Œloop_insertï¼Œå‚æ•°ä¼ 1022ï¼Œè§‚å¯Ÿcanal-clientç«¯ï¼šæ‰€æœ‰eventä¼šåœ¨ä¸€ä¸ªbatchä¸­æ‹¿åˆ°       > åœ¨mysqlç«¯æ‰§è¡Œloop_insertï¼Œå‚æ•°ä¼ 1023ï¼Œè§‚å¯Ÿcanal-clientç«¯ï¼šä¼šè¿”å›ä¸¤ä¸ªbatchï¼Œç¬¬ä¸€ä¸ªåŒ…å«1024æ¡eventï¼Œç¬¬äºŒä¸ªåŒ…å«1æ¡event       ä¸Šé¢éªŒè¯äº†å‚æ•°"canal.instance.transaction.size"çš„ä½œç”¨ï¼Œä¸ºäº†é˜²æ­¢äº‹åŠ¡è¢«æˆªæ–­éœ€è¦æŠŠå‚æ•°å€¼è®¾ç½®çš„å¤§ä¸€äº›    2. æµ‹è¯•batchsize       3.1 åœºæ™¯ä¸€            > å°†canal-serverçš„å‚æ•°è®¾ä¸ºITEMSIZE(ä½¿ç”¨ITEMSIZEä¾¿äºæµ‹è¯•)ï¼Œå°†canal-clientä¸­çš„batchsizeè®¾ç½®ä¸º2           > å¯åŠ¨mysqlï¼Œå¯åŠ¨canal-serverï¼Œåœ¨mysqlç«¯æ‰§è¡Œloop_insertï¼Œå‚æ•°ä¼ 10ï¼Œç„¶åå†å¯åŠ¨canal-client           > è§‚å¯Ÿcanal-clientç«¯ï¼šä¼šè¿”å›6ä¸ªbatchï¼Œæ¯ä¸ªbatchåŒ…å«2æ¡eventï¼Œäº‹åŠ¡è¢«æˆªæ–­       3.4 åœºæ™¯äºŒ           > å°†canal-serverçš„å‚æ•°è®¾ä¸ºITEMSIZE(ä½¿ç”¨ITEMSIZEä¾¿äºæµ‹è¯•)ï¼Œå°†canal-clientä¸­çš„batchsizeè®¾ç½®ä¸º13           > å¯åŠ¨mysqlï¼Œå¯åŠ¨canal-serverï¼Œåœ¨mysqlç«¯è¿ç»­æ‰§è¡Œloop_insertä¸¤æ¬¡ï¼Œå‚æ•°ä¼ 10ï¼Œç„¶åå†å¯åŠ¨canal-client(å¿…é¡»ä¸Šè¿°æ“ä½œå®Œæˆåå†å¯åŠ¨clientï¼Œä¿è¯3.4çš„çœŸå®æ€§)           > è§‚å¯Ÿcanal-clientç«¯ï¼šä¼šè¿”å›ä¸¤ä¸ªbatchï¼Œç¬¬ä¸€ä¸ªbatch13æ¡eventï¼Œç¬¬äºŒä¸ªbatch11æ¡eventï¼Œäº‹åŠ¡è¢«æˆªæ–­       ç”±æ­¤å¯è§ï¼Œé™¤äº†éœ€è¦è€ƒè™‘transaction sizeè¿˜éœ€è¦è€ƒè™‘batch sizeï¼Œbatchsizeé…ç½®çš„æ¯”è¾ƒå°çš„è¯ä¹Ÿå¯èƒ½æˆªæ–­äº‹åŠ¡ï¼Œä½†æ˜¯å¦‚æœå¤ªå¤§çš„è¯åˆä¼šå½±å“å®æ—¶æ€§ï¼Œéœ€è¦å–ä¸€ä¸ªæŠ˜è¡·       æ³¨ï¼šå†å¯¹2å’Œ3è¿›è¡Œæµ‹è¯•æ—¶ï¼Œè¦ä¿è¯ç›¸äº’éš”ç¦»ï¼Œå³æµ‹è¯•transaction.sizeçš„æ—¶å€™è¦ä¿è¯batchsizeçš„è¶³å¤Ÿå¤§ï¼Œæµ‹è¯•batchsizeçš„æ—¶å€™äº¦ç„¶ canal.instance.transaction.sizeçš„ç›®çš„æ˜¯é˜²æ­¢äº‹åŠ¡è¢«æˆªæ–­ï¼Œä½†æ˜¯å¦‚æœmysqlçš„binlog-formatæ˜¯mixedç±»å‹ï¼ŒåŸºæœ¬æ¯ä¸ªäº‹ä»¶éƒ½ä¼šå¯¼è‡´ä¸€æ¬¡flushï¼Œcanal.instance.transaction.sizeçš„è®¾ç½®å°±æ²¡ä»€ä¹ˆæ„ä¹‰äº†å§ï¼Ÿï¼Ÿï¼Ÿ è¯´ä¸‹æˆ‘å½“æ—¶è€ƒè™‘çš„æ€è·¯ï¼š 1. canal.instance.transaction.sizeï¼Œè¿™ä¸ªå‚æ•°ä¸»è¦æ§åˆ¶parserè§£æåï¼Œæäº¤åˆ°event storeæ—¶ï¼Œå¦‚æœè¦ä¿è¯äº‹åŠ¡å¯è§çš„ä¸€è‡´æ€§ï¼Œè®¾ç½®çš„æœ€å¤§ä¿è¯ä¸€è‡´æ€§çš„äº‹åŠ¡å¤§å°ä¸º1024. (ä¸¾ä¸ªä¾‹å­ï¼šå¦‚æœæ²¡æœ‰è¿™ä¸€è‡´æ€§ä¿æŠ¤ï¼Œä½ geté¢‘ç¹è°ƒç”¨å¯èƒ½ä¼šæ‹¿åˆ°ä¸€æ¬¡äº‹åŠ¡å¤´ï¼Œäº‹åŠ¡ä½“æ•°æ®ï¼Œäº‹åŠ¡å°¾æ•°æ®)ï¼Œäº‹åŠ¡çš„ä¸€è‡´æ€§å†™å…¥æ˜¯äº‹åŠ¡å—è¯»å–çš„ä¸€ä¸ªåŸºç¡€ 2. ç›®å‰getæ•°æ®è·å–æ—¶ï¼Œæš‚æ—¶æ²¡æœ‰è€ƒè™‘äº‹åŠ¡å®Œæ•´è¯»å–çš„æœºåˆ¶ï¼Œä¸»è¦è¿˜æ˜¯è€ƒè™‘ä¸šåŠ¡éœ€æ±‚ï¼Œå¯¹äºäº‹åŠ¡å®Œæ•´æ€§ä¸æ•æ„Ÿ.  è¦ä¿è¯å®Œæ•´è¯»å–å…¶å®ä¹Ÿä¸éš¾. ä½ å¯ä»¥æè¿°ä¸€ä¸‹ï¼Œä½ ä»¬å¯¹å®Œæ•´äº‹åŠ¡çš„éœ€æ±‚ï¼Œä¸»è¦åŸºäºä»€ä¹ˆæ ·çš„ä¸šåŠ¡è€ƒè™‘ æ˜ç™½ä½ çš„æ„æ€ã€‚ ä½†æ˜¯æœ€åé‚£ä¸ªbinlog-formatçš„é—®é¢˜ï¼Œä¸çŸ¥é“æ‚¨è¯•äº†æ²¡æœ‰ã€‚å¦‚æœformatæ˜¯mixedç±»å‹ï¼Œé‚£ä¹ˆcanal.instance.transaction.sizeåº”è¯¥å°±å¤±æ•ˆäº†ï¼Œå› ä¸ºisDmlè¿”å›çš„æ˜¯falseï¼Œæ¯æ”¶åˆ°ä¸€ä¸ªrowdataç±»å‹çš„entryå°±flushä¸€æ¬¡äº†ã€‚             case ROWDATA:                 put(entry);                 // é’ˆå¯¹éDMLçš„æ•°æ®ï¼Œç›´æ¥è¾“å‡ºï¼Œä¸è¿›è¡Œbufferæ§åˆ¶                 EventType eventType = entry.getHeader().getEventType();                 if (eventType != null && !isDml(eventType)) {                     flush();                 }                 break; 
132,filterEmtryTransactionEntryçš„é—®é¢˜ åœ¨EntryEventSinkç±»çš„sinkDataæ–¹æ³•ä¸­ï¼Œæœ‰å¯¹filterEmtryTransactionEntryè¿›è¡Œåˆ¤æ–­çš„ä»£ç æ®µï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š             if (filterEmtryTransactionEntry && !CollectionUtils.isEmpty(events)) {                 long currentTimestamp = events.get(0).getEntry().getHeader().getExecuteTime();                 // åŸºäºä¸€å®šçš„ç­–ç•¥æ§åˆ¶ï¼Œæ”¾è¿‡ç©ºçš„äº‹åŠ¡å¤´å’Œå°¾ï¼Œä¾¿äºåŠæ—¶æ›´æ–°æ•°æ®åº“ä½ç‚¹ï¼Œè¡¨æ˜å·¥ä½œæ­£å¸¸                 if (Math.abs(currentTimestamp - lastEmptyTransactionTimestamp) > emptyTransactionInterval                     || lastEmptyTransactionCount.incrementAndGet() > emptyTransctionThresold) {                     lastEmptyTransactionCount.set(0L);                     lastEmptyTransactionTimestamp = currentTimestamp;                     return doSink(events);                 }             } è¯·é—®è¿™é‡Œçš„åˆ¤æ–­åŸºäºä»€ä¹ˆç›®çš„ï¼Ÿä¸å¤ªæ˜ç™½ã€‚ æŠŠcanal.instance.transaction.sizeçš„å¤§å°è®¾ç½®ä¸º1024ï¼Œåœ¨mysqlä¸Šè¿è¡Œä¸€ä¸ªäº‹åŠ¡ï¼Œè¿›è¡Œ1023æ¬¡æ’å…¥ï¼Œé‚£ä¹ˆcanal-serverä¼šäº§ç”Ÿ1025ä¸ªeventï¼ŒæŒ‰ç…§EventTransactionBufferçš„é€»è¾‘è¾¾åˆ°1024çš„æ—¶å€™ä¼šflushä¸€æ¬¡ï¼Œéšåå‰©ä¸‹çš„ä¸€ä¸ªevent(Transactionendç±»å‹)ä¼šå•ç‹¬è¿›è¡Œflushï¼Œä½†æ˜¯ç”±äºä¸Šè¿°ä»£ç çš„ç¼˜æ•…ï¼Œè¯¥eventè¢«å¿½ç•¥äº†ï¼Œè¿™åº”è¯¥ä¸å°½åˆç†å§ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ äº‹åŠ¡å¤´å’Œå°¾ä¸»è¦æ˜¯ç”¨æ¥åŒºåˆ†äº‹åŠ¡è¾¹ç•Œï¼Œæœ¬èº«æ•°æ®æ²¡å•¥æ„ä¹‰.  1025çš„transaction endäº‹ä»¶çš„ç¡®å¯èƒ½è¢«å¿½ç•¥äº†ã€‚ åœ¨canal+otteräº§å“é…åˆå®æ–½ä¸­ï¼Œotterå¯¹äºè¿‡æ»¤åçš„ç©ºäº‹åŠ¡äº‹ä»¶ä¸æ˜¯å¼ºéœ€æ±‚ï¼Œåè€Œå ç”¨äº†è¿‡å¤šçš„canal eventStoreçš„ringBufferç©ºé—´ï¼Œå¯¼è‡´æ•´ä½“ä¸šåŠ¡çš„å¤„ç†é€Ÿåº¦å˜æ…¢ï¼Œæ‰€ä»¥å½“æ—¶è®¾è®¡é»˜è®¤å€¼ä¸ºtrueï¼Œå¾…è€ƒè™‘å’Œä¼˜åŒ– æ„Ÿè°¢æ‚¨çš„å›å¤ã€‚ çš„ç¡®ï¼Œå‡ºç°äº‹åŠ¡è¢«æˆªæ–­çš„æƒ…å†µæ˜¯ä¸ªå°æ¦‚ç‡äº‹ä»¶ï¼Œå¹¶ä¸”åƒ1025ä¾‹å­è¿™æ ·è¢«æˆªæ–­åæ°å¥½å‡ºç°äº†ä¸€ä¸ªç©ºäº‹åŠ¡äº‹ä»¶æ›´æ˜¯ä¸€ä¸ªæç«¯äº‹ä»¶ã€‚ æ‚¨è¯´çš„â€œåè€Œå ç”¨äº†è¿‡å¤šçš„canal eventStorçš„ringBufferç©ºé—´â€æŒ‡çš„åº”è¯¥æ˜¯mysqlçš„binlog-formatä¸ç­‰äºrowçš„æƒ…å†µå§ã€‚å½“binlog-formatç­‰äºrowçš„æ—¶å€™ï¼Œæ¯æ¬¡EventTransactionBufferéƒ½æ˜¯æ”’å¤Ÿä¸€ä¸ªäº‹åŠ¡æ‰flushä¸€æ¬¡ï¼Œé™¤éäº‹åŠ¡å¤ªå¤§è¢«æˆªæ–­ï¼Œå¦åˆ™ä¸ä¼šå‡ºç°ã€ç©ºäº‹åŠ¡äº‹ä»¶ã€‘çš„æƒ…å†µï¼Œé‚£ä¹ˆä¹Ÿå°±æ²¡æœºä¼šè¿‡æ»¤äº†ï¼Œè¿™æ ·å¹¶æ²¡æœ‰å‡å°‘ringbufferçš„å†…å­˜ä½¿ç”¨ã€‚è€Œå½“binlog-formatæ¯”å¦‚ç­‰äºmixedæ—¶ï¼Œä¸‹é¢çš„ä»£ç æ®µä¼šè¿›å…¥ifè¯­å¥ï¼ŒåŸºæœ¬ä¸Šæ¯æ¡è¯­å¥éƒ½ä¼šflushä¸€æ¬¡ï¼Œè¿™æ ·æ‰å¯¼è‡´å¾ˆå¤šã€ç©ºäº‹åŠ¡äº‹ä»¶ã€‘ã€‚ case ROWDATA:                 put(entry);                 // é’ˆå¯¹éDMLçš„æ•°æ®ï¼Œç›´æ¥è¾“å‡ºï¼Œä¸è¿›è¡Œbufferæ§åˆ¶                 EventType eventType = entry.getHeader().getEventType();                 if (eventType != null && !isDml(eventType)) {                     flush();  //å½“binlog-formatä¸ºmixedæ—¶ï¼Œeventtypä¸ºQueryï¼ŒisDmlè¿”å›falseï¼Œä¼šflush                 }                 break; æ‚¨è¯´çš„ â€œ åœ¨canal+otteräº§å“é…ç½®å®æ–½ä¸­ï¼Œotterå¯¹äºè¿‡æ»¤åçš„ç©ºäº‹åŠ¡äº‹ä»¶ä¸æ˜¯å¼ºéœ€æ±‚ â€ï¼Œè¿™ä¸ªè¯¥æ€ä¹ˆç†è§£å‘¢ï¼Ÿè¿˜æ˜¯1025é‚£ä¸ªä¾‹å­ï¼Œå¦‚æœ1025å¯¹åº”çš„TRANSACTIONENDäº‹ä»¶è¢«è¿‡æ»¤ï¼Œotteræ€ä¹ˆæ¥ç•Œå®šäº‹åŠ¡è¾¹ç•Œå‘¢ï¼Ÿ otteréäº‹åŠ¡æ•æ„Ÿæ€§ï¼Œå…¶ä¸»è¦åˆ©ç”¨äº‹åŠ¡å¤´å’Œå°¾æ¥æ›´æ–°ä½ç‚¹è€Œå·²ï¼Œä¸æ˜¯ä»¥äº‹åŠ¡å•å…ƒè¿›è¡Œæ•´ä½“æäº¤ï¼Œå…·ä½“å¯ä»¥çœ‹ä¸‹æ•°æ®å¯¼å…¥çš„wiki æ© â€œéäº‹åŠ¡æ•æ„Ÿæ€§ã€ä¸»è¦åˆ©ç”¨äº‹åŠ¡å¤´å’Œå°¾æ¥æ›´æ–°ä½ç‚¹â€  è¿™ä¸ªæ˜ç™½äº†ã€‚ ä¸Šè¿°å…³äºbinlog-formatçš„è¡¨è¿°æ˜¯å¦æ­£ç¡®ï¼Ÿå¦‚æœäº‹åŠ¡ä¸è¢«æˆªæ–­ï¼Œå¹¶ä¸”binlog-foramtä¸ºrowï¼Œé‚£å‡ºç°ã€ç©ºäº‹åŠ¡äº‹ä»¶ã€‘çš„åœºæ™¯åº”è¯¥å°±æ²¡æœ‰äº†å§ï¼Ÿ å…³äºã€ç©ºäº‹åŠ¡äº‹ä»¶ã€‘ï¼Œæˆ‘æ‰¾åˆ°å¦å¤–çš„åœºæ™¯äº†ï¼Œå½“é…ç½®filterçš„æ—¶å€™ï¼Œå¦‚æœæŸä¸ªè¡¨è¢«è¿‡æ»¤ï¼Œé‚£è¿™å¼ è¡¨çš„rowdata eventä¼šè¢«è¿‡æ»¤æ‰ï¼Œä½†æ˜¯TRANSACTIONBEGINå’ŒTRANSACTIONEDNå¹¶æ²¡æœ‰è¢«è¿‡æ»¤æ‰ï¼Œæ‰€ä»¥è¿˜æ˜¯éœ€è¦é€šè¿‡filterEmtryTransactionEntry è¿›è¡Œæ§åˆ¶ã€‚æ‚¨è¯´çš„â€œåè€Œå ç”¨äº†è¿‡å¤šçš„canal eventStorçš„ringBufferç©ºé—´â€åº”è¯¥ä¸»è¦æŒ‡è¿™ç§æƒ…å†µå§ï¼Ÿ æ˜¯çš„ï¼Œç†è§£æ­£ç¡®. RingBufferæ˜¯å›ºå®šæ•°ç»„å¤§å°çš„è®¾è®¡ï¼Œæ‰€ä»¥ç©ºçš„äº‹åŠ¡å¤´å’Œå°¾ä¼šå½±å“æ•´ä½“çš„ååé‡ 
131,parse row data failed mysqlç‰ˆæœ¬ï¼š5.6.23-logï¼Œ ä½¿ç”¨otteråšæ•°æ®åŒæ­¥çš„æ—¶å€™ï¼Œä¼šæŠ¥å¦‚ä¸‹é”™è¯¯: pid:2 nid:2 exception:canal:canal_mysql:com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: java.lang.IllegalArgumentException: bad format  x exceed: 2147483638  999999999 at com.taobao.tddl.dbsync.binlog.LogBuffer.getDecimal0(LogBuffer.java:1355) at com.taobao.tddl.dbsync.binlog.LogBuffer.getDecimal(LogBuffer.java:1265) at com.taobao.tddl.dbsync.binlog.event.RowsLogBuffer.fetchValue(RowsLogBuffer.java:336) at com.taobao.tddl.dbsync.binlog.event.RowsLogBuffer.nextValue(RowsLogBuffer.java:96) at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseOneRow(LogEventConvert.java:454) éº»çƒ¦æŠ¥å‘Šä¸€ä¸‹canalç‰ˆæœ¬å’Œotterç‰ˆæœ¬ canal: 1.0.20 otter: 4.2.12 mysqlç¯å¢ƒæ˜¯ä¸€ä¸ªä¸»ä»é›†ç¾¤ï¼Œå¼€å¯åŠåŒæ­¥æ’ä»¶ã€‚ è¿ä»åº“ä¼šæŠ¥è¿™ä¸ªé”™è¯¯ï¼› è¿ä¸»åº“æ²¡æœ‰é—®é¢˜ã€‚ æµ‹è¯•äº†æœ¬åœ°çš„mysql 5.6ç‰ˆæœ¬ï¼Œé’ˆå¯¹decimalç±»å‹æš‚æ—¶æ²¡å‘ç°æœ‰ç±»ä¼¼é”™è¯¯ï¼Œå¦‚æœæ–¹ä¾¿æ˜¯å¦å¯ä»¥æä¾›ä¸€ä¸‹å¯¹åº”å‡ºé”™ä½ç‚¹çš„binlogåŸå§‹æ–‡ä»¶ ä¼°è®¡æ˜¯è¿™ä¸ªé—®é¢˜ï¼Œhttps://github.com/alibaba/canal/issues/119 ä½¿ç”¨masteråˆ†æ”¯buildä¸€ä¸ªåŒ…è¯•è¯• ä¹Ÿé‡åˆ°è¿™ä¸ªé—®é¢˜ï¼Œcanalåœ¨è§£æDecimalç±»å‹(MYSQL_TYPE_NEWDECIMAL)æ—¶ä¼¼ä¹å‡ºç°äº†é—®é¢˜ï¼Œå‡ºé—®é¢˜çš„ä»£ç åœ¨LogBufferç±»çš„getDecimal0æ–¹æ³•ï¼› æˆ‘åœ¨æœ¬åœ°æ”¹äº†ä¸€ä¸ªç‰ˆæœ¬ï¼Œå·²ç»ä¿®å¤äº†è¿™ä¸ªé—®é¢˜ï¼Œä½†å¯èƒ½éœ€è¦è¿›ä¸€æ­¥å®Œå–„ï¼Œç¨åä¼šæäº¤PR æ¬¢è¿æäº¤PRï¼Œæ–¹ä¾¿æŠ¥å‘Šä¸€ä¸‹æµ‹è¯•mysqlå’Œcanalçš„ç‰ˆæœ¬ mysql Server version: 10.2.14-MariaDB-log Columnstore 1.1.4-1 canal 1.0.24 2018-05-10 17:42 GMT+08:00 agapple <notifications@github.com>: > æ¬¢è¿æäº¤PRï¼Œæ–¹ä¾¿æŠ¥å‘Šä¸€ä¸‹æµ‹è¯•mysqlå’Œcanalçš„ç‰ˆæœ¬ > > â€” > You are receiving this because you commented. > Reply to this email directly  view it on GitHub > <https://github.com/alibaba/canal/issues/131#issuecomment-388006054>  or mute > the thread > <https://github.com/notifications/unsubscribe-auth/ASsS_qXHnsjFiIsbJ28I1VULEZax_zqjks5txAt6gaJpZM4GX7gy> > . > --  Best Regards  Zhiyu å¯¹åº”çš„æµ‹è¯•decimalæ•°æ®å‘ä¸€ä¸‹å§ â€‹  mysql-bin.000014 <https://drive.google.com/file/d/1V9PHa3M4T4UhTPfHBElsqLFMi4ECJU2r/view?usp=drive_web> â€‹ googleç¡¬ç›˜åº”è¯¥å¯ä»¥è®¿é—®å§ã€‚ æˆ‘æ˜¨å¤©æŠŠæˆ‘æ”¹è¿‡ä»£ç è¿è¡Œåœ¨mysql5.6ä¸Šï¼Œå‘ç°å¯¹äºmysql5.6ä¸workï¼Œæ€€ç–‘æ˜¯mysqlå’Œcolumnstoreçš„binlogæ ¼å¼åœ¨å¤„ç†decimalæ–¹é¢æœ‰ç‚¹ä¸ä¸€æ ·ã€‚ 2018-05-10 19:14 GMT+08:00 agapple <notifications@github.com>: > å¯¹åº”çš„æµ‹è¯•decimalæ•°æ®å‘ä¸€ä¸‹å§ > > â€” > You are receiving this because you commented. > Reply to this email directly  view it on GitHub > <https://github.com/alibaba/canal/issues/131#issuecomment-388025033>  or mute > the thread > <https://github.com/notifications/unsubscribe-auth/ASsS_iT5TTAzZOB_09yhsHg3h4XE9xEzks5txCEfgaJpZM4GX7gy> > . > --  Best Regards  Zhiyu æœ‰ä¸šåŠ¡ä¸Šæ„é€ æµ‹è¯•æ•°æ®çš„sqlï¼Ÿ ä»–ä»¬æ˜¯ç”¨loadå‘½ä»¤æŠŠcsvæ–‡ä»¶loadåˆ°columnstoreé‡Œé¢ï¼Œè¯­å¥å¦‚ä¸‹ï¼š LOAD DATA LOCAL INFILE '"+ ExportData[ Key ].Location +"' INTO TABLE "+ ExportData[ Key ].Table +" CHARACTER SET utf8 COLUMNS TERMINATED BY '|' IGNORE 1 LINES") å¦‚æœæƒ³è¦é‡ç°çš„è¯ï¼Œå†™ä¸€ä¸ªcsvæ–‡ä»¶ ï¼Œå†æ‰§è¡Œloadåº”è¯¥å¯ä»¥ 2018-05-15 17:58 GMT+08:00 agapple <notifications@github.com>: > æœ‰ä¸šåŠ¡ä¸Šæ„é€ æµ‹è¯•æ•°æ®çš„sqlï¼Ÿ > > â€” > You are receiving this because you commented. > Reply to this email directly  view it on GitHub > <https://github.com/alibaba/canal/issues/131#issuecomment-389112064>  or mute > the thread > <https://github.com/notifications/unsubscribe-auth/ASsS_qVV7534IKkprEIB-GLBjiwb-x6Oks5tyqa9gaJpZM4GX7gy> > . > --  Best Regards  Zhiyu æœ€å¥½æ˜¯èƒ½æ„é€ å‡ºå¯¹åº”çš„sqlè¯­å¥æ¥å¤ç°è¿™ä¸ªé—®é¢˜ï¼ŒæŸ¥è¿‡å¯¹åº”çš„binlogè§£æä»£ç ï¼Œå’Œmysql parserçš„æ˜¯ä¿æŒä¸€è‡´çš„
130,mysql 5.6ç‰ˆæœ¬ datetimeå€¼ä¸ºnullæ—¶ sqltypeè§£æå¼‚å¸¸ é—®é¢˜æè¿°ï¼š mysql ç‰ˆæœ¬ä¸º5.6.12ï¼Œ åœ¨æ’å…¥æ•°æ®æ—¶ï¼ŒDATETIMEç±»å‹çš„å­—æ®µï¼ˆå¦‚update_timeå­—æ®µï¼‰è®¾ç½®ä¸ºNULLæ—¶ï¼Œåœ¨ä»canalå®¢æˆ·ç«¯è·å–åˆ°çš„æ•°æ®ä¸­ï¼Œå¯¹åº”å­—æ®µçš„sqlTypeä¸º1111ï¼ˆOTHERï¼‰ è€Œåœ¨mysql 5.5.*ç‰ˆæœ¬ä¸­åšåŒæ ·çš„æµ‹è¯•ï¼ŒDATETIMEä¸ºnullæ—¶ï¼Œcanalå®¢æˆ·ç«¯è·å–åˆ°çš„å¯¹åº”sqlTypeä¸º93ï¼ˆTIMESTAMPï¼‰ è¿™ä¸ªæ˜¯BUGä¹ˆï¼Ÿ æˆ‘å…ˆéªŒè¯ä¸‹ ç¡®è®¤æ˜¯ä¸€ä¸ªbugï¼Œmysql5.6å¢åŠ äº†æ–°çš„LogEventç±»å‹ï¼Œå¢åŠ swtichåˆ¤æ–­åå³å¯ä¿®å¤ 
129,æ— æ³•è¯»å–Binlog ç¯å¢ƒï¼š Fedora 21 docker 1.8.1 docker mysql 5.5.45 mysqlé…ç½®ï¼š ``` [mysqld] server-id=1042776 log_bin=mysql-bin log_error=mysql-bin.err binlog-format=ROW ``` canalé…ç½®ï¼š ``` [snowwolf@snowwolf-dev canal]$ cat conf/example/instance.properties ################################################# ## mysql serverId canal.instance.mysql.slaveId = 1234 # position info canal.instance.master.address = 127.0.0.1:33306 canal.instance.master.journal.name =  canal.instance.master.position =  canal.instance.master.timestamp =  #canal.instance.standby.address =  #canal.instance.standby.journal.name = #canal.instance.standby.position =  #canal.instance.standby.timestamp =  # username/password canal.instance.dbUsername = canal canal.instance.dbPassword = canal canal.instance.defaultDatabaseName = dbroute_01 canal.instance.connectionCharset = UTF-8 # table regex canal.instance.filter.regex = .*\\..* # table black regex canal.instance.filter.black.regex =   ################################################# ``` å¯åŠ¨å‚æ•°ï¼š ``` docker run --name dbrouter-mysql-dev -p 33306:3306 -v /etc/mysql/conf.d:/etc/mysql/conf.d -v /var/lib/docker-mysql:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=xxx -d mysql:5.5 ``` æ—¥å¿—ï¼š ``` 2015-09-08 21:11:34.687 [destination = example   address = /127.0.0.1:33306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position by switch ::1441612069000 2015-09-08 21:11:34.701 [destination = example   address = /127.0.0.1:33306   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - Didn't find the corresponding binlog files from mysql-bin.000001 to mysql-bin.000003 2015-09-08 21:11:34.701 [destination = example   address = /127.0.0.1:33306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /127.0.0.1:33306 has an error  retrying. caused by  com.alibaba.otter.canal.parse.exception.CanalParseException: can't find start position for example 2015-09-08 21:11:34.702 [destination = example   address = /127.0.0.1:33306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[com.alibaba.otter.canal.parse.exception.CanalParseException: can't find start position for example ] ``` ä½¿ç”¨mysqlbinlogå¯ä»¥è§£æ ``` [root@snowwolf-dev ~]# mysqlbinlog -h127.0.0.1 -P33306 -ucanal -pcanal --read-from-remote-server -v --start-position=296 -d dbroute_01 mysql-bin.000003 /*!50530 SET @@SESSION.PSEUDO_SLAVE_MODE=1*/; /*!40019 SET @@session.max_insert_delayed_threads=0*/; /*!50003 SET @OLD_COMPLETION_TYPE=@@COMPLETION_TYPE COMPLETION_TYPE=0*/; DELIMITER /*!*/; # at 296 #150908 20:29:44 server id 1042776  end_log_pos 0   Start: binlog v 4  server v 5.5.45-log created 150908 20:29:44 BINLOG ' uNTuVQ9Y6Q8AZwAAAAAAAAAAAAQANS41LjQ1LWxvZwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAEzgNAAgAEgAEBAQEEgAAVAAEGggAAAAICAgCAA== '/*!*/; # at 296 #150908 20:33:05 server id 1042776  end_log_pos 431     Write_rows: table id 3979 flags: STMT_END_F BINLOG ' gdXuVRdY6Q8AhwAAAK8BAAAAAIsPAAAAAAEAGP///0DSPgMAAACyyO5VssjuVQEAAAAKMTIzNDU2 Nzg5MgwrMTM4MTAwMDEwMDIJAHRlc3R1c2VyMyBlMTBhZGMzOTQ5YmE1OWFiYmU1NmUwNTdmMjBm ODgzZQGyyO5VAQEABGFiY2QAAAAA '/*!*/; ### Row event for unknown table #3979# at 431 #150908 20:33:05 server id 1042776  end_log_pos 458     Xid = 914 COMMIT/*!*/; # at 458 #150908 20:57:33 server id 1042776  end_log_pos 532     Query   thread_id=515   exec_time=0 error_code=0 SET TIMESTAMP=1441717053/*!*/; SET @@session.pseudo_thread_id=515/*!*/; SET @@session.foreign_key_checks=1  @@session.sql_auto_is_null=0  @@session.unique_checks=1  @@session.autocommit=1/*!*/; SET @@session.sql_mode=0/*!*/; SET @@session.auto_increment_increment=1  @@session.auto_increment_offset=1/*!*/; /*!\C utf8mb4 *//*!*/; SET @@session.character_set_client=45 @@session.collation_connection=224 @@session.collation_server=8/*!*/; SET @@session.lc_time_names=0/*!*/; SET @@session.collation_database=DEFAULT/*!*/; BEGIN /*!*/; # at 532 # at 639 #150908 20:57:33 server id 1042776  end_log_pos 639     Table_map: `dbroute_01`.`uc_member_000` mapped to number 3979 #150908 20:57:33 server id 1042776  end_log_pos 774     Delete_rows: table id 3979 flags: STMT_END_F BINLOG ' PdvuVRNY6Q8AawAAAH8CAAAAAIsPAAAAAAEACmRicm91dGVfMDEADXVjX21lbWJlcl8wMDAAGAMH BwMPDw8PDwEBBw8BDwECAQ8PDw8PBxg8ADwAPAAsAZYAlgDAADwAeAA8ADwAHgDg9z4= PdvuVRlY6Q8AhwAAAAYDAAAAAIsPAAAAAAEAGP///0DSPgMAAACyyO5VssjuVQEAAAAKMTIzNDU2 Nzg5MgwrMTM4MTAwMDEwMDIJAHRlc3R1c2VyMyBlMTBhZGMzOTQ5YmE1OWFiYmU1NmUwNTdmMjBm ODgzZQGyyO5VAQEABGFiY2QAAAAA '/*!*/; ### DELETE FROM `dbroute_01`.`uc_member_000` ### WHERE ###   @1=3 ###   @2=1441712306 ###   @3=1441712306 ###   @4=1 ###   @5='1234567892' ###   @6='+13810001002' ###   @7=NULL ###   @8='testuser3' ###   @9='e10adc3949ba59abbe56e057f20f883e' ###   @10=NULL ###   @11=1 ###   @12=1441712306 ###   @13=NULL ###   @14=1 ###   @15=NULL ###   @16=NULL ###   @17=1 ###   @18=NULL ###   @19=NULL ###   @20=NULL ###   @21=NULL ###   @22=NULL ###   @23='abcd' ###   @24=0 # at 774 #150908 20:57:33 server id 1042776  end_log_pos 801     Xid = 3451 COMMIT/*!*/; DELIMITER ; # End of log file ROLLBACK /* added by mysqlbinlog */; /*!50003 SET COMPLETION_TYPE=@OLD_COMPLETION_TYPE*/; /*!50530 SET @@SESSION.PSEUDO_SLAVE_MODE=0*/; ``` åœ¨édockerçš„MariaDB 10ï¼Œdockerçš„5.6ä¸Šéƒ½æ˜¯å¦‚æ­¤ï¼Œè¯·é—®æ˜¯ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ prepare to find start position by switch ::1441612069000 åŸºäºæ—¶é—´æˆ³å®šä½ä½ç‚¹ï¼Œæ‰¾ä¸åˆ°æ¯”è¿™æ—¶é—´å°çš„binlog.  å»ºè®®. åˆ é™¤å†å²ä½ç‚¹ï¼Œé‡æ–°è®¢é˜… 
128,fix rename table ddl parser tablename and schemaname error ä¹‹å‰çš„rename table æ­£åˆ™è¡¨è¾¾å¼åœ¨åŒ¹é… tablenameæˆ–è€…schemaname ä¸­ä»¥to æ‰“å¤´çš„è¡¨åæˆ–è€…åº“åçš„æ—¶å€™ä¼šæœ‰å¼‚å¸¸ï¼ŒåŒ¹é…åˆ°ç©ºã€‚å…·ä½“çš„bad caseå¯ä»¥çœ‹æµ‹è¯•æ–‡ä»¶ tks 
127,fix not skip filter and read the error data å®˜æ–¹åè®®ä¸­æœ‰ä¸¤ä¸ªbyteçš„filterå­—æ®µã€‚è¿™é‡Œæ²¡æœ‰è·³è¿‡ï¼Œå¯¼è‡´åé¢çš„æ•°æ®è¯»é”™ã€‚ ``` lenenc_str     catalog lenenc_str     schema lenenc_str     table lenenc_str     org_table lenenc_str     name lenenc_str     org_name lenenc_int     length of fixed-length fields [0c] 2              character set 4              column length 1              type 2              flags 1              decimals 2              filler [00] [00]   if command was COM_FIELD_LIST { lenenc_int     length of default-values string[$len]   default values   } ``` æŒ‰ç…§å®˜ç½‘çš„è¯´æ³•ï¼Œfiller å­—æ®µåº”è¯¥æ˜¯ 00ï¼Œæ‰€ä»¥æœ€åä»¥ä¸º string length å¦‚æœä¹Ÿæ˜¯0çš„è¯ä¸ä¼šæŠ¥é”™ã€‚ ä½†æ˜¯æˆ‘åˆ©ç”¨è¿™ä¸ªæ–¹æ³•è¯·æ±‚`SHOW BINARY LOGS`ï¼Œå‘ç° filter è¿”å›çš„æ˜¯ 31ã€‚ æ‰€ä»¥æ‰å‘ç°äº†è¿™ä¸ªé—®é¢˜ã€‚ ä¸ºä»€ä¹ˆè¿”å›31è¿˜ä¸çŸ¥é“ï¼Œä½†æ˜¯è¿™é‡Œæœ€åä¸€ä½çš„è¯»å–è‚¯å®šè¯»é”™äº†ã€‚ tks 
126,Canalæœ‰è®¡åˆ’æ”¯æŒåŸºäºGTIDå»åšæ•°æ®åŒæ­¥ä¹ˆ å¦‚æœMySQLä½¿ç”¨VIPæ˜¯å»HAï¼Œå½“MYSQLå‘ç”Ÿä¸»ä»åˆ‡æ¢çš„æ—¶å€™ï¼Œcanalä¼šå¯èƒ½ä¼šæŠ¥é”™ï¼Œå› ä¸ºå’Œå¤‡æœºä¸Šçš„binlogå’Œpositionå¯¹ä¸ä¸Šã€‚å¦‚æœæ˜¯åŸºäºGTIDå»æ‹‰binlogï¼Œåº”è¯¥å°±èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ åŸºäºä¸»å¤‡å¤åˆ¶çš„mysqlï¼ŒGTIDå¯ä»¥è§£å†³åˆ‡æ¢åä½ç‚¹æŸ¥æ‰¾çš„é—®é¢˜ï¼ŒæŠ€æœ¯ä¸Šå¯ä»¥å®ç°ï¼Œå…·ä½“æ—¶é—´ä¸å¯ä¿è¯ å—¯ï¼Œæ˜ç™½ã€‚æ„Ÿè°¢@agapple åŒå­¦ã€‚ä»£ç æäº¤çš„æ—¶å€™å…³ä¸‹è¿™ä¸ªissueï¼Œå¥½è®©æˆ‘çŸ¥é“å»è¯•ç”¨ä¸‹ã€‚ è¿™ä¸ªè¿›å±•å¦‚ä½•å‘¢ï¼Ÿæœ‰è®¡åˆ’æ”¯æŒä¹ˆ @agapple æ‰€ä»¥å°±æ˜¯è¿„ä»Šä¸ºæ­¢ canal ä¹Ÿæ²¡æœ‰æ”¯æŒ GTID æ˜¯ä¹ˆ?  è¯·é—®ç°åœ¨æ”¯æŒGTIDï¼Ÿ æš‚æ—¶æ²¡æœ‰ï¼ŒæœŸå¾…æœ‰å®Œæˆçš„åŒå­¦è´¡çŒ®ä¸€ä¸ªPR å¾ˆä¹…ä»¥å‰æˆ‘å®Œæˆäº†è¿™ä¸ªåŠŸèƒ½ï¼Œä»£ç ç•¥ç³™ï¼Œæ²¡æ³•PR æˆ‘åœ¨1.0.25çš„åŸºç¡€ä¸Šå¢åŠ äº†GTIDçš„æ”¯æŒï¼Œéœ€è¦å¸®åŠ©reviewã€‚https://github.com/alibaba/canal/pull/618 ## æ”¹åŠ¨è¯´æ˜ 1. å¢åŠ instanceçº§é…ç½®`gtidon`ï¼ŒæŒ‡ç¤ºè¯¥instanceæ˜¯å¦å¯ç”¨GTIDæ¨¡å¼ã€‚ 2. driveråŒ…å¢åŠ GTIDç›¸å…³ç±»ï¼š`GTIDSet`ï¼Œ`UUIDSet`æ˜¯GTIDè¡¨ç¤ºï¼Œ`BinlogDumpGTIDCommandPacket`æ˜¯`COM_BINLOG_DUMP_GTID`å‘½ä»¤ã€‚ 3. è¡¥å…¨dbsyncåŒ…ä¸‹çš„`GtidLogEvent`äº‹ä»¶çš„è§£æã€‚ 4. protocolåŒ…ä¸‹ï¼Œå¢åŠ äº†`EntryType`æšä¸¾é¡¹`GTIDLOG`ï¼Œæ˜¯binlogæµä¸­çš„GTIDLOGäº‹ä»¶ï¼›`Header`å¢åŠ äº†å­—æ®µ`gtid`ï¼Œè¿™é‡Œåé¢å•ç‹¬æ®µè½è¯¦ç»†è¯´æ˜ã€‚ 5. parseåŒ…ä¸‹ï¼Œ`ErosaConnection`å¢åŠ æ ¹æ®GTIDåŒæ­¥çš„dumpæ–¹æ³•ã€‚ 6. parseåŒ…ä¸‹ï¼Œ`AbstractEventParser.startå†…`ï¼Œå¦‚æœinstanceä½¿ç”¨GTIDæ¨¡å¼ï¼Œåˆ™å‘é€`COM_BINLOG_DUMP_GTID`å‘½ä»¤ç»™mysqlã€‚ ## å…³äº`CanalEntry.Header`å¢åŠ `gtid`å­—æ®µ slaveé€šè¿‡æ–‡ä»¶ä½ç‚¹çš„æ–¹å¼åŒæ­¥binlogæ—¶ï¼Œæ¯ä¸ªäº‹ä»¶å¤´é‡Œéƒ½æºå¸¦äº†filename positionä¿¡æ¯ï¼Œåç»­å­˜å‚¨æœ€æ–°åŒæ­¥ä½ç‚¹åªè¦å–å®¢æˆ·ç«¯ackè¿‡çš„æœ€åä¸€æ¡äº‹ä»¶çš„filename positionå³å¯ã€‚ å¯¹åº”çš„ï¼ŒGTIDæ¨¡å¼åˆ™éœ€è¦è®°å½•æ¶ˆè´¹è¿‡çš„[GTIDSet](https://dev.mysql.com/doc/refman/5.7/en/replication-gtids-concepts.html)ã€‚ ä¸€ä¸ªäº‹åŠ¡æäº¤åï¼Œslaveæ”¶åˆ°å¦‚ä¸‹ä¸€è¿ä¸²äº‹ä»¶ï¼Œ`GTID_LOG`ï¼Œ`TRANSACTIONBEGIN`ï¼Œ`ROWDATA`ï¼Œ`TRANSACTIONEND`ï¼Œå…¶ä¸­åªæœ‰`GTID_LOG`æœ‰æœ¬æ¬¡äº‹åŠ¡çš„GTIDä¿¡æ¯ã€‚ç°åœ¨é€šè¿‡`com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvertGTID`ç±»ï¼Œè®°å½•åˆå¹¶æœ€åä¸€ä¸ªGTIDï¼Œå¹¶èµ‹å€¼ç»™åç»­äº‹ä»¶çš„Header.gtidã€‚ å‘ç°æ²¡æ³•ç»™æŸä¸ªtagå‘pr.. æˆ‘è°ƒæ•´ä¸‹å¯¹masterå‘ä¸ªpr @agapple com.alibaba.fastsqlåŒ…2.0.0_preview_228ç‰ˆå¯ä»¥æä¾›ä¸€ä»½å—ï¼Ÿ @hiwjd åœ¨alphaçš„äºŒè¿›åˆ¶åŒ…é‡Œæœ‰ä¸€ä»½fastsqlçš„jar gtidçš„PRå·²ç»åˆå¹¶äº†ï¼Œéå¸¸æ„Ÿè°¢ @hiwjd çš„è´¡çŒ® https://dev.mysql.com/doc/refman/5.7/en/replication-mode-change-online-enable-gtids.htmlï¼Œå¼€å¯gtidçš„æ–¹æ¡ˆ
125,canal 1.0.20ä¸otter.canal-client 1.0.20ä½¿ç”¨çš„protobufç‰ˆæœ¬ä¸åŒ ä¸€ä¸ªæ˜¯2.4.1ä¸€ä¸ªæ˜¯2.5ï¼Œå¯¼è‡´ç”¨canal-clientè¿æ¥ canalæ—¶æŠ¥é”™ï¼š ``` java java.lang.UnsupportedOperationException: This is supposed to be overridden by subclasses.         at com.google.protobuf.GeneratedMessage.getUnknownFields(GeneratedMessage.java:180) ~[protobuf-java-2.5.0.jar:na] ``` ç›®å‰canalå’Œotterä½¿ç”¨çš„protobufç‰ˆæœ¬å‡ä¸º2.4.1.  ç›®å‰çœ‹æ¥æ˜¯2.4.1ç”Ÿæˆçš„classï¼Œ2.5æ— æ³•æ”¯æŒï¼Œéœ€è¦æµ‹è¯•ä½¿ç”¨2.5ä¹‹åï¼Œéƒ¨åˆ†è€ç‰ˆæœ¬ç”¨æˆ·ä½¿ç”¨2.4.1ç‰ˆæœ¬æ˜¯å¦å¯ä»¥æ­£å¸¸ä½¿ç”¨ é—®é¢˜æ˜¯åœ¨maven repositoryé‡Œé¢ï¼Œcanal.protocolçš„dependencyä¸­protobufæ²¡æœ‰æŒ‡å®šç‰ˆæœ¬ï¼š http://search.maven.org/#artifactdetails%7Ccom.alibaba.otter%7Ccanal.protocol%7C1.0.20%7Cjar ``` xml        <dependency>             <groupId>com.google.protobuf</groupId>             <artifactId>protobuf-java</artifactId>         </dependency> ``` é»˜è®¤ä¼šç”¨2.5.0 https://repo1.maven.org/maven2/com/alibaba/otter/canal/1.0.20/canal-1.0.20.pomï¼Œçˆ¶å·¥ç¨‹ä¼šæ˜¾ç¤ºå£°æ˜protobufç‰ˆæœ¬ä¸º2.4.1 åœ¨pomé‡Œé¢æ›´æ”¹protobufç‰ˆæœ¬ï¼Œç„¶åå†æœ¬åœ°é‡æ–°ç”Ÿæˆprotocolæ–‡ä»¶æ”¾åˆ°protocol/src/main/java/com/alibaba/otter/canal/protocol/é‡Œé¢ï¼Œå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ–è€…ç›´æ¥cloneæˆ‘çš„ä»£ç  https://github.com/chaopengio/canal https://github.com/alibaba/canal/commit/c86fba6092979c4d42734903829843c3d62342aeï¼Œæœ‰äººå·²ç»æäº¤äº†PRï¼Œå‡çº§åˆ°äº†2.6.1  
124,fixed a hard coded mysql host ip address tks 
123,Update eventè¢«è¯†åˆ«ä¸ºINSERT EVENTå½“è¡¨æ ¼å­˜å‚¨ä¸ºndbclusteråŒæ—¶è®¾ç½®æœ‰pkçš„æƒ…å†µä¸‹ åˆ›å»ºè¿™æ ·çš„è¡¨æ ¼ï¼Œè¿™é‡Œè¦åŒæ—¶æœ‰PKå’Œndbcluster engineçš„æŒ‡å®šã€‚åªæŒ‡å®šå…¶ä¸€ï¼Œä¸ä¼šè§¦å‘è¿™ç§æƒ…å†µã€‚ create table test3col(id int(3)  name varchar(10)  last varchar(10)  primary key(id))engine=ndbcluster;  mysql> insert into test3col values(1 'a' 'b'); mysql> update test3col set last='c' where id=1; SimpleCilentæ‰“å°å‡ºæ¥çš„logï¼Œå¯ä»¥å‘ç°updateå‘½ä»¤è¢«è®¤ä¸ºæ˜¯insertç±»å‹ï¼ŒåŒæ—¶åªæ˜¾ç¤ºäº†ä¸»é”®å’Œæ›´æ–°åˆ— ================> binlog[log-bin.000001:3946366]   name[cudb_user_data test3col]   eventType : CREATE empty count : 1 empty count : 2 empty count : 3 empty count : 4 empty count : 5 empty count : 6 ================> binlog[log-bin.000001:3946753]   name[mysql ndb_apply_status]   eventType : INSERT server_id : 501    update=true epoch : 15301516776701952    update=true log_name :     update=true start_pos : 0    update=true end_pos : 0    update=true ================> binlog[log-bin.000001:3946814]   name[cudb_user_data test3col]   eventType : INSERT id : 1    update=true name : a    update=true last : b    update=true ================> binlog[log-bin.000001:3947108]   name[mysql ndb_apply_status]   eventType : INSERT server_id : 501    update=true epoch : 15301538251538433    update=true log_name :     update=true start_pos : 0    update=true end_pos : 0    update=true ================> binlog[log-bin.000001:3947169]   name[cudb_user_data test3col]   eventType : INSERT id : 1    update=true last : c    update=true 1. åªæ˜¾ç¤ºä¸»é”®å’Œå˜æ›´åˆ—ï¼Œä¼°è®¡å’Œä½ mysqlç‰ˆæœ¬æœ‰å…³ï¼Œmysql5.6ä¹‹åæ”¯æŒminial imageæ¨¡å¼ï¼Œåªä¼šè®°å½•å˜æ›´åˆ—å’Œä¸»é”® 2. è‡³äºupdateè¢«è®¤ä¸ºinsertï¼Œä¸ªäººåˆæ­¥åˆ¤æ–­å’Œndbclusteræœ‰å…³ï¼Œä»¥å‰æ²¡æµ‹è¯•è¿‡ å»ºè®®ä½ ç›´æ¥çœ‹ä¸€ä¸‹show binlog eventsçœ‹ä¸€ä¸‹å¯¹åº”update sqlçš„binlogå¯¹è±¡ mysql 5.6  mysql> show binlog events in 'log-bin.000001' from 3960268 limit 100; +----------------+---------+------------+-----------+-------------+-----------------------------------------+ | Log_name       | Pos     | Event_type | Server_id | End_log_pos | Info                                    | +----------------+---------+------------+-----------+-------------+-----------------------------------------+ | log-bin.000001 | 3960268 | Write_rows |       501 |     3960329 | table_id: 34                            | | log-bin.000001 | 3960329 | Write_rows |       501 |     3960368 | table_id: 521 flags: STMT_END_F         | | log-bin.000001 | 3960368 | Query      |       501 |     3960433 | COMMIT                                  | | log-bin.000001 | 3960433 | Query      |       501 |     3960497 | BEGIN                                   | | log-bin.000001 | 3960497 | Table_map  |       501 |     3960560 | table_id: 521 (cudb_user_data.test3col) | | log-bin.000001 | 3960560 | Table_map  |       501 |     3960622 | table_id: 34 (mysql.ndb_apply_status)   | | log-bin.000001 | 3960622 | Write_rows |       501 |     3960683 | table_id: 34                            | | log-bin.000001 | 3960683 | Write_rows |       501 |     3960723 | table_id: 521 flags: STMT_END_F         | | log-bin.000001 | 3960723 | Query      |       501 |     3960788 | COMMIT                                  | +----------------+---------+------------+-----------+-------------+-----------------------------------------+ 9 rows in set (0.00 sec) å…¶ä¸­ | log-bin.000001 | 3960329 | Write_rows |       501 |     3960368 | table_id: 521 flags: STMT_END_F å¯¹åº”ä¸€ä¸ªinsert è¯­å¥ | log-bin.000001 | 3960683 | Write_rows |       501 |     3960723 | table_id: 521 flags: STMT_END_F   å¯¹åº”ä¸€ä¸ªupdateè¯­å¥ã€‚ ä»è¿™é‡Œçœ‹ä¸å‡ºæ¥insertå’Œupdateçš„åŒºåˆ«ã€‚ è€Œé’ˆå¯¹ä¸€å¼ InnoDBçš„è¡¨ï¼Œå¯ä»¥çœ‹åˆ°event_typeåŒºåˆ†ä¸ºWrite_rowså’ŒUpdate_rows mysql> show binlog events in 'log-bin.000001' from 3960268 limit 100; +----------------+---------+-------------+-----------+-------------+-----------------------------------------+ | Log_name       | Pos     | Event_type  | Server_id | End_log_pos | Info                                    | +----------------+---------+-------------+-----------+-------------+-----------------------------------------+ | log-bin.000001 | 3960268 | Write_rows  |       501 |     3960329 | table_id: 34                            | | log-bin.000001 | 3960329 | Write_rows  |       501 |     3960368 | table_id: 521 flags: STMT_END_F         | | log-bin.000001 | 3960368 | Query       |       501 |     3960433 | COMMIT                                  | | log-bin.000001 | 3960433 | Query       |       501 |     3960497 | BEGIN                                   | | log-bin.000001 | 3960497 | Table_map   |       501 |     3960560 | table_id: 521 (cudb_user_data.test3col) | | log-bin.000001 | 3960560 | Table_map   |       501 |     3960622 | table_id: 34 (mysql.ndb_apply_status)   | | log-bin.000001 | 3960622 | Write_rows  |       501 |     3960683 | table_id: 34                            | | log-bin.000001 | 3960683 | Write_rows  |       501 |     3960723 | table_id: 521 flags: STMT_END_F         | | log-bin.000001 | 3960723 | Query       |       501 |     3960788 | COMMIT                                  | | log-bin.000001 | 3960788 | Query       |       501 |     3960852 | BEGIN                                   | | log-bin.000001 | 3960852 | Table_map   |       501 |     3960915 | table_id: 521 (cudb_user_data.test3col) | | log-bin.000001 | 3960915 | Table_map   |       501 |     3960977 | table_id: 34 (mysql.ndb_apply_status)   | | log-bin.000001 | 3960977 | Write_rows  |       501 |     3961038 | table_id: 34                            | | log-bin.000001 | 3961038 | Write_rows  |       501 |     3961078 | table_id: 521 flags: STMT_END_F         | | log-bin.000001 | 3961078 | Query       |       501 |     3961143 | COMMIT                                  | | log-bin.000001 | 3961143 | Query       |       501 |     3961207 | BEGIN                                   | | log-bin.000001 | 3961207 | Table_map   |       501 |     3961270 | table_id: 521 (cudb_user_data.test3col) | | log-bin.000001 | 3961270 | Table_map   |       501 |     3961332 | table_id: 34 (mysql.ndb_apply_status)   | | log-bin.000001 | 3961332 | Write_rows  |       501 |     3961393 | table_id: 34                            | | log-bin.000001 | 3961393 | Write_rows  |       501 |     3961431 | table_id: 521 flags: STMT_END_F         | | log-bin.000001 | 3961431 | Query       |       501 |     3961496 | COMMIT                                  | | log-bin.000001 | 3961496 | Query       |       501 |     3961574 | BEGIN                                   | | log-bin.000001 | 3961574 | Table_map   |       501 |     3961630 | table_id: 510 (cudb_user_data.test)     | | log-bin.000001 | 3961630 | Write_rows  |       501 |     3961668 | table_id: 510 flags: STMT_END_F         | | log-bin.000001 | 3961668 | Xid         |       501 |     3961695 | COMMIT /\* xid=17139826 _/               | | log-bin.000001 | 3961695 | Query       |       501 |     3961773 | BEGIN                                   | | log-bin.000001 | 3961773 | Table_map   |       501 |     3961829 | table_id: 510 (cudb_user_data.test)     | | log-bin.000001 | 3961829 | Update_rows |       501 |     3961876 | table_id: 510 flags: STMT_END_F         | | log-bin.000001 | 3961876 | Xid         |       501 |     3961903 | COMMIT /_ xid=17139887 */               | +----------------+---------+-------------+-----------+-------------+-----------------------------------------+ é€šè¿‡binlogçš„event typeæ— æ³•åŒºåˆ†insertå’Œupdateçš„æƒ…å†µä¸‹ï¼Œè¿˜å¯ä»¥æœ‰å…¶ä»–æ–¹å¼åŒºåˆ†å— Write_rows/Update_rows/Delete_rowsï¼Œbinlogé’ˆå¯¹ä¸åŒçš„ç±»å‹ä¼šæœ‰ä¸¥æ ¼åŒºåˆ†ï¼Œä½ è¿™é‡Œå°±æ˜¯è®°å½•ä¸ºinsertç±»å‹ï¼Œä¼°è®¡å’Œä½ é€‰æ‹©çš„ndbå­˜å‚¨æœ‰å…³ 
122,ä¿®å¤rename tableå‘½ä»¤ä¸­åŒ…å«å¤šä¸ªè¡¨ï¼Œè§£æå¤±è´¥é—®é¢˜ ç®€å•çš„ä¿®å¤ä¸‹ rename tableå‘½ä»¤ä¸­åŒ…å«å¤šä¸ªè¡¨çš„é—®é¢˜ã€‚ å¦‚ https://github.com/alibaba/canal/issues/79 ä¸­æåˆ°çš„ï¼š åç»­å®Œç¾è§£å†³ï¼šä½¿ç”¨ç±»ä¼¼druid/cobarçš„mysql sqlè¯­æ³•è§£æï¼Œæå–å¯¹åº”çš„è¡¨. æ˜¯æ¯”è¾ƒç†æƒ³è§£å†³æ–¹æ¡ˆã€‚ ç”±äºcanalè·å–binlogå­˜åœ¨å»¶è¿Ÿï¼Œå¯èƒ½æ‹¿åˆ°binlogçš„æ—¶å€™é€šè¿‡descå‘½ä»¤è·å–çš„è¡¨ç»“æ„å®é™…æ˜¯å’Œbinlogäº§ç”Ÿæ—¶çš„è¡¨ç»“æ„æœ‰å·®è·çš„ã€‚ æœ€å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯ddlè¯­å¥éƒ½ç›´æ¥è§¦å‘tablemeta cacheçš„å¯¹åº”å˜åŒ–ï¼Œè€Œä¸æ˜¯clear tablemetacacheã€‚ 1.åªæœ‰drop table ä¼šclear tablemeta cache 2.åªæœ‰æ”¶é›†åˆ°table metacache ä¸­æ²¡æœ‰çš„è¡¨çš„binlogæ—¶æ‰ä¼šdesc è·å–è¡¨ç»“æ„ã€‚ 3.ddlè¯­å¥éƒ½ç›´æ¥ä½œç”¨åœ¨tablemeta cacheä¸Š è¿™ä¸ªæ‰èƒ½æœ€å¤§ç¨‹åº¦çš„å‡å°‘é”™è¯¯çš„å‘ç”Ÿï¼Œè¿™ä¸ªæ˜¯ä¸ªä¸´æ—¶çš„ä¿®è¡¥æ–¹æ¡ˆï¼Œè§£å†³ç›®å‰é‡åˆ°çš„ rename tableå‘½ä»¤ä¸­åŒ…å«å¤šä¸ªè¡¨çš„é—®é¢˜ã€‚ 
121,Update README.md tks 
120,å¢åŠ äº†ä¸€ä¸ªè„šæœ¬æ¥è‡ªåŠ¨è·å–mysql master binlogä¿¡æ¯ï¼Œå¹¶è‡ªåŠ¨æ›´æ–°instanceé…ç½®æ–‡ä»¶ tks 
119,æ”¯æŒä¸‹mysql5.6çš„noblob/minimalçš„binlogè§£æ mysql 5.6å¼€å§‹æ”¯æŒbinlog_row_imageå±æ€§ å…è®¸åº”ç”¨æ§åˆ¶è®°å½•binlogé‡Œçš„before/afterçš„å­—æ®µå†…å®¹ï¼Œä»¥å‰é»˜è®¤æ˜¯è®°å½•æ‰€æœ‰å­—æ®µ.  æ–‡æ¡£:http://dev.mysql.com/doc/refman/5.6/en/replication-options-binary-log.html#sysvar_binlog_row_image.  æ”¯æŒ: 1. è§£æè¯†åˆ«changeColumns é’ˆå¯¹noblob/minimalçš„æƒ…å†µ åªè¿”å›binlogé‡Œæœ‰çš„å­—æ®µç±»å‹ 2. MysqlEventParserå¢åŠ supportBinlogFormats/Imagesçš„æ§åˆ¶ å…è®¸ç”¨æˆ·å®šä¹‰æœŸæœ›æ”¯æŒçš„ç±»å‹ï¼Œå¦‚æœdbä¸ç¬¦åˆè¿™ç±»å‹ç›´æ¥æŠ¥é”™.  (for otter   åªæ”¯æŒrowæ¨¡å¼ + FULL image) 
118,æˆ‘åœ¨windowså¯åŠ¨node 4.2.11 æŠ¥ä¸‹é¢é”™è¯¯ Listening for transport dt_socket at address: 8099 é–¿æ¬’î‡¤: éµå¥ç¬‰é’ç‰ˆå¨éƒçŠ³ç¡¶é”çŠºæµ‡æ¶“è¤è¢« æ¾¶å‹ªç°¬éµæ’³ç´‘é˜èˆµâ‚¬ä½µâ‚¬ 1. å…ˆè§£å†³ä¹±ç é—®é¢˜ï¼Œ 2. Listeningè¿™æ—¥å¿—æ˜¯æ­£å¸¸è¾“å‡º 
117,ç°åœ¨å¾ˆå¤šæ—¶å€™binlog-formatéƒ½æ˜¯mixed ç°åœ¨å¾ˆå¤šæ—¶å€™binlog-formatéƒ½æ˜¯mixed ä»¥åä¼šæ”¯æŒè¿™ç±»å‹ä¹ˆ ç›®å‰canalç‰ˆæœ¬è§£ææ”¯æŒmixed/statement/rowæ ¼å¼ 
116,ArrayIndexOutOfBoundsException: 0  see : https://github.com/alibaba/otter/issues/76 
115,Typo javadoc ä¿®æ­£  æ›´æ–° guava åˆ°18.0 ä¿®æ­£äº† embeded -> embedded éƒ¨åˆ† javadoc ä¿®æ­£ æ›´æ–° guava åˆ°18.0 ä¸»è¦æ˜¯ä¸»è¦æ˜¯ MapMaker çš„ computeMake åœ¨18.0æ˜¯åŒ…çº§åˆ«çš„ ç›®å‰æ²¡æœ‰æ›´æ¢å®ç° ä» Map æ›´æ”¹ä¸º LoadingCache å¤ªéº»çƒ¦ åªæ˜¯å°†åŒ…çº§åˆ«çš„æ–¹æ³•æš´éœ²äº†å‡ºæ¥ è¿˜æ˜¯åŸæ¥çš„é…æ–¹ å› æ­¤ guava æ˜¯å¯ä»¥æ›´æ¢ä¸ºå…¶ä»–ç‰ˆæœ¬çš„ æ²¡æœ‰ç”¨åˆ°æ–°ç‰¹æ€§. å¤šè°¢ä½ çš„pull request  ä¿®æ­£äº†æˆ‘çš„ä¸€äº›ä½çº§é”™è¯¯ï¼Œå¯èƒ½code styleå’Œformatæœ‰ä¸€äº›åŒºåˆ«ï¼Œåˆå¹¶ä»£ç åå›ç»Ÿä¸€è¿›è¡Œæ ¼å¼åŒ–ï¼Œä¿è¯å†…éƒ¨ä»£ç é£æ ¼çš„ç»Ÿä¸€ï¼Œè¯·è§è°….  ğŸ‘Œ 
114,æ˜¯å¦å¯ä»¥æ›´æ–°ä¸‹ Guava ç‰ˆæœ¬ canal é‡Œçš„æ˜¯ guava r09 ç°åœ¨å¼€å‘çš„éƒ½ä¸å¯èƒ½ç”¨è¿™ä¹ˆæ—§çš„ç‰ˆæœ¬ æ‰€ä»¥æ— æ³•æŠŠ canal æœåŠ¡åµŒå…¥åˆ°åº”ç”¨ä¸­ç›´æ¥ä½¿ç”¨ èƒ½ä¸èƒ½ç»™æ¥å—æ–°çš„ç‰ˆæœ¬å‘¢? å¦‚æœèƒ½æ¥å— æˆ‘å¯ä»¥æ”¹å¥½ ç„¶å pr ç›®å‰æˆ‘çš„åˆ†æ”¯å·²ç»å¯ä»¥ç”¨æ›´æ–°ç‰ˆæœ¬çš„ guava äº† ```         <dependency>             <groupId>com.github.wenerme.canal</groupId>             <artifactId>canal.server</artifactId>             <version>596b060</version>         </dependency>         <repository>             <id>jitpack.io</id>             <url>https://jitpack.io</url>         </repository> ``` Done at 6a0733bbab7b600c0d41afa8a421e9c443ddecbc 
113,add missing api parameter doc com.alibaba.otter.canal.client.CanalConnectorsæ–¹æ³•ä¿®æ”¹åæ²¡æ”¹javadocï¼Œè¯»ä»£ç çš„æ—¶å€™é€ æˆäº†ä¸€äº›ç–‘æƒ‘. tks 
112,mysql5.6æ—¶é—´æ¯«ç§’ç²¾åº¦æ”¯æŒ æ”¯æŒä¸‹mysql5.6æ¯«ç§’ç²¾åº¦çš„è§£æ.  ## æµ‹è¯•caseï¼š CREATE TABLE `t1` (   `id` int(11) NOT NULL AUTO_INCREMENT   `time0` time DEFAULT NULL   `time1` time(1) DEFAULT NULL   `time2` time(2) DEFAULT NULL   `time3` time(3) DEFAULT NULL   `time4` time(4) DEFAULT NULL   `time5` time(5) DEFAULT NULL   `time6` time(6) DEFAULT NULL   `timestamp0` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00'   `timestamp1` timestamp(1) NOT NULL DEFAULT '0000-00-00 00:00:00.0'   `timestamp2` timestamp(2) NOT NULL DEFAULT '0000-00-00 00:00:00.00'   `timestamp3` timestamp(3) NOT NULL DEFAULT '0000-00-00 00:00:00.000'   `timestamp4` timestamp(4) NOT NULL DEFAULT '0000-00-00 00:00:00.0000'   `timestamp5` timestamp(5) NOT NULL DEFAULT '0000-00-00 00:00:00.00000'   `timestamp6` timestamp(6) NOT NULL DEFAULT '0000-00-00 00:00:00.000000'   `datetime0` datetime DEFAULT NULL   `datetime1` datetime(1) DEFAULT NULL   `datetime2` datetime(2) DEFAULT NULL   `datetime3` datetime(3) DEFAULT NULL   `datetime4` datetime(4) DEFAULT NULL   `datetime5` datetime(5) DEFAULT NULL   `datetime6` datetime(6) DEFAULT NULL   PRIMARY KEY (`id`) ## ) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8 æµ‹è¯•æ•°æ®: 1. insert into t1 values(null '00:00:00.0' '00:00:00.1' '00:00:00.02' '00:00:00.003' '00:00:00.1004' '00:00:00.1005' '00:00:00.101016' '2015-03-30 16:42:39.0' '2015-03-30 16:42:39.0' '2015-03-30 16:42:39.01' '2015-03-30 16:42:39.032' '2015-03-30 16:42:39.1023' '2015-03-30 16:42:39.10132' '2015-03-30 16:42:39.121232' '2015-03-30 16:42:39.0' '2015-03-30 16:42:39.0' '2015-03-30 16:42:39.01' '2015-03-30 16:42:39.032' '2015-03-30 16:42:39.1023' '2015-03-30 16:42:39.10132' '2015-03-30 16:42:39.121232'); 2. insert into t1 values(null '16:42:39.0' '16:42:39.1' '16:42:39.02' '16:42:39.003' '16:42:39.1004' '16:42:39.1005' '16:42:39.101016' '2015-03-30 16:42:39.0' '2015-03-30 16:42:39.0' '2015-03-30 16:42:39.01' '2015-03-30 16:42:39.032' '2015-03-30 16:42:39.1023' '2015-03-30 16:42:39.10132' '2015-03-30 16:42:39.121232' '2015-03-30 16:42:39.0' '2015-03-30 16:42:39.0' '2015-03-30 16:42:39.01' '2015-03-30 16:42:39.032' '2015-03-30 16:42:39.1023' '2015-03-30 16:42:39.10132' '2015-03-30 16:42:39.121232') 3. insert into t1 values(null '-16:42:39.0' '-16:42:39.1' '-16:42:39.02' '-16:42:39.003' '16:42:39.1004' '-16:42:39.1005' '-16:42:39.101016' '2015-03-30 16:42:39.0' '2015-03-30 16:42:39.0' '2015-03-30 16:42:39.01' '2015-03-30 16:42:39.032' '2015-03-30 16:42:39.1023' '2015-03-30 16:42:39.10132' '2015-03-30 16:42:39.121232' '2015-03-30 16:42:39.0' '2015-03-30 16:42:39.0' '2015-03-30 16:42:39.01' '2015-03-30 16:42:39.032' '2015-03-30 16:42:39.1023' '2015-03-30 16:42:39.10132' '2015-03-30 16:42:39.121232'); 
111,æ˜¯å¦è€ƒè™‘åˆå¹¶æ¨¡å— ç›®å‰æ¨¡å—æ•°é‡å¤ªå¤šäº† ç›®å‰æ˜¯15ä¸ªæ¨¡å—å§ éƒ¨åˆ†æ¨¡å—å†…åªæœ‰å¾ˆå°‘çš„å†…å®¹ ä¸ä¾¿äºå¼€å‘å’Œé˜…è¯» ç»å¸¸éƒ½æ˜¯åœ¨æ¨¡å—ä¹‹é—´è·³æ¥è·³å». æš‚æ—¶ä¸è€ƒè™‘åˆå¹¶ï¼Œå€’æ˜¯å¯ä»¥è€ƒè™‘æ‰“åŒ…æ—¶å‡ºä¸€ä¸ªç±»ä¼¼spring-allçš„åŒ… 
110,FileLogFetcher's fetch() method should fix up position and origin even i... ...f we weren't successful at fetching anything from the file 
109, Could not find first log file name in binary log index file 2015-01-15 10:40:01.756 [destination = example   address = /127.0.0.1:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:example[java.io.IOException: Received error packet: errno = 1236  sqlstate = HY000 errmsg = Could not find first log file name in binary log index file         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.DirectLogFetcher.fetch(DirectLogFetcher.java:95)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:116)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209)         at java.lang.Thread.run(Thread.java:662) æˆ‘åœ¨dataç›®å½•ä¸‹çœ‹åˆ°äº†mysql-bin.indexå’Œmysql-bin.000001 å¯æ˜¯æŠ¥é”™è¯´æ‰¾ä¸åˆ°index fileï¼Œæˆ‘ç”¨çš„æ˜¯ubuntuçš„ç³»ç»Ÿï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯å’Œç³»ç»Ÿæœ‰å…³ç³»ï¼Œæˆ‘åœ¨windowsä¸‹æµ‹è¯•æ²¡æœ‰é—®é¢˜çš„ã€‚ è¿™ä¸ªåº”è¯¥å’Œä½ çš„mysqlåˆå…³å§ï¼ŒæŒ‡å®šä¸€ä¸ªcanalèµ·å§‹ä½ç‚¹ï¼Œå¦‚æœæœ‰é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤éªŒè¯ä¸‹mysql binlog show binlog events in 'mysql-bin.000001' from xxx limit 10; å·²ç»è§£å†³äº† æ˜¯linuxæ–‡ä»¶æƒé™é—®é¢˜ @NewsGitHub è¯·é—®æ˜¯å“ªä¸ªæ–‡ä»¶çš„æƒé™é—®é¢˜ï¼Œæˆ‘è¿™è¾¹ä¹Ÿç¢°åˆ°ç›¸åŒçš„é—®é¢˜äº† @NewsGitHub  äº²ï¼Œç»™äº†æ—¥å¿—-R 777çš„æƒé™è²Œä¼¼ä¸è¡Œçš„å‘¢ @changsong  åˆ é™¤canalä¸‹é¢çš„meta.datï¼Œç„¶åé‡å¯ä¸€ä¸‹å°±è¡Œã€‚ è¿™é—®é¢˜çš„è§£å†³æ²¡æè¿°æ¸…æ¥šå•Šï¼Œæˆ‘æŒ‡å®šäº†ä½ç½®ç‚¹è¿˜æ˜¯ä¸è¡Œ æˆ‘ä¹Ÿæ˜¯å¡åœ¨è¿™é‡Œã€‚åœ¨mysqlç«¯å‘ç°canalè¿™ä¸ªç”¨æˆ·ä¸€ç›´åœ¨æ‰§è¡ŒBinlog Dump è¿™ä¸ªæ€ä¹ˆèƒ½å’Œæƒé™æœ‰å…³ç³»å‘¢ï¼Ÿå¦‚æœcanalè¯»çš„ä¸æ˜¯æœ¬æœºå‘¢ï¼Ÿ
108,æ–°ç‰ˆæœ¬ç¼–è¯‘ä»£ç æç¤ºå†…å­˜æº¢å‡º parse events has an errorjava.lang.OutOfMemoryError: Java heap space     at java.nio.HeapByteBuffer.<init>(HeapByteBuffer.java:57) ~[na:1.7.0_67]     at java.nio.ByteBuffer.allocate(ByteBuffer.java:331) ~[na:1.7.0_67]     at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.readNextPacket(SimpleCanalConnector.java:364) ~[classes/:na]     at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.doConnect(SimpleCanalConnector.java:129) ~[classes/:na]     at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.connect(SimpleCanalConnector.java:97) ~[classes/:na]     at com.alibaba.otter.canal.example.AbstractCanalClientTest.process(AbstractCanalClientTest.java:110) ~[classes/:na]     at com.alibaba.otter.canal.example.AbstractCanalClientTest$2.run(AbstractCanalClientTest.java:80) ~[classes/:na]     at java.lang.Thread.run(Thread.java:745) ~[na:1.7.0_67] ## stop the canal client## canal client is down. è¿è¡Œçš„æ˜¯mvnï¼Ÿå°è¯•è°ƒæ•´ä¸‹mvnçš„jvmå‚æ•° 
107,canal è§£æmysqlå¼‚å¸¸ 2015-01-07 17:37:51.436 [destination = example   address = /192.168.0.20:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /192.168.0.20:3306 has an error  retrying. caused by com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. java.lang.IllegalArgumentException: bad format  x exceed: 2121395706  1000000000 è¿™ä¸ªæ˜¯ä»€ä¹ˆé—®é¢˜å¼•èµ·çš„ï¼Œmysqlæ˜¯slaveï¼Œå¹¶ä¸”binlogä¸æ˜¯åœ¨é»˜è®¤ç›®å½•ä¸‹é¢ è¯·æä¾›ä¸€ä¸‹mysqlç‰ˆæœ¬ä¿¡æ¯å’Œcanalç‰ˆæœ¬ä¿¡æ¯ mysql5.6.21 canal1.0.20ä¸€ï¼Œåœ¨slaveåº“ä¸Šæµ‹è¯•æŠ¥ï¼š2015-01-14 10:19:05.121 [main] WARNÂ  org.springframework.beans.TypeConverterDelegate - PropertyEditor [com.sun.beans.editors.EnumEditor] found through deprecated global PropertyEditorManager fallback - consider using a more isolated form of registration  e.g. on the BeanWrapper/BeanFactory!2015-01-14 10:19:05.231 [main] INFOÂ  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start CannalInstance for 1-example2015-01-14 10:19:05.365 [main] INFOÂ  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start successful....2015-01-14 10:19:05.366 [destination = example   address = /192.168.0.20:3306   EventParser] WARNÂ  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position by switch ::14207065360002015-01-14 10:19:05.770 [destination = example   address = /192.168.0.20:3306   EventParser] WARNÂ  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - ERROR ## parse this event has an error   last position : [EntryPosition[included=false journalName=mysql-bin.000092 position=59469 timestamp=1421036672000]]com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed.java.lang.IllegalArgumentException: bad format  x exceed: 2016149504  1000000000Â  Â  Â  Â  at com.taobao.tddl.dbsync.binlog.LogBuffer.getDecimal0(LogBuffer.java:1635) ~[canal.parse.dbsync-1.0.19.jar:na]Â  Â  Â  Â  at com.taobao.tddl.dbsync.binlog.LogBuffer.getDecimal(LogBuffer.java:1561) ~[canal.parse.dbsync-1.0.19.jar:na]Â  Â  Â  Â  at com.taobao.tddl.dbsync.binlog.event.RowsLogBuffer.fetchValue(RowsLogBuffer.java:335) ~[canal.parse.dbsync-1.0.19.jar:na]Â  Â  Â  Â  at com.taobao.tddl.dbsync.binlog.event.RowsLogBuffer.nextValue(RowsLogBuffer.java:95) ~[canal.parse.dbsync-1.0.19.jar:na]Â  Â  Â  Â  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseOneRow(LogEventConvert.java:449) ~[canal.parse-1.0.19.jar:na]Â  Â  Â  Â  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:364) ~[canal.parse-1.0.19.jar:na]Â  Â  Â  Â  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:109) ~[canal.parse-1.0.19.jar:na]Â  Â  Â  Â  at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:62) ~[canal.parse-1.0.19.jar:na]Â  Â  Â  Â  at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:323) ~[canal.parse-1.0.19.jar:na]Â  Â  Â  Â  at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:176) ~[canal.parse-1.0.19.jar:na]Â  Â  Â  Â  at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:124) [canal.parse-1.0.19.jar:na]Â  Â  Â  Â  at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:209) [canal.parse-1.0.19.jar:na] Â  Â  Â  Â  at java.lang.Thread.run(Thread.java:744) [na:1.7.0_51]äºŒï¼Œåœ¨masteræµ‹è¯•æŠ¥ï¼š015-01-14 10:10:28.992 [main] WARNÂ  org.springframework.beans.TypeConverterDelegate - PropertyEditor [com.sun.beans.editors.EnumEditor] found through deprecated global PropertyEditorManager fallback - consider using a more isolated form of registration  e.g. on the BeanWrapper/BeanFactory!2015-01-14 10:10:29.118 [main] INFOÂ  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start CannalInstance for 1-example2015-01-14 10:10:29.278 [main] INFOÂ  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start successful....2015-01-14 10:10:29.279 [destination = example   address = /192.168.0.21:3306   EventParser] WARNÂ  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position by switch ::14207065360002015-01-14 10:10:29.371 [destination = example   address = /192.168.0.21:3306   EventParser] WARNÂ  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - Didn't find the corresponding binlog files from mysql-bin.000001 to mysql-bin.000002 2015-01-14 10:10:29.376 [destination = example   address = /192.168.0.21:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /192.168.0.21:3306 has an error  retrying. caused bycom.alibaba.otter.canal.parse.exception.CanalParseException: can't find start position for exampleÂ æè¿…ï¼ˆrusonï¼‰ ä¸Šæµ·-hadoopå·¥ç¨‹å¸ˆï¼ŒELEME IncEmailï¼šxun.li@ele.me | Mobile:18201873319http://ele.me é¥¿äº†ä¹ˆ                            Â åŸå§‹é‚®ä»¶Â                             å‘ä»¶äºº:Â agapplenotifications@github.comæ”¶ä»¶äºº:Â alibaba/canalcanal@noreply.github.comæŠ„é€:Â rusongitxun.li@ele.meå‘é€æ—¶é—´:Â 2015å¹´1æœˆ13æ—¥(å‘¨äºŒ)â€‡18:41ä¸»é¢˜:Â Re: [canal] canal è§£æmysqlå¼‚å¸¸ (#107)è¯·æä¾›ä¸€ä¸‹mysqlç‰ˆæœ¬ä¿¡æ¯å’Œcanalç‰ˆæœ¬ä¿¡æ¯ â€”Reply to this email directly or view it on GitHub. mysql-bin.000092 position=59469 timestamp=1421036672000ï¼Œæ–¹ä¾¿æä¾›ä¸€ä¸‹å¯¹åº”çš„binlogæ–‡ä»¶ç»™æˆ‘ä¸ï¼Ÿæœ¬åœ°æµ‹è¯•äº†å¯¹åº”çš„mysql 5.6.22ç‰ˆæœ¬çš„decimalç±»å‹ï¼Œè§£ææ˜¯æ­£å¸¸çš„ è¿™æ˜¯æˆ‘ä»¬çº¿ä¸Šåº“ï¼Œä¸æ–¹ä¾¿æä¾›binlogï¼Œæˆ‘ä»¬åº“æ˜¯slaveåº“ï¼Œæ˜¯ä¸æ˜¯è¿™ä¸ªå¼•èµ·çš„ï¼Ÿæè¿…ï¼ˆrusonï¼‰ ä¸Šæµ·-hadoopå·¥ç¨‹å¸ˆï¼ŒELEME IncEmailï¼šxun.li@ele.me | Mobile:18201873319http://ele.me é¥¿äº†ä¹ˆ                            Â åŸå§‹é‚®ä»¶Â                             å‘ä»¶äºº:Â agapplenotifications@github.comæ”¶ä»¶äºº:Â alibaba/canalcanal@noreply.github.comæŠ„é€:Â rusongitxun.li@ele.meå‘é€æ—¶é—´:Â 2015å¹´1æœˆ14æ—¥(å‘¨ä¸‰)â€‡15:17ä¸»é¢˜:Â Re: [canal] canal è§£æmysqlå¼‚å¸¸ (#107)mysql-bin.000092 position=59469 timestamp=1421036672000ï¼Œæ–¹ä¾¿æä¾›ä¸€ä¸‹å¯¹åº”çš„binlogæ–‡ä»¶ç»™æˆ‘ä¸ï¼Ÿæœ¬åœ°æµ‹è¯•äº†å¯¹åº”çš„mysql 5.6.22ç‰ˆæœ¬çš„decimalç±»å‹ï¼Œè§£ææ˜¯æ­£å¸¸çš„ â€”Reply to this email directly or view it on GitHub. ä¸ç¡®å®šï¼Œæˆ‘è¯•è¿‡5.6.22ç‰ˆæœ¬æ˜¯æ­£å¸¸çš„ã€‚å¯ä»¥è¯•ç€åœ¨ä½ ä»¬æµ‹è¯•åº“ä¸­é‡ç°ä¸€ä¸‹é—®é¢˜ï¼Œåˆ°æ—¶å€™å‘æˆ‘binlogå³å¯ åˆæ­¥æ€€ç–‘æ˜¯è¿™ç±»é—®é¢˜ï¼Œå…ˆå…³é—­.  see : https://github.com/alibaba/canal/issues/119 
106,CanalController.javaå¼‚å¸¸å¤„ç†ä¸è§„èŒƒ **é—®é¢˜æè¿°** å·¥ç¨‹å¼•å…¥xerces.jarã€xercesImpl.jaræ—¶ï¼Œè¯»å–é…ç½®æ–‡ä»¶ä¼šå‡ºé—®é¢˜ï¼Œä¸èƒ½æ­£å¸¸è¿è¡Œã€‚ä½†æ˜¯å› ä¸ºCanalController.javaï¼ˆLine:286 ï¼‰ç¼ºå°‘å¯¹å¼‚å¸¸æƒ…å†µçš„å¤„ç†ï¼Œå¼‚å¸¸è¢«åï¼Œå¯¼è‡´ä¸èƒ½è¾“å‡ºå¼‚å¸¸ä¿¡æ¯ï¼Œå¢åŠ æ’æŸ¥é—®é¢˜çš„éš¾åº¦ã€‚ **å¼‚å¸¸ä¿¡æ¯** ``` org.springframework.beans.factory.BeanDefinitionStoreException: Parser configuration exception parsing XML from class path resource [spring/file-instance.xml]; nested exception is javax.xml.parsers.ParserConfigurationException: Unable to validate using XSD: Your JAXP provider [org.apache.xerces.jaxp.DocumentBuilderFactoryImpl@2e1551b0] does not support XML Schema. Are you running on Java 1.4 with Apache Crimson? Upgrade to Apache Xerces (or Java 1.5) for full XSD support. ``` **å»ºè®®** å¢åŠ try catchï¼Œå¹¶è®°å½•å¼‚å¸¸æ—¥å¿—ã€‚ ``` try { // è®¾ç½®å½“å‰æ­£åœ¨åŠ è½½çš„é€šé“ï¼ŒåŠ è½½springæŸ¥æ‰¾æ–‡ä»¶æ—¶ä¼šç”¨åˆ°è¯¥å˜é‡     System.setProperty(CanalConstants.CANAL_DESTINATION_PROPERTY  destination);     instanceGenerator.setBeanFactory(getBeanFactory(config.getSpringXml()));     instance = instanceGenerator.generate(destination); }catch(Exception e){     if(logger.isErrorEnabled()){         logger.error("generator instance failed." e);     } }finally {     System.setProperty(CanalConstants.CANAL_DESTINATION_PROPERTY  ""); } ``` å·²ä¿®å¤ 
105,mysql5.6å¼€å¯checksumå åŸºäºæ—¶é—´æŸ¥æ‰¾ä½ç‚¹ä¼šæ‰¾åˆ°é”™è¯¯çš„ä½ç½® é—®é¢˜æè¿°ï¼šåœ¨mysql5.6ä¹‹åç‰ˆæœ¬ä¸­ï¼Œå› ä¸ºå¼•å…¥äº†checksumæœºåˆ¶ï¼Œä¼šåœ¨æ­£å¸¸eventçš„æœ«å°¾åŠ ä¸Š4å­—èŠ‚çš„checksumï¼Œè€Œåœ¨åšåŸºäºæ—¶é—´æŸ¥æ‰¾çš„seekæ–¹æ³•ä¸­ï¼Œdecoderè§£ææœªè¯†åˆ«FORMATæ ¼å¼çš„eventäº‹ä»¶ï¼Œå¯¼è‡´æ²¡æœ‰åˆ¤æ–­å‡ºå¼€å¯äº†checksumï¼Œæ‰€ä»¥å¯¼è‡´æ­£å¸¸çš„äº‹åŠ¡å¤´çš„BEGINï¼Œå¤šäº†ä¸ª4ä¸ªå­—èŠ‚ï¼Œè€Œåˆ¤æ–­æ˜¯å¦ä¸ºäº‹åŠ¡å¤´é‡‡ç”¨äº†ä¸¥æ ¼çš„å­—ç¬¦ä¸²åŒ¹é…ï¼Œå°±å› ä¸ºå¤šäº†4ä¸ªå­—èŠ‚ï¼Œå¯¼è‡´eventç±»å‹å‡ºé”™ã€‚ å½±å“èŒƒå›´ï¼šåŸºäºmysql5.6 + å¼€å¯äº†checksum + æ¶‰åŠæ—¶é—´æŸ¥æ‰¾(æ¯”å¦‚ä¸»å¤‡åˆ‡æ¢å’ŒåŸºäºæ—¶é—´æˆ³å¯åŠ¨) ä¿®æ”¹: 1.  å¢åŠ formatç±»å‹è§£æ ```  LogDecoder decoder = new LogDecoder();         decoder.handle(LogEvent.ROTATE_EVENT);         decoder.handle(LogEvent.FORMAT_DESCRIPTION_EVENT);         decoder.handle(LogEvent.QUERY_EVENT);         decoder.handle(LogEvent.XID_EVENT);         LogContext context = new LogContext();         while (fetcher.fetch()) {             LogEvent event = null;             event = decoder.decode(fetcher  context);             if (event == null) {                 throw new CanalParseException("parse failed");             }             if (!func.sink(event)) {                 break;             }         } ``` 1. åŸºäºæ—¶é—´æŸ¥æ‰¾ï¼Œå¢åŠ äº‹åŠ¡begin/endçš„å¤šé‡åˆ¤æ–­. 13bf7c85a037a9e24d26c8f5c0aa007441fd9ae4 1.  åŸºäºæ—¶é—´æŸ¥æ‰¾ï¼Œå¢åŠ äº‹åŠ¡begin/endçš„å¤šé‡åˆ¤æ–­. åŸºäº1.0.19ç‰ˆæœ¬åšcanal instance ha  è¢«è¿™ä¸ªissues å‘äº†ä¸€æŠŠï¼Œæ²¡èƒ½æ‰¾åˆ°æ­£ç¡®çš„position ä¸¢äº†æ•°æ®; è€Œä¸”æ—¥å¿—é‡Œæ²¡æœ‰å¼‚å¸¸ï¼Œåæ¥å¯¹æ¯” switch time å’Œ  haåˆ‡æ¢åçš„ binlog timestamp  æ‰å‘ç°çš„ã€‚ https://github.com/alibaba/canal/commit/13bf7c85a037a9e24d26c8f5c0aa007441fd9ae4  å»ºè®®ä½ç‰ˆæœ¬çš„å°½å¿«ä¿®å¤ä¸Šè¿°patch
104,ä¿®å¤äº†é‡å¤è®¢é˜…æ²¡æœ‰çœŸæ­£ä¿®æ”¹è¿‡æ»¤å™¨çš„é—®é¢˜ æˆ‘è‡ªå·±åªç”¨default-instance.xmlé‡Œé¢çš„é…ç½®ï¼Œgroupæ¨¡å¼çš„æ²¡æ”¹ 
103,parseè§£æè‡ªåŠ¨åˆ‡æ¢å¤±è´¥ åŸå› åœ¨äºhaControlleré‡Œè¾¹çš„eventParseræ²¡æœ‰èµ‹å€¼ã€‚ é—®é¢˜ä¸å¤Ÿæ˜ç¡®ï¼Œéº»çƒ¦æè¿°ä¸‹æ›´å¤šçš„é‡ç°è¯¥é—®é¢˜çš„æ¡ä»¶ 
102,ä¿®æ­£æ’ä»¶çš„å£°æ˜ tks 
101,è®¾ç½®filterTransactionEntryåï¼Œå¯¼è‡´MetaManagerä¸­clientå¾—cursor å¾—ä¸åˆ°æ›´æ–° åœ¨EvenSinkä¸­ï¼Œhttps://github.com/alibaba/canal/blob/master/sink/src/main/java/com/alibaba/otter/canal/sink/entry/EntryEventSink.java#L77 æ­¤å¤„ä»£ç ä¼šåœ¨filterTransactionEntryè®¾ç½®ä¸ºtrueçš„æ—¶å€™è¿‡æ»¤åˆ°TRANSACTION_BEGINå’ŒENDçš„eventã€‚ è€Œåœ¨getWithoutAck ->  getEvents -> com/alibaba/otter/canal/store/memory/MemoryEventStoreWithBuffer.java ä¸­ï¼Œçš„ doGet æ–¹æ³•ä¸­å¯ä»¥çœ‹åˆ°ï¼Œè®¾ç½®LogPositionRange çš„ackå±æ€§æ˜¯æ ¹æ®è¿™ä¸ªrangeä¸­æ˜¯å¦å­˜åœ¨TRANSACTION_BEGIN å’ŒENDçš„eventæ¥è¿›è¡Œè®¾ç½®çš„ã€‚ å¦‚æœè®¾ç½®äº†filterTransactionEntry é‚£ä¹ˆè¿™é‡Œè¿”å›ç»™clientçš„messageå¯¹åº”çš„positionRangeçš„ackä¸ºnullã€‚ åœ¨clientç¡®è®¤çš„æ—¶å€™ï¼ŒæœåŠ¡ç«¯æ‰§è¡Œackæ–¹æ³•ï¼š https://github.com/alibaba/canal/blob/master/server/src/main/java/com/alibaba/otter/canal/server/embeded/CanalServerWithEmbeded.java#L348 è¿™é‡Œä¼šå‘ç°å¦‚æœackä¸ºnullï¼Œåˆ™ä¸æ›´æ–°metaä¿¡æ¯ çœ‹äº†ä¸€ä¸‹ä»£ç ï¼Œè™½ç„¶ä½ å¼ºåˆ¶æ›´æ–°äº†cursorï¼Œä½†æ˜¯æ²¡è§£å†³positionRanges.getAck()å‡ºç°nullå€¼ï¼Œå¦‚æœnullå€¼è¿˜æ˜¯ä¼šå¿½ç•¥æœ¬æ¬¡æ›´æ–°ã€‚è¿™é‡Œåº”è¯¥æ˜¯è¿”å›æœ€åä¸€æ¡çš„æ•°æ®ä½ç‚¹.  ps.  è¿™æ ·çš„æ›´æ–°è¿˜æ˜¯ä¼šæœ‰ä¸€äº›é—®é¢˜ï¼Œå› ä¸ºä½ ä½ç‚¹è®°å½•çš„å¯èƒ½æ˜¯äº‹åŠ¡ä¸­çš„ç¬¬ä¸€æ¡æ›´æ–°ï¼Œä¸‹æ¬¡é‡å¯åï¼Œé‡æ–°è·å–binlogä¼šå‡ºç°æ‰¾ä¸åˆ°TableIdçš„æƒ…å†µ å“¦ï¼ŒfilterTransactionè¿™ä¸ªé€‰é¡¹å½“åˆè®¾è®¡æ˜¯ä¸ºäº†ä»€ä¹ˆæƒ…å½¢çš„ï¼Ÿ å‘è‡ªChinaXing iPhone > åœ¨ 2014å¹´10æœˆ10æ—¥ï¼Œ18:32ï¼Œagapple notifications@github.com å†™é“ï¼š >  > çœ‹äº†ä¸€ä¸‹ä»£ç ï¼Œè™½ç„¶ä½ å¼ºåˆ¶æ›´æ–°äº†cursorï¼Œä½†æ˜¯æ²¡è§£å†³positionRanges.getAck()å‡ºç°nullå€¼ï¼Œå¦‚æœnullå€¼è¿˜æ˜¯ä¼šå¿½ç•¥æœ¬æ¬¡æ›´æ–°ã€‚è¿™é‡Œåº”è¯¥æ˜¯è¿”å›æœ€åä¸€æ¡çš„æ•°æ®ä½ç‚¹. >  > ps. è¿™æ ·çš„æ›´æ–°è¿˜æ˜¯ä¼šæœ‰ä¸€äº›é—®é¢˜ï¼Œå› ä¸ºä½ ä½ç‚¹è®°å½•çš„å¯èƒ½æ˜¯äº‹åŠ¡ä¸­çš„ç¬¬ä¸€æ¡æ›´æ–°ï¼Œä¸‹æ¬¡é‡å¯åï¼Œé‡æ–°è·å–binlogä¼šå‡ºç°æ‰¾ä¸åˆ°TableIdçš„æƒ…å†µ >  > â€” > Reply to this email directly or view it on GitHub. è¿™ä¸ªæš‚æ—¶åº”è¯¥æ²¡ç”¨ä¸Šï¼Œä¹‹å‰ä¸»è¦æ˜¯è€ƒè™‘group-instance.xmlæ¨¡å¼ï¼Œå¤šä¸ªåº“æ•°æ®åˆå¹¶æ—¶å¿½ç•¥äº‹ç‰©begin/endï¼Œåæ¥åšäº†ä¸€ä¸ªç‰ˆæœ¬å¯ä»¥æ•´ä¸ªäº‹åŠ¡ä¸€èµ·åšåˆå¹¶ï¼Œè¿™å—ä»£ç å°±ç›¸å½“äºæ²¡ç”¨ä¸Šè¿‡ï¼Œå¯ä»¥å¿½ç•¥ã€‚ äº‹åŠ¡çš„begin/endï¼Œæˆ‘æœ‰ä¸€å®šçš„æœºåˆ¶ä¼šå¿½ç•¥ç©ºçš„äº‹åŠ¡ ä½ æœ‰å¿½ç•¥äº‹åŠ¡begin/endçš„éœ€æ±‚ï¼Ÿ 
100,è®¾ç½®filterTransactionEntryåï¼Œå¯¼è‡´MetaManagerä¸­clientå¾—cursor å¾—ä¸åˆ°æ›´æ–° åœ¨EvenSinkä¸­ï¼Œhttps://github.com/alibaba/canal/blob/master/sink/src/main/java/com/alibaba/otter/canal/sink/entry/EntryEventSink.java#L77 æ­¤å¤„ä»£ç ä¼šåœ¨filterTransactionEntryè®¾ç½®ä¸ºtrueçš„æ—¶å€™è¿‡æ»¤åˆ°TRANSACTION_BEGINå’ŒENDçš„eventã€‚ è€Œåœ¨getWithoutAck ->  getEvents -> com/alibaba/otter/canal/store/memory/MemoryEventStoreWithBuffer.java ä¸­ï¼Œçš„ doGet æ–¹æ³•ä¸­å¯ä»¥çœ‹åˆ°ï¼Œè®¾ç½®LogPositionRange çš„ackå±æ€§æ˜¯æ ¹æ®è¿™ä¸ªrangeä¸­æ˜¯å¦å­˜åœ¨TRANSACTION_BEGIN å’ŒENDçš„eventæ¥è¿›è¡Œè®¾ç½®çš„ã€‚ å¦‚æœè®¾ç½®äº†filterTransactionEntry é‚£ä¹ˆè¿™é‡Œè¿”å›ç»™clientçš„messageå¯¹åº”çš„positionRangeçš„ackä¸ºnullã€‚ åœ¨clientç¡®è®¤çš„æ—¶å€™ï¼ŒæœåŠ¡ç«¯æ‰§è¡Œackæ–¹æ³•ï¼š https://github.com/alibaba/canal/blob/master/server/src/main/java/com/alibaba/otter/canal/server/embeded/CanalServerWithEmbeded.java#L348 è¿™é‡Œä¼šå‘ç°å¦‚æœackä¸ºnullï¼Œåˆ™ä¸æ›´æ–°metaä¿¡æ¯ 
99,é‡å¯canalåæŸäº›æƒ…å†µä¸‹parseEventå¤±è´¥æ— æ³•ç»§ç»­ å¼‚å¸¸å¦‚ä¸‹ï¼š 2014-09-23 12:49:09.635 [destination = db2   address = /10.15.2.116:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:db2[com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: com.alibaba.otter.canal.parse.exception.TableIdNotFoundException: not found tableId:71 æ­¤å¼‚å¸¸ä¼šä¸€ç›´ä¸æ–­é‡å¤ï¼Œå¯¼è‡´binlogçš„æ¶ˆè´¹åœç•™åœ¨æ­¤LogPositionä¸å¾€ä¸‹ç»§ç»­ã€‚ è§¦å‘åœºæ™¯ï¼š åœæ‰canalåå¯åŠ¨. å¼‚å¸¸æƒ…å†µåŸå› æ¨æ–­æ˜¯å› ä¸ºé‡å¯åé‡åˆ°çš„binlog eventæ²¡æœ‰TABLE_MAP_EVENTå¼€å¤´ï¼Œè€Œæ°å¥½ç›´æ¥å‡ºç°åç»­çš„eventï¼Œå¯¼è‡´logContextçš„tableå­—æ®µæœªè®¾ç½® é€šè¿‡æŸ¥è¯¢å¼‚å¸¸çš„å‡ºç°ç‚¹åœ¨ï¼š ``` com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert private Entry parseRowsEvent(RowsLogEvent event) {         try {             TableMapLogEvent table = event.getTable();             if (table == null) {                 // tableIdå¯¹åº”çš„è®°å½•ä¸å­˜åœ¨                 throw new TableIdNotFoundException("not found tableId:" + event.getTableId());             }  ... ``` eventçš„tableå­—æ®µè®¾ç½®ï¼š ``` com.taobao.tddl.dbsync.binlog.event.RowsLogEvent public final void fillTable(LogContext context)     {         table = context.getTable(tableId);         // end of statement check:         if ((flags & RowsLogEvent.STMT_END_F) != 0)         {             // Now is safe to clear ignored map (clear_tables will also             // delete original table map events stored in the map).             context.clearAllTables();         }     } ``` ``` com.taobao.tddl.dbsync.binlog.LogContext public final void putTable(TableMapLogEvent mapEvent)     {         mapOfTable.put(Long.valueOf(mapEvent.getTableId())  mapEvent);     } ``` ``` com.taobao.tddl.dbsync.binlog.LogDecoder.decode æ–¹æ³•  case LogEvent.TABLE_MAP_EVENT:             {                 TableMapLogEvent mapEvent = new TableMapLogEvent(header                         buffer  descriptionEvent);                 /* updating position in context */                 logPosition.position = header.getLogPos();                 context.putTable(mapEvent);                 return mapEvent;             } ``` å‡ºç°TableIdNotFoundExceptionï¼Œä¸»è¦æ˜¯ä½ binlogçš„èµ·å§‹ä½ç‚¹ä¸æ˜¯ä¸€ä¸ªäº‹åŠ¡å¼€å¤´æˆ–è€…ç»“å°¾ï¼Œåªèƒ½é‡ç½®ä¸‹ä½ç‚¹ å“¦ã€‚æ˜¯é€šè¿‡show bin log events ï¼Œç„¶åæ‰¾ä¸€ä¸ªé™„è¿‘çš„ä½ç‚¹ï¼Ÿ 2014-09-30 10:11 GMT+08:00 agapple notifications@github.com: > å‡ºç°TableIdNotFoundExceptionï¼Œä¸»è¦æ˜¯ä½ binlogçš„èµ·å§‹ä½ç‚¹ä¸æ˜¯ä¸€ä¸ªäº‹åŠ¡å¼€å¤´æˆ–è€…ç»“å°¾ï¼Œåªèƒ½é‡ç½®ä¸‹ä½ç‚¹ >  > â€” > Reply to this email directly or view it on GitHub > https://github.com/alibaba/canal/issues/99#issuecomment-57258051. ##  --- Best Regards ! é™ˆäº‘æ˜Ÿ  Tel : 1866122992 æ˜¯çš„ 
98,fix bug in test OS with 64bit (follow symbole link files) ä¿®æ­£æ¢æµ‹OS æ˜¯å¦ä¸º64bitçš„bug: 1. å½“$JAVA ä¸ºç¬¦å·é“¾æ¥æ–‡ä»¶æ—¶ æ— æ³•è¯†åˆ« 2. `$JAVA_HOME/bin/java  /=  $JAVA` 
97,group é…ç½®å®ç° ä½ å¥½ï¼Œæˆ‘çœ‹äº†group-instance.xml å‘ç°ä¸¤ä¸ªeventParseré…ç½®äº†åŒä¸€ä¸ªdestinationï¼Œè€Œä¸”ä¸‹é¢çš„master å’Œstandby åªæœ‰ä¸€ä¸ªæ•°æ®åº“ï¼Œè¯·é—®æ˜¯å¦‚ä½•å®ç°Nï¼š1 çš„ï¼Ÿ å¤šè°¢ï¼ æ‰¾åˆ°äº†master å’Œ standby é…ç½®äº†ä¸¤ä¸ªåº“ã€‚ æˆ‘è¿™è¾¹è¿˜æœ‰ä¸€äº›ç–‘é—®ï¼š 1. group-instance.xml ä¸­logPosition ä½¿ç”¨çš„æ—¶Memoryçš„ï¼Œè¿™æ ·åœ¨æ•…éšœæ¢å¤çš„æ—¶å€™ï¼Œposition ä¼šå˜æˆbinlog çš„æœ€åä½ç½®ï¼ˆshow master statusï¼‰ï¼Œè¿™æ ·çš„è¯ï¼Œä¼šé€ æˆä¸€éƒ¨åˆ†bin log äº‹ä»¶ä¸¢å¤±ã€‚ 2. åŸºäºzk çš„logPosition æŒä¹…åŒ–å®ç°ã€‚æ— æ³•ä½¿ç”¨åœ¨group-instance.xmlä¸­ï¼Œå› ä¸ºparser1 å’Œ parser2 éƒ½æ˜¯åŒä¸€ä¸ªdestinationå€¼ï¼Œåœ¨zkä¸­ä¼šå–åˆ°åŒä¸€ä»½æ•°æ®ã€‚ 3. å…³äºN:1æ¨¡å¼å¤šä¸ªdbï¼Œæ•°æ®é¡ºåºæ€§æ˜¯æ²¡æ³•ä¿è¯çš„å§ã€‚è¿™ä¸ªæœ‰æ²¡æœ‰ä»€ä¹ˆé—®é¢˜åœ¨æŸäº›æƒ…å†µä¸‹ï¼Ÿ groupæ¨¡å¼çš„ä½ç‚¹è®°å½•æ˜¯åŸºäºtimestampçš„ï¼Œæ¯ä¸ªdestinationåªæœ‰ä¸€ä»½ï¼Œç„¶åä¸åŒçš„parseråŸºäºæ—¶é—´æˆ³åšé‡æ–°å®šä½ï¼Œé‡å¤æ•°æ®ç›¸æ¯”äºå•åº“æ¨¡å¼è¦å¤šä¸€äº› 
96,è¡¨é»‘åå•é»˜è®¤å…³é—­ ç›®å‰è¡¨é»‘åå•å®šä¹‰é’ˆå¯¹springæ¨¡å¼ï¼Œè™½ç„¶é…ç½®äº†ä¸€ä¸ªç©ºå€¼ï¼Œé’ˆå¯¹AviaterRegexFilterç©ºå€¼æ„å‘³ç€å…¨åŒ¹é…ï¼Œæ‰€ä»¥æ‰€æœ‰çš„æ•°æ®å…¨éƒ¨è¢«å½“ä½œé»‘åå•è¿‡æ»¤äº† AviaterRegexFilteræ›¾åŠ ä¸ªå±æ€§ï¼Œç‰¹æ®Šå¤„ç†ç©ºå€¼ 
95,canalè§£æå°†mysql setç±»å‹è½¬ä¸ºunsigned longç±»å‹ mysqlä¸­setçš„æ•°æ®è¡¨ç¤ºæ˜¯é€šè¿‡bitæ¥æè¿°.   ä¸¾ä¸ªä¾‹å­ï¼šæ¯”å¦‚set('a' 'b 'c ' 'd')ï¼Œæ’å…¥ä¸€æ¡'a' 'c'çš„è®°å½•ï¼Œmysqlç”¨bitè¡¨ç¤ºå°±æ˜¯1010ï¼Œè½¬åŒ–ä¸º10è¿›åˆ¶å°±æ˜¯5ï¼Œæ³¨æ„æ˜¯litten-endian. 
94,canal/example/src/main/bin/startup.sh ALIBABA_JAVA="/usr/alibaba/java/bin/java" TAOBAO_JAVA="/opt/taobao/java/bin/java" ...   elif [ -f $ALIBABA_JAVA ] ; then     JAVA=$TAOBAO_JAVA ...   elif [ -f $TAOBAO_JAVA ] ; then     JAVA=$TAOBAO_JAVA ... çœ‹åˆ°è„šæœ¬é—®é¢˜äº†ï¼Œåº”è¯¥æ˜¯è¿™æ · ... elif [ -f $ALIBABA_JAVA ] ; then JAVA=$ALIBABA_JAVA ... elif [ -f $TAOBAO_JAVA ] ; then JAVA=$TAOBAO_JAVA ... 
93,æ”¯æŒè¡¨é»‘åå•å®šä¹‰ <=1.0.17ç‰ˆæœ¬ï¼Œè®¢é˜…è¡¨ç›®å‰åªæ”¯æŒæ­£å‘åŒ¹é…ï¼Œè€Œç›®å‰æ­£åˆ™è¡¨è¾¾å¼å¯¹äºéœ€è¦å•ç‹¬æ’é™¤æŸå¼ è¡¨æ—¶ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œå¸Œæœ›å¯ä»¥æœ‰ç™½åå•+é»‘åå•çš„å®šä¹‰.  ç­–ç•¥ï¼š 1.  å¦‚æœåªæœ‰ç™½åå•ï¼Œé‚£å°±æ˜¯åªè¿›è¡Œæ­£å‘åŒ¹é… 2.  å¦‚æœåªæœ‰é»‘åå•ï¼Œé‚£å°±æ˜¯åªæ’é™¤é»‘åå•åŒ¹é… 3.  å¦‚æœé»‘+ç™½åå•ï¼Œå…ˆåšç™½åå•åŒ¹é…ï¼Œå†åšé»‘åå•æ’é™¤ ä¸é…ç½®é»‘åå•çš„æƒ…å†µä¸‹ï¼Œç™½åå•ä¸å·¥ä½œã€‚ çœ‹issue #96 ï¼Œå·²ç»ä¿®å¤ 
92,å¦‚æœå‡ºç°è§£æå¼‚å¸¸ï¼Œå…è®¸è·³è¿‡ é’ˆå¯¹å‡ºç°åˆ—ä¸ä¸€è‡´ï¼Œè¡¨ä¸å­˜åœ¨ç­‰æƒ…å†µï¼Œè·³è¿‡è§£æå¼‚å¸¸ï¼Œå¹¶è®°å½•å¯¹åº”çš„æ•°æ®æ—¥å¿—ï¼Œä¾›äººè‚‰å¤„ç†ï¼Œé»˜è®¤ä¸ºfalseï¼Œé…åˆotterä½¿ç”¨ é”™è¯¯æ•°æ®å¯ä»¥é€šè¿‡Alarmçš„æ–¹å¼æŠ¥å‘Šï¼Œæ¯”å¦‚otter manager 
91,SimpleCanalConnectoråœ¨ç«äº‰çš„æ—¶å€™ä¼šæŠ›should connect firstçš„Exception _Repro_: 1. ä½¿ç”¨default-instanceæ¨¡å¼ï¼ˆæœ‰Zookeeperæ”¯æŒï¼‰çš„Canal Serverï¼› 2. Setupç¬¬ä¸€ä¸ªClusterCanalClientï¼Œè°ƒç”¨connectçš„æ—¶å€™ï¼ŒæˆåŠŸè¿æ¥ï¼› 3. Setupç¬¬äºŒä¸ªClusterCanalClientï¼Œè°ƒç”¨connectçš„æ—¶å€™ï¼Œä¼šæŠ›Exception: com.alibaba.otter.canal.protocol.exception.CanalClientException: should connect first         at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.waitClientRunning(SimpleCanalConnector.java:418)         at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.subscribe(SimpleCanalConnector.java:186)         at com.alibaba.otter.canal.client.impl.ClusterCanalConnector.subscribe(ClusterCanalConnector.java:100) _Expected_: ç¬¬äºŒä¸ªClusterCanalClientåœ¨connectçš„æ—¶å€™åº”è¯¥è¢«blockä½ï¼Œç›´è‡³å…¶å®ƒçš„client disconnectã€‚ æ¨æµ‹åŸå› ï¼ˆè§ä¸‹é¢çš„gistä¿®æ”¹ï¼‰ https://gist.github.com/caojia/10960073/revisions ä½ çš„ç†è§£æ˜¯å¯¹çš„ï¼Œä¼°è®¡ä¿®æ”¹å¦ä¸€ä¸ªbugè€ƒè™‘ä¸å…¨ï¼Œä»£ç æˆ‘åšäº†ä¸‹ä¿®æ”¹ï¼Œå¤šè°¢ è°¢è°¢ï¼åœ¨connectå‡½æ•°é‡Œé¢è°ƒç”¨waitClientRunningçš„æ—¶å€™æ˜¯ä¸æ˜¯è¿˜åº”è¯¥ä¼ ä¸ªfalseçš„å‚æ•°? å¦å¤–ï¼Œä½ ä»¬ä¼šæŠŠè¿™ä¸ªä¿®æ”¹pushåˆ°mavenä¸Šä¹ˆï¼Ÿ éªŒè¯é€šè¿‡åä¼šæäº¤åˆ°mavenä»“åº“ 
90, MasteræŒ‚æ‰åçš„æ¢å¤ Hi jianghangï¼Œ ä½ å¥½ï¼è¯·é—®å¦‚æœåœ¨Canalçš„æ¶æ„ä¸­ï¼Œå¦‚æœMysqlçš„MasteræŒ‚æ‰åï¼Œæ–°çš„Slaveè¢«Promoteæˆæ–°çš„Masterï¼ŒCanalèƒ½å¤Ÿæ‰¾åˆ°binlogåœ¨åŸMasterçš„ä½ç½®æ‰€å¯¹åº”çš„æ–°çš„Masterçš„ä½ç½®ä¹ˆï¼Ÿæ˜¯å¦èƒ½ä¿è¯Canalä¸­çš„Change Eventæ˜¯Exactly Onceçš„ï¼Ÿ è°¢è°¢ï¼ ä¸ä¿è¯Exactly Onceï¼Œä¼šæœ‰é‡å¤æ•°æ® 
89,å®¢æˆ·ç«¯ä¸åœé‡è¿æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯å¯åŠ¨åï¼Œå®¢æˆ·ç«¯è¿æ¥çº¿ç¨‹å¡æ­»ã€‚ å½“åªæœ‰ä¸€ä¸ªcanal serverçš„æ—¶å€™ï¼Œå®¢æˆ·ç«¯ä¸åœçš„é‡è¿æœåŠ¡ç«¯ï¼Œå½“æœåŠ¡ç«¯å¯åŠ¨åï¼Œå®¢æˆ·ç«¯è¿æ¥çº¿ç¨‹ä¼šå¡æ­»ã€‚ é—®é¢˜å‡ºç°åœ¨SimpleCanalConnectorçš„initClientRunningMonitorçš„æ–¹æ³•ã€‚    runningMonitor.setListener(new ClientRunningListener() { ```             public InetSocketAddress processActiveEnter() {                 InetSocketAddress address = doConnect();                 mutex.set(true);                 if (rollbackOnConnect) {                     rollback();                 }                 return address;             }             public void processActiveExit() {                 mutex.set(false);                 doDisconnnect();             }         }); ``` å½“doConnectå‡ºç°å¼‚å¸¸é€€å‡ºåï¼Œmutex.set(true)æœªè¢«æ‰§è¡Œï¼ŒæŠ›å‡ºçš„å¼‚å¸¸ä¼šè¢«å¤–å±‚è°ƒç”¨å‡½æ•°catchä½ï¼Œè¿™æ ·å¯¼è‡´å…¶ä»–å‡½æ•°ä¼šå¡æ­»åœ¨mutexè¿™ä¸ªé”ä¸Šã€‚ https://github.com/alibaba/canal/issues/77 å’Œè¿™ä¸ªissueç›¸ä¼¼ï¼Œä½¿ç”¨1.0.16+çš„ç‰ˆæœ¬ æš‚æ—¶å…³é—­ï¼Œæœ‰é—®é¢˜å†reopen 
88,canal deployer 1.0.14ç‰ˆæœ¬ï¼Œåœ¨clientç«¯æ¥å—åˆ°çš„entryéƒ½æ˜¯TRANSACTION_BEGINå’ŒTRANSACTION_END å…·ä½“ç°è±¡æ˜¯è¿™æ ·çš„ï¼Œåœ¨canalçš„serverç«¯å¯åŠ¨çš„ä¸€å°æ®µæ—¶é—´å†…æ¥å—åˆ°çš„æ•°æ®æ˜¯æ­£å¸¸çš„ï¼Œä½†æ˜¯åœ¨è¿‡å¤§çº¦10åˆ†é’Ÿä¹‹åï¼Œå®¢æˆ·ç«¯æ¥å—åˆ°çš„entryçš„entryTypeå°±å…¨éƒ¨ä¸ºTRANSACTION_BEGINå’ŒTRANSACTION_ENDäº†ã€‚ æ›¾ç»æ€€ç–‘æ˜¯æˆ‘å†™çš„å®¢æˆ·ç«¯æœ‰é—®é¢˜ï¼Œä½†æ˜¯æŠŠå®¢æˆ·ç«¯æ¢æˆç¤ºä¾‹å®¢æˆ·ç«¯è¿˜æ˜¯ä¸€æ ·çš„æ•ˆæœã€‚ å·²ç»å°è¯•å°†serverç«¯çš„æ—¥å¿—çº§åˆ«è®¾ç½®ä¸ºdebugï¼Œä½†æ˜¯æ²¡æœ‰å¾—åˆ°ä»€ä¹ˆæœ‰ä»·å€¼çš„è°ƒè¯•ä¿¡æ¯ã€‚ éº»çƒ¦æä¾›ä¸€ä¸‹è§£å†³æ­¤é—®é¢˜çš„æ€è·¯ï¼Œæˆ–è€…æˆ‘çš„serverç«¯é…ç½®æœ‰é—®é¢˜ï¼Œå¯èƒ½æ˜¯å“ªå„¿çš„é—®é¢˜ï¼Œè°¢è°¢ï¼ï¼ï¼ æä¾›serverç«¯çš„instance.propertiesé…ç½®å’Œå®¢æˆ·ç«¯ä»£ç  è¿™ä¸ªé—®é¢˜çš„åŸå› æ‰¾åˆ°äº†ã€‚ åœ¨instance.propertiesä¸­é…ç½®çš„æ•°æ®åº“åç§°æ˜¯å°å†™çš„ï¼Œä½†æ˜¯mysqlä¸Šçš„æ•°æ®åº“æ˜¯å¤§å†™çš„ï¼ŒåŒæ—¶é…ç½®äº†å¤§å°å†™æ•æ„Ÿï¼Œæ‰€ä»¥å¤§å¤šæ•°çš„æ˜¯ç©ºçš„ã€‚ ä½†æ˜¯ï¼šï¼šä¸è§£çš„æ˜¯ä¸ºä»€ä¹ˆä¼šæ¶ˆè´¹ä¸€æ®µæ—¶é—´ï¼Œç„¶åå°±ä¸è¡Œäº†ã€‚å¦‚æœæ˜¯å› ä¸ºå¤§å°å†™çš„åŸå› ï¼Œé‚£åº”è¯¥æ˜¯ä¸€æ¡éƒ½æ²¡æœ‰ï¼Œè¿™æ ·æ‰åˆç†ã€‚ å»ºè®®ï¼šåœ¨canal.propertiesä¸­å¢åŠ å¤§å°å†™æ•æ„Ÿçš„é€‰é¡¹ instance.propertiesä¸­çš„è¡¨è¾¾å¼ï¼Œåœ¨canalç¼–è¯‘ä¸ºæ­£åˆ™è¡¨è¾¾å¼æ—¶å¼€å¯äº†å¤§å°å†™ä¸æ•æ„Ÿå‚æ•°(Perl5Compiler.CASE_INSENSITIVE_MASK)ï¼Œæ‰€ä»¥ä½ è¿™ä¸ªé—®é¢˜æ¨è®ºå¯èƒ½æœ‰è¯¯ æ˜¯çš„ã€‚ å®¢æˆ·ç«¯é…ç½®è®¢é˜…è§„åˆ™çš„æ—¶å€™é…ç½®çš„é—®é¢˜ã€‚subscribeçš„è§„åˆ™å†™é”™äº†ï¼Œå¯¼è‡´æ‰€æœ‰çš„å†…å®¹éƒ½è¿›ä¸æ¥ã€‚ å®¢æˆ·ç«¯çš„subscribeä¼˜å…ˆäºinstance.propertiesä¸­çš„é…ç½® åŒæ ·çš„é—®é¢˜ `connector.subscribe("actionlog\\d{8}");`æˆ‘æƒ³è®¢é˜…æ‰€æœ‰actionlogæ‰“å¤´æ¥æ•°å­—çš„è¡¨ï¼Œç»“æœæ²¡æœ‰ROWDATAäº†ï¼Œæ˜¯æ­£åˆ™é”™äº†ï¼Œè¿˜æ˜¯å“ªé‡Œé”™äº†ï¼Ÿ è¯·æ•™ä¸€ä¸‹æƒ³è®¢é˜…æŒ‡å®šçš„åº“æˆ–è€…è¡¨ï¼Œè¿™ä¸ªæ­£åˆ™è¦æ€ä¹ˆå†™ï¼Ÿ
87,groupæ¨¡å¼å¼€å¯äº†HeartBeatçº¿ç¨‹ï¼Œå‡ºç°æ•°æ®é˜»å¡ otter issue : https://github.com/alibaba/otter/issues/46 
86,canalä¸­é’ˆå¯¹groupæƒ…å†µä¸æ”¯æŒéHeartBeatçš„HAæ–¹å¼ æ”¯æŒä¸‹otter issue : https://github.com/alibaba/otter/issues/45 
85,æ— æ³•è®¾ç½®max_packet_sizeï¼Œå¯èƒ½å¯¼è‡´æ— æ³•åŒæ­¥binlog max_packet_sizeé»˜è®¤æ˜¯16mï¼Œå¦‚æœmysql packetå¤§äº16mï¼Œåˆ™canalæ— æ³•åŒæ­¥binlogã€‚ http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_max_allowed_packet éœ€è¦é€šè¿‡è®¾ç½®sessionå˜é‡æ¥è§£å†³ çœ‹äº†ä¸‹binlogçš„packetï¼Œç›®å‰é»˜è®¤æ˜¯è¯»å–3å­—èŠ‚åšä¸ºlength ä¹Ÿå°±æ˜¯æœ€å¤šåªèƒ½æ ‡ç¤º16MBçš„å¤§å°ï¼Œè¶…è¿‡16MBæ‹†åˆ†ä¸ºå¤šä¸ªpacketï¼Œæš‚æ—¶ä¸æ¸…æ¥šmax_allowed_packetè°ƒæ•´åï¼Œmysql serverç«¯æ˜¯å¦ä¼šè°ƒæ•´netlençš„å­—èŠ‚æ•°æ¥è§£å†³å¤§åŒ…çš„ä¼ è¾“.  <pre> // Fetching the first packet(may a multi-packet). int netlen = getUint24(PACKET_LEN_OFFSET); int netnum = getUint8(PACKET_SEQ_OFFSET); </pre> å…¶å®å‘å‡ºæ¥çš„å•ä¸ªåŒ…ä»£ç é‡Œé¢ç”¨å®å†™æ­»çš„ï¼Œæœ€å¤§å°±æ˜¯16Mï¼Œnetlenéå‹ç¼©åŒ…é»˜è®¤å°±æ˜¯è§£æå‰ä¸‰ä¸ªå­—èŠ‚ä½œä¸ºé•¿åº¦ã€‚mysql serverç«¯ä¸ä¼šæ ¹æ®max_allowed_packetè°ƒèŠ‚è¿™ä¸ªä¸œè¥¿çš„ã€‚ é•¿åº¦æ§åˆ¶è¿™ä¸€å—æœ‰å¥½å‡ ä¸ªå±‚çº§ã€‚max_allowed_packetå½±å“ä¸åˆ°æœ€å†…å±‚çš„å‘åŒ…å¤§å°é™åˆ¶ã€‚ MYSQL  è¯»å–æ—¥å¿—çš„å‡½æ•°handle_slave_ioé‡Œé¢çš„ read_eventä¼šè°ƒç”¨my_net_readï¼Œè€Œè¿™ä¸ªå‡½æ•°é»˜è®¤ä¼šæœ‰ä¸€ä¸ªç»„åŒ…çš„è¿‡ç¨‹ã€‚ æ‰€ä»¥MYSQLæ­£å¸¸æ˜¯å¯ä»¥æ‹¼å‡ºé•¿åº¦å¤§äº16Mçš„log eventçš„ã€‚canalè¿™ä¸€å—å¤„ç†å¯èƒ½æ²¡æœ‰åšã€‚ é™„ï¼š ulong my_net_read(NET *net) {   size_t len  complen;   MYSQL_NET_READ_START(); #ifdef HAVE_COMPRESS   if (!net->compress)   { #endif     len= net_read_packet(net  &complen);     if (len == MAX_PACKET_LENGTH)     {       /\* First packet of a multi-packet.  Concatenate the packets _/       ulong save_pos = net->where_b;       size_t total_length= 0;       do       {         net->where_b += len;         total_length += len;         len= net_read_packet(net  &complen);       } while (len == MAX_PACKET_LENGTH);       if (len != packet_error)         len+= total_length;       net->where_b = save_pos;     }     net->read_pos = net->buff + net->where_b;     if (len != packet_error)       net->read_pos[len]=0;     /_ Safeguard for mysql_use_result */     MYSQL_NET_READ_DONE(0  len);     return len; #ifdef HAVE_COMPRESS   } å¤šäº›åé¦ˆmysqlçš„å®ç°ï¼Œmysqlé€šè¿‡å¤špacketæ¨¡å¼æ¥è§£å†³å¤§åŒ…é—®é¢˜ï¼Œåªéœ€è¦å®¢æˆ·ç«¯å¤„ç†çš„æ—¶å€™èƒ½å¯¹packetè¿›è¡Œé‡æ–°ç»„åŒ…å³å¯.   ç›®å‰canalå¤„ç†é€»è¾‘ï¼š // Fetching the first packet(may a multi-packet). int netlen = getUint24(PACKET_LEN_OFFSET); int netnum = getUint8(PACKET_SEQ_OFFSET); if (!fetch0(NET_HEADER_SIZE  netlen)) { return false;  } while (netlen == MAX_PACKET_LENGTH) // é’ˆå¯¹16MBçš„packetï¼Œç»§ç»­è¯»å–ä¸‹ä¸€ä¸ªpacket {      netlen = getUint24(PACKET_LEN_OFFSET);      netnum = getUint8(PACKET_SEQ_OFFSET);      if (!fetch0(limit  netlen))      { return false; } } 
84,æ”¯æŒmariadb5.5.34/10.0.7ç‰ˆæœ¬çš„binlogè§£æ æ”¯æŒä¸‹maraidb 5/10ç‰ˆæœ¬çš„binlogè§£æ å˜åŒ–å†…å®¹ï¼š https://github.com/alibaba/canal/wiki/BinlogChange%28MariaDB5%2610%29 
82,Canalä¼šå¯¼è‡´ZooKeeperçš„ç£ç›˜IOè´Ÿè½½è¿‡é«˜ã€‚ åœ¨æµ‹è¯•ä¸­æˆ‘ä»¬å‘ç°Canalä¼šå¯¼è‡´ZooKeeperçš„IOè´Ÿè½½æé«˜ï¼Œiotopä¸‹å¯ä»¥çœ‹åˆ°ZooKeeperæŒç»­ä»¥400KB/sçš„é€Ÿåº¦å‘ç£ç›˜å†™å…¥äº‹åŠ¡æ•°æ®ï¼Œå› æ­¤ç£ç›˜IOè´Ÿè½½å±…é«˜ä¸ä¸‹ã€‚æˆ‘ä»¬ç›®å‰å¹¶æ²¡æœ‰æä¾›ç‹¬ç«‹çš„æœåŠ¡å™¨æ¥è¿è¡ŒZooKeeperï¼Œå› æ­¤æˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿé€šè¿‡é™ä½ZooKeeperçš„write/updateå‹åŠ›ï¼Œä»è€Œå‡å°‘å®ƒçš„ç£ç›˜IOå ç”¨ç‡ã€‚ æŒ‰æˆ‘çš„ç†è§£ï¼ŒCanalåº”è¯¥æ˜¯æ¯æ¬¡å®¢æˆ·ç«¯ACKæ—¶éƒ½ä¼šå°†æœ€æ–°çš„binlogåç§»é‡æ›´æ–°å…¥ZooKeeperï¼Œè¿™å°±å¯¼è‡´ZooKeeperçš„äº‹åŠ¡å¾ˆå¤šï¼Œç£ç›˜IOå ç”¨ç‡å¾ˆå¤§ã€‚ æˆ‘ä¿®æ”¹äº†canal.propertiesä¸­çš„canal.zookeeper.flush.periodé…ç½®ä¸º5000  å¸Œæœ›Canalèƒ½æ¯5ç§’é’Ÿæ›´æ–°ä¸€æ¬¡ZooKeeperã€‚ä½†æ˜¯é…ç½®ä¹‹åï¼Œå‘ç°å®ƒæ ¹æœ¬ä¸èµ·ä½œç”¨ï¼ŒZooKeeperçš„å†™å‹åŠ›ä»ç„¶å·¨å¤§ã€‚ ä¹‹åæˆ‘ç›‘è§†ZooKeeperçš„æ—¥å¿—å‘ç°ï¼Œç»å¤§éƒ¨åˆ†çš„å†™æ“ä½œå¹¶éæ¥è‡ªCanalæœåŠ¡å™¨ï¼Œè€Œæ˜¯æ¥è‡ªäºCanalå®¢æˆ·ç«¯ã€‚ ä¸ºä»€ä¹ˆCanalå®¢æˆ·ç«¯ä¼šç›´æ¥é«˜é¢‘ç‡åœ°å‘ZooKeeperæœåŠ¡å™¨å†™å…¥binlogåç§»é‡ï¼Ÿ binlogåç§»é‡çš„æ›´æ–°æˆ–å†™å…¥ä¸æ˜¯åº”è¯¥ç”±CanalæœåŠ¡å™¨ç»Ÿä¸€è°ƒåº¦å—ï¼Ÿ ZooKeeperæ‰€åœ¨æœåŠ¡å™¨ç£ç›˜IOè´Ÿè½½æƒ…å†µï¼š > # iostat -xdm 1 >  > Device:         rrqm/s   wrqm/s   r/s   w/s    rMB/s    wMB/s avgrq-sz avgqu-sz   await  svctm  %util > sda             228.00     2.00 442.00 15.00    39.32     0.06   176.47    11.21   24.79   2.19 100.00 > sda1            228.00     2.00 442.00 15.00    39.32     0.06   176.47    11.21   24.79   2.19 100.00 > sda2              0.00     0.00  0.00  0.00     0.00     0.00     0.00     0.00    0.00   0.00   0.00 ZooKeeperçš„ç£ç›˜IOå ç”¨æƒ…å†µï¼š > # iotop -p 10411(zookeeperçš„pid) >  > 10411 be/4 datacent    0.00 B/s  475.99 K/s 52.38 % 48.88 % java -Dzook...oo.cfg æ‰¾åˆ°é—®é¢˜æ‰€åœ¨äº†ï¼Œä¸æ˜¯Canalçš„é—®é¢˜ã€‚ Canalå®¢æˆ·ç«¯åŒæ—¶ä¹Ÿå‘hbaseå†™å…¥æ•°æ®ï¼Œå¯¼è‡´zookeeper IOè¿‡é«˜æ˜¯hbaseè€Œä¸æ˜¯canalã€‚ 
81,CanalæœåŠ¡å™¨é‡å¯åï¼ŒSlaveIDè¢«å¼ºåˆ¶æ›´æ–°ä¸º-1 è¿è¡Œç¯å¢ƒï¼š     Zookeeperé›†ç¾¤     å•CanalæœåŠ¡å™¨ï¼ˆæµ‹è¯•ï¼‰     å•Canalå®¢æˆ·ç«¯ï¼ˆæµ‹è¯•ï¼‰     2ä¸ªMySQLå®ä¾‹ï¼ˆä¸æ–­æœ‰æ–°binlogï¼‰ é—®é¢˜ï¼š     æŸæ¬¡Canalå…³é—­æ—¶stopæ“ä½œæ— å“åº”ï¼Œæ— å¥ˆä¹‹ä¸‹é‡‡ç”¨kill -9 pidå¼ºåˆ¶å…³é—­canalè¿›ç¨‹ã€‚ ``` ä¸‹æ¬¡å¯åŠ¨Canalæ—¶æŠ›å‡ºâ€œCanalèŠ‚ç‚¹å·²å­˜åœ¨â€å¼‚å¸¸ï¼Œä¹‹åå†æ¬¡é‡å¯Canalæ—¶å¼‚å¸¸è«åå…¶å¦™çš„æ¶ˆå¤±äº†ï¼Œåº”è¯¥æ˜¯å› ä¸ºZookeeperæ£€æµ‹åˆ°Canalç¦»çº¿ï¼Œè‡ªåŠ¨åˆ é™¤äº†ã€‚ ä¸€ç•ªå‘¨æŠ˜ä¹‹åï¼ŒæˆåŠŸå¯åŠ¨åçš„Canalä¸å†è¯»å–binlogï¼Œåè€Œæ‰“å°warnæ—¥å¿—ï¼šprepare to find start position just last positionï¼Œæ­¤æ—¶mysqlä¸­binlogæ˜¯æŒç»­å­˜åœ¨çš„ã€‚ æˆ‘æ‰‹åŠ¨æŸ¥çœ‹zookeeperä¸­å­˜å‚¨çš„canalæ•°æ®æ—¶å‘ç°ï¼š [zookeeper] get /otter/canal/destinations/{åç§°}/1001/cursor {"@type":"com.alibaba.otter.canal.protocol.position.LogPosition" "identity":{"slaveId":-1 "sourceAddress":{"address":"..." "port":3310}} "postion":{"included":false "journalName":"localhost-bin.000008" "position":689389260 "timestamp":1388062800000}} è¯·æ³¨æ„"slaveId":-1ï¼Œæˆ‘é‡‡ç”¨çš„æ˜¯Canalé»˜è®¤é…ç½®slaveId=1234  ç°åœ¨å˜ä¸º-1çœŸæ˜¯è«åå…¶å¦™ã€‚æˆ‘æ€€ç–‘æ˜¯Canalå‡ºç°å¼‚å¸¸åï¼Œè‡ªåŠ¨æ›´æ”¹ä¸º-1çš„ï¼Œäºæ˜¯æˆ‘æ‰‹åŠ¨å°†æ­¤salveIDä»-1é‡æ–°æ”¹ä¸º1234  ä½†æ˜¯ä¹‹åå†æ¬¡å¯åŠ¨Canalå‘ç°æ­¤slaveIDåˆè¢«å¼ºåˆ¶æ”¹å˜ä¸º-1. ç”±äºslaveidè¢«æ”¹å˜ä¸º-1  ä¹‹åcanalå°±æ— æ³•è¯»å–åˆ°binlogæ•°æ®ã€‚ ``` ä»¥ä¸‹æ˜¯canalå…¶ä¸­ä¸€ä¸ªmysqlå®ä¾‹çš„å¯åŠ¨æ—¥å¿—ï¼ˆå·²å¼€å¯debugçº§åˆ«ï¼‰ï¼Œå¸Œæœ›å¤§å®¶èƒ½å¸®æˆ‘è§£å†³è¿™ä¸ªé—®é¢˜ï¼š 2013-12-27 09:51:57.745 [canal-instance-scan-0] DEBUG o.s.beans.factory.xml.PluggableSchemaResolver - Found XML schema [http://www.springframework.org/schema/beans/spring-beans-2.0.xsd] in classpath: org/springframework/beans/factory/xml/spring-beans-2.0.xsd 2013-12-27 09:51:57.860 [canal-instance-scan-0] DEBUG o.s.b.factory.xml.DefaultBeanDefinitionDocumentReader - Loading bean definitions 2013-12-27 09:51:57.898 [canal-instance-scan-0] DEBUG o.s.beans.factory.xml.BeanDefinitionParserDelegate - Neither XML 'id' nor 'name' specified - using generated bean name [com.alibaba.otter.canal.instance.spring.support.PropertyPlaceholderConfigurer#0] 2013-12-27 09:51:57.903 [canal-instance-scan-0] DEBUG o.s.beans.factory.xml.BeanDefinitionParserDelegate - Neither XML 'id' nor 'name' specified - using generated bean name [org.springframework.beans.factory.config.CustomEditorConfigurer#0] 2013-12-27 09:51:57.907 [canal-instance-scan-0] DEBUG o.s.beans.factory.xml.BeanDefinitionParserDelegate - Neither XML 'id' nor 'name' specified - using generated bean name [com.alibaba.otter.canal.meta.ZooKeeperMetaManager#291792b7] 2013-12-27 09:51:57.911 [canal-instance-scan-0] DEBUG o.s.beans.factory.xml.BeanDefinitionParserDelegate - Neither XML 'id' nor 'name' specified - using generated bean name [com.alibaba.otter.canal.parse.ha.HeartBeatHAController#4aa14174] 2013-12-27 09:51:57.913 [canal-instance-scan-0] DEBUG o.s.beans.factory.xml.BeanDefinitionParserDelegate - Neither XML 'id' nor 'name' specified - using generated bean name [com.alibaba.otter.canal.filter.aviater.AviaterRegexFilter#55d580a8] 2013-12-27 09:51:57.915 [canal-instance-scan-0] DEBUG o.s.beans.factory.xml.BeanDefinitionParserDelegate - Neither XML 'id' nor 'name' specified - using generated bean name [com.alibaba.otter.canal.parse.index.MemoryLogPositionManager#33f1c19e] 2013-12-27 09:51:57.915 [canal-instance-scan-0] DEBUG o.s.beans.factory.xml.BeanDefinitionParserDelegate - Neither XML 'id' nor 'name' specified - using generated bean name [com.alibaba.otter.canal.parse.index.MetaLogPositionManager#44de86b6] 2013-12-27 09:51:57.915 [canal-instance-scan-0] DEBUG o.s.beans.factory.xml.BeanDefinitionParserDelegate - Neither XML 'id' nor 'name' specified - using generated bean name [com.alibaba.otter.canal.parse.index.FailbackLogPositionManager#6d5e3a0c] 2013-12-27 09:51:57.916 [canal-instance-scan-0] DEBUG o.s.beans.factory.xml.BeanDefinitionParserDelegate - Neither XML 'id' nor 'name' specified - using generated bean name [com.alibaba.otter.canal.parse.support.AuthenticationInfo#453521ec] 2013-12-27 09:51:57.917 [canal-instance-scan-0] DEBUG o.s.beans.factory.xml.BeanDefinitionParserDelegate - Neither XML 'id' nor 'name' specified - using generated bean name [com.alibaba.otter.canal.parse.support.AuthenticationInfo#23463073] 2013-12-27 09:51:57.918 [canal-instance-scan-0] DEBUG o.s.beans.factory.xml.BeanDefinitionParserDelegate - Neither XML 'id' nor 'name' specified - using generated bean name [com.alibaba.otter.canal.protocol.position.EntryPosition#5516e01c] 2013-12-27 09:51:57.919 [canal-instance-scan-0] DEBUG o.s.beans.factory.xml.BeanDefinitionParserDelegate - Neither XML 'id' nor 'name' specified - using generated bean name [com.alibaba.otter.canal.protocol.position.EntryPosition#50d379e8] 2013-12-27 09:51:57.920 [canal-instance-scan-0] DEBUG o.s.beans.factory.xml.XmlBeanDefinitionReader - Loaded 10 bean definitions from location pattern [classpath:spring/default-instance.xml] 2013-12-27 09:51:57.920 [canal-instance-scan-0] INFO  o.s.context.support.ClassPathXmlApplicationContext - Bean factory for application context [org.springframework.context.support.ClassPathXmlApplicationContext@344d638a]: org.springframework.beans.factory.support.DefaultListableBeanFactory@6be897cc 2013-12-27 09:51:57.920 [canal-instance-scan-0] DEBUG o.s.context.support.ClassPathXmlApplicationContext - 10 beans defined in org.springframework.context.support.ClassPathXmlApplicationContext@344d638a: display name [org.springframework.context.support.ClassPathXmlApplicationContext@344d638a]; startup date [Fri Dec 27 09:51:57 CST 2013]; root of context hierarchy 2013-12-27 09:51:57.980 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating shared instance of singleton bean 'com.alibaba.otter.canal.instance.spring.support.PropertyPlaceholderConfigurer#0' 2013-12-27 09:51:57.981 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating instance of bean 'com.alibaba.otter.canal.instance.spring.support.PropertyPlaceholderConfigurer#0' 2013-12-27 09:51:58.021 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Eagerly caching bean 'com.alibaba.otter.canal.instance.spring.support.PropertyPlaceholderConfigurer#0' to allow for resolving potential circular references 2013-12-27 09:51:58.066 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Invoking afterPropertiesSet() on bean with name 'com.alibaba.otter.canal.instance.spring.support.PropertyPlaceholderConfigurer#0' 2013-12-27 09:51:58.067 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Finished creating instance of bean 'com.alibaba.otter.canal.instance.spring.support.PropertyPlaceholderConfigurer#0' 2013-12-27 09:51:58.069 [canal-instance-scan-0] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [canal.properties] 2013-12-27 09:51:58.070 [canal-instance-scan-0] INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties file from class path resource [war_wist_ios_cn_h17_ww2/instance.properties] 2013-12-27 09:51:58.138 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating shared instance of singleton bean 'org.springframework.beans.factory.config.CustomEditorConfigurer#0' 2013-12-27 09:51:58.138 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating instance of bean 'org.springframework.beans.factory.config.CustomEditorConfigurer#0' 2013-12-27 09:51:58.139 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Eagerly caching bean 'org.springframework.beans.factory.config.CustomEditorConfigurer#0' to allow for resolving potential circular references 2013-12-27 09:51:58.143 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating shared instance of singleton bean 'socketAddressEditor' 2013-12-27 09:51:58.144 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating instance of bean 'socketAddressEditor' 2013-12-27 09:51:58.144 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Eagerly caching bean 'socketAddressEditor' to allow for resolving potential circular references 2013-12-27 09:51:58.157 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Finished creating instance of bean 'socketAddressEditor' 2013-12-27 09:51:58.169 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Finished creating instance of bean 'org.springframework.beans.factory.config.CustomEditorConfigurer#0' 2013-12-27 09:51:58.174 [canal-instance-scan-0] DEBUG o.s.context.support.ClassPathXmlApplicationContext - Unable to locate MessageSource with name 'messageSource': using default [org.springframework.context.support.DelegatingMessageSource@d170baf] 2013-12-27 09:51:58.177 [canal-instance-scan-0] DEBUG o.s.context.support.ClassPathXmlApplicationContext - Unable to locate ApplicationEventMulticaster with name 'applicationEventMulticaster': using default [org.springframework.context.event.SimpleApplicationEventMulticaster@5ee5c122] 2013-12-27 09:51:58.180 [canal-instance-scan-0] INFO  o.s.beans.factory.support.DefaultListableBeanFactory - Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@6be897cc: defining beans [com.alibaba.otter.canal.instance.spring.support.PropertyPlaceholderConfigurer#0 socketAddressEditor org.springframework.beans.factory.config.CustomEditorConfigurer#0 instance alarmHandler zkClientx metaManager eventStore eventSink eventParser]; root of factory hierarchy 2013-12-27 09:51:58.180 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'com.alibaba.otter.canal.instance.spring.support.PropertyPlaceholderConfigurer#0' 2013-12-27 09:51:58.180 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'socketAddressEditor' 2013-12-27 09:51:58.180 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'org.springframework.beans.factory.config.CustomEditorConfigurer#0' 2013-12-27 09:51:58.180 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating shared instance of singleton bean 'instance' 2013-12-27 09:51:58.181 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating instance of bean 'instance' 2013-12-27 09:51:58.183 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Eagerly caching bean 'instance' to allow for resolving potential circular references 2013-12-27 09:51:58.215 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating shared instance of singleton bean 'eventParser' 2013-12-27 09:51:58.215 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating instance of bean 'eventParser' 2013-12-27 09:51:58.225 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Eagerly caching bean 'eventParser' to allow for resolving potential circular references 2013-12-27 09:51:58.246 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating shared instance of singleton bean 'eventSink' 2013-12-27 09:51:58.246 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating instance of bean 'eventSink' 2013-12-27 09:51:58.249 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Eagerly caching bean 'eventSink' to allow for resolving potential circular references 2013-12-27 09:51:58.260 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating shared instance of singleton bean 'eventStore' 2013-12-27 09:51:58.260 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating instance of bean 'eventStore' 2013-12-27 09:51:58.264 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Eagerly caching bean 'eventStore' to allow for resolving potential circular references 2013-12-27 09:51:58.283 [canal-instance-scan-0] DEBUG org.springframework.beans.BeanUtils - No property editor [com.alibaba.otter.canal.store.model.BatchModeEditor] found for type com.alibaba.otter.canal.store.model.BatchMode according to 'Editor' suffix convention 2013-12-27 09:51:58.285 [canal-instance-scan-0] WARN  org.springframework.beans.TypeConverterDelegate - PropertyEditor [com.sun.beans.editors.EnumEditor] found through deprecated global PropertyEditorManager fallback - consider using a more isolated form of registration  e.g. on the BeanWrapper/BeanFactory! 2013-12-27 09:51:58.286 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Finished creating instance of bean 'eventStore' 2013-12-27 09:51:58.286 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Finished creating instance of bean 'eventSink' 2013-12-27 09:51:58.287 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Added autowiring by name from bean name 'eventParser' via property 'eventSink' to bean named 'eventSink' 2013-12-27 09:51:58.288 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating instance of bean 'com.alibaba.otter.canal.parse.ha.HeartBeatHAController#4aa14174' 2013-12-27 09:51:58.296 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Finished creating instance of bean 'com.alibaba.otter.canal.parse.ha.HeartBeatHAController#4aa14174' 2013-12-27 09:51:58.296 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating shared instance of singleton bean 'alarmHandler' 2013-12-27 09:51:58.297 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating instance of bean 'alarmHandler' 2013-12-27 09:51:58.297 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Eagerly caching bean 'alarmHandler' to allow for resolving potential circular references 2013-12-27 09:51:58.302 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Finished creating instance of bean 'alarmHandler' 2013-12-27 09:51:58.303 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating instance of bean 'com.alibaba.otter.canal.filter.aviater.AviaterRegexFilter#55d580a8' 2013-12-27 09:51:58.466 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Finished creating instance of bean 'com.alibaba.otter.canal.filter.aviater.AviaterRegexFilter#55d580a8' 2013-12-27 09:51:58.467 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating instance of bean 'com.alibaba.otter.canal.parse.index.FailbackLogPositionManager#6d5e3a0c' 2013-12-27 09:51:58.476 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating instance of bean 'com.alibaba.otter.canal.parse.index.MemoryLogPositionManager#33f1c19e' 2013-12-27 09:51:58.483 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Finished creating instance of bean 'com.alibaba.otter.canal.parse.index.MemoryLogPositionManager#33f1c19e' 2013-12-27 09:51:58.484 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating instance of bean 'com.alibaba.otter.canal.parse.index.MetaLogPositionManager#44de86b6' 2013-12-27 09:51:58.491 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating shared instance of singleton bean 'metaManager' 2013-12-27 09:51:58.491 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating instance of bean 'metaManager' 2013-12-27 09:51:58.493 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Eagerly caching bean 'metaManager' to allow for resolving potential circular references 2013-12-27 09:51:58.504 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating instance of bean 'com.alibaba.otter.canal.meta.ZooKeeperMetaManager#291792b7' 2013-12-27 09:51:58.511 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating shared instance of singleton bean 'zkClientx' 2013-12-27 09:51:58.511 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating instance of bean 'zkClientx' 2013-12-27 09:51:58.512 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Eagerly caching bean 'zkClientx' to allow for resolving potential circular references 2013-12-27 09:51:58.523 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Invoking afterPropertiesSet() on bean with name 'zkClientx' 2013-12-27 09:51:58.523 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Finished creating instance of bean 'zkClientx' 2013-12-27 09:51:58.525 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Finished creating instance of bean 'com.alibaba.otter.canal.meta.ZooKeeperMetaManager#291792b7' 2013-12-27 09:51:58.525 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Finished creating instance of bean 'metaManager' 2013-12-27 09:51:58.526 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Finished creating instance of bean 'com.alibaba.otter.canal.parse.index.MetaLogPositionManager#44de86b6' 2013-12-27 09:51:58.526 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Finished creating instance of bean 'com.alibaba.otter.canal.parse.index.FailbackLogPositionManager#6d5e3a0c' 2013-12-27 09:51:58.526 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating instance of bean 'com.alibaba.otter.canal.parse.support.AuthenticationInfo#453521ec' 2013-12-27 09:51:58.531 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Finished creating instance of bean 'com.alibaba.otter.canal.parse.support.AuthenticationInfo#453521ec' 2013-12-27 09:51:58.531 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating instance of bean 'com.alibaba.otter.canal.parse.support.AuthenticationInfo#23463073' 2013-12-27 09:51:58.532 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Finished creating instance of bean 'com.alibaba.otter.canal.parse.support.AuthenticationInfo#23463073' 2013-12-27 09:51:58.532 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating instance of bean 'com.alibaba.otter.canal.protocol.position.EntryPosition#5516e01c' 2013-12-27 09:51:58.541 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Finished creating instance of bean 'com.alibaba.otter.canal.protocol.position.EntryPosition#5516e01c' 2013-12-27 09:51:58.541 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Creating instance of bean 'com.alibaba.otter.canal.protocol.position.EntryPosition#50d379e8' 2013-12-27 09:51:58.542 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Finished creating instance of bean 'com.alibaba.otter.canal.protocol.position.EntryPosition#50d379e8' 2013-12-27 09:51:58.543 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Finished creating instance of bean 'eventParser' 2013-12-27 09:51:58.543 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'eventSink' 2013-12-27 09:51:58.543 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'eventStore' 2013-12-27 09:51:58.543 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'metaManager' 2013-12-27 09:51:58.544 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'alarmHandler' 2013-12-27 09:51:58.544 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Finished creating instance of bean 'instance' 2013-12-27 09:51:58.544 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'alarmHandler' 2013-12-27 09:51:58.544 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'zkClientx' 2013-12-27 09:51:58.545 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'metaManager' 2013-12-27 09:51:58.545 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'eventStore' 2013-12-27 09:51:58.545 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'eventSink' 2013-12-27 09:51:58.545 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'eventParser' 2013-12-27 09:51:58.546 [canal-instance-scan-0] DEBUG o.s.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'instance' 2013-12-27 09:51:58.546 [canal-instance-scan-0] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start CannalInstance for 1-war_wist_ios_cn_h17_ww2  2013-12-27 09:51:58.577 [destination = war_wist_ios_cn_h17_ww2   address = /118.26.235.88:3310   EventParser] INFO  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - start heart beat....  2013-12-27 09:51:58.578 [destination = war_wist_ios_cn_h17_ww2   address = /118.26.235.88:3310   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - connect MysqlConnection to /118.26.235.88:3310... 2013-12-27 09:51:58.596 [canal-instance-scan-0] INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start successful.... 2013-12-27 09:51:58.596 [canal-instance-scan-0] INFO  c.a.otter.canal.server.embeded.CanalServerWithEmbeded - start CanalInstances[war_wist_ios_cn_h17_ww2] successfully 2013-12-27 09:52:09.329 [destination = war_wist_ios_cn_h17_ww2   address = /118.26.235.88:3310   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - handshake initialization packet received  prepare the client authentication packet to send 2013-12-27 09:52:09.338 [destination = war_wist_ios_cn_h17_ww2   address = /118.26.235.88:3310   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - client authentication packet is sent out. 2013-12-27 09:52:09.355 [destination = war_wist_ios_cn_h17_ww2   address = /118.26.235.88:3310   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - connect MysqlConnection to /118.26.235.88:3310... 2013-12-27 09:52:19.509 [destination = war_wist_ios_cn_h17_ww2   address = /118.26.235.88:3310   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - handshake initialization packet received  prepare the client authentication packet to send 2013-12-27 09:52:19.510 [destination = war_wist_ios_cn_h17_ww2   address = /118.26.235.88:3310   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - client authentication packet is sent out. 2013-12-27 09:52:19.541 [destination = war_wist_ios_cn_h17_ww2   address = /118.26.235.88:3310   EventParser] WARN  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - prepare to find start position just last position 2013-12-27 09:52:19.580 [destination = war_wist_ios_cn_h17_ww2   address = /118.26.235.88:3310   EventParser] INFO  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - find start position : EntryPosition[included=false journalName=localhost-bin.000008 position=679706051 timestamp=1388060804000] 2013-12-27 09:52:19.580 [destination = war_wist_ios_cn_h17_ww2   address = /118.26.235.88:3310   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - disConnect MysqlConnection to /118.26.235.88:3310... 2013-12-27 09:52:19.580 [destination = war_wist_ios_cn_h17_ww2   address = /118.26.235.88:3310   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - connect MysqlConnection to /118.26.235.88:3310... 2013-12-27 09:52:29.239 [destination = war_wist_ios_cn_h17_ww2   address = /118.26.235.88:3310   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - handshake initialization packet received  prepare the client authentication packet to send 2013-12-27 09:52:29.240 [destination = war_wist_ios_cn_h17_ww2   address = /118.26.235.88:3310   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - client authentication packet is sent out. 2013-12-27 09:52:29.244 [destination = war_wist_ios_cn_h17_ww2   address = /118.26.235.88:3310   EventParser] DEBUG c.a.otter.canal.parse.driver.mysql.MysqlUpdateExecutor - read update result... 2013-12-27 09:52:29.748 [destination = war_wist_ios_cn_h17_ww2   address = /118.26.235.88:3310   EventParser] DEBUG c.a.otter.canal.parse.driver.mysql.MysqlUpdateExecutor - read update result... 2013-12-27 09:52:29.830 [destination = war_wist_ios_cn_h17_ww2   address = /118.26.235.88:3310   EventParser] DEBUG c.a.otter.canal.parse.driver.mysql.MysqlUpdateExecutor - read update result... 2013-12-27 09:52:29.831 [destination = war_wist_ios_cn_h17_ww2   address = /118.26.235.88:3310   EventParser] DEBUG c.a.otter.canal.parse.driver.mysql.MysqlUpdateExecutor - read update result... 2013-12-27 09:52:29.957 [destination = war_wist_ios_cn_h17_ww2   address = /118.26.235.88:3310   EventParser] DEBUG c.a.otter.canal.parse.driver.mysql.MysqlUpdateExecutor - read update result... 2013-12-27 09:52:30.053 [destination = war_wist_ios_cn_h17_ww2   address = /118.26.235.88:3310   EventParser] INFO  c.a.otter.canal.parse.inbound.mysql.MysqlConnection - COM_BINLOG_DUMP with position:BinlogDumpCommandPacket[binlogPosition=679706051 slaveServerId=1234 binlogFileName=localhost-bin.000008 command=18] 2013-12-27 09:52:30.346 [destination = war_wist_ios_cn_h17_ww2   address = /118.26.235.88:3310   EventParser] INFO  com.taobao.tddl.dbsync.binlog.LogEvent - common_header_len= 19  number_of_event_types= 27 2013-12-27 09:52:50.072 [New I/O server worker #1-2] INFO  c.a.otter.canal.server.embeded.CanalServerWithEmbeded - rollback successfully  clientId:1001 2013-12-27 09:52:50.073 [New I/O server worker #1-2] INFO  c.a.otter.canal.server.embeded.CanalServerWithEmbeded - subscribe successfully  use last cursor position:ClientIdentity[destination=war_wist_ios_cn_h17_ww2 clientId=1001 filter=._.._]  2013-12-27 09:52:50.115 [New I/O server worker #1-2] INFO  c.a.otter.canal.server.embeded.CanalServerWithEmbeded - rollback successfully  clientId:1001 2013-12-27 09:52:50.118 [New I/O server worker #1-2] INFO  c.a.otter.canal.server.embeded.CanalServerWithEmbeded - getWithoutAck successfully  clientId:1001 batchSize:1000  real size is 619 and result is [batchId:1   position:PositionRange[start=LogPosition[identity=LogIdentity[sourceAddress=/118.26.235.88:3310 slaveId=-1] postion=EntryPosition[included=false journalName=localhost-bin.000008 position=679706051 timestamp=1388060804000]] ack=LogPosition[identity=LogIdentity[sourceAddress=/118.26.235.88:3310 slaveId=-1] postion=EntryPosition[included=false journalName=localhost-bin.000008 position=689389260 timestamp=1388062800000]] end=LogPosition[identity=LogIdentity[sourceAddress=/118.26.235.88:3310 slaveId=-1] postion=EntryPosition[included=false journalName=localhost-bin.000008 position=689389260 timestamp=1388062800000]]]] 2013-12-27 09:52:50.240 [New I/O server worker #1-2] INFO  c.a.otter.canal.server.embeded.CanalServerWithEmbeded - ack successfully  clientId:1001 batchId:1 position:PositionRange[start=LogPosition[identity=LogIdentity[sourceAddress=/118.26.235.88:3310 slaveId=-1] postion=EntryPosition[included=false journalName=localhost-bin.000008 position=679706051 timestamp=1388060804000]] ack=LogPosition[identity=LogIdentity[sourceAddress=/118.26.235.88:3310 slaveId=-1] postion=EntryPosition[included=false journalName=localhost-bin.000008 position=689389260 timestamp=1388062800000]] end=LogPosition[identity=LogIdentity[sourceAddress=/118.26.235.88:3310 slaveId=-1] postion=EntryPosition[included=false journalName=localhost-bin.000008 position=689389260 timestamp=1388062800000]]] 2013-12-27 09:52:50.248 [New I/O server worker #1-2] DEBUG c.a.otter.canal.server.embeded.CanalServerWithEmbeded - getWithoutAck successfully  clientId:1001 batchSize:1000 but result is null 2013-12-27 09:52:51.291 [New I/O server worker #1-2] DEBUG c.a.otter.canal.server.embeded.CanalServerWithEmbeded - getWithoutAck successfully  clientId:1001 batchSize:1000 but result is null 2013-12-27 09:52:52.335 [New I/O server worker #1-2] DEBUG c.a.otter.canal.server.embeded.CanalServerWithEmbeded - getWithoutAck successfully  clientId:1001 batchSize:1000 but result is null 2013-12-27 09:52:53.380 [New I/O server worker #1-2] INFO  c.a.otter.canal.server.embeded.CanalServerWithEmbeded - getWithoutAck successfully  clientId:1001 batchSize:1000  real size is 327 and result is [batchId:2   position:PositionRange[start=LogPosition[identity=LogIdentity[sourceAddress=/118.26.235.88:3310 slaveId=-1] postion=EntryPosition[included=false journalName=localhost-bin.000008 position=696177601 timestamp=1388062803000]] ack=LogPosition[identity=LogIdentity[sourceAddress=/118.26.235.88:3310 slaveId=-1] postion=EntryPosition[included=false journalName=localhost-bin.000008 position=696612594 timestamp=1388062803000]] end=LogPosition[identity=LogIdentity[sourceAddress=/118.26.235.88:3310 slaveId=-1] postion=EntryPosition[included=false journalName=localhost-bin.000008 position=696612594 timestamp=1388062803000]]]] PSï¼šæˆ‘é‡‡ç”¨çš„Canalç‰ˆæœ¬ä¸º1.0.15ã€‚ è§£é‡Šå‡ ä¸ªé—®é¢˜ï¼š 1.  prepare to find start position just last position.    è¿™é‡Œæ˜¯æ­£å¸¸çš„ï¼Œå½“å‰å¯åŠ¨æ˜¯ä»ä¸Šä¸€æ¬¡çš„ä½ç‚¹ç»§ç»­ï¼Œè¿™é‡Œçš„last positionç†è§£ä¸ºæœ€åä¸€æ¬¡çš„æ¶ˆè´¹ä½ç‚¹ 2.  kill -9å¼ºåˆ¶å…³é—­åï¼ŒæŠ›å‡ºâ€œCanalèŠ‚ç‚¹å·²å­˜åœ¨â€å¼‚å¸¸åè‡ªåŠ¨åˆ é™¤ï¼Œè¿™ä¸ªç†è§£æ˜¯å¯¹çš„ï¼Œæ˜¯zookeeper serveræœ‰ä¸ªsessionTimeoutæ—¶é—´ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´åæ‰ä¼šè‡ªåŠ¨åˆ é™¤èŠ‚ç‚¹ï¼Œæ­£å¸¸é€€å‡ºæ—¶canalä¼šè‡ªå·±åˆ é™¤ï¼Œæ‰€ä»¥ä¸ä¼šæœ‰é—®é¢˜ 3.  slaveId = -1ï¼Œè¿™ä¸ªæ˜¯ç›®å‰å·²çŸ¥çš„ï¼Œä»£ç é‡Œæœ¬èº«å°±æ²¡æœ‰æŠŠæ­£ç¡®çš„slaveIdå†™åˆ°zookeeperä¸­ï¼Œæ¯æ¬¡éƒ½ä¼šä»canal.propertiesä¸­è¯»å–slaveIdï¼Œè¿™ä¸ªä¸å½±å“ éå¸¸æ„Ÿè°¢agappleçš„è§£é‡Šï½ æˆ‘æƒ³å€Ÿæ­¤æœºä¼šå†å’¨è¯¢ä¸€ä¸ªCanalå¯¼è‡´zookeeperçš„IOè´Ÿè½½è¿‡é«˜çš„é—®é¢˜ã€‚ åœ¨æµ‹è¯•ä¸­æˆ‘ä»¬å‘ç°Canalä¼šå¯¼è‡´ZooKeeperçš„IOè´Ÿè½½ç›¸å½“çš„é«˜ï¼Œiotopä¸‹å¯ä»¥çœ‹åˆ°ZooKeeperæŒç»­ä»¥400KB/sçš„é€Ÿåº¦å‘ç£ç›˜å†™å…¥äº‹åŠ¡æ•°æ®ï¼Œå¯¼è‡´ç£ç›˜IOè´Ÿè½½å±…é«˜ä¸ä¸‹ã€‚æˆ‘ä»¬ç›®å‰å¹¶æ²¡æœ‰æä¾›ç‹¬ç«‹çš„æœåŠ¡å™¨æ¥è¿è¡ŒZooKeeperï¼Œå› æ­¤æˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿé€šè¿‡é™ä½ZooKeeperçš„write/updateå‹åŠ›ï¼Œä»è€Œå‡å°‘å®ƒçš„ç£ç›˜IOå ç”¨ç‡ã€‚ æŒ‰æˆ‘çš„ç†è§£ï¼ŒCanalåº”è¯¥æ˜¯æ¯æ¬¡å®¢æˆ·ç«¯ACKæ—¶éƒ½ä¼šå°†æœ€æ–°çš„binlogåç§»é‡æ›´æ–°å…¥ZooKeeperï¼Œè¿™å°±å¯¼è‡´ZooKeeperçš„äº‹åŠ¡å¾ˆå¤šï¼Œç£ç›˜IOå ç”¨ç‡å¾ˆå¤§ã€‚ è¯·é—®æœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•è®©Canalæ¯éš”ä¸€æ®µæ—¶é—´å†æ›´æ–°ä¸€æ¬¡binlogåç§»é‡ï¼Œæˆ‘ä»¬å¸Œæœ›é€šè¿‡è¿™ç§åŠæ³•é™ä½ZooKeeperçš„å†™å‹åŠ›ã€‚é…ç½®ä¸­çš„canal.zookeeper.flush.periodå¥½åƒä¸èµ·ä½œç”¨ï¼Œå°†å®ƒé…ç½®ä¸º5000åï¼ŒZooKeeperçš„å†™å‹åŠ›ä»ç„¶å·¨å¤§ã€‚ @agapple å“ˆå–½ï¼Œéº»çƒ¦æ‚¨å¸®æˆ‘çœ‹çœ‹æ¥¼ä¸Šçš„é—®é¢˜å“ˆã€‚ å¿½ç•¥æ¥¼ä¸Šå§ï¼Œå¯¼è‡´ZooKeeperçš„IOè´Ÿè½½è¿‡é«˜ä¸æ˜¯Canalçš„é—®é¢˜ã€‚ 
80,ä¼˜åŒ–ä¸‹should start firstå¼‚å¸¸ æ¯”å¦‚å‡ºç°å¦‚ä¸‹å¼‚å¸¸ï¼š <pre>  failed to subscribe with reason: something goes wrong with channel:[id: 0x01039fc0  /192.168.22.153:15686 => /192.168.22.19:11111]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: destination:example should start first </pre> å¤§è‡´åŸå› ï¼šcanal serverå‘ç”Ÿä¸€æ¬¡åˆ‡æ¢ï¼Œæ¯”å¦‚åœ¨ä¸Šä¸€ä¸ªèŠ‚ç‚¹åˆšå¥½åœ¨æ‰§è¡ŒgetWithoutAck()ï¼Œåˆ‡åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹åï¼Œå¦‚æœç»§ç»­æ‰§è¡ŒgetWithoutAck()ï¼Œå› ä¸ºæœªè¿›è¡Œsubscribe()è°ƒç”¨ï¼Œä¼šå‡ºç°serveræœªåˆå§‹åŒ–ï¼Œè°ƒç”¨getWithoutAck()å°±ä¼šå‡ºç°should start first. ä¼˜åŒ–æ–¹å¼ï¼šç¼“å­˜ä¸Šä¸€æ¬¡çš„filteræ¡ä»¶ï¼Œåœ¨ä¸‹ä¸€æ¬¡è‡ªåŠ¨åˆ‡æ¢æ—¶ï¼Œé¡ºåºè°ƒç”¨disconnnect/connect/subscribe(filter)ï¼Œä¿è¯æ–°çš„canal serverå®Œæˆåˆå§‹åŒ–åï¼Œå†è°ƒç”¨getWithoutAck()è·å–æ•°æ® 
79,å¤šè¡¨ddlçš„sql tableNameè§£æå¤±è´¥ <pre> DROP /*!40005 TEMPORARY */ TABLE IF EXISTS `temp_bond_keys` `temp_bond_key_id`  RENAME TABLE A TO B   C TO D . </pre> ç›®å‰å·²çŸ¥çš„è¿™ä¸¤ç§ddlä¼šå­˜åœ¨å¤šè¡¨æ“ä½œï¼Œç›®å‰æš‚ä¸æ”¯æŒå¤šè¡¨è§£æ.   åç»­å®Œç¾è§£å†³ï¼šä½¿ç”¨ç±»ä¼¼druid/cobarçš„mysql sqlè¯­æ³•è§£æï¼Œæå–å¯¹åº”çš„è¡¨.  ddlä¸èƒ½æ­£å¸¸è§£æå‡ºè¡¨åï¼Œå­˜åœ¨çš„å½±å“ï¼š 1.  ddlä¸èƒ½æ­£å¸¸åŒæ­¥.  2.  ddlè¯­å¥ä¸ä¼šå‘é€ç»™canal clientï¼Œå› ä¸ºä¸æ»¡è¶³å¯¹åº”çš„è¿‡æ»¤æ¡ä»¶ï¼Œä½†ä¸ä¼šé˜»å¡æ•´ä¸ªè§£æ å…ˆä¸´æ—¶æ–¹æ¡ˆè§£å†³ï¼Œåç»­ç»Ÿä¸€ä¿®æ”¹ä¸ºSQLè§£æå™¨è¿›è¡Œä¼˜åŒ– 
78,default-instance.xmlæ¨¡å¼ä¸‹ï¼Œå®¢æˆ·ç«¯è®¢é˜…çš„filteræ¡ä»¶åœ¨canal serveråˆ‡æ¢åä¼šä¸¢å¤±filter  ZooKeeperMetaManagerçš„listAllSubscribeInfoæ–¹æ³•ä¸­åªè¯»å–äº†clientIdä¿¡æ¯ï¼Œå¹¶æ²¡æœ‰è¯»å–å¯¹åº”çš„filterï¼Œå¯¼è‡´canal clientæäº¤çš„ä¿¡æ¯åœ¨canal serverä¸‹ä¸€æ¬¡å¯åŠ¨æ—¶å¹¶æ²¡æœ‰è½½å…¥ï¼Œå¯¼è‡´åˆ‡æ¢åå®¢æˆ·ç«¯æäº¤çš„filterå¹¶æœªç”Ÿæ•ˆ.   ps . MemoryMetaManager/FileMetaManageræ¨¡å¼ä¸‹æ­£å¸¸.  <pre>   String path = ZookeeperPathUtils.getDestinationPath(destination);         List<String> childs = null;         try {             childs = zkClientx.getChildren(path);         } catch (ZkNoNodeException e) {             // ignore         }         if (CollectionUtils.isEmpty(childs)) {             return new ArrayList<ClientIdentity>();         }         List<Short> clientIds = new ArrayList<Short>();         for (String child : childs) {             if (StringUtils.isNumeric(child)) {                 clientIds.add(ZookeeperPathUtils.getClientId(child));             }         }         Collections.sort(clientIds); // è¿›è¡Œä¸€ä¸ªæ’åº         List<ClientIdentity> clientIdentities = Lists.newArrayList();         for (Short clientId : clientIds) {             clientIdentities.add(new ClientIdentity(destination  clientId));         }         return clientIdentities; } </pre> 
77,canal serverå®•æ‰åï¼Œcanal clientæœ‰å¯èƒ½åˆ‡ä¸åˆ°å¤‡ç”¨serverä¸Š canal server é€šè¿‡ZKåšé›†ç¾¤ï¼Œå½“ä¸€ä¸ªserverå®•æ‰åï¼Œå¦‚æœZKä¸Šä¸´æ—¶èŠ‚ç‚¹æ²¡æœ‰æ¶ˆå¤±ï¼Œåˆ™canal clientæœ‰å¯èƒ½ä¼šä¸€ç›´é˜»å¡ã€‚ Caused by: java.net.ConnectException: Connection refused: connect     at sun.nio.ch.Net.connect(Native Method) ~[na:1.6.0_45]     at sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:532) ~[na:1.6.0_45]     at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.doConnect(SimpleCanalConnector.java:117) [canal.client-1.0.9.jar:na]     ... 14 common frames omitted [2013-12-13 21:40:47  INFO com.alibaba.otter.canal.client.impl.ClusterCanalConnector:167] [shared-pool-thread-1] restart the connector for next round retry. ä¸å†æ‹¦æˆªå¼‚å¸¸ï¼Œconnectå¤±è´¥åä¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œå¦‚æœæ˜¯clusteræ¨¡å¼ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨restartå°±å¯ä»¥å¾—åˆ°é‡è¯•ã€‚å¦‚æœæ˜¯simpleæ¨¡å¼ï¼Œéœ€è¦æ‰‹å·¥è°ƒç”¨disconnectåè¿›è¡Œconnect.  server runningçš„ä¹Ÿå­˜åœ¨è¿™ä¸ªé£é™©ï¼Œåªä¸è¿‡å› ä¸ºæ²¡æœ‰å¤–éƒ¨ä¾èµ–ï¼Œå‡ºç°å¼‚å¸¸çš„å¯èƒ½æ€§å°ï¼Œå”¯ä¸€å‡ºé”™çš„å°±æ˜¯å’Œzkä¹‹é—´çš„ç½‘ç»œé“¾æ¥ï¼Œæ‰€ä»¥ä¸€æ—¦ä¸´æ—¶èŠ‚ç‚¹åˆ›å»ºåï¼ŒåŸºæœ¬éƒ½æ˜¯æœ¬åœ°ç±»åˆå§‹åŒ–çš„åŠ¨ä½œï¼ŒåŸºæœ¬ä¸ä¼šå‡ºé”™.  
76,canalå¿ƒè·³æ£€æŸ¥å‡ºç°ArrayIndexOutOfBoundsException <pre> Exception in thread "destination = transfer1   address = /192.168.237.26:3306   MysqlHeartBeatTimeTask" java.lang.ArrayIndexOutOfBoundsException: 1 at com.alibaba.otter.canal.parse.driver.mysql.utils.ByteHelper.readBinaryCodedLengthBytes(ByteHelper.java:83) at com.alibaba.otter.canal.parse.driver.mysql.packets.server.OKPacket.fromBytes(OKPacket.java:44) at com.alibaba.otter.canal.parse.driver.mysql.MysqlUpdateExecutor.update(MysqlUpdateExecutor.java:53) at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.update(MysqlConnection.java:73) at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser$MysqlHeartBeatTimeTask.run(MysqlEventParser.java:208) at java.util.TimerThread.mainLoop(Timer.java:512) at java.util.TimerThread.run(Timer.java:462) </pre> å¯¹åº”çš„å¿ƒè·³æ£€æŸ¥sqlä¸º; show master status; ä¸»è¦åŸå› ä¸ºï¼šmysqlçš„åè®®åŒºåˆ†ä¸ºquery/updateä¸¤ç±»ï¼Œå¯¹åº”çš„æ•°æ®åŒ…è§£æä¸ä¸€æ ·ï¼Œè¿™ä¸ªé—®é¢˜å°±æ˜¯é”™è¯¯çš„å°†show master statusä½¿ç”¨äº†updateåè®®è¿›è¡Œè§£æï¼Œå¯¼è‡´å‡ºé”™ï¼Œä½¿ç”¨queryåè®®å³å¯ 
75,heartbeatå¿ƒè·³æ£€æŸ¥ç¨‹åºå‡ºç°Timer already cancelled. <pre> 2013-11-26 15:33:28.895 [destination = inter_ttsdb1   address = /192.168.24.130:3306   EventParser] WARN  c.a.o.canal.parse.inbound.mysql.dbsync.DirectLogFetcher - Received EOF packet from server  apparent master disconnected. 2013-11-26 15:33:28.895 [destination = inter_ttsdb1   address = /192.168.24.130:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - disConnect MysqlConnection to /192.168.24.130:3306... 2013-11-26 15:33:28.896 [destination = inter_ttsdb1   address = /192.168.24.130:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - disConnect MysqlConnection to /192.168.24.130:3306... 2013-11-26 15:33:42.819 [destination = inter_ttsdb1   address = /192.168.24.130:3306   EventParser] INFO  c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - start heart beat....  2013-11-26 15:33:42.825 [destination = inter_ttsdb1   address = /192.168.24.130:3306   EventParser] ERROR c.a.otter.canal.parse.inbound.mysql.MysqlEventParser - dump address /192.168.24.130:3306 has an error  retrying. caused by  java.lang.IllegalStateException: Timer already cancelled.     at java.util.Timer.sched(Timer.java:354) ~[na:1.6.0_20]     at java.util.Timer.schedule(Timer.java:222) ~[na:1.6.0_20]     at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.startHeartbeat(MysqlEventParser.java:153) ~[canal.parse-1.0.7.jar:na]     at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:83) ~[canal.parse-1.0.7.jar:na]     at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:143) ~[canal.parse-1.0.7.jar:na]     at java.lang.Thread.run(Thread.java:619) [na:1.6.0_20] 2013-11-26 15:33:42.826 [destination = inter_ttsdb1   address = /192.168.24.130:3306   EventParser] ERROR com.alibaba.otter.canal.common.alarm.LogAlarmHandler - destination:inter_ttsdb1[java.lang.IllegalStateException: Timer already cancelled.     at java.util.Timer.sched(Timer.java:354)     at java.util.Timer.schedule(Timer.java:222)     at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.startHeartbeat(MysqlEventParser.java:153)     at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:83)     at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:143)     at java.lang.Thread.run(Thread.java:619) ] 2013-11-26 15:33:42.826 [destination = inter_ttsdb1   address = /192.168.24.130:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - the channel /192.168.24.130:3306 is not connected 2013-11-26 15:33:42.826 [destination = inter_ttsdb1   address = /192.168.24.130:3306   EventParser] INFO  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - the channel /192.168.24.130:3306 is not connected </pre> å¼‚å¸¸é—®é¢˜åˆ†æï¼š 1.  é¦–å…ˆæ˜¯å‡ºç°mysqlå¼‚å¸¸å…³é—­ï¼Œå¯¼è‡´binlog dumpå’Œmetaçš„mysqlé“¾æ¥éƒ½å‡ºç°æ–­å¼€ 2.  MysqlHeartBeatTimeTaskåœ¨ä¸‹ä¸€æ¬¡timerè°ƒåº¦ä¸­ï¼Œä¼šå‡ºç°å¼‚å¸¸ï¼Œç›®å‰try...catchçš„å¼‚å¸¸åªåŒ…å«äº†SocketTimeoutException/IOExceptionï¼Œå¦‚æœå‡ºç°å…¶ä»–ï¼Œæ¯”å¦‚RuntimeExceptionï¼Œå°±ä¼šå¯¼è‡´Timeré€€å‡ºï¼Œå¹¶è®¾ç½®ä¸ºcancelçŠ¶æ€ï¼Œè§¦å‘æœ¬issueçš„bug.  
74,mysql create tableè¯­å¥è§£æé”™è¯¯ <pre> public static final String TABLE_PATTERN        = "^(IF\\s*NOT\\s*EXIST\\s*)?(IF\\s*EXIST\\s*)?(`?.+?`?[;\\(\\s]+?)?.*$"; // é‡‡ç”¨éè´ªå©ªæ¨¡å¼ </pre> åœ¨mysqlè¯­æ³•é‡Œæ­£ç¡®ä¸ºEXISTS 
73,EntryProtocolå¢åŠ mysql typeç±»å‹ï¼Œç”¨äºå®¢æˆ·è‡ªå®šä¹‰å¤„ç† <pre> /**æ¯ä¸ªå­—æ®µçš„æ•°æ®ç»“æ„**/ message Column {     /**å­—æ®µä¸‹æ ‡**/     optional int32      index           =       1;          /**å­—æ®µjavaä¸­ç±»å‹**/     optional int32      sqlType         =       2;          /**å­—æ®µåç§°(å¿½ç•¥å¤§å°å†™)ï¼Œåœ¨mysqlä¸­æ˜¯æ²¡æœ‰çš„**/     optional string     name            =       3;          /**æ˜¯å¦æ˜¯ä¸»é”®**/     optional bool       isKey           =       4;          /**å¦‚æœEventType=UPDATE ç”¨äºæ ‡è¯†è¿™ä¸ªå­—æ®µå€¼æ˜¯å¦æœ‰ä¿®æ”¹**/     optional bool       updated         =       5;          /** æ ‡è¯†æ˜¯å¦ä¸ºç©º  **/     optional bool       isNull          =       6 [default = false];          /**é¢„ç•™æ‰©å±•**/     repeated Pair       props           =       7;            /** å­—æ®µå€¼ timestamp Datetimeæ˜¯ä¸€ä¸ªæ—¶é—´æ ¼å¼çš„æ–‡æœ¬ **/     optional string     value           =       8;          /** å¯¹åº”æ•°æ®å¯¹è±¡åŸå§‹é•¿åº¦ **/     optional int32      length          =       9;          /**å­—æ®µmysqlç±»å‹**/     optional string     mysqlType       =       10; } </pre> å­—æ®µä¿¡æ¯ï¼šåŒ…å«sqlTypeå’ŒmysqlType sqlTypeæ˜¯ç»è¿‡canalè½¬æ¢å¤„ç†çš„ï¼Œæ¯”å¦‚unsigned intä¼šè¢«è½¬åŒ–ä¸ºLongï¼Œunsigned longä¼šè¢«è½¬æ¢ä¸ºBigDecimal. mysqlTypeæ˜¯åŸå§‹mysqlä¸­çš„å­—æ®µæ–‡æœ¬æè¿°ï¼Œå¯ä»¥é€šè¿‡desc xxxæ¥è·å–  è¾“å‡ºç»“æœï¼š <pre> ID : 38    type=int(10) unsigned ADDRESS : hello    type=varchar(32) EVENT_DATA : 2013-11-12 11:43:06    type=datetime    update=true CHAR_VALUES :     type=char(1) NUMBER_VALUES :     type=decimal(19 8) FIOAT_VALUES :     type=float(19 8) DOUBLE_VALUES :     type=double(19 8) TINYINT_VALUES : -128    type=tinyint(3) TINYINT_UN_VALUES : 255    type=tinyint(3) unsigned SMALLINT_VALUES : 30000    type=smallint(5) SMALLINT_UN_VALUES : 65535    type=smallint(5) unsigned MEDIUMINT_VALUES : 8077215    type=mediumint(7) MEDIUMINT_UN_VALUES : 16777215    type=mediumint(7) unsigned INT_VALUES : 2094967296    type=int(10) INT_UN_VALUES : 4294967295    type=int(10) unsigned BIGINT_VALUES : 9223372036854775807    type=bigint(19) BIGINT_UN_VALUES : 9223372036854775808    type=bigint(19) unsigned DATETIME_VALUES : 0000-00-00 00:00:00    type=datetime TIMESTAMP_VALUES : 0000-00-00 00:00:00    type=timestamp DATE_VALUES : 0000-00-00    type=date TIME_VALUES : 00:00:00    type=time YEAR4_VALUES : 0000    type=year(4) YEAR2_VALUES : 0000    type=year(4) BLOB_VALUE : hello    type=blob TINY_BLOB_VALUE :     type=tinyblob MEDIA_BLOB_VALUE :     type=mediumblob LONG_BLOB_VALUE :     type=longblob TEXT_VALUE : Ã¤Â¸Â­Ã¦â€“â€¡1    type=text TINY_TEXT_VALUE :     type=tinytext MEDIA_TEXT_VALUE :     type=mediumtext LONG_TEXT_VALUE :     type=longtext </pre> 
72,mysql5.6æ—¥æœŸå­—æ®µæ— æ³•åŒæ­¥ ç‰ˆæœ¬ï¼šotter-4.2.3 osï¼šCentOS release 6.3 mysqlï¼š5.6.10-log MySQL Community Server å­—æ®µç±»å‹ï¼š  create_time         | datetime     | YES  |     | NULL    |       | update_time         | datetime     | YES  |     | NULL    |       | é…ç½®äº†ä¸€ä¸ªå•å‘åŒæ­¥channelï¼Œæºè¡¨é‡Œæœ‰create_timeã€update_timeå­—æ®µï¼Œå¯åŠ¨channelåŒæ­¥å°±ä¼šå‡ºç°æŒ‚èµ·ï¼ŒæŸ¥çœ‹æ—¥å¿—å‘ç°æŠ¥é”™ï¼Œæç¤ºæ—¶é—´æ ¼å¼ä¸å¯¹ï¼Œç›¸åº”çš„é”™è¯¯æ—¥å¿—å¦‚ä¸‹ï¼š pid:3 nid:1 exception:setl:com.alibaba.otter.node.etl.load.exception.LoadException: java.util.concurrent.ExecutionException: com.alibaba.otter.node.etl.load.exception.LoadException: com.alibaba.otter.node.etl.load.exception.LoadException: com.alibaba.otter.node.etl.load.exception.LoadException: org.springframework.dao.DataIntegrityViolationException: PreparedStatementCallback; SQL [update tb set  `create_time` = ?   `update_time` = ?  where ]; Data truncation: Incorrect datetime value: '1383277380000' for column 'create_time' at row 1; nested exception is com.mysql.jdbc.MysqlDataTruncation: Data truncation: Incorrect datetime value: '1383277380000' for column 'create_time' at row 1     at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:101)     at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:72)     at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:80)     at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:80)     at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:603)     at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:812)     at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:868)     at com.alibaba.otter.node.etl.load.loader.db.DbLoadAction$DbLoadWorker$2.doInTransaction(DbLoadAction.java:607)     at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:130)     at com.alibaba.otter.node.etl.load.loader.db.DbLoadAction$DbLoadWorker.doCall(DbLoadAction.java:599)     at com.alibaba.otter.node.etl.load.loader.db.DbLoadAction$DbLoadWorker.call(DbLoadAction.java:527)     at com.alibaba.otter.node.etl.load.loader.db.DbLoadAction.doTwoPhase(DbLoadAction.java:449)     at com.alibaba.otter.node.etl.load.loader.db.DbLoadAction.doLoad(DbLoadAction.java:274)     at com.alibaba.otter.node.etl.load.loader.db.DbLoadAction.load(DbLoadAction.java:160)     at com.alibaba.otter.node.etl.load.loader.db.DbLoadAction$$FastClassByCGLIB$$d932a4cb.invoke()     at net.sf.cglib.proxy.MethodProxy.invoke(MethodProxy.java:191)     at org.springframework.aop.framework.Cglib2AopProxy$DynamicAdvisedInterceptor.intercept(Cglib2AopProxy.java:618)     at com.alibaba.otter.node.etl.load.loader.db.DbLoadAction$$EnhancerByCGLIB$$80fd23c2.load()     at com.alibaba.otter.node.etl.load.loader.db.DataBatchLoader$2.call(DataBatchLoader.java:198)     at com.alibaba.otter.node.etl.load.loader.db.DataBatchLoader$2.call(DataBatchLoader.java:189)     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)     at java.util.concurrent.FutureTask.run(FutureTask.java:166)     at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)     at java.util.concurrent.FutureTask.run(FutureTask.java:166)     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)     at java.lang.Thread.run(Thread.java:724) Caused by: com.mysql.jdbc.MysqlDataTruncation: Data truncation: Incorrect datetime value: '1383277380000' for column 'create_time' at row 1     at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3560)     at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3494)     at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1960)     at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2114)     at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2696)     at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2105)     at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2398)     at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2316)     at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2301)     at org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)     at org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)     at org.springframework.jdbc.core.JdbcTemplate$2.doInPreparedStatement(JdbcTemplate.java:818)     at org.springframework.jdbc.core.JdbcTemplate$2.doInPreparedStatement(JdbcTemplate.java:1)     at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:587)     ... 23 more :----------------- - PairId: 5   TableId: 1   EventType : U   Time : 1383277861000  ## \- Consistency : M   Mode :  ---Pks     EventColumn[index=0 columnType=12 columnName=sub_serial columnValue=426931043 isNull=false isKey=true isUpdate=true] ---oldPks ---Columns     EventColumn[index=7 columnType=93 columnName=create_time columnValue=1383277380000 isNull=false isKey=false isUpdate=true]    ä¸­é—´çœç•¥ EventColumn[index=8 columnType=93 columnName=update_time columnValue=1383277864000 isNull=false isKey=false isUpdate=true]     EventColumn[index=9 columnType=4 columnName=status columnValue=1 isNull=false isKey=false isUpdate=true] æˆ‘æŠŠåŒæ­¥è¡¨ä¸­çš„æ—¶é—´ç›¸å…³çš„å­—æ®µå»æ‰å†å¼€å¯åŒæ­¥ï¼Œè¯¥é—®é¢˜ä¸ä¼šå‡ºç°ã€‚ å‚è§ otter issue : https://github.com/alibaba/otter/issues/30 
71,å¢åŠ filterQueryDdlåŠŸèƒ½ ä¹‹å‰æ”¯æŒfilterQueryDcl filterQueryDmlï¼Œéƒ¨åˆ†ç”¨æˆ·æœŸæœ›åªå…³ä¹å¯¹åº”çš„rowæ•°æ®ï¼Œè¿™é‡Œä¹ŸåŠ ä¸ŠfilterQueryDdlæ§åˆ¶ï¼Œå…è®¸å¿½ç•¥ddläº‹ä»¶.  
70,mysql bitç±»å‹æ”¯æŒ æµ‹è¯•çš„è¡¨ï¼š <pre> CREATE TABLE `test_bit_all` (   id int(10) unsigned NOT NULL AUTO_INCREMENT   bit1 bit(1)   bit2 bit(9)   bit3 bit(17)   bit4 bit(25)   bit5 bit(33)   bit6 bit(41)   bit7 bit(49)   bit8 bit(57)   bit9 bit(64)   PRIMARY KEY (`id`)   )  ENGINE=InnoDB DEFAULT CHARSET=gbk; </pre> æ„é€ æ•°æ®ï¼š insert into test_bit_all(id bit1 bit2 bit3 bit4 bit5 bit6 bit7 bit8 bit9) values(null 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615) ; è¾“å‡ºç»“æœï¼š EventColumn[index=1 columnType=-7 columnName=bit1 columnValue=1 isNull=false isKey=false isUpdate=true] EventColumn[index=2 columnType=-7 columnName=bit2 columnValue=511 isNull=false isKey=false isUpdate=true] EventColumn[index=3 columnType=-7 columnName=bit3 columnValue=131071 isNull=false isKey=false isUpdate=true] EventColumn[index=4 columnType=-7 columnName=bit4 columnValue=33554431 isNull=false isKey=false isUpdate=true] EventColumn[index=5 columnType=-7 columnName=bit5 columnValue=8589934591 isNull=false isKey=false isUpdate=true] EventColumn[index=6 columnType=-7 columnName=bit6 columnValue=2199023255551 isNull=false isKey=false isUpdate=true] EventColumn[index=7 columnType=-7 columnName=bit7 columnValue=562949953421311 isNull=false isKey=false isUpdate=true] EventColumn[index=8 columnType=-7 columnName=bit8 columnValue=144115188075855871 isNull=false isKey=false isUpdate=true] EventColumn[index=9 columnType=-7 columnName=bit9 columnValue=18446744073709551615 isNull=false isKey=false isUpdate=true] 
69,mysqlç™»å½•å¤±è´¥ <pre> Caused by: java.io.IOException: connect /192.168.1.206:3306 failure:java.lang.ArrayIndexOutOfBoundsException: 1         at com.alibaba.otter.canal.parse.driver.mysql.utils.ByteHelper.readUnsignedShortLittleEndian(ByteHelper.java:56)         at com.alibaba.otter.canal.parse.driver.mysql.packets.server.ErrorPacket.fromBytes(ErrorPacket.java:35)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.negotiate(MysqlConnector.java:170)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:66)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:51)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:92)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:143)         at java.lang.Thread.run(Thread.java:662)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:69)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:51)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser.preDump(MysqlEventParser.java:92)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:143)         at java.lang.Thread.run(Thread.java:662) </pre> mysql version :  5.5.30-log mysqlç¯å¢ƒï¼š    old_passwords=1 mysqlçš„ç”¨æˆ·å¯†ç ï¼šUPDATE mysql.user SET Password = OLD_PASSWORD('ottermysql') WHERE user = 'ottermysql'.   åœ¨ä½¿ç”¨æ­£å¸¸çš„auth411ç™»å½•è®¤è¯æ—¶ä¼šè¿”å›-2ï¼Œéœ€è¦ä½¿ç”¨auth311è¿›è¡Œç™»å½•éªŒè¯.  
68,canalç›‘æ§é…ç½®æ–‡ä»¶å˜åŒ–æ—¶è€ƒè™‘ä¸‹ä¸meta.datæ–‡ä»¶è¾“å‡º æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œç§»é™¤äº†ä¸€ä¸ªinstanceé…ç½®ï¼Œå‘ç°é€šé“å¹¶æœªåœæ­¢ï¼Œè€Œæ˜¯ç»§ç»­è¿è¡Œç€ï¼Œæ£€æŸ¥äº†ä¸‹confç›®å½•ï¼Œå‘ç°åˆé‡æ–°ç”Ÿæˆäº†è¯¥ç›®å½•ï¼Œè¯¥ç›®å½•ä¸‹å­˜åœ¨ä¸€ä¸ªmeta.datæ–‡ä»¶.  å¯¼è‡´è‡ªåŠ¨åœæ­¢å¤±è´¥.  è§£å†³ï¼š å¿½ç•¥ç©ºçš„æ–‡ä»¶ï¼Œæ¯ä¸ªinstanceå¿…é¡»åŒ…å«instance.propertiesæ‰ç®—ä¸€ä¸ªæ­£å¸¸çš„ï¼Œå¦åˆ™éœ€è¦è¿›è¡Œå…³é—­ 
67,canalå¢åŠ heartbeatäº‹ä»¶ æ”¯æŒä¸‹otteréœ€æ±‚ï¼š https://github.com/alibaba/otter/issues/25 ç›®å‰å¿ƒè·³ä¿¡æ¯åªåœ¨parserå’Œsinkæ¨¡å—ä¸­é—´è¿›è¡Œä¼ è¾“ï¼Œç›®å‰storeæš‚æ— éœ€æ±‚ï¼Œæ‰€ä»¥æš‚ä¸è¾“å‡ºåˆ°storeä¸­ï¼Œç›´æ¥åœ¨sinkä¸­è¢«æ¶ˆè´¹å’Œè¿‡æ»¤ 
66,mysql binaryç±»å‹å¤„ç† otter issue : https://github.com/alibaba/otter/issues/22 é’ˆå¯¹åŒæ­¥binaryç±»å‹ï¼Œbinlogé‡Œè®°å½•ä¸ºStringï¼Œå¯¼è‡´åç»­åœ¨å¤„ç†æ—¶æŒ‰ç…§å­—ç¬¦ä¸²è¿›è¡Œå¤„ç†ï¼Œå‡ºç°é”™è¯¯.  
65,schemaä¸ºçº¯æ•°å­—æ—¶ï¼Œdesc 123.tableä¼šåŒ…è¯­æ³•é”™è¯¯ï¼Œå¯¼è‡´è·å–è¡¨ç»“æ„å¼‚å¸¸ <pre> mysql> desc 123.pre_common_addon ; ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '123.pre_common_addon' at line 1 </pre> éœ€è¦å¯¹schema / table nameåšä¸€ä¸‹è½¬ä¹‰ç¬¦ 
64,canal client exampleå¼‚å¸¸å¤„ç† 1.  canal serveré›†ç¾¤ï¼Œæ‰€æœ‰çš„èŠ‚ç‚¹å…¨æŒ‚äº†ï¼Œå¯¹åº”çš„canal client exampleéœ€è¦å¤„ç†no alive canal serverçš„å¼‚å¸¸.  2.  ClusterCanalConnector.connect()ï¼Œå½“é‡è¯•retryTimesæ¬¡åï¼Œå¦‚æœè¿˜å»ºç«‹ä¸äº†é“¾æ¥ï¼Œå¢åŠ å¼‚å¸¸åé¦ˆï¼Œè€Œä¸åº”è¯¥åªæ˜¯è®°å½•æ—¥å¿—.  
63,zkClientä½¿ç”¨0.2ç‰ˆæœ¬åï¼Œå‡ºç°NoSuchMethodError ![zkclient](https://f.cloud.github.com/assets/834743/1148993/adb7ffce-1ed2-11e3-85d7-135e9c1d3490.jpg) zkClientä½¿ç”¨0.2ç‰ˆæœ¬åï¼Œå‡ºç°NoSuchMethodError zkclientåœ¨0.2ç‰ˆæœ¬ï¼Œä¿®æ”¹äº†æ–¹æ³•ï¼š https://github.com/sgroschupf/zkclient/commit/e72d8fd682907004d0b1488e47d8fe55d405b751 ç„¶ååœ¨zkclinet 0.3ç‰ˆæœ¬ï¼Œä¿®å¤äº†æ–¹æ³•ä¸å…¼å®¹çš„é—®é¢˜ï¼š https://github.com/sgroschupf/zkclient/commit/26f4d50fe8b3f5f6a4aa3747f254162c6a6c410b 
62,ddlè¯­å¥è§£æå¼‚å¸¸ é’ˆå¯¹å¦‚ä¸‹ddlè¯­å¥ï¼š <pre> CREATE TABLE `cm_settle_incash` (    `batch_id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'æ‰¹æ¬¡'    `counter_acct_code` bigint(20) DEFAULT NULL COMMENT 'æŸœå°ç§‘ç›®å·'    `channel_sum_amount` decimal(18 2) NOT NULL COMMENT 'æ€»é‡‘é¢'    `channel_sum_cost` decimal(18 2) NOT NULL DEFAULT '0.00' COMMENT 'æ€»æˆæœ¬'    `bank_sum_amount` decimal(18 2) NOT NULL DEFAULT '0.00' COMMENT 'æ€»æ¥æ¬¾'    `begin_date` date DEFAULT NULL COMMENT 'å¼€å§‹æ—¥æœŸ'    `end_date` date DEFAULT NULL COMMENT 'ç»“æŸæ—¥æœŸ'    `create_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´'    `update_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´'    `cdk_amount` decimal(18 2) DEFAULT '0.00' COMMENT 'é•¿çŸ­æ¬¾é‡‘é¢'    `cdk_type` tinyint(4) DEFAULT NULL COMMENT 'é•¿çŸ­æ¬¾ç±»å‹ 1é•¿æ¬¾2çŸ­æ¬¾'    `deal_id` bigint(20) DEFAULT NULL COMMENT 'äº¤æ˜“id'    `cdk_deal_id` bigint(20) DEFAULT NULL COMMENT 'é•¿çŸ­æ¬¾id'    PRIMARY KEY (`batch_id`)  ) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8; </pre> é€šè¿‡SimpleDdlParserï¼Œæ— æ³•è§£ææ­£ç¡®çš„schema/table nameï¼Œå¯¼è‡´è§£æå‡ºé”™.  ä¸»è¦åŸå› ï¼š 1.  SimpleDdlParseræ˜¯é€šè¿‡æ­£åˆ™è¿›è¡Œè¡¨åæå–ï¼Œæ¯”å¦‚ä¼šå¤„ç†`schema`.`table`çš„æƒ…å†µï¼Œå¦‚æœå¯¹åº”æ•´ä¸ªddlä¸­æœ‰ä¸ª.å·ï¼Œä¼šå¯¼è‡´schemaçš„åŒ¹é…å‡ºé”™ 
61,canalæ”¯æŒä¸‹otter ddlåŒæ­¥çš„éœ€æ±‚ otter issue : https://github.com/alibaba/otter/issues/12 ddlåŒæ­¥çš„æ— æ³•æ”¯æŒå¹‚ç­‰æ€§å¤„ç†ï¼Œéœ€è¦å°½å¯èƒ½ä¿è¯ddl/dmlæ˜¯ç›¸äº’ç‹¬ç«‹ï¼Œå°½å¯èƒ½æ˜¯å•æ¡çš„ddlè¿›è¡Œä¸²è¡Œæ‰§è¡Œï¼Œä¸è€ƒè™‘batch.   è§£å†³ï¼š  1. canal serverå¢åŠ å‚æ•°ï¼Œcanal.instance.get.ddl.isolationï¼Œä»£è¡¨æ˜¯å¦å­¤ç«‹çš„è¿”å›å•æ¡ddlè¯­å¥.  
60,SimpleDdlParser process query failed.  å‡ºç°ç±»ä¼¼å¼‚å¸¸ï¼š <pre> pid:1 nid:1 exception:canal:6.21->6.20:com.alibaba.otter.canal.parse.exception.CanalParseException: com.alibaba.otter.canal.parse.exception.CanalParseException: SimpleDdlParser process query failed. pls submit issue with this queryString: CREATE table `bak591`.`j_order_log_back_201309` like j_order_log Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: SimpleDdlParser process query failed. pls submit issue with this queryString: CREATE table `bak591`.`j_order_log_back_201309` like j_order_log </pre> ç™»å½•æ•°æ®åº“ï¼Œåœ¨bakåº“ä¸‹ï¼Œæ‰§è¡Œddlè¯­å¥ï¼Œè·¨åº“å»ºè¡¨ï¼Œå¯¼è‡´è§£æå¼‚å¸¸.  
59,canal server é«˜å¯ç”¨è¿æ¥æ•°é—®é¢˜  client serverè¿æ¥äº†ä¸¤ä¸ªæ•°æ®åº“ã€‚é»˜è®¤æ˜¯æ•°æ®åº“Aï¼Œstandby æ•°æ®åº“Bã€‚å½“æ•°æ®åº“AæŒ‚æ‰çš„æ—¶å€™ï¼Œcanalä¸æ•°æ®åº“Bçš„è¿æ¥æ•°æš´å¢ï¼Œå¯¼è‡´è¿æ¥æ‹’ç»ã€‚ æ˜¯å¦æœ‰å¼€å¯å¿ƒè·³SQL ï¼Ÿ  å¯¹åº”canalç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Ÿ  æš‚æ—¶å…³é—­é—®é¢˜ï¼Œæ€€ç–‘å’Œæ—©æœŸçš„canalç‰ˆæœ¬å¿ƒè·³sql bugå¯¼è‡´å‡ºç°æ‰§è¡Œå¿ƒè·³sqlçš„é“¾æ¥ä¸é‡Šæ”¾ï¼Œå·²ä¿®å¤ 
58,ä¸èƒ½æŒ‰ç‰¹å®šè§„åˆ™æŒ‡å®šDDLè®¢é˜… æ¯”å¦‚è®¢é˜…DML   pop.\*      å¯¹äºDDLè€Œè¨€ï¼Œ_._çš„æ•°æ®éƒ½ä¼šè¢«è®¢é˜…  
57,ç‰¹æ®Šæ•°æ®ç±»å‹è§£æ ç‰¹æ®Šæ•°æ®ï¼š 1. yearç±»å‹ï¼Œé»˜è®¤å€¼ä¸º0000 2. dateç±»å‹ï¼Œé»˜è®¤å€¼ä¸º0000-00-00 00:00:00 canal <= 1.0.8ç‰ˆæœ¬ï¼Œç›®å‰çš„æµ‹è¯•ï¼š æ’å…¥æ•°æ®ï¼š +----+---------------------+---------------------+-------------+-------------+--------------+--------------+ | ID | DATETIME_VALUES     | TIMESTAMP_VALUES    | DATE_VALUES | TIME_VALUES | YEAR4_VALUES | YEAR2_VALUES | +----+---------------------+---------------------+-------------+-------------+--------------+--------------+ |  3 | 0000-00-00 00:00:00 | 0000-00-00 00:00:00 | 0000-00-00  | 00:00:00    |         0000 |         2000 | +----+---------------------+---------------------+-------------+-------------+--------------+--------------+ å®é™…è¾“å‡ºï¼š 3 0002-11-30 00:00:00.0 1970-01-01 08:00:00.0 0002-11-30 00:00:00 1900 2000 æµ‹è¯•è¿‡ç¨‹ä¸­ä¾‹å­ï¼š +----+---------------------+---------------------+-------------+-------------+--------------+--------------+ | ID | DATETIME_VALUES     | TIMESTAMP_VALUES    | DATE_VALUES | TIME_VALUES | YEAR4_VALUES | YEAR2_VALUES | +----+---------------------+---------------------+-------------+-------------+--------------+--------------+ | 26 | 9999-12-31 23:59:59 | 2038-01-18 23:59:59 | 9999-12-31  | 838:59:59   |         2155 |         2155 | | 27 | 0000-00-00 00:00:00 | 0000-00-00 00:00:00 | 0000-00-00  | -838:59:59  |         0000 |         0000 | +----+---------------------+---------------------+-------------+-------------+--------------+--------------+ å®é™…æµ‹è¯•è¾“å‡ºï¼š --- 26 9999-12-31 23:59:59 2038-01-18 23:59:59 9999-12-31 838:59:59 2155 2155 --- 27 0000-00-00 00:00:00 0000-00-00 00:00:00 0000-00-00 -838:59:59 0000 0000 --- it's fixed.   å¯ä»¥çœ‹ä¸€ä¸‹ï¼Œmysqlçš„æ—¶é—´ç±»å‹ï¼šhttp://dev.mysql.com/doc/refman/5.0/en/date-and-time-types.html 
56,canal serveråœ¨å¼€å¯heartbeatï¼Œé‡åˆ°è§£æå¼‚å¸¸åä¼šå‡ºç°mysqlé“¾æ¥æš´æ¶¨ canal serveråœ¨å¼€å¯heartbeatï¼Œé‡åˆ°è§£æå¼‚å¸¸åä¼šå‡ºç°mysqlé“¾æ¥æš´æ¶¨.  ç”¨æˆ·åœ¨ä½¿ç”¨canalè§£æmysql 5.6.13ç‰ˆæœ¬æ—¶ï¼Œè§£ææ—¶å‡ºç°å¦‚ä¸‹å¼‚å¸¸ï¼š <pre> Caused by: com.alibaba.otter.canal.parse.exception.CanalParseException: parse row data failed. Caused by: java.lang.IllegalArgumentException: !! Unknown BLOB packlen = 0         at com.taobao.tddl.dbsync.binlog.event.RowsLogBuffer.fetchValue(RowsLogBuffer.java:752)         at com.taobao.tddl.dbsync.binlog.event.RowsLogBuffer.nextValue(RowsLogBuffer.java:97)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseOneRow(LogEventConvert.java:294)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parseRowsEvent(LogEventConvert.java:249)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:102)         at com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert.parse(LogEventConvert.java:60)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser.parseAndProfilingIfNecessary(AbstractEventParser.java:297)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3$1.sink(AbstractEventParser.java:161)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.dump(MysqlConnection.java:120)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:189) </pre> è¿è¡Œä¸€æ®µæ—¶é—´åï¼Œmysqlé“¾æ¥é€æ­¥æŒç»­å¢é•¿ï¼Œæœ€ç»ˆè¶…è¿‡æœ€å¤§è¿æ¥æ•° é—®é¢˜åŸå› åˆ†æï¼š MysqlEventParseræ€»å…±æœ‰3ä¸ªsocketé“¾æ¥åˆ°mysqlä¸Š  1.  binlog dumpé“¾æ¥  (start/stopä¸­éƒ½ä¼šå…³é—­ï¼Œstartè§£æå¼‚å¸¸æ—¶ä¼šè§¦å‘preDump/afterDumpè°ƒç”¨) 2.  table metaæŸ¥è¯¢é“¾æ¥ (preDump/afterDump/stopä¸­éƒ½ä¼šå…³é—­) 3.  heartbeat æ‰§è¡Œé“¾æ¥  (preDump/stopä¸­éƒ½ä¼šå…³é—­). æ‰€ä»¥åˆšå¥½é‡ä¸Šè§£æå¼‚å¸¸æ—¶ï¼Œé‡å¤è§¦å‘preDump/afterDumpè°ƒç”¨ï¼Œè€Œheartbeatæ²¡æœ‰åœ¨afterDumpä¸­å…³é—­é“¾æ¥ï¼Œå¯¼è‡´è¢«é‡å¤åˆ›å»º.   åŸæœ¬heartbeatçš„è®¾è®¡æ€è·¯æ—¶ï¼Œåªå¯åŠ¨ä¸€æ¬¡ï¼Œå½“å‡ºç°switchæ—¶æ‰ä¼šè¿›è¡Œé‡æ–°é“¾æ¥çš„è¿‡ç¨‹.  éœ€è¦é¿å…é‡å¤è°ƒç”¨prefDumpè§¦å‘åˆ›å»ºå¤šæ¬¡heartbeaté“¾æ¥çš„é—®é¢˜   
55,clientåœ¨serverä¸å¯ç”¨æ—¶ï¼Œå‡ºç°cpu100% ç”¨æˆ·åé¦ˆï¼šåœ¨linuxä¸Šï¼ŒClusterCanalConnectorè¿™ç§æ–¹å¼é‡Œé¢åªæœ‰ä¸€ä¸ªåœ°å€çš„æ—¶å€™ å¦‚æœè¿™ä¸ªå®•æœºäº† é‡è¿çš„é€Ÿåº¦éå¸¸å¿« cpu100%.   å¤§è‡´å®¢æˆ·ç«¯ä»£ç ï¼š while(true) {     client.connect()     client.getWithoutAck()/client.ack(); } windowsä¸‹cpuä¸ä¼š100%ï¼Œlinuxç¯å¢ƒä¸‹æ˜æ˜¾.   
54,ç¼ºå°‘thred idè®¯æ¯ï¼Ÿ å½“åšç¨‹åºäº‹ç‰©æ—¥å¿—æ¥ç”¨çš„æ—¶å€™ç¼ºå°‘å‰åå°å…³è”æ€§ï¼Œéœ€è¦åŠ å…¥binlogæœ¬èº«å·²æœ‰çš„thredidã€‚å¸Œæœ›èƒ½å¤Ÿåœ¨ä¸‹ä¸ªç‰ˆæœ¬é‡ŒåŠ å…¥ã€‚ 
53,èƒ½ä¸èƒ½å¢åŠ  mysql å’Œoracle æ–¹é¢çš„æ‰‹å†Œï¼Ÿ èƒ½ä¸èƒ½å¢åŠ æ‰‹å†Œ æˆ–è€…è¯¦ç»†çš„æ–‡æ¡£ï¼Ÿè°¢è°¢ï¼ çœ‹ä¸€ä¸‹wikiå§ï¼Œåº”è¯¥æœ‰ä½ æƒ³è¦çš„å†…å®¹ã€‚ wikiåœ°å€ï¼šhttps://github.com/alibaba/canal/wiki 
52,canal clientæ”¯æŒgetWithout timeoutè¶…æ—¶æ§åˆ¶çš„æ¥å£è°ƒç”¨ RT.   è§£å†³ï¼š CanalConnectoræ–°å¢æ–¹æ³• 1.  Message getWithoutAck(int batchSize  Long timeout  TimeUnit unit) 2.  Message get(int batchSize  Long timeout  TimeUnit unit)  
51,mysqlåœ°å€é…ç½®å‡ºé”™ï¼Œå¢åŠ å¼‚å¸¸æè¿°ä¿¡æ¯ Caused by: org.springframework.beans.factory.BeanCreationException: Error creatng bean with name 'com.alibaba.otter.canal.parse.support.AuthenticationInfo#1f5ea4a' defined in class path resource [spring/file-instance.xml]: Initialization of bean failed; nested exception is java.lang.ArrayIndexOutOfBoundsException: 1 at org.springframework.beans.factory.support.AbstractAutowireCapableBeaFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:480) ~[spring-2.5..jar:2.5.6] at org.springframework.beans.factory.support.AbstractAutowireCapableBeaFactory$1.run(AbstractAutowireCapableBeanFactory.java:409) ~[spring-2.5.6.jar:25.6] at java.security.AccessController.doPrivileged(Native Method) ~[na:1.6._17] è§£å†³ï¼š  è¯†åˆ«å‡ºå¼‚å¸¸é…ç½®ï¼ŒæŠ›å¼‚å¸¸æ—¶è®°å½•åŸå§‹çš„é…ç½®ä¿¡æ¯.    throw new RuntimeException("address[" + text + "] is illegal  eg.127.0.0.1:3306"); 
50,canalä¸­è¾“å‡ºè¡¨åå…¨ä¸ºå°å†™ canal 1.0.6ç‰ˆæœ¬ä¹‹å‰ï¼Œè§£æçš„schema   tablename å…¨éƒ¨è½¬åŒ–ä¸ºäº†å°å†™ã€‚ è§£å†³ï¼šéœ€è¦ä¿ç•™ä¸‹binlogä¸­è®°å½•çš„å†…å®¹ï¼Œä¸åšå¤§å°å†™è½¬åŒ–  éœ€è¦åœ¨my.cnfä¸­è®¾ç½®lower_case_table_names=0ï¼Œä¿è¯mysqlå¤§å°å†™é“­æ„Ÿ.  ä¸ç„¶é’ˆå¯¹mysqlå­˜å‚¨è¡¨åå…¨ä¸ºå°å†™ 
49,canal serveråœ¨windowsä¸‹å¯åŠ¨å¤±è´¥ï¼Œconfç›®å½•ä¸‹ä¿®æ”¹é…ç½®ä¸€ç›´ä¸ç”Ÿæ•ˆ canal deployeråœ¨æ‰“åŒ…çš„æ—¶å€™ï¼Œå°†confä¹Ÿæ‰“å…¥åˆ°äº†jarä¸­ï¼Œè€Œåœ¨ä¸€äº›ç‰¹å®šçš„ç¯å¢ƒä¸‹ï¼Œclassloaderä¼šä¼˜å…ˆåŠ è½½äº†jaråŒ…ä¸­çš„confé…ç½®æ–‡ä»¶ï¼Œä»è€Œå¯¼è‡´åœ¨æ‰“åŒ…ç›®å½•ä¸‹çš„é…ç½®ä¸€ç›´æœªç”Ÿæ•ˆ.   ä¹Ÿå°±æ˜¯è¯´ï¼šconfä¸‹å’Œcanal.deployer-xxxx.jarä¸­éƒ½æœ‰canal.propertieså’Œinstance.properties è§£å†³åŠæ³•ï¼š 1.  åœ¨canal.deployer-xxx.jaræ‰“åŒ…æ—¶å»é™¤confç›®å½•.  fixed issue 49    9515b83 
48,mysqlä¸»å¤‡åˆ‡æ¢é‡‡ç”¨è™šipåˆ‡æ¢ï¼Œcanalçš„failoveræœºåˆ¶ é‡‡ç”¨è™šipè¿›è¡Œmysqlä¸»å¤‡ç®¡ç†æ—¶ï¼Œæš´éœ²çš„ipåªæœ‰1ä¸ªï¼Œç›®å‰canalè¯†åˆ«ä¸»å¤‡åˆ‡æ¢æ˜¯æ ¹æ®ipå’Œå¯¹åº”metaä¿¡æ¯ä¸­çš„ipåœ°å€å‘ç”Ÿä¸ä¸€è‡´æ—¶ï¼Œè¿›è¡Œä¸€æ¬¡åˆ‡æ¢æ“ä½œï¼ŒåŸºäºæ—¶é—´æˆ³é‡æ–°å®šä½binlog . æ‰€ä»¥ï¼Œå½“ä½¿ç”¨è™šipï¼Œåç«¯å‘ç”Ÿäº†ä¸»å¤‡åˆ‡æ¢ï¼Œå‰ç«¯æ— æ³•æ„ŸçŸ¥ï¼Œä¸€ç›´ä¼šå‡ºç°å¯¹åº”binlogä¸å­˜åœ¨çš„é”™è¯¯ï¼Œä¸€ç›´é‡è¯•ï¼Œä»è€Œå¯¼è‡´canalæ•´ä¸ªä¸å¯ç”¨ è§£å†³ï¼šåœ¨å‡ºç°binlogä¸å­˜åœ¨çš„é”™è¯¯æ—¶ï¼Œå°è¯•æŒ‰ç…§æ—¶é—´æˆ³é‡æ–°å®šä½binlog .  ä»€ä¹ˆæƒ…å†µä¸‹binlogä¼šå‡ºç°ä¸å­˜åœ¨ï¼š 1. è™šipã€€mysqlä¸»å¤‡åˆ‡æ¢ 2. canalè§£æå»¶è¿Ÿè¿‡ä¹…ï¼Œå¯¹åº”binlogå·²ç»è¢«åˆ é™¤.  é’ˆå¯¹æƒ…å†µ2ï¼Œéœ€è¦é¿å…ã€‚è§£å†³åŠæ³•ï¼šå½“æŒ‰ç…§æ—¶é—´æˆ³è¿›è¡Œé‡æ–°å®šä½binlogæ—¶ï¼Œå¦‚æœå½“å‰æ‰€æœ‰binlogçš„æ—¶é—´æˆ³éƒ½æ™šäºæŸ¥æ‰¾çš„æ—¶é—´æˆ³ï¼Œé‚£åº”è¯¥æŒ‚èµ·ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨ç¬¬ä¸€ä¸ªbinlogè¿›è¡Œè§£æå¤„ç† binlogä¸å­˜åœ¨çš„é”™è¯¯ç±»å‹ï¼Œæ¯”è¾ƒå¤š.   ä¸å­˜åœ¨çš„binlog :  mysql> show binlog events in 'mysql-bin.000273' from 75489806 limit 1; ERROR 1220 (HY000): Error when executing command SHOW BINLOG EVENTS: Could not find target log å­˜åœ¨çš„binlogï¼Œé”™è¯¯çš„offest:  mysql> show binlog events in 'mysql-bin.000374' from 75489806 limit 1; ERROR 1220 (HY000): Error when executing command SHOW BINLOG EVENTS: Wrong offset or I/O error --- binlog dumpæŒ‡ä»¤ï¼š ä¸å­˜åœ¨çš„binlog :  : Received error packet: errno = 1236  sqlstate = HY000 errmsg = Client requested master to start replication from position > file size; the first event 'mysql-bin.000011' at 12313  the last event read from './mysql-bin.000011' at 4  the last byte read from './mysql-bin.000011' at 4. å­˜åœ¨çš„binlogï¼Œé”™è¯¯çš„offest: Received error packet: errno = 1236  sqlstate = HY000 errmsg = binlog truncated in the middle of event; consider out of disk space on master; the first event 'mysql-bin.000011' at 123  the last event read from './mysql-bin.000011' at 123  the last byte read from './mysql-bin.000011' at 142. æƒ…å†µæš‚æ—¶è¿˜æ²¡ä¸èƒ½å…¨é¢æšä¸¾ï¼Œæš‚æ—¶holdä¸€ä¸‹issue 
47,canal serverå¯åŠ¨æ—¶é’ˆå¯¹canal.ipé…ç½®ä¸ºç©ºæ—¶ï¼Œé»˜è®¤ç›‘å¬ä¸ºAddressUtils.getHostIp()çš„åœ°å€ï¼Œå¯¼è‡´å¤šIPåœ°å€ä¸å¯è®¿é—® canal serverå¯åŠ¨æ—¶é’ˆå¯¹canal.ipé…ç½®ä¸ºç©ºæ—¶ï¼Œé»˜è®¤ç›‘å¬ä¸ºAddressUtils.getHostIp()çš„åœ°å€ï¼Œå¯¼è‡´å¤šIPåœ°å€ä¸å¯è®¿é—®.    è§£å†³ï¼š  1.  å¦‚æœé…ç½®ipåœ°å€ä¸ºç©ºæ—¶ï¼Œé»˜è®¤socketçš„ç›‘å¬ä¸º :${canal.port}ï¼Œä¸æŒ‡å®šipç»‘å®šï¼Œæ¥æ”¶ä»»ä½•è¯¥æœºå™¨ä»»ä½•ipè¿‡æ¥çš„è¯·æ±‚.  2.  åŒæ—¶ä¼šé€šè¿‡AddressUtils.getHostIp()é€‰æ‹©ä¸€ä¸ªipï¼Œæš´éœ²åˆ°zkä¸­ï¼Œç”±å®¢æˆ·ç«¯è¿›è¡Œè®¿é—®.  
46,lll 
45,åˆå¹¶åŸä½œè€…æ›´æ–° 
44,å…³æ³¨è¡¨çš„æ¡ä»¶å˜æ›´ï¼Œå¯¹åº”ç”Ÿæ•ˆæ—¶é—´é—®é¢˜ ç›®å‰å…³æ³¨è¡¨çš„æ­£åˆ™ï¼Œå¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼è¿›è¡Œè®¾ç½® 1.  confä¸‹çš„instance.propertiesä¸­ï¼Œå¯ä»¥è®¾ç½®table.regexï¼Œåœ¨ç¬¬ä¸€æ¬¡å¯åŠ¨çš„æ—¶å€™ç›´æ¥è½½å…¥ä½¿ç”¨ 2.  æŸä¸ªclientè¿›è¡Œsubscribe(filter)ï¼Œå¯ä»¥æäº¤ä¸€ä¸ªfilter å¦‚æœæ–¹å¼2ä¸­ï¼Œæäº¤äº†filterï¼Œç›®å‰çš„ç­–ç•¥æ˜¯ç›´æ¥è¦†ç›–äº†æ–¹å¼1ä¸­çš„æ¡ä»¶ï¼Œå¦‚æœcanal serveré€‰æ‹©äº†file/zookeeperæŒä¹…åŒ–äº†metaï¼Œå³ä½¿ä¸‹æ¬¡serveré‡å¯ï¼Œå¯¹åº”çš„å…³æ³¨è¡¨æ¡ä»¶ä¹Ÿä¼šæ˜¯æ–¹å¼2æäº¤çš„æ•°æ® ç”Ÿæ•ˆæ—¶é—´é—®é¢˜ï¼š æ–¹å¼1ï¼šä¿®æ”¹instance.propertiesï¼Œéœ€è¦é‡å¯instance(å¦‚æœå¼€å¯scanï¼Œè‡ªåŠ¨ä¼šé‡å¯)ï¼Œinstanceé‡å¯ä¼šå›é€€ä¸€éƒ¨åˆ†binlogï¼Œæ¯”å¦‚å®¢æˆ·ç«¯æœªackçš„æ•°æ®ï¼Œæˆ–è€…æ¶ˆè´¹äº†ä¸€åŠçš„äº‹åŠ¡ï¼Œè¿˜æœ‰å°±æ˜¯æœªåŠæ—¶åˆ·å‡ºå†…å­˜ä½ç‚¹æ•°æ®åˆ°æŒä¹…åŒ–ä»‹è´¨.  æ‰€ä»¥ï¼Œå¯¹åº”çš„ç”Ÿæ•ˆæ—¶é—´ä¼šå¯¹ä¹‹å‰çš„éƒ¨åˆ†æ•°æ®è¿›è¡Œä½œç”¨ æ–¹å¼2ï¼šå…³é—­clientï¼Œä¿®æ”¹è®¢é˜…æ¡ä»¶åï¼Œä¼šæ˜¯åŒæ­¥å³æ—¶ç”Ÿæ•ˆï¼Œsubscribeè°ƒç”¨æˆåŠŸåï¼Œç›´æ¥æ›¿æ¢äº†canal serverä¸­è€ç‰ˆæœ¬çš„filter. 
43,canalé‡å¯åä¼šä¸¢å¤±clientæäº¤çš„filteræ¡ä»¶ï¼Œè¢«instance.propertiesé…ç½®çš„filterç»™è¦†ç›– canal serveråœ¨é‡å¯åï¼Œæ²¡æœ‰é‡æ–°è¯»å–ä¸€æ¬¡å®¢æˆ·ç«¯subscribe()æäº¤çš„filterè®°å½•ï¼Œå¯¼è‡´å¯åŠ¨æ—¶é‡æ–°è½½å…¥äº†instance.propertiesï¼Œclient filteræ¡ä»¶è¢«ä¸¢å¼ƒ è§£å†³ï¼šcanal instanceé‡æ–°å¯åŠ¨æ—¶ï¼Œä¼˜å…ˆè¯»å–ä¸€æ¬¡MetaManagerä¸­è®°å½•çš„client filterä¿¡æ¯ 
42,canalè‡ªåŠ¨é‡è¿æ—¶ä¼šå‡ºç°destination:idbbond-1 should start firstä¿¡æ¯ <pre title="code"> 2013-06-05 18:08:40.960 [main] INFO c.alibaba.otter.canal.client.impl.ClusterCanalConnector - restart the connector for next round retry. 2013-06-05 18:08:40.975 [main] WARN c.alibaba.otter.canal.client.impl.ClusterCanalConnector - something goes wrong when getWithoutAck data from server:/192.168.1.134:11111 com.alibaba.otter.canal.protocol.exception.CanalClientException: something goes wrong with reason: something goes wrong with channel:[id: 0x3622e177  /192.168.1.134:50993 => /192.168.1.134:11111]  exception=com.alibaba.otter.canal.server.exception.CanalServerException: destination:idbbond-1 should start first at com.alibaba.otter.canal.client.impl.SimpleCanalConnector.getWithoutAck(SimpleCanalConnector.java:241) at com.alibaba.otter.canal.client.impl.ClusterCanalConnector.getWithoutAck(ClusterCanalConnector.java:135) at SimpleCanalClientExample.main(SimpleCanalClientExample.java:35) </pre> é—®é¢˜è¯´æ˜ï¼š 1. canal serveråœ¨å¯åŠ¨æ—¶ï¼Œæ˜¯å…ˆæš´éœ²äº†ç«¯å£ï¼Œå†å¯åŠ¨å¯¹åº”éœ€è¦å¯åŠ¨çš„instanceï¼Œå› ä¸ºå¯åŠ¨instanceéœ€è¦ä¸€ç‚¹æ—¶é—´ï¼Œæ‰€ä»¥æœ‰ä¸€å®šæ¦‚ç‡ä¼šæ’ä¸Šinstanceæœªå¯åŠ¨å®Œæˆ.  
41,mysql 5.6æ–°å¢ä¸¤ç§typeäº‹ä»¶MYSQL_TYPE_TIMESTAMP2/MYSQL_TYPE_DATETIME2 éœ€è¦æ³¨æ„ï¼Œæ–°çš„æ—¶é—´ç±»å‹åŸºäºæ•°å­—è¿›è¡Œå‹ç¼©å­˜å‚¨ï¼Œè€Œä¸”é‡‡ç”¨äº†big-endianæ¨¡å¼ï¼Œå’Œå…¶ä»–binlogå¯¹è±¡è§£ææœ‰æ‰€ä¸åŒ 
39,HAæ¨¡å¼ä¸‹mysql master-standbyæ— æ³•è‡ªåŠ¨åˆ‡æ¢ canal ä¸» canal config ## detecing config canal.instance.detecting.enable = true canal.instance.detecting.sql = insert into retl.xdual values(1 now()) on duplicate key update x=now() canal.instance.detecting.interval.time = 3 canal.instance.detecting.retry.threshold = 3 canal.instance.detecting.heartbeatHaEnable = true #  example log  2013-05-14 10:23:29.509 [destination = example   address = /192.168.196.82:3306   EventParser] WARN  c.alibaba.otter.canal.parse.driver.mysql.MysqlConnector - connect failed!java.net.ConnectException: Connection refused         at sun.nio.ch.Net.connect(Native Method)         at sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:525)         at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:65)         at com.alibaba.otter.canal.parse.inbound.mysql.MysqlConnection.connect(MysqlConnection.java:51)         at com.alibaba.otter.canal.parse.inbound.AbstractEventParser$3.run(AbstractEventParser.java:141)         at java.lang.Thread.run(Thread.java:679) canal ä»  ## detecing config canal.instance.detecting.enable = true canal.instance.detecting.sql = insert into retl.xdual values(1 now()) on duplicate key update x=now() canal.instance.detecting.interval.time = 3 canal.instance.detecting.retry.threshold = 3 canal.instance.detecting.heartbeatHaEnable = true 
38,scanå®šæ—¶æ‰«æéœ€è¦å¿½ç•¥canal meta/paser.datæ–‡ä»¶ é»˜è®¤é…ç½®ä¸­ï¼Œcanalé€‰æ‹©çš„æ˜¯file-intance.xmlæœºåˆ¶ï¼Œä¼šå°†ç›¸å…³æ•°æ®å®šæ—¶åˆ·æ–°åˆ°æ–‡ä»¶. è€Œæ–‡ä»¶çš„å­˜å‚¨é»˜è®¤æ˜¯å’Œinstanceçš„é…ç½®æ–‡ä»¶åœ¨ä¸€èµ·.   æ¯”å¦‚ conf/example/meta.dat.  æ‰€ä»¥åœ¨scanå®šæ—¶æ‰«æçš„æ—¶å€™ï¼Œå°±ä¼šå‘ç°instanceä¸‹çš„æ–‡ä»¶æœ‰æ‰€å˜åŒ–ï¼Œå¯¼è‡´éœ€è¦è¿›è¡Œä¸€æ¬¡reload.  è§£å†³ï¼š scanæ‰«ææ—¶ï¼Œå¿½ç•¥.datçš„æ–‡ä»¶å˜æ›´ 
37,DDLè¯­å¥ä¸èƒ½åŠæ—¶è¾“å‡º ddlè¯­å¥ä¼šåœ¨Transaction Bufferä¸­è¢«ç¼“å­˜ä¸­ï¼Œåªæœ‰åœ¨ä¸‹ä¸€æ¬¡å‡ºç°Transaction Begin/Endçš„æ¶ˆæ¯æ—¶ï¼Œæ‰ä¼šè¾“å‡ºåˆ°storeä¸­ï¼Œclientæ‰å¯è§ è§£å†³ï¼šddlè¯­å¥åœ¨binlogåè®®ä¸­ï¼Œå‰åä¸ä¼šæœ‰begin/commitäº‹ä»¶ï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œè¿›å…¥Transaction Bufferåï¼Œä¹Ÿç«‹é©¬flushåˆ°storeä¸­ å½±å“ç‰ˆæœ¬ <= 1.0.3 
36,eclipseä¸­ç›´æ¥å¯åŠ¨canal server eclipseç›´æ¥è¿è¡ŒCanalLanuncherä¼šå¯åŠ¨å¤±è´¥ï¼Œå¯¹åº”ä¾èµ–çš„canal.propertieså’Œspring/xxx-instance.xmlæ— æ³•æ‰¾åˆ° åŸå› ï¼š 1.  canal serverå¯åŠ¨æ—¶ä¸ºäº†ç®€åŒ–è·¯å¾„ä¾èµ–ï¼Œéƒ½ä½¿ç”¨äº†ç›¸å¯¹è·¯å¾„æˆ–è€…classpath:è¿›è¡Œæè¿°èµ„æºä¾èµ–ï¼Œæ‰€ä»¥åŸºäºeclipseå¯åŠ¨åï¼Œå¯¼è‡´æŸ¥æ‰¾èµ„æºå¤±è´¥ è§£å†³ï¼š 1.  å°†conf/ç›®å½•ä¸‹çš„é…ç½®ï¼ŒåŠ å…¥åˆ°eclipseçš„classpathä¸­ eclipseç›´æ¥è¿è¡ŒCanalLauncherå³å¯ï¼Œé»˜è®¤ä¼šæ‰¾åˆ°deployerå·¥ç¨‹ä¸‹çš„src/main/resourcesä¸­çš„èµ„æºæ–‡ä»¶. æ¯”å¦‚: 1. logback.xml 2. canal.propertiesï¼Œè¿™é‡Œé¢ä¾èµ–äº†spring/xxxx-instance.xmlä¸ºclasspathè·¯å¾„ 3. spring/xxxx-instance.xmlï¼Œè¿™é‡Œé¢ä¾èµ–äº†xxxx/instance.propertiesä¸ºclasspathè·¯å¾„ ç›´æ¥è¿è¡Œåï¼Œå¯¹åº”çš„logsè¾“å‡ºä¸ºcanal/logs(å·¥ç¨‹æ ¹ç›®å½•çš„logsç›®å½•) 
35,æ”¯æŒbinlog_formatä¸ºstatement mixedæ¨¡å¼çš„è§£æè¾“å‡º binlog_formatæ¨¡å¼æœ‰statement  row  mixedä¸‰ç§æ¨¡å¼ï¼Œä¸»è¦çš„åŒºåˆ«åœ¨äºinsert/update/deleteè®°å½•æ˜¯å¦é‡‡å–sqlæ–¹å¼ï¼Œè¿˜æ˜¯è¯¦ç»†çš„è®°å½•å˜æ›´.  æœŸæœ›ï¼š 1. canalä¹Ÿå¯ä»¥æ”¯æŒérowæ¨¡å¼çš„æ•°æ®è§£æï¼Œè§£æå¯¹åº”çš„sql.  (érowæ¨¡å¼ä¸‹ï¼Œä¸ä¼šæä¾›before/after columnsä¿¡æ¯) 
34,canalæ–°å¢åŸºäºfileè®°å½•ä½ç‚¹ä¿¡æ¯ï¼Œä¸ä¾èµ–zookeeperæŒä¹…åŒ–canal serverçŠ¶æ€ è®¡åˆ’æ”¯æŒézookeeperæ¨¡å¼ï¼Œä¹Ÿå¯ä»¥æœ‰æŒä¹…åŒ–çš„åŠŸèƒ½ï¼Œå…³é—­canal serveråï¼Œä¸‹ä¸€æ¬¡å¯åŠ¨æ—¶ä¹Ÿèƒ½ç»§ç»­ä¸Šä¸€æ¬¡çš„ä½ç½®è¿›è¡Œæ¶ˆè´¹æ•°æ®ï¼Œä¸ä¼šä¸¢å¤±æ•°æ® æ³¨æ„ï¼š åŸºäºfileæŒä¹…åŒ–çš„æ¨¡å¼ï¼Œå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ— æ³•å®ç°é›†ç¾¤failoverçš„åŠŸèƒ½ï¼Œå› ä¸ºfileå±äºæœ¬æœºï¼Œfailoveråˆ‡æ¢åˆ°å¦ä¸€æœºå™¨åæ— æ³•æ‰¾åˆ°fileï¼Œä¼šé€ æˆæ— æ³•æ‰¾åˆ°ä¸Šä¸€æ¬¡è§£æä½ç½®.  
33,æ–°å»ºä¸ªexample module <name>canal driver module for otter ${project.version}</name> modulename  å¤ªé•¿äº† ç›®å‰example moduleæ²¡æœ‰çº³å…¥canal trunkç®¡ç†ï¼Œå¯ä»¥å°†å…¶ç§»å…¥ï¼Œæ–¹ä¾¿å­¦ä¹  
32,clientåŸºäºzookeeperåœ°å€æ–­å¼€ä¸€æ¬¡åï¼Œç«‹é©¬é‡æ–°å¯åŠ¨ï¼Œå¶å„¿ä¼šå‡ºç°NPEå¼‚å¸¸ é—®é¢˜æè¿°ï¼š 1.  clientåŸºäºzookeeperåœ°å€è·å–canal serverçš„å·¥ä½œèŠ‚ç‚¹ 2.  clientç¬¬ä¸€æ¬¡èµ·æ¥å·¥ä½œåï¼Œè¢«éæ­£å¸¸é€€å‡ºï¼Œæ¯”å¦‚kill.   ç„¶åç«‹é©¬åˆé‡æ–°å¯åŠ¨ 3.  clientä¼šå‡ºç°NullPointExceptionå¼‚å¸¸ åŸå› åˆ†æï¼š  1.  clientç¬¬ä¸€æ¬¡å¯åŠ¨åï¼Œä¼šåœ¨zookeeperè®°å½•ä¸€ä¸ªclient runningèŠ‚ç‚¹ï¼Œéæ­£å¸¸é€€å‡ºåï¼ŒrunningèŠ‚ç‚¹ä¸ä¼šç«‹é©¬å°æ—¶ 2.  å½“clientä¸‹ä¸€æ¬¡ç«‹é©¬å¯åŠ¨åï¼Œå‘ç°runningèŠ‚ç‚¹å­˜åœ¨ï¼Œå¹¶ä¸ä¼šç«‹é©¬åˆ›å»ºsocketï¼Œå½“æ‰§è¡Œåé¢çš„getæ•°æ®æ“ä½œæ—¶ï¼Œå‘ç°socketä¸ºnullï¼Œå°±å‡ºç°äº†NPEé—®é¢˜ å½±å“çš„ç‰ˆæœ¬ <= 1.0.3.  è§£å†³æ–¹æ¡ˆï¼š 1.  å‘ç°runningèŠ‚ç‚¹å­˜åœ¨ï¼Œå¹¶ä¸ä¼šç«‹é©¬åˆ›å»ºsocketï¼Œä½†åŒæ—¶é˜»å¡åç»­çš„getæ•°æ®çš„æ“ä½œï¼Œç›´åˆ°socketè¢«å»ºç«‹  
31,mysql YEARç±»å‹binlogè¾“å‡ºä½¿ç”¨shortæ›¿æ¢Date é—®é¢˜ï¼š mysql YEARç±»å‹åœ¨canal1.0.3ç‰ˆæœ¬ä¸­ä½¿ç”¨äº†java.sql.Dateå¯¹è±¡æ¥æ ‡ç¤ºï¼Œæ— æ³•å‡†ç¡®çš„è¡¨ç¤ºä¸€ä¸ªå¹´ä»½ä¿¡æ¯ï¼ŒåŸæœ¬ä¸€ä¸ªå¹´ä»½2013ï¼Œè¾“å‡ºç»“æœä¼šæ˜¯ï¼š2013-01-01 if (cal == null)    cal = Calendar.getInstance(); cal.clear(); cal.set(Calendar.YEAR  i32 + 1900); value = new java.sql.Date(cal.getTimeInMillis()); è§£å†³ï¼š  1.  ç›´æ¥ä½¿ç”¨æ•°å­—å­˜å‚¨è¡¨ç¤ºï¼Œprotobufè¾“å‡ºç»“æœä¸º2013 
30,macä¸‹startup.shå¯åŠ¨è„šæœ¬æŠ¥é”™ é—®é¢˜ï¼š bin_abs_path=$(readlink -f $(dirname $0)) macä¸‹readlink -fä¸èƒ½æ­£å¸¸å·¥ä½œ è§£å†³ï¼š  case "`uname`" in     Linux)                 bin_abs_path=$(readlink -f $(dirname $0))                 ;;           *)                   bin_abs_path=`cd $(dirname $0); pwd`                 ;;  
29,canalè§£æDDLæ“ä½œå‡ºç°å¼‚å¸¸ï¼Œå¯¼è‡´æ•´ä¸ªè§£ææŒ‚èµ· é—®é¢˜æè¿°:  1.  å¯åŠ¨canal server/client 2.  æ‰§è¡Œddlæ“ä½œï¼Œæ¯”å¦‚createï¼Œalter   deleteï¼Œcreateè¡¨çš„æ“ä½œ.  ç‰¹å®šçš„caseè§¦å‘DDLè¡¨åè§£æé”™è¯¯ 3.  canalåœ¨è§£æbinlogåï¼Œå‘ç°binlog columnä¿¡æ¯å’Œå½“å‰tablemeta cacheä¸­çš„æ•°æ®ä¸ä¸€è‡´ï¼ŒæŠ›å‡ºå¼‚å¸¸ï¼Œè¿›è¡Œé‡è¯•.  å­˜åœ¨çš„é—®é¢˜:  å°±æ˜¯åœ¨ç¬¬ä¸‰æ­¥å‡ºç°å¼‚å¸¸åï¼Œæ²¡æœ‰æ›´æ–°å¯¹åº”çš„cacheæ•°æ®ï¼Œå¯¼è‡´ä¸‹ä¸€æ¬¡è§£ææ—¶ä¸€ç›´ä½¿ç”¨ä¸Šä¸€æ¬¡é”™è¯¯çš„tablemetaï¼Œå¯¼è‡´ä¸€ç›´å‡ºé”™ï¼Œä¸€ç›´åœ¨é‡è¯•.  
28,canal HAæ¨¡å¼clusteré›†ç¾¤åˆ—è¡¨æ•°æ®æ›´æ–°é—®é¢˜ æ¯ä¸ªinstanceä¸‹é¢éƒ½ä¼šæœ‰ä¸ªclusterç›®å½•ï¼Œä»£è¡¨æœåŠ¡è¿™ä¸ªinstanceçš„canal serverçš„æœºå™¨åˆ—è¡¨ï¼š <pre> [zk: localhost:2181(CONNECTED) 15] ls /otter/canal/destinations/example/cluster  [10.20.144.22:11111] </pre> 1.0.2ç‰ˆæœ¬çš„clusteråˆ—è¡¨åªä¼šåœ¨runningèŠ‚ç‚¹æŠ¢å æˆåŠŸåæ‰ä¼šç”ŸæˆrunningèŠ‚ç‚¹ï¼Œå’ŒåŸæœ¬cluseterçš„å®šä½æƒ³çŸ›ç›¾ è§£å†³ï¼š canal serverå¯åŠ¨å¯¹åº”çš„instanceæ—¶ï¼Œä¸ç®¡æœ‰æ²¡æœ‰æŠ¢å åˆ°runningèŠ‚ç‚¹ï¼Œéƒ½åº”è¯¥åˆ›å»ºclusterèŠ‚ç‚¹ï¼Œè¡¨æ˜è‡ªå·±æ˜¯å¯ä»¥work for this instanceï¼Œå¦‚æœæ­¤æ—¶å‘ç”ŸrunningèŠ‚ç‚¹åˆ é™¤ï¼Œå®¢æˆ·ç«¯å°±å¯ä»¥ä»clusteråˆ—è¡¨ä¸­æ‰¾åˆ°ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿›è¡Œé“¾æ¥ï¼Œlazyçš„æ–¹å¼ä¿ƒä½¿å®ƒè¿›è¡Œå¯åŠ¨ã€‚ (ps. å½“ç„¶runningèŠ‚ç‚¹åˆ é™¤ï¼Œcanal serverçš„å¦ä¸€å°æœºå™¨è‡ªå·±ä¹Ÿèƒ½æ„Ÿåº”åˆ°ï¼Œå¹¶å¯åŠ¨instance) 
27,canal server runningèŠ‚ç‚¹åˆ¤æ–­æ˜¯å¦ä¸ºæœ¬æœºæ“ä½œä¼˜åŒ– canal serveråœ¨zookeeperçš„èŠ‚ç‚¹ï¼š  <pre class="java" name="code"> [zk: localhost:2181(CONNECTED) 15] get /otter/canal/destinations/example/running   {"active":true "address":"10.20.144.51:11111" "cid":1} </pre> ç›®å‰ä¸€å°æœºå™¨ï¼Œåˆ¤æ–­å½“å‰æ˜¯å¦ä¸ºå·¥ä½œèŠ‚ç‚¹ï¼Œæ˜¯é€šè¿‡cidæ˜¯å¦å’Œæœ¬æœºçš„idç›¸åŒæ¥åˆ¤æ–­ï¼Œä½†ç›®å‰cidè¿™ä¿¡æ¯åœ¨å¯åŠ¨canal serveræ²¡æœ‰ä¸¥æ ¼æ ¡éªŒæ˜¯å¦æœ‰é‡å¤ï¼Œå¯¼è‡´ä¸¤å°æœºå™¨éƒ½è®¤ä¸ºæ˜¯è‡ªå·±æœ¬æœºï¼Œå¯¹äºåç»­çš„å‘½ä»¤æ§åˆ¶æ“ä½œæœ‰é£é™© è§£å†³ï¼šå°†åˆ¤æ–­æ˜¯å¦æœ¬æœºçš„æ“ä½œï¼Œä¿®æ”¹ä¸ºåŸºäºaddressæ˜¯å¦ç›¸åŒæ¥åˆ¤æ–­ï¼Œip+portå¯ä»¥å”¯ä¸€å®šä¹‰ä¸€ä¸ªjvm 
26, é›†ç¾¤æ¨¡å¼ä¸‹ï¼Œå®¢æˆ·ç«¯ä¸instanceæ–­å¼€è¿æ¥ï¼Œzookeeper runningèŠ‚ç‚¹ è‡ªåŠ¨è¢«åˆ é™¤äº† é—®é¢˜ï¼š   é›†ç¾¤æ¨¡å¼ä¸‹ï¼Œå®¢æˆ·ç«¯ä¸instanceæ–­å¼€è¿æ¥ï¼Œzookeeper runningèŠ‚ç‚¹ è‡ªåŠ¨è¢«åˆ é™¤äº†ã€‚å¹¶ä¸”æŸ¥çœ‹canal.log æ— ä»»ä½•å¼‚å¸¸ä¿¡æ¯è¾“å‡ºã€‚ è¯·é—®è¿™æ˜¯ç›®å‰çš„bugä¹ˆï¼Œè¿˜æ˜¯è¯´zookeeperé…ç½®é—®é¢˜ ï¼Ÿ æˆ‘æ‰€æœŸæœ›çš„ï¼š    å®¢æˆ·ç«¯æ–­å¼€é“¾æ¥åï¼ŒrunningèŠ‚ç‚¹ä¾ç„¶å­˜åœ¨ï¼Œä¸‹æ¬¡å®¢æˆ·ç«¯è¿æ¥ä¸Šæ¥ï¼Œå¯ä»¥ç»§ç»­ä½¿ç”¨ä¹‹å‰çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬cursorä¿¡æ¯ã€‚ ps:è²Œä¼¼çœ‹åˆ°ç±»ä¼¼é—®é¢˜æ˜¯1.0.3è§£å†³ã€‚ç°åœ¨æ˜¯å•¥ç‰ˆæœ¬ã€‚ã€‚ã€‚ å¯ä»¥çœ‹ä¸€ä¸‹è¿™ä¸ªissue : https://github.com/alibaba/canal/issues/22 ä¸»è¦æ˜¯canal 1.0.2ç‰ˆæœ¬ä¸‹ï¼Œå½“ä¸€ä¸ªinstanceåªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯é“¾æ¥ï¼Œè€Œä¸”è¿™ä¸ªå®¢æˆ·ç«¯é“¾æ¥æ–­å¼€æ—¶ï¼Œä¼šè‡ªåŠ¨åœæ­¢ã€‚ä¸‹ä¸€æ¬¡å®¢æˆ·ç«¯å¯åŠ¨æ—¶ï¼Œä¼šè‡ªåŠ¨ä»æ‰€æœ‰çš„instanceçš„clusteræœºå™¨åˆ—è¡¨ä¸­éšæœºé€‰æ‹©ä¸€å°ï¼Œé‡æ–°å»ºç«‹é“¾æ¥ï¼Œè¿™æ—¶instanceä¼šé‡æ–°å¯åŠ¨.  ç›®å‰æ˜¯å¦å…³é—­åœ¨canal 1.0.3ç‰ˆæœ¬ä¼šåšæˆå¯é…ç½®çš„æ¨¡å¼ï¼Œå…è®¸ç”¨æˆ·å®šä¹‰.  (PS. 1.0.3ç›®å‰è¿˜æœªæ­£å¼å‘å¸ƒï¼Œæ¸…æ˜è¿‡åä¼šrelease) canal.propertiesä¸­æ–°å¢å‚æ•°ï¼š #as far as possible to stop canal instance where client disconnect canal.stopInstanceAsPossible = true / false  # falseä»£è¡¨å®¢æˆ·ç«¯æ–­å¼€æ—¶ï¼Œä¸ä¸»åŠ¨å…³é—­instanceï¼Œå³ä½ é”æœŸæœ›çš„ä¿ç•™runningèŠ‚ç‚¹ è¿˜æœ‰ä¸€ç‚¹è¦è¯´æ˜ï¼Œä½ é€‰æ‹©äº†zookeeperçš„é›†ç¾¤æ¨¡å¼é…ç½®å¯åŠ¨äº†canal serverï¼Œå®ƒä¼šå®šæ—¶è®°å½•cursorä¿¡æ¯åˆ°zookeeperä¸­ï¼Œé»˜è®¤çš„åˆ·æ–°é¢‘ç‡å¯è§ canal.zookeeper.flush.periodè¿™å‚æ•°ï¼Œé»˜è®¤ä¸º1ç§’ã€‚  æ‰€ä»¥ä¸‹ä¸€æ¬¡é‡æ–°é“¾æ¥æ—¶ï¼Œé‡æ–°å¯åŠ¨instanceï¼Œä¼šç»§ç»­ä»æœ€åä¸€æ¬¡æäº¤åˆ°zookeeperä¸­çš„cursorä½ç½®è¿›è¡Œå¯åŠ¨ï¼Œä¼šæœ‰ä¸€å®šçš„é‡å¤æ•°æ®.  ç›®å‰canal 1.0.2è¿˜æœ‰ä¸€ä¸ªå·²çŸ¥bug : #23 ï¼Œä¼šæœ‰ä¸ªNPEé—®é¢˜ï¼Œå¯¼è‡´é‡æ–°é“¾æ¥æ—¶ä¼šå‡ºç°å¯åŠ¨å¤±è´¥ã€‚ æ‰€ä»¥ç›®å‰canal 1.0.2ä½¿ç”¨äº†é›†ç¾¤éƒ¨ç½²instanceï¼Œå‘ç”Ÿåˆ‡æ¢æˆ–è€…å®¢æˆ·ç«¯ä¸»åŠ¨æ–­å¼€é“¾æ¥ï¼Œä¼šå¯¼è‡´instanceç¯å¢ƒä¸å¯ç”¨ï¼Œå¦‚æœæƒ³ä½¿ç”¨é›†ç¾¤éƒ¨ç½²ï¼Œè¿˜æ˜¯ç­‰ä¸€ä¸‹canal 1.0.3ç‰ˆæœ¬ï¼Œå¦‚æœ‰é—®é¢˜ï¼Œå¯è¿›ç¾¤è®¨è®º(wikié¦–é¡µæœ‰ç¾¤å·ä¿¡æ¯)æˆ–è€…ç»§ç»­åœ¨issueä¸Šç•™è¨€.  å¤šè°¢ï¼ 
25,windows batè„šæœ¬å¯åŠ¨å¤±è´¥ å‡ºé”™æç¤ºï¼š  'conf_dir' ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤ï¼Œä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åº æˆ–æ‰¹å¤„ç†æ–‡ä»¶ã€‚ 'canal_conf' ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤ï¼Œä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åº æˆ–æ‰¹å¤„ç†æ–‡ä»¶ã€‚ 'logback_configurationFile' ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤ï¼Œä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åº æˆ–æ‰¹å¤„ç†æ–‡ä»¶ã€‚ Listening for transport dt_socket at address: 9099 Exception in thread "main" java.lang.NoClassDefFoundError: com/alibaba/otter/can al/deployer/CanalLauncher Caused by: java.lang.ClassNotFoundException: com.alibaba.otter.canal.deployer.Ca nalLauncher         at java.net.URLClassLoader$1.run(URLClassLoader.java:202)         at java.security.AccessController.doPrivileged(Native Method)         at java.net.URLClassLoader.findClass(URLClassLoader.java:190)         at java.lang.ClassLoader.loadClass(ClassLoader.java:307)         at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)         at java.lang.ClassLoader.loadClass(ClassLoader.java:248) Could not find the main class: com.alibaba.otter.canal.deployer.CanalLauncher. Program will exit. windowsç¯å¢ƒæµ‹è¯•é€šè¿‡.  ç¯å¢ƒï¼š windows xpç³»ç»Ÿ  javaç‰ˆæœ¬ï¼š java version "1.6.0_18" Java(TM) SE Runtime Environment (build 1.6.0_18-b07) Java HotSpot(TM) Client VM (build 16.0-b13  mixed mode  sharing) 
24,windowsåœ¨ä¸mysqlå»ºç«‹é“¾æ¥æ—¶ï¼Œå‡ºç°unexpected blocking io behaviorå¼‚å¸¸ å¼‚å¸¸æ ˆï¼š <code> 0:42:02.725 [main] WARN  c.a.o.c.p.d.mysql.MysqlConnector - connect failed!java.io.IOException: unexpected blocking io behavior  at com.alibaba.otter.canal.parse.driver.mysql.utils.PacketManager.write(PacketManager.java:54)  at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.negotiate(MysqlConnector.java:159)  at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnector.connect(MysqlConnector.java:66)  at com.alibaba.otter.canal.parse.driver.mysql.MysqlConnectorTest.testQuery(MysqlConnectorTest.java:20)  </code> å¯¹åº”ä»£ç ï¼š <code> public static void write(SocketChannel ch  ByteBuffer[] srcs) throws IOException {          long total = 0;          for (ByteBuffer buffer : srcs) {              total += buffer.remaining();              System.out.println(total);           }          long size = ch.write(srcs);          if (size != total) {              throw new IOException("unexpected blocking io behavior");          }      }  </code> æ‰¾äº†windowsç¯å¢ƒæµ‹è¯•æœªé‡ç°è¯¥é—®é¢˜ ï¼Œæš‚æ—¶close  
23,canal clientåœ¨ç¬¬ä¸€æ¬¡å»ºç«‹è¿æ¥æ—¶ï¼Œå¦‚æœcanal serveræ‰€æœ‰éƒ½é…ç½®äº†lazyæ¨¡å¼ï¼Œclientå¯åŠ¨å¤±è´¥ clientå¯åŠ¨æ—¶éœ€è¦åšä¸€ä¸ªcheck :  1.  å¦‚æœå½“å‰instanceå·²ç»æœ‰runningçš„canal serverï¼Œç›´æ¥é€‰æ‹©è¯¥èŠ‚ç‚¹ï¼Œè¿›è¡Œé“¾æ¥ 2.  å¦‚æœæ²¡æœ‰runningèŠ‚ç‚¹ï¼Œå†ä»instance/clusterèŠ‚ç‚¹ä¸­ï¼Œéšæœºé€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿›è¡Œé“¾æ¥ æˆ‘å°±æ˜¯é‡åˆ°#26 è¿™ä¸ªé—®é¢˜ã€‚æˆ‘æƒ³çŸ¥é“æ˜¯è°åˆ é™¤äº†running èŠ‚ç‚¹ã€‚ åˆ é™¤runningèŠ‚ç‚¹çš„ä»£ç ï¼š  1. https://github.com/alibaba/canal/blob/master/server/src/main/java/com/alibaba/otter/canal/server/netty/handler/SessionHandler.java    stopCanalInstanceIfNecessaryæ–¹æ³•ï¼Œå‘ç°clientæ–­å¼€æ—¶ï¼Œå°è¯•å…³é—­instance.  2. https://github.com/alibaba/canal/blob/master/common/src/main/java/com/alibaba/otter/canal/common/zookeeper/running/ServerRunningMonitor.java ï¼Œå¯¹åº”çš„stopæ–¹å¼ï¼Œä¼šåˆ é™¤runningèŠ‚ç‚¹ 
22,canal serveråœ¨å¤„ç†å®¢æˆ·ç«¯ä¸»åŠ¨å…³é—­è¿æ¥æ—¶ï¼Œæ˜¯å¦éœ€è¦å…³é—­instance åœ¨canal 1.0.2ç‰ˆæœ¬ä»¥åŠä»¥å‰çš„ç‰ˆæœ¬ï¼Œåœ¨è®¾è®¡çš„æ—¶å€™ï¼Œcanal serveré’ˆå¯¹instanceç®¡ç†ä¸€ç›´éƒ½æ˜¯lazyæ¨¡å¼å¤„ç†.  å½“canal clientæ–­å¼€é“¾æ¥æ—¶ï¼Œcanal serverä¼šä¸»åŠ¨å…³é—­instanceï¼Œç­‰ä¸‹ä¸€æ¬¡canal clienté“¾æ¥åå†é‡æ–°åˆ›å»º.  å…ˆå‰çš„è€ƒè™‘ï¼š 1. canal serverä¸»åŠ¨å…³é—­instanceï¼Œä¸»è¦æ˜¯è€ƒè™‘æ˜¯æƒ³å°†canal serverä½œæˆæ— çŠ¶æ€ï¼Œä¸‹ä¸€æ¬¡canal clientå¯ä»¥éšæœºé€‰æ‹©ä¸€å°æœºå™¨è·å–æ•°æ®ï¼Œæ–°çš„canal serverä¼šé‡æ–°å¯åŠ¨instanceï¼Œæ•´ä¸ªHAæ¨¡å‹ä¼šæ¯”è¾ƒç®€å•.  æ”¹è¿›ï¼š 1.  canal serveråœ¨clienté€€å‡ºæ—¶ä¸ä¸»åŠ¨å…³é—­instanceèµ„æº 2.  ä¸‹ä¸€æ¬¡canal clienté‡æ–°é“¾æ¥åï¼Œéœ€è¦é€šè¿‡Clusteræ¨¡å¼(é€šè¿‡zookeeperè·å–åˆ°HAæ¨¡å¼ä¸­æ­£åœ¨è¿è¡Œçš„canal serverçš„æœºå™¨ä¿¡æ¯)ï¼Œç„¶åä¸å…¶é‡æ–°å»ºç«‹é“¾æ¥å³å¯ ä¸€ä¸ªå‰æï¼Œå®¢æˆ·ç«¯disconnect/connecté—´éš”æ—¶é—´ä¸ä¼šå¾ˆé•¿ï¼Œå°½å¯èƒ½å‡å°‘èµ„æºæ¶ˆè€—.  
21,canal MemoryStoreæ”¯æŒæŒ‰å†…å­˜å¤§å°å®šä¹‰ canal v1.0.2ç‰ˆæœ¬æ”¯æŒçš„MemoryEventStoreWithBufferï¼Œæ˜¯é€šè¿‡å®šä¹‰bufferSizeæ¥æ§åˆ¶å†…å­˜ä½¿ç”¨ï¼Œä½†é‡åˆ°å¤§æ–‡æœ¬å­—æ®µæ—¶ï¼Œå•çº¯æŒ‰ç…§è®°å½•æ•°æ¥æ§åˆ¶å°±å¾ˆå®¹æ˜“çˆ†å†…å­˜.  æ‰€ä»¥ï¼Œéœ€è¦æ”¯æŒåŸºäºå†…å­˜å¤§å°ç®¡ç†çš„EventStoreï¼ŒåŒæ—¶æ”¯æŒæŒ‰å†…å­˜å¤§å°è·å–æ•°æ®ï¼Œæ–¹ä¾¿clientè¿›è¡Œå†…å­˜æ§åˆ¶.  MemoryEventStoreWithBuffer.setBufferMemSize() 
20,æ”¯æŒmysql 5.6å—ï¼Ÿ æ”¯æŒmysql 5.6å—ï¼Ÿ ç›®å‰æš‚ä¸æ”¯æŒmysql5.6ï¼Œä¸»è¦æ˜¯mysql 5.6åè®®ä¸Šå‡ºç°ä¸å…¼å®¹å¤„ç†ï¼Œä¿®æ”¹äº†LogEventäº‹ä»¶typeç±»å‹ï¼Œéœ€è¦å‡çº§canalç‰ˆæœ¬è§£å†³ è®¡åˆ’åœ¨v1.0.3æ”¯æŒmysql 5.6åè®®ï¼Œç›®å‰canalç‰ˆæœ¬releaseæš‚å®šä¸º2å‘¨ä¸€ä¸ªå‘¨æœŸ æ„Ÿè°¢agappleçš„å›å¤ï¼Œç­‰å¾…æ‚¨ä»¬çš„æ–°ç‰ˆæœ¬ æˆ‘æ‰¾äº†åŠå¤©ä¹Ÿæ²¡æœ‰æ‰¾åˆ°5.6 binlogçš„æ ¼å¼æ–‡æ¡£ã€‚ä½ çŸ¥é“åœ¨å“ªé‡Œå—ï¼Ÿ http://dev.mysql.com/doc/internals/en/binary-log.html ï¼Œè¿™ä¸ªé“¾æ¥æ˜¯ä½ åˆ—å‡ºæ¥çš„ï¼Œé‡Œé¢çš„å†…å®¹åº”è¯¥æ˜¯5.5ç‰ˆæœ¬ä»¥ä¸‹çš„ã€‚ http://dev.mysql.com/doc/refman/5.6/en/binary-log.html å·²ç»æ”¯æŒï¼Œcommitè®°å½•ï¼š https://github.com/alibaba/canal/commit/286a8f82916d99d3464ac544e2267397290e7880 mysql5.6åè®®å˜åŒ–æ–‡æ¡£ï¼šhttps://github.com/alibaba/canal/wiki/BinlogChange%28mysql5.6%29 
19,mysql metaConnectioné“¾æ¥æ³„æ¼ è¿è¡Œä¸€æ®µæ—¶é—´åï¼Œä¸mysqlä¹‹é—´çš„æ•°æ®åº“é“¾æ¥è¾¾åˆ°äº†å‡ åƒæ¡ï¼Œä¸”å…¨éƒ¨éƒ½æ˜¯å¤„äºESTABLISHEDçŠ¶æ€ã€‚ è¿›è¡Œjmap dumpå†…å­˜å¯¹è±¡ï¼Œå´æ— æ³•æ‰¾åˆ°SocketChannelImplçš„ç›¸å…³å®ä¾‹ï¼Œè¯´æ˜æ˜¯è¢«full gcå›æ”¶äº†.  
18,mysql textä¸­æ–‡å­—ç¬¦å‡ºç°ä¹±ç  mysql tableä¸­å­—æ®µç±»å‹ä¸ºtextæ—¶ï¼Œæ•°æ®åº“ç¼–ç å’Œè¡¨ç¼–ç å‡ä¸ºutf-8ï¼Œcanalé…ç½®çš„è§£æç¼–ç ä¸ºutf-8ï¼Œè§£æå‡ºæ¥çš„æ•°æ®è®°å½•ä¸ºä¹±ç .   åŸå› åˆ†æï¼š 1. mysql binlogä¸­å°†text/blobç±»å‹éƒ½è®°å½•ä¸ºLogEvent.MYSQL_TYPE_BLOB 2. canalè¯†åˆ«åˆ°BLOBä¿¡æ¯ï¼Œæ— æ³•åŒºåˆ†æ˜¯textè¿˜æ˜¯blobï¼Œéƒ½æŒ‰ç…§iso-8859-1è¿›è¡Œç¼–ç ï¼Œå¯¼è‡´é—®é¢˜çš„äº§ç”Ÿ è§£å†³ï¼š 1.  æ‹¿åˆ°binlogåï¼Œé’ˆå¯¹BLOBç±»å‹ï¼Œéœ€è¦åæŸ¥ä¸‹table metaä¿¡æ¯ï¼Œè·å–çœŸå®çš„å­—æ®µç±»å‹ï¼ŒåŒºåˆ†å‡ºtextï¼Œç„¶åæŒ‰ç…§ç¼–ç è¿›è¡Œè§£æ.  
17,mysql varcharç±»å‹å¤„ç†'\000'å­—ç¬¦é—®é¢˜ çº¿ä¸Šæµ‹è¯•é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼š a. ä¸šåŠ¡æ‰§è¡Œsqlæ’å…¥äº†ä¸€æ¡è®°å½•ï¼Œå…¶ä¸­ä¸€ä¸ªå­—æ®µä¸ºï¼š'210012\000\000\000' b. otterä¸­ç¾åŒæ­¥ï¼Œæ›´æ–°äº†è¿™æ¡è®°å½•ï¼Œå°†å­—æ®µæ›´æ–°ä¸ºï¼š '210012'  (å»é™¤äº†\000) c. canalå†ä¸€æ¬¡è§£ææ—¶ï¼Œå‘ç°beforeå’Œafterå€¼ç›¸åŒï¼Œæ²¡æœ‰ä»»ä½•å­—æ®µå‘ç”Ÿå˜æ›´ï¼Œå¯¼è‡´otteråŒæ­¥sqlæ‰§è¡Œå¤±è´¥ã€‚ åŸå› åˆ†æï¼š 1. dbsyncåœ¨è§£æ'210012\000\000\000'ï¼Œç­‰ä»·äº'210012'ï¼Œè‡ªåŠ¨å¿½ç•¥äº†'\000'è¯·æ±‚ ä»£ç ï¼š for (; (found < end) && buf[found] != '\0'; found++) è¯´æ˜ï¼š \0ä¸ºc-styleé£æ ¼çš„å­—ç¬¦ä¸²ç»“æŸç¬¦ï¼Œè‡³äºä¸šåŠ¡æ‰§è¡Œæ€ä¹ˆæ’å…¥äº†\000ï¼Œç›®å‰æš‚æœªçŸ¥åŸå›  
16,columnå­—æ®µå˜æ›´ä¿¡æ¯ä¸¢å¤± åœ¨LogEventConvertä¸­å¤„ç†æ—¶columnï¼Œä¿¡æ¯ä¸æ­£ç¡®ã€‚  1. isUpdateæ‰€æœ‰éƒ½ä¸ºtrueï¼Œæ­£ç¡®çš„åº”è¯¥æ˜¯ï¼šæ ¹æ®beforeå’Œafterå­—è¿›è¡Œåˆ¤æ–­.  2. sqlTypeæ‰€æœ‰éƒ½ä¸º0ï¼Œæ­£ç¡®åº”è¯¥æ˜¯ï¼šintç±»å‹å¯¹åº”äºçš„java.sql.Types 1. é’ˆå¯¹isNullå­—æ®µï¼Œæ²¡æœ‰æ·»åŠ åˆ°before/afterå˜æ›´å­—æ®µåˆ—è¡¨ 
15,ä¿®æ”¹canal.propertiesé‡Œçš„canal.addressä¸ºcanal.ip ä¿®æ”¹canal.propertiesé‡Œçš„canal.addressä¸ºcanal.ip è·Ÿcom.alibaba.otter.canal.deployer.CanalConstants.CANAL_IPå¸¸é‡å¯¹åº”ä¸Š 
14,cannal.propertiesé‡Œçš„é…åˆ¶é€‰é¡¹æ˜¯å¦è½»å¾®é”™è¯¯? åœ¨deployerå·¥ç¨‹é‡Œçš„canal.propertiesé‡Œçš„ canal.address=  æ˜¯å¦åº”è¯¥æ”¹ä¸º canal.ip= å› ä¸ºåœ¨ CanalConstants è¿™ä¸ªç±»é‡Œæ˜¯å¦‚ä¸‹å®šä¹‰çš„: public static final String CANAL_IP                          = ROOT + "." + "ip"; çœ¼ç¥çœŸæ•é”å•Šï¼ ç¡®å®æ˜¯è¿™æ ·çš„ï¼Œä»£ç ä¸­æœ‰è¿™æ ·çš„é€»è¾‘ï¼š ``` java ip = getProperty(properties  CanalConstants.CANAL_IP); if (StringUtils.isEmpty(ip)) {   ip = AddressUtils.getHostIp(); } ``` æ‰€ä»¥ä¸€ç›´æ²¡æœ‰åˆ«å‘ç°ã€‚ @wenzhihong2003  è¦ä¸ä½ æ¥æ”¹ä¸‹ï¼Œç„¶ååšä¸€æ¬¡ pull requestï¼Ÿ #15  å¤šè°¢ï¼šï¼‰ 
13,mysql instanceæ”¯æŒgroupæ¨¡å¼ æ”¯æŒå¤šä¸ªmysql parseæ•°æ®åˆå¹¶ä¸ºä¸€ä¸ªstoreè¾“å‡ºï¼Œè¿›è¡Œæ¶ˆè´¹ã€‚ å…¸å‹çš„ä¸šåŠ¡ï¼šæ•°æ®æŒ‰æ°´å¹³æ‹†åˆ†ä¸º16ä¸ªåº“åï¼Œåˆå¹¶ä¸ºé€»è¾‘çš„ä¸€ä¸ªcanal destinationè¿›è¡Œæ¶ˆè´¹ï¼Œå®¢æˆ·ç«¯ä¸ç”¨å…³å¿ƒåç»­16ä¸ªåº“çš„é“¾æ¥æƒ…å†µ éœ€è¦è€ƒè™‘ï¼š 1. å¼ºä¸€è‡´ (groupå†…æ‰€æœ‰çš„parseéƒ½æ­£å¸¸å·¥ä½œï¼Œæ‰è¿è¡Œå®¢æˆ·ç«¯æ¶ˆè´¹æ•°æ®) 2. å¼±ä¸€è‡´ (groupå†…åªè¦æœ‰ä¸€ä¸ªparseæ­£å¸¸å·¥ä½œï¼Œå°±å…è®¸å®¢æˆ·ç«¯æ¶ˆè´¹æ•°æ®) ç›®å‰çš„è§£å†³ï¼Œåªæ”¯æŒå¼ºä¸€è‡´ï¼Œè¦æ±‚æ‰€æœ‰çš„parseéƒ½æ­£å¸¸å·¥ä½œï¼Œæ‰å…è®¸å®¢æˆ·ç«¯æ¶ˆè´¹æ•°æ®ã€‚é’ˆå¯¹å¼±ä¸€è‡´æ€§ï¼Œå»ºè®®ä½¿ç”¨å¤šé€šé“éƒ¨ç½²çš„æ–¹å¼æ¥è§£å†³ 
12,1.0.0ç‰ˆæœ¬ä»£ç æäº¤ 1.0.0ç‰ˆæœ¬ä»£ç æäº¤ 
11,mysql driveråœ¨è·å–table metaæ—¶ï¼Œé’ˆå¯¹è¡¨ä¸å­˜åœ¨å‡ºç°é˜»å¡ mysql driveråœ¨å¤„ç†è¿”å›çš„æ•°æ®åŒ…æ²¡æœ‰è€ƒè™‘å¼‚å¸¸æƒ…å†µ fixed at v1.0.1 
10,mysqlç‰¹å®šçš„ddlæ“ä½œ(åˆ é™¤å­—æ®µï¼Œrename tableç­‰)ï¼Œå¯¼è‡´è§£ææŒ‚èµ· ç›®å‰å·²çŸ¥ä¼šå¯¼è‡´æŒ‚èµ·çš„ddlæ“ä½œï¼š 1. å­—æ®µåˆ é™¤   2. rename table  (å¯¼è‡´desc tableæ—¶æ‰¾ä¸åˆ°å¯¹åº”çš„metaä¿¡æ¯ï¼Œæ— æ³•è¡¥å…¨Entryä¿¡æ¯) ä¼šå¯¼è‡´ä¿¡æ¯é”™ä¹±çš„ddlæ“ä½œï¼š 1. é¦–å…ˆåˆ é™¤ä¸€ä¸ªå­—æ®µï¼Œç„¶åå†æ–°åŠ ä¸€ä¸ªå­—æ®µ(éæ·»åŠ åˆ°æœ«å°¾) åŸå› ï¼š - mysql binlogä¸­çš„tablemap LogEventï¼Œæ²¡æœ‰åŒ…å«å¯¹åº”çš„column nameä¿¡æ¯ï¼Œåªæ˜¯æŒ‰ç…§å½“å‰tableä¸­columnçš„é¡ºåºï¼Œåˆ—å‡ºäº†å­—æ®µç±»å‹ - å›é€€åˆ°ddlæ“ä½œå‰çš„binlogé‡æ–°å¼€å§‹è§£æï¼Œæ­¤æ—¶æ•°æ®åº“ä¸­desc tableæ‰€è·å–çš„ä¿¡æ¯å°±ä¼šå’Œtable mapä¸­ä¸ä¸€è‡´(æ— æ³•è¿›è¡Œmatchæ“ä½œ)ï¼Œä¼šå¯¼è‡´ä¿¡æ¯æ··ä¹± é¿å…çš„æ“ä½œï¼š 1.  ä¸šåŠ¡æ“ä½œé¿å…å¸¦åˆ é™¤æ€§è´¨çš„ddlï¼Œæ¯”å¦‚å­—æ®µåˆ é™¤ï¼Œrename table   drop table 2.  ä¸šåŠ¡æ“ä½œé¿å…æ·»åŠ å­—æ®µæ—¶è°ƒæ•´é¡ºåºï¼Œåªèƒ½æ·»åŠ åˆ°æœ«å°¾.  å¦‚æœçœŸä¸å¯é¿å…å‡ºç°å‡ºç°ä¸Šè¿°æ“ä½œä¸­çš„æƒ…å†µï¼Œåªè¦ä¸å›é€€canalè§£æä½ç½®ï¼Œå°±å¯ä»¥æ­£å¸¸å¾€ä¸‹è§£æï¼Œä¸ä¼šå‡ºç°æ•°æ®é”™ä¹±.  ä¸è¿‡éœ€è¦è€ƒè™‘ï¼šå½“canalè§£æå»¶è¿Ÿæ¯”è¾ƒå¤§ï¼Œæ­¤æ—¶è¿›è¡Œå¸¦åˆ é™¤æ€§è´¨çš„ddlæ“ä½œï¼Œå¾…è§£æçš„binlogä¸­è¿˜å­˜åœ¨å¯¹åº”ddlçš„è¡¨æ•°æ®ï¼Œé‚£è¿˜æ˜¯ä¼šå‡ºç°é—®é¢˜ã€‚ï¼ˆå°½å¯èƒ½é€‰æ‹©åˆé€‚çš„æ—¶é—´è¿›è¡Œddlæ“ä½œï¼‰ éœ€è¦ä½¿ç”¨ä¸Šé¿å…ï¼Œä¸æ˜¯bug æœ€å¥½èƒ½åŠ å…¥æ­¤ç§æ“ä½œæ–¹å¼ä¸‹ï¼Œè®©canalèƒ½å†æ¬¡é‡æ–°æ­£å¸¸è§£æçš„å®Œæ•´æ­¥éª¤ï¼ å¦‚æœé‡åˆ°ddlå¸¦åˆ é™¤æ€§è´¨çš„æ“ä½œï¼Œæ­£å¸¸çš„è¯åªè¦ä¿è¯è¿™æ—¶clientå’Œserverä¸è¦æœ‰é‡å¯ï¼Œé‚£åˆ°é—®é¢˜ä¸å¤§ï¼Œå¦‚æœçœŸé‡ä¸Šäº†ï¼Œé‚£åªèƒ½é‡ç½®ä½ç‚¹ã€‚  é‡ç½®ä½ç‚¹æ–¹æ³•ï¼š  1. åˆ é™¤zookeeperçš„cursorèŠ‚ç‚¹ä¿¡æ¯  2. ä¿®æ”¹instance.propertiesé…ç½®åˆ°ä¸€ä¸ªæ–°çš„èµ·å§‹ä½ç‚¹  3. é‡å¯å¯åŠ¨serverï¼Œç„¶åå¯åŠ¨client.  é‡ç½®ä½ç‚¹ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿™ä¸€æ®µæ—¶é—´çš„æ•°æ®ä¸¢å¤±ï¼Œåªèƒ½é€šè¿‡äººè‚‰çš„æ–¹å¼å»è¡¥è¿™ä¸ªæ•°æ®äº†ï¼Œè§£æå‡ºbinlogï¼Œå»æ‰ä¸€äº›ddlæ“ä½œçš„ä¿¡æ¯ï¼Œç„¶åæ„é€ sql  ç°åœ¨æˆ‘ä¹Ÿåœ¨è€ƒè™‘ä¸€ä¸ªé—®é¢˜ï¼Œæ˜¯å¦å¯ä»¥è€ƒè™‘å¼•å…¥ä¸€ä¸ªstrictæ¨¡å¼ï¼Œå¦‚æœéstrictæ¨¡å¼ï¼Œé’ˆå¯¹è¿™äº›ddlé—®é¢˜çš„æ•°æ®ï¼Œç›´æ¥å¿½ç•¥ï¼Œè®°å½•æ—¥å¿—çš„æ–¹å¼æ¥è§£å†³. å‡ºé—®é¢˜çš„æ—¶å€™æ‰‹å·¥åˆ‡æ¢ä¸ºéstrictï¼Œå°½å¯èƒ½å°‘çš„è·³è¿‡æ•°æ®ï¼Œé¿å…å¤§é‡æ•°æ®ä¸¢å¤± 
9,canalæ–°å¢DevGuide æ–°å¢DevGuideï¼ŒæŒ‡å¯¼ç”¨æˆ·å¦‚ä½•å¼€å‘canalçš„ç»„ä»¶ï¼Œä¸»è¦æ˜¯ä»‹ç»canalçš„ç±»ç»“æ„å’Œæ¨¡å‹ devguideåœ¨å“ªé‡Œï¼Ÿ å·²å®ŒæˆDevGuideï¼Œhttps://github.com/alibaba/canal/wiki/DevGuide 
8,canalæ–°å¢AdminGuide éœ€è¦æ–°å¢AdminGuideï¼ŒæŒ‡å¯¼ç”¨æˆ·å¦‚ä½•æ­£ç¡®é…ç½®canalçš„ç›¸å…³å‚æ•°ï¼Œä»¥åŠè¿ç»´çš„åŸºæœ¬æ“ä½œ https://github.com/alibaba/canal/wiki/AdminGuide 
7,table metaæ˜¯å¦ä¸»é”®ä¿¡æ¯åˆ¤æ–­é”™è¯¯ Entryæ•°æ®ä¸­isKeyçš„æ•°æ®è¿”å›é”™è¯¯ï¼Œå…¨éƒ¨è¿”å›ä¸ºtrue 
6,dbsync binlogè§£æå¢åŠ testcaseç”¨ä¾‹ å¢åŠ testcaseç”¨ä¾‹ï¼Œå¼•å¯¼åˆ«äººä½¿ç”¨ 
5,æŠ½å–mysql packetåè®®åŒ…ä¸ºç‹¬ç«‹å·¥ç¨‹ï¼Œæ–¹ä¾¿é‡ç”¨ mysql packetä»‹ç»ï¼šæ¨¡æ‹Ÿmysqlç™»å½•ï¼Œselect/updateè¯­å¥ä¸mysqlè¿›è¡Œé€šè®¯ fix issue 5     1. æ–°å¢äº†driver project æä¾›äº†MysqlConnector MysqlQueryExector MysqlUpdateExector     2. ä¿®æ”¹åŸå…ˆçš„parseçš„åŒ…ä¾èµ–ï¼Œé‡æ„MysqlConnectionï¼Œä½¿ç”¨æ–°çš„MysqlConnector 
3,mysql ç¼–ç å‚æ•°å»é™¤charsetNumberï¼Œæ ¹æ®connectionCharsetè®¾ç½®çš„ç¼–ç å³å¯ v1.0.0çš„ç‰ˆæœ¬ä¸­ï¼Œè®¾å®šç¼–ç éœ€è¦åŒæ—¶è®¾ç½®charsetNumberå’ŒconnectionCharsetï¼ŒcharsetNumberä¸»è¦æ˜¯å’Œmysqlè¿›è¡Œhandsharkæ—¶ï¼ŒæŒ‡å®šcharacter_set_resultsçš„è¿”å›ç¼–ç ã€‚connectionCharsetæŒ‡å®šä¸ºå®¢æˆ·ç«¯çš„è§£æç¼–ç  
2,instanceå¢åŠ è‡ªåŠ¨æ‰«ææœºåˆ¶ æ‰«æconfç›®å½•ä¸‹çš„å­ç›®å½•ï¼Œæ’é™¤springä»¥å¤–ï¼Œå°†ç›®å½•ååšä¸ºinstance destinationï¼Œè‡ªåŠ¨åŠ è½½è¯¥instanceï¼Œé»˜è®¤è¯»å–global lazy 
1,ä¿®å¤memory-instance.xmlä¸‹ï¼Œä¸é…ç½®zkserverï¼Œå¯ä»¥æ­£å¸¸å¯åŠ¨å’Œå…³é—­ fixed at version 1.0.1 
